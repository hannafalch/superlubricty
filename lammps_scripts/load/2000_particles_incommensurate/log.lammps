LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -50 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0013347219   0              0              0.0040041656   15031.727      0              7.258283e+08   1.1971759e-13  0              5.5437025    
    200000   12727.922      100            100            0.0013327946   0              0              0.0039983838   19375.65       0              9.3558078e+08  1.1971759e-13  0              4.7869199    
    300000   12727.922      100            100            0.0011475278   0              0              0.0034425835   20005.825      0              9.6600968e+08  1.1971759e-13  0              3.9894717    
    400000   12727.922      100            100            0.00093989831  0              0              0.0028196949   20091.883      0              9.7016511e+08  1.1971759e-13  0              3.1865202    
    500000   12727.922      100            100            0.00046676979  4.7599694e-36  0              0.0014003094   6089.6198      0              2.9404595e+08  1.1971759e-13  0              3.0157284    
    600000   12727.922      100            100           -0.00018627354  5.0773092e-35  0             -0.00055882063  1203.721       0              58123379       1.1971759e-13  0              3.0034359    
    700000   12727.922      100            100           -8.8077535e-05 -3.1733124e-36  0             -0.0002642326   260.14131      0              12561293       1.1971759e-13  0              3.0002703    
    800000   12727.922      100            100            0.0021352559   0.0001315943   0              0.0062741735   13.124591      0              633739.53      1.1971759e-13  0              2.9982539    
    900000   12727.922      100            100            0.00043803691  1.5759912e-05  0              0.0012983508   2.6687449      0              128864.14      1.1971759e-13  0              2.9991885    
   1000000   12727.922      100            100            0.00093611667  3.6550188e-05  0              0.0027717998   0.41366677     0              19974.488      1.1971759e-13  0              2.9988291    
   1100000   12727.922      100            100            0.00081125114 -1.07667e-05    0              0.0024445201   0.13065863     0              6309.0377      1.1971759e-13  0              2.9989032    
   1200000   12727.922      100            100            0.00076221584 -8.7511407e-06  0              0.0022953986   0.0033174356   0              160.18709      1.1971759e-13  0              2.9989358    
   1300000   12727.922      100            100            0.00078039568 -7.6641683e-06  0              0.0023488512   0.0026860828   0              129.70133      1.1971759e-13  0              2.9989232    
   1400000   12727.922      100            100            0.00078612965 -7.8099385e-06  0              0.0023661989   2.6320846e-05  0              1.2709395      1.1971759e-13  0              2.9989194    
   1500000   12727.922      100            100            0.00078343833 -7.7289986e-06  0              0.002358044    5.2836824e-05  0              2.5513011      1.1971759e-13  0              2.9989213    
   1600000   12727.922      100            100            0.0007828034  -7.7134753e-06  0              0.0023561237   1.0315323e-07  0              0.0049809003   1.1971759e-13  0              2.9989217    
   1700000   12727.922      100            100            0.0007831996  -7.7239317e-06  0              0.0023573227   9.9682524e-07  0              0.048133123    1.1971759e-13  0              2.9989214    
   1800000   12727.922      100            100            0.00078326516 -7.7255074e-06  0              0.002357521    5.8343774e-11  0              2.817212e-06   1.1971759e-13  0              2.9989214    
   1900000   12727.922      100            100            0.00078320829 -7.7239894e-06  0              0.0023573488   1.8089405e-08  0              0.00087347264  1.1971759e-13  0              2.9989214    
   2000000   12727.922      100            100            0.00078320234 -7.7238545e-06  0              0.0023573309   6.2509859e-11  0              3.0183774e-06  1.1971759e-13  0              2.9989214    
   2100000   12727.922      100            100            0.00078321032 -7.724066e-06   0              0.002357355    3.1565202e-10  0              1.5241706e-05  1.1971759e-13  0              2.9989214    
   2200000   12727.922      100            100            0.00078321072 -7.7240735e-06  0              0.0023573562   3.9055635e-12  0              1.8858568e-07  1.1971759e-13  0              2.9989214    
   2300000   12727.922      100            100            0.00078320962 -7.7240445e-06  0              0.0023573529   5.2862315e-12  0              2.552532e-07   1.1971759e-13  0              2.9989214    
   2400000   12727.922      100            100            0.00078320962 -7.7240449e-06  0              0.0023573529   1.4812516e-13  0              7.1524339e-09  1.1971759e-13  0              2.9989214    
   2500000   12727.922      100            100            0.00078320977 -7.7240488e-06  0              0.0023573534   8.4640509e-14  0              4.0869873e-09  1.1971759e-13  0              2.9989214    
   2600000   12727.922      100            100            0.00078320976 -7.7240487e-06  0              0.0023573533   4.3073622e-15  0              2.0798711e-10  1.1971759e-13  0              2.9989214    
   2700000   12727.922      100            100            0.00078320974 -7.7240481e-06  0              0.0023573533   1.2962785e-15  0              6.2592652e-11  1.1971759e-13  0              2.9989214    
   2800000   12727.922      100            100            0.00078320975 -7.7240478e-06  0              0.0023573533   1.3955294e-16  0              6.7385121e-12  1.1971759e-13  0              2.9989214    
   2900000   12727.922      100            100            0.00078320975 -7.724048e-06   0              0.0023573533   3.3608044e-17  0              1.6228122e-12  1.1971759e-13  0              2.9989214    
   3000000   12727.922      100            100            0.00078320975 -7.7240474e-06  0              0.0023573533   4.343929e-18   0              2.0975278e-13  1.1971759e-13  0              2.9989214    
Loop time of 540.976 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4791340.566 ns/day, 0.000 hours/ns, 5545.533 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.047     | 73.967     | 124.67     | 585.7 | 13.67
Neigh   | 0.74242    | 0.75786    | 0.77345    |   1.3 |  0.14
Comm    | 11.725     | 17.305     | 22.64      |  96.8 |  3.20
Output  | 0.34808    | 0.34875    | 0.34944    |   0.1 |  0.06
Modify  | 321.84     | 341.11     | 359.84     | 100.0 | 63.05
Other   |            | 107.5      |            |       | 19.87

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         684.25 ave        1369 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2737
Ave neighs/atom = 0.54729054
Neighbor list builds = 64
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -100 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.002620154    0              0              0.0078604619   60126.908      0              2.9033132e+09  1.1971759e-13  0              5.0874051    
    200000   12727.922      100            100            0.0022444989   0              0              0.0067334968   77502.599      0              3.7423231e+09  1.1971759e-13  0              3.5738397    
    300000   12727.922      100            100            0.00077276043 -1.9039875e-35  0              0.0023182813   14526.778      0              7.0144611e+08  1.1971759e-13  0              3.1280413    
    400000   12727.922      100            100            0.00039119076  2.1667222e-41  0              0.0011735723   4350.4777      0              2.10069e+08    1.1971759e-13  0              3.0227456    
    500000   12727.922      100            100            0.00012628356 -2.5386474e-35  0              0.00037885067  495.87645      0              23944099       1.1971759e-13  0              3.0064514    
    600000   12727.922      100            100           -6.8854106e-06  5.0773021e-35  0             -2.0656232e-05  1.5312599      0              73939.06       1.1971759e-13  0              3.0007788    
    700000   12727.922      100            100            0.0027107483  -2.7746028e-05  0              0.0081599909   18.926098      0              913873.54      1.1971759e-13  0              2.9979907    
    800000   12727.922      100            100            0.0013148086   0.00027512611  0              0.0036692998   3.2906197      0              158892.25      1.1971759e-13  0              2.9986512    
    900000   12727.922      100            100            0.0016307883   0.00022519939  0              0.0046671656   0.96277309     0              46488.867      1.1971759e-13  0              2.9984886    
   1000000   12727.922      100            100            0.0016996961   0.00023441716  0              0.0048646711   0.052862923    0              2552.5614      1.1971759e-13  0              2.9984538    
   1100000   12727.922      100            100            0.0016236856   0.00022880162  0              0.0046422553   0.00015925814  0              7.6900055      1.1971759e-13  0              2.99849      
   1200000   12727.922      100            100            0.0016536517   0.00022953695  0              0.004731418    0.0013998851   0              67.595439      1.1971759e-13  0              2.9984757    
   1300000   12727.922      100            100            0.0016480387   0.00022954907  0              0.0047145669   0.00032158491  0              15.528184      1.1971759e-13  0              2.9984783    
   1400000   12727.922      100            100            0.0016469715   0.00022954916  0              0.0047113653   1.9147647e-05  0              0.92457134     1.1971759e-13  0              2.9984789    
   1500000   12727.922      100            100            0.0016482913   0.00022954909  0              0.0047153247   1.4641862e-08  0              0.00070700313  1.1971759e-13  0              2.9984782    
   1600000   12727.922      100            100            0.0016477419   0.00022954927  0              0.0047136764   4.2823749e-07  0              0.020678056    1.1971759e-13  0              2.9984785    
   1700000   12727.922      100            100            0.0016478524   0.00022954926  0              0.0047140081   1.0732453e-07  0              0.0051823176   1.1971759e-13  0              2.9984784    
   1800000   12727.922      100            100            0.0016478685   0.00022954925  0              0.0047140563   7.0276175e-09  0              0.0003393385   1.1971759e-13  0              2.9984784    
   1900000   12727.922      100            100            0.0016478451   0.00022954926  0              0.0047139862   2.8733417e-14  0              1.3874339e-09  1.1971759e-13  0              2.9984784    
   2000000   12727.922      100            100            0.0016478553   0.00022954925  0              0.0047140165   1.3011077e-10  0              6.2825836e-06  1.1971759e-13  0              2.9984784    
   2100000   12727.922      100            100            0.0016478531   0.00022954925  0              0.00471401     3.5667431e-11  0              1.7222526e-06  1.1971759e-13  0              2.9984784    
   2200000   12727.922      100            100            0.0016478529   0.00022954925  0              0.0047140093   2.5574382e-12  0              1.2348954e-07  1.1971759e-13  0              2.9984784    
   2300000   12727.922      100            100            0.0016478533   0.00022954925  0              0.0047140106   1.1811226e-15  0              5.7032183e-11  1.1971759e-13  0              2.9984784    
   2400000   12727.922      100            100            0.0016478531   0.00022954925  0              0.00471401     3.944939e-14   0              1.9048699e-09  1.1971759e-13  0              2.9984784    
   2500000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   1.1814302e-14  0              5.7047037e-10  1.1971759e-13  0              2.9984784    
   2600000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   8.5462017e-16  0              4.126655e-11   1.1971759e-13  0              2.9984784    
   2700000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   4.7564255e-19  0              2.2967076e-14  1.1971759e-13  0              2.9984784    
   2800000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   2.2689956e-17  0              1.0956168e-12  1.1971759e-13  0              2.9984784    
   2900000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   7.4846948e-18  0              3.6140913e-13  1.1971759e-13  0              2.9984784    
   3000000   12727.922      100            100            0.0016478531   0.00022954925  0              0.0047140101   1.529718e-18   0              7.3864607e-14  1.1971759e-13  0              2.9984784    
Loop time of 534.481 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4849565.240 ns/day, 0.000 hours/ns, 5612.923 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.93      | 75.543     | 128.91     | 599.4 | 14.13
Neigh   | 0.81652    | 0.82941    | 0.84196    |   1.1 |  0.16
Comm    | 11.765     | 17.454     | 21.297     |  94.0 |  3.27
Output  | 0.34338    | 0.34402    | 0.34468    |   0.1 |  0.06
Modify  | 319.15     | 334.58     | 350.09     |  80.7 | 62.60
Other   |            | 105.7      |            |       | 19.78

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         684.75 ave        1370 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2739
Ave neighs/atom = 0.54769046
Neighbor list builds = 70
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -150 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0038562963   0              0              0.011568889    135285.54      0              6.5324547e+09  1.1971759e-13  0              4.6311076    
    200000   12727.922      100            100           -0.00043598845 -1.269325e-35   0             -0.0013079654   5778.6735      0              2.7903146e+08  1.1971759e-13  0              3.3187243    
    300000   12727.922      100            100            0.0010591191   1.0154608e-34  0              0.0031773572   27123.433      0              1.3096935e+09  1.1971759e-13  0              3.013367     
    400000   12727.922      100            100           -0.00037098795  7.3230761e-42  0             -0.0011129639   5133.4371      0              2.478753e+08   1.1971759e-13  0              3.0047017    
    500000   12727.922      100            100            0.010988597    0.00084162179  0              0.032124168    552.94007      0              26699497       1.1971759e-13  0              2.9960535    
    600000   12727.922      100            100            0.00051192668  7.8056308e-05  0              0.0014577237   122.66564      0              5923084.8      1.1971759e-13  0              2.9990985    
    700000   12727.922      100            100            0.0014595293   0.00034842665  0              0.0040301612   3.4390351      0              166058.7       1.1971759e-13  0              2.9985978    
    800000   12727.922      100            100            0.0028694222   0.00020924886  0              0.0083990179   0.022435395    0              1083.3249      1.1971759e-13  0              2.9979708    
    900000   12727.922      100            100            0.0023405716   0.00040092977  0              0.0066207852   0.058157077    0              2808.1971      1.1971759e-13  0              2.9981971    
   1000000   12727.922      100            100            0.002531032    0.00037346494  0              0.007219631    0.023917128    0              1154.8725      1.1971759e-13  0              2.9981184    
   1100000   12727.922      100            100            0.0024682254   0.00037911436  0              0.0070255619   0.0060253853   0              290.94429      1.1971759e-13  0              2.9981434    
   1200000   12727.922      100            100            0.002486487    0.00037765087  0              0.0070818101   0.001187164    0              57.323901      1.1971759e-13  0              2.9981362    
   1300000   12727.922      100            100            0.0024819923   0.00037799254  0              0.0070679845   0.00019597026  0              9.4627024      1.1971759e-13  0              2.9981379    
   1400000   12727.922      100            100            0.0024827231   0.00037794187  0              0.0070702275   2.8121121e-05  0              1.3578683      1.1971759e-13  0              2.9981377    
   1500000   12727.922      100            100            0.0024828106   0.00037793145  0              0.0070705004   3.5357573e-06  0              0.17072907     1.1971759e-13  0              2.9981376    
   1600000   12727.922      100            100            0.0024826499   0.00037794568  0              0.0070700041   3.856626e-07   0              0.018622267    1.1971759e-13  0              2.9981377    
   1700000   12727.922      100            100            0.0024827523   0.00037793697  0              0.0070703201   3.5232397e-08  0              0.0017012463   1.1971759e-13  0              2.9981376    
   1800000   12727.922      100            100            0.0024827012   0.00037794124  0              0.0070701624   2.4624581e-09  0              0.00011890329  1.1971759e-13  0              2.9981377    
   1900000   12727.922      100            100            0.0024827237   0.00037793938  0              0.0070702318   9.8912629e-11  0              4.7761369e-06  1.1971759e-13  0              2.9981376    
   2000000   12727.922      100            100            0.0024827146   0.00037794013  0              0.0070702038   1.3956836e-13  0              6.7392565e-09  1.1971759e-13  0              2.9981377    
   2100000   12727.922      100            100            0.0024827181   0.00037793985  0              0.0070702143   1.1589101e-12  0              5.5959619e-08  1.1971759e-13  0              2.9981376    
   2200000   12727.922      100            100            0.0024827169   0.00037793994  0              0.0070702106   6.6547325e-13  0              3.2133322e-08  1.1971759e-13  0              2.9981376    
   2300000   12727.922      100            100            0.0024827172   0.00037793991  0              0.0070702118   1.8883172e-13  0              9.1180079e-09  1.1971759e-13  0              2.9981376    
   2400000   12727.922      100            100            0.0024827171   0.00037793992  0              0.0070702115   3.974281e-14   0              1.919038e-09   1.1971759e-13  0              2.9981376    
   2500000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702116   6.8302658e-15  0              3.2980909e-10  1.1971759e-13  0              2.9981376    
   2600000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702115   1.0171386e-15  0              4.9113984e-11  1.1971759e-13  0              2.9981376    
   2700000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702116   1.3993891e-16  0              6.757149e-12   1.1971759e-13  0              2.9981376    
   2800000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702115   9.8557686e-18  0              4.7589979e-13  1.1971759e-13  0              2.9981376    
   2900000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702115   3.6152306e-18  0              1.7456655e-13  1.1971759e-13  0              2.9981376    
   3000000   12727.922      100            100            0.0024827172   0.00037793992  0              0.0070702115   3.2675532e-18  0              1.5777845e-13  1.1971759e-13  0              2.9981376    
Loop time of 541.716 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4784795.678 ns/day, 0.000 hours/ns, 5537.958 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.697     | 76.901     | 135.07     | 615.0 | 14.20
Neigh   | 0.9034     | 0.91571    | 0.92758    |   1.1 |  0.17
Comm    | 12.03      | 19.567     | 28.947     | 150.2 |  3.61
Output  | 0.34336    | 0.34402    | 0.34472    |   0.1 |  0.06
Modify  | 328.71     | 338.93     | 349.13     |  52.5 | 62.57
Other   |            | 105.1      |            |       | 19.39

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         684.75 ave        1370 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2739
Ave neighs/atom = 0.54769046
Neighbor list builds = 78
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -200 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0050431489   0              0              0.015129447    240507.63      0              1.1613253e+10  1.1971759e-13  0              4.1748102    
    200000   12727.922      100            100            0.0016134309   3.8079761e-35  0              0.0048402928   50374.402      0              2.4323996e+09  1.1971759e-13  0              3.2540431    
    300000   12727.922      100            100            0.00093056522  4.9696145e-44  0              0.0027916957   21362.121      0              1.0315004e+09  1.1971759e-13  0              3.0313145    
    400000   12727.922      100            100            0.00086169875 -3.0376609e-05  0              0.0026154729   7311.0161      0              3.530228e+08   1.1971759e-13  0              2.9992673    
    500000   12727.922      100            100            0.0044493733   0.00048383755  0              0.012864282    1460.8361      0              70538545       1.1971759e-13  0              2.9974292    
    600000   12727.922      100            100            0.0066370055   0.00055054619  0              0.01936047     42.375774      0              2046174.5      1.1971759e-13  0              2.9969099    
    700000   12727.922      100            100            0.0031225736  -0.00040521429  0              0.009772935    30.803192      0              1487375.9      1.1971759e-13  0              2.9978007    
    800000   12727.922      100            100            0.0027366921   5.7838666e-05  0              0.0081522377   0.073754863    0              3561.3584      1.1971759e-13  0              2.998001     
    900000   12727.922      100            100            0.0032006746  -8.2012271e-05  0              0.0096840359   0.41410228     0              19995.517      1.1971759e-13  0              2.9978221    
   1000000   12727.922      100            100            0.0031502326  -7.0404254e-05  0              0.009521102    0.053801203    0              2597.8676      1.1971759e-13  0              2.9978388    
   1100000   12727.922      100            100            0.0030979492  -6.7500104e-05  0              0.0093613476   0.00019712839  0              9.5186247      1.1971759e-13  0              2.9978574    
   1200000   12727.922      100            100            0.0031211866  -6.9977045e-05  0              0.0094335367   0.0012657201   0              61.117095      1.1971759e-13  0              2.9978493    
   1300000   12727.922      100            100            0.0031208445  -6.9872583e-05  0              0.0094324061   8.7344406e-05  0              4.2175488      1.1971759e-13  0              2.9978493    
   1400000   12727.922      100            100            0.003117853   -6.9459291e-05  0              0.0094230183   3.3780118e-06  0              0.1631121      1.1971759e-13  0              2.9978504    
   1500000   12727.922      100            100            0.0031188516  -6.9590201e-05  0              0.0094261449   3.3949485e-06  0              0.16392991     1.1971759e-13  0              2.99785      
   1600000   12727.922      100            100            0.003118939   -6.960368e-05   0              0.0094264207   1.1271457e-07  0              0.0054425832   1.1971759e-13  0              2.99785      
   1700000   12727.922      100            100            0.0031187767  -6.9581601e-05  0              0.0094259116   2.0211074e-08  0              0.00097592044  1.1971759e-13  0              2.9978501    
   1800000   12727.922      100            100            0.0031188163  -6.9586773e-05  0              0.0094260357   8.1564055e-09  0              0.00039384363  1.1971759e-13  0              2.99785      
   1900000   12727.922      100            100            0.0031188257  -6.958811e-05   0              0.0094260651   8.8982632e-11  0              4.2966528e-06  1.1971759e-13  0              2.99785      
   2000000   12727.922      100            100            0.0031188173  -6.9586988e-05  0              0.009426039    8.451265e-11   0              4.0808134e-06  1.1971759e-13  0              2.99785      
   2100000   12727.922      100            100            0.0031188187  -6.9587163e-05  0              0.0094260433   1.7507866e-11  0              8.4539221e-07  1.1971759e-13  0              2.99785      
   2200000   12727.922      100            100            0.0031188194  -6.9587259e-05  0              0.0094260455   7.2463809e-15  0              3.499018e-10   1.1971759e-13  0              2.99785      
   2300000   12727.922      100            100            0.003118819   -6.9587205e-05  0              0.0094260442   2.8885547e-13  0              1.3947797e-08  1.1971759e-13  0              2.99785      
   2400000   12727.922      100            100            0.003118819   -6.9587209e-05  0              0.0094260443   3.2845591e-14  0              1.5859961e-09  1.1971759e-13  0              2.99785      
   2500000   12727.922      100            100            0.0031188191  -6.9587215e-05  0              0.0094260445   2.2402372e-16  0              1.0817304e-11  1.1971759e-13  0              2.99785      
   2600000   12727.922      100            100            0.0031188191  -6.9587213e-05  0              0.0094260444   8.4802078e-16  0              4.0947888e-11  1.1971759e-13  0              2.99785      
   2700000   12727.922      100            100            0.0031188191  -6.9587213e-05  0              0.0094260444   7.1924245e-17  0              3.4729644e-12  1.1971759e-13  0              2.99785      
   2800000   12727.922      100            100            0.0031188191  -6.9587213e-05  0              0.0094260444   2.8764502e-18  0              1.3889348e-13  1.1971759e-13  0              2.99785      
   2900000   12727.922      100            100            0.0031188191  -6.9587213e-05  0              0.0094260444   1.666506e-19   0              8.046961e-15   1.1971759e-13  0              2.99785      
   3000000   12727.922      100            100            0.0031188191  -6.9587212e-05  0              0.0094260444   2.1314691e-21  0              1.0292101e-16  1.1971759e-13  0              2.99785      
Loop time of 530.423 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4886670.082 ns/day, 0.000 hours/ns, 5655.868 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.482     | 75.407     | 129.35     | 606.6 | 14.22
Neigh   | 0.99587    | 1.012      | 1.0277     |   1.2 |  0.19
Comm    | 12.324     | 17.699     | 21.641     |  93.1 |  3.34
Output  | 0.34367    | 0.34432    | 0.34499    |   0.1 |  0.06
Modify  | 317.25     | 331.17     | 344.29     |  72.0 | 62.43
Other   |            | 104.8      |            |       | 19.76

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 86
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -250 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0061807118   0              0              0.018542135    375793.17      0              1.8145707e+10  1.1971759e-13  0              3.7185127    
    200000   12727.922      100            100           -0.0012425071   1.0154639e-34  0             -0.0037275214   92687.466      0              4.475546e+09   1.1971759e-13  0              3.0712859    
    300000   12727.922      100            100            0.00036370853  1.0154616e-34  0              0.0010911256   3697.419       0              1.7853513e+08  1.1971759e-13  0              3.0651436    
    400000   12727.922      100            100           -0.000153759    3.2795042e-40  0             -0.00046127701  804.44624      0              38843830       1.1971759e-13  0              3.0124871    
    500000   12727.922      100            100            0.00015329098  2.5386512e-35  0              0.00045987295  727.70987      0              35138505       1.1971759e-13  0              3.0001249    
    600000   12727.922      100            100            0.0022946167   0.00022787607  0              0.0066559739   157.55588      0              7607809.5      1.1971759e-13  0              2.9982218    
    700000   12727.922      100            100            0.0030272645   0.00046213286  0              0.0086196605   6.7148767      0              324237.36      1.1971759e-13  0              2.9979491    
    800000   12727.922      100            100            0.0035347599  -7.3977927e-06  0              0.010611678    1.0629216      0              51324.679      1.1971759e-13  0              2.9977208    
    900000   12727.922      100            100            0.0038488827   0.00017012176  0              0.011376526    0.196788       0              9502.1882      1.1971759e-13  0              2.9976391    
   1000000   12727.922      100            100            0.0039418011   0.00017899472  0              0.011646409    0.035230561    0              1701.1577      1.1971759e-13  0              2.9976108    
   1100000   12727.922      100            100            0.0039715428   0.00017673014  0              0.011737898    0.0059712328   0              288.32946      1.1971759e-13  0              2.9976012    
   1200000   12727.922      100            100            0.0039815113   0.00017656951  0              0.011767965    0.00096311388  0              46.505322      1.1971759e-13  0              2.9975981    
   1300000   12727.922      100            100            0.0039846832   0.00017651514  0              0.011777534    0.00014902506  0              7.1958868      1.1971759e-13  0              2.9975971    
   1400000   12727.922      100            100            0.0039856519   0.00017649808  0              0.011780458    2.2244828e-05  0              1.0741231      1.1971759e-13  0              2.9975968    
   1500000   12727.922      100            100            0.0039859306   0.00017649307  0              0.011781299    3.2147605e-06  0              0.15522928     1.1971759e-13  0              2.9975967    
   1600000   12727.922      100            100            0.0039860032   0.00017649172  0              0.011781518    4.507981e-07   0              0.021767427    1.1971759e-13  0              2.9975966    
   1700000   12727.922      100            100            0.0039860186   0.00017649142  0              0.011781564    6.1410414e-08  0              0.0029652891   1.1971759e-13  0              2.9975966    
   1800000   12727.922      100            100            0.00398602     0.00017649138  0              0.011781569    8.1294215e-09  0              0.00039254067  1.1971759e-13  0              2.9975966    
   1900000   12727.922      100            100            0.003986019    0.00017649139  0              0.011781566    1.0452102e-09  0              5.046946e-05   1.1971759e-13  0              2.9975966    
   2000000   12727.922      100            100            0.003986018    0.0001764914   0              0.011781563    1.303353e-10   0              6.2934252e-06  1.1971759e-13  0              2.9975966    
   2100000   12727.922      100            100            0.0039860175   0.00017649141  0              0.011781561    1.5726184e-11  0              7.5936115e-07  1.1971759e-13  0              2.9975966    
   2200000   12727.922      100            100            0.0039860172   0.00017649142  0              0.01178156     1.8270897e-12  0              8.8223624e-08  1.1971759e-13  0              2.9975966    
   2300000   12727.922      100            100            0.0039860171   0.00017649142  0              0.01178156     2.0424149e-13  0              9.8620906e-09  1.1971759e-13  0              2.9975966    
   2400000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     2.1554457e-14  0              1.0407876e-09  1.1971759e-13  0              2.9975966    
   2500000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     2.1157285e-15  0              1.0216096e-10  1.1971759e-13  0              2.9975966    
   2600000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     1.8676266e-16  0              9.0181006e-12  1.1971759e-13  0              2.9975966    
   2700000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     2.7233089e-17  0              1.3149884e-12  1.1971759e-13  0              2.9975966    
   2800000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     1.2785052e-18  0              6.1734442e-14  1.1971759e-13  0              2.9975966    
   2900000   12727.922      100            100            0.003986017    0.00017649142  0              0.01178156     2.6480852e-18  0              1.2786656e-13  1.1971759e-13  0              2.9975966    
   3000000   12727.922      100            100            0.003986017    0.00017649141  0              0.01178156     1.6474086e-18  0              7.9547468e-14  1.1971759e-13  0              2.9975966    
Loop time of 542.353 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4779175.949 ns/day, 0.000 hours/ns, 5531.454 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.918     | 76.465     | 131.59     | 607.4 | 14.10
Neigh   | 1.0931     | 1.109      | 1.1244     |   1.2 |  0.20
Comm    | 12.279     | 17.723     | 22.613     | 103.2 |  3.27
Output  | 0.34866    | 0.34932    | 0.35002    |   0.1 |  0.06
Modify  | 324.6      | 339.45     | 355.98     |  76.5 | 62.59
Other   |            | 107.3      |            |       | 19.78

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 94
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -300 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0072689849   0              0              0.021806955    541142.17      0              2.6129819e+10  1.1971759e-13  0              3.2622153    
    200000   12727.922      100            100           -0.0001582356   1.2693252e-35  0             -0.0004747068   726.86974      0              35097939       1.1971759e-13  0              3.2503984    
    300000   12727.922      100            100           -0.00050117568  5.0773009e-35  0             -0.001503527    9615.2558      0              4.6428629e+08  1.1971759e-13  0              3.043194     
    400000   12727.922      100            100            0.00015207026 -2.0309176e-34  0              0.00045621077  711.19308      0              34340969       1.1971759e-13  0              3.0120742    
    500000   12727.922      100            100            0.0077264996   0.00050428547  0              0.022675213    1538.2836      0              74278210       1.1971759e-13  0              2.9967149    
    600000   12727.922      100            100            0.0026244787   0.00020632784  0              0.0076671081   132.47942      0              6396957.2      1.1971759e-13  0              2.9980853    
    700000   12727.922      100            100            0.0053539506   0.00038756972  0              0.015674282    27.139033      0              1310446.8      1.1971759e-13  0              2.99722      
    800000   12727.922      100            100            0.0048961803   0.00018889561  0              0.014499645    4.0614118      0              196111.04      1.1971759e-13  0              2.9973367    
    900000   12727.922      100            100            0.0046542509   0.00028653742  0              0.013676215    0.16044057     0              7747.1008      1.1971759e-13  0              2.9974098    
   1000000   12727.922      100            100            0.0048731701   0.00028927095  0              0.014330239    0.0038927209   0              187.96556      1.1971759e-13  0              2.9973492    
   1100000   12727.922      100            100            0.0047966582   0.00029097896  0              0.014098996    0.0075728474   0              365.6657       1.1971759e-13  0              2.9973709    
   1200000   12727.922      100            100            0.0048070031   0.00029073822  0              0.014130271    0.0013401311   0              64.710136      1.1971759e-13  0              2.9973678    
   1300000   12727.922      100            100            0.0048119569   0.00029062692  0              0.014145244    5.153387e-05   0              2.4883862      1.1971759e-13  0              2.9973664    
   1400000   12727.922      100            100            0.0048080067   0.00029071984  0              0.0141333      1.5041446e-06  0              0.07262976     1.1971759e-13  0              2.9973675    
   1500000   12727.922      100            100            0.0048093798   0.00029068701  0              0.014137452    2.5629219e-06  0              0.12375432     1.1971759e-13  0              2.9973671    
   1600000   12727.922      100            100            0.0048092029   0.00029069151  0              0.014136917    4.3772904e-07  0              0.021136369    1.1971759e-13  0              2.9973672    
   1700000   12727.922      100            100            0.0048091092   0.00029069362  0              0.014136634    1.5871317e-08  0              0.00076636912  1.1971759e-13  0              2.9973672    
   1800000   12727.922      100            100            0.0048091814   0.00029069192  0              0.014136852    5.8049928e-10  0              2.8030233e-05  1.1971759e-13  0              2.9973672    
   1900000   12727.922      100            100            0.0048091568   0.00029069251  0              0.014136778    8.6576286e-10  0              4.180459e-05   1.1971759e-13  0              2.9973672    
   2000000   12727.922      100            100            0.0048091598   0.00029069244  0              0.014136787    1.4282932e-10  0              6.8967167e-06  1.1971759e-13  0              2.9973672    
   2100000   12727.922      100            100            0.0048091615   0.0002906924   0              0.014136792    4.8715325e-12  0              2.3522887e-07  1.1971759e-13  0              2.9973672    
   2200000   12727.922      100            100            0.0048091602   0.00029069243  0              0.014136788    2.2099248e-13  0              1.0670936e-08  1.1971759e-13  0              2.9973672    
   2300000   12727.922      100            100            0.0048091607   0.00029069242  0              0.01413679     2.9237248e-13  0              1.4117621e-08  1.1971759e-13  0              2.9973672    
   2400000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    4.6467674e-14  0              2.2437577e-09  1.1971759e-13  0              2.9973672    
   2500000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    1.4407506e-15  0              6.9568688e-11  1.1971759e-13  0              2.9973672    
   2600000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    9.4023576e-17  0              4.540062e-12   1.1971759e-13  0              2.9973672    
   2700000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    1.158005e-16   0              5.5915917e-12  1.1971759e-13  0              2.9973672    
   2800000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    1.1026734e-17  0              5.3244152e-13  1.1971759e-13  0              2.9973672    
   2900000   12727.922      100            100            0.0048091606   0.00029069242  0              0.014136789    6.9865752e-18  0              3.3735671e-13  1.1971759e-13  0              2.9973672    
   3000000   12727.922      100            100            0.0048091606   0.00029069241  0              0.014136789    1.3306243e-17  0              6.4251086e-13  1.1971759e-13  0              2.9973672    
Loop time of 556.405 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4658476.625 ns/day, 0.000 hours/ns, 5391.755 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.442     | 77.548     | 134.41     | 614.3 | 13.94
Neigh   | 1.1528     | 1.1701     | 1.1867     |   1.3 |  0.21
Comm    | 12.692     | 18.344     | 23.94      | 105.5 |  3.30
Output  | 0.3459     | 0.34658    | 0.3473     |   0.1 |  0.06
Modify  | 334.14     | 348.76     | 366.05     |  74.6 | 62.68
Other   |            | 110.2      |            |       | 19.81

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 100
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -350 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.001359419    9.3144437e-40  0             -0.004078257    558533.49      0              2.6969583e+10  1.1971759e-13  0              3.1025492    
    200000   12727.922      100            100            0.0013628637   2.093636e-40   0              0.004088591    38167.292      0              1.8429619e+09  1.1971759e-13  0              3.2215713    
    300000   12727.922      100            100            0.0009879218  -1.0154578e-34  0              0.0029637654   23790.504      0              1.1487583e+09  1.1971759e-13  0              3.0292132    
    400000   12727.922      100            100            0.00029785787  6.0927684e-34  0              0.00089357361  2614.4828      0              1.2624402e+08  1.1971759e-13  0              3.0085212    
    500000   12727.922      100            100            0.0017605273   4.7835135e-05  0              0.0052337468   1397.8068      0              67495087       1.1971759e-13  0              2.9984985    
    600000   12727.922      100            100            0.0062162042   0.00041528635  0              0.018233326    240.52535      0              11614108       1.1971759e-13  0              2.9969887    
    700000   12727.922      100            100            0.0052848667   0.00037626938  0              0.015478331    31.533922      0              1522660.2      1.1971759e-13  0              2.9972366    
    800000   12727.922      100            100            0.0051746391   0.00041908071  0              0.015104837    0.89176729     0              43060.251      1.1971759e-13  0              2.997277     
    900000   12727.922      100            100            0.0054508535   0.00035446244  0              0.015998098    0.14616049     0              7057.5668      1.1971759e-13  0              2.9971996    
   1000000   12727.922      100            100            0.0056153315   0.00036607551  0              0.016479919    0.080854401    0              3904.1697      1.1971759e-13  0              2.9971576    
   1100000   12727.922      100            100            0.0056409082   0.00036882637  0              0.016553898    0.0039936154   0              192.83739      1.1971759e-13  0              2.9971509    
   1200000   12727.922      100            100            0.0056291046   0.00036891973  0              0.016518394    0.00016437092  0              7.9368835      1.1971759e-13  0              2.9971538    
   1300000   12727.922      100            100            0.005621036    0.00036896982  0              0.016494138    0.00018724801  0              9.0415363      1.1971759e-13  0              2.9971559    
   1400000   12727.922      100            100            0.0056193704   0.00036897877  0              0.016489132    1.4413429e-05  0              0.69597288     1.1971759e-13  0              2.9971564    
   1500000   12727.922      100            100            0.0056197852   0.00036897684  0              0.016490379    9.6734696e-08  0              0.0046709723   1.1971759e-13  0              2.9971563    
   1600000   12727.922      100            100            0.005620177    0.00036897485  0              0.016491556    4.0583642e-07  0              0.019596388    1.1971759e-13  0              2.9971562    
   1700000   12727.922      100            100            0.0056202793   0.00036897431  0              0.016491864    4.6332063e-08  0              0.0022372095   1.1971759e-13  0              2.9971561    
   1800000   12727.922      100            100            0.0056202678   0.00036897436  0              0.016491829    1.1202577e-12  0              5.4093234e-08  1.1971759e-13  0              2.9971561    
   1900000   12727.922      100            100            0.0056202494   0.00036897446  0              0.016491774    8.1639263e-10  0              3.9420678e-05  1.1971759e-13  0              2.9971562    
   2000000   12727.922      100            100            0.0056202435   0.00036897449  0              0.016491756    1.3632635e-10  0              6.5827114e-06  1.1971759e-13  0              2.9971562    
   2100000   12727.922      100            100            0.0056202436   0.00036897449  0              0.016491756    7.4464035e-13  0              3.5956017e-08  1.1971759e-13  0              2.9971562    
   2200000   12727.922      100            100            0.0056202444   0.00036897448  0              0.016491759    1.4985214e-12  0              7.2358235e-08  1.1971759e-13  0              2.9971562    
   2300000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     3.7283516e-13  0              1.8002875e-08  1.1971759e-13  0              2.9971562    
   2400000   12727.922      100            100            0.0056202448   0.00036897448  0              0.01649176     6.7198933e-15  0              3.244796e-10   1.1971759e-13  0              2.9971562    
   2500000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     2.4915955e-15  0              1.2031023e-10  1.1971759e-13  0              2.9971562    
   2600000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     9.5271012e-16  0              4.6002962e-11  1.1971759e-13  0              2.9971562    
   2700000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     1.0045891e-17  0              4.8508013e-13  1.1971759e-13  0              2.9971562    
   2800000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     8.4596957e-18  0              4.0848843e-13  1.1971759e-13  0              2.9971562    
   2900000   12727.922      100            100            0.0056202447   0.00036897448  0              0.01649176     3.8434851e-18  0              1.8558814e-13  1.1971759e-13  0              2.9971562    
   3000000   12727.922      100            100            0.0056202447   0.00036897449  0              0.01649176     2.4290544e-19  0              1.1729035e-14  1.1971759e-13  0              2.9971562    
Loop time of 536.341 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4832745.047 ns/day, 0.000 hours/ns, 5593.455 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.025     | 75.316     | 128.57     | 600.7 | 14.04
Neigh   | 1.2323     | 1.251      | 1.2691     |   1.3 |  0.23
Comm    | 12.584     | 18.225     | 22.624     | 100.7 |  3.40
Output  | 0.3433     | 0.34394    | 0.34458    |   0.1 |  0.06
Modify  | 319.05     | 334.7      | 349.37     |  80.2 | 62.40
Other   |            | 106.5      |            |       | 19.86

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 106
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -400 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0018856809   1.0154633e-34  0             -0.0056570428   289938.25      0              1.4000081e+10  1.1971759e-13  0              3.4211431    
    200000   12727.922      100            100            0.0029986911   8.6194686e-42  0              0.0089960732   151417.74      0              7.3114206e+09  1.1971759e-13  0              3.0673926    
    300000   12727.922      100            100           -0.00037880921 -5.0772926e-35  0             -0.0011364276   5192.814       0              2.5074241e+08  1.1971759e-13  0              3.0479377    
    400000   12727.922      100            100            0.00029181777  1.3200987e-33  0              0.00087545331  2514.7694      0              1.2142921e+08  1.1971759e-13  0              3.0082145    
    500000   12727.922      100            100           -6.750156e-05   6.0927652e-34  0             -0.00020250468  151.18579      0              7300220.8      1.1971759e-13  0              3.0000743    
    600000   12727.922      100            100            0.0029491344   0.00066336208  0              0.0081840412   9.9473788      0              480323.32      1.1971759e-13  0              2.99799      
    700000   12727.922      100            100            0.0081324624   0.00093893474  0              0.023458453    0.86089203     0              41569.395      1.1971759e-13  0              2.9966061    
    800000   12727.922      100            100            0.0061345756   0.00055279855  0              0.017850928    2.905762       0              140308.85      1.1971759e-13  0              2.9970435    
    900000   12727.922      100            100            0.006474914    0.00068049862  0              0.018744243    0.61533288     0              29712.222      1.1971759e-13  0              2.9969669    
   1000000   12727.922      100            100            0.0065688892   0.00067416227  0              0.019032505    0.026647762    0              1286.725       1.1971759e-13  0              2.9969449    
   1100000   12727.922      100            100            0.0064803246   0.00067367473  0              0.018767299    0.0006133131   0              29.614695      1.1971759e-13  0              2.9969661    
   1200000   12727.922      100            100            0.0065117566   0.00067444601  0              0.018860824    0.0011749596   0              56.734593      1.1971759e-13  0              2.9969584    
   1300000   12727.922      100            100            0.0065081306   0.00067435281  0              0.018850039    0.00018739246  0              9.0485113      1.1971759e-13  0              2.9969594    
   1400000   12727.922      100            100            0.006505697    0.00067429615  0              0.018842795    4.7682058e-06  0              0.23023959     1.1971759e-13  0              2.9969599    
   1500000   12727.922      100            100            0.0065073946   0.00067433691  0              0.018847847    5.760044e-07   0              0.027813191    1.1971759e-13  0              2.9969595    
   1600000   12727.922      100            100            0.0065068791   0.00067432431  0              0.018846313    4.5039801e-07  0              0.021748108    1.1971759e-13  0              2.9969597    
   1700000   12727.922      100            100            0.0065069065   0.00067432508  0              0.018846394    5.3434072e-08  0              0.0025801401   1.1971759e-13  0              2.9969597    
   1800000   12727.922      100            100            0.0065069623   0.00067432639  0              0.018846561    5.9716822e-10  0              2.8835116e-05  1.1971759e-13  0              2.9969596    
   1900000   12727.922      100            100            0.0065069309   0.00067432564  0              0.018846467    3.6082358e-10  0              1.7422879e-05  1.1971759e-13  0              2.9969597    
   2000000   12727.922      100            100            0.006506939    0.00067432584  0              0.018846491    1.6197027e-10  0              7.8209648e-06  1.1971759e-13  0              2.9969597    
   2100000   12727.922      100            100            0.0065069392   0.00067432584  0              0.018846492    1.4160865e-11  0              6.8377748e-07  1.1971759e-13  0              2.9969597    
   2200000   12727.922      100            100            0.006506938    0.00067432581  0              0.018846488    2.39557e-14    0              1.156735e-09   1.1971759e-13  0              2.9969597    
   2300000   12727.922      100            100            0.0065069386   0.00067432582  0              0.01884649     1.858148e-13   0              8.9723316e-09  1.1971759e-13  0              2.9969597    
   2400000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     5.4924527e-14  0              2.6521089e-09  1.1971759e-13  0              2.9969597    
   2500000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     3.3459975e-15  0              1.6156625e-10  1.1971759e-13  0              2.9969597    
   2600000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     6.1023614e-18  0              2.9466119e-13  1.1971759e-13  0              2.9969597    
   2700000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     1.251985e-16   0              6.0453875e-12  1.1971759e-13  0              2.9969597    
   2800000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     7.4399376e-18  0              3.5924796e-13  1.1971759e-13  0              2.9969597    
   2900000   12727.922      100            100            0.0065069385   0.00067432582  0              0.01884649     3.3799507e-18  0              1.6320572e-13  1.1971759e-13  0              2.9969597    
   3000000   12727.922      100            100            0.0065069385   0.00067432581  0              0.01884649     7.6608044e-18  0              3.6991283e-13  1.1971759e-13  0              2.9969597    
Loop time of 531.78 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4874193.984 ns/day, 0.000 hours/ns, 5641.428 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.54      | 74.534     | 126.95     | 597.5 | 14.02
Neigh   | 1.2867     | 1.3064     | 1.3258     |   1.4 |  0.25
Comm    | 12.44      | 18.897     | 23.798     | 113.2 |  3.55
Output  | 0.34501    | 0.34564    | 0.34628    |   0.1 |  0.06
Modify  | 317.3      | 331.55     | 347.06     |  74.1 | 62.35
Other   |            | 105.1      |            |       | 19.77

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 112
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -450 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0017336239   3.0463826e-34  0             -0.0052008718   129175.39      0              6.2374171e+09  1.1971759e-13  0              3.6286628    
    200000   12727.922      100            100           -0.0013362599   3.0463846e-34  0             -0.0040087797   116652.41      0              5.6327273e+09  1.1971759e-13  0              3.085007     
    300000   12727.922      100            100            0.0010266808   7.6159516e-34  0              0.0030800425   25466.067      0              1.2296652e+09  1.1971759e-13  0              3.0296418    
    400000   12727.922      100            100            0.00014481531 -6.346624e-36   0              0.00043444593  647.81415      0              31280627       1.1971759e-13  0              3.0097949    
    500000   12727.922      100            100            0.020766542    0.0017558296   0              0.060543796    270.28144      0              13050923       1.1971759e-13  0              2.9945632    
    600000   12727.922      100            100            0.0034078351   0.00053750701  0              0.0096859982   0.0086332338   0              416.86796      1.1971759e-13  0              2.9978203    
    700000   12727.922      100            100            0.0056874365   0.00043180949  0              0.0166305      0.0008134351   0              39.27787       1.1971759e-13  0              2.9971441    
    800000   12727.922      100            100            0.0069022286   0.0011128502   0              0.019593836    0.58698872     0              28343.585      1.1971759e-13  0              2.9969008    
    900000   12727.922      100            100            0.0072828522   0.0011016746   0              0.020746882    0.31825649     0              15367.467      1.1971759e-13  0              2.9968104    
   1000000   12727.922      100            100            0.0073949328   0.001068322    0              0.021116476    0.076818367    0              3709.284       1.1971759e-13  0              2.9967817    
   1100000   12727.922      100            100            0.0074260784   0.001072273    0              0.021205962    0.011961763    0              577.59072      1.1971759e-13  0              2.9967747    
   1200000   12727.922      100            100            0.0074293169   0.0010722542   0              0.021215696    0.0012784165   0              61.730157      1.1971759e-13  0              2.9967738    
   1300000   12727.922      100            100            0.0074274697   0.0010722624   0              0.021210147    8.4022368e-05  0              4.0571394      1.1971759e-13  0              2.9967742    
   1400000   12727.922      100            100            0.0074258002   0.0010722705   0              0.02120513     1.7200013e-06  0              0.083052707    1.1971759e-13  0              2.9967746    
   1500000   12727.922      100            100            0.0074249334   0.0010722748   0              0.021202526    1.2797786e-07  0              0.0061795927   1.1971759e-13  0              2.9967748    
   1600000   12727.922      100            100            0.007424579    0.0010722766   0              0.02120146     1.7276651e-07  0              0.0083422763   1.1971759e-13  0              2.9967749    
   1700000   12727.922      100            100            0.0074244589   0.0010722772   0              0.021201099    5.2716616e-08  0              0.0025454967   1.1971759e-13  0              2.9967749    
   1800000   12727.922      100            100            0.0074244263   0.0010722773   0              0.021201002    9.5006327e-09  0              0.00045875155  1.1971759e-13  0              2.9967749    
   1900000   12727.922      100            100            0.0074244207   0.0010722774   0              0.021200985    1.1711692e-09  0              5.6551568e-05  1.1971759e-13  0              2.9967749    
   2000000   12727.922      100            100            0.0074244213   0.0010722774   0              0.021200987    9.4966004e-11  0              4.5855685e-06  1.1971759e-13  0              2.9967749    
   2100000   12727.922      100            100            0.0074244225   0.0010722774   0              0.02120099     3.6306834e-12  0              1.7531271e-07  1.1971759e-13  0              2.9967749    
   2200000   12727.922      100            100            0.0074244232   0.0010722774   0              0.021200992    1.5565094e-15  0              7.5158268e-11  1.1971759e-13  0              2.9967749    
   2300000   12727.922      100            100            0.0074244236   0.0010722774   0              0.021200993    8.0432649e-14  0              3.8838047e-09  1.1971759e-13  0              2.9967749    
   2400000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    3.3629021e-14  0              1.6238251e-09  1.1971759e-13  0              2.9967749    
   2500000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    7.1748473e-15  0              3.464477e-10   1.1971759e-13  0              2.9967749    
   2600000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    1.0160689e-15  0              4.9062333e-11  1.1971759e-13  0              2.9967749    
   2700000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    3.251599e-17   0              1.5700808e-12  1.1971759e-13  0              2.9967749    
   2800000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    8.0456827e-19  0              3.8849723e-14  1.1971759e-13  0              2.9967749    
   2900000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    9.645512e-18   0              4.6574726e-13  1.1971759e-13  0              2.9967749    
   3000000   12727.922      100            100            0.0074244237   0.0010722774   0              0.021200994    5.550133e-18   0              2.6799606e-13  1.1971759e-13  0              2.9967749    
Loop time of 531.346 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4878181.643 ns/day, 0.000 hours/ns, 5646.044 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.773     | 75.559     | 127.94     | 599.3 | 14.22
Neigh   | 1.3631     | 1.3829     | 1.4031     |   1.4 |  0.26
Comm    | 12.84      | 18.729     | 23.602     |  95.3 |  3.52
Output  | 0.3447     | 0.34533    | 0.34596    |   0.1 |  0.06
Modify  | 316.6      | 330.94     | 345.22     |  73.6 | 62.28
Other   |            | 104.4      |            |       | 19.65

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 116
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -500 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0011752862   5.0773116e-35  0             -0.0035258586   39567.219      0              1.9105594e+09  1.1971759e-13  0              3.7605843    
    200000   12727.922      100            100           -0.00065600207 -3.0463752e-34  0             -0.0019680062   15570.998      0              7.5186775e+08  1.1971759e-13  0              3.1977911    
    300000   12727.922      100            100           -0.00066852757  1.6983228e-42  0             -0.0020055827   18707.495      0              9.0331797e+08  1.1971759e-13  0              3.032019     
    400000   12727.922      100            100           -0.00012332319  6.0927631e-34  0             -0.00036996958  512.19296      0              24731965       1.1971759e-13  0              3.0091204    
    500000   12727.922      100            100            0.00046849657  1.8114214e-05  0              0.0013873755   695.38055      0              33577438       1.1971759e-13  0              2.999052     
    600000   12727.922      100            100            0.005212783    0.00088459209  0              0.014753757    151.20682      0              7301236.1      1.1971759e-13  0              2.9972917    
    700000   12727.922      100            100            0.0082277353   0.00072663604  0              0.02395657     38.152792      0              1842261.8      1.1971759e-13  0              2.9965787    
    800000   12727.922      100            100            0.0083121745   0.0011316329   0              0.02380489     5.0368423      0              243211.09      1.1971759e-13  0              2.9965794    
    900000   12727.922      100            100            0.0081715326   0.0012148834   0              0.023299714    0.58634187     0              28312.35       1.1971759e-13  0              2.9966196    
   1000000   12727.922      100            100            0.0083029614   0.0012078464   0              0.023701038    0.059670212    0              2881.261       1.1971759e-13  0              2.9965893    
   1100000   12727.922      100            100            0.0082343289   0.0012173368   0              0.02348565     0.0049522831   0              239.12803      1.1971759e-13  0              2.9966052    
   1200000   12727.922      100            100            0.0082666564   0.0012148009   0              0.023585168    0.00030269483  0              14.61605       1.1971759e-13  0              2.9965979    
   1300000   12727.922      100            100            0.0082529869   0.0012155771   0              0.023543384    8.5241021e-06  0              0.41159838     1.1971759e-13  0              2.996601     
   1400000   12727.922      100            100            0.0082583791   0.0012153936   0              0.023559744    6.8123222e-08  0              0.0032894266   1.1971759e-13  0              2.9965998    
   1500000   12727.922      100            100            0.0082563901   0.0012154579   0              0.023553712    3.3517654e-07  0              0.016184475    1.1971759e-13  0              2.9966002    
   1600000   12727.922      100            100            0.0082570806   0.0012154353   0              0.023555807    1.423612e-07   0              0.0068741128   1.1971759e-13  0              2.9966001    
   1700000   12727.922      100            100            0.0082568564   0.0012154425   0              0.023555127    3.6425481e-08  0              0.0017588561   1.1971759e-13  0              2.9966001    
   1800000   12727.922      100            100            0.0082569232   0.0012154404   0              0.023555329    7.2544792e-09  0              0.00035029284  1.1971759e-13  0              2.9966001    
   1900000   12727.922      100            100            0.0082569058   0.001215441    0              0.023555276    1.2239521e-09  0              5.9100266e-05  1.1971759e-13  0              2.9966001    
   2000000   12727.922      100            100            0.0082569092   0.0012154408   0              0.023555287    1.8111632e-10  0              8.7454588e-06  1.1971759e-13  0              2.9966001    
   2100000   12727.922      100            100            0.0082569091   0.0012154408   0              0.023555286    2.3796379e-11  0              1.149042e-06   1.1971759e-13  0              2.9966001    
   2200000   12727.922      100            100            0.0082569087   0.0012154409   0              0.023555285    2.7657467e-12  0              1.3354801e-07  1.1971759e-13  0              2.9966001    
   2300000   12727.922      100            100            0.008256909    0.0012154409   0              0.023555286    2.7862499e-13  0              1.3453803e-08  1.1971759e-13  0              2.9966001    
   2400000   12727.922      100            100            0.0082569088   0.0012154409   0              0.023555286    2.3311128e-14  0              1.125611e-09   1.1971759e-13  0              2.9966001    
   2500000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    1.4828899e-15  0              7.1603446e-11  1.1971759e-13  0              2.9966001    
   2600000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    3.3876153e-17  0              1.6357582e-12  1.1971759e-13  0              2.9966001    
   2700000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    2.6444777e-17  0              1.2769236e-12  1.1971759e-13  0              2.9966001    
   2800000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    4.6983844e-18  0              2.2686817e-13  1.1971759e-13  0              2.9966001    
   2900000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    7.1623023e-18  0              3.4584195e-13  1.1971759e-13  0              2.9966001    
   3000000   12727.922      100            100            0.0082569089   0.0012154409   0              0.023555286    1.4102317e-17  0              6.8095044e-13  1.1971759e-13  0              2.9966001    
Loop time of 534.175 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4852340.568 ns/day, 0.000 hours/ns, 5616.135 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.543     | 75.06      | 127.68     | 604.1 | 14.05
Neigh   | 1.4238     | 1.4455     | 1.4667     |   1.4 |  0.27
Comm    | 12.731     | 18.202     | 23.609     | 103.1 |  3.41
Output  | 0.34322    | 0.34384    | 0.34448    |   0.1 |  0.06
Modify  | 319.98     | 334.01     | 347.05     |  70.8 | 62.53
Other   |            | 105.1      |            |       | 19.68

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -550 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.00034597282  2.2847855e-34  0             -0.0010379184   2565.2535      0              1.2386691e+08  1.1971759e-13  0              3.8376536    
    200000   12727.922      100            100            0.00046962912 -3.046378e-34   0              0.0014088874   5481.896       0              2.6470114e+08  1.1971759e-13  0              3.2239039    
    300000   12727.922      100            100            0.00053976746 -2.0309073e-34  0              0.0016193024   7849.0089      0              3.7900055e+08  1.1971759e-13  0              3.0468774    
    400000   12727.922      100            100           -0.00047734082  1.2693254e-35  0             -0.0014320225   8925.1978      0              4.3096586e+08  1.1971759e-13  0              3.000976     
    500000   12727.922      100            100            0.0018244675   0.00031549235  0              0.00515791     1143.3889      0              55210159       1.1971759e-13  0              2.9985005    
    600000   12727.922      100            100            0.013447107    0.0011303474   0              0.039210974    73.140479      0              3531692        1.1971759e-13  0              2.9956051    
    700000   12727.922      100            100            0.010099355    0.00095080199  0              0.029347262    23.884213      0              1153283.2      1.1971759e-13  0              2.9962095    
    800000   12727.922      100            100            0.0088835204   0.0013906092   0              0.025259952    4.7268875      0              228244.48      1.1971759e-13  0              2.9964815    
    900000   12727.922      100            100            0.008823123    0.0012428622   0              0.025226507    0.03176426     0              1533.7824      1.1971759e-13  0              2.9964815    
   1000000   12727.922      100            100            0.0089921845   0.0012474938   0              0.02572906     0.050634525    0              2444.96        1.1971759e-13  0              2.9964461    
   1100000   12727.922      100            100            0.0090596105   0.001245656    0              0.025933176    0.012213195    0              589.73146      1.1971759e-13  0              2.9964321    
   1200000   12727.922      100            100            0.009062766    0.0012455822   0              0.025942716    0.00012613193  0              6.0904594      1.1971759e-13  0              2.9964316    
   1300000   12727.922      100            100            0.0090548206   0.0012458136   0              0.025918648    0.00011381096  0              5.4955241      1.1971759e-13  0              2.9964333    
   1400000   12727.922      100            100            0.0090514237   0.0012459094   0              0.025908362    3.029889e-05   0              1.463025       1.1971759e-13  0              2.996434     
   1500000   12727.922      100            100            0.0090512212   0.0012459144   0              0.025907749    3.9056887e-07  0              0.018859173    1.1971759e-13  0              2.996434     
   1600000   12727.922      100            100            0.0090516025   0.0012459033   0              0.025908904    2.5686679e-07  0              0.012403178    1.1971759e-13  0              2.9964339    
   1700000   12727.922      100            100            0.0090517725   0.0012458985   0              0.025909419    7.4983361e-08  0              0.0036206781   1.1971759e-13  0              2.9964339    
   1800000   12727.922      100            100            0.0090517849   0.0012458982   0              0.025909456    1.1765391e-09  0              5.681086e-05   1.1971759e-13  0              2.9964339    
   1900000   12727.922      100            100            0.0090517666   0.0012458988   0              0.025909401    5.7654603e-10  0              2.7839344e-05  1.1971759e-13  0              2.9964339    
   2000000   12727.922      100            100            0.0090517581   0.001245899    0              0.025909375    1.8508809e-10  0              8.9372415e-06  1.1971759e-13  0              2.9964339    
   2100000   12727.922      100            100            0.0090517574   0.001245899    0              0.025909373    3.464274e-12   0              1.6727739e-07  1.1971759e-13  0              2.9964339    
   2200000   12727.922      100            100            0.0090517583   0.001245899    0              0.025909376    1.2859024e-12  0              6.2091623e-08  1.1971759e-13  0              2.9964339    
   2300000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    4.5557981e-13  0              2.1998319e-08  1.1971759e-13  0              2.9964339    
   2400000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    9.9152566e-15  0              4.7877226e-10  1.1971759e-13  0              2.9964339    
   2500000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    2.7611018e-15  0              1.3332372e-10  1.1971759e-13  0              2.9964339    
   2600000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    1.1128866e-15  0              5.373731e-11   1.1971759e-13  0              2.9964339    
   2700000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    1.0221284e-16  0              4.935492e-12   1.1971759e-13  0              2.9964339    
   2800000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    2.4306469e-18  0              1.1736724e-13  1.1971759e-13  0              2.9964339    
   2900000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    1.0494367e-17  0              5.0673541e-13  1.1971759e-13  0              2.9964339    
   3000000   12727.922      100            100            0.0090517587   0.001245899    0              0.025909377    8.4537713e-18  0              4.0820236e-13  1.1971759e-13  0              2.9964339    
Loop time of 533.098 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4862146.833 ns/day, 0.000 hours/ns, 5627.485 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.414     | 74.787     | 126.87     | 599.6 | 14.03
Neigh   | 1.4296     | 1.453      | 1.4757     |   1.5 |  0.27
Comm    | 12.572     | 18.4       | 23.957     | 100.6 |  3.45
Output  | 0.34353    | 0.34416    | 0.34479    |   0.1 |  0.06
Modify  | 318.71     | 333.48     | 348.45     |  75.6 | 62.55
Other   |            | 104.6      |            |       | 19.63

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -600 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.00067977834  1.0154613e-34  0              0.002039335    7955.2865      0              3.8413231e+08  1.1971759e-13  0              3.8729513    
    200000   12727.922      100            100            0.0018849339   1.015461e-34   0              0.0056548018   67731.556      0              3.2705144e+09  1.1971759e-13  0              3.1820594    
    300000   12727.922      100            100            0.11090537     0.00023177108  0              0.33248433     15795.12       0              7.6268983e+08  1.1971759e-13  0              2.9871685    
    400000   12727.922      100            100            0.035894715   -0.0011468341   0              0.10883098     8357.26        0              4.0354217e+08  1.1971759e-13  0              2.9927496    
    500000   12727.922      100            100            0.019706281    0.0017987503   0              0.057320093    1386.0966      0              66929643       1.1971759e-13  0              2.9947274    
    600000   12727.922      100            100            0.0074205672   0.0011908322   0              0.021070869    229.90605      0              11101340       1.1971759e-13  0              2.9968044    
    700000   12727.922      100            100            0.010563236    0.0011527382   0              0.030536969    35.149891      0              1697262.4      1.1971759e-13  0              2.9961342    
    800000   12727.922      100            100            0.010517884    0.0012656838   0              0.030287968    0.0027438556   0              132.49097      1.1971759e-13  0              2.9961436    
    900000   12727.922      100            100            0.0099186484   0.0012203693   0              0.028535576    0.64673742     0              31228.636      1.1971759e-13  0              2.9962562    
   1000000   12727.922      100            100            0.009768737    0.0012299962   0              0.028076215    0.053438263    0              2580.3425      1.1971759e-13  0              2.9962871    
   1100000   12727.922      100            100            0.0097992497   0.0012270232   0              0.028170726    0.0015534933   0              75.012633      1.1971759e-13  0              2.9962812    
   1200000   12727.922      100            100            0.0098287338   0.0012251059   0              0.028261096    0.0018309443   0              88.409749      1.1971759e-13  0              2.9962752    
   1300000   12727.922      100            100            0.0098333504   0.001224957    0              0.028275094    5.3552714e-05  0              2.5858689      1.1971759e-13  0              2.9962742    
   1400000   12727.922      100            100            0.0098306969   0.0012250364   0              0.028267054    1.2951534e-05  0              0.62538324     1.1971759e-13  0              2.9962747    
   1500000   12727.922      100            100            0.0098292936   0.0012250802   0              0.028262801    4.1860598e-06  0              0.20212985     1.1971759e-13  0              2.996275     
   1600000   12727.922      100            100            0.0098292366   0.0012250823   0              0.028262628    1.4231848e-08  0              0.00068720503  1.1971759e-13  0              2.996275     
   1700000   12727.922      100            100            0.0098294086   0.001225077    0              0.028263149    5.7641035e-08  0              0.0027832793   1.1971759e-13  0              2.996275     
   1800000   12727.922      100            100            0.009829467    0.0012250752   0              0.028263326    7.5456986e-09  0              0.00036435478  1.1971759e-13  0              2.996275     
   1900000   12727.922      100            100            0.0098294611   0.0012250754   0              0.028263308    4.4612393e-11  0              2.1541728e-06  1.1971759e-13  0              2.996275     
   2000000   12727.922      100            100            0.0098294515   0.0012250756   0              0.028263279    1.8652154e-10  0              9.0064577e-06  1.1971759e-13  0              2.996275     
   2100000   12727.922      100            100            0.0098294495   0.0012250757   0              0.028263273    9.7941128e-12  0              4.7292266e-07  1.1971759e-13  0              2.996275     
   2200000   12727.922      100            100            0.0098294502   0.0012250757   0              0.028263275    8.3566712e-13  0              4.0351374e-08  1.1971759e-13  0              2.996275     
   2300000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    4.7733154e-13  0              2.3048632e-08  1.1971759e-13  0              2.996275     
   2400000   12727.922      100            100            0.0098294507   0.0012250757   0              0.028263276    6.4316397e-15  0              3.1056086e-10  1.1971759e-13  0              2.996275     
   2500000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    4.8977924e-15  0              2.3649686e-10  1.1971759e-13  0              2.996275     
   2600000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    9.8980817e-16  0              4.7794294e-11  1.1971759e-13  0              2.996275     
   2700000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    3.8825166e-17  0              1.8747283e-12  1.1971759e-13  0              2.996275     
   2800000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    1.248867e-17   0              6.030332e-13   1.1971759e-13  0              2.996275     
   2900000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    4.244938e-20   0              2.0497286e-15  1.1971759e-13  0              2.996275     
   3000000   12727.922      100            100            0.0098294506   0.0012250757   0              0.028263276    1.5800572e-18  0              7.6295305e-14  1.1971759e-13  0              2.996275     
Loop time of 530.458 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4886347.057 ns/day, 0.000 hours/ns, 5655.494 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.245     | 75.196     | 127.79     | 605.7 | 14.18
Neigh   | 1.5216     | 1.5457     | 1.5694     |   1.5 |  0.29
Comm    | 12.721     | 18.942     | 24.558     | 100.4 |  3.57
Output  | 0.34521    | 0.34583    | 0.34644    |   0.1 |  0.07
Modify  | 315.33     | 329.41     | 342.94     |  71.8 | 62.10
Other   |            | 105        |            |       | 19.80

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -650 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0018573555  -2.0309198e-34  0              0.0055720664   49737.897      0              2.401665e+09   1.1971759e-13  0              3.8752252    
    200000   12727.922      100            100            0.0034940965   1.0154604e-34  0              0.010482289    191202.72      0              9.2324951e+09  1.1971759e-13  0              3.084971     
    300000   12727.922      100            100           -0.0003124159  -2.0309083e-34  0             -0.00093724771  3441.6313      0              1.6618406e+08  1.1971759e-13  0              3.0461427    
    400000   12727.922      100            100            0.00028268309  1.015466e-34   0              0.00084804928  2369.3289      0              1.1440641e+08  1.1971759e-13  0              3.0069608    
    500000   12727.922      100            100            0.026870823    0.0018510813   0              0.078761389    174.42596      0              8422405.2      1.1971759e-13  0              2.9937764    
    600000   12727.922      100            100            0.012687478    0.0017422838   0              0.036320151    283.1975       0              13674594       1.1971759e-13  0              2.9957613    
    700000   12727.922      100            100            0.0097600125   0.0017934825   0              0.027486555    29.60468       0              1429504.1      1.1971759e-13  0              2.9963327    
    800000   12727.922      100            100            0.011036121    0.0016315894   0              0.031476775    4.8370518      0              233563.92      1.1971759e-13  0              2.9960664    
    900000   12727.922      100            100            0.010655368    0.0015412104   0              0.030424893    0.7344794      0              35465.382      1.1971759e-13  0              2.9961358    
   1000000   12727.922      100            100            0.010724788    0.0015398962   0              0.030634468    0.10540317     0              5089.5418      1.1971759e-13  0              2.9961213    
   1100000   12727.922      100            100            0.010726577    0.0015512413   0              0.030628491    0.014101204    0              680.8967       1.1971759e-13  0              2.9961221    
   1200000   12727.922      100            100            0.010719224    0.0015513357   0              0.030606337    0.0017737517   0              85.648121      1.1971759e-13  0              2.9961234    
   1300000   12727.922      100            100            0.010724797    0.0015512575   0              0.030623133    0.00020904485  0              10.094028      1.1971759e-13  0              2.9961224    
   1400000   12727.922      100            100            0.010721763    0.0015513005   0              0.030613989    2.2850183e-05  0              1.1033536      1.1971759e-13  0              2.9961229    
   1500000   12727.922      100            100            0.010723206    0.0015512795   0              0.030618338    2.2769235e-06  0              0.10994449     1.1971759e-13  0              2.9961226    
   1600000   12727.922      100            100            0.010722572    0.0015512888   0              0.030616426    1.9997829e-07  0              0.0096562357   1.1971759e-13  0              2.9961228    
   1700000   12727.922      100            100            0.010722836    0.0015512849   0              0.030617222    1.442941e-08   0              0.00069674457  1.1971759e-13  0              2.9961227    
   1800000   12727.922      100            100            0.01072273     0.0015512864   0              0.030616904    7.0941209e-10  0              3.4254971e-05  1.1971759e-13  0              2.9961227    
   1900000   12727.922      100            100            0.010722771    0.0015512858   0              0.030617027    9.5250082e-12  0              4.5992856e-07  1.1971759e-13  0              2.9961227    
   2000000   12727.922      100            100            0.010722756    0.0015512861   0              0.030616981    1.8292389e-12  0              8.8327402e-08  1.1971759e-13  0              2.9961227    
   2100000   12727.922      100            100            0.010722761    0.001551286    0              0.030616998    1.9404554e-12  0              9.3697645e-08  1.1971759e-13  0              2.9961227    
   2200000   12727.922      100            100            0.010722759    0.001551286    0              0.030616992    6.8004832e-13  0              3.28371e-08    1.1971759e-13  0              2.9961227    
   2300000   12727.922      100            100            0.01072276     0.001551286    0              0.030616994    1.6727428e-13  0              8.0770764e-09  1.1971759e-13  0              2.9961227    
   2400000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    3.4065829e-14  0              1.644917e-09   1.1971759e-13  0              2.9961227    
   2500000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    6.0054141e-15  0              2.8997995e-10  1.1971759e-13  0              2.9961227    
   2600000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    1.0195038e-15  0              4.922819e-11   1.1971759e-13  0              2.9961227    
   2700000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    1.5765207e-16  0              7.6124542e-12  1.1971759e-13  0              2.9961227    
   2800000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    6.7878146e-18  0              3.2775927e-13  1.1971759e-13  0              2.9961227    
   2900000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    2.2136846e-18  0              1.068909e-13   1.1971759e-13  0              2.9961227    
   3000000   12727.922      100            100            0.01072276     0.001551286    0              0.030616993    2.3418652e-18  0              1.1308029e-13  1.1971759e-13  0              2.9961227    
Loop time of 538.21 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4815965.725 ns/day, 0.000 hours/ns, 5574.034 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.47      | 74.673     | 127.23     | 601.7 | 13.87
Neigh   | 1.5622     | 1.5869     | 1.6104     |   1.5 |  0.29
Comm    | 12.574     | 18.873     | 24.127     | 112.0 |  3.51
Output  | 0.34391    | 0.34457    | 0.34522    |   0.1 |  0.06
Modify  | 321.63     | 336.19     | 353.22     |  75.2 | 62.46
Other   |            | 106.5      |            |       | 19.80

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -700 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.003158144    2.0309237e-34  0              0.0094744321   124209.72      0              5.9976431e+09  1.1971759e-13  0              3.8506092    
    200000   12727.922      100            100            0.032978649    0.0041036931   0              0.094832253    298525.5       0              1.4414728e+10  1.1971759e-13  0              2.9930213    
    300000   12727.922      100            100            0.00098230087 -5.0772901e-35  0              0.0029469026   23490.388      0              1.1342668e+09  1.1971759e-13  0              3.0346006    
    400000   12727.922      100            100           -0.00036084572 -3.1733122e-36  0             -0.0010825372   4831.419       0              2.3329193e+08  1.1971759e-13  0              3.0045683    
    500000   12727.922      100            100            0.021656403    0.0026175762   0              0.062351632    1587.0789      0              76634359       1.1971759e-13  0              2.9944413    
    600000   12727.922      100            100            0.0072753654   0.0015141135   0              0.020311983    93.760168      0              4527343        1.1971759e-13  0              2.9968559    
    700000   12727.922      100            100            0.010024905    0.0017142444   0              0.028360471    16.97307       0              819568.82      1.1971759e-13  0              2.996264     
    800000   12727.922      100            100            0.011684428    0.0019059498   0              0.033147336    6.0517486      0              292217.28      1.1971759e-13  0              2.9959633    
    900000   12727.922      100            100            0.011828905    0.0018289839   0              0.033657731    0.20576303     0              9935.5605      1.1971759e-13  0              2.9959344    
   1000000   12727.922      100            100            0.011692836    0.0018404774   0              0.033238032    0.018573168    0              896.83181      1.1971759e-13  0              2.9959604    
   1100000   12727.922      100            100            0.011611857    0.001842464    0              0.032993106    0.014217243    0              686.49977      1.1971759e-13  0              2.9959753    
   1200000   12727.922      100            100            0.011595696    0.0018426599   0              0.032944427    0.001090787    0              52.670202      1.1971759e-13  0              2.9959782    
   1300000   12727.922      100            100            0.011599582    0.0018425218   0              0.032956224    3.1107809e-06  0              0.15020847     1.1971759e-13  0              2.9959774    
   1400000   12727.922      100            100            0.011603457    0.001842506    0              0.032967864    2.7078015e-05  0              1.3075004      1.1971759e-13  0              2.9959767    
   1500000   12727.922      100            100            0.011604603    0.0018425018   0              0.032971308    4.0445736e-06  0              0.19529799     1.1971759e-13  0              2.9959765    
   1600000   12727.922      100            100            0.011604577    0.001842502    0              0.03297123     2.8607623e-08  0              0.0013813597   1.1971759e-13  0              2.9959765    
   1700000   12727.922      100            100            0.011604412    0.0018425026   0              0.032970733    3.8954503e-08  0              0.0018809735   1.1971759e-13  0              2.9959765    
   1800000   12727.922      100            100            0.011604344    0.0018425028   0              0.032970529    1.1668399e-08  0              0.00056342523  1.1971759e-13  0              2.9959765    
   1900000   12727.922      100            100            0.011604337    0.0018425029   0              0.032970508    4.0520338e-10  0              1.9565821e-05  1.1971759e-13  0              2.9959765    
   2000000   12727.922      100            100            0.011604343    0.0018425028   0              0.032970526    3.3983988e-11  0              1.6409652e-06  1.1971759e-13  0              2.9959765    
   2100000   12727.922      100            100            0.011604346    0.0018425028   0              0.032970537    2.7308615e-11  0              1.3186353e-06  1.1971759e-13  0              2.9959765    
   2200000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970539    2.1709917e-12  0              1.0482942e-07  1.1971759e-13  0              2.9959765    
   2300000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    4.3807152e-15  0              2.1152906e-10  1.1971759e-13  0              2.9959765    
   2400000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    5.1370806e-14  0              2.4805124e-09  1.1971759e-13  0              2.9959765    
   2500000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    8.0149377e-15  0              3.8701266e-10  1.1971759e-13  0              2.9959765    
   2600000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    1.0704318e-16  0              5.168732e-12   1.1971759e-13  0              2.9959765    
   2700000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    1.2335035e-17  0              5.9561472e-13  1.1971759e-13  0              2.9959765    
   2800000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    6.2448126e-18  0              3.0153965e-13  1.1971759e-13  0              2.9959765    
   2900000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    4.9215465e-18  0              2.3764387e-13  1.1971759e-13  0              2.9959765    
   3000000   12727.922      100            100            0.011604347    0.0018425028   0              0.032970538    5.0461164e-18  0              2.436589e-13   1.1971759e-13  0              2.9959765    
Loop time of 531.463 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4877101.957 ns/day, 0.000 hours/ns, 5644.794 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.76      | 74.906     | 128.04     | 602.3 | 14.09
Neigh   | 1.6284     | 1.6555     | 1.6812     |   1.6 |  0.31
Comm    | 12.692     | 19.014     | 24.056     | 117.5 |  3.58
Output  | 0.34464    | 0.34527    | 0.34592    |   0.1 |  0.06
Modify  | 317.56     | 330.98     | 344.67     |  67.8 | 62.28
Other   |            | 104.6      |            |       | 19.68

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -750 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.004562678   -5.0772999e-35  0              0.013688034    228994.61      0              1.105733e+10   1.1971759e-13  0              3.8035731    
    200000   12727.922      100            100           -0.0013867257   4.511502e-42   0             -0.004160177    127643.05      0              6.1634259e+09  1.1971759e-13  0              3.1126832    
    300000   12727.922      100            100            0.024424561    0.0066249739   0              0.066648709    75384.922      0              3.6400681e+09  1.1971759e-13  0              2.994138     
    400000   12727.922      100            100            0.043626267   -0.0031341697   0              0.13401297     8857.9276      0              4.2771762e+08  1.1971759e-13  0              2.991943     
    500000   12727.922      100            100            0.019759487    0.0034725902   0              0.05580587     2137.2247      0              1.0319893e+08  1.1971759e-13  0              2.9947331    
    600000   12727.922      100            100            0.01772178     0.0013862214   0              0.051779118    59.100603      0              2853756.6      1.1971759e-13  0              2.9949663    
    700000   12727.922      100            100            0.014285299    0.001397148    0              0.04145875     2.5210922      0              121734.52      1.1971759e-13  0              2.9954877    
    800000   12727.922      100            100            0.012678529    0.0017527492   0              0.036282839    5.1499731      0              248673.77      1.1971759e-13  0              2.9957773    
    900000   12727.922      100            100            0.012262346    0.0018307036   0              0.034956333    0.68730296     0              33187.4        1.1971759e-13  0              2.9958564    
   1000000   12727.922      100            100            0.01228479     0.0018256868   0              0.035028684    0.0053913747   0              260.33019      1.1971759e-13  0              2.9958529    
   1100000   12727.922      100            100            0.012353871    0.0018227123   0              0.035238899    0.0061831137   0              298.56043      1.1971759e-13  0              2.9958406    
   1200000   12727.922      100            100            0.012381682    0.0018197478   0              0.0353253      0.002065818    0              99.750959      1.1971759e-13  0              2.9958355    
   1300000   12727.922      100            100            0.012385081    0.0018192679   0              0.035335976    9.8332752e-05  0              4.7481367      1.1971759e-13  0              2.9958348    
   1400000   12727.922      100            100            0.012382835    0.0018193403   0              0.035329164    2.6933154e-06  0              0.13005056     1.1971759e-13  0              2.9958352    
   1500000   12727.922      100            100            0.01238135     0.001819391    0              0.035324658    4.2968375e-06  0              0.2074789      1.1971759e-13  0              2.9958355    
   1600000   12727.922      100            100            0.012380983    0.0018194041   0              0.035323544    5.0941096e-07  0              0.024597632    1.1971759e-13  0              2.9958356    
   1700000   12727.922      100            100            0.012381017    0.001819403    0              0.035323647    1.8517383e-09  0              8.9413814e-05  1.1971759e-13  0              2.9958356    
   1800000   12727.922      100            100            0.012381081    0.0018194008   0              0.035323843    5.8617276e-09  0              0.00028304185  1.1971759e-13  0              2.9958356    
   1900000   12727.922      100            100            0.012381106    0.0018193999   0              0.035323918    1.6238474e-09  0              7.8409779e-05  1.1971759e-13  0              2.9958355    
   2000000   12727.922      100            100            0.012381108    0.0018193998   0              0.035323925    6.1953309e-11  0              2.9915036e-06  1.1971759e-13  0              2.9958355    
   2100000   12727.922      100            100            0.012381106    0.0018193999   0              0.035323918    3.4977329e-12  0              1.68893e-07    1.1971759e-13  0              2.9958355    
   2200000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    3.6154788e-12  0              1.7457853e-07  1.1971759e-13  0              2.9958355    
   2300000   12727.922      100            100            0.012381104    0.0018194      0              0.035323913    3.6546224e-13  0              1.7646864e-08  1.1971759e-13  0              2.9958355    
   2400000   12727.922      100            100            0.012381104    0.0018194      0              0.035323913    2.5233431e-16  0              1.2184321e-11  1.1971759e-13  0              2.9958355    
   2500000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    5.5414232e-15  0              2.6757549e-10  1.1971759e-13  0              2.9958355    
   2600000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    1.226679e-15   0              5.9231938e-11  1.1971759e-13  0              2.9958355    
   2700000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    9.2733812e-19  0              4.4777839e-14  1.1971759e-13  0              2.9958355    
   2800000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    2.3615411e-17  0              1.1403037e-12  1.1971759e-13  0              2.9958355    
   2900000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    5.1944239e-18  0              2.5082014e-13  1.1971759e-13  0              2.9958355    
   3000000   12727.922      100            100            0.012381105    0.0018194      0              0.035323914    8.8572198e-20  0              4.2768345e-15  1.1971759e-13  0              2.9958355    
Loop time of 537.99 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4817935.226 ns/day, 0.000 hours/ns, 5576.314 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.508     | 75.22      | 127.71     | 604.0 | 13.98
Neigh   | 1.6423     | 1.6678     | 1.6929     |   1.5 |  0.31
Comm    | 12.643     | 18.833     | 24.84      | 113.1 |  3.50
Output  | 0.34156    | 0.3422     | 0.34284    |   0.1 |  0.06
Modify  | 322.6      | 336.76     | 350.12     |  71.1 | 62.60
Other   |            | 105.2      |            |       | 19.55

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -800 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0060570298  -1.0154593e-34  0              0.018171089    362521.39      0              1.7504861e+10  1.1971759e-13  0              3.7374797    
    200000   12727.922      100            100           -0.00084026633 -8.1236306e-34  0             -0.002520799    28212.437      0              1.3622776e+09  1.1971759e-13  0              3.1823343    
    300000   12727.922      100            100           -0.00036320365 -1.827826e-33   0             -0.0010896109   4754.8318      0              2.2959381e+08  1.1971759e-13  0              3.0437525    
    400000   12727.922      100            100            0.0001140359   2.0309279e-34  0              0.00034210769  407.23095      0              19663725       1.1971759e-13  0              3.0075125    
    500000   12727.922      100            100            0.022880955    0.0029572487   0              0.065685618    1904.8501      0              91978395       1.1971759e-13  0              2.9942937    
    600000   12727.922      100            100            0.014022211    0.0021762222   0              0.039890412    360.12143      0              17388975       1.1971759e-13  0              2.9955578    
    700000   12727.922      100            100            0.011564718    0.0020713048   0              0.032622848    16.117818      0              778271.77      1.1971759e-13  0              2.9960018    
    800000   12727.922      100            100            0.013921731    0.0017664048   0              0.039998788    0.15556002     0              7511.4366      1.1971759e-13  0              2.9955687    
    900000   12727.922      100            100            0.012916481    0.001893429    0              0.036856013    0.064190622    0              3099.5354      1.1971759e-13  0              2.9957461    
   1000000   12727.922      100            100            0.013262987    0.0018696361   0              0.037919325    0.048723281    0              2352.6728      1.1971759e-13  0              2.9956857    
   1100000   12727.922      100            100            0.013166544    0.0018740595   0              0.037625572    0.012827646    0              619.40113      1.1971759e-13  0              2.9957021    
   1200000   12727.922      100            100            0.013184157    0.001873377    0              0.037679093    0.0021381815   0              103.24513      1.1971759e-13  0              2.9956992    
   1300000   12727.922      100            100            0.013185348    0.0018733133   0              0.03768273     0.00024801945  0              11.975972      1.1971759e-13  0              2.995699     
   1400000   12727.922      100            100            0.013182185    0.0018734476   0              0.037673109    1.8784262e-05  0              0.9070248      1.1971759e-13  0              2.9956995    
   1500000   12727.922      100            100            0.013184144    0.0018733662   0              0.037679066    6.1871735e-07  0              0.029875647    1.1971759e-13  0              2.9956992    
   1600000   12727.922      100            100            0.013183257    0.0018734027   0              0.037676369    3.0981377e-09  0              0.00014959798  1.1971759e-13  0              2.9956993    
   1700000   12727.922      100            100            0.013183588    0.0018733892   0              0.037677375    2.0453771e-08  0              0.0009876394   1.1971759e-13  0              2.9956993    
   1800000   12727.922      100            100            0.013183486    0.0018733933   0              0.037677064    7.8011462e-09  0              0.00037668943  1.1971759e-13  0              2.9956993    
   1900000   12727.922      100            100            0.01318351     0.0018733924   0              0.037677137    1.5954006e-09  0              7.7036187e-05  1.1971759e-13  0              2.9956993    
   2000000   12727.922      100            100            0.013183507    0.0018733925   0              0.03767713     2.2154659e-10  0              1.0697692e-05  1.1971759e-13  0              2.9956993    
   2100000   12727.922      100            100            0.013183506    0.0018733925   0              0.037677125    2.1185603e-11  0              1.0229769e-06  1.1971759e-13  0              2.9956993    
   2200000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677129    1.1716668e-12  0              5.6575597e-08  1.1971759e-13  0              2.9956993    
   2300000   12727.922      100            100            0.013183506    0.0018733925   0              0.037677127    1.1053952e-14  0              5.3375578e-10  1.1971759e-13  0              2.9956993    
   2400000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    5.7957527e-15  0              2.7985616e-10  1.1971759e-13  0              2.9956993    
   2500000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677127    4.0805145e-15  0              1.9703344e-10  1.1971759e-13  0              2.9956993    
   2600000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    1.0591915e-15  0              5.1144569e-11  1.1971759e-13  0              2.9956993    
   2700000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    1.5123447e-16  0              7.3025714e-12  1.1971759e-13  0              2.9956993    
   2800000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    1.6223684e-17  0              7.8338363e-13  1.1971759e-13  0              2.9956993    
   2900000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    8.6736668e-19  0              4.1882033e-14  1.1971759e-13  0              2.9956993    
   3000000   12727.922      100            100            0.013183507    0.0018733925   0              0.037677128    4.2328455e-20  0              2.0438896e-15  1.1971759e-13  0              2.9956993    
Loop time of 537.953 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4818268.256 ns/day, 0.000 hours/ns, 5576.699 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.827     | 75.725     | 129.45     | 606.7 | 14.08
Neigh   | 1.7347     | 1.7623     | 1.7891     |   1.6 |  0.33
Comm    | 13.114     | 18.717     | 23.268     |  96.6 |  3.48
Output  | 0.34256    | 0.34318    | 0.34381    |   0.1 |  0.06
Modify  | 321.7      | 336.13     | 350.23     |  73.0 | 62.48
Other   |            | 105.3      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -850 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0076307921   6.0927646e-34  0              0.022892376    523726.9       0              2.5288898e+10  1.1971759e-13  0              3.6549275    
    200000   12727.922      100            100            8.5620114e-05  1.9039878e-35  0              0.00025686034  204.69833      0              9884149.8      1.1971759e-13  0              3.2086378    
    300000   12727.922      100            100            0.00087470854 -6.3466246e-36  0              0.0026241256   19065.092      0              9.2058505e+08  1.1971759e-13  0              3.0377894    
    400000   12727.922      100            100            0.017606044    0.0045668676   0              0.048251266    17513.313      0              8.456552e+08   1.1971759e-13  0              2.9950375    
    500000   12727.922      100            100            0.029549107    0.00035212005  0              0.0882952      729.45851      0              35222941       1.1971759e-13  0              2.993403     
    600000   12727.922      100            100            0.0086613167   0.0015358857   0              0.024448064    48.776324      0              2355234.1      1.1971759e-13  0              2.9965277    
    700000   12727.922      100            100            0.015721314    0.0015777067   0              0.045586236    15.668475      0              756574.61      1.1971759e-13  0              2.995267     
    800000   12727.922      100            100            0.014153571    0.0019023845   0              0.040558328    6.4950469      0              313622.57      1.1971759e-13  0              2.9955405    
    900000   12727.922      100            100            0.013667054    0.0018453335   0              0.039155828    0.0097182382   0              469.25894      1.1971759e-13  0              2.9956157    
   1000000   12727.922      100            100            0.014003665    0.0018517833   0              0.040159211    0.10222349     0              4936.0064      1.1971759e-13  0              2.9955599    
   1100000   12727.922      100            100            0.013990162    0.0018518078   0              0.040118679    0.0074291833   0              358.72867      1.1971759e-13  0              2.9955625    
   1200000   12727.922      100            100            0.013948665    0.0018532933   0              0.039992701    0.00054588092  0              26.358636      1.1971759e-13  0              2.9955694    
   1300000   12727.922      100            100            0.013959895    0.00185288     0              0.040026806    0.00028517316  0              13.769991      1.1971759e-13  0              2.9955674    
   1400000   12727.922      100            100            0.013962921    0.0018527746   0              0.040035989    4.8378039e-07  0              0.023360024    1.1971759e-13  0              2.995567     
   1500000   12727.922      100            100            0.013960724    0.0018528541   0              0.040029319    4.4582953e-06  0              0.21527512     1.1971759e-13  0              2.9955673    
   1600000   12727.922      100            100            0.013960817    0.0018528502   0              0.0400296      3.2841452e-07  0              0.015857962    1.1971759e-13  0              2.9955673    
   1700000   12727.922      100            100            0.013961091    0.0018528404   0              0.040030433    2.3589309e-08  0              0.0011390433   1.1971759e-13  0              2.9955673    
   1800000   12727.922      100            100            0.013961016    0.0018528432   0              0.040030206    1.2522e-08     0              0.00060464257  1.1971759e-13  0              2.9955673    
   1900000   12727.922      100            100            0.013960996    0.0018528439   0              0.040030145    2.2822307e-11  0              1.1020075e-06  1.1971759e-13  0              2.9955673    
   2000000   12727.922      100            100            0.013961011    0.0018528433   0              0.04003019     1.9468531e-10  0              9.4006567e-06  1.1971759e-13  0              2.9955673    
   2100000   12727.922      100            100            0.01396101     0.0018528434   0              0.040030188    1.4525263e-11  0              7.0137296e-07  1.1971759e-13  0              2.9955673    
   2200000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030182    1.0183828e-12  0              4.9174061e-08  1.1971759e-13  0              2.9955673    
   2300000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    5.5042702e-13  0              2.6578151e-08  1.1971759e-13  0              2.9955673    
   2400000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    1.0352109e-15  0              4.9986632e-11  1.1971759e-13  0              2.9955673    
   2500000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    8.5636044e-15  0              4.1350581e-10  1.1971759e-13  0              2.9955673    
   2600000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    5.6941621e-16  0              2.7495071e-11  1.1971759e-13  0              2.9955673    
   2700000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    1.0293459e-16  0              4.970343e-12   1.1971759e-13  0              2.9955673    
   2800000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    2.1959667e-18  0              1.0603537e-13  1.1971759e-13  0              2.9955673    
   2900000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    2.5544498e-18  0              1.2334524e-13  1.1971759e-13  0              2.9955673    
   3000000   12727.922      100            100            0.013961009    0.0018528434   0              0.040030184    3.6123467e-18  0              1.7442729e-13  1.1971759e-13  0              2.9955673    
Loop time of 538.333 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4814862.520 ns/day, 0.000 hours/ns, 5572.758 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.474     | 76.354     | 130.06     | 612.3 | 14.18
Neigh   | 1.7703     | 1.7993     | 1.8286     |   1.7 |  0.33
Comm    | 13.291     | 19.058     | 24.668     |  96.7 |  3.54
Output  | 0.34374    | 0.34438    | 0.34502    |   0.1 |  0.06
Modify  | 321.79     | 334.49     | 348.12     |  68.6 | 62.13
Other   |            | 106.3      |            |       | 19.74

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -900 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0092758952   2.5386507e-35  0              0.027827686    711879.51      0              3.4374114e+10  1.1971759e-13  0              3.5579708    
    200000   12727.922      100            100            0.001317898    1.573767e-39   0              0.0039536941   36420.824      0              1.7586312e+09  1.1971759e-13  0              3.1968655    
    300000   12727.922      100            100            0.14189617    -0.0053588159   0              0.43104731     21499.763      0              1.0381466e+09  1.1971759e-13  0              2.9854691    
    400000   12727.922      100            100            0.00049213657  1.0154612e-34  0              0.0014764097   6776.5558      0              3.2721563e+08  1.1971759e-13  0              3.0036514    
    500000   12727.922      100            100            0.033056968   -0.0006085911   0              0.099779494    151.53872      0              7317262.5      1.1971759e-13  0              2.9930117    
    600000   12727.922      100            100            0.010100261    0.0019695707   0              0.028331211    132.22753      0              6384794.1      1.1971759e-13  0              2.9962831    
    700000   12727.922      100            100            0.012769481    0.0024688516   0              0.03583959     0.69493551     0              33555.948      1.1971759e-13  0              2.9958059    
    800000   12727.922      100            100            0.014022031    0.0021006083   0              0.039965483    0.2398833      0              11583.106      1.1971759e-13  0              2.9955703    
    900000   12727.922      100            100            0.014521216    0.0019969611   0              0.041566688    0.1833976      0              8855.6137      1.1971759e-13  0              2.9954827    
   1000000   12727.922      100            100            0.014698219    0.0019636563   0              0.042131001    0.055057747    0              2658.5416      1.1971759e-13  0              2.9954524    
   1100000   12727.922      100            100            0.014758313    0.0019609671   0              0.042313971    0.011697461    0              564.82852      1.1971759e-13  0              2.9954427    
   1200000   12727.922      100            100            0.014776558    0.0019617865   0              0.042367889    0.0020345725   0              98.242227      1.1971759e-13  0              2.9954398    
   1300000   12727.922      100            100            0.014780946    0.0019612502   0              0.042381588    0.0003049531   0              14.725094      1.1971759e-13  0              2.9954391    
   1400000   12727.922      100            100            0.014781761    0.0019612178   0              0.042384065    4.0041376e-05  0              1.9334548      1.1971759e-13  0              2.995439     
   1500000   12727.922      100            100            0.014781734    0.0019612201   0              0.042383982    4.591505e-06   0              0.22170735     1.1971759e-13  0              2.995439     
   1600000   12727.922      100            100            0.014781605    0.001961226    0              0.04238359     4.4881288e-07  0              0.021671568    1.1971759e-13  0              2.995439     
   1700000   12727.922      100            100            0.014781518    0.0019612299   0              0.042383323    3.5105664e-08  0              0.0016951269   1.1971759e-13  0              2.995439     
   1800000   12727.922      100            100            0.014781473    0.0019612319   0              0.042383187    1.8411437e-09  0              8.8902238e-05  1.1971759e-13  0              2.9954391    
   1900000   12727.922      100            100            0.014781453    0.0019612328   0              0.042383126    2.77347e-11    0              1.3392094e-06  1.1971759e-13  0              2.9954391    
   2000000   12727.922      100            100            0.014781445    0.0019612331   0              0.042383101    4.120467e-12   0              1.989626e-07   1.1971759e-13  0              2.9954391    
   2100000   12727.922      100            100            0.014781442    0.0019612333   0              0.042383091    4.6117522e-12  0              2.2268501e-07  1.1971759e-13  0              2.9954391    
   2200000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383088    1.5659513e-12  0              7.5614185e-08  1.1971759e-13  0              2.9954391    
   2300000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383087    3.5880859e-13  0              1.7325583e-08  1.1971759e-13  0              2.9954391    
   2400000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    6.5884035e-14  0              3.1813043e-09  1.1971759e-13  0              2.9954391    
   2500000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    1.039178e-14   0              5.0178188e-10  1.1971759e-13  0              2.9954391    
   2600000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    1.4147682e-15  0              6.8314094e-11  1.1971759e-13  0              2.9954391    
   2700000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    1.8581612e-16  0              8.9723955e-12  1.1971759e-13  0              2.9954391    
   2800000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    2.3981069e-17  0              1.15796e-12    1.1971759e-13  0              2.9954391    
   2900000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    1.1879265e-17  0              5.736072e-13   1.1971759e-13  0              2.9954391    
   3000000   12727.922      100            100            0.01478144     0.0019612333   0              0.042383086    1.2644609e-17  0              6.1056291e-13  1.1971759e-13  0              2.9954391    
Loop time of 533.36 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4859752.469 ns/day, 0.000 hours/ns, 5624.714 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.475     | 75.835     | 129.26     | 608.9 | 14.22
Neigh   | 1.8738     | 1.9029     | 1.9324     |   1.6 |  0.36
Comm    | 12.795     | 19.337     | 25.667     | 114.6 |  3.63
Output  | 0.34316    | 0.3438     | 0.34444    |   0.1 |  0.06
Modify  | 318.53     | 331.21     | 344.35     |  65.2 | 62.10
Other   |            | 104.7      |            |       | 19.64

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -950 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.010985879   -2.5386489e-35  0              0.032957638    926469.86      0              4.4735914e+10  1.1971759e-13  0              3.4482649    
    200000   12727.922      100            100            0.0028002392   1.4265181e-40  0              0.0084007175   131503.53      0              6.3498347e+09  1.1971759e-13  0              3.1512544    
    300000   12727.922      100            100           -0.00076232677  3.0076759e-40  0             -0.0022869803   25590.802      0              1.2356883e+09  1.1971759e-13  0              3.0311492    
    400000   12727.922      100            100           -0.00052982702  3.4851977e-40  0             -0.001589481    11262.663      0              5.438337e+08   1.1971759e-13  0              3.0008908    
    500000   12727.922      100            100            0.022095953    0.001830766    0              0.064457093    2646.5513      0              1.2779249e+08  1.1971759e-13  0              2.9944168    
    600000   12727.922      100            100            0.014083773    0.001285131    0              0.040966189    388.36884      0              18752941       1.1971759e-13  0              2.9955342    
    700000   12727.922      100            100            0.017401947    0.0020857448   0              0.050120098    23.586256      0              1138895.9      1.1971759e-13  0              2.9950452    
    800000   12727.922      100            100            0.016309485    0.0020000199   0              0.046928436    1.9356086      0              93463.613      1.1971759e-13  0              2.9952002    
    900000   12727.922      100            100            0.015448684    0.0018518923   0              0.04449416     0.91121014     0              43999.077      1.1971759e-13  0              2.9953263    
   1000000   12727.922      100            100            0.015417412    0.0018585176   0              0.04439372     0.00029445505  0              14.218181      1.1971759e-13  0              2.9953324    
   1100000   12727.922      100            100            0.015516845    0.001857249    0              0.044693285    0.015422373    0              744.69118      1.1971759e-13  0              2.9953168    
   1200000   12727.922      100            100            0.015543061    0.0018567679   0              0.044772414    0.00089001243  0              42.975515      1.1971759e-13  0              2.9953126    
   1300000   12727.922      100            100            0.015535527    0.001856904    0              0.044749677    0.00010118981  0              4.8860939      1.1971759e-13  0              2.9953137    
   1400000   12727.922      100            100            0.015530334    0.0018569991   0              0.044734002    3.8955798e-05  0              1.8810361      1.1971759e-13  0              2.9953146    
   1500000   12727.922      100            100            0.015530192    0.0018570023   0              0.044733574    1.2383118e-09  0              5.9793644e-05  1.1971759e-13  0              2.9953146    
   1600000   12727.922      100            100            0.015530858    0.0018569904   0              0.044735585    6.8994782e-07  0              0.033315111    1.1971759e-13  0              2.9953145    
   1700000   12727.922      100            100            0.015531025    0.0018569873   0              0.044736089    3.5811507e-08  0              0.0017292095   1.1971759e-13  0              2.9953145    
   1800000   12727.922      100            100            0.015530973    0.0018569882   0              0.044735931    4.8366861e-09  0              0.00023354626  1.1971759e-13  0              2.9953145    
   1900000   12727.922      100            100            0.015530939    0.0018569888   0              0.044735828    1.6703468e-09  0              8.0655067e-05  1.1971759e-13  0              2.9953145    
   2000000   12727.922      100            100            0.015530938    0.0018569889   0              0.044735826    6.9414352e-14  0              3.3517707e-09  1.1971759e-13  0              2.9953145    
   2100000   12727.922      100            100            0.015530943    0.0018569888   0              0.04473584     3.0789974e-11  0              1.4867377e-06  1.1971759e-13  0              2.9953145    
   2200000   12727.922      100            100            0.015530944    0.0018569888   0              0.044735843    1.4327805e-12  0              6.9183843e-08  1.1971759e-13  0              2.9953145    
   2300000   12727.922      100            100            0.015530944    0.0018569888   0              0.044735842    2.2989582e-13  0              1.1100846e-08  1.1971759e-13  0              2.9953145    
   2400000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    7.1284738e-14  0              3.4420849e-09  1.1971759e-13  0              2.9953145    
   2500000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    2.460916e-17   0              1.1882883e-12  1.1971759e-13  0              2.9953145    
   2600000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    1.3494041e-15  0              6.5157895e-11  1.1971759e-13  0              2.9953145    
   2700000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    2.7842772e-17  0              1.3444278e-12  1.1971759e-13  0              2.9953145    
   2800000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    2.6262636e-17  0              1.2681287e-12  1.1971759e-13  0              2.9953145    
   2900000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    3.1929444e-18  0              1.5417586e-13  1.1971759e-13  0              2.9953145    
   3000000   12727.922      100            100            0.015530943    0.0018569888   0              0.044735841    7.3357433e-18  0              3.5421679e-13  1.1971759e-13  0              2.9953145    
Loop time of 534.315 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4851072.892 ns/day, 0.000 hours/ns, 5614.668 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.431     | 76.004     | 130.08     | 611.8 | 14.22
Neigh   | 1.8541     | 1.878      | 1.9024     |   1.6 |  0.35
Comm    | 13.183     | 18.852     | 23.564     |  97.4 |  3.53
Output  | 0.34387    | 0.34449    | 0.34511    |   0.1 |  0.06
Modify  | 319.7      | 332.59     | 345.14     |  66.0 | 62.25
Other   |            | 104.6      |            |       | 19.59

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.012755433    1.5231917e-34  0              0.038266299    1167141.5      0              5.6357084e+10  1.1971759e-13  0              3.3271665    
    200000   12727.922      100            100            0.0044881223   2.0309271e-34  0              0.013464367    281386.72      0              1.3587158e+10  1.1971759e-13  0              3.07527      
    300000   12727.922      100            100            0.00026932432  5.0773017e-35  0              0.00080797296  2111.4018      0              1.0195204e+08  1.1971759e-13  0              3.0452685    
    400000   12727.922      100            100            0.00073889284  1.0302515e-06  0              0.0022156483   14110.103      0              6.8132637e+08  1.1971759e-13  0              2.999902     
    500000   12727.922      100            100            0.0063933603   0.0007117593   0              0.018468322    1885.0597      0              91022785       1.1971759e-13  0              2.9970525    
    600000   12727.922      100            100            0.018633826    0.0027801889   0              0.053121288    383.02405      0              18494861       1.1971759e-13  0              2.9949111    
    700000   12727.922      100            100            0.017053489    0.0022784009   0              0.048882065    52.104481      0              2515938.9      1.1971759e-13  0              2.9950966    
    800000   12727.922      100            100            0.015857376    0.0021842957   0              0.045387832    4.2289332      0              204200.05      1.1971759e-13  0              2.9952822    
    900000   12727.922      100            100            0.016783065    0.002402175    0              0.047947018    0.20065338     0              9688.8335      1.1971759e-13  0              2.9951492    
   1000000   12727.922      100            100            0.016362052    0.0023487358   0              0.046737421    0.00053927383  0              26.039603      1.1971759e-13  0              2.995211     
   1100000   12727.922      100            100            0.016521582    0.002353935    0              0.047210811    0.0019532767   0              94.316743      1.1971759e-13  0              2.9951869    
   1200000   12727.922      100            100            0.016468638    0.0023528962   0              0.047053017    0.0010860456   0              52.441257      1.1971759e-13  0              2.9951949    
   1300000   12727.922      100            100            0.016483055    0.0023532027   0              0.047095963    0.00026679892  0              12.882765      1.1971759e-13  0              2.9951927    
   1400000   12727.922      100            100            0.016480428    0.0023531499   0              0.047088136    4.366948e-05   0              2.1086429      1.1971759e-13  0              2.9951931    
   1500000   12727.922      100            100            0.016480267    0.0023531455   0              0.047087656    5.1567016e-06  0              0.24899866     1.1971759e-13  0              2.9951931    
   1600000   12727.922      100            100            0.016480729    0.0023531556   0              0.047089031    4.1814138e-07  0              0.020190551    1.1971759e-13  0              2.9951931    
   1700000   12727.922      100            100            0.016480439    0.0023531493   0              0.047088167    1.739103e-08   0              0.00083975059  1.1971759e-13  0              2.9951931    
   1800000   12727.922      100            100            0.016480573    0.0023531522   0              0.047088566    5.0485958e-12  0              2.4377862e-07  1.1971759e-13  0              2.9951931    
   1900000   12727.922      100            100            0.016480521    0.0023531511   0              0.047088412    2.6225189e-10  0              1.2663205e-05  1.1971759e-13  0              2.9951931    
   2000000   12727.922      100            100            0.016480538    0.0023531515   0              0.047088463    1.2639576e-10  0              6.1031987e-06  1.1971759e-13  0              2.9951931    
   2100000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088449    2.9388185e-11  0              1.4190503e-06  1.1971759e-13  0              2.9951931    
   2200000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    4.6323229e-12  0              2.2367829e-07  1.1971759e-13  0              2.9951931    
   2300000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    5.2747959e-13  0              2.5470102e-08  1.1971759e-13  0              2.9951931    
   2400000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088451    4.0825487e-14  0              1.9713166e-09  1.1971759e-13  0              2.9951931    
   2500000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    1.6409519e-15  0              7.9235694e-11  1.1971759e-13  0              2.9951931    
   2600000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088451    1.5511347e-18  0              7.4898744e-14  1.1971759e-13  0              2.9951931    
   2700000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    1.0112008e-17  0              4.8827268e-13  1.1971759e-13  0              2.9951931    
   2800000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    1.3207123e-19  0              6.377247e-15   1.1971759e-13  0              2.9951931    
   2900000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    7.4560401e-18  0              3.6002549e-13  1.1971759e-13  0              2.9951931    
   3000000   12727.922      100            100            0.016480534    0.0023531514   0              0.047088452    1.0145196e-18  0              4.898752e-14   1.1971759e-13  0              2.9951931    
Loop time of 536.094 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4834970.945 ns/day, 0.000 hours/ns, 5596.031 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.465     | 76.018     | 129.59     | 612.6 | 14.18
Neigh   | 1.8927     | 1.9201     | 1.9472     |   1.6 |  0.36
Comm    | 13.203     | 19.066     | 24.529     |  98.9 |  3.56
Output  | 0.34217    | 0.34278    | 0.34339    |   0.1 |  0.06
Modify  | 320.83     | 333.82     | 346.25     |  66.3 | 62.27
Other   |            | 104.9      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1050 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.014580088    5.0773072e-35  0              0.043740264    1433644.9      0              6.9225581e+10  1.1971759e-13  0              3.1958034    
    200000   12727.922      100            100            0.36466196    -0.053497154    0              1.147483       88993.718      0              4.2971881e+09  1.1971759e-13  0              2.9761959    
    300000   12727.922      100            100            0.001686537   -5.0772951e-35  0              0.005059611    60387.226      0              2.915883e+09   1.1971759e-13  0              3.018124     
    400000   12727.922      100            100           -0.00047024632  1.0154657e-34  0             -0.001410739    8618.1812      0              4.1614113e+08  1.1971759e-13  0              3.0023161    
    500000   12727.922      100            100            0.002674796    0.00097035398  0              0.0070540341   44.483212      0              2147935.1      1.1971759e-13  0              2.998125     
    600000   12727.922      100            100            0.021272172    0.0029935053   0              0.060823011    306.81161      0              14814835       1.1971759e-13  0              2.9945514    
    700000   12727.922      100            100            0.014892967    0.0023442486   0              0.042334653    1.4388493      0              69476.885      1.1971759e-13  0              2.9954404    
    800000   12727.922      100            100            0.017991565    0.0027101095   0              0.051264585    4.1384137      0              199829.19      1.1971759e-13  0              2.9949832    
    900000   12727.922      100            100            0.017410072    0.0025388376   0              0.049691378    0.96803626     0              46743.007      1.1971759e-13  0              2.9950631    
   1000000   12727.922      100            100            0.017217268    0.0025561431   0              0.049095662    0.012678163    0              612.18312      1.1971759e-13  0              2.9950918    
   1100000   12727.922      100            100            0.01736572     0.0025560718   0              0.049541087    0.0078113414   0              377.18172      1.1971759e-13  0              2.9950696    
   1200000   12727.922      100            100            0.017334688    0.0025555568   0              0.049448506    0.0024388352   0              117.76262      1.1971759e-13  0              2.9950744    
   1300000   12727.922      100            100            0.017326652    0.0025554281   0              0.049424528    5.2858467e-05  0              2.5523462      1.1971759e-13  0              2.9950755    
   1400000   12727.922      100            100            0.017333933    0.0025555487   0              0.049446251    1.4548073e-05  0              0.70247438     1.1971759e-13  0              2.9950744    
   1500000   12727.922      100            100            0.017332191    0.0025555194   0              0.049441055    6.0232492e-06  0              0.29084115     1.1971759e-13  0              2.9950747    
   1600000   12727.922      100            100            0.017331889    0.0025555146   0              0.049440151    1.9252647e-07  0              0.0092964143   1.1971759e-13  0              2.9950747    
   1700000   12727.922      100            100            0.01733224     0.0025555204   0              0.049441199    2.5454894e-08  0              0.0012291257   1.1971759e-13  0              2.9950747    
   1800000   12727.922      100            100            0.017332144    0.0025555188   0              0.049440914    1.4578524e-08  0              0.00070394476  1.1971759e-13  0              2.9950747    
   1900000   12727.922      100            100            0.017332134    0.0025555186   0              0.049440884    6.4316785e-10  0              3.1056273e-05  1.1971759e-13  0              2.9950747    
   2000000   12727.922      100            100            0.017332151    0.0025555189   0              0.049440934    4.0791931e-11  0              1.9696964e-06  1.1971759e-13  0              2.9950747    
   2100000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    3.4586573e-11  0              1.6700619e-06  1.1971759e-13  0              2.9950747    
   2200000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440918    2.0204349e-12  0              9.755957e-08   1.1971759e-13  0              2.9950747    
   2300000   12727.922      100            100            0.017332146    0.0025555188   0              0.04944092     5.6654843e-14  0              2.7356596e-09  1.1971759e-13  0              2.9950747    
   2400000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    8.0133109e-14  0              3.869341e-09   1.1971759e-13  0              2.9950747    
   2500000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    6.0070108e-15  0              2.9005706e-10  1.1971759e-13  0              2.9950747    
   2600000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    4.7124006e-17  0              2.2754496e-12  1.1971759e-13  0              2.9950747    
   2700000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    1.9147526e-16  0              9.2456552e-12  1.1971759e-13  0              2.9950747    
   2800000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    2.2968518e-18  0              1.1090675e-13  1.1971759e-13  0              2.9950747    
   2900000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    5.8666518e-18  0              2.8327962e-13  1.1971759e-13  0              2.9950747    
   3000000   12727.922      100            100            0.017332146    0.0025555188   0              0.049440919    6.0907362e-18  0              2.9409986e-13  1.1971759e-13  0              2.9950747    
Loop time of 538.834 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4810389.307 ns/day, 0.000 hours/ns, 5567.580 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.766     | 76.6       | 130.39     | 614.2 | 14.22
Neigh   | 1.953      | 1.9817     | 2.0098     |   1.6 |  0.37
Comm    | 13.283     | 18.937     | 24.316     |  98.1 |  3.51
Output  | 0.34356    | 0.34416    | 0.34479    |   0.1 |  0.06
Modify  | 320.39     | 334.29     | 349.31     |  71.3 | 62.04
Other   |            | 106.7      |            |       | 19.80

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1100 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.016456012    7.6516344e-40  0              0.049368036    1725807.1      0              8.3333047e+10  1.1971759e-13  0              3.0551256    
    200000   12727.922      100            100           -0.0015255981  -2.0309154e-34  0             -0.0045767942   296625.24      0              1.4322971e+10  1.1971759e-13  0              3.059181     
    300000   12727.922      100            100            0.018147616    0.0055425315   0              0.048900315    105662.29      0              5.1020539e+09  1.1971759e-13  0              2.9949165    
    400000   12727.922      100            100            0.0017248226  -2.4872564e-05  0              0.0051993404   16938.164      0              8.1788333e+08  1.1971759e-13  0              2.998832     
    500000   12727.922      100            100            0.014286771    0.0035913014   0              0.039269013    3132.939       0              1.5127841e+08  1.1971759e-13  0              2.9955601    
    600000   12727.922      100            100            0.022354425    0.0028389228   0              0.064224352    298.61987      0              14419285       1.1971759e-13  0              2.9944004    
    700000   12727.922      100            100            0.01726783     0.0024599738   0              0.049343516    52.400943      0              2530254        1.1971759e-13  0              2.9950856    
    800000   12727.922      100            100            0.017246571    0.0023956923   0              0.04934402     1.5386309      0              74294.978      1.1971759e-13  0              2.9950805    
    900000   12727.922      100            100            0.017813152    0.0026103639   0              0.050829093    0.097055942    0              4686.4841      1.1971759e-13  0              2.9950058    
   1000000   12727.922      100            100            0.018056714    0.0025542075   0              0.051615934    0.11053889     0              5337.5272      1.1971759e-13  0              2.9949674    
   1100000   12727.922      100            100            0.018127265    0.0025508253   0              0.051830969    0.01751243     0              845.61256      1.1971759e-13  0              2.9949571    
   1200000   12727.922      100            100            0.018129172    0.0025508008   0              0.051836714    0.0005903765   0              28.507168      1.1971759e-13  0              2.9949569    
   1300000   12727.922      100            100            0.018120602    0.0025509798   0              0.051810826    2.6063798e-05  0              1.2585275      1.1971759e-13  0              2.9949582    
   1400000   12727.922      100            100            0.018115885    0.0025510822   0              0.051796572    3.5070306e-05  0              1.6934196      1.1971759e-13  0              2.9949589    
   1500000   12727.922      100            100            0.018114577    0.0025511108   0              0.051792621    5.7626864e-06  0              0.2782595      1.1971759e-13  0              2.994959     
   1600000   12727.922      100            100            0.018114529    0.0025511116   0              0.051792475    2.0781098e-07  0              0.010034449    1.1971759e-13  0              2.994959     
   1700000   12727.922      100            100            0.018114679    0.0025511082   0              0.05179293     7.1819878e-09  0              0.00034679249  1.1971759e-13  0              2.994959     
   1800000   12727.922      100            100            0.018114764    0.0025511063   0              0.051793186    1.1101968e-08  0              0.0005360743   1.1971759e-13  0              2.994959     
   1900000   12727.922      100            100            0.018114788    0.0025511058   0              0.051793259    1.8947464e-09  0              9.1490522e-05  1.1971759e-13  0              2.994959     
   2000000   12727.922      100            100            0.018114789    0.0025511057   0              0.051793262    7.2861651e-11  0              3.5182283e-06  1.1971759e-13  0              2.994959     
   2100000   12727.922      100            100            0.018114787    0.0025511058   0              0.051793254    1.9485973e-12  0              9.409079e-08   1.1971759e-13  0              2.994959     
   2200000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793249    3.5097779e-12  0              1.6947462e-07  1.1971759e-13  0              2.994959     
   2300000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    6.2275827e-13  0              3.0070768e-08  1.1971759e-13  0              2.994959     
   2400000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    2.5709051e-14  0              1.2413981e-09  1.1971759e-13  0              2.994959     
   2500000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    5.2063545e-16  0              2.5139622e-11  1.1971759e-13  0              2.994959     
   2600000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    1.1585002e-15  0              5.5939827e-11  1.1971759e-13  0              2.994959     
   2700000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    2.0501838e-16  0              9.8996036e-12  1.1971759e-13  0              2.994959     
   2800000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    2.3370384e-17  0              1.1284722e-12  1.1971759e-13  0              2.994959     
   2900000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    1.5925261e-18  0              7.6897385e-14  1.1971759e-13  0              2.994959     
   3000000   12727.922      100            100            0.018114785    0.0025511058   0              0.051793248    1.5241834e-18  0              7.3597362e-14  1.1971759e-13  0              2.994959     
Loop time of 538.477 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4813579.800 ns/day, 0.000 hours/ns, 5571.273 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.811     | 76.692     | 131.47     | 614.9 | 14.24
Neigh   | 2.002      | 2.0311     | 2.0594     |   1.6 |  0.38
Comm    | 13.357     | 19.489     | 24.788     | 117.6 |  3.62
Output  | 0.34506    | 0.34569    | 0.34631    |   0.1 |  0.06
Modify  | 322.31     | 334.3      | 346.24     |  60.9 | 62.08
Other   |            | 105.6      |            |       | 19.61

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1150 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.30538561    -0.032252415    0              0.94840925     1629407.9      0              7.8678278e+10  1.1971759e-13  0              2.9783536    
    200000   12727.922      100            100           -0.0014139964   2.5386516e-35  0             -0.0042419892   132619.13      0              6.403703e+09   1.1971759e-13  0              3.1327843    
    300000   12727.922      100            100           -0.00061588556  8.6314112e-34  0             -0.0018476567   15388.096      0              7.4303608e+08  1.1971759e-13  0              3.0366939    
    400000   12727.922      100            100           -0.00052698427  2.5386547e-35  0             -0.0015809528   11120.91       0              5.3698893e+08  1.1971759e-13  0              3.0012354    
    500000   12727.922      100            100            0.039605525   -0.0020915262   0              0.1209081      12.987413      0              627115.69      1.1971759e-13  0              2.9922964    
    600000   12727.922      100            100            0.0222335      0.0031272675   0              0.063573234    373.7571       0              18047393       1.1971759e-13  0              2.9944305    
    700000   12727.922      100            100            0.021010544    0.0030360381   0              0.059995592    27.686029      0              1336859.2      1.1971759e-13  0              2.9945791    
    800000   12727.922      100            100            0.019986885    0.0030066812   0              0.056953974    0.29334413     0              14164.538      1.1971759e-13  0              2.9947147    
    900000   12727.922      100            100            0.019372059    0.0030094927   0              0.055106683    0.15213381     0              7345.9973      1.1971759e-13  0              2.9948002    
   1000000   12727.922      100            100            0.01913244     0.0030363533   0              0.054360966    0.09780566     0              4722.6853      1.1971759e-13  0              2.9948355    
   1100000   12727.922      100            100            0.019060517    0.0030325841   0              0.054148967    0.019549725    0              943.98625      1.1971759e-13  0              2.9948457    
   1200000   12727.922      100            100            0.019050448    0.0030326632   0              0.054118681    0.0019232765   0              92.868139      1.1971759e-13  0              2.9948472    
   1300000   12727.922      100            100            0.019053727    0.0030326409   0              0.054128541    6.6372e-05     0              3.2048663      1.1971759e-13  0              2.9948468    
   1400000   12727.922      100            100            0.019057093    0.0030326166   0              0.054138662    7.8745898e-07  0              0.038023576    1.1971759e-13  0              2.9948463    
   1500000   12727.922      100            100            0.019058719    0.0030326047   0              0.054143551    2.6838309e-06  0              0.12959259     1.1971759e-13  0              2.9948461    
   1600000   12727.922      100            100            0.019059264    0.0030326006   0              0.054145192    7.8546157e-07  0              0.037927128    1.1971759e-13  0              2.994846     
   1700000   12727.922      100            100            0.019059381    0.0030325998   0              0.054145543    1.0496618e-07  0              0.0050684413   1.1971759e-13  0              2.994846     
   1800000   12727.922      100            100            0.019059379    0.0030325998   0              0.054145539    6.3776523e-09  0              0.00030795401  1.1971759e-13  0              2.994846     
   1900000   12727.922      100            100            0.019059363    0.0030325999   0              0.054145488    3.0475294e-11  0              1.4715429e-06  1.1971759e-13  0              2.994846     
   2000000   12727.922      100            100            0.019059353    0.0030325999   0              0.054145458    5.3770047e-11  0              2.5963632e-06  1.1971759e-13  0              2.994846     
   2100000   12727.922      100            100            0.019059349    0.0030326      0              0.054145447    2.7465124e-11  0              1.3261925e-06  1.1971759e-13  0              2.994846     
   2200000   12727.922      100            100            0.019059348    0.0030326      0              0.054145443    4.9809937e-12  0              2.4051436e-07  1.1971759e-13  0              2.994846     
   2300000   12727.922      100            100            0.019059348    0.0030326      0              0.054145443    4.4286353e-13  0              2.1384295e-08  1.1971759e-13  0              2.994846     
   2400000   12727.922      100            100            0.019059348    0.0030326      0              0.054145443    1.1584854e-14  0              5.5939116e-10  1.1971759e-13  0              2.994846     
   2500000   12727.922      100            100            0.019059348    0.0030326      0              0.054145443    5.5770056e-16  0              2.6929364e-11  1.1971759e-13  0              2.994846     
   2600000   12727.922      100            100            0.019059348    0.0030326      0              0.054145444    7.8320063e-16  0              3.7817956e-11  1.1971759e-13  0              2.994846     
   2700000   12727.922      100            100            0.019059348    0.0030326      0              0.054145444    2.0585625e-16  0              9.9400614e-12  1.1971759e-13  0              2.994846     
   2800000   12727.922      100            100            0.019059348    0.0030326      0              0.054145444    1.1435067e-17  0              5.5215845e-13  1.1971759e-13  0              2.994846     
   2900000   12727.922      100            100            0.019059348    0.0030326      0              0.054145444    7.6294824e-18  0              3.684004e-13   1.1971759e-13  0              2.994846     
   3000000   12727.922      100            100            0.019059348    0.0030326      0              0.054145444    1.4313862e-17  0              6.9116516e-13  1.1971759e-13  0              2.994846     
Loop time of 536.82 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4828430.120 ns/day, 0.000 hours/ns, 5588.461 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.8       | 76.862     | 131.17     | 616.1 | 14.32
Neigh   | 2.0354     | 2.0664     | 2.0967     |   1.7 |  0.38
Comm    | 13.433     | 18.925     | 24.166     | 100.2 |  3.53
Output  | 0.3672     | 0.36786    | 0.36849    |   0.1 |  0.07
Modify  | 321.39     | 333.54     | 345.79     |  61.2 | 62.13
Other   |            | 105.1      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1200 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0010630138  -5.0772936e-35  0              0.0031890415   1588203        0              7.6688638e+10  1.1971759e-13  0              3.1154304    
    200000   12727.922      100            100           -0.00091815629 -7.1082177e-34  0             -0.0027544689   35208.443      0              1.7000897e+09  1.1971759e-13  0              3.1785995    
    300000   12727.922      100            100            0.00046689799  2.0309291e-34  0              0.001400694    6008.3144      0              2.9012e+08     1.1971759e-13  0              3.0424938    
    400000   12727.922      100            100            0.00072038378  2.0389851e-40  0              0.0021611513   13699.97       0              6.615225e+08   1.1971759e-13  0              3.0005128    
    500000   12727.922      100            100            0.014937648    0.0015748812   0              0.043238063    3288.9275      0              1.5881054e+08  1.1971759e-13  0              2.9954475    
    600000   12727.922      100            100            0.020032153    0.0016909213   0              0.058405537    465.21648      0              22463639       1.1971759e-13  0              2.9946643    
    700000   12727.922      100            100            0.022414742    0.0028316393   0              0.064412587    2.6941571      0              130091.2       1.1971759e-13  0              2.9943781    
    800000   12727.922      100            100            0.019396574    0.002993601    0              0.055196121    6.6787054      0              322490.78      1.1971759e-13  0              2.9947942    
    900000   12727.922      100            100            0.019527113    0.0028709822   0              0.055710356    0.48948601     0              23635.527      1.1971759e-13  0              2.9947727    
   1000000   12727.922      100            100            0.019897348    0.0028622991   0              0.056829744    0.041665128    0              2011.8599      1.1971759e-13  0              2.9947201    
   1100000   12727.922      100            100            0.019799232    0.0028640927   0              0.056533602    0.018693088    0              902.62233      1.1971759e-13  0              2.9947336    
   1200000   12727.922      100            100            0.019769971    0.0028645506   0              0.056445362    1.8302958e-06  0              0.088378434    1.1971759e-13  0              2.9947378    
   1300000   12727.922      100            100            0.019789291    0.0028642577   0              0.056503616    0.00032629351  0              15.755546      1.1971759e-13  0              2.9947351    
   1400000   12727.922      100            100            0.01978916     0.0028642576   0              0.056503222    1.5827921e-05  0              0.76427365     1.1971759e-13  0              2.9947351    
   1500000   12727.922      100            100            0.019786594    0.0028642967   0              0.056495485    2.521912e-06   0              0.1217741      1.1971759e-13  0              2.9947355    
   1600000   12727.922      100            100            0.019787151    0.0028642885   0              0.056497164    7.5298278e-07  0              0.036358844    1.1971759e-13  0              2.9947354    
   1700000   12727.922      100            100            0.019787378    0.002864285    0              0.05649785     9.4500316e-10  0              4.5630821e-05  1.1971759e-13  0              2.9947354    
   1800000   12727.922      100            100            0.019787256    0.0028642868   0              0.05649748     1.5110043e-08  0              0.00072960989  1.1971759e-13  0              2.9947354    
   1900000   12727.922      100            100            0.019787251    0.0028642869   0              0.056497466    4.713802e-10   0              2.2761263e-05  1.1971759e-13  0              2.9947354    
   2000000   12727.922      100            100            0.019787268    0.0028642867   0              0.056497519    1.4243055e-10  0              6.8774616e-06  1.1971759e-13  0              2.9947354    
   2100000   12727.922      100            100            0.019787265    0.0028642867   0              0.056497509    2.9402852e-11  0              1.4197585e-06  1.1971759e-13  0              2.9947354    
   2200000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497504    2.1341181e-13  0              1.0304892e-08  1.1971759e-13  0              2.9947354    
   2300000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    6.8079087e-13  0              3.2872954e-08  1.1971759e-13  0              2.9947354    
   2400000   12727.922      100            100            0.019787265    0.0028642867   0              0.056497507    1.2018324e-14  0              5.8032184e-10  1.1971759e-13  0              2.9947354    
   2500000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497506    7.7601745e-15  0              3.7471105e-10  1.1971759e-13  0              2.9947354    
   2600000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    1.0415864e-15  0              5.0294479e-11  1.1971759e-13  0              2.9947354    
   2700000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    2.0001333e-17  0              9.6579279e-13  1.1971759e-13  0              2.9947354    
   2800000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    2.379513e-17   0              1.1489817e-12  1.1971759e-13  0              2.9947354    
   2900000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    7.1311631e-18  0              3.4433834e-13  1.1971759e-13  0              2.9947354    
   3000000   12727.922      100            100            0.019787264    0.0028642867   0              0.056497507    1.0591792e-19  0              5.1143971e-15  1.1971759e-13  0              2.9947354    
Loop time of 535.67 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4838798.629 ns/day, 0.000 hours/ns, 5600.461 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.793     | 76.922     | 131.59     | 616.3 | 14.36
Neigh   | 2.0986     | 2.1312     | 2.1631     |   1.7 |  0.40
Comm    | 13.455     | 18.98      | 24.049     |  99.5 |  3.54
Output  | 0.34368    | 0.34429    | 0.3449     |   0.1 |  0.06
Modify  | 320.97     | 332.75     | 344.41     |  59.3 | 62.12
Other   |            | 104.5      |            |       | 19.52

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 182
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1250 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -3.6368877e-05 -6.092731e-34   0             -0.00010910663  1290306.1      0              6.2304266e+10  1.1971759e-13  0              3.2367908    
    200000   12727.922      100            100           -8.5303989e-05  1.2693255e-35  0             -0.00025591197  211.62181      0              10218460       1.1971759e-13  0              3.1988482    
    300000   12727.922      100            100            0.0019229672  -2.4370995e-33  0              0.0057689015   75301.15       0              3.636023e+09   1.1971759e-13  0              3.0150861    
    400000   12727.922      100            100            0.0039356131   0.0012078185   0              0.010599021    20268.389      0              9.7868796e+08  1.1971759e-13  0              2.9975091    
    500000   12727.922      100            100            0.0041299434   0.00088251733  0              0.011507313    208.55121      0              10070192       1.1971759e-13  0              2.9976001    
    600000   12727.922      100            100            0.017441614    0.0026023503   0              0.049722491    391.23867      0              18891515       1.1971759e-13  0              2.9950774    
    700000   12727.922      100            100            0.022165215    0.0028453509   0              0.063650295    41.502425      0              2004003.6      1.1971759e-13  0              2.9944078    
    800000   12727.922      100            100            0.019954742    0.0029753856   0              0.056888841    4.6764306      0              225808.1       1.1971759e-13  0              2.9947188    
    900000   12727.922      100            100            0.020822445    0.0028438364   0              0.059623499    0.55365672     0              26734.101      1.1971759e-13  0              2.9945913    
   1000000   12727.922      100            100            0.020477998    0.0028881976   0              0.058545796    0.062327376    0              3009.5659      1.1971759e-13  0              2.9946411    
   1100000   12727.922      100            100            0.020614531    0.0028765275   0              0.058967065    0.006982437    0              337.15689      1.1971759e-13  0              2.9946216    
   1200000   12727.922      100            100            0.020561749    0.0028809554   0              0.058804292    0.00075993128  0              36.694362      1.1971759e-13  0              2.9946291    
   1300000   12727.922      100            100            0.020582205    0.0028799571   0              0.058866658    8.0026036e-05  0              3.8641709      1.1971759e-13  0              2.9946262    
   1400000   12727.922      100            100            0.020574381    0.0028802286   0              0.058842914    8.0567171e-06  0              0.38903003     1.1971759e-13  0              2.9946273    
   1500000   12727.922      100            100            0.020577341    0.0028801241   0              0.058851899    7.6435319e-07  0              0.03690788     1.1971759e-13  0              2.9946269    
   1600000   12727.922      100            100            0.020576227    0.0028801631   0              0.058848518    6.6614433e-08  0              0.0032165726   1.1971759e-13  0              2.9946271    
   1700000   12727.922      100            100            0.020576644    0.0028801485   0              0.058849783    5.0871054e-09  0              0.00024563812  1.1971759e-13  0              2.994627     
   1800000   12727.922      100            100            0.020576489    0.0028801539   0              0.058849312    3.0608383e-10  0              1.4779693e-05  1.1971759e-13  0              2.994627     
   1900000   12727.922      100            100            0.020576546    0.0028801519   0              0.058849487    1.0339716e-11  0              4.992679e-07   1.1971759e-13  0              2.994627     
   2000000   12727.922      100            100            0.020576525    0.0028801526   0              0.058849422    7.0322909e-18  0              3.3956416e-13  1.1971759e-13  0              2.994627     
   2100000   12727.922      100            100            0.020576533    0.0028801523   0              0.058849446    1.8451509e-13  0              8.9095736e-09  1.1971759e-13  0              2.994627     
   2200000   12727.922      100            100            0.02057653     0.0028801524   0              0.058849437    9.8571317e-14  0              4.7596561e-09  1.1971759e-13  0              2.994627     
   2300000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     2.9501236e-14  0              1.4245091e-09  1.1971759e-13  0              2.994627     
   2400000   12727.922      100            100            0.020576531    0.0028801524   0              0.058849439    6.8992616e-15  0              3.3314065e-10  1.1971759e-13  0              2.994627     
   2500000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     1.420488e-15   0              6.8590282e-11  1.1971759e-13  0              2.994627     
   2600000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     3.0877062e-16  0              1.4909428e-11  1.1971759e-13  0              2.994627     
   2700000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     5.6818144e-17  0              2.7435448e-12  1.1971759e-13  0              2.994627     
   2800000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     1.694372e-18   0              8.1815162e-14  1.1971759e-13  0              2.994627     
   2900000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     5.2501227e-18  0              2.5350963e-13  1.1971759e-13  0              2.994627     
   3000000   12727.922      100            100            0.020576531    0.0028801524   0              0.05884944     4.62282e-18    0              2.2321943e-13  1.1971759e-13  0              2.994627     
Loop time of 539.454 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4804854.106 ns/day, 0.000 hours/ns, 5561.174 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.321     | 76.771     | 131.64     | 617.4 | 14.23
Neigh   | 2.1309     | 2.1651     | 2.1987     |   1.8 |  0.40
Comm    | 13.522     | 19.103     | 23.556     |  91.7 |  3.54
Output  | 0.344      | 0.34462    | 0.34525    |   0.1 |  0.06
Modify  | 322.14     | 335.13     | 349.17     |  67.2 | 62.12
Other   |            | 105.9      |            |       | 19.64

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 186
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1300 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.00088216817 -2.030914e-34   0             -0.0026465045   1027094        0              4.9594692e+10  1.1971759e-13  0              3.3433578    
    200000   12727.922      100            100            0.001044619    5.0773027e-35  0              0.0031338571   24187.086      0              1.1679078e+09  1.1971759e-13  0              3.1954551    
    300000   12727.922      100            100            0.064251094   -0.0055520096   0              0.19830529     110603.8       0              5.3406615e+09  1.1971759e-13  0              2.990033     
    400000   12727.922      100            100            0.00046870002  7.2587361e-40  0              0.0014061001   6190.1417      0              2.9889979e+08  1.1971759e-13  0              3.0035026    
    500000   12727.922      100            100            0.031608652    0.00017569437  0              0.094650262    2740.5741      0              1.3233252e+08  1.1971759e-13  0              2.9931561    
    600000   12727.922      100            100            0.014978571    0.0028010468   0              0.042134666    98.481336      0              4755311.3      1.1971759e-13  0              2.9954611    
    700000   12727.922      100            100            0.021924202    0.0037018268   0              0.062070779    64.44427       0              3111783.2      1.1971759e-13  0              2.9944762    
    800000   12727.922      100            100            0.022360861    0.0033196389   0              0.063762946    2.6325592      0              127116.86      1.1971759e-13  0              2.9944087    
    900000   12727.922      100            100            0.021234513    0.0034169542   0              0.060286584    0.36107496     0              17435.018      1.1971759e-13  0              2.9945623    
   1000000   12727.922      100            100            0.021506164    0.0034030804   0              0.06111541     0.15027565     0              7256.2733      1.1971759e-13  0              2.9945244    
   1100000   12727.922      100            100            0.021582052    0.0033982981   0              0.061347857    0.00068358179  0              33.007718      1.1971759e-13  0              2.9945143    
   1200000   12727.922      100            100            0.021523945    0.0033994322   0              0.061172403    0.002010176    0              97.064203      1.1971759e-13  0              2.9945221    
   1300000   12727.922      100            100            0.021529612    0.0033993253   0              0.061189511    0.00025059589  0              12.100379      1.1971759e-13  0              2.9945213    
   1400000   12727.922      100            100            0.021535852    0.0033992138   0              0.061208342    2.7714493e-06  0              0.13382337     1.1971759e-13  0              2.9945205    
   1500000   12727.922      100            100            0.021533377    0.0033992595   0              0.061200871    6.6640526e-06  0              0.32178325     1.1971759e-13  0              2.9945208    
   1600000   12727.922      100            100            0.02153322     0.003399262    0              0.061200398    2.3635194e-07  0              0.011412589    1.1971759e-13  0              2.9945209    
   1700000   12727.922      100            100            0.021533595    0.0033992552   0              0.061201531    4.5252542e-08  0              0.0021850833   1.1971759e-13  0              2.9945208    
   1800000   12727.922      100            100            0.021533513    0.0033992568   0              0.061201283    1.5300224e-08  0              0.00073879308  1.1971759e-13  0              2.9945208    
   1900000   12727.922      100            100            0.021533485    0.0033992573   0              0.061201199    2.9768194e-11  0              1.4373996e-06  1.1971759e-13  0              2.9945208    
   2000000   12727.922      100            100            0.021533504    0.0033992569   0              0.061201255    2.2787724e-10  0              1.1003376e-05  1.1971759e-13  0              2.9945208    
   2100000   12727.922      100            100            0.021533503    0.0033992569   0              0.061201251    2.3829095e-11  0              1.1506217e-06  1.1971759e-13  0              2.9945208    
   2200000   12727.922      100            100            0.021533501    0.003399257    0              0.061201245    4.6768565e-13  0              2.2582866e-08  1.1971759e-13  0              2.9945208    
   2300000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    7.1070823e-13  0              3.4317557e-08  1.1971759e-13  0              2.9945208    
   2400000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    1.9596886e-14  0              9.4626348e-10  1.1971759e-13  0              2.9945208    
   2500000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    5.7693617e-15  0              2.7858183e-10  1.1971759e-13  0              2.9945208    
   2600000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    1.5462583e-15  0              7.4663281e-11  1.1971759e-13  0              2.9945208    
   2700000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    2.6604247e-18  0              1.2846239e-13  1.1971759e-13  0              2.9945208    
   2800000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    2.8106281e-17  0              1.3571517e-12  1.1971759e-13  0              2.9945208    
   2900000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    1.2794824e-17  0              6.1781624e-13  1.1971759e-13  0              2.9945208    
   3000000   12727.922      100            100            0.021533501    0.003399257    0              0.061201247    4.5514276e-19  0              2.1977215e-14  1.1971759e-13  0              2.9945208    
Loop time of 539.734 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4802364.262 ns/day, 0.000 hours/ns, 5558.292 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.024     | 77.114     | 131.83     | 614.7 | 14.29
Neigh   | 2.1634     | 2.1958     | 2.2278     |   1.7 |  0.41
Comm    | 13.926     | 18.924     | 23.553     |  90.4 |  3.51
Output  | 0.3438     | 0.34442    | 0.34505    |   0.1 |  0.06
Modify  | 321.72     | 334.72     | 348.14     |  65.9 | 62.02
Other   |            | 106.4      |            |       | 19.72

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 188
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1350 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0014953987  -2.0309092e-34  0             -0.0044861961   796754.48      0              3.8472422e+10  1.1971759e-13  0              3.436317     
    200000   12727.922      100            100            0.0024374628  -6.0927479e-34  0              0.0073123884   104276.62      0              5.0351447e+09  1.1971759e-13  0              3.1701007    
    300000   12727.922      100            100           -0.00080129441  6.9213088e-40  0             -0.0024038832   28894.704      0              1.3952218e+09  1.1971759e-13  0              3.0313338    
    400000   12727.922      100            100            0.054311319   -0.0088065957   0              0.17174055     17392.865      0              8.3983922e+08  1.1971759e-13  0              2.990764     
    500000   12727.922      100            100            0.027869866    0.0027895028   0              0.080820096    3531.5277      0              1.7052483e+08  1.1971759e-13  0              2.9937452    
    600000   12727.922      100            100            0.015046081    0.0022939684   0              0.042844276    52.734379      0              2546354.4      1.1971759e-13  0              2.9954076    
    700000   12727.922      100            100            0.021727993    0.0034836544   0              0.061700324    63.784672      0              3079933.5      1.1971759e-13  0              2.9944926    
    800000   12727.922      100            100            0.022905141    0.0033219906   0              0.065393431    5.7247448      0              276427.44      1.1971759e-13  0              2.9943348    
    900000   12727.922      100            100            0.022688175    0.0033846443   0              0.064679882    0.015520218    0              749.41578      1.1971759e-13  0              2.9943674    
   1000000   12727.922      100            100            0.022409482    0.003355908    0              0.063872538    0.066434187    0              3207.8691      1.1971759e-13  0              2.9944029    
   1100000   12727.922      100            100            0.022305852    0.0033551023   0              0.063562452    0.021436108    0              1035.0729      1.1971759e-13  0              2.9944164    
   1200000   12727.922      100            100            0.022289997    0.0033551107   0              0.063514881    0.0015099291   0              72.909075      1.1971759e-13  0              2.9944184    
   1300000   12727.922      100            100            0.022295899    0.0033551306   0              0.063532567    1.534755e-08   0              0.00074107825  1.1971759e-13  0              2.9944176    
   1400000   12727.922      100            100            0.02230098     0.0033551353   0              0.063547806    2.7815697e-05  0              1.3431205      1.1971759e-13  0              2.9944169    
   1500000   12727.922      100            100            0.022302737    0.0033551226   0              0.063553088    6.9315234e-06  0              0.33469846     1.1971759e-13  0              2.9944167    
   1600000   12727.922      100            100            0.022302939    0.0033551212   0              0.063553697    3.7835354e-07  0              0.018269338    1.1971759e-13  0              2.9944166    
   1700000   12727.922      100            100            0.022302806    0.0033551223   0              0.063553294    1.9508606e-09  0              9.4200075e-05  1.1971759e-13  0              2.9944166    
   1800000   12727.922      100            100            0.022302711    0.003355123    0              0.06355301     1.0962415e-08  0              0.00052933578  1.1971759e-13  0              2.9944167    
   1900000   12727.922      100            100            0.022302682    0.0033551232   0              0.063552922    2.1783294e-09  0              0.00010518373  1.1971759e-13  0              2.9944167    
   2000000   12727.922      100            100            0.02230268     0.0033551232   0              0.063552915    8.838093e-11   0              4.2675988e-06  1.1971759e-13  0              2.9944167    
   2100000   12727.922      100            100            0.022302682    0.0033551232   0              0.063552924    2.3669327e-12  0              1.1429071e-07  1.1971759e-13  0              2.9944167    
   2200000   12727.922      100            100            0.022302684    0.0033551232   0              0.063552929    4.1361652e-12  0              1.9972062e-07  1.1971759e-13  0              2.9944167    
   2300000   12727.922      100            100            0.022302685    0.0033551232   0              0.063552931    6.6410884e-13  0              3.2067439e-08  1.1971759e-13  0              2.9944167    
   2400000   12727.922      100            100            0.022302685    0.0033551232   0              0.063552931    1.860041e-14   0              8.9814721e-10  1.1971759e-13  0              2.9944167    
   2500000   12727.922      100            100            0.022302685    0.0033551232   0              0.063552931    1.6344631e-15  0              7.8922373e-11  1.1971759e-13  0              2.9944167    
   2600000   12727.922      100            100            0.022302685    0.0033551232   0              0.06355293     1.5285858e-15  0              7.3809936e-11  1.1971759e-13  0              2.9944167    
   2700000   12727.922      100            100            0.022302685    0.0033551232   0              0.06355293     1.7277246e-16  0              8.3425636e-12  1.1971759e-13  0              2.9944167    
   2800000   12727.922      100            100            0.022302685    0.0033551232   0              0.06355293     3.5099254e-18  0              1.6948174e-13  1.1971759e-13  0              2.9944167    
   2900000   12727.922      100            100            0.022302685    0.0033551232   0              0.06355293     2.3981943e-19  0              1.1580022e-14  1.1971759e-13  0              2.9944167    
   3000000   12727.922      100            100            0.022302685    0.0033551232   0              0.06355293     4.2689914e-18  0              2.0613432e-13  1.1971759e-13  0              2.9944167    
Loop time of 539.99 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4800087.853 ns/day, 0.000 hours/ns, 5555.657 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.878     | 76.873     | 131.18     | 615.6 | 14.24
Neigh   | 2.2035     | 2.2355     | 2.2672     |   1.7 |  0.41
Comm    | 13.389     | 19.346     | 25.279     | 118.4 |  3.58
Output  | 0.34486    | 0.34551    | 0.34615    |   0.1 |  0.06
Modify  | 323.82     | 335.72     | 346.89     |  59.4 | 62.17
Other   |            | 105.5      |            |       | 19.53

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 190
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1400 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0018939544  -1.015456e-34   0             -0.0056818632   597793.51      0              2.8865309e+10  1.1971759e-13  0              3.5167031    
    200000   12727.922      100            100            0.0040637379   1.8342228e-40  0              0.012191214    238086.83      0              1.1496361e+10  1.1971759e-13  0              3.124263     
    300000   12727.922      100            100            0.0001734448   5.0773113e-35  0              0.0005203344   904.88442      0              43693630       1.1971759e-13  0              3.0429066    
    400000   12727.922      100            100            8.223543e-05   5.0773162e-35  0              0.00024670629  215.59225      0              10410178       1.1971759e-13  0              3.0053938    
    500000   12727.922      100            100            0.0049553774   0.00089946574  0              0.013966666    69.520802      0              3356910.7      1.1971759e-13  0              2.9973699    
    600000   12727.922      100            100            0.021028024    0.0040547772   0              0.059029294    472.201        0              22800896       1.1971759e-13  0              2.9946024    
    700000   12727.922      100            100            0.021949612    0.0030674945   0              0.062781341    59.578358      0              2876825.7      1.1971759e-13  0              2.9944449    
    800000   12727.922      100            100            0.022352998    0.0030504473   0              0.064008548    5.8654658      0              283222.35      1.1971759e-13  0              2.9943949    
    900000   12727.922      100            100            0.022708093    0.0031637144   0              0.064960564    0.41068499     0              19830.508      1.1971759e-13  0              2.9943547    
   1000000   12727.922      100            100            0.022900852    0.0032027372   0              0.06549982     0.014185751    0              684.97913      1.1971759e-13  0              2.9943318    
   1100000   12727.922      100            100            0.022984904    0.0032049269   0              0.065749785    1.2006356e-05  0              0.57974395     1.1971759e-13  0              2.9943211    
   1200000   12727.922      100            100            0.023018785    0.00320505     0              0.065851306    0.00033868972  0              16.354114      1.1971759e-13  0              2.9943167    
   1300000   12727.922      100            100            0.023031127    0.0032050808   0              0.065888299    0.00015180979  0              7.3303516      1.1971759e-13  0              2.9943151    
   1400000   12727.922      100            100            0.023035155    0.0032050892   0              0.065900377    3.7097761e-05  0              1.7913181      1.1971759e-13  0              2.9943146    
   1500000   12727.922      100            100            0.023036299    0.0032050915   0              0.065903806    6.6488812e-06  0              0.32105068     1.1971759e-13  0              2.9943144    
   1600000   12727.922      100            100            0.023036553    0.0032050919   0              0.065904567    9.4931101e-07  0              0.045838831    1.1971759e-13  0              2.9943144    
   1700000   12727.922      100            100            0.023036576    0.003205092    0              0.065904636    1.0955883e-07  0              0.0052902038   1.1971759e-13  0              2.9943144    
   1800000   12727.922      100            100            0.023036558    0.003205092    0              0.065904582    9.8516072e-09  0              0.00047569885  1.1971759e-13  0              2.9943144    
   1900000   12727.922      100            100            0.023036542    0.0032050919   0              0.065904535    6.0300328e-10  0              2.9116871e-05  1.1971759e-13  0              2.9943144    
   2000000   12727.922      100            100            0.023036534    0.0032050919   0              0.06590451     1.4032545e-11  0              6.7758139e-07  1.1971759e-13  0              2.9943144    
   2100000   12727.922      100            100            0.02303653     0.0032050919   0              0.065904499    4.7819171e-13  0              2.3090166e-08  1.1971759e-13  0              2.9943144    
   2200000   12727.922      100            100            0.023036529    0.0032050919   0              0.065904494    9.6596804e-13  0              4.664314e-08   1.1971759e-13  0              2.9943144    
   2300000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904493    3.4843624e-13  0              1.6824739e-08  1.1971759e-13  0              2.9943144    
   2400000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    7.7164208e-14  0              3.7259834e-09  1.1971759e-13  0              2.9943144    
   2500000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    1.3003656e-14  0              6.2789999e-10  1.1971759e-13  0              2.9943144    
   2600000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    1.7731913e-15  0              8.5621062e-11  1.1971759e-13  0              2.9943144    
   2700000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    2.1216827e-16  0              1.0244846e-11  1.1971759e-13  0              2.9943144    
   2800000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    1.1815892e-17  0              5.7054714e-13  1.1971759e-13  0              2.9943144    
   2900000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    1.0040546e-18  0              4.8482202e-14  1.1971759e-13  0              2.9943144    
   3000000   12727.922      100            100            0.023036528    0.0032050919   0              0.065904492    1.3788721e-19  0              6.6580797e-15  1.1971759e-13  0              2.9943144    
Loop time of 540.713 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4793673.437 ns/day, 0.000 hours/ns, 5548.233 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.948     | 77.086     | 132.54     | 616.6 | 14.26
Neigh   | 2.2705     | 2.2978     | 2.3255     |   1.7 |  0.42
Comm    | 13.776     | 19.088     | 23.293     |  95.4 |  3.53
Output  | 0.34463    | 0.34525    | 0.34588    |   0.1 |  0.06
Modify  | 324.14     | 336.28     | 348.1      |  61.5 | 62.19
Other   |            | 105.6      |            |       | 19.53

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 196
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1450 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0020932044  -2.030898e-34   0             -0.0062796132   428971.67      0              2.0713507e+10  1.1971759e-13  0              3.5854245    
    200000   12727.922      100            100            0.0058977494   1.0154603e-34  0              0.017693248    423598.83      0              2.0454071e+10  1.1971759e-13  0              3.0592505    
    300000   12727.922      100            100            0.0015334866   6.0927885e-34  0              0.0046004598   51216.738      0              2.473073e+09   1.1971759e-13  0              3.026403     
    400000   12727.922      100            100            0.079746551   -0.0089198495   0              0.2481595      8674.2748      0              4.1884968e+08  1.1971759e-13  0              2.9889923    
    500000   12727.922      100            100            0.038127133   -0.0029032876   0              0.11728469     2132.4164      0              1.0296676e+08  1.1971759e-13  0              2.9923904    
    600000   12727.922      100            100            0.02954323     0.0015671919   0              0.087062497    229.26539      0              11070405       1.1971759e-13  0              2.9934561    
    700000   12727.922      100            100            0.022979894    0.0037763424   0              0.06516334     61.385409      0              2964081.7      1.1971759e-13  0              2.9943407    
    800000   12727.922      100            100            0.022935718    0.0037051352   0              0.06510202     0.19364067     0              9350.2149      1.1971759e-13  0              2.9943493    
    900000   12727.922      100            100            0.02400851     0.0037835637   0              0.068241966    1.2470823      0              60217.142      1.1971759e-13  0              2.9942153    
   1000000   12727.922      100            100            0.024159516    0.0037965856   0              0.068681963    0.0045706926   0              220.70239      1.1971759e-13  0              2.994196     
   1100000   12727.922      100            100            0.024035397    0.0038029775   0              0.068303213    0.020311726    0              980.78056      1.1971759e-13  0              2.9942118    
   1200000   12727.922      100            100            0.024002444    0.0038034095   0              0.068203921    0.00058961204  0              28.470256      1.1971759e-13  0              2.9942161    
   1300000   12727.922      100            100            0.024015809    0.0038033934   0              0.068244035    0.00027283155  0              13.174059      1.1971759e-13  0              2.9942144    
   1400000   12727.922      100            100            0.024021676    0.0038033883   0              0.068261639    2.5193856e-05  0              1.2165211      1.1971759e-13  0              2.9942137    
   1500000   12727.922      100            100            0.024020509    0.0038033891   0              0.068258138    2.8207658e-06  0              0.13620468     1.1971759e-13  0              2.9942138    
   1600000   12727.922      100            100            0.024019598    0.0038033898   0              0.068255403    7.2642456e-07  0              0.035076442    1.1971759e-13  0              2.9942139    
   1700000   12727.922      100            100            0.024019657    0.0038033898   0              0.068255581    1.802993e-08   0              0.00087060077  1.1971759e-13  0              2.9942139    
   1800000   12727.922      100            100            0.024019785    0.0038033897   0              0.068255967    1.6543982e-08  0              0.0007988497   1.1971759e-13  0              2.9942139    
   1900000   12727.922      100            100            0.024019791    0.0038033896   0              0.068255984    1.8329716e-11  0              8.8507641e-07  1.1971759e-13  0              2.9942139    
   2000000   12727.922      100            100            0.024019775    0.0038033897   0              0.068255934    3.134787e-10   0              1.5136764e-05  1.1971759e-13  0              2.9942139    
   2100000   12727.922      100            100            0.024019772    0.0038033897   0              0.068255927    1.727781e-12   0              8.3428361e-08  1.1971759e-13  0              2.9942139    
   2200000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    4.989889e-12   0              2.4094388e-07  1.1971759e-13  0              2.9942139    
   2300000   12727.922      100            100            0.024019775    0.0038033897   0              0.068255934    1.7153962e-13  0              8.2830342e-09  1.1971759e-13  0              2.9942139    
   2400000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255934    6.5214154e-14  0              3.1489581e-09  1.1971759e-13  0              2.9942139    
   2500000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    6.7454822e-15  0              3.257152e-10   1.1971759e-13  0              2.9942139    
   2600000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    7.0336124e-16  0              3.3962797e-11  1.1971759e-13  0              2.9942139    
   2700000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    2.1507974e-16  0              1.0385431e-11  1.1971759e-13  0              2.9942139    
   2800000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    1.6627904e-18  0              8.0290199e-14  1.1971759e-13  0              2.9942139    
   2900000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    2.9944892e-18  0              1.4459317e-13  1.1971759e-13  0              2.9942139    
   3000000   12727.922      100            100            0.024019774    0.0038033897   0              0.068255933    4.4520886e-18  0              2.1497542e-13  1.1971759e-13  0              2.9942139    
Loop time of 539.59 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4803650.493 ns/day, 0.000 hours/ns, 5559.781 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.648     | 77.368     | 132.19     | 620.5 | 14.34
Neigh   | 2.3095     | 2.3384     | 2.3681     |   1.7 |  0.43
Comm    | 13.307     | 19.74      | 25.955     | 114.0 |  3.66
Output  | 0.34502    | 0.34567    | 0.34635    |   0.1 |  0.06
Modify  | 323.96     | 334.86     | 346.44     |  55.8 | 62.06
Other   |            | 104.9      |            |       | 19.45

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 198
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1500 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0021064562  -4.5695686e-34  0             -0.0063193687   289255.5       0              1.3967113e+10  1.1971759e-13  0              3.6432839    
    200000   12727.922      100            100            0.31653159    -0.046509496    0              0.99610428     346705.98      0              1.6741191e+10  1.1971759e-13  0              2.9779439    
    300000   12727.922      100            100            0.15015436    -0.0059208624   0              0.45638395     76190.493      0              3.6789662e+09  1.1971759e-13  0              2.9850931    
    400000   12727.922      100            100           -0.00039033956  2.030945e-34   0             -0.0011710187   5723.2988      0              2.7635762e+08  1.1971759e-13  0              3.0031371    
    500000   12727.922      100            100            0.019300951    0.0018904245   0              0.056012428    3821.6972      0              1.8453608e+08  1.1971759e-13  0              2.9948095    
    600000   12727.922      100            100            0.03108144     0.0011540952   0              0.092090224    167.58379      0              8092021.6      1.1971759e-13  0              2.9932874    
    700000   12727.922      100            100            0.02432679     0.0041212914   0              0.068859077    68.706571      0              3317594.4      1.1971759e-13  0              2.9941826    
    800000   12727.922      100            100            0.024262509    0.0037960868   0              0.06899144     7.1098114      0              343307.35      1.1971759e-13  0              2.9941847    
    900000   12727.922      100            100            0.025180246    0.0038163316   0              0.071724407    0.16592637     0              8011.9906      1.1971759e-13  0              2.9940685    
   1000000   12727.922      100            100            0.024687033    0.003870398    0              0.0701907      0.017354098    0              837.96729      1.1971759e-13  0              2.9941324    
   1100000   12727.922      100            100            0.024853779    0.0038691614   0              0.070692175    0.016648361    0              803.88977      1.1971759e-13  0              2.9941117    
   1200000   12727.922      100            100            0.024828247    0.0038693151   0              0.070615426    0.0030013546   0              144.92467      1.1971759e-13  0              2.9941147    
   1300000   12727.922      100            100            0.024820215    0.0038693715   0              0.070591274    0.00018165366  0              8.7714053      1.1971759e-13  0              2.9941158    
   1400000   12727.922      100            100            0.024828152    0.0038693184   0              0.070615139    5.1189186e-08  0              0.0024717426   1.1971759e-13  0              2.9941148    
   1500000   12727.922      100            100            0.024824771    0.0038693406   0              0.070604971    2.8227026e-06  0              0.13629821     1.1971759e-13  0              2.9941152    
   1600000   12727.922      100            100            0.024825606    0.0038693352   0              0.070607483    9.4899299e-07  0              0.045823475    1.1971759e-13  0              2.9941151    
   1700000   12727.922      100            100            0.02482559     0.0038693352   0              0.070607435    1.0367277e-07  0              0.0050059871   1.1971759e-13  0              2.9941151    
   1800000   12727.922      100            100            0.024825487    0.0038693359   0              0.070607125    2.5262249e-09  0              0.00012198236  1.1971759e-13  0              2.9941151    
   1900000   12727.922      100            100            0.024825547    0.0038693355   0              0.070607306    2.2310197e-10  0              1.0772796e-05  1.1971759e-13  0              2.9941151    
   2000000   12727.922      100            100            0.024825527    0.0038693356   0              0.070607246    2.2891584e-10  0              1.1053527e-05  1.1971759e-13  0              2.9941151    
   2100000   12727.922      100            100            0.02482553     0.0038693356   0              0.070607255    4.2205069e-11  0              2.0379318e-06  1.1971759e-13  0              2.9941151    
   2200000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607258    2.6275546e-12  0              1.2687521e-07  1.1971759e-13  0              2.9941151    
   2300000   12727.922      100            100            0.02482553     0.0038693356   0              0.070607255    1.4534413e-15  0              7.018148e-11   1.1971759e-13  0              2.9941151    
   2400000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607257    3.8774672e-14  0              1.8722901e-09  1.1971759e-13  0              2.9941151    
   2500000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    1.3318669e-14  0              6.4311087e-10  1.1971759e-13  0              2.9941151    
   2600000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    1.5203841e-15  0              7.3413907e-11  1.1971759e-13  0              2.9941151    
   2700000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    1.3468565e-17  0              6.5034879e-13  1.1971759e-13  0              2.9941151    
   2800000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    4.2152303e-18  0              2.0353839e-13  1.1971759e-13  0              2.9941151    
   2900000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    1.8513592e-18  0              8.9395508e-14  1.1971759e-13  0              2.9941151    
   3000000   12727.922      100            100            0.024825531    0.0038693356   0              0.070607256    1.458715e-17   0              7.0436125e-13  1.1971759e-13  0              2.9941151    
Loop time of 535.141 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4843587.793 ns/day, 0.000 hours/ns, 5606.004 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.708     | 77.076     | 132.23     | 618.2 | 14.40
Neigh   | 2.299      | 2.333      | 2.366      |   1.8 |  0.44
Comm    | 13.475     | 18.933     | 23.513     |  94.9 |  3.54
Output  | 0.34359    | 0.34422    | 0.34486    |   0.1 |  0.06
Modify  | 319.65     | 331.9      | 343.79     |  61.2 | 62.02
Other   |            | 104.6      |            |       | 19.54

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 200
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1550 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0019453195   3.0463851e-34  0             -0.0058359586   177778.73      0              8.5842985e+09  1.1971759e-13  0              3.6909948    
    200000   12727.922      100            100           -0.0013373767  -2.0309018e-34  0             -0.00401213     501969.57      0              2.4238314e+10  1.1971759e-13  0              3.0292734    
    300000   12727.922      100            100           -0.0011901919   4.5332183e-40  0             -0.0035705758   87766.02       0              4.237907e+09   1.1971759e-13  0              3.0128293    
    400000   12727.922      100            100            0.0025499034   6.9232444e-05  0              0.0075804777   20653.459      0              9.9728164e+08  1.1971759e-13  0              2.9984544    
    500000   12727.922      100            100            0.011312413    0.0033491562   0              0.030588083    2138.2555      0              1.032487e+08   1.1971759e-13  0              2.9960777    
    600000   12727.922      100            100            0.022119366    0.002871922    0              0.063486175    463.71652      0              22391211       1.1971759e-13  0              2.9944357    
    700000   12727.922      100            100            0.025828307    0.0034869589   0              0.073997962    71.609812      0              3457781.6      1.1971759e-13  0              2.9939698    
    800000   12727.922      100            100            0.025747072    0.0035531733   0              0.073688042    9.2684597      0              447540.75      1.1971759e-13  0              2.9939902    
    900000   12727.922      100            100            0.025310433    0.0036783553   0              0.072252942    0.8728562      0              42147.102      1.1971759e-13  0              2.9940463    
   1000000   12727.922      100            100            0.02565415     0.003625997    0              0.073336453    0.051000324    0              2462.6231      1.1971759e-13  0              2.9940026    
   1100000   12727.922      100            100            0.025478089    0.0036370848   0              0.072797182    0.0007057662   0              34.078924      1.1971759e-13  0              2.9940245    
   1200000   12727.922      100            100            0.025550578    0.0036349505   0              0.073016784    0.00015360011  0              7.4167996      1.1971759e-13  0              2.9940155    
   1300000   12727.922      100            100            0.025525575    0.0036359875   0              0.072940737    0.00014233746  0              6.8729665      1.1971759e-13  0              2.9940187    
   1400000   12727.922      100            100            0.025532734    0.0036355936   0              0.072962608    4.0844495e-05  0              1.9722345      1.1971759e-13  0              2.9940177    
   1500000   12727.922      100            100            0.02553124     0.0036356776   0              0.072958042    7.3632771e-06  0              0.3555463      1.1971759e-13  0              2.9940179    
   1600000   12727.922      100            100            0.025531288    0.0036356738   0              0.072958191    9.4967442e-07  0              0.045856379    1.1971759e-13  0              2.9940179    
   1700000   12727.922      100            100            0.025531456    0.0036356651   0              0.072958703    8.6371563e-08  0              0.0041705737   1.1971759e-13  0              2.9940179    
   1800000   12727.922      100            100            0.025531336    0.0036356715   0              0.072958337    4.5825146e-09  0              0.00022127323  1.1971759e-13  0              2.9940179    
   1900000   12727.922      100            100            0.025531395    0.0036356684   0              0.072958515    3.9502468e-11  0              1.9074328e-06  1.1971759e-13  0              2.9940179    
   2000000   12727.922      100            100            0.025531371    0.0036356696   0              0.072958444    2.3366013e-11  0              1.1282611e-06  1.1971759e-13  0              2.9940179    
   2100000   12727.922      100            100            0.025531379    0.0036356692   0              0.072958468    1.6839036e-11  0              8.130968e-07   1.1971759e-13  0              2.9940179    
   2200000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958462    4.499569e-12   0              2.1726808e-07  1.1971759e-13  0              2.9940179    
   2300000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    7.7748085e-13  0              3.7541768e-08  1.1971759e-13  0              2.9940179    
   2400000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    9.6579361e-14  0              4.6634717e-09  1.1971759e-13  0              2.9940179    
   2500000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    8.5137476e-15  0              4.110984e-10   1.1971759e-13  0              2.9940179    
   2600000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    3.8633827e-16  0              1.8654893e-11  1.1971759e-13  0              2.9940179    
   2700000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    2.1481488e-17  0              1.0372642e-12  1.1971759e-13  0              2.9940179    
   2800000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    1.9077753e-19  0              9.2119639e-15  1.1971759e-13  0              2.9940179    
   2900000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    1.2801708e-20  0              6.1814867e-16  1.1971759e-13  0              2.9940179    
   3000000   12727.922      100            100            0.025531377    0.0036356693   0              0.072958463    9.1725967e-18  0              4.4291187e-13  1.1971759e-13  0              2.9940179    
Loop time of 536.78 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4828792.988 ns/day, 0.000 hours/ns, 5588.881 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.641     | 76.964     | 132.72     | 618.2 | 14.34
Neigh   | 2.2986     | 2.3327     | 2.3659     |   1.8 |  0.43
Comm    | 13.331     | 18.953     | 23.178     |  97.6 |  3.53
Output  | 0.36093    | 0.36156    | 0.36218    |   0.1 |  0.07
Modify  | 321.68     | 333.68     | 345.18     |  61.1 | 62.16
Other   |            | 104.5      |            |       | 19.47

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 200
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1600 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.0016199937  -1.5231898e-34  0             -0.004859981    93812.332      0              4.5298618e+09  1.1971759e-13  0              3.7291944    
    200000   12727.922      100            100           -0.0015633845   4.0619112e-34  0             -0.0046901534   285339.02      0              1.3778e+10     1.1971759e-13  0              3.0973187    
    300000   12727.922      100            100           -0.00049147071  6.0927736e-34  0             -0.0014744121   9225.1973      0              4.4545176e+08  1.1971759e-13  0              3.0383432    
    400000   12727.922      100            100            0.029926267    0.0056186374   0              0.084160162    28487.051      0              1.3755378e+09  1.1971759e-13  0              2.9934845    
    500000   12727.922      100            100            0.048562186   -0.0031248755   0              0.14881143     585.09144      0              28251972       1.1971759e-13  0              2.9914657    
    600000   12727.922      100            100            0.018576267    0.0038606758   0              0.051868125    31.473928      0              1519763.3      1.1971759e-13  0              2.9949504    
    700000   12727.922      100            100            0.027818298    0.0031208693   0              0.080334025    52.415327      0              2530948.6      1.1971759e-13  0              2.9937183    
    800000   12727.922      100            100            0.027165243    0.003728788    0              0.077766941    4.8384746      0              233632.62      1.1971759e-13  0              2.9938255    
    900000   12727.922      100            100            0.026103271    0.0039812226   0              0.074328591    0.48492723     0              23415.401      1.1971759e-13  0              2.9939625    
   1000000   12727.922      100            100            0.026332482    0.0039119707   0              0.075085476    0.13542424     0              6539.1517      1.1971759e-13  0              2.9939311    
   1100000   12727.922      100            100            0.026455066    0.0039004729   0              0.075464726    0.0030103118   0              145.35718      1.1971759e-13  0              2.993916     
   1200000   12727.922      100            100            0.026408844    0.003903186    0              0.075323345    0.0030341691   0              146.50917      1.1971759e-13  0              2.9939218    
   1300000   12727.922      100            100            0.026397063    0.0039038653   0              0.075287325    2.5595042e-06  0              0.1235893      1.1971759e-13  0              2.9939232    
   1400000   12727.922      100            100            0.026404484    0.0039034219   0              0.07531003     5.700576e-05   0              2.7526041      1.1971759e-13  0              2.9939223    
   1500000   12727.922      100            100            0.026405288    0.0039033771   0              0.075312488    3.2941137e-07  0              0.015906096    1.1971759e-13  0              2.9939222    
   1600000   12727.922      100            100            0.02640421     0.003903441    0              0.075309188    9.0649118e-07  0              0.043771215    1.1971759e-13  0              2.9939223    
   1700000   12727.922      100            100            0.026404214    0.0039034404   0              0.075309203    3.1099284e-08  0              0.0015016731   1.1971759e-13  0              2.9939223    
   1800000   12727.922      100            100            0.026404359    0.0039034319   0              0.075309644    1.1925777e-08  0              0.00057585308  1.1971759e-13  0              2.9939223    
   1900000   12727.922      100            100            0.026404343    0.0039034328   0              0.075309596    1.2279053e-09  0              5.9291154e-05  1.1971759e-13  0              2.9939223    
   2000000   12727.922      100            100            0.026404325    0.0039034339   0              0.075309542    1.2053036e-10  0              5.8199796e-06  1.1971759e-13  0              2.9939223    
   2100000   12727.922      100            100            0.026404329    0.0039034336   0              0.075309554    3.4137647e-11  0              1.6483848e-06  1.1971759e-13  0              2.9939223    
   2200000   12727.922      100            100            0.026404331    0.0039034335   0              0.07530956     7.4111637e-13  0              3.5785857e-08  1.1971759e-13  0              2.9939223    
   2300000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    7.6196908e-13  0              3.679276e-08   1.1971759e-13  0              2.9939223    
   2400000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    5.0627505e-16  0              2.444621e-11   1.1971759e-13  0              2.9939223    
   2500000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    1.4252244e-14  0              6.8818987e-10  1.1971759e-13  0              2.9939223    
   2600000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    5.795923e-17   0              2.7986438e-12  1.1971759e-13  0              2.9939223    
   2700000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    1.8143319e-16  0              8.7607595e-12  1.1971759e-13  0              2.9939223    
   2800000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    1.5056512e-17  0              7.2702509e-13  1.1971759e-13  0              2.9939223    
   2900000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    1.9657821e-18  0              9.4920582e-14  1.1971759e-13  0              2.9939223    
   3000000   12727.922      100            100            0.02640433     0.0039034336   0              0.075309557    6.1678078e-18  0              2.9782137e-13  1.1971759e-13  0              2.9939223    
Loop time of 536.435 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4831902.216 ns/day, 0.000 hours/ns, 5592.479 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.184     | 77.144     | 132.09     | 621.8 | 14.38
Neigh   | 2.3308     | 2.366      | 2.4005     |   1.8 |  0.44
Comm    | 13.371     | 19.047     | 23.939     |  92.7 |  3.55
Output  | 0.34187    | 0.34248    | 0.3431     |   0.1 |  0.06
Modify  | 320.57     | 332.76     | 345.24     |  61.5 | 62.03
Other   |            | 104.8      |            |       | 19.53

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 204
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1650 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.001139497   -1.2693241e-35  0             -0.0034184911   36740.415      0              1.7740631e+09  1.1971759e-13  0              3.7584546    
    200000   12727.922      100            100           -0.0014195299   1.5231906e-34  0             -0.0042585897   131202.86      0              6.3353164e+09  1.1971759e-13  0              3.1465827    
    300000   12727.922      100            100            0.00061908337 -6.3466247e-36  0              0.0018572501   10167.98       0              4.9097538e+08  1.1971759e-13  0              3.0393226    
    400000   12727.922      100            100            0.00016239848 -5.0772886e-35  0              0.00048719545  816.37388      0              39419773       1.1971759e-13  0              3.0045725    
    500000   12727.922      100            100            0.0071325358   0.0014210227   0              0.019976585    136.92887      0              6611805.1      1.1971759e-13  0              2.9968848    
    600000   12727.922      100            100            0.028646168    0.0030038938   0              0.082934611    546.09187      0              26368822       1.1971759e-13  0              2.9936072    
    700000   12727.922      100            100            0.029632921    0.0024567647   0              0.086441999    12.265504      0              592257.29      1.1971759e-13  0              2.9934865    
    800000   12727.922      100            100            0.028122664    0.0034294202   0              0.080938572    1.1650272      0              56254.994      1.1971759e-13  0              2.9937       
    900000   12727.922      100            100            0.027339194    0.0037424971   0              0.078275086    1.0391142      0              50175.105      1.1971759e-13  0              2.9938045    
   1000000   12727.922      100            100            0.02709894     0.0037296381   0              0.077567181    0.17276197     0              8342.0573      1.1971759e-13  0              2.9938322    
   1100000   12727.922      100            100            0.027085455    0.0037295997   0              0.077526766    0.0089067016   0              430.07275      1.1971759e-13  0              2.9938336    
   1200000   12727.922      100            100            0.02710868     0.003727395    0              0.077598644    1.0368513e-05  0              0.50065838     1.1971759e-13  0              2.9938306    
   1300000   12727.922      100            100            0.027123455    0.0037263131   0              0.077644051    0.00020853715  0              10.069513      1.1971759e-13  0              2.9938288    
   1400000   12727.922      100            100            0.027128539    0.003725949    0              0.077659667    5.772951e-05   0              2.7875514      1.1971759e-13  0              2.9938282    
   1500000   12727.922      100            100            0.027129385    0.0037258904   0              0.077662264    5.2405704e-06  0              0.25304839     1.1971759e-13  0              2.9938281    
   1600000   12727.922      100            100            0.027129174    0.0037259064   0              0.077661615    6.4805642e-08  0              0.0031292325   1.1971759e-13  0              2.9938281    
   1700000   12727.922      100            100            0.027128943    0.0037259232   0              0.077660906    2.7309832e-08  0              0.0013186941   1.1971759e-13  0              2.9938282    
   1800000   12727.922      100            100            0.027128843    0.0037259304   0              0.077660599    1.5876736e-08  0              0.00076663076  1.1971759e-13  0              2.9938282    
   1900000   12727.922      100            100            0.027128818    0.0037259321   0              0.077660523    2.2955723e-09  0              0.00011084497  1.1971759e-13  0              2.9938282    
   2000000   12727.922      100            100            0.027128818    0.0037259321   0              0.077660522    9.5135764e-11  0              4.5937656e-06  1.1971759e-13  0              2.9938282    
   2100000   12727.922      100            100            0.027128821    0.0037259319   0              0.077660531    9.9583023e-13  0              4.8085078e-08  1.1971759e-13  0              2.9938282    
   2200000   12727.922      100            100            0.027128823    0.0037259318   0              0.077660537    3.4657937e-12  0              1.6735077e-07  1.1971759e-13  0              2.9938282    
   2300000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    8.1258703e-13  0              3.9236919e-08  1.1971759e-13  0              2.9938282    
   2400000   12727.922      100            100            0.027128824    0.0037259317   0              0.077660539    6.3495782e-14  0              3.0659841e-09  1.1971759e-13  0              2.9938282    
   2500000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    3.6748116e-16  0              1.774435e-11   1.1971759e-13  0              2.9938282    
   2600000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    4.5981771e-16  0              2.2202952e-11  1.1971759e-13  0              2.9938282    
   2700000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    2.5827456e-16  0              1.2471154e-11  1.1971759e-13  0              2.9938282    
   2800000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    1.0031542e-17  0              4.8438727e-13  1.1971759e-13  0              2.9938282    
   2900000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    1.5581887e-17  0              7.5239356e-13  1.1971759e-13  0              2.9938282    
   3000000   12727.922      100            100            0.027128823    0.0037259317   0              0.077660539    5.8495631e-18  0              2.8245447e-13  1.1971759e-13  0              2.9938282    
Loop time of 539.37 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4805605.962 ns/day, 0.000 hours/ns, 5562.044 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.348     | 77.397     | 132.39     | 620.0 | 14.35
Neigh   | 2.3438     | 2.3786     | 2.4127     |   1.8 |  0.44
Comm    | 13.383     | 19.451     | 24.306     |  92.8 |  3.61
Output  | 0.3478     | 0.34844    | 0.34908    |   0.1 |  0.06
Modify  | 321.42     | 334.06     | 347.58     |  63.4 | 61.94
Other   |            | 105.7      |            |       | 19.60

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 206
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1700 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100           -0.00051185254  3.6847593e-40  0             -0.0015355576   6041.0334      0              2.9169988e+08  1.1971759e-13  0              3.7792909    
    200000   12727.922      100            100           -0.00093674885  8.8852766e-35  0             -0.0028102466   37029.369      0              1.7880157e+09  1.1971759e-13  0              3.1780983    
    300000   12727.922      100            100            0.0020973252   3.2216605e-39  0              0.0062919757   86840.115      0              4.1931984e+09  1.1971759e-13  0              3.0170854    
    400000   12727.922      100            100            0.08165879    -0.0084432731   0              0.25341964     13836.836      0              6.6813128e+08  1.1971759e-13  0              2.9888858    
    500000   12727.922      100            100            0.043991944   -0.0052277765   0              0.13720361     2103.3996      0              1.0156564e+08  1.1971759e-13  0              2.9917723    
    600000   12727.922      100            100            0.035038583   -0.0005719183   0              0.10568767     85.143375      0              4111268.9      1.1971759e-13  0              2.9928053    
    700000   12727.922      100            100            0.030474574    0.002024378    0              0.089399343    6.5516014      0              316353.38      1.1971759e-13  0              2.9933798    
    800000   12727.922      100            100            0.028842709    0.0029871118   0              0.083541017    0.041907509    0              2023.5636      1.1971759e-13  0              2.9935989    
    900000   12727.922      100            100            0.028218719    0.0033786025   0              0.081277553    0.040652859    0              1962.9811      1.1971759e-13  0              2.993686     
   1000000   12727.922      100            100            0.027950036    0.0034081173   0              0.08044199     0.028724173    0              1386.9875      1.1971759e-13  0              2.9937185    
   1100000   12727.922      100            100            0.027854994    0.0034164019   0              0.080148579    0.008800366    0              424.93818      1.1971759e-13  0              2.99373      
   1200000   12727.922      100            100            0.027823471    0.0034190007   0              0.080051412    0.0019449036   0              93.912436      1.1971759e-13  0              2.9937339    
   1300000   12727.922      100            100            0.027813777    0.0034198152   0              0.080021517    0.00035474514  0              17.129373      1.1971759e-13  0              2.993735     
   1400000   12727.922      100            100            0.027811097    0.0034200435   0              0.080013246    5.6288961e-05  0              2.7179925      1.1971759e-13  0              2.9937354    
   1500000   12727.922      100            100            0.027810487    0.0034200965   0              0.080011363    7.9449354e-06  0              0.38363249     1.1971759e-13  0              2.9937355    
   1600000   12727.922      100            100            0.027810411    0.0034201036   0              0.080011131    1.0035927e-06  0              0.048459899    1.1971759e-13  0              2.9937355    
   1700000   12727.922      100            100            0.02781044     0.0034201016   0              0.080011217    1.1266884e-07  0              0.0054403749   1.1971759e-13  0              2.9937355    
   1800000   12727.922      100            100            0.02781047     0.0034200992   0              0.08001131     1.0978745e-08  0              0.00053012432  1.1971759e-13  0              2.9937355    
   1900000   12727.922      100            100            0.027810487    0.0034200978   0              0.080011365    8.7814052e-10  0              4.2402263e-05  1.1971759e-13  0              2.9937355    
   2000000   12727.922      100            100            0.027810496    0.0034200971   0              0.080011391    4.9853638e-11  0              2.4072538e-06  1.1971759e-13  0              2.9937355    
   2100000   12727.922      100            100            0.0278105      0.0034200968   0              0.080011403    1.1169202e-12  0              5.3932081e-08  1.1971759e-13  0              2.9937355    
   2200000   12727.922      100            100            0.027810501    0.0034200966   0              0.080011407    3.7429116e-14  0              1.8073181e-09  1.1971759e-13  0              2.9937355    
   2300000   12727.922      100            100            0.027810502    0.0034200966   0              0.080011409    7.7924139e-14  0              3.7626778e-09  1.1971759e-13  0              2.9937355    
   2400000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     2.9611326e-14  0              1.429825e-09   1.1971759e-13  0              2.9937355    
   2500000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     7.4393106e-15  0              3.5921769e-10  1.1971759e-13  0              2.9937355    
   2600000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     1.4940109e-15  0              7.2140439e-11  1.1971759e-13  0              2.9937355    
   2700000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     1.800412e-16   0              8.6935451e-12  1.1971759e-13  0              2.9937355    
   2800000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     1.8380589e-17  0              8.8753286e-13  1.1971759e-13  0              2.9937355    
   2900000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     1.5047273e-18  0              7.2657894e-14  1.1971759e-13  0              2.9937355    
   3000000   12727.922      100            100            0.027810502    0.0034200966   0              0.08001141     1.1984486e-18  0              5.7868795e-14  1.1971759e-13  0              2.9937355    
Loop time of 538.613 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4812362.099 ns/day, 0.000 hours/ns, 5569.864 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.63      | 77.433     | 132.38     | 620.5 | 14.38
Neigh   | 2.3891     | 2.4227     | 2.456      |   1.8 |  0.45
Comm    | 13.672     | 19.166     | 24.087     |  92.7 |  3.56
Output  | 0.34595    | 0.34658    | 0.34722    |   0.1 |  0.06
Modify  | 322.93     | 334.8      | 346.11     |  59.7 | 62.16
Other   |            | 104.4      |            |       | 19.39

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 210
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1750 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0002557623  -3.8079745e-35  0              0.00076728689  1270.6763      0              61356411       1.1971759e-13  0              3.7921701    
    200000   12727.922      100            100           -0.00014265406 -1.6247297e-33  0             -0.00042796217  605.98488      0              29260841       1.1971759e-13  0              3.1928011    
    300000   12727.922      100            100            0.24207367    -0.036086986    0              0.762308       1416.7055      0              68407638       1.1971759e-13  0              2.9805831    
    400000   12727.922      100            100           -0.00056797188 -1.0154577e-34  0             -0.0017039156   13172.661      0              6.3606065e+08  1.1971759e-13  0              3.0006471    
    500000   12727.922      100            100            0.014795113    0.001739769    0              0.04264557     2838.4578      0              1.3705897e+08  1.1971759e-13  0              2.9954753    
    600000   12727.922      100            100            0.023921037    0.00431631     0              0.067446802    392.90034      0              18971751       1.1971759e-13  0              2.9942625    
    700000   12727.922      100            100            0.029779371    0.0026222893   0              0.086715824    63.517549      0              3067035.1      1.1971759e-13  0              2.9934833    
    800000   12727.922      100            100            0.029638445    0.0029755925   0              0.085939744    0.075262055    0              3634.1353      1.1971759e-13  0              2.9935074    
    900000   12727.922      100            100            0.028694703    0.0033676733   0              0.082716436    1.2886987      0              62226.65       1.1971759e-13  0              2.9936296    
   1000000   12727.922      100            100            0.028475929    0.0034455349   0              0.081982253    0.069839367    0              3372.2931      1.1971759e-13  0              2.9936585    
   1100000   12727.922      100            100            0.028546464    0.0034265907   0              0.0822128      0.0065749258   0              317.47963      1.1971759e-13  0              2.9936498    
   1200000   12727.922      100            100            0.028597591    0.0034197537   0              0.082373018    0.0032706137   0              157.92623      1.1971759e-13  0              2.9936436    
   1300000   12727.922      100            100            0.028601451    0.0034192527   0              0.082385099    1.9907371e-05  0              0.96125572     1.1971759e-13  0              2.9936431    
   1400000   12727.922      100            100            0.028595604    0.0034199495   0              0.082366862    4.181436e-05   0              2.0190658      1.1971759e-13  0              2.9936438    
   1500000   12727.922      100            100            0.028593521    0.0034202049   0              0.082360357    5.4331905e-06  0              0.26234932     1.1971759e-13  0              2.9936441    
   1600000   12727.922      100            100            0.028593745    0.0034201794   0              0.082361057    5.8378989e-08  0              0.0028189124   1.1971759e-13  0              2.9936441    
   1700000   12727.922      100            100            0.028594085    0.0034201383   0              0.082362116    1.4217648e-07  0              0.0068651935   1.1971759e-13  0              2.993644     
   1800000   12727.922      100            100            0.028594145    0.0034201307   0              0.082362306    4.7186093e-09  0              0.00022784476  1.1971759e-13  0              2.993644     
   1900000   12727.922      100            100            0.028594116    0.0034201342   0              0.082362215    1.030933e-09   0              4.9780064e-05  1.1971759e-13  0              2.993644     
   2000000   12727.922      100            100            0.0285941      0.0034201361   0              0.082362165    3.1715902e-10  0              1.5314474e-05  1.1971759e-13  0              2.993644     
   2100000   12727.922      100            100            0.0285941      0.0034201362   0              0.082362164    2.2206632e-13  0              1.0722788e-08  1.1971759e-13  0              2.993644     
   2200000   12727.922      100            100            0.028594102    0.0034201359   0              0.08236217     5.1068764e-12  0              2.4659278e-07  1.1971759e-13  0              2.993644     
   2300000   12727.922      100            100            0.028594103    0.0034201359   0              0.082362172    4.4754313e-13  0              2.1610256e-08  1.1971759e-13  0              2.993644     
   2400000   12727.922      100            100            0.028594103    0.0034201359   0              0.082362172    1.4885874e-14  0              7.1878557e-10  1.1971759e-13  0              2.993644     
   2500000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    1.5065172e-14  0              7.2744323e-10  1.1971759e-13  0              2.993644     
   2600000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    2.5149516e-16  0              1.2143801e-11  1.1971759e-13  0              2.993644     
   2700000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    6.5090533e-17  0              3.1429889e-12  1.1971759e-13  0              2.993644     
   2800000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    3.301819e-17   0              1.5943302e-12  1.1971759e-13  0              2.993644     
   2900000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    4.300832e-19   0              2.0767179e-14  1.1971759e-13  0              2.993644     
   3000000   12727.922      100            100            0.028594102    0.0034201359   0              0.082362171    5.4743762e-18  0              2.6433804e-13  1.1971759e-13  0              2.993644     
Loop time of 538.759 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4811059.654 ns/day, 0.000 hours/ns, 5568.356 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.668     | 77.49      | 132.52     | 620.4 | 14.38
Neigh   | 2.4521     | 2.4869     | 2.5211     |   1.8 |  0.46
Comm    | 13.462     | 18.97      | 23.786     |  92.1 |  3.52
Output  | 0.34584    | 0.34648    | 0.34711    |   0.1 |  0.06
Modify  | 322.64     | 334.87     | 346.37     |  60.1 | 62.16
Other   |            | 104.6      |            |       | 19.41

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 214
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1800 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0011568923   5.1887805e-40  0              0.0034706769   22051.669      0              1.0647962e+09  1.1971759e-13  0              3.7975163    
    200000   12727.922      100            100            0.00093797938  7.6159521e-35  0              0.0028139381   19990.267      0              9.6525843e+08  1.1971759e-13  0              3.1915423    
    300000   12727.922      100            100           -0.0012059064   2.0309435e-34  0             -0.0036177191   91364.801      0              4.4116793e+09  1.1971759e-13  0              3.0146347    
    400000   12727.922      100            100            0.00063991098  4.468028e-33   0              0.0019197329   11035.724      0              5.3287563e+08  1.1971759e-13  0              3.0014686    
    500000   12727.922      100            100            0.030537835    0.0040252428   0              0.087588263    4543.0105      0              2.1936572e+08  1.1971759e-13  0              2.9934056    
    600000   12727.922      100            100            0.02406066     0.0054339338   0              0.066748046    325.86693      0              15734948       1.1971759e-13  0              2.9942651    
    700000   12727.922      100            100            0.028054915    0.003860807    0              0.080303937    63.199985      0              3051701.1      1.1971759e-13  0              2.9937291    
    800000   12727.922      100            100            0.030305733    0.0025780027   0              0.088339197    0.11408863     0              5508.9316      1.1971759e-13  0              2.9934173    
    900000   12727.922      100            100            0.028963838    0.0030379032   0              0.08385361     0.83286613     0              40216.125      1.1971759e-13  0              2.9935861    
   1000000   12727.922      100            100            0.029196514    0.0030018384   0              0.084587704    0.17695754     0              8544.6465      1.1971759e-13  0              2.993559     
   1100000   12727.922      100            100            0.029294405    0.0030034431   0              0.084879772    0.0028422942   0              137.24421      1.1971759e-13  0              2.9935476    
   1200000   12727.922      100            100            0.029223771    0.0030115596   0              0.084659752    0.0011604694   0              56.034916      1.1971759e-13  0              2.9935559    
   1300000   12727.922      100            100            0.029240769    0.0030096402   0              0.084712667    0.00045746954  0              22.089567      1.1971759e-13  0              2.993554     
   1400000   12727.922      100            100            0.029243119    0.0030093529   0              0.084720004    1.9199764e-05  0              0.92708787     1.1971759e-13  0              2.9935537    
   1500000   12727.922      100            100            0.029239859    0.00300973     0              0.084709847    1.0662888e-06  0              0.05148727     1.1971759e-13  0              2.9935541    
   1600000   12727.922      100            100            0.029240908    0.0030096107   0              0.084713112    1.0380992e-06  0              0.050126093    1.1971759e-13  0              2.9935539    
   1700000   12727.922      100            100            0.029240906    0.0030096101   0              0.084713107    8.2833091e-08  0              0.0039997135   1.1971759e-13  0              2.9935539    
   1800000   12727.922      100            100            0.029240766    0.0030096263   0              0.084712672    2.5973856e-10  0              1.2541846e-05  1.1971759e-13  0              2.993554     
   1900000   12727.922      100            100            0.029240825    0.0030096196   0              0.084712854    2.0516505e-09  0              9.9066859e-05  1.1971759e-13  0              2.9935539    
   2000000   12727.922      100            100            0.029240819    0.0030096202   0              0.084712836    2.8177861e-10  0              1.3606081e-05  1.1971759e-13  0              2.9935539    
   2100000   12727.922      100            100            0.029240813    0.0030096209   0              0.084712819    9.096563e-13   0              4.3924047e-08  1.1971759e-13  0              2.9935539    
   2200000   12727.922      100            100            0.029240816    0.0030096205   0              0.084712829    3.4217412e-12  0              1.6522363e-07  1.1971759e-13  0              2.9935539    
   2300000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    8.117883e-13   0              3.9198352e-08  1.1971759e-13  0              2.9935539    
   2400000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    1.694606e-14   0              8.1826457e-10  1.1971759e-13  0              2.9935539    
   2500000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    4.2543254e-15  0              2.0542615e-10  1.1971759e-13  0              2.9935539    
   2600000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    2.0439584e-15  0              9.8695436e-11  1.1971759e-13  0              2.9935539    
   2700000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    3.2909695e-17  0              1.5890914e-12  1.1971759e-13  0              2.9935539    
   2800000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    2.2472479e-17  0              1.0851156e-12  1.1971759e-13  0              2.9935539    
   2900000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    9.481111e-20   0              4.5780892e-15  1.1971759e-13  0              2.9935539    
   3000000   12727.922      100            100            0.029240816    0.0030096206   0              0.084712827    4.8759526e-18  0              2.354423e-13   1.1971759e-13  0              2.9935539    
Loop time of 537.149 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4825478.957 ns/day, 0.000 hours/ns, 5585.045 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.648     | 77.673     | 133.21     | 619.8 | 14.46
Neigh   | 2.5013     | 2.5348     | 2.5671     |   1.9 |  0.47
Comm    | 13.545     | 19.208     | 23.525     |  92.7 |  3.58
Output  | 0.34169    | 0.34232    | 0.34295    |   0.1 |  0.06
Modify  | 319.61     | 331.96     | 345.21     |  62.5 | 61.80
Other   |            | 105.4      |            |       | 19.63

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 220
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1850 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0021857031  -1.0154585e-34  0              0.0065571092   68061.863      0              3.2864638e+09  1.1971759e-13  0              3.7957162    
    200000   12727.922      100            100            0.0022828111  -2.8432873e-33  0              0.0068484334   93469.963      0              4.51333e+09    1.1971759e-13  0              3.1750987    
    300000   12727.922      100            100           -0.00052697227  8.1363623e-40  0             -0.0015809168   10784.631      0              5.2075125e+08  1.1971759e-13  0              3.0372428    
    400000   12727.922      100            100            0.10934917     0.00050843745  0              0.32753908     3712.2739      0              1.7925242e+08  1.1971759e-13  0              2.9872825    
    500000   12727.922      100            100            0.027508876    0.001966512    0              0.080560117    4601.692       0              2.2219924e+08  1.1971759e-13  0              2.9937615    
    600000   12727.922      100            100            0.03772353    -0.0011986235   0              0.11436921     68.416642      0              3303594.8      1.1971759e-13  0              2.9925052    
    700000   12727.922      100            100            0.027029861    0.0038635456   0              0.077226037    0.59815902     0              28882.958      1.1971759e-13  0              2.9938457    
    800000   12727.922      100            100            0.030895324    0.0019182561   0              0.090767717    0.00015110872  0              7.2964995      1.1971759e-13  0              2.9933276    
    900000   12727.922      100            100            0.029353413    0.0023361647   0              0.085724075    0.0070198027   0              338.96115      1.1971759e-13  0              2.9935155    
   1000000   12727.922      100            100            0.029939705    0.0022677033   0              0.087551411    0.0040345757   0              194.81522      1.1971759e-13  0              2.9934469    
   1100000   12727.922      100            100            0.029726811    0.0022928057   0              0.086887627    0.001314164    0              63.456274      1.1971759e-13  0              2.9934717    
   1200000   12727.922      100            100            0.029803267    0.0022834941   0              0.087126307    0.00032397992  0              15.643831      1.1971759e-13  0              2.9934628    
   1300000   12727.922      100            100            0.029775942    0.0022867994   0              0.087041027    6.8391214e-05  0              3.302367       1.1971759e-13  0              2.9934659    
   1400000   12727.922      100            100            0.029785627    0.0022856275   0              0.087071253    1.3118982e-05  0              0.63346867     1.1971759e-13  0              2.9934648    
   1500000   12727.922      100            100            0.029782222    0.0022860386   0              0.087060626    2.3538552e-06  0              0.11365925     1.1971759e-13  0              2.9934652    
   1600000   12727.922      100            100            0.029783408    0.0022858956   0              0.087064329    4.0193959e-07  0              0.019408224    1.1971759e-13  0              2.9934651    
   1700000   12727.922      100            100            0.029782999    0.0022859448   0              0.087063051    6.6023654e-08  0              0.0031880459   1.1971759e-13  0              2.9934651    
   1800000   12727.922      100            100            0.029783138    0.002285928    0              0.087063487    1.0508374e-08  0              0.00050741178  1.1971759e-13  0              2.9934651    
   1900000   12727.922      100            100            0.029783091    0.0022859337   0              0.08706334     1.6286864e-09  0              7.8643439e-05  1.1971759e-13  0              2.9934651    
   2000000   12727.922      100            100            0.029783107    0.0022859318   0              0.087063389    2.4672443e-10  0              1.191344e-05   1.1971759e-13  0              2.9934651    
   2100000   12727.922      100            100            0.029783102    0.0022859324   0              0.087063373    3.6629524e-11  0              1.7687086e-06  1.1971759e-13  0              2.9934651    
   2200000   12727.922      100            100            0.029783104    0.0022859322   0              0.087063378    5.3365539e-12  0              2.5768309e-07  1.1971759e-13  0              2.9934651    
   2300000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    7.6447518e-13  0              3.6913771e-08  1.1971759e-13  0              2.9934651    
   2400000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    1.0783571e-13  0              5.2070003e-09  1.1971759e-13  0              2.9934651    
   2500000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    1.4945083e-14  0              7.2164457e-10  1.1971759e-13  0              2.9934651    
   2600000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    2.0458984e-15  0              9.8789112e-11  1.1971759e-13  0              2.9934651    
   2700000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    2.5591862e-16  0              1.2357394e-11  1.1971759e-13  0              2.9934651    
   2800000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    1.5103703e-17  0              7.2930376e-13  1.1971759e-13  0              2.9934651    
   2900000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    2.881132e-18   0              1.3911955e-13  1.1971759e-13  0              2.9934651    
   3000000   12727.922      100            100            0.029783103    0.0022859323   0              0.087063377    9.7843802e-19  0              4.724527e-14   1.1971759e-13  0              2.9934651    
Loop time of 537.521 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4822139.495 ns/day, 0.000 hours/ns, 5581.180 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.586     | 77.512     | 132.48     | 621.7 | 14.42
Neigh   | 2.5522     | 2.5881     | 2.623      |   1.9 |  0.48
Comm    | 13.49      | 19.136     | 24.283     |  95.7 |  3.56
Output  | 0.3413     | 0.3419     | 0.34252    |   0.1 |  0.06
Modify  | 322.14     | 333.73     | 345.07     |  57.7 | 62.09
Other   |            | 104.2      |            |       | 19.39

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.75 ave        1376 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2751
Ave neighs/atom = 0.55008998
Neighbor list builds = 224
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1900 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0033368971   2.0309296e-34  0              0.010010691    139026.17      0              6.7130762e+09  1.1971759e-13  0              3.7871238    
    200000   12727.922      100            100            0.0038716041  -2.030918e-34   0              0.011614812    219529.83      0              1.060031e+10   1.1971759e-13  0              3.144182     
    300000   12727.922      100            100            0.00055916458 -4.0618326e-34  0              0.0016774937   8429.9035      0              4.0704987e+08  1.1971759e-13  0              3.0389474    
    400000   12727.922      100            100           -0.00033645967 -4.0618056e-34  0             -0.001009379    4152.7052      0              2.0051927e+08  1.1971759e-13  0              3.00301      
    500000   12727.922      100            100            0.021989793    0.0051601357   0              0.060809244    4017.1935      0              1.939759e+08   1.1971759e-13  0              2.9944934    
    600000   12727.922      100            100            0.029359335    0.0036583123   0              0.084419693    602.5355       0              29094283       1.1971759e-13  0              2.9935812    
    700000   12727.922      100            100            0.029108672    0.0032362884   0              0.084089727    60.191585      0              2906436.2      1.1971759e-13  0              2.9935726    
    800000   12727.922      100            100            0.031654298    0.0018890105   0              0.093073884    0.59893719     0              28920.533      1.1971759e-13  0              2.9932437    
    900000   12727.922      100            100            0.030170376    0.0022193773   0              0.088291751    0.46244811     0              22329.964      1.1971759e-13  0              2.9934195    
   1000000   12727.922      100            100            0.030559408    0.0022026902   0              0.089475535    0.19324862     0              9331.2844      1.1971759e-13  0              2.9933749    
   1100000   12727.922      100            100            0.030577716    0.0021990288   0              0.089534119    0.015126734    0              730.41584      1.1971759e-13  0              2.9933731    
   1200000   12727.922      100            100            0.030517611    0.0022059009   0              0.089346932    9.9140687e-07  0              0.04787149     1.1971759e-13  0              2.9933799    
   1300000   12727.922      100            100            0.030544356    0.0022027906   0              0.089430277    0.00025548426  0              12.33642       1.1971759e-13  0              2.9933768    
   1400000   12727.922      100            100            0.030539385    0.0022033822   0              0.089414773    6.2628422e-05  0              3.0241023      1.1971759e-13  0              2.9933774    
   1500000   12727.922      100            100            0.030538222    0.0022035104   0              0.089411157    2.9298828e-06  0              0.14147356     1.1971759e-13  0              2.9933775    
   1600000   12727.922      100            100            0.030539454    0.0022033687   0              0.089414994    5.1363805e-08  0              0.0024801743   1.1971759e-13  0              2.9933774    
   1700000   12727.922      100            100            0.03053901     0.0022034205   0              0.08941361     1.1530119e-07  0              0.0055674816   1.1971759e-13  0              2.9933775    
   1800000   12727.922      100            100            0.030539061    0.0022034143   0              0.08941377     1.8208722e-08  0              0.00087923403  1.1971759e-13  0              2.9933774    
   1900000   12727.922      100            100            0.030539096    0.0022034104   0              0.089413877    4.084657e-10   0              1.9723347e-05  1.1971759e-13  0              2.9933774    
   2000000   12727.922      100            100            0.030539072    0.0022034131   0              0.089413804    6.7787648e-11  0              3.2732229e-06  1.1971759e-13  0              2.9933774    
   2100000   12727.922      100            100            0.030539079    0.0022034123   0              0.089413825    4.5082901e-11  0              2.1768919e-06  1.1971759e-13  0              2.9933774    
   2200000   12727.922      100            100            0.030539079    0.0022034123   0              0.089413825    4.6879722e-12  0              2.263654e-07   1.1971759e-13  0              2.9933774    
   2300000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413822    2.3979698e-14  0              1.1578938e-09  1.1971759e-13  0              2.9933774    
   2400000   12727.922      100            100            0.030539079    0.0022034124   0              0.089413823    4.5763928e-14  0              2.2097763e-09  1.1971759e-13  0              2.9933774    
   2500000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    1.5665372e-14  0              7.5642474e-10  1.1971759e-13  0              2.9933774    
   2600000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    9.8944038e-16  0              4.7776535e-11  1.1971759e-13  0              2.9933774    
   2700000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    1.1129029e-17  0              5.3738099e-13  1.1971759e-13  0              2.9933774    
   2800000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    3.4508238e-19  0              1.6662793e-14  1.1971759e-13  0              2.9933774    
   2900000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    2.8816229e-19  0              1.3914325e-14  1.1971759e-13  0              2.9933774    
   3000000   12727.922      100            100            0.030539078    0.0022034124   0              0.089413823    1.4119109e-17  0              6.8176126e-13  1.1971759e-13  0              2.9933774    
Loop time of 538.401 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4814252.866 ns/day, 0.000 hours/ns, 5572.052 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.363     | 77.523     | 133.02     | 623.6 | 14.40
Neigh   | 2.559      | 2.5922     | 2.6254     |   1.8 |  0.48
Comm    | 13.466     | 19.767     | 26.316     | 114.6 |  3.67
Output  | 0.34359    | 0.34422    | 0.34484    |   0.1 |  0.06
Modify  | 323        | 333.84     | 344.38     |  53.7 | 62.01
Other   |            | 104.3      |            |       | 19.38

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 224
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1950 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.0046056429   1.015461e-34   0              0.013816929    234709.51      0              1.1333282e+10  1.1971759e-13  0              3.7720638    
    200000   12727.922      100            100            0.0056859437   6.8296988e-41  0              0.017057831    396823.81      0              1.9161202e+10  1.1971759e-13  0              3.099446     
    300000   12727.922      100            100            0.002015129   -5.0772956e-35  0              0.006045387    81184.618      0              3.9201147e+09  1.1971759e-13  0              3.0207085    
    400000   12727.922      100            100            0.0034997386   6.9973063e-05  0              0.010429243    23592.742      0              1.1392091e+09  1.1971759e-13  0              2.9980815    
    500000   12727.922      100            100            0.03678108    -0.0014214736   0              0.11176471     4534.3755      0              2.1894877e+08  1.1971759e-13  0              2.9926354    
    600000   12727.922      100            100            0.025177607    0.0057902158   0              0.069742605    227.34109      0              10977488       1.1971759e-13  0              2.9941404    
    700000   12727.922      100            100            0.03304655     0.00082571021  0              0.09831394     50.579888      0              2442321.8      1.1971759e-13  0              2.9930515    
    800000   12727.922      100            100            0.032334031    0.0020328188   0              0.094969274    3.3298819      0              160788.08      1.1971759e-13  0              2.9931758    
    900000   12727.922      100            100            0.031107677    0.0021539112   0              0.09116912     1.2067048      0              58267.455      1.1971759e-13  0              2.9933134    
   1000000   12727.922      100            100            0.03115836     0.0021899686   0              0.09128511     0.02165448     0              1045.6173      1.1971759e-13  0              2.9933084    
   1100000   12727.922      100            100            0.031325277    0.0021707901   0              0.091805041    0.025348139    0              1223.9709      1.1971759e-13  0              2.9932893    
   1200000   12727.922      100            100            0.031333818    0.0021699306   0              0.091831522    5.5944191e-05  0              2.7013447      1.1971759e-13  0              2.9932884    
   1300000   12727.922      100            100            0.031312081    0.0021724078   0              0.091763836    0.00047917785  0              23.137783      1.1971759e-13  0              2.9932909    
   1400000   12727.922      100            100            0.031309278    0.0021727126   0              0.091755122    4.5317263e-07  0              0.021882084    1.1971759e-13  0              2.9932912    
   1500000   12727.922      100            100            0.031311974    0.0021724037   0              0.091763517    8.2930058e-06  0              0.40043957     1.1971759e-13  0              2.9932909    
   1600000   12727.922      100            100            0.031312555    0.0021723393   0              0.091765327    9.6382442e-08  0              0.0046539632   1.1971759e-13  0              2.9932909    
   1700000   12727.922      100            100            0.031312239    0.0021723757   0              0.091764341    1.3095258e-07  0              0.0063232313   1.1971759e-13  0              2.9932909    
   1800000   12727.922      100            100            0.031312137    0.0021723871   0              0.091764023    4.7963538e-09  0              0.00023159876  1.1971759e-13  0              2.9932909    
   1900000   12727.922      100            100            0.031312171    0.0021723831   0              0.091764131    1.8627235e-09  0              8.9944249e-05  1.1971759e-13  0              2.9932909    
   2000000   12727.922      100            100            0.031312188    0.0021723813   0              0.091764182    1.5813176e-10  0              7.6356167e-06  1.1971759e-13  0              2.9932909    
   2100000   12727.922      100            100            0.031312184    0.0021723817   0              0.091764171    2.3209146e-11  0              1.1206866e-06  1.1971759e-13  0              2.9932909    
   2200000   12727.922      100            100            0.031312182    0.002172382    0              0.091764164    4.2151809e-12  0              2.03536e-07    1.1971759e-13  0              2.9932909    
   2300000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764164    2.3801607e-13  0              1.1492944e-08  1.1971759e-13  0              2.9932909    
   2400000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    9.7688084e-14  0              4.717008e-09   1.1971759e-13  0              2.9932909    
   2500000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    1.7512337e-15  0              8.4560808e-11  1.1971759e-13  0              2.9932909    
   2600000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    2.0110024e-15  0              9.7104111e-11  1.1971759e-13  0              2.9932909    
   2700000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    5.0879843e-17  0              2.4568055e-12  1.1971759e-13  0              2.9932909    
   2800000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    8.2168366e-18  0              3.9676163e-13  1.1971759e-13  0              2.9932909    
   2900000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    3.8279752e-18  0              1.8483922e-13  1.1971759e-13  0              2.9932909    
   3000000   12727.922      100            100            0.031312182    0.0021723819   0              0.091764165    4.8306795e-18  0              2.3325623e-13  1.1971759e-13  0              2.9932909    
Loop time of 540.76 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4793253.836 ns/day, 0.000 hours/ns, 5547.747 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.527     | 77.909     | 133.05     | 624.6 | 14.41
Neigh   | 2.5688     | 2.6114     | 2.6537     |   2.0 |  0.48
Comm    | 13.688     | 19.426     | 24.885     |  96.4 |  3.59
Output  | 0.34332    | 0.34393    | 0.34455    |   0.1 |  0.06
Modify  | 324.15     | 335.65     | 346.98     |  56.1 | 62.07
Other   |            | 104.8      |            |       | 19.38

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 224
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))          # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 ${n1e1} -50 50 -50 50 units box
region box block -6363.96103067894 6363.96103067894 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6363.96103067894 6363.96103067894 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -50 -50) to (6363.961 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -2000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 51.26 | 51.27 | 51.29 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      100            100            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      100            100            0.005987517    1.3608945e-39  0              0.017962551    354911.03      0              1.7137383e+10  1.1971759e-13  0              3.7508352    
    200000   12727.922      100            100            0.007709009    4.0618424e-34  0              0.023127027    624152.39      0              3.0138085e+10  1.1971759e-13  0              3.0414932    
    300000   12727.922      100            100            0.15891929    -0.0074223925   0              0.48418027     117923.93      0              5.6941244e+09  1.1971759e-13  0              2.9846661    
    400000   12727.922      100            100            0.081382752   -0.010864712    0              0.25501297     19980.393      0              9.6478166e+08  1.1971759e-13  0              2.9887552    
    500000   12727.922      100            100            0.019485407    0.0054213394   0              0.053034881    3373.6976      0              1.6290378e+08  1.1971759e-13  0              2.9948547    
    600000   12727.922      100            100            0.040466692   -0.0016553948   0              0.12305547     54.784816      0              2645362.7      1.1971759e-13  0              2.9922261    
    700000   12727.922      100            100            0.03484561     0.00075369274  0              0.10378314     16.059545      0              775457.95      1.1971759e-13  0              2.9928673    
    800000   12727.922      100            100            0.032620499    0.0017303617   0              0.096131135    8.3039995      0              400970.42      1.1971759e-13  0              2.9931348    
    900000   12727.922      100            100            0.03190772     0.0016160098   0              0.094107152    1.514662       0              73137.607      1.1971759e-13  0              2.9932065    
   1000000   12727.922      100            100            0.031825965    0.0016369582   0              0.093840935    0.14389397     0              6948.125       1.1971759e-13  0              2.9932156    
   1100000   12727.922      100            100            0.031855675    0.0016218555   0              0.093945168    0.0049703769   0              240.00171      1.1971759e-13  0              2.9932116    
   1200000   12727.922      100            100            0.031887916    0.0016177101   0              0.094046038    4.8640579e-05  0              2.3486795      1.1971759e-13  0              2.9932079    
   1300000   12727.922      100            100            0.031903681    0.0016164261   0              0.094094618    0.00018922355  0              9.1369282      1.1971759e-13  0              2.9932062    
   1400000   12727.922      100            100            0.031909031    0.0016158214   0              0.09411127     5.7893135e-05  0              2.7954523      1.1971759e-13  0              2.9932056    
   1500000   12727.922      100            100            0.031910257    0.0016156642   0              0.094115108    8.316849e-06   0              0.40159087     1.1971759e-13  0              2.9932054    
   1600000   12727.922      100            100            0.031910307    0.0016156593   0              0.094115262    5.9663825e-07  0              0.028809526    1.1971759e-13  0              2.9932054    
   1700000   12727.922      100            100            0.031910174    0.0016156773   0              0.094114843    8.7649555e-09  0              0.00042322833  1.1971759e-13  0              2.9932054    
   1800000   12727.922      100            100            0.031910084    0.0016156892   0              0.094114563    2.0495303e-09  0              9.8964483e-05  1.1971759e-13  0              2.9932054    
   1900000   12727.922      100            100            0.031910046    0.0016156941   0              0.094114445    1.6526745e-09  0              7.9801735e-05  1.1971759e-13  0              2.9932055    
   2000000   12727.922      100            100            0.031910035    0.0016156956   0              0.094114409    3.6814309e-10  0              1.7776312e-05  1.1971759e-13  0              2.9932055    
   2100000   12727.922      100            100            0.031910033    0.0016156958   0              0.094114403    4.1913943e-11  0              2.0238743e-06  1.1971759e-13  0              2.9932055    
   2200000   12727.922      100            100            0.031910033    0.0016156958   0              0.094114403    2.1068222e-12  0              1.017309e-07   1.1971759e-13  0              2.9932055    
   2300000   12727.922      100            100            0.031910034    0.0016156958   0              0.094114405    1.1389307e-15  0              5.4994888e-11  1.1971759e-13  0              2.9932055    
   2400000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    2.9728141e-14  0              1.4354655e-09  1.1971759e-13  0              2.9932055    
   2500000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    1.2564693e-14  0              6.0670404e-10  1.1971759e-13  0              2.9932055    
   2600000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    2.1542579e-15  0              1.040214e-10   1.1971759e-13  0              2.9932055    
   2700000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    1.2515011e-16  0              6.0430509e-12  1.1971759e-13  0              2.9932055    
   2800000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    1.2538565e-17  0              6.0544242e-13  1.1971759e-13  0              2.9932055    
   2900000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    1.7056438e-20  0              8.2359436e-16  1.1971759e-13  0              2.9932055    
   3000000   12727.922      100            100            0.031910034    0.0016156957   0              0.094114406    4.7364857e-18  0              2.2870795e-13  1.1971759e-13  0              2.9932055    
Loop time of 539.385 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4805473.677 ns/day, 0.000 hours/ns, 5561.891 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.217     | 77.651     | 132.85     | 626.3 | 14.40
Neigh   | 2.6234     | 2.6623     | 2.7007     |   1.9 |  0.49
Comm    | 13.624     | 19.372     | 24.741     |  96.8 |  3.59
Output  | 0.34349    | 0.34411    | 0.34474    |   0.1 |  0.06
Modify  | 321.54     | 333.69     | 346.47     |  61.0 | 61.87
Other   |            | 105.7      |            |       | 19.59

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 228
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 5:58:22

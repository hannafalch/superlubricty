LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.003 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -50 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0018885251   0              0              0.0056655752   7519.6195      0              7.2619103e+08 -5.9828895e-14  0              5.5437025    
    200000   4500           100            100            0.0018857982   0              0              0.0056573945   9692.6663      0              9.3604834e+08 -5.9828895e-14  0              4.7869199    
    300000   4500           100            100            0.0016236604   0              0              0.0048709813   10007.911      0              9.6649245e+08 -5.9828895e-14  0              3.9894717    
    400000   4500           100            100            0.0013298812   0              0              0.0039896436   10050.962      0              9.7064995e+08 -5.9828895e-14  0              3.1865202    
    500000   4500           100            100            0.00067666873 -1.4024194e-37  0              0.0020300062   3190.1571      0              3.0808254e+08 -5.9828895e-14  0              3.0144719    
    600000   4500           100            100           -0.00017282703  1.2998224e-44  0             -0.00051848109  251.28268      0              24267083      -5.9828895e-14  0              3.0123225    
    700000   4500           100            100            5.2731032e-05 -2.8048388e-37  0              0.00015819309  22.278533      0              2151501.2     -5.9828895e-14  0              3.0043546    
    800000   4500           100            100            8.1458475e-05  1.4024194e-37  0              0.00024437543  52.942475      0              5112805.3     -5.9828895e-14  0              3.0000082    
    900000   4500           100            100            2.5282386e-05  2.9913797e-46  0              7.5847158e-05  5.1741787      0              499685.14     -5.9828895e-14  0              3.0000757    
   1000000   4500           100            100            0.0016140174  -7.0120969e-38  0              0.0048420521   1.5355912      0              148296.4      -5.9828895e-14  0              2.9998913    
   1100000   4500           100            100            0.00098485674 -1.4024194e-37  0              0.0029545702   0.22531896     0              21759.692     -5.9828895e-14  0              2.999921     
   1200000   4500           100            100            0.0012835016   2.1912803e-38  0              0.0038505048   5.3248903e-05  0              5.1423979     -5.9828895e-14  0              2.9999061    
   1300000   4500           100            100            0.0011152432   2.1912803e-39  0              0.0033457295   0.0043916059   0              424.10986     -5.9828895e-14  0              2.9999146    
   1400000   4500           100            100            0.0010896806  -1.0956401e-39  0              0.0032690418   4.3459486e-06  0              0.41970061    -5.9828895e-14  0              2.9999158    
   1500000   4500           100            100            0.0011110908   2.1912803e-39  0              0.0033332723   7.8032724e-05  0              7.535842      -5.9828895e-14  0              2.9999147    
   1600000   4500           100            100            0.001115188    1.0956401e-39  0              0.003345564    2.930399e-07   0              0.028299696   -5.9828895e-14  0              2.9999145    
   1700000   4500           100            100            0.0011124263   7.9284582e-51  0              0.0033372789   1.3689169e-06  0              0.1322002     -5.9828895e-14  0              2.9999147    
   1800000   4500           100            100            0.0011117953   3.6752726e-51  0              0.003335386    1.1546628e-08  0              0.0011150906  -5.9828895e-14  0              2.9999147    
   1900000   4500           100            100            0.0011121472   2.5679066e-41  0              0.0033364415   2.3677784e-08  0              0.0022866309  -5.9828895e-14  0              2.9999147    
   2000000   4500           100            100            0.0011122424   4.7879832e-52  0              0.0033367271   3.6118504e-10  0              3.4880666e-05 -5.9828895e-14  0              2.9999147    
   2100000   4500           100            100            0.001112198   -3.4238755e-41  0              0.0033365939   4.037073e-10   0              3.8987161e-05 -5.9828895e-14  0              2.9999147    
   2200000   4500           100            100            0.0011121839  -1.3695502e-40  0              0.0033365516   9.9163937e-12  0              9.5765433e-07 -5.9828895e-14  0              2.9999147    
   2300000   4500           100            100            0.0011121894   2.0543253e-40  0              0.0033365682   6.7782623e-12  0              6.5459606e-07 -5.9828895e-14  0              2.9999147    
   2400000   4500           100            100            0.0011121915   3.4737323e-57  0              0.0033365744   2.5041798e-13  0              2.4183576e-08 -5.9828895e-14  0              2.9999147    
   2500000   4500           100            100            0.0011121908  -1.3695502e-40  0              0.0033365723   1.1202599e-13  0              1.0818668e-08 -5.9828895e-14  0              2.9999147    
   2600000   4500           100            100            0.0011121905  -6.8477509e-41  0              0.0033365714   5.914535e-15   0              5.7118345e-10 -5.9828895e-14  0              2.9999147    
   2700000   4500           100            100            0.0011121906   1.477566e-58   0              0.0033365717   1.8025227e-15  0              1.7407474e-10 -5.9828895e-14  0              2.9999147    
   2800000   4500           100            100            0.0011121906   6.8477509e-41  0              0.0033365718   1.5678e-16     0              1.514069e-11  -5.9828895e-14  0              2.9999147    
   2900000   4500           100            100            0.0011121906   1.6242001e-60  0              0.0033365718   3.0655595e-17  0              2.9604979e-12 -5.9828895e-14  0              2.9999147    
   3000000   4500           100            100            0.0011121906  -1.3695502e-40  0              0.0033365718   7.3582928e-18  0              7.1061125e-13 -5.9828895e-14  0              2.9999147    
Loop time of 337.354 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7683319.747 ns/day, 0.000 hours/ns, 8892.731 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.619     | 103.45     | 138.87     | 314.2 | 30.66
Neigh   | 0.26934    | 0.27107    | 0.27403    |   0.3 |  0.08
Comm    | 23.425     | 56.827     | 91.763     | 400.3 | 16.84
Output  | 0.1958     | 0.196      | 0.19623    |   0.0 |  0.06
Modify  | 119.49     | 139.33     | 156.38     | 139.4 | 41.30
Other   |            | 37.28      |            |       | 11.05

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 64
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -100 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0037073091   0              0              0.011121927    30078.478      0              2.9047641e+09 -5.9828895e-14  0              5.0874051    
    200000   4500           100            100            0.0031757872   0              0              0.0095273615   38770.665      0              3.7441934e+09 -5.9828895e-14  0              3.5738397    
    300000   4500           100            100            0.0011288619   2.2438711e-36  0              0.0033865856   7700.1842      0              7.4362868e+08 -5.9828895e-14  0              3.128336     
    400000   4500           100            100            0.00063320066 -2.2438708e-36  0              0.001899602    2808.8079      0              2.7125456e+08 -5.9828895e-14  0              3.019687     
    500000   4500           100            100            0.00038259748 -1.1219354e-36  0              0.0011477924   1091.647       0              1.0542345e+08 -5.9828895e-14  0              3.0003158    
    600000   4500           100            100            0.0001047926   7.012097e-38   0              0.00031437779  87.066608      0              8408269.8     -5.9828895e-14  0              3.0018098    
    700000   4500           100            100            0.0067385517   2.8048389e-37  0              0.020215655    44.371811      0              4285111.9     -5.9828895e-14  0              2.9997185    
    800000   4500           100            100            0.00032484886 -5.6096775e-37  0              0.00097454657  5.4895407      0              530140.55     -5.9828895e-14  0              2.9999605    
    900000   4500           100            100            0.0017072809   1.7629864e-45  0              0.0051218428   1.1075769      0              106961.84     -5.9828895e-14  0              2.999887     
   1000000   4500           100            100            0.0019501109   2.6295364e-38  0              0.0058503326   0.11261341     0              10875.397     -5.9828895e-14  0              2.9998761    
   1100000   4500           100            100            0.0021443497   3.2869204e-39  0              0.0064330492   0.018694266    0              1805.3584     -5.9828895e-14  0              2.9998679    
   1200000   4500           100            100            0.0022062549  -4.3825606e-39  0              0.0066187648   0.0029997196   0              289.69145     -5.9828895e-14  0              2.9998653    
   1300000   4500           100            100            0.0022222298   4.0512336e-49  0              0.0066666894   0.0004388208   0              42.378172     -5.9828895e-14  0              2.9998647    
   1400000   4500           100            100            0.0022252549  -4.3825606e-39  0              0.0066757646   5.87114e-05    0              5.6699268     -5.9828895e-14  0              2.9998645    
   1500000   4500           100            100            0.0022252787   4.4018241e-50  0              0.0066758361   7.1854222e-06  0              0.69391664    -5.9828895e-14  0              2.9998645    
   1600000   4500           100            100            0.0022248912  -9.5868513e-40  0              0.0066746735   7.9767242e-07  0              0.077033492   -5.9828895e-14  0              2.9998645    
   1700000   4500           100            100            0.0022246106   2.7391004e-40  0              0.0066738319   7.8676761e-08  0              0.0075980384  -5.9828895e-14  0              2.9998646    
   1800000   4500           100            100            0.0022244616   1.0956401e-39  0              0.0066733849   6.5970228e-09  0              0.00063709325 -5.9828895e-14  0              2.9998646    
   1900000   4500           100            100            0.0022243925   2.7391004e-40  0              0.0066731776   4.2393507e-10  0              4.0940614e-05 -5.9828895e-14  0              2.9998646    
   2000000   4500           100            100            0.002224363    2.7391004e-40  0              0.006673089    1.4929354e-11  0              1.4417701e-06 -5.9828895e-14  0              2.9998646    
   2100000   4500           100            100            0.0022243511   2.7391004e-40  0              0.0066730534   7.1767427e-17  0              6.9307844e-12 -5.9828895e-14  0              2.9998646    
   2200000   4500           100            100            0.0022243466   4.6810757e-54  0              0.0066730397   2.6153693e-13  0              2.5257365e-08 -5.9828895e-14  0              2.9998646    
   2300000   4500           100            100            0.0022243449   5.4782007e-40  0              0.0066730347   1.3478191e-13  0              1.3016272e-08 -5.9828895e-14  0              2.9998646    
   2400000   4500           100            100            0.0022243443   8.3878304e-56  0              0.0066730329   3.8089591e-14  0              3.6784201e-09 -5.9828895e-14  0              2.9998646    
   2500000   4500           100            100            0.0022243441   1.58988e-57    0              0.0066730323   8.2763305e-15  0              7.9926876e-10 -5.9828895e-14  0              2.9998646    
   2600000   4500           100            100            0.002224344   -5.4782007e-40  0              0.0066730321   1.4505233e-15  0              1.4008116e-10 -5.9828895e-14  0              2.9998646    
   2700000   4500           100            100            0.002224344   -2.7391004e-40  0              0.0066730321   2.2439123e-16  0              2.1670099e-11 -5.9828895e-14  0              2.9998646    
   2800000   4500           100            100            0.002224344   -5.4782007e-40  0              0.0066730321   1.3367152e-18  0              1.2909038e-13 -5.9828895e-14  0              2.9998646    
   2900000   4500           100            100            0.002224344   -2.7391004e-40  0              0.0066730321   5.961366e-18   0              5.7570606e-13 -5.9828895e-14  0              2.9998646    
   3000000   4500           100            100            0.002224344   -2.7391004e-40  0              0.0066730321   8.7510544e-21  0              8.451142e-16  -5.9828895e-14  0              2.9998646    
Loop time of 330.215 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7849421.355 ns/day, 0.000 hours/ns, 9084.978 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.548     | 100.7      | 136.64     | 331.2 | 30.50
Neigh   | 0.30229    | 0.30659    | 0.31097    |   0.6 |  0.09
Comm    | 23.639     | 57.864     | 93.061     | 417.7 | 17.52
Output  | 0.19421    | 0.19439    | 0.1946     |   0.0 |  0.06
Modify  | 114.51     | 132.95     | 151.96     | 144.2 | 40.26
Other   |            | 38.2       |            |       | 11.57

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 72
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -150 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.005456352    0              0              0.016369056    67676.576      0              6.5357193e+09 -5.9828895e-14  0              4.6311076    
    200000   4500           100            100           -0.00054805657  2.2438712e-36  0             -0.0016441697   2223.6775      0              2.1474686e+08 -5.9828895e-14  0              3.3323878    
    300000   4500           100            100            0.0015684175  -3.5060485e-38  0              0.0047052524   14737.031      0              1.423197e+09  -5.9828895e-14  0              3.0084958    
    400000   4500           100            100           -0.00029017186  1.8856999e-43  0             -0.00087051559  725.99602      0              70111499      -5.9828895e-14  0              3.0204263    
    500000   4500           100            100            9.1598502e-05  8.3120506e-45  0              0.00027479551  66.577997      0              6429626.4     -5.9828895e-14  0              3.0061593    
    600000   4500           100            100           -4.3524685e-05  1.9581906e-44  0             -0.00013057406  15.504018      0              1497267.1     -5.9828895e-14  0              3.0012813    
    700000   4500           100            100            0.011651408    5.609678e-37   0              0.034954224    3.3690621      0              325359.9      -5.9828895e-14  0              2.999592     
    800000   4500           100            100            0.0028804935   1.4024194e-37  0              0.0086414805   6.1997321      0              598725.75     -5.9828895e-14  0              2.9998401    
    900000   4500           100            100            0.0028604209   1.5917161e-46  0              0.0085812626   0.66822978     0              64532.849     -5.9828895e-14  0              2.9998402    
   1000000   4500           100            100            0.003416545   -1.7530242e-38  0              0.010249635    0.11014238     0              10636.763     -5.9828895e-14  0              2.9998198    
   1100000   4500           100            100            0.0034564601   1.7530242e-38  0              0.01036938     0.0040535905   0              391.46676     -5.9828895e-14  0              2.9998183    
   1200000   4500           100            100            0.0033850414  -4.3825606e-39  0              0.010155124    0.00017600676  0              16.997473     -5.9828895e-14  0              2.9998208    
   1300000   4500           100            100            0.0033442772   9.380259e-50   0              0.010032831    0.00022568581  0              21.79512      -5.9828895e-14  0              2.9998222    
   1400000   4500           100            100            0.0033338136  -2.1912803e-39  0              0.010001441    3.1339406e-05  0              3.0265355     -5.9828895e-14  0              2.9998226    
   1500000   4500           100            100            0.0033341214   1.8458841e-50  0              0.010002364    5.4397386e-07  0              0.052533102   -5.9828895e-14  0              2.9998226    
   1600000   4500           100            100            0.0033356725  -1.0956401e-39  0              0.010007017    1.4984293e-07  0              0.014470758   -5.9828895e-14  0              2.9998226    
   1700000   4500           100            100            0.0033363925   1.3880035e-50  0              0.010009177    8.3286071e-08  0              0.0080431726  -5.9828895e-14  0              2.9998225    
   1800000   4500           100            100            0.0033365382   1.2701347e-51  0              0.010009615    8.0641834e-09  0              0.00077878111 -5.9828895e-14  0              2.9998225    
   1900000   4500           100            100            0.0033365134   6.8477509e-41  0              0.01000954     2.9694531e-11  0              2.8676853e-06 -5.9828895e-14  0              2.9998225    
   2000000   4500           100            100            0.0033364817   7.1485421e-53  0              0.010009445    8.7234136e-11  0              8.4244485e-06 -5.9828895e-14  0              2.9998225    
   2100000   4500           100            100            0.0033364695   2.7937726e-58  0              0.010009408    2.8215934e-11  0              2.7248929e-06 -5.9828895e-14  0              2.9998225    
   2200000   4500           100            100            0.0033364677   3.8347405e-39  0              0.010009403    1.8405538e-12  0              1.7774751e-07 -5.9828895e-14  0              2.9998225    
   2300000   4500           100            100            0.0033364685  -6.8477509e-40  0              0.010009405    2.0162777e-15  0              1.9471767e-10 -5.9828895e-14  0              2.9998225    
   2400000   4500           100            100            0.0033364691   1.3695502e-40  0              0.010009407    4.134318e-14   0              3.9926284e-09 -5.9828895e-14  0              2.9998225    
   2500000   4500           100            100            0.0033364693   2.7391004e-40  0              0.010009408    8.7755565e-15  0              8.4748043e-10 -5.9828895e-14  0              2.9998225    
   2600000   4500           100            100            0.0033364693   5.3197748e-58  0              0.010009408    3.7993531e-16  0              3.6691433e-11 -5.9828895e-14  0              2.9998225    
   2700000   4500           100            100            0.0033364693   1.3695502e-40  0              0.010009408    9.6935904e-19  0              9.3613758e-14 -5.9828895e-14  0              2.9998225    
   2800000   4500           100            100            0.0033364693   5.6388754e-60  0              0.010009408    3.7654487e-19  0              3.6364008e-14 -5.9828895e-14  0              2.9998225    
   2900000   4500           100            100            0.0033364693  -5.4782007e-40  0              0.010009408    2.371037e-18   0              2.2897778e-13 -5.9828895e-14  0              2.9998225    
   3000000   4500           100            100            0.0033364693   5.4782007e-40  0              0.010009408    7.3989651e-18  0              7.1453909e-13 -5.9828895e-14  0              2.9998225    
Loop time of 327.684 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7910066.441 ns/day, 0.000 hours/ns, 9155.169 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.771     | 102.35     | 136.51     | 333.4 | 31.23
Neigh   | 0.33777    | 0.34272    | 0.34803    |   0.6 |  0.10
Comm    | 24.046     | 57.546     | 90.996     | 438.3 | 17.56
Output  | 0.19437    | 0.19453    | 0.19475    |   0.0 |  0.06
Modify  | 112.92     | 130.13     | 148.61     | 151.1 | 39.71
Other   |            | 37.12      |            |       | 11.33

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 80
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -200 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0071356539   0              0              0.021406962    120313.91      0              1.1619056e+10 -5.9828895e-14  0              4.1748102    
    200000   4500           100            100            0.0023517094  -5.6096771e-37  0              0.0070551281   26513.175      0              2.5604526e+09 -5.9828895e-14  0              3.2544472    
    300000   4500           100            100            0.001452647    5.4324687e-44  0              0.0043579411   12766.626      0              1.2329094e+09 -5.9828895e-14  0              3.0251154    
    400000   4500           100            100           -0.00052037818  1.1219356e-36  0             -0.0015611345   2513.9081      0              2.4277525e+08 -5.9828895e-14  0              3.0079176    
    500000   4500           100            100           -0.00026045073  8.2534678e-44  0             -0.0007813522   587.82566      0              56767995      -5.9828895e-14  0              3.0020092    
    600000   4500           100            100            0.018019224   -1.1219354e-36  0              0.054057673    135.36061      0              13072159      -5.9828895e-14  0              2.9994563    
    700000   4500           100            100            0.0053907612   1.4024194e-37  0              0.016172284    40.057097      0              3868427.7     -5.9828895e-14  0              2.9997578    
    800000   4500           100            100            0.0021047767  -1.4024194e-37  0              0.0063143302   1.0243113      0              98920.65      -5.9828895e-14  0              2.999869     
    900000   4500           100            100            0.005477531    1.4024194e-37  0              0.016432593    0.022094308    0              2133.7101     -5.9828895e-14  0              2.999753     
   1000000   4500           100            100            0.0043858382   7.1927861e-47  0              0.013157514    0.097963564    0              9460.6198     -5.9828895e-14  0              2.9997871    
   1100000   4500           100            100            0.0043240508   3.5060485e-38  0              0.012972152    0.0022301964   0              215.37641     -5.9828895e-14  0              2.999789     
   1200000   4500           100            100            0.0044791466   2.1912803e-39  0              0.01343744     0.0011181209   0              107.98012     -5.9828895e-14  0              2.999784     
   1300000   4500           100            100            0.0044598426   1.7991667e-49  0              0.013379528    0.0001499871   0              14.48468      -5.9828895e-14  0              2.9997846    
   1400000   4500           100            100            0.0044424951   1.0956401e-39  0              0.013327485    5.31719e-06    0              0.51349615    -5.9828895e-14  0              2.9997852    
   1500000   4500           100            100            0.0044481341   5.1830536e-50  0              0.013344402    4.1715876e-06  0              0.40286207    -5.9828895e-14  0              2.999785     
   1600000   4500           100            100            0.0044494587   4.3825606e-39  0              0.013348376    2.6803492e-09  0              0.00025884894 -5.9828895e-14  0              2.999785     
   1700000   4500           100            100            0.0044484717  -2.1912803e-39  0              0.013345415    6.9588732e-08  0              0.0067203817  -5.9828895e-14  0              2.999785     
   1800000   4500           100            100            0.0044484687   8.7027263e-51  0              0.013345406    2.8521293e-09  0              0.00027543824 -5.9828895e-14  0              2.999785     
   1900000   4500           100            100            0.0044486011   1.219681e-51   0              0.013345803    6.6763604e-10  0              6.447551e-05  -5.9828895e-14  0              2.999785     
   2000000   4500           100            100            0.0044485781  -2.1912803e-39  0              0.013345734    1.366464e-10   0              1.3196331e-05 -5.9828895e-14  0              2.999785     
   2100000   4500           100            100            0.0044485645  -4.3825606e-39  0              0.013345693    1.9389086e-12  0              1.8724592e-07 -5.9828895e-14  0              2.999785     
   2200000   4500           100            100            0.00444857     1.0956401e-39  0              0.01334571     3.2685945e-12  0              3.1565746e-07 -5.9828895e-14  0              2.999785     
   2300000   4500           100            100            0.0044485708   2.2510761e-55  0              0.013345712    1.756006e-14   0              1.6958249e-09 -5.9828895e-14  0              2.999785     
   2400000   4500           100            100            0.0044485699  -1.0956401e-39  0              0.01334571     4.742646e-14   0              4.5801081e-09 -5.9828895e-14  0              2.999785     
   2500000   4500           100            100            0.00444857     2.1912803e-39  0              0.01334571     3.1867955e-15  0              3.077579e-10  -5.9828895e-14  0              2.999785     
   2600000   4500           100            100            0.0044485701  -1.0956401e-39  0              0.01334571     3.8111715e-16  0              3.6805566e-11 -5.9828895e-14  0              2.999785     
   2700000   4500           100            100            0.0044485701  -2.1912803e-39  0              0.01334571     1.368712e-16   0              1.3218041e-11 -5.9828895e-14  0              2.999785     
   2800000   4500           100            100            0.0044485701   5.0916716e-62  0              0.01334571     2.8612185e-18  0              2.76316e-13   -5.9828895e-14  0              2.999785     
   2900000   4500           100            100            0.0044485701   4.8367689e-59  0              0.01334571     5.2803094e-18  0              5.0993449e-13 -5.9828895e-14  0              2.999785     
   3000000   4500           100            100            0.0044485701  -2.1912803e-39  0              0.01334571     3.3776829e-18  0              3.2619244e-13 -5.9828895e-14  0              2.999785     
Loop time of 328.537 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7889525.577 ns/day, 0.000 hours/ns, 9131.395 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.053     | 102.29     | 138.66     | 335.9 | 31.13
Neigh   | 0.36682    | 0.37118    | 0.37589    |   0.5 |  0.11
Comm    | 23.676     | 58.505     | 93.693     | 427.2 | 17.81
Output  | 0.19741    | 0.19758    | 0.1978     |   0.0 |  0.06
Modify  | 112.48     | 130.29     | 147.49     | 142.5 | 39.66
Other   |            | 36.88      |            |       | 11.23

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 88
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -250 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0087452147   0              0              0.026235644    187990.49      0              1.8154776e+10 -5.9828895e-14  0              3.7185127    
    200000   4500           100            100           -0.0016948414   1.7083627e-43  0             -0.0050845241   39611.18       0              3.8253642e+09 -5.9828895e-14  0              3.1009473    
    300000   4500           100            100            0.00074025696  2.8129172e-43  0              0.0022207709   3665.9009      0              3.5402647e+08 -5.9828895e-14  0              3.0650849    
    400000   4500           100            100            0.00029965252  3.1287229e-44  0              0.00089895755  675.12875      0              65199102      -5.9828895e-14  0              3.01661      
    500000   4500           100            100           -0.00034422002  3.3658067e-36  0             -0.0010326601   1051.7685      0              1.0157227e+08 -5.9828895e-14  0              3.0001272    
    600000   4500           100            100           -0.00013095069  2.8048388e-37  0             -0.00039285208  143.72472      0              13879905      -5.9828895e-14  0              3.0002285    
    700000   4500           100            100            0.0044569501  -1.1219355e-36  0              0.01337085     39.536914      0              3818192.1     -5.9828895e-14  0              2.9997825    
    800000   4500           100            100            0.0031004068  -1.4024194e-37  0              0.0093012205   0.88179822     0              85157.76      -5.9828895e-14  0              2.9998314    
    900000   4500           100            100            0.0045426033   3.5060485e-38  0              0.01362781     0.0081060651   0              782.82575     -5.9828895e-14  0              2.999782     
   1000000   4500           100            100            0.0051917357   2.9648257e-47  0              0.015575207    0.005523904    0              533.45911     -5.9828895e-14  0              2.9997617    
   1100000   4500           100            100            0.0054282512  -1.0518145e-37  0              0.016284754    0.0012990308   0              125.4511      -5.9828895e-14  0              2.9997545    
   1200000   4500           100            100            0.0055134754   8.7651212e-39  0              0.016540426    0.00025707188  0              24.826163     -5.9828895e-14  0              2.9997519    
   1300000   4500           100            100            0.0055439537   5.4782007e-40  0              0.016631861    4.7013708e-05  0              4.5402474     -5.9828895e-14  0              2.999751     
   1400000   4500           100            100            0.0055547795   8.7651212e-39  0              0.016664338    8.1560001e-06  0              0.78764811    -5.9828895e-14  0              2.9997507    
   1500000   4500           100            100            0.0055585997   6.5738409e-39  0              0.016675799    1.3597882e-06  0              0.13131861    -5.9828895e-14  0              2.9997506    
   1600000   4500           100            100            0.0055599388   1.0956401e-39  0              0.016679816    2.1965867e-07  0              0.021213062   -5.9828895e-14  0              2.9997505    
   1700000   4500           100            100            0.0055604048  -2.1912803e-39  0              0.016681214    3.4572066e-08  0              0.0033387226  -5.9828895e-14  0              2.9997505    
   1800000   4500           100            100            0.0055605657   9.5382892e-52  0              0.016681697    5.3228032e-09  0              0.00051403824 -5.9828895e-14  0              2.9997505    
   1900000   4500           100            100            0.0055606207   1.0956401e-38  0              0.016681862    8.0397376e-10  0              7.7642031e-05 -5.9828895e-14  0              2.9997505    
   2000000   4500           100            100            0.0055606394   1.6129271e-52  0              0.016681918    1.1943391e-10  0              1.1534072e-05 -5.9828895e-14  0              2.9997505    
   2100000   4500           100            100            0.0055606456   1.185246e-53   0              0.016681937    1.7468114e-11  0              1.6869454e-06 -5.9828895e-14  0              2.9997505    
   2200000   4500           100            100            0.0055606477  -4.3825606e-39  0              0.016681943    2.5210353e-12  0              2.4346354e-07 -5.9828895e-14  0              2.9997505    
   2300000   4500           100            100            0.0055606484   4.3825606e-39  0              0.016681945    3.5958519e-13  0              3.4726164e-08 -5.9828895e-14  0              2.9997505    
   2400000   4500           100            100            0.0055606486  -2.1912803e-39  0              0.016681946    5.0598606e-14  0              4.8864512e-09 -5.9828895e-14  0              2.9997505    
   2500000   4500           100            100            0.0055606486   3.6239195e-57  0              0.016681946    6.9765253e-15  0              6.7374287e-10 -5.9828895e-14  0              2.9997505    
   2600000   4500           100            100            0.0055606486  -2.1912803e-39  0              0.016681946    9.4626517e-16  0              9.1383517e-11 -5.9828895e-14  0              2.9997505    
   2700000   4500           100            100            0.0055606487  -4.3825606e-39  0              0.016681946    1.1984337e-16  0              1.1573615e-11 -5.9828895e-14  0              2.9997505    
   2800000   4500           100            100            0.0055606487   4.3825606e-39  0              0.016681946    3.0447511e-18  0              2.9404027e-13 -5.9828895e-14  0              2.9997505    
   2900000   4500           100            100            0.0055606487   2.1912803e-39  0              0.016681946    5.0276361e-18  0              4.8553311e-13 -5.9828895e-14  0              2.9997505    
   3000000   4500           100            100            0.0055606487   2.1912803e-39  0              0.016681946    5.342641e-20   0              5.1595403e-15 -5.9828895e-14  0              2.9997505    
Loop time of 328.324 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7894639.207 ns/day, 0.000 hours/ns, 9137.314 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.167     | 102.98     | 138.36     | 339.7 | 31.37
Neigh   | 0.40773    | 0.41317    | 0.41888    |   0.6 |  0.13
Comm    | 24.118     | 58.638     | 93.991     | 442.0 | 17.86
Output  | 0.1958     | 0.19596    | 0.19616    |   0.0 |  0.06
Modify  | 112.44     | 129.76     | 146.86     | 146.7 | 39.52
Other   |            | 36.33      |            |       | 11.07

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 96
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -300 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.010285034    0              0              0.030855103    270706.3       0              2.6142877e+10 -5.9828895e-14  0              3.2622153    
    200000   4500           100            100           -6.745988e-05   3.7039172e-45  0             -0.00020237964  31.57356       0              3049148.4     -5.9828895e-14  0              3.263068     
    300000   4500           100            100           -0.00042461425 -2.2438708e-36  0             -0.0012738427   1564.8617      0              1.5112314e+08 -5.9828895e-14  0              3.0611331    
    400000   4500           100            100            0.026499104    4.4877427e-36  0              0.079497312    5083.9746      0              4.9097388e+08 -5.9828895e-14  0              2.9993091    
    500000   4500           100            100            9.9686328e-05  1.4024194e-37  0              0.00029905899  78.925808      0              7622089.6     -5.9828895e-14  0              3.0037313    
    600000   4500           100            100            0.00012668662 -1.4024194e-37  0              0.00038005986  126.88904      0              12254035      -5.9828895e-14  0              3.0002733    
    700000   4500           100            100            0.011367671   -1.4024194e-37  0              0.034103014    28.775601      0              2778941.6     -5.9828895e-14  0              2.9995967    
    800000   4500           100            100            0.0061146179   8.1806037e-45  0              0.018343854    5.3713772      0              518729.17     -5.9828895e-14  0              2.999735     
    900000   4500           100            100            0.0065713138   1.0878156e-45  0              0.019713941    0.73852948     0              71321.891     -5.9828895e-14  0              2.9997214    
   1000000   4500           100            100            0.00678944     7.012097e-38   0              0.02036832     0.091125344    0              8800.2335     -5.9828895e-14  0              2.9997151    
   1100000   4500           100            100            0.0067688195   1.4300727e-47  0              0.020306459    0.0074938735   0              723.70466     -5.9828895e-14  0              2.9997156    
   1200000   4500           100            100            0.006721073    8.7651212e-39  0              0.020163219    0.00029616389  0              28.601389     -5.9828895e-14  0              2.9997169    
   1300000   4500           100            100            0.0066920156   1.7899671e-48  0              0.020076047    1.1944992e-08  0              0.0011535618  -5.9828895e-14  0              2.9997177    
   1400000   4500           100            100            0.0066790861   4.5475349e-51  0              0.020037258    5.601944e-06   0              0.54099565    -5.9828895e-14  0              2.9997181    
   1500000   4500           100            100            0.0066743705   5.4782007e-40  0              0.020023111    2.4271979e-06  0              0.2344014     -5.9828895e-14  0              2.9997182    
   1600000   4500           100            100            0.0066729614   2.3051745e-50  0              0.020018884    5.1765668e-07  0              0.049991577   -5.9828895e-14  0              2.9997183    
   1700000   4500           100            100            0.006672654   -1.0956401e-39  0              0.020017962    7.3040413e-08  0              0.0070537203  -5.9828895e-14  0              2.9997183    
   1800000   4500           100            100            0.0066726377   2.1912803e-39  0              0.020017913    6.9903983e-09  0              0.00067508263 -5.9828895e-14  0              2.9997183    
   1900000   4500           100            100            0.0066726679   8.7651212e-39  0              0.020018004    3.8051276e-10  0              3.6747199e-05 -5.9828895e-14  0              2.9997183    
   2000000   4500           100            100            0.0066726901   2.1912803e-39  0              0.02001807     3.2756454e-12  0              3.1633838e-07 -5.9828895e-14  0              2.9997183    
   2100000   4500           100            100            0.0066727008   5.2970041e-55  0              0.020018102    1.9603827e-12  0              1.8931973e-07 -5.9828895e-14  0              2.9997183    
   2200000   4500           100            100            0.006672705    1.0956401e-39  0              0.020018115    1.3722915e-12  0              1.3252609e-07 -5.9828895e-14  0              2.9997183    
   2300000   4500           100            100            0.0066727063  -2.1912803e-39  0              0.020018119    3.5041208e-13  0              3.384029e-08  -5.9828895e-14  0              2.9997183    
   2400000   4500           100            100            0.0066727067   2.2055685e-57  0              0.02001812     5.6319262e-14  0              5.4389113e-09 -5.9828895e-14  0              2.9997183    
   2500000   4500           100            100            0.0066727067   4.7020011e-58  0              0.02001812     6.0788053e-15  0              5.870475e-10  -5.9828895e-14  0              2.9997183    
   2600000   4500           100            100            0.0066727067  -2.1912803e-39  0              0.02001812     3.8922669e-16  0              3.7588728e-11 -5.9828895e-14  0              2.9997183    
   2700000   4500           100            100            0.0066727067  -4.3825606e-39  0              0.02001812     6.0702535e-17  0              5.8622164e-12 -5.9828895e-14  0              2.9997183    
   2800000   4500           100            100            0.0066727067  -1.0956401e-39  0              0.02001812     1.6415628e-17  0              1.5853039e-12 -5.9828895e-14  0              2.9997183    
   2900000   4500           100            100            0.0066727067  -1.0956401e-39  0              0.02001812     2.168803e-20   0              2.0944747e-15 -5.9828895e-14  0              2.9997183    
   3000000   4500           100            100            0.0066727067  -1.0956401e-39  0              0.02001812     4.2709554e-18  0              4.124583e-13  -5.9828895e-14  0              2.9997183    
Loop time of 326.097 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7948548.629 ns/day, 0.000 hours/ns, 9199.709 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.354     | 100.43     | 136.28     | 334.2 | 30.80
Neigh   | 0.41431    | 0.41998    | 0.42567    |   0.6 |  0.13
Comm    | 23.599     | 57.975     | 92.028     | 424.5 | 17.78
Output  | 0.19322    | 0.19341    | 0.19364    |   0.0 |  0.06
Modify  | 112.7      | 130.44     | 147.62     | 142.9 | 40.00
Other   |            | 36.63      |            |       | 11.23

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 100
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -350 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0020748564  -1.7950951e-35  0             -0.0062245692   261342.95      0              2.5238632e+10 -5.9828895e-14  0              3.1464804    
    200000   4500           100            100            0.0021187324   4.4877447e-36  0              0.0063561973   22480.516      0              2.1710073e+09 -5.9828895e-14  0              3.2219052    
    300000   4500           100            100            0.0017641091   1.3085698e-42  0              0.0052923273   18023.043      0              1.7405365e+09 -5.9828895e-14  0              3.0168396    
    400000   4500           100            100           -0.00061845426  4.4877424e-36  0             -0.0018553628   3664.4903      0              3.5389024e+08 -5.9828895e-14  0              3.0054711    
    500000   4500           100            100            0.00032945876  3.3658066e-36  0              0.00098837628  818.73207      0              79067283      -5.9828895e-14  0              3.0013933    
    600000   4500           100            100            0.00010279437  1.4024194e-37  0              0.00030838311  84.076275      0              8119484.9     -5.9828895e-14  0              3.0003645    
    700000   4500           100            100            0.01698001    -7.0120969e-38  0              0.050940031    0.51640143     0              49870.354     -5.9828895e-14  0              2.999475     
    800000   4500           100            100            0.0054443365   5.8554609e-47  0              0.016333009    2.1648598      0              209066.66     -5.9828895e-14  0              2.9997545    
    900000   4500           100            100            0.0067759327   7.0120969e-38  0              0.020327798    0.13332521     0              12875.594     -5.9828895e-14  0              2.9997155    
   1000000   4500           100            100            0.0074142184  -3.5060485e-38  0              0.022242655    0.018416247    0              1778.5093     -5.9828895e-14  0              2.9996978    
   1100000   4500           100            100            0.0076516363   1.0998438e-48  0              0.022954909    0.0028794332   0              278.07505     -5.9828895e-14  0              2.9996914    
   1200000   4500           100            100            0.0077372278   8.7651212e-39  0              0.023211683    0.00044926926  0              43.387209     -5.9828895e-14  0              2.9996891    
   1300000   4500           100            100            0.0077678403  -5.2590727e-38  0              0.023303521    6.9112054e-05  0              6.6743475     -5.9828895e-14  0              2.9996882    
   1400000   4500           100            100            0.0077787483  -8.7651212e-39  0              0.023336245    1.0491544e-05  0              1.0131982     -5.9828895e-14  0              2.999688     
   1500000   4500           100            100            0.0077826239   4.3825606e-39  0              0.023347872    1.5743363e-06  0              0.15203813    -5.9828895e-14  0              2.9996878    
   1600000   4500           100            100            0.0077839971   2.6055347e-50  0              0.023351991    2.3384352e-07  0              0.022582933   -5.9828895e-14  0              2.9996878    
   1700000   4500           100            100            0.0077844823   8.7651212e-39  0              0.023353447    3.4418901e-08  0              0.0033239311  -5.9828895e-14  0              2.9996878    
   1800000   4500           100            100            0.0077846531  -2.6295364e-38  0              0.023353959    5.0244655e-09  0              0.00048522692 -5.9828895e-14  0              2.9996878    
   1900000   4500           100            100            0.0077847131   8.7651212e-39  0              0.023354139    7.2797634e-10  0              7.0302744e-05 -5.9828895e-14  0              2.9996878    
   2000000   4500           100            100            0.0077847341   3.124718e-53   0              0.023354202    1.04739e-10    0              1.0114943e-05 -5.9828895e-14  0              2.9996878    
   2100000   4500           100            100            0.0077847414   1.2485987e-53  0              0.023354224    1.4973417e-11  0              1.4460255e-06 -5.9828895e-14  0              2.9996878    
   2200000   4500           100            100            0.007784744   -8.7651212e-39  0              0.023354232    2.1242357e-12  0              2.0514348e-07 -5.9828895e-14  0              2.9996878    
   2300000   4500           100            100            0.0077847449   2.2725562e-55  0              0.023354235    2.9954085e-13  0              2.8927511e-08 -5.9828895e-14  0              2.9996878    
   2400000   4500           100            100            0.0077847452   1.0176036e-56  0              0.023354235    4.2126153e-14  0              4.0682423e-09 -5.9828895e-14  0              2.9996878    
   2500000   4500           100            100            0.0077847453   2.2415973e-60  0              0.023354236    5.9307405e-15  0              5.7274846e-10 -5.9828895e-14  0              2.9996878    
   2600000   4500           100            100            0.0077847453   2.9522185e-58  0              0.023354236    8.3308761e-16  0              8.0453639e-11 -5.9828895e-14  0              2.9996878    
   2700000   4500           100            100            0.0077847453  -1.7530242e-38  0              0.023354236    5.1783533e-17  0              5.000883e-12  -5.9828895e-14  0              2.9996878    
   2800000   4500           100            100            0.0077847453   6.4282539e-58  0              0.023354236    2.2524733e-18  0              2.1752775e-13 -5.9828895e-14  0              2.9996878    
   2900000   4500           100            100            0.0077847453   4.767723e-58   0              0.023354236    5.2604103e-18  0              5.0801277e-13 -5.9828895e-14  0              2.9996878    
   3000000   4500           100            100            0.0077847453  -4.3825606e-39  0              0.023354236    1.4740861e-18  0              1.4235668e-13 -5.9828895e-14  0              2.9996878    
Loop time of 332.359 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7798789.171 ns/day, 0.000 hours/ns, 9026.376 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.328     | 103.23     | 142.46     | 344.5 | 31.06
Neigh   | 0.45041    | 0.45647    | 0.46245    |   0.6 |  0.14
Comm    | 23.675     | 60.374     | 97.412     | 424.1 | 18.17
Output  | 0.19293    | 0.19309    | 0.19332    |   0.0 |  0.06
Modify  | 112.15     | 131.41     | 147.74     | 136.0 | 39.54
Other   |            | 36.69      |            |       | 11.04

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 110
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -400 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0026901364   4.4877432e-36  0             -0.0080704091   133058.83      0              1.284987e+10  -5.9828895e-14  0              3.4565731    
    200000   4500           100            100            0.0044420831   1.9132658e-43  0              0.013326249    81724.122      0              7.8923307e+09 -5.9828895e-14  0              3.0577562    
    300000   4500           100            100           -0.00010576485 -8.4145162e-37  0             -0.00031729456  89.154043      0              8609859.4     -5.9828895e-14  0              3.0626257    
    400000   4500           100            100           -0.00056026762  3.0623066e-43  0             -0.0016808029   2948.2535      0              2.8472122e+08 -5.9828895e-14  0              3.0078613    
    500000   4500           100            100            0.00035381602  2.2438714e-36  0              0.001061448    939.52675      0              90732769      -5.9828895e-14  0              3.0011703    
    600000   4500           100            100            0.0024988247   2.2438712e-36  0              0.0074964742   263.81999      0              25477847      -5.9828895e-14  0              2.9998468    
    700000   4500           100            100            0.016903304    1.0957019e-43  0              0.050709912    12.525274      0              1209601.3     -5.9828895e-14  0              2.9994756    
    800000   4500           100            100            0.0063686152   4.2991741e-46  0              0.019105845    1.9818234      0              191390.32     -5.9828895e-14  0              2.9997274    
    900000   4500           100            100            0.0079425469   2.8048388e-37  0              0.023827641    0.2605889      0              25165.811     -5.9828895e-14  0              2.9996834    
   1000000   4500           100            100            0.0089303819   7.012097e-38   0              0.026791146    0.10511361     0              10151.12      -5.9828895e-14  0              2.9996578    
   1100000   4500           100            100            0.0090360905   4.0147128e-47  0              0.027108271    0.0029142615   0              281.43851     -5.9828895e-14  0              2.9996552    
   1200000   4500           100            100            0.0089459923  -1.7530242e-38  0              0.026837977    0.00049134223  0              47.450316     -5.9828895e-14  0              2.9996575    
   1300000   4500           100            100            0.0088974074   4.3825606e-39  0              0.026692222    0.00024985158  0              24.128877     -5.9828895e-14  0              2.9996587    
   1400000   4500           100            100            0.0088904649   4.4245434e-49  0              0.026671395    1.0317144e-05  0              0.99635588    -5.9828895e-14  0              2.9996589    
   1500000   4500           100            100            0.0088942227   5.4782007e-40  0              0.026682668    7.2702822e-07  0              0.070211181   -5.9828895e-14  0              2.9996588    
   1600000   4500           100            100            0.0088966132   3.0900951e-52  0              0.02668984     5.7802819e-07  0              0.055821826   -5.9828895e-14  0              2.9996587    
   1700000   4500           100            100            0.0088970449  -3.2869204e-39  0              0.026691135    3.3443037e-08  0              0.0032296891  -5.9828895e-14  0              2.9996587    
   1800000   4500           100            100            0.0088968948   2.7264554e-51  0              0.026690684    8.9725183e-10  0              8.6650159e-05 -5.9828895e-14  0              2.9996587    
   1900000   4500           100            100            0.0088967787   1.6834108e-52  0              0.026690336    1.2985069e-09  0              0.0001254005  -5.9828895e-14  0              2.9996587    
   2000000   4500           100            100            0.0088967535  -1.0956401e-39  0              0.026690261    1.0119465e-10  0              9.7726551e-06 -5.9828895e-14  0              2.9996587    
   2100000   4500           100            100            0.0088967591   1.5324377e-53  0              0.026690277    7.6830616e-13  0              7.419751e-08  -5.9828895e-14  0              2.9996587    
   2200000   4500           100            100            0.0088967647   1.0956401e-39  0              0.026690294    2.828274e-12   0              2.7313446e-07 -5.9828895e-14  0              2.9996587    
   2300000   4500           100            100            0.0088967661   2.533941e-56   0              0.026690298    2.8986366e-13  0              2.7992957e-08 -5.9828895e-14  0              2.9996587    
   2400000   4500           100            100            0.0088967659   1.0956401e-39  0              0.026690298    1.6581799e-16  0              1.6013514e-11 -5.9828895e-14  0              2.9996587    
   2500000   4500           100            100            0.0088967656  -1.0956401e-39  0              0.026690297    5.9652207e-15  0              5.7607832e-10 -5.9828895e-14  0              2.9996587    
   2600000   4500           100            100            0.0088967656  -1.0956401e-39  0              0.026690297    8.036313e-16   0              7.7608959e-11 -5.9828895e-14  0              2.9996587    
   2700000   4500           100            100            0.0088967656   1.6434602e-39  0              0.026690297    2.4641383e-17  0              2.3796884e-12 -5.9828895e-14  0              2.9996587    
   2800000   4500           100            100            0.0088967656   1.0956401e-39  0              0.026690297    3.4804168e-19  0              3.3611374e-14 -5.9828895e-14  0              2.9996587    
   2900000   4500           100            100            0.0088967656  -1.0956401e-39  0              0.026690297    6.0800782e-18  0              5.8717044e-13 -5.9828895e-14  0              2.9996587    
   3000000   4500           100            100            0.0088967656   2.1912803e-39  0              0.026690297    5.409851e-18   0              5.2244469e-13 -5.9828895e-14  0              2.9996587    
Loop time of 333.862 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7763689.090 ns/day, 0.000 hours/ns, 8985.751 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.253     | 101.91     | 139.68     | 343.6 | 30.52
Neigh   | 0.47559    | 0.48211    | 0.48899    |   0.7 |  0.14
Comm    | 23.862     | 59.76      | 94.628     | 428.6 | 17.90
Output  | 0.19227    | 0.19244    | 0.19265    |   0.0 |  0.06
Modify  | 113.41     | 132.8      | 152.14     | 147.6 | 39.78
Other   |            | 38.71      |            |       | 11.60

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 114
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -450 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0023854025   3.5104781e-42  0             -0.0071562074   57120.824      0              5.5163203e+09 -5.9828895e-14  0              3.6573303    
    200000   4500           100            100           -0.0017797788   2.2438713e-36  0             -0.0053393363   44873.666      0              4.3335774e+09 -5.9828895e-14  0              3.1213472    
    300000   4500           100            100            0.0020044993   3.3658066e-36  0              0.0060134978   22505.736      0              2.1734429e+09 -5.9828895e-14  0              3.0135111    
    400000   4500           100            100           -0.00064598261  1.3463227e-35  0             -0.0019379478   4030.9012      0              3.8927558e+08 -5.9828895e-14  0              3.0058427    
    500000   4500           100            100            0.00018580925  9.4701349e-43  0              0.00055742775  268.88648      0              25967131      -5.9828895e-14  0              3.0027535    
    600000   4500           100            100           -4.7647444e-05  1.1219355e-35  0             -0.00014294233  18.509814      0              1787545.4     -5.9828895e-14  0              3.0004263    
    700000   4500           100            100            0.0035134544   1.1219356e-36  0              0.010540363    17.259677      0              1666816       -5.9828895e-14  0              2.9998179    
    800000   4500           100            100            0.013136779   -2.8048388e-37  0              0.039410336    1.1218277      0              108338.09     -5.9828895e-14  0              2.9995577    
    900000   4500           100            100            0.0088079137  -8.7651212e-39  0              0.026423741    0.0047271799   0              456.5172      -5.9828895e-14  0              2.999661     
   1000000   4500           100            100            0.010408632    3.8237059e-47  0              0.031225896    0.021727735    0              2098.3091     -5.9828895e-14  0              2.999621     
   1100000   4500           100            100            0.0099241125   8.4355487e-47  0              0.029772338    0.010586626    0              1022.3806     -5.9828895e-14  0              2.999633     
   1200000   4500           100            100            0.010007717    2.9268556e-47  0              0.03002315     0.0019447698   0              187.81195     -5.9828895e-14  0              2.9996309    
   1300000   4500           100            100            0.010020649    6.4390679e-48  0              0.030061946    0.0001817917   0              17.556141     -5.9828895e-14  0              2.9996306    
   1400000   4500           100            100            0.010001578    1.3695502e-40  0              0.030004735    5.9548575e-06  0              0.57507751    -5.9828895e-14  0              2.999631     
   1500000   4500           100            100            0.010011619    2.1912803e-39  0              0.030034857    8.4101685e-08  0              0.0081219387  -5.9828895e-14  0              2.9996308    
   1600000   4500           100            100            0.010007968    2.1912803e-39  0              0.030023904    2.5358192e-07  0              0.024489127   -5.9828895e-14  0              2.9996309    
   1700000   4500           100            100            0.010008882    4.3825606e-39  0              0.030026646    7.3881364e-08  0              0.0071349333  -5.9828895e-14  0              2.9996308    
   1800000   4500           100            100            0.010008805    2.1912803e-39  0              0.030026414    1.0104866e-08  0              0.00097585562 -5.9828895e-14  0              2.9996308    
   1900000   4500           100            100            0.010008731   -6.5738409e-39  0              0.030026192    6.6492102e-10  0              6.4213313e-05 -5.9828895e-14  0              2.9996308    
   2000000   4500           100            100            0.010008787   -4.3825606e-39  0              0.03002636     6.3234656e-12  0              6.1067504e-07 -5.9828895e-14  0              2.9996308    
   2100000   4500           100            100            0.010008762    2.1912803e-39  0              0.030026286    3.5398784e-12  0              3.4185612e-07 -5.9828895e-14  0              2.9996308    
   2200000   4500           100            100            0.01000877    -4.3825606e-39  0              0.030026309    2.2324001e-12  0              2.1558922e-07 -5.9828895e-14  0              2.9996308    
   2300000   4500           100            100            0.010008768   -2.1912803e-39  0              0.030026305    4.5013993e-13  0              4.3471293e-08 -5.9828895e-14  0              2.9996308    
   2400000   4500           100            100            0.010008768    6.5738409e-39  0              0.030026304    4.5939352e-14  0              4.4364938e-09 -5.9828895e-14  0              2.9996308    
   2500000   4500           100            100            0.010008768    2.8486644e-38  0              0.030026305    1.8874297e-15  0              1.8227445e-10 -5.9828895e-14  0              2.9996308    
   2600000   4500           100            100            0.010008768   -2.1912803e-39  0              0.030026305    1.6177414e-18  0              1.5622988e-13 -5.9828895e-14  0              2.9996308    
   2700000   4500           100            100            0.010008768    2.1912803e-39  0              0.030026305    4.5368656e-19  0              4.3813801e-14 -5.9828895e-14  0              2.9996308    
   2800000   4500           100            100            0.010008768    1.7530242e-38  0              0.030026305    6.7833754e-18  0              6.5508984e-13 -5.9828895e-14  0              2.9996308    
   2900000   4500           100            100            0.010008768    2.3279318e-59  0              0.030026305    4.6283129e-18  0              4.4696933e-13 -5.9828895e-14  0              2.9996308    
   3000000   4500           100            100            0.010008768    6.5738409e-39  0              0.030026305    5.2413903e-20  0              5.0617596e-15 -5.9828895e-14  0              2.9996308    
Loop time of 333.898 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7762853.969 ns/day, 0.000 hours/ns, 8984.785 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.65      | 104.52     | 141.55     | 355.5 | 31.30
Neigh   | 0.49992    | 0.50621    | 0.51219    |   0.6 |  0.15
Comm    | 24.064     | 60.351     | 98.147     | 461.5 | 18.07
Output  | 0.19553    | 0.1957     | 0.19591    |   0.0 |  0.06
Modify  | 111.8      | 130.8      | 149.62     | 153.2 | 39.17
Other   |            | 37.52      |            |       | 11.24

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -500 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0015283047   8.7683236e-42  0             -0.0045849142   15896.612      0              1.535181e+09  -5.9828895e-14  0              3.7835681    
    200000   4500           100            100           -0.00066639514  6.7316135e-36  0             -0.0019991854   3666.5591      0              3.5409004e+08 -5.9828895e-14  0              3.2185551    
    300000   4500           100            100           -0.00040973123  4.487745e-36   0             -0.0012291937   1456.034       0              1.4061334e+08 -5.9828895e-14  0              3.0558943    
    400000   4500           100            100            0.013068399    5.609678e-37   0              0.039205197    7459.5019      0              7.203853e+08  -5.9828895e-14  0              2.9995399    
    500000   4500           100            100           -0.00015045458 -2.8048387e-37  0             -0.00045136374  190.0877       0              18357309      -5.9828895e-14  0              3.0027651    
    600000   4500           100            100           -7.4156859e-05  1.4617244e-46  0             -0.00022247058  45.241341      0              4369084.9     -5.9828895e-14  0              3.000327     
    700000   4500           100            100            0.0084662918  -5.6096773e-37  0              0.025398875    43.962727      0              4245605.5     -5.9828895e-14  0              2.9996718    
    800000   4500           100            100            0.011034077   -5.6096773e-37  0              0.03310223     6.4301062      0              620973.63     -5.9828895e-14  0              2.9996067    
    900000   4500           100            100            0.012401748    1.5722084e-45  0              0.037205245    0.0013604246   0              131.38007     -5.9828895e-14  0              2.9995741    
   1000000   4500           100            100            0.011078527    1.2721714e-48  0              0.03323558     0.11309026     0              10921.448     -5.9828895e-14  0              2.9996049    
   1100000   4500           100            100            0.010957054    1.0110269e-47  0              0.032871163    0.00076639851  0              74.013282     -5.9828895e-14  0              2.9996079    
   1200000   4500           100            100            0.011143422   -2.1912803e-39  0              0.033430267    0.0017476501   0              168.77554     -5.9828895e-14  0              2.9996035    
   1300000   4500           100            100            0.011140133    7.3339806e-53  0              0.0334204      6.6686174e-05  0              6.4400734     -5.9828895e-14  0              2.9996035    
   1400000   4500           100            100            0.011115656    5.4782007e-40  0              0.033346969    2.1934691e-05  0              2.1182955     -5.9828895e-14  0              2.9996041    
   1500000   4500           100            100            0.011118723    2.1912803e-39  0              0.03335617     2.5234072e-06  0              0.2436926     -5.9828895e-14  0              2.999604     
   1600000   4500           100            100            0.01112165    -5.4782007e-40  0              0.03336495     2.0482479e-07  0              0.019780512   -5.9828895e-14  0              2.999604     
   1700000   4500           100            100            0.011120928    3.4183369e-51  0              0.033362784    6.7529877e-08  0              0.0065215521  -5.9828895e-14  0              2.999604     
   1800000   4500           100            100            0.011120616   -5.4782007e-40  0              0.033361849    1.0444617e-09  0              0.00010086663 -5.9828895e-14  0              2.999604     
   1900000   4500           100            100            0.011120746    6.8477509e-41  0              0.033362237    1.4466293e-09  0              0.0001397051  -5.9828895e-14  0              2.999604     
   2000000   4500           100            100            0.011120773    2.6650055e-53  0              0.03336232     4.7532272e-14  0              4.5903266e-09 -5.9828895e-14  0              2.999604     
   2100000   4500           100            100            0.011120753    1.9458171e-54  0              0.033362259    2.5835499e-11  0              2.4950076e-06 -5.9828895e-14  0              2.999604     
   2200000   4500           100            100            0.011120752    1.6155049e-54  0              0.033362255    2.6727775e-13  0              2.5811772e-08 -5.9828895e-14  0              2.999604     
   2300000   4500           100            100            0.011120754    1.7446555e-55  0              0.033362263    3.8527753e-13  0              3.7207346e-08 -5.9828895e-14  0              2.999604     
   2400000   4500           100            100            0.011120754    5.0331212e-58  0              0.033362263    1.8497121e-14  0              1.7863196e-09 -5.9828895e-14  0              2.999604     
   2500000   4500           100            100            0.011120754    2.0827348e-57  0              0.033362262    4.6594978e-15  0              4.4998095e-10 -5.9828895e-14  0              2.999604     
   2600000   4500           100            100            0.011120754   -2.7391004e-40  0              0.033362262    6.1495925e-16  0              5.9388363e-11 -5.9828895e-14  0              2.999604     
   2700000   4500           100            100            0.011120754    2.2236613e-59  0              0.033362262    1.1710174e-16  0              1.1308848e-11 -5.9828895e-14  0              2.999604     
   2800000   4500           100            100            0.011120754    6.8477509e-40  0              0.033362262    1.6130262e-17  0              1.5577452e-12 -5.9828895e-14  0              2.999604     
   2900000   4500           100            100            0.011120754    5.4782007e-40  0              0.033362262    7.9379619e-18  0              7.6659154e-13 -5.9828895e-14  0              2.999604     
   3000000   4500           100            100            0.011120754   -1.3695502e-40  0              0.033362262    8.9685906e-20  0              8.6612228e-15 -5.9828895e-14  0              2.999604     
Loop time of 339.463 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7635585.064 ns/day, 0.000 hours/ns, 8837.483 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.955     | 105.08     | 145.02     | 356.8 | 30.96
Neigh   | 0.55528    | 0.56343    | 0.57146    |   0.8 |  0.17
Comm    | 23.698     | 61.713     | 101.44     | 446.6 | 18.18
Output  | 0.19609    | 0.19626    | 0.19649    |   0.0 |  0.06
Modify  | 113.93     | 133.02     | 152.82     | 146.6 | 39.19
Other   |            | 38.89      |            |       | 11.46

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -550 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.00030177875 -3.5901925e-35  0             -0.00090533625  468.13317      0              45208950      -5.9828895e-14  0              3.8556684    
    200000   4500           100            100            0.0010288821  -8.9754794e-36  0              0.0030866462   6164.5065      0              5.9532392e+08 -5.9828895e-14  0              3.2310243    
    300000   4500           100            100            0.0015102574   4.4152184e-43  0              0.0045307722   13592.951      0              1.3127099e+09 -5.9828895e-14  0              3.0373519    
    400000   4500           100            100            0.00097902274 -4.4877414e-36  0              0.0029370682   6356.2073      0              6.13837e+08   -5.9828895e-14  0              3.0030612    
    500000   4500           100            100            0.073408575   -6.7316127e-36  0              0.22022573     619.95942      0              59871243      -5.9828895e-14  0              2.9986098    
    600000   4500           100            100            0.019308257    3.5047226e-45  0              0.057924771    322.9841       0              31191493      -5.9828895e-14  0              2.999424     
    700000   4500           100            100            0.0035850641   7.3321458e-44  0              0.010755192    1.1690201      0              112895.6      -5.9828895e-14  0              2.9998134    
    800000   4500           100            100            0.01411039     5.8901614e-36  0              0.04233117     4.8932673      0              472556.73     -5.9828895e-14  0              2.9995353    
    900000   4500           100            100            0.013526554   -3.5060485e-38  0              0.040579662    0.040538561    0              3914.9241     -5.9828895e-14  0              2.9995487    
   1000000   4500           100            100            0.012670502    7.012097e-38   0              0.038011507    0.020143032    0              1945.2699     -5.9828895e-14  0              2.999568     
   1100000   4500           100            100            0.012321357    3.5060485e-38  0              0.03696407     0.011711802    0              1131.042      -5.9828895e-14  0              2.999576     
   1200000   4500           100            100            0.012227646    2.3171306e-47  0              0.036682937    0.002074683    0              200.35803     -5.9828895e-14  0              2.9995781    
   1300000   4500           100            100            0.012217922    1.7530242e-38  0              0.036653767    0.00016324806  0              15.765329     -5.9828895e-14  0              2.9995783    
   1400000   4500           100            100            0.012224571    4.3825606e-39  0              0.036673712    2.4429576e-06  0              0.23592336    -5.9828895e-14  0              2.9995782    
   1500000   4500           100            100            0.01222983    -1.0956401e-39  0              0.03668949     5.8805494e-07  0              0.056790137   -5.9828895e-14  0              2.9995781    
   1600000   4500           100            100            0.012232082   -8.7651212e-39  0              0.036696247    4.422552e-07   0              0.042709842   -5.9828895e-14  0              2.999578     
   1700000   4500           100            100            0.012232726    2.2894117e-50  0              0.036698177    8.6760803e-08  0              0.0083787373  -5.9828895e-14  0              2.999578     
   1800000   4500           100            100            0.01223281     1.8222058e-51  0              0.03669843     7.6049145e-09  0              0.0007344282  -5.9828895e-14  0              2.999578     
   1900000   4500           100            100            0.012232775    8.7651212e-39  0              0.036698324    1.6474746e-10  0              1.591013e-05  -5.9828895e-14  0              2.999578     
   2000000   4500           100            100            0.012232743   -2.1912803e-38  0              0.036698228    1.5534708e-11  0              1.5002309e-06 -5.9828895e-14  0              2.999578     
   2100000   4500           100            100            0.012232728    8.561913e-55   0              0.036698184    1.6455797e-11  0              1.589183e-06  -5.9828895e-14  0              2.999578     
   2200000   4500           100            100            0.012232724   -4.3825606e-39  0              0.036698171    3.5914149e-12  0              3.4683315e-07 -5.9828895e-14  0              2.999578     
   2300000   4500           100            100            0.012232723    1.7530242e-38  0              0.036698169    3.4948524e-13  0              3.3750783e-08 -5.9828895e-14  0              2.999578     
   2400000   4500           100            100            0.012232723    8.7651212e-39  0              0.036698169    9.9280658e-15  0              9.5878153e-10 -5.9828895e-14  0              2.999578     
   2500000   4500           100            100            0.012232723   -4.3825606e-39  0              0.03669817     3.8012588e-16  0              3.6709837e-11 -5.9828895e-14  0              2.999578     
   2600000   4500           100            100            0.012232723    1.8980098e-58  0              0.03669817     6.3946163e-16  0              6.1754627e-11 -5.9828895e-14  0              2.999578     
   2700000   4500           100            100            0.012232723    4.3825606e-39  0              0.03669817     1.232126e-16   0              1.1898991e-11 -5.9828895e-14  0              2.999578     
   2800000   4500           100            100            0.012232723    3.7467059e-58  0              0.03669817     1.7819314e-17  0              1.7208618e-12 -5.9828895e-14  0              2.999578     
   2900000   4500           100            100            0.012232723    3.0651783e-58  0              0.03669817     5.7695608e-18  0              5.5718289e-13 -5.9828895e-14  0              2.999578     
   3000000   4500           100            100            0.012232723    3.2700912e-58  0              0.03669817     9.3194007e-19  0              9.0000101e-14 -5.9828895e-14  0              2.999578     
Loop time of 330.744 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7836869.220 ns/day, 0.000 hours/ns, 9070.450 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.195     | 104.33     | 139.99     | 332.7 | 31.54
Neigh   | 0.56115    | 0.56768    | 0.57469    |   0.6 |  0.17
Comm    | 23.788     | 58.372     | 94.319     | 435.6 | 17.65
Output  | 0.19712    | 0.19729    | 0.19752    |   0.0 |  0.06
Modify  | 110        | 129.67     | 147.97     | 150.8 | 39.20
Other   |            | 37.61      |            |       | 11.37

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -600 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0011933188  -4.4877412e-36  0              0.0035799563   5924.4949      0              5.7214532e+08 -5.9828895e-14  0              3.8864951    
    200000   4500           100            100            0.0031012391   4.4877441e-36  0              0.0093037172   43676.394      0              4.2179535e+09 -5.9828895e-14  0              3.1768936    
    300000   4500           100            100           -0.0011251679   6.7328834e-43  0             -0.0033755037   14181.105      0              1.3695096e+09 -5.9828895e-14  0              3.0324504    
    400000   4500           100            100            0.00048994449 -2.6926451e-35  0              0.0014698335   1740.2542      0              1.6806129e+08 -5.9828895e-14  0              3.0115152    
    500000   4500           100            100           -3.3623286e-05 -2.2438702e-36  0             -0.00010086986  9.1012045      0              878929.19     -5.9828895e-14  0              3.0029503    
    600000   4500           100            100            0.0020759283  -6.731613e-36   0              0.0062277849   274.33283      0              26493101      -5.9828895e-14  0              2.9998786    
    700000   4500           100            100            0.023336324    4.4877421e-35  0              0.070008973    8.0315745      0              775631.98     -5.9828895e-14  0              2.9993515    
    800000   4500           100            100            0.01367459     7.9912332e-46  0              0.041023771    6.873555       0              663798.74     -5.9828895e-14  0              2.9995448    
    900000   4500           100            100            0.012844181    5.6096776e-37  0              0.038532544    0.7922983      0              76514.499     -5.9828895e-14  0              2.9995643    
   1000000   4500           100            100            0.013573005    3.5060485e-38  0              0.040719016    0.095989978    0              9270.025      -5.9828895e-14  0              2.9995476    
   1100000   4500           100            100            0.013246112    1.7530242e-38  0              0.039738337    0.011325204    0              1093.7072     -5.9828895e-14  0              2.999555     
   1200000   4500           100            100            0.01338551     1.2519021e-47  0              0.040156531    0.0013167002   0              127.15748     -5.9828895e-14  0              2.9995519    
   1300000   4500           100            100            0.01332812    -1.7530242e-38  0              0.03998436     0.00014836716  0              14.328238     -5.9828895e-14  0              2.9995532    
   1400000   4500           100            100            0.013351269    3.5096096e-50  0              0.040053807    1.6189611e-05  0              1.5634767     -5.9828895e-14  0              2.9995527    
   1500000   4500           100            100            0.013342092    2.1912803e-39  0              0.040026276    1.6948872e-06  0              0.16368007    -5.9828895e-14  0              2.9995529    
   1600000   4500           100            100            0.013345678   -4.3825606e-39  0              0.040037033    1.6847159e-07  0              0.01626978    -5.9828895e-14  0              2.9995528    
   1700000   4500           100            100            0.013344294   -2.1912803e-39  0              0.040032883    1.5614036e-08  0              0.0015078919  -5.9828895e-14  0              2.9995528    
   1800000   4500           100            100            0.013344822    8.1943899e-51  0              0.040034466    1.3081571e-09  0              0.00012633245 -5.9828895e-14  0              2.9995528    
   1900000   4500           100            100            0.013344623    6.1048874e-53  0              0.040033868    9.3165221e-11  0              8.9972302e-06 -5.9828895e-14  0              2.9995528    
   2000000   4500           100            100            0.013344697   -2.1912803e-39  0              0.040034092    4.8428362e-12  0              4.6768646e-07 -5.9828895e-14  0              2.9995528    
   2100000   4500           100            100            0.01334467     2.6993875e-55  0              0.040034009    9.8943993e-14  0              9.5553026e-09 -5.9828895e-14  0              2.9995528    
   2200000   4500           100            100            0.01334468    -6.5738409e-39  0              0.04003404     4.1173252e-15  0              3.9762179e-10 -5.9828895e-14  0              2.9995528    
   2300000   4500           100            100            0.013344676    8.9173677e-60  0              0.040034028    7.7505708e-15  0              7.4849465e-10 -5.9828895e-14  0              2.9995528    
   2400000   4500           100            100            0.013344677   -2.1912803e-39  0              0.040034032    3.1779665e-15  0              3.0690526e-10 -5.9828895e-14  0              2.9995528    
   2500000   4500           100            100            0.013344677   -2.1912803e-39  0              0.040034031    8.149564e-16   0              7.8702656e-11 -5.9828895e-14  0              2.9995528    
   2600000   4500           100            100            0.013344677   -4.3825606e-39  0              0.040034031    2.0392751e-16  0              1.9693859e-11 -5.9828895e-14  0              2.9995528    
   2700000   4500           100            100            0.013344677    1.7530242e-38  0              0.040034031    1.0715967e-16  0              1.0348714e-11 -5.9828895e-14  0              2.9995528    
   2800000   4500           100            100            0.013344677    4.3825606e-38  0              0.040034031    7.105453e-18   0              6.8619379e-13 -5.9828895e-14  0              2.9995528    
   2900000   4500           100            100            0.013344677   -4.3825606e-39  0              0.040034031    2.5799219e-18  0              2.4915039e-13 -5.9828895e-14  0              2.9995528    
   3000000   4500           100            100            0.013344677    2.1912803e-39  0              0.040034031    8.9832032e-20  0              8.6753347e-15 -5.9828895e-14  0              2.9995528    
Loop time of 324.979 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7975898.092 ns/day, 0.000 hours/ns, 9231.364 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.187     | 99.421     | 135.47     | 331.4 | 30.59
Neigh   | 0.57216    | 0.57932    | 0.58679    |   0.7 |  0.18
Comm    | 24.837     | 58.437     | 94.79      | 409.8 | 17.98
Output  | 0.19591    | 0.19609    | 0.19632    |   0.0 |  0.06
Modify  | 110.91     | 129.83     | 146.05     | 138.4 | 39.95
Other   |            | 36.51      |            |       | 11.24

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -650 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0028965486   2.0643614e-34  0              0.0086896457   29381.958      0              2.8374992e+09 -5.9828895e-14  0              3.8846599    
    200000   4500           100            100            0.0054241246   2.0621161e-42  0              0.016272374    111018.72      0              1.0721393e+10 -5.9828895e-14  0              3.068511     
    300000   4500           100            100            0.00041054925  4.305897e-42   0              0.0012316478   1209.0742      0              1.1676373e+08 -5.9828895e-14  0              3.0567569    
    400000   4500           100            100           -0.00010354737 -2.2438706e-36  0             -0.00031064212  88.083821      0              8506505       -5.9828895e-14  0              3.0136695    
    500000   4500           100            100            0.020638119    4.2140847e-44  0              0.061914358    2053.0943      0              1.9827315e+08 -5.9828895e-14  0              2.9994124    
    600000   4500           100            100            0.019494339    3.198682e-44   0              0.058483016    369.13233      0              35648159      -5.9828895e-14  0              2.9994201    
    700000   4500           100            100            0.018970017   -8.9754837e-36  0              0.056910051    44.314539      0              4279581       -5.9828895e-14  0              2.9994331    
    800000   4500           100            100            0.018360505   -1.1219355e-36  0              0.055081516    0.11077156     0              10697.525     -5.9828895e-14  0              2.9994467    
    900000   4500           100            100            0.015848514    1.4024194e-37  0              0.047545542    0.024231419    0              2340.097      -5.9828895e-14  0              2.9994984    
   1000000   4500           100            100            0.014940418    2.8048388e-37  0              0.044821254    0.012727394    0              1229.1206     -5.9828895e-14  0              2.9995178    
   1100000   4500           100            100            0.014619106    3.1018364e-47  0              0.043857317    0.0038878841   0              375.46402     -5.9828895e-14  0              2.9995247    
   1200000   4500           100            100            0.014508915    3.4798791e-47  0              0.043526745    0.00088958873  0              85.910112     -5.9828895e-14  0              2.9995271    
   1300000   4500           100            100            0.014472535    2.1912803e-39  0              0.043417606    0.00017179396  0              16.590631     -5.9828895e-14  0              2.9995279    
   1400000   4500           100            100            0.014461082    1.6652535e-49  0              0.043383247    2.9541337e-05  0              2.8528909     -5.9828895e-14  0              2.9995282    
   1500000   4500           100            100            0.014457703   -4.3825606e-39  0              0.04337311     4.6461689e-06  0              0.44869374    -5.9828895e-14  0              2.9995283    
   1600000   4500           100            100            0.014456802   -8.7651212e-39  0              0.043370406    6.7782567e-07  0              0.065459551   -5.9828895e-14  0              2.9995283    
   1700000   4500           100            100            0.014456605   -4.3825606e-39  0              0.043369814    9.2356057e-08  0              0.0089190869  -5.9828895e-14  0              2.9995283    
   1800000   4500           100            100            0.014456583    1.175267e-50   0              0.043369749    1.1773409e-08  0              0.0011369916  -5.9828895e-14  0              2.9995283    
   1900000   4500           100            100            0.014456594   -1.3147682e-38  0              0.043369781    1.4002334e-09  0              0.00013522452 -5.9828895e-14  0              2.9995283    
   2000000   4500           100            100            0.014456604   -4.3825606e-39  0              0.043369812    1.5406423e-10  0              1.4878421e-05 -5.9828895e-14  0              2.9995283    
   2100000   4500           100            100            0.01445661     2.7051667e-55  0              0.043369831    1.5430109e-11  0              1.4901295e-06 -5.9828895e-14  0              2.9995283    
   2200000   4500           100            100            0.014456613    1.3147682e-38  0              0.043369839    1.3632832e-12  0              1.3165613e-07 -5.9828895e-14  0              2.9995283    
   2300000   4500           100            100            0.014456614    4.3825606e-39  0              0.043369843    9.8675142e-14  0              9.5293389e-09 -5.9828895e-14  0              2.9995283    
   2400000   4500           100            100            0.014456615   -1.3147682e-38  0              0.043369845    4.9042447e-15  0              4.7361685e-10 -5.9828895e-14  0              2.9995283    
   2500000   4500           100            100            0.014456615    8.5446849e-58  0              0.043369846    8.5368852e-17  0              8.2443127e-12 -5.9828895e-14  0              2.9995283    
   2600000   4500           100            100            0.014456615    4.3825606e-39  0              0.043369846    4.2422288e-18  0              4.0968409e-13 -5.9828895e-14  0              2.9995283    
   2700000   4500           100            100            0.014456615    1.9142138e-59  0              0.043369846    4.8217295e-18  0              4.6564813e-13 -5.9828895e-14  0              2.9995283    
   2800000   4500           100            100            0.014456615   -4.3825606e-39  0              0.043369846    1.2775689e-18  0              1.2337846e-13 -5.9828895e-14  0              2.9995283    
   2900000   4500           100            100            0.014456615   -8.7651212e-39  0              0.043369846    6.5431338e-23  0              6.3188903e-18 -5.9828895e-14  0              2.9995283    
   3000000   4500           100            100            0.014456615    2.603749e-59   0              0.043369846    4.2592656e-18  0              4.1132939e-13 -5.9828895e-14  0              2.9995283    
Loop time of 310.53 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8347019.128 ns/day, 0.000 hours/ns, 9660.902 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.243     | 92.432     | 123.09     | 318.4 | 29.77
Neigh   | 0.58529    | 0.5923     | 0.59965    |   0.7 |  0.19
Comm    | 23.927     | 54.165     | 85.859     | 410.6 | 17.44
Output  | 0.19263    | 0.19278    | 0.19297    |   0.0 |  0.06
Modify  | 109.64     | 126.96     | 144.29     | 148.8 | 40.89
Other   |            | 36.19      |            |       | 11.65

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -700 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0047690793  -2.2438709e-36  0              0.014307238    69061.3        0              6.6694461e+09 -5.9828895e-14  0              3.8562059    
    200000   4500           100            100           -0.0021222166   2.2438715e-36  0             -0.0063666498   115476.77      0              1.115192e+10  -5.9828895e-14  0              3.0508876    
    300000   4500           100            100            0.0024888879  -2.2438702e-36  0              0.0074666637   32510.169      0              3.1395995e+09 -5.9828895e-14  0              3.0118283    
    400000   4500           100            100           -0.00074015793 -2.2438705e-36  0             -0.0022204738   5455.0006      0              5.2680491e+08 -5.9828895e-14  0              3.0056416    
    500000   4500           100            100           -0.00031943911 -4.4877417e-36  0             -0.00095831732  897.53371      0              86677381      -5.9828895e-14  0              3.0014982    
    600000   4500           100            100           -2.0956632e-05  3.3552111e-44  0             -6.2869895e-05  3.4819818      0              336264.88     -5.9828895e-14  0              3.0002653    
    700000   4500           100            100            0.018533832   -1.1219354e-36  0              0.055601496    51.600689      0              4983225.2     -5.9828895e-14  0              2.9994417    
    800000   4500           100            100            0.012062331    1.1394658e-37  0              0.036186994    1.2043746      0              116309.88     -5.9828895e-14  0              2.9995822    
    900000   4500           100            100            0.016808358   -2.8048387e-37  0              0.050425073    0.26204522     0              25306.452     -5.9828895e-14  0              2.9994783    
   1000000   4500           100            100            0.015191356    1.48641e-45    0              0.045574069    0.06220584     0              6007.3948     -5.9828895e-14  0              2.9995125    
   1100000   4500           100            100            0.015670192    1.4670763e-47  0              0.047010576    0.012406114    0              1198.0937     -5.9828895e-14  0              2.9995022    
   1200000   4500           100            100            0.015546735   -1.0956401e-39  0              0.046640206    0.0020766923   0              200.55208     -5.9828895e-14  0              2.9995049    
   1300000   4500           100            100            0.015570417    8.7651212e-39  0              0.046711252    0.00030467059  0              29.422905     -5.9828895e-14  0              2.9995044    
   1400000   4500           100            100            0.015570098    4.3825606e-39  0              0.046710293    3.958227e-05   0              3.8225723     -5.9828895e-14  0              2.9995044    
   1500000   4500           100            100            0.015567186    2.1912803e-39  0              0.046701558    4.5427988e-06  0              0.43871099    -5.9828895e-14  0              2.9995044    
   1600000   4500           100            100            0.015569288    4.3825606e-39  0              0.046707865    4.5144479e-07  0              0.043597307   -5.9828895e-14  0              2.9995044    
   1700000   4500           100            100            0.015568188    4.3825606e-39  0              0.046704565    3.691708e-08   0              0.0035651873  -5.9828895e-14  0              2.9995044    
   1800000   4500           100            100            0.015568687    9.0076154e-52  0              0.046706061    2.177467e-09   0              0.00021028417 -5.9828895e-14  0              2.9995044    
   1900000   4500           100            100            0.01556848     3.8879059e-53  0              0.046705441    5.6085211e-11  0              5.4163082e-06 -5.9828895e-14  0              2.9995044    
   2000000   4500           100            100            0.01556856    -4.3825606e-39  0              0.046705681    8.0965449e-13  0              7.8190635e-08 -5.9828895e-14  0              2.9995044    
   2100000   4500           100            100            0.015568531   -8.7651212e-39  0              0.046705594    2.6566274e-12  0              2.5655806e-07 -5.9828895e-14  0              2.9995044    
   2200000   4500           100            100            0.015568541    4.3825606e-39  0              0.046705624    1.0672225e-12  0              1.0306471e-07 -5.9828895e-14  0              2.9995044    
   2300000   4500           100            100            0.015568538    7.9373717e-57  0              0.046705614    2.6452993e-13  0              2.5546407e-08 -5.9828895e-14  0              2.9995044    
   2400000   4500           100            100            0.015568539   -4.3825606e-39  0              0.046705617    5.1243815e-14  0              4.9487608e-09 -5.9828895e-14  0              2.9995044    
   2500000   4500           100            100            0.015568539    8.1684791e-58  0              0.046705616    8.3647664e-15  0              8.0780927e-10 -5.9828895e-14  0              2.9995044    
   2600000   4500           100            100            0.015568539   -4.3825606e-39  0              0.046705616    1.2045482e-15  0              1.1632665e-10 -5.9828895e-14  0              2.9995044    
   2700000   4500           100            100            0.015568539    2.5440898e-58  0              0.046705616    1.533658e-16   0              1.4810971e-11 -5.9828895e-14  0              2.9995044    
   2800000   4500           100            100            0.015568539   -4.3825606e-39  0              0.046705616    1.9147241e-17  0              1.8491035e-12 -5.9828895e-14  0              2.9995044    
   2900000   4500           100            100            0.015568539    1.7530242e-38  0              0.046705616    3.6228253e-18  0              3.4986653e-13 -5.9828895e-14  0              2.9995044    
   3000000   4500           100            100            0.015568539    4.3825606e-39  0              0.046705616    2.8145784e-18  0              2.7181184e-13 -5.9828895e-14  0              2.9995044    
Loop time of 309.612 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8371777.012 ns/day, 0.000 hours/ns, 9689.557 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.407     | 92.167     | 123.08     | 319.9 | 29.77
Neigh   | 0.62254    | 0.63074    | 0.63898    |   0.7 |  0.20
Comm    | 23.533     | 54.077     | 85.097     | 412.1 | 17.47
Output  | 0.19302    | 0.19318    | 0.19337    |   0.0 |  0.06
Modify  | 109.47     | 126.73     | 143.52     | 148.4 | 40.93
Other   |            | 35.81      |            |       | 11.57

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -750 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.006784434    6.731614e-36   0              0.020353302    123821.62      0              1.1957806e+10 -5.9828895e-14  0              3.8055417    
    200000   4500           100            100           -0.0017491016   1.7951016e-35  0             -0.0052473048   40660.473      0              3.9266975e+09 -5.9828895e-14  0              3.1540002    
    300000   4500           100            100           -0.00094826963 -1.1219354e-36  0             -0.0028448089   9327.2639      0              9.0076038e+08 -5.9828895e-14  0              3.0420681    
    400000   4500           100            100            0.0010397976   3.6210549e-42  0              0.0031193927   7089.0353      0              6.8460828e+08 -5.9828895e-14  0              3.0042681    
    500000   4500           100            100            8.9623077e-05 -1.1219355e-36  0              0.00026886923  64.290991      0              6208763.7     -5.9828895e-14  0              3.0026714    
    600000   4500           100            100            0.00015240715  4.4446206e-43  0              0.00045722146  183.00074      0              17672902      -5.9828895e-14  0              3.0000001    
    700000   4500           100            100            0.027988038    2.2438711e-36  0              0.083964115    4.6751093      0              451488.59     -5.9828895e-14  0              2.9992668    
    800000   4500           100            100            0.020133265    2.4493956e-44  0              0.060399795    2.3711636      0              228990        -5.9828895e-14  0              2.9994121    
    900000   4500           100            100            0.017926777   -1.9633871e-36  0              0.053780331    0.30931604     0              29871.529     -5.9828895e-14  0              2.9994557    
   1000000   4500           100            100            0.017161595   -7.450353e-38   0              0.051484784    0.028289109    0              2731.9596     -5.9828895e-14  0              2.9994712    
   1100000   4500           100            100            0.016864792   -3.5060485e-38  0              0.050594375    0.0021666361   0              209.23821     -5.9828895e-14  0              2.9994773    
   1200000   4500           100            100            0.016750024    2.9321942e-48  0              0.050250073    0.0001276771   0              12.33014      -5.9828895e-14  0              2.9994796    
   1300000   4500           100            100            0.016706315   -8.7651212e-38  0              0.050118945    3.9818195e-06  0              0.38453563    -5.9828895e-14  0              2.9994805    
   1400000   4500           100            100            0.016689924   -1.7530242e-38  0              0.050069773    3.1310827e-09  0              0.00030237755 -5.9828895e-14  0              2.9994809    
   1500000   4500           100            100            0.016683869    1.7530242e-38  0              0.050051607    9.3148941e-08  0              0.008995658   -5.9828895e-14  0              2.999481     
   1600000   4500           100            100            0.016681664    1.7530242e-38  0              0.050044993    4.5493256e-08  0              0.004393413   -5.9828895e-14  0              2.999481     
   1700000   4500           100            100            0.016680874    3.5060485e-38  0              0.050042621    1.2939812e-08  0              0.0012496344  -5.9828895e-14  0              2.9994811    
   1800000   4500           100            100            0.016680594   -3.5060485e-38  0              0.050041783    2.9120877e-09  0              0.00028122859 -5.9828895e-14  0              2.9994811    
   1900000   4500           100            100            0.016680497    1.8111039e-53  0              0.050041491    5.7274742e-10  0              5.5311847e-05 -5.9828895e-14  0              2.9994811    
   2000000   4500           100            100            0.016680464   -7.0120969e-38  0              0.050041392    1.0295517e-10  0              9.9426736e-06 -5.9828895e-14  0              2.9994811    
   2100000   4500           100            100            0.016680453    3.5060485e-38  0              0.050041358    1.7332642e-11  0              1.6738625e-06 -5.9828895e-14  0              2.9994811    
   2200000   4500           100            100            0.016680449   -1.7530242e-38  0              0.050041347    2.7692106e-12  0              2.6743054e-07 -5.9828895e-14  0              2.9994811    
   2300000   4500           100            100            0.016680448    4.4274753e-56  0              0.050041344    4.2331127e-13  0              4.0880372e-08 -5.9828895e-14  0              2.9994811    
   2400000   4500           100            100            0.016680448    1.323655e-57   0              0.050041343    6.2323953e-14  0              6.0188013e-09 -5.9828895e-14  0              2.9994811    
   2500000   4500           100            100            0.016680448   -3.5060485e-38  0              0.050041343    8.951203e-15   0              8.6444312e-10 -5.9828895e-14  0              2.9994811    
   2600000   4500           100            100            0.016680448    1.7530242e-38  0              0.050041343    1.2395732e-15  0              1.1970911e-10 -5.9828895e-14  0              2.9994811    
   2700000   4500           100            100            0.016680448    1.227117e-37   0              0.050041343    1.5544559e-16  0              1.5011822e-11 -5.9828895e-14  0              2.9994811    
   2800000   4500           100            100            0.016680447    1.6134894e-56  0              0.050041342    3.0208384e-18  0              2.9173095e-13 -5.9828895e-14  0              2.9994811    
   2900000   4500           100            100            0.016680448    1.5265508e-56  0              0.050041343    7.9954444e-18  0              7.7214279e-13 -5.9828895e-14  0              2.9994811    
   3000000   4500           100            100            0.016680448    1.5206038e-56  0              0.050041343    2.3150198e-19  0              2.2356804e-14 -5.9828895e-14  0              2.9994811    
Loop time of 310.503 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8347734.680 ns/day, 0.000 hours/ns, 9661.730 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.149     | 92.292     | 123.56     | 321.9 | 29.72
Neigh   | 0.6723     | 0.67913    | 0.68571    |   0.6 |  0.22
Comm    | 23.388     | 54.417     | 86.468     | 415.4 | 17.53
Output  | 0.1949     | 0.19506    | 0.19526    |   0.0 |  0.06
Modify  | 109.14     | 126.9      | 144.18     | 149.6 | 40.87
Other   |            | 36.02      |            |       | 11.60

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -800 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0089236235   3.4295505e-43  0              0.026770871    192909.25      0              1.8629794e+10 -5.9828895e-14  0              3.735986     
    200000   4500           100            100           -0.00075194263  2.9435188e-42  0             -0.0022558279   4813.6199      0              4.6486495e+08 -5.9828895e-14  0              3.2082545    
    300000   4500           100            100            0.00061609128  8.9754854e-36  0              0.0018482739   2618.205       0              2.528475e+08  -5.9828895e-14  0              3.0538291    
    400000   4500           100            100            8.7049234e-05 -4.4877388e-36  0              0.0002611477   60.314311      0              5824724.5     -5.9828895e-14  0              3.0133015    
    500000   4500           100            100            0.00047935052  4.4877431e-36  0              0.0014380516   1681.0012      0              1.6233907e+08 -5.9828895e-14  0              3.0006088    
    600000   4500           100            100            0.0099154617   4.4877424e-36  0              0.029746385    397.67557      0              38404660      -5.9828895e-14  0              2.9996388    
    700000   4500           100            100            0.016145412   -5.6096774e-37  0              0.048436235    58.198949      0              5620437.9     -5.9828895e-14  0              2.999494     
    800000   4500           100            100            0.02164243     1.4204733e-45  0              0.064927291    1.4224776      0              137372.71     -5.9828895e-14  0              2.9993824    
    900000   4500           100            100            0.016306343    1.8654069e-44  0              0.048919028    0.021601811    0              2086.1483     -5.9828895e-14  0              2.9994889    
   1000000   4500           100            100            0.018346373    1.6652975e-49  0              0.05503912     0.00017773273  0              17.164155     -5.9828895e-14  0              2.9994471    
   1100000   4500           100            100            0.017595363    8.7651212e-39  0              0.052786088    0.0007486105   0              72.295444     -5.9828895e-14  0              2.9994623    
   1200000   4500           100            100            0.017860819    4.3825606e-39  0              0.053582457    0.00031831128  0              30.740225     -5.9828895e-14  0              2.9994569    
   1300000   4500           100            100            0.01776932     2.30766e-48    0              0.05330796     8.4148399e-05  0              8.1264501     -5.9828895e-14  0              2.9994587    
   1400000   4500           100            100            0.017799805    1.7530242e-38  0              0.053399415    1.7860658e-05  0              1.7248545     -5.9828895e-14  0              2.9994581    
   1500000   4500           100            100            0.017790034    8.7651212e-39  0              0.053370102    3.3097924e-06  0              0.31963606    -5.9828895e-14  0              2.9994583    
   1600000   4500           100            100            0.01779301     1.7530242e-38  0              0.053379031    5.5738924e-07  0              0.053828663   -5.9828895e-14  0              2.9994582    
   1700000   4500           100            100            0.017792168   -1.7530242e-38  0              0.053376504    8.7073889e-08  0              0.0084089729  -5.9828895e-14  0              2.9994583    
   1800000   4500           100            100            0.017792378    2.6295364e-38  0              0.053377135    1.2764921e-08  0              0.0012327447  -5.9828895e-14  0              2.9994583    
   1900000   4500           100            100            0.017792339    1.1451978e-51  0              0.053377017    1.7669159e-09  0              0.00017063609 -5.9828895e-14  0              2.9994583    
   2000000   4500           100            100            0.017792339    1.9212763e-52  0              0.053377018    2.3149278e-10  0              2.2355916e-05 -5.9828895e-14  0              2.9994583    
   2100000   4500           100            100            0.017792344    1.6978664e-53  0              0.053377033    2.868304e-11   0              2.7700027e-06 -5.9828895e-14  0              2.9994583    
   2200000   4500           100            100            0.017792341   -8.7651212e-39  0              0.053377022    3.344921e-12   0              3.2302853e-07 -5.9828895e-14  0              2.9994583    
   2300000   4500           100            100            0.017792343    1.7530242e-38  0              0.053377028    3.646659e-13   0              3.5216822e-08 -5.9828895e-14  0              2.9994583    
   2400000   4500           100            100            0.017792342    8.4643106e-58  0              0.053377025    3.6893192e-14  0              3.5628804e-09 -5.9828895e-14  0              2.9994583    
   2500000   4500           100            100            0.017792342    2.5124999e-58  0              0.053377026    3.3548976e-15  0              3.23992e-10   -5.9828895e-14  0              2.9994583    
   2600000   4500           100            100            0.017792342    2.0234057e-58  0              0.053377026    3.0042063e-16  0              2.9012474e-11 -5.9828895e-14  0              2.9994583    
   2700000   4500           100            100            0.017792342    8.7651212e-39  0              0.053377026    3.6955953e-18  0              3.5689415e-13 -5.9828895e-14  0              2.9994583    
   2800000   4500           100            100            0.017792342   -8.7651212e-39  0              0.053377026    2.0174679e-17  0              1.9483261e-12 -5.9828895e-14  0              2.9994583    
   2900000   4500           100            100            0.017792342    1.5099017e-58  0              0.053377026    4.3617839e-18  0              4.2122987e-13 -5.9828895e-14  0              2.9994583    
   3000000   4500           100            100            0.017792342    2.6295364e-37  0              0.053377026    5.5730324e-18  0              5.3820358e-13 -5.9828895e-14  0              2.9994583    
Loop time of 311.052 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8333007.726 ns/day, 0.000 hours/ns, 9644.685 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.393     | 92.726     | 123.9      | 319.4 | 29.81
Neigh   | 0.65745    | 0.6663     | 0.6753     |   0.8 |  0.21
Comm    | 23.509     | 54.239     | 86.568     | 413.0 | 17.44
Output  | 0.19542    | 0.19558    | 0.19576    |   0.0 |  0.06
Modify  | 109.1      | 127.08     | 144.17     | 148.8 | 40.86
Other   |            | 36.14      |            |       | 11.62

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -850 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.011172421    8.9754893e-36  0              0.033517263    275814.83      0              2.6636222e+10 -5.9828895e-14  0              3.6501056    
    200000   4500           100            100            0.0007416968   1.6220041e-41  0              0.0022250904   3379.5221      0              3.2637006e+08 -5.9828895e-14  0              3.2201127    
    300000   4500           100            100            0.0027030342  -1.1219353e-36  0              0.0081091025   37293.142      0              3.6015047e+09 -5.9828895e-14  0              3.0128656    
    400000   4500           100            100           -0.00081597732  1.2335327e-42  0             -0.002447932    6805.2961      0              6.5720678e+08 -5.9828895e-14  0              3.0049757    
    500000   4500           100            100            0.11341295    -2.2438707e-36  0              0.34023886     11.669372      0              1126944.4     -5.9828895e-14  0              2.9981366    
    600000   4500           100            100            0.01121642    -2.2438709e-36  0              0.03364926     415.69508      0              40144855      -5.9828895e-14  0              2.9996073    
    700000   4500           100            100            0.014790991    1.1219355e-36  0              0.044372972    53.54075       0              5170582.4     -5.9828895e-14  0              2.9995193    
    800000   4500           100            100            0.022858005    3.9296393e-46  0              0.068574014    1.436903       0              138765.8      -5.9828895e-14  0              2.9993595    
    900000   4500           100            100            0.020410497    3.5060485e-38  0              0.06123149     0.086251455    0              8329.5482     -5.9828895e-14  0              2.9994064    
   1000000   4500           100            100            0.019259782    7.012097e-38   0              0.057779345    0.087703245    0              8469.7517     -5.9828895e-14  0              2.9994289    
   1100000   4500           100            100            0.018920723    6.5738409e-38  0              0.056762169    0.018921093    0              1827.2637     -5.9828895e-14  0              2.9994356    
   1200000   4500           100            100            0.018867196    8.7651212e-39  0              0.056601587    0.0019008334   0              183.56889     -5.9828895e-14  0              2.9994367    
   1300000   4500           100            100            0.018879717   -2.6295364e-37  0              0.05663915     6.4527154e-05  0              6.2315707     -5.9828895e-14  0              2.9994364    
   1400000   4500           100            100            0.018894366    4.0838822e-49  0              0.056683098    8.8643393e-07  0              0.085605444   -5.9828895e-14  0              2.9994361    
   1500000   4500           100            100            0.018901534    7.3905759e-51  0              0.056704602    2.6642998e-06  0              0.25729901    -5.9828895e-14  0              2.999436     
   1600000   4500           100            100            0.01890391     5.9792285e-54  0              0.056711729    7.3695615e-07  0              0.07116995    -5.9828895e-14  0              2.9994359    
   1700000   4500           100            100            0.018904391   -1.7530242e-38  0              0.056713172    9.0442114e-08  0              0.008734252   -5.9828895e-14  0              2.9994359    
   1800000   4500           100            100            0.018904365    8.7651212e-39  0              0.056713096    4.5361434e-09  0              0.00043806826 -5.9828895e-14  0              2.9994359    
   1900000   4500           100            100            0.018904286    9.3493121e-52  0              0.056712859    4.9233032e-13  0              4.7545738e-08 -5.9828895e-14  0              2.9994359    
   2000000   4500           100            100            0.018904242    1.895819e-52   0              0.056712726    7.2358497e-11  0              6.9878657e-06 -5.9828895e-14  0              2.9994359    
   2100000   4500           100            100            0.018904226   -6.1355848e-38  0              0.056712677    2.7229882e-11  0              2.6296671e-06 -5.9828895e-14  0              2.9994359    
   2200000   4500           100            100            0.018904222    2.6295364e-38  0              0.056712666    4.061296e-12   0              3.9221089e-07 -5.9828895e-14  0              2.9994359    
   2300000   4500           100            100            0.018904222    1.7530242e-38  0              0.056712665    2.7395593e-13  0              2.6456703e-08 -5.9828895e-14  0              2.9994359    
   2400000   4500           100            100            0.018904222    6.9416983e-58  0              0.056712666    2.2352254e-15  0              2.1586207e-10 -5.9828895e-14  0              2.9994359    
   2500000   4500           100            100            0.018904222   -1.7530242e-38  0              0.056712667    1.7387818e-15  0              1.679191e-10  -5.9828895e-14  0              2.9994359    
   2600000   4500           100            100            0.018904223    1.7530242e-38  0              0.056712668    9.0483912e-16  0              8.7382885e-11 -5.9828895e-14  0              2.9994359    
   2700000   4500           100            100            0.018904223   -1.7530242e-38  0              0.056712668    1.6912734e-16  0              1.6333108e-11 -5.9828895e-14  0              2.9994359    
   2800000   4500           100            100            0.018904223    8.7651212e-39  0              0.056712668    2.7553126e-18  0              2.6608837e-13 -5.9828895e-14  0              2.9994359    
   2900000   4500           100            100            0.018904223   -8.7651212e-39  0              0.056712668    4.1395105e-18  0              3.997643e-13  -5.9828895e-14  0              2.9994359    
   3000000   4500           100            100            0.018904223   -1.7530242e-38  0              0.056712668    2.6562722e-20  0              2.5652376e-15 -5.9828895e-14  0              2.9994359    
Loop time of 313.108 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8278293.646 ns/day, 0.000 hours/ns, 9581.358 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.004     | 93.191     | 126.19     | 324.6 | 29.76
Neigh   | 0.67264    | 0.68195    | 0.69105    |   0.8 |  0.22
Comm    | 23.514     | 55.252     | 89.314     | 411.3 | 17.65
Output  | 0.19385    | 0.194      | 0.19418    |   0.0 |  0.06
Modify  | 108.64     | 127.53     | 143.96     | 146.0 | 40.73
Other   |            | 36.26      |            |       | 11.58

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -900 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.013519764    5.6096777e-37  0              0.040559293    372188.41      0              3.5943292e+10 -5.9828895e-14  0              3.5499309    
    200000   4500           100            100            0.0026358287   1.795099e-35   0              0.007907486    33040.962      0              3.1908596e+09 -5.9828895e-14  0              3.1946739    
    300000   4500           100            100           -0.0011979093   1.7950982e-35  0             -0.003593728    16525.775      0              1.595941e+09  -5.9828895e-14  0              3.0349751    
    400000   4500           100            100            0.00088449263  1.1219358e-36  0              0.0026534779   5266.8159      0              5.0863138e+08 -5.9828895e-14  0              3.0074475    
    500000   4500           100            100           -0.00049721557 -2.2438701e-36  0             -0.0014916467   2290.1554      0              2.2116682e+08 -5.9828895e-14  0              3.0000114    
    600000   4500           100            100            0.0019282662   1.4024194e-37  0              0.0057847985   246.93765      0              23847471      -5.9828895e-14  0              2.9998846    
    700000   4500           100            100            0.01819055    -2.2438709e-36  0              0.05457165     61.644544      0              5953188.8     -5.9828895e-14  0              2.999452     
    800000   4500           100            100            0.023967772    1.1219356e-36  0              0.071903315    1.840069       0              177700.69     -5.9828895e-14  0              2.9993395    
    900000   4500           100            100            0.020260686    5.6096777e-37  0              0.060782059    1.0863806      0              104914.86     -5.9828895e-14  0              2.999409     
   1000000   4500           100            100            0.019454254    2.1036291e-37  0              0.058362761    0.0078158367   0              754.79757     -5.9828895e-14  0              2.999425     
   1100000   4500           100            100            0.020143353    7.2259225e-47  0              0.06043006     0.012527494    0              1209.8157     -5.9828895e-14  0              2.9994115    
   1200000   4500           100            100            0.020053591    3.5060485e-38  0              0.060160773    0.001966739    0              189.93358     -5.9828895e-14  0              2.9994133    
   1300000   4500           100            100            0.019988261   -3.5060485e-38  0              0.059964783    3.4920881e-06  0              0.33724088    -5.9828895e-14  0              2.9994145    
   1400000   4500           100            100            0.02001925     3.5060485e-38  0              0.060057749    4.1242535e-05  0              3.9829088     -5.9828895e-14  0              2.9994139    
   1500000   4500           100            100            0.020018854   -1.7530242e-38  0              0.060056563    2.6533394e-06  0              0.25624052    -5.9828895e-14  0              2.9994139    
   1600000   4500           100            100            0.020014863    1.7530242e-38  0              0.060044588    1.4067033e-07  0              0.013584934   -5.9828895e-14  0              2.999414     
   1700000   4500           100            100            0.020016082    5.0573345e-51  0              0.060048245    1.0592507e-07  0              0.010229486   -5.9828895e-14  0              2.999414     
   1800000   4500           100            100            0.020016254   -1.7530242e-38  0              0.060048763    2.0612559e-09  0              0.00019906134 -5.9828895e-14  0              2.999414     
   1900000   4500           100            100            0.020016042   -1.7530242e-38  0              0.060048127    8.9184527e-10  0              8.6128033e-05 -5.9828895e-14  0              2.999414     
   2000000   4500           100            100            0.020016081   -1.7530242e-38  0              0.060048244    2.1736371e-10  0              2.0991431e-05 -5.9828895e-14  0              2.999414     
   2100000   4500           100            100            0.020016098    5.2590727e-37  0              0.060048294    1.2253745e-13  0              1.183379e-08  -5.9828895e-14  0              2.999414     
   2200000   4500           100            100            0.020016088   -3.5060485e-38  0              0.060048264    3.4255739e-12  0              3.308174e-07  -5.9828895e-14  0              2.999414     
   2300000   4500           100            100            0.020016089   -5.2590727e-38  0              0.060048266    3.4445832e-13  0              3.3265319e-08 -5.9828895e-14  0              2.999414     
   2400000   4500           100            100            0.02001609     1.598045e-55   0              0.06004827     5.2474801e-15  0              5.0676407e-10 -5.9828895e-14  0              2.999414     
   2500000   4500           100            100            0.020016089    3.1554436e-37  0              0.060048268    9.8732126e-15  0              9.534842e-10  -5.9828895e-14  0              2.999414     
   2600000   4500           100            100            0.020016089    1.7277492e-59  0              0.060048268    4.2325801e-16  0              4.0875229e-11 -5.9828895e-14  0              2.999414     
   2700000   4500           100            100            0.020016089   -1.7530242e-38  0              0.060048268    7.953764e-17   0              7.681176e-12  -5.9828895e-14  0              2.999414     
   2800000   4500           100            100            0.020016089    1.7530242e-38  0              0.060048268    1.2678439e-21  0              1.2243929e-16 -5.9828895e-14  0              2.999414     
   2900000   4500           100            100            0.020016089   -1.7530242e-38  0              0.060048268    4.8639308e-18  0              4.6972362e-13 -5.9828895e-14  0              2.999414     
   3000000   4500           100            100            0.020016089    3.5060485e-38  0              0.060048268    1.8015651e-18  0              1.7398226e-13 -5.9828895e-14  0              2.999414     
Loop time of 311.598 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8318406.255 ns/day, 0.000 hours/ns, 9627.785 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.589     | 92.551     | 123.51     | 318.3 | 29.70
Neigh   | 0.68748    | 0.69823    | 0.70877    |   0.9 |  0.22
Comm    | 23.438     | 53.945     | 85.112     | 411.7 | 17.31
Output  | 0.19509    | 0.19525    | 0.19542    |   0.0 |  0.06
Modify  | 110.69     | 128.03     | 145.42     | 149.5 | 41.09
Other   |            | 36.18      |            |       | 11.61

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -950 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.015956773    2.2438719e-36  0              0.047870319    481786.85      0              4.6527526e+10 -5.9828895e-14  0              3.4370993    
    200000   4500           100            100            0.0048561574   8.9754963e-36  0              0.014568472    91327.584      0              8.8197644e+09 -5.9828895e-14  0              3.1360438    
    300000   4500           100            100            0.00019329106  4.2738989e-42  0              0.00057987318  281.72133      0              27206629      -5.9828895e-14  0              3.0547753    
    400000   4500           100            100           -0.00031656138  1.3077471e-42  0             -0.00094968413  873.5085       0              84357199      -5.9828895e-14  0              3.0118675    
    500000   4500           100            100           -0.00033658568  7.1754158e-43  0             -0.001009757    1000.6055      0              96631314      -5.9828895e-14  0              3.001441     
    600000   4500           100            100            1.748746e-05  -3.5060485e-38  0              5.2462381e-05  2.5965094      0              250752.29     -5.9828895e-14  0              3.0001335    
    700000   4500           100            100            0.03279104     5.2540896e-45  0              0.09837312     11.858         0              1145160.8     -5.9828895e-14  0              2.999185     
    800000   4500           100            100            0.018560466    7.012097e-38   0              0.055681398    5.6795544      0              548490.71     -5.9828895e-14  0              2.9994433    
    900000   4500           100            100            0.020195923    7.012097e-38   0              0.060587769    0.77001411     0              74362.451     -5.9828895e-14  0              2.9994103    
   1000000   4500           100            100            0.021690686    3.498083e-46   0              0.065072057    0.015449528    0              1492.0049     -5.9828895e-14  0              2.9993817    
   1100000   4500           100            100            0.021140832   -3.5060485e-38  0              0.063422495    0.020024265    0              1933.8002     -5.9828895e-14  0              2.9993923    
   1200000   4500           100            100            0.021051076   -4.3825606e-39  0              0.063153228    0.00011337013  0              10.948475     -5.9828895e-14  0              2.999394     
   1300000   4500           100            100            0.021140868   -1.7530242e-38  0              0.063422603    0.00027938642  0              26.981141     -5.9828895e-14  0              2.9993922    
   1400000   4500           100            100            0.021135665    1.4200427e-50  0              0.063406995    2.1139892e-05  0              2.0415394     -5.9828895e-14  0              2.9993923    
   1500000   4500           100            100            0.021124758   -1.7530242e-38  0              0.063374275    1.7890985e-06  0              0.17277833    -5.9828895e-14  0              2.9993926    
   1600000   4500           100            100            0.021127527    6.6107804e-50  0              0.063382581    7.4658709e-07  0              0.072100037   -5.9828895e-14  0              2.9993925    
   1700000   4500           100            100            0.021128444   -1.7530242e-38  0              0.063385332    1.5548285e-10  0              1.5015421e-05 -5.9828895e-14  0              2.9993925    
   1800000   4500           100            100            0.021127902    3.9238476e-51  0              0.063383707    1.3651558e-08  0              0.0013183698  -5.9828895e-14  0              2.9993925    
   1900000   4500           100            100            0.021127884    3.2121033e-52  0              0.063383653    4.2526667e-10  0              4.1069211e-05 -5.9828895e-14  0              2.9993925    
   2000000   4500           100            100            0.021127959    1.4565064e-52  0              0.063383878    1.3332151e-10  0              1.2875237e-05 -5.9828895e-14  0              2.9993925    
   2100000   4500           100            100            0.021127948    1.7530242e-38  0              0.063383843    2.433064e-11   0              2.349679e-06  -5.9828895e-14  0              2.9993925    
   2200000   4500           100            100            0.02112794     5.1088034e-55  0              0.06338382     3.4767562e-13  0              3.3576023e-08 -5.9828895e-14  0              2.9993925    
   2300000   4500           100            100            0.021127943    1.7530242e-38  0              0.063383829    5.8550498e-13  0              5.654388e-08  -5.9828895e-14  0              2.9993925    
   2400000   4500           100            100            0.021127943   -8.7651212e-38  0              0.06338383     4.6729714e-15  0              4.5128213e-10 -5.9828895e-14  0              2.9993925    
   2500000   4500           100            100            0.021127943   -1.7530242e-38  0              0.063383828    7.9040141e-15  0              7.633131e-10  -5.9828895e-14  0              2.9993925    
   2600000   4500           100            100            0.021127943   -8.7651212e-39  0              0.063383829    6.0100246e-16  0              5.8040516e-11 -5.9828895e-14  0              2.9993925    
   2700000   4500           100            100            0.021127943   -1.7530242e-38  0              0.063383829    7.5198602e-17  0              7.2621428e-12 -5.9828895e-14  0              2.9993925    
   2800000   4500           100            100            0.021127943   -1.7530242e-38  0              0.063383829    3.4867707e-18  0              3.3672735e-13 -5.9828895e-14  0              2.9993925    
   2900000   4500           100            100            0.021127943    8.7651212e-39  0              0.063383829    3.2167915e-18  0              3.106547e-13  -5.9828895e-14  0              2.9993925    
   3000000   4500           100            100            0.021127943    2.8415788e-57  0              0.063383829    3.7410804e-18  0              3.6128677e-13 -5.9828895e-14  0              2.9993925    
Loop time of 310.192 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8356120.885 ns/day, 0.000 hours/ns, 9671.436 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.113     | 92.362     | 123.15     | 319.4 | 29.78
Neigh   | 0.7004     | 0.71023    | 0.7208     |   0.9 |  0.23
Comm    | 23.764     | 54.12      | 86.029     | 412.2 | 17.45
Output  | 0.19379    | 0.19394    | 0.19412    |   0.0 |  0.06
Modify  | 109.23     | 126.85     | 143.8      | 149.3 | 40.89
Other   |            | 35.96      |            |       | 11.59

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.018476127   -1.795095e-35   0              0.055428382    604440.47      0              5.8372534e+10 -5.9828895e-14  0              3.3129534    
    200000   4500           100            100            0.0073437667   1.7950995e-35  0              0.0220313      176363.51      0              1.7031925e+10 -5.9828895e-14  0              3.0475848    
    300000   4500           100            100            0.0021337455   8.9754888e-36  0              0.0064012364   24838.755      0              2.3987492e+09 -5.9828895e-14  0              3.0314324    
    400000   4500           100            100            0.13251687     5.6951345e-42  0              0.3975506      10021.225      0              9.6777821e+08 -5.9828895e-14  0              2.9979465    
    500000   4500           100            100           -0.00021544729 -2.2438704e-36  0             -0.00064634188  396.07411      0              38250003      -5.9828895e-14  0              3.0020564    
    600000   4500           100            100            0.007210924   -2.2438706e-36  0              0.021632772    373.05952      0              36027418      -5.9828895e-14  0              2.9996976    
    700000   4500           100            100            0.017763581    1.2124771e-43  0              0.053290744    58.036439      0              5604743.8     -5.9828895e-14  0              2.9994571    
    800000   4500           100            100            0.021612296   -7.0120968e-38  0              0.064836889    8.7094228      0              841093.72     -5.9828895e-14  0              2.9993826    
    900000   4500           100            100            0.021372066    1.4024194e-37  0              0.064116198    0.85654573     0              82719.056     -5.9828895e-14  0              2.9993876    
   1000000   4500           100            100            0.021714269   -2.8048388e-37  0              0.065142806    0.038315189    0              3700.2067     -5.9828895e-14  0              2.9993813    
   1100000   4500           100            100            0.022019635    1.6413456e-47  0              0.066058906    2.8146755e-09  0              0.00027182121 -5.9828895e-14  0              2.9993755    
   1200000   4500           100            100            0.022170404    1.9996174e-48  0              0.066511212    0.00067658371  0              65.339612     -5.9828895e-14  0              2.9993727    
   1300000   4500           100            100            0.022225187    1.7530242e-38  0              0.06667556     0.00026977422  0              26.052863     -5.9828895e-14  0              2.9993716    
   1400000   4500           100            100            0.022239765    3.5060485e-38  0              0.066719296    4.7844162e-05  0              4.6204467     -5.9828895e-14  0              2.9993714    
   1500000   4500           100            100            0.022241705    3.5060485e-38  0              0.066725115    4.7892944e-06  0              0.46251577    -5.9828895e-14  0              2.9993713    
   1600000   4500           100            100            0.022240998    4.2221831e-50  0              0.066722993    2.1587372e-07  0              0.020847539   -5.9828895e-14  0              2.9993713    
   1700000   4500           100            100            0.022240295    7.0120969e-38  0              0.066720885    1.094892e-11   0              1.0573684e-06 -5.9828895e-14  0              2.9993714    
   1800000   4500           100            100            0.022239945   -7.0120969e-38  0              0.066719836    3.5329864e-09  0              0.00034119054 -5.9828895e-14  0              2.9993714    
   1900000   4500           100            100            0.022239818   -5.6096775e-37  0              0.066719453    1.4391602e-09  0              0.00013898379 -5.9828895e-14  0              2.9993714    
   2000000   4500           100            100            0.022239783    1.6305362e-54  0              0.06671935     2.5795571e-10  0              2.4911516e-05 -5.9828895e-14  0              2.9993714    
   2100000   4500           100            100            0.022239779    7.0120969e-38  0              0.066719336    2.6078535e-11  0              2.5184782e-06 -5.9828895e-14  0              2.9993714    
   2200000   4500           100            100            0.02223978    -3.5060485e-38  0              0.066719341    1.1983822e-12  0              1.1573117e-07 -5.9828895e-14  0              2.9993714    
   2300000   4500           100            100            0.022239782   -3.5060485e-38  0              0.066719346    1.8338567e-16  0              1.7710076e-11 -5.9828895e-14  0              2.9993714    
   2400000   4500           100            100            0.022239783   -3.5060485e-38  0              0.066719348    1.8811499e-14  0              1.8166799e-09 -5.9828895e-14  0              2.9993714    
   2500000   4500           100            100            0.022239783   -1.4024194e-37  0              0.066719349    7.7795361e-15  0              7.5129191e-10 -5.9828895e-14  0              2.9993714    
   2600000   4500           100            100            0.022239783    2.4409282e-56  0              0.06671935     1.3993356e-15  0              1.3513782e-10 -5.9828895e-14  0              2.9993714    
   2700000   4500           100            100            0.022239783   -3.5060485e-38  0              0.06671935     1.1536597e-16  0              1.1141219e-11 -5.9828895e-14  0              2.9993714    
   2800000   4500           100            100            0.022239783    3.7721689e-56  0              0.06671935     3.1070976e-22  0              3.0006125e-17 -5.9828895e-14  0              2.9993714    
   2900000   4500           100            100            0.022239783    3.5060485e-38  0              0.06671935     1.0999287e-18  0              1.0622324e-13 -5.9828895e-14  0              2.9993714    
   3000000   4500           100            100            0.022239783    7.0120969e-38  0              0.06671935     5.6817113e-18  0              5.4869901e-13 -5.9828895e-14  0              2.9993714    
Loop time of 311.118 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8331243.236 ns/day, 0.000 hours/ns, 9642.643 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.161     | 92.363     | 123.16     | 319.9 | 29.69
Neigh   | 0.72721    | 0.73794    | 0.74843    |   0.9 |  0.24
Comm    | 23.898     | 54.358     | 86.146     | 412.4 | 17.47
Output  | 0.19526    | 0.19541    | 0.19558    |   0.0 |  0.06
Modify  | 109.84     | 127.53     | 144.58     | 148.9 | 40.99
Other   |            | 35.93      |            |       | 11.55

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 174
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1050 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.021071654   -8.975469e-36   0              0.063214962    740031.08      0              7.1466905e+10 -5.9828895e-14  0              3.1786099    
    200000   4500           100            100           -0.0020821704   1.7950971e-35  0             -0.0062465113   185661.94      0              1.7929901e+10 -5.9828895e-14  0              3.0336154    
    300000   4500           100            100           -0.0016938305   1.2004035e-41  0             -0.0050814914   44924.103      0              4.3384483e+09 -5.9828895e-14  0              3.0105254    
    400000   4500           100            100            9.3499412e-05  1.6611111e-42  0              0.00028049823  69.632575      0              6724615.7     -5.9828895e-14  0              3.0126771    
    500000   4500           100            100           -0.00013783244  5.6096778e-37  0             -0.00041349733  158.45793      0              15302732      -5.9828895e-14  0              3.0022634    
    600000   4500           100            100            0.062545936   -2.243871e-36   0              0.18763781     0.72113823     0              69642.369     -5.9828895e-14  0              2.9987472    
    700000   4500           100            100            0.012017981    9.2529744e-44  0              0.036053942    7.30701        0              705658.73     -5.9828895e-14  0              2.9995823    
    800000   4500           100            100            0.024072176    4.9697735e-46  0              0.072216527    8.8936375      0              858883.85     -5.9828895e-14  0              2.9993379    
    900000   4500           100            100            0.023794058   -5.6096773e-37  0              0.071382173    1.1212515      0              108282.45     -5.9828895e-14  0              2.9993422    
   1000000   4500           100            100            0.022981763    3.5060485e-38  0              0.068945288    0.10164644     0              9816.2852     -5.9828895e-14  0              2.9993575    
   1100000   4500           100            100            0.023540964    1.5777218e-37  0              0.070622893    0.0061067579   0              589.74697     -5.9828895e-14  0              2.9993471    
   1200000   4500           100            100            0.02327165    -7.0120969e-38  0              0.069814951    0.00012030386  0              11.618085     -5.9828895e-14  0              2.9993521    
   1300000   4500           100            100            0.023381074   -3.5060485e-38  0              0.070143223    8.1510552e-06  0              0.78717057    -5.9828895e-14  0              2.99935      
   1400000   4500           100            100            0.023342122    3.4203555e-48  0              0.070026365    1.1543973e-05  0              1.1148343     -5.9828895e-14  0              2.9993508    
   1500000   4500           100            100            0.023354178    8.7651212e-39  0              0.070062534    3.7553016e-06  0              0.36266015    -5.9828895e-14  0              2.9993505    
   1600000   4500           100            100            0.023351117    1.2147941e-49  0              0.070053351    7.5849321e-07  0              0.073249845   -5.9828895e-14  0              2.9993506    
   1700000   4500           100            100            0.023351607    1.7530242e-38  0              0.070054821    1.1359544e-07  0              0.010970234   -5.9828895e-14  0              2.9993506    
   1800000   4500           100            100            0.023351678   -1.7530242e-38  0              0.070055035    1.3091032e-08  0              0.0012642381  -5.9828895e-14  0              2.9993506    
   1900000   4500           100            100            0.023351565    3.6177596e-53  0              0.070054695    1.1131013e-09  0              0.00010749536 -5.9828895e-14  0              2.9993506    
   2000000   4500           100            100            0.023351633    7.8760533e-54  0              0.070054898    5.7625465e-11  0              5.565055e-06  -5.9828895e-14  0              2.9993506    
   2100000   4500           100            100            0.023351601    3.5060485e-38  0              0.070054804    5.7493339e-13  0              5.5522952e-08 -5.9828895e-14  0              2.9993506    
   2200000   4500           100            100            0.023351614    7.0120969e-38  0              0.070054841    2.3784656e-13  0              2.2969519e-08 -5.9828895e-14  0              2.9993506    
   2300000   4500           100            100            0.02335161     3.5060485e-38  0              0.070054829    1.8663105e-13  0              1.8023491e-08 -5.9828895e-14  0              2.9993506    
   2400000   4500           100            100            0.023351611   -3.5060485e-38  0              0.070054832    5.2689111e-14  0              5.0883372e-09 -5.9828895e-14  0              2.9993506    
   2500000   4500           100            100            0.023351611    7.7414795e-58  0              0.070054832    9.9867764e-15  0              9.6445138e-10 -5.9828895e-14  0              2.9993506    
   2600000   4500           100            100            0.023351611    6.3976453e-62  0              0.070054832    1.4105976e-15  0              1.3622542e-10 -5.9828895e-14  0              2.9993506    
   2700000   4500           100            100            0.023351611    1.5594808e-58  0              0.070054832    1.9156516e-16  0              1.8499992e-11 -5.9828895e-14  0              2.9993506    
   2800000   4500           100            100            0.023351611    1.7530242e-38  0              0.070054832    2.2287707e-17  0              2.1523872e-12 -5.9828895e-14  0              2.9993506    
   2900000   4500           100            100            0.023351611   -3.5060485e-38  0              0.070054832    1.936245e-19   0              1.8698869e-14 -5.9828895e-14  0              2.9993506    
   3000000   4500           100            100            0.023351611   -3.5060485e-38  0              0.070054832    4.2214797e-20  0              4.0768029e-15 -5.9828895e-14  0              2.9993506    
Loop time of 310.288 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8353542.005 ns/day, 0.000 hours/ns, 9668.451 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.85      | 92.643     | 123.51     | 319.2 | 29.86
Neigh   | 0.73927    | 0.74896    | 0.75897    |   0.8 |  0.24
Comm    | 23.62      | 54.152     | 85.439     | 412.4 | 17.45
Output  | 0.19607    | 0.19622    | 0.19639    |   0.0 |  0.06
Modify  | 109.12     | 126.59     | 143.63     | 148.8 | 40.80
Other   |            | 35.96      |            |       | 11.59

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 176
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1100 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.023738045    2.2438717e-36  0              0.071214136    888476.85      0              8.5802735e+10 -5.9828895e-14  0              3.0350107    
    200000   4500           100            100           -0.0021325589   4.4877434e-36  0             -0.0063976768   91101.401      0              8.7979212e+09 -5.9828895e-14  0              3.1203338    
    300000   4500           100            100           -0.00069079404  4.4877458e-36  0             -0.0020723821   4513.156       0              4.358483e+08  -5.9828895e-14  0              3.048719     
    400000   4500           100            100            0.021115929   -8.9754795e-36  0              0.063347787    14279.874      0              1.379048e+09  -5.9828895e-14  0              2.9993713    
    500000   4500           100            100           -0.00010633917  3.0853227e-36  0             -0.00031901751  93.344133      0              9014508.2     -5.9828895e-14  0              3.0022899    
    600000   4500           100            100            0.0038577427  -4.4877414e-36  0              0.011573228    274.19259      0              26479558      -5.9828895e-14  0              2.9998109    
    700000   4500           100            100            0.012286904    5.8210656e-44  0              0.036860711    0.11987182     0              11576.362     -5.9828895e-14  0              2.9995768    
    800000   4500           100            100            0.026071223    5.6096779e-37  0              0.078213668    8.2564091      0              797344.89     -5.9828895e-14  0              2.9993005    
    900000   4500           100            100            0.026173527    1.4024194e-37  0              0.078520581    0.052313674    0              5052.0802     -5.9828895e-14  0              2.9992993    
   1000000   4500           100            100            0.024481426    8.7651212e-39  0              0.073444277    0.16324601     0              15765.131     -5.9828895e-14  0              2.9993299    
   1100000   4500           100            100            0.024242879    7.5066162e-47  0              0.072728638    0.001546621    0              149.36158     -5.9828895e-14  0              2.9993342    
   1200000   4500           100            100            0.024422014    1.6063764e-47  0              0.073266041    0.0021642576   0              209.0085      -5.9828895e-14  0              2.9993309    
   1300000   4500           100            100            0.024485343    1.3097428e-48  0              0.073456028    0.00017979072  0              17.362901     -5.9828895e-14  0              2.9993297    
   1400000   4500           100            100            0.024472766    2.6295364e-38  0              0.073418299    1.4396435e-05  0              1.3903047     -5.9828895e-14  0              2.99933      
   1500000   4500           100            100            0.024462171    6.1355848e-38  0              0.073386514    5.9680904e-06  0              0.57635545    -5.9828895e-14  0              2.9993301    
   1600000   4500           100            100            0.024461968    8.7651212e-39  0              0.073385904    5.1033044e-09  0              0.00049284061 -5.9828895e-14  0              2.9993301    
   1700000   4500           100            100            0.024463334    8.7651212e-39  0              0.073390003    1.1281021e-07  0              0.010894402   -5.9828895e-14  0              2.9993301    
   1800000   4500           100            100            0.024463602    1.9002987e-52  0              0.073390806    2.4754056e-09  0              0.00023905696 -5.9828895e-14  0              2.9993301    
   1900000   4500           100            100            0.024463468    8.7651212e-39  0              0.073390405    1.27276e-09    0              0.00012291405 -5.9828895e-14  0              2.9993301    
   2000000   4500           100            100            0.024463409   -3.5060485e-38  0              0.073390228    1.6568765e-10  0              1.6000927e-05 -5.9828895e-14  0              2.9993301    
   2100000   4500           100            100            0.024463417   -3.5060485e-38  0              0.07339025     6.0070859e-12  0              5.8012136e-07 -5.9828895e-14  0              2.9993301    
   2200000   4500           100            100            0.024463426    1.6085224e-55  0              0.073390277    4.5614323e-12  0              4.4051049e-07 -5.9828895e-14  0              2.9993301    
   2300000   4500           100            100            0.024463426   -8.7651212e-39  0              0.073390279    2.8490986e-15  0              2.7514555e-10 -5.9828895e-14  0              2.9993301    
   2400000   4500           100            100            0.024463425   -8.7651212e-39  0              0.073390276    7.489466e-14   0              7.2327902e-09 -5.9828895e-14  0              2.9993301    
   2500000   4500           100            100            0.024463425   -8.7651212e-39  0              0.073390275    2.9781428e-15  0              2.8760771e-10 -5.9828895e-14  0              2.9993301    
   2600000   4500           100            100            0.024463425    1.389552e-57   0              0.073390275    6.7406991e-16  0              6.5096847e-11 -5.9828895e-14  0              2.9993301    
   2700000   4500           100            100            0.024463425    6.1355848e-38  0              0.073390275    1.8816413e-16  0              1.8171545e-11 -5.9828895e-14  0              2.9993301    
   2800000   4500           100            100            0.024463425   -1.7530242e-38  0              0.073390275    8.2984765e-20  0              8.0140747e-15 -5.9828895e-14  0              2.9993301    
   2900000   4500           100            100            0.024463425   -1.7530242e-38  0              0.073390275    5.4969277e-18  0              5.3085394e-13 -5.9828895e-14  0              2.9993301    
   3000000   4500           100            100            0.024463425    8.7651212e-39  0              0.073390275    5.6066301e-18  0              5.414482e-13  -5.9828895e-14  0              2.9993301    
Loop time of 312.162 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8303389.372 ns/day, 0.000 hours/ns, 9610.404 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.179     | 92.746     | 125.09     | 325.7 | 29.71
Neigh   | 0.75419    | 0.76547    | 0.77628    |   0.9 |  0.25
Comm    | 23.48      | 55.109     | 88.084     | 415.6 | 17.65
Output  | 0.19477    | 0.19492    | 0.19511    |   0.0 |  0.06
Modify  | 108.72     | 127.32     | 144.1      | 147.8 | 40.79
Other   |            | 36.03      |            |       | 11.54

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 178
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1150 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0022297345  -8.975478e-36   0              0.0066892036   858499.19      0              8.2907707e+10 -5.9828895e-14  0              3.0620259    
    200000   4500           100            100           -0.0016077269   7.9056591e-42  0             -0.0048231807   30907.596      0              2.9848344e+09 -5.9828895e-14  0              3.177421     
    300000   4500           100            100            0.00091261149  3.9224597e-44  0              0.0027378345   5449.9377      0              5.2631597e+08 -5.9828895e-14  0              3.0500162    
    400000   4500           100            100            0.00037167418 -5.6096773e-37  0              0.0011150225   1027.8818      0              99265464      -5.9828895e-14  0              3.0117452    
    500000   4500           100            100           -0.00012184301  1.795097e-35   0             -0.00036552902  123.12872      0              11890891      -5.9828895e-14  0              3.002226     
    600000   4500           100            100            0.015261976    6.5245129e-43  0              0.045785927    485.25933      0              46862873      -5.9828895e-14  0              2.9995058    
    700000   4500           100            100            0.013122913    5.6942311e-43  0              0.039368738    0.029200292    0              2819.9552     -5.9828895e-14  0              2.9995577    
    800000   4500           100            100            0.020859795    4.0847816e-44  0              0.062579384    0.1293705      0              12493.677     -5.9828895e-14  0              2.9993977    
    900000   4500           100            100            0.024354079    5.1850944e-45  0              0.073062237    0.64852626     0              62630.024     -5.9828895e-14  0              2.9993323    
   1000000   4500           100            100            0.025568819    1.7530242e-37  0              0.076706457    0.1671154      0              16138.809     -5.9828895e-14  0              2.9993102    
   1100000   4500           100            100            0.025735861   -5.6096775e-37  0              0.077207584    0.011756161    0              1135.3259     -5.9828895e-14  0              2.9993071    
   1200000   4500           100            100            0.02566016    -7.0120969e-38  0              0.076980479    7.294265e-06   0              0.7044279     -5.9828895e-14  0              2.9993084    
   1300000   4500           100            100            0.025598464    7.0120969e-38  0              0.076795391    0.00016698198  0              16.125925     -5.9828895e-14  0              2.9993096    
   1400000   4500           100            100            0.02557617     1.3292543e-49  0              0.076728509    5.0794536e-05  0              4.9053727     -5.9828895e-14  0              2.99931      
   1500000   4500           100            100            0.025572647    2.1036291e-37  0              0.076717942    4.0999472e-06  0              0.39594355    -5.9828895e-14  0              2.99931      
   1600000   4500           100            100            0.025573751    7.0120969e-38  0              0.076721253    1.3946462e-08  0              0.0013468495  -5.9828895e-14  0              2.99931      
   1700000   4500           100            100            0.025574795   -7.0120969e-38  0              0.076724385    4.2429085e-08  0              0.0040974973  -5.9828895e-14  0              2.99931      
   1800000   4500           100            100            0.025575196    6.3108872e-37  0              0.076725588    1.526349e-08   0              0.0014740386  -5.9828895e-14  0              2.99931      
   1900000   4500           100            100            0.025575268   -7.0120969e-38  0              0.076725804    1.4048465e-09  0              0.00013567002 -5.9828895e-14  0              2.99931      
   2000000   4500           100            100            0.025575253   -7.0120969e-38  0              0.076725758    1.0849356e-11  0              1.0477531e-06 -5.9828895e-14  0              2.99931      
   2100000   4500           100            100            0.025575235    1.5976944e-54  0              0.076725706    1.0444392e-11  0              1.0086446e-06 -5.9828895e-14  0              2.99931      
   2200000   4500           100            100            0.025575228    1.4024194e-37  0              0.076725684    4.5303274e-12  0              4.3750659e-07 -5.9828895e-14  0              2.99931      
   2300000   4500           100            100            0.025575227   -7.0120969e-38  0              0.07672568     4.7464226e-13  0              4.5837552e-08 -5.9828895e-14  0              2.99931      
   2400000   4500           100            100            0.025575227   -7.0120969e-38  0              0.07672568     6.2426215e-15  0              6.0286771e-10 -5.9828895e-14  0              2.99931      
   2500000   4500           100            100            0.025575227   -7.0120969e-38  0              0.076725681    2.4434251e-15  0              2.3596851e-10 -5.9828895e-14  0              2.99931      
   2600000   4500           100            100            0.025575227    7.0120969e-38  0              0.076725682    1.318816e-15   0              1.2736181e-10 -5.9828895e-14  0              2.99931      
   2700000   4500           100            100            0.025575227    1.4024194e-37  0              0.076725682    8.4879129e-17  0              8.1970188e-12 -5.9828895e-14  0              2.99931      
   2800000   4500           100            100            0.025575227    6.6636042e-56  0              0.076725682    7.5495273e-19  0              7.2907931e-14 -5.9828895e-14  0              2.99931      
   2900000   4500           100            100            0.025575227    7.0120969e-38  0              0.076725682    1.548575e-18   0              1.4955029e-13 -5.9828895e-14  0              2.99931      
   3000000   4500           100            100            0.025575227   -2.1036291e-37  0              0.076725682    1.3479881e-18  0              1.3017904e-13 -5.9828895e-14  0              2.99931      
Loop time of 310.76 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8340852.450 ns/day, 0.000 hours/ns, 9653.764 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.412     | 92.24      | 123.19     | 320.6 | 29.68
Neigh   | 0.77854    | 0.79078    | 0.80269    |   1.0 |  0.25
Comm    | 23.922     | 54.51      | 85.604     | 411.8 | 17.54
Output  | 0.19098    | 0.19116    | 0.19134    |   0.0 |  0.06
Modify  | 110.13     | 127.24     | 144.2      | 147.8 | 40.95
Other   |            | 35.79      |            |       | 11.52

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 186
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1200 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.00050081667  2.2438714e-36  0              0.00150245     701071.96      0              6.7704512e+10 -5.9828895e-14  0              3.1934828    
    200000   4500           100            100           -0.00058136682 -3.5901906e-35  0             -0.0017441005   2747.4173      0              2.653259e+08  -5.9828895e-14  0              3.2073664    
    300000   4500           100            100            0.0030219367   2.115449e-42   0              0.00906581     44745.623      0              4.321212e+09  -5.9828895e-14  0              3.0173654    
    400000   4500           100            100           -0.0010367262  -8.9754819e-36  0             -0.0031101787   11947.511      0              1.1538051e+09 -5.9828895e-14  0              3.0023547    
    500000   4500           100            100           -0.00018388019 -5.6096771e-37  0             -0.00055164056  285.67305      0              27588258      -5.9828895e-14  0              3.0020519    
    600000   4500           100            100            0.036241227    1.0372647e-43  0              0.10872368     513.06226      0              49547881      -5.9828895e-14  0              2.9991336    
    700000   4500           100            100            0.015320372    1.1219357e-36  0              0.045961117    16.073268      0              1552241.2     -5.9828895e-14  0              2.9995087    
    800000   4500           100            100            0.027089368    7.012097e-38   0              0.081268103    9.7103746      0              937758.47     -5.9828895e-14  0              2.9992836    
    900000   4500           100            100            0.027264741   -1.4024194e-37  0              0.081794223    1.1568231      0              111717.69     -5.9828895e-14  0              2.9992797    
   1000000   4500           100            100            0.026265143    2.1036291e-37  0              0.07879543     0.098989679    0              9559.7146     -5.9828895e-14  0              2.9992977    
   1100000   4500           100            100            0.026894508    3.5060485e-38  0              0.080683525    0.0053735435   0              518.93837     -5.9828895e-14  0              2.9992864    
   1200000   4500           100            100            0.026601567   -1.7530242e-37  0              0.079804702    6.8397612e-05  0              6.6053518     -5.9828895e-14  0              2.9992916    
   1300000   4500           100            100            0.026717849   -7.0120969e-38  0              0.080153548    1.636638e-05   0              1.5805479     -5.9828895e-14  0              2.9992896    
   1400000   4500           100            100            0.026677312    5.5586032e-48  0              0.080031935    1.4825607e-05  0              1.431751      -5.9828895e-14  0              2.9992903    
   1500000   4500           100            100            0.026689554    7.0306802e-49  0              0.080068663    4.3649612e-06  0              0.42153671    -5.9828895e-14  0              2.9992901    
   1600000   4500           100            100            0.026686571   -3.5060485e-38  0              0.080059713    8.3648846e-07  0              0.080782068   -5.9828895e-14  0              2.9992901    
   1700000   4500           100            100            0.026686985    3.5060485e-38  0              0.080060956    1.2041839e-07  0              0.011629146   -5.9828895e-14  0              2.9992901    
   1800000   4500           100            100            0.026687098   -3.5060485e-38  0              0.080061293    1.3349349e-08  0              0.0012891846  -5.9828895e-14  0              2.9992901    
   1900000   4500           100            100            0.026686966    3.5060485e-38  0              0.080060899    1.0792543e-09  0              0.00010422665 -5.9828895e-14  0              2.9992901    
   2000000   4500           100            100            0.026687041    5.2260316e-53  0              0.080061123    5.0530132e-11  0              4.8798384e-06 -5.9828895e-14  0              2.9992901    
   2100000   4500           100            100            0.026687007    3.8009178e-55  0              0.080061022    2.500119e-13   0              2.4144359e-08 -5.9828895e-14  0              2.9992901    
   2200000   4500           100            100            0.02668702     7.0120969e-38  0              0.080061061    3.5887171e-13  0              3.4657261e-08 -5.9828895e-14  0              2.9992901    
   2300000   4500           100            100            0.026687016    2.2107768e-56  0              0.080061048    2.2476075e-13  0              2.1705785e-08 -5.9828895e-14  0              2.9992901    
   2400000   4500           100            100            0.026687017    8.7586886e-57  0              0.080061052    5.9881497e-14  0              5.7829263e-09 -5.9828895e-14  0              2.9992901    
   2500000   4500           100            100            0.026687017   -7.0120969e-38  0              0.080061051    1.076809e-14   0              1.0399051e-09 -5.9828895e-14  0              2.9992901    
   2600000   4500           100            100            0.026687017    3.6131489e-56  0              0.080061051    1.4601868e-15  0              1.4101439e-10 -5.9828895e-14  0              2.9992901    
   2700000   4500           100            100            0.026687017    4.8935407e-56  0              0.080061051    1.9640944e-16  0              1.8967818e-11 -5.9828895e-14  0              2.9992901    
   2800000   4500           100            100            0.026687017    5.1986761e-56  0              0.080061051    2.1189896e-17  0              2.0463685e-12 -5.9828895e-14  0              2.9992901    
   2900000   4500           100            100            0.026687017    5.2182219e-56  0              0.080061051    2.2338852e-18  0              2.1573265e-13 -5.9828895e-14  0              2.9992901    
   3000000   4500           100            100            0.026687017    5.1848227e-56  0              0.080061051    5.3006279e-18  0              5.118967e-13  -5.9828895e-14  0              2.9992901    
Loop time of 311.956 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8308872.281 ns/day, 0.000 hours/ns, 9616.750 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.671     | 92.925     | 123.94     | 320.7 | 29.79
Neigh   | 0.79073    | 0.80173    | 0.81252    |   0.9 |  0.26
Comm    | 24.025     | 54.558     | 85.651     | 413.4 | 17.49
Output  | 0.19664    | 0.19679    | 0.19695    |   0.0 |  0.06
Modify  | 109.79     | 127.42     | 144.39     | 150.2 | 40.85
Other   |            | 36.05      |            |       | 11.56

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 190
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1250 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.00084637503  1.7950974e-35  0             -0.0025391251   561800.44      0              5.4254665e+10 -5.9828895e-14  0              3.3089687    
    200000   4500           100            100            0.00088477492  6.813882e-43   0              0.0026543247   4715.84        0              4.5542207e+08 -5.9828895e-14  0              3.2123128    
    300000   4500           100            100           -0.0016463375  -2.692645e-35   0             -0.0049390125   40441.238      0              3.9055253e+09 -5.9828895e-14  0              3.0196586    
    400000   4500           100            100            0.00049377706  8.0779362e-35  0              0.0014813312   1768.6314      0              1.7080176e+08 -5.9828895e-14  0              3.011072     
    500000   4500           100            100           -0.00029033254  6.9436815e-44  0             -0.00087099763  734.08227      0              70892411      -5.9828895e-14  0              3.0016603    
    600000   4500           100            100            0.0075135269  -4.4877414e-36  0              0.022540581    354.44576      0              34229835      -5.9828895e-14  0              2.9996895    
    700000   4500           100            100            0.024740338   -3.3658065e-36  0              0.074221015    71.709393      0              6925179.9     -5.9828895e-14  0              2.9993234    
    800000   4500           100            100            0.03253362     1.6829033e-36  0              0.09760086     1.4895372      0              143848.84     -5.9828895e-14  0              2.9991901    
    900000   4500           100            100            0.02701268     2.115285e-44   0              0.08103804     1.0720285      0              103528.84     -5.9828895e-14  0              2.9992846    
   1000000   4500           100            100            0.027193878    1.1780726e-45  0              0.081581633    0.030243207    0              2920.6725     -5.9828895e-14  0              2.9992811    
   1100000   4500           100            100            0.027894355    2.8048388e-37  0              0.083683064    0.019428528    0              1876.2681     -5.9828895e-14  0              2.9992688    
   1200000   4500           100            100            0.027880397    3.0677924e-38  0              0.08364119     0.00043809531  0              42.308109     -5.9828895e-14  0              2.9992691    
   1300000   4500           100            100            0.027787419   -7.0120969e-38  0              0.083362256    0.00035147416  0              33.942858     -5.9828895e-14  0              2.9992707    
   1400000   4500           100            100            0.027787831    2.8125719e-49  0              0.083363492    6.1028187e-06  0              0.58936655    -5.9828895e-14  0              2.9992707    
   1500000   4500           100            100            0.027800125   -3.5060485e-38  0              0.083400375    6.3380817e-06  0              0.61208656    -5.9828895e-14  0              2.9992705    
   1600000   4500           100            100            0.027800265   -3.5060485e-38  0              0.083400795    8.2301291e-08  0              0.0079480696  -5.9828895e-14  0              2.9992705    
   1700000   4500           100            100            0.027798642    7.2934351e-50  0              0.083395925    1.1380221e-07  0              0.010990203   -5.9828895e-14  0              2.9992705    
   1800000   4500           100            100            0.027798598    7.0120969e-38  0              0.083395793    1.0629969e-09  0              0.00010265664 -5.9828895e-14  0              2.9992705    
   1900000   4500           100            100            0.027798812   -4.9084679e-37  0              0.083396435    2.0352393e-09  0              0.00019654884 -5.9828895e-14  0              2.9992705    
   2000000   4500           100            100            0.027798821    4.5879348e-54  0              0.083396462    1.2944371e-11  0              1.2500747e-06 -5.9828895e-14  0              2.9992705    
   2100000   4500           100            100            0.027798793    2.6157655e-54  0              0.083396378    3.6227543e-11  0              3.4985968e-06 -5.9828895e-14  0              2.9992705    
   2200000   4500           100            100            0.027798791    3.3628411e-55  0              0.083396373    1.4511608e-13  0              1.4014272e-08 -5.9828895e-14  0              2.9992705    
   2300000   4500           100            100            0.027798795    6.7086155e-56  0              0.083396384    6.4341917e-13  0              6.2136818e-08 -5.9828895e-14  0              2.9992705    
   2400000   4500           100            100            0.027798795    4.4998901e-57  0              0.083396385    1.4038904e-15  0              1.3557768e-10 -5.9828895e-14  0              2.9992705    
   2500000   4500           100            100            0.027798794    3.5060485e-38  0              0.083396383    1.1424781e-14  0              1.1033235e-09 -5.9828895e-14  0              2.9992705    
   2600000   4500           100            100            0.027798794   -1.0518145e-37  0              0.083396383    1.9719371e-17  0              1.9043557e-12 -5.9828895e-14  0              2.9992705    
   2700000   4500           100            100            0.027798794    3.601758e-56   0              0.083396383    1.7451166e-16  0              1.6853087e-11 -5.9828895e-14  0              2.9992705    
   2800000   4500           100            100            0.027798794    3.4541655e-56  0              0.083396383    8.33253e-18    0              8.0469611e-13 -5.9828895e-14  0              2.9992705    
   2900000   4500           100            100            0.027798794   -3.5060485e-38  0              0.083396383    3.4893597e-18  0              3.3697738e-13 -5.9828895e-14  0              2.9992705    
   3000000   4500           100            100            0.027798794   -7.0120969e-38  0              0.083396383    7.208868e-18   0              6.9618087e-13 -5.9828895e-14  0              2.9992705    
Loop time of 310.813 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8339413.654 ns/day, 0.000 hours/ns, 9652.099 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.281     | 92.542     | 123.69     | 321.9 | 29.77
Neigh   | 0.80845    | 0.81972    | 0.83184    |   0.9 |  0.26
Comm    | 23.742     | 54.541     | 86.56      | 414.6 | 17.55
Output  | 0.19443    | 0.19459    | 0.19477    |   0.0 |  0.06
Modify  | 109.19     | 126.86     | 143.91     | 149.1 | 40.82
Other   |            | 35.85      |            |       | 11.54

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 190
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1300 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0018456231   3.5902017e-35  0             -0.0055368693   439630.02      0              4.245632e+10  -5.9828895e-14  0              3.4098302    
    200000   4500           100            100            0.002738346    8.9754885e-36  0              0.0082150381   35244.886      0              3.4036988e+09 -5.9828895e-14  0              3.194118     
    300000   4500           100            100           -0.00061525126  2.1133485e-42  0             -0.0018457538   3494.6611      0              3.3748935e+08 -5.9828895e-14  0              3.0494874    
    400000   4500           100            100           -0.0010583156  -1.7950946e-35  0             -0.0031749468   12555.798      0              1.2125491e+09 -5.9828895e-14  0              3.0024902    
    500000   4500           100            100           -0.00043743756 -4.4877394e-36  0             -0.0013123127   1738.9962      0              1.6793981e+08 -5.9828895e-14  0              3.0008733    
    600000   4500           100            100            0.031539636   -1.1219354e-36  0              0.094618907    570.14943      0              55060951      -5.9828895e-14  0              2.9992111    
    700000   4500           100            100            0.04173352     7.1666014e-44  0              0.12520056     18.110383      0              1748971.1     -5.9828895e-14  0              2.9990428    
    800000   4500           100            100            0.033936623    7.8535486e-36  0              0.10180987     0.71409494     0              68962.178     -5.9828895e-14  0              2.9991666    
    900000   4500           100            100            0.030523888    2.8048388e-37  0              0.091571664    0.34500646     0              33318.254     -5.9828895e-14  0              2.9992235    
   1000000   4500           100            100            0.029353671   -1.0518145e-37  0              0.088061014    0.10156077     0              9808.0119     -5.9828895e-14  0              2.9992435    
   1100000   4500           100            100            0.029001433   -1.4024194e-37  0              0.087004298    0.020292035    0              1959.6595     -5.9828895e-14  0              2.9992496    
   1200000   4500           100            100            0.028914352    2.1855869e-47  0              0.086743056    0.0031066761   0              300.02054     -5.9828895e-14  0              2.9992511    
   1300000   4500           100            100            0.028901144   -3.5060485e-38  0              0.086703432    0.00037777063  0              36.482383     -5.9828895e-14  0              2.9992514    
   1400000   4500           100            100            0.028903594    4.6554867e-50  0              0.086710782    3.5693751e-05  0              3.447047      -5.9828895e-14  0              2.9992513    
   1500000   4500           100            100            0.028907023   -5.2590727e-38  0              0.086721069    2.3466468e-06  0              0.22662235    -5.9828895e-14  0              2.9992513    
   1600000   4500           100            100            0.028909053    7.0120969e-38  0              0.086727159    6.8552773e-08  0              0.0066203361  -5.9828895e-14  0              2.9992512    
   1700000   4500           100            100            0.028909993   -1.7530242e-38  0              0.086729979    5.1750267e-10  0              4.9976704e-05 -5.9828895e-14  0              2.9992512    
   1800000   4500           100            100            0.02891037    -1.7530242e-38  0              0.08673111     2.5217119e-09  0              0.00024352889 -5.9828895e-14  0              2.9992512    
   1900000   4500           100            100            0.028910504   -1.7530242e-38  0              0.086731513    9.8979759e-10  0              9.5587566e-05 -5.9828895e-14  0              2.9992512    
   2000000   4500           100            100            0.028910547   -1.7530242e-38  0              0.086731641    2.2369172e-10  0              2.1602545e-05 -5.9828895e-14  0              2.9992512    
   2100000   4500           100            100            0.028910558   -1.7530242e-38  0              0.086731675    3.7307602e-11  0              3.6029012e-06 -5.9828895e-14  0              2.9992512    
   2200000   4500           100            100            0.028910561   -1.7530242e-38  0              0.086731682    4.9089662e-12  0              4.7407282e-07 -5.9828895e-14  0              2.9992512    
   2300000   4500           100            100            0.028910561    2.4542339e-37  0              0.086731682    5.094249e-13   0              4.9196611e-08 -5.9828895e-14  0              2.9992512    
   2400000   4500           100            100            0.02891056     1.0617724e-57  0              0.086731681    3.9095766e-14  0              3.7755892e-09 -5.9828895e-14  0              2.9992512    
   2500000   4500           100            100            0.02891056     5.8422834e-60  0              0.08673168     1.650264e-15   0              1.5937068e-10 -5.9828895e-14  0              2.9992512    
   2600000   4500           100            100            0.02891056    -5.2590727e-38  0              0.08673168     1.0132686e-17  0              9.7854228e-13 -5.9828895e-14  0              2.9992512    
   2700000   4500           100            100            0.02891056     3.0775943e-56  0              0.08673168     9.5239435e-17  0              9.197543e-12  -5.9828895e-14  0              2.9992512    
   2800000   4500           100            100            0.02891056     2.3949292e-56  0              0.08673168     4.5992978e-18  0              4.4416726e-13 -5.9828895e-14  0              2.9992512    
   2900000   4500           100            100            0.02891056     2.3178046e-56  0              0.08673168     8.1200822e-18  0              7.8417942e-13 -5.9828895e-14  0              2.9992512    
   3000000   4500           100            100            0.02891056    -1.227117e-37   0              0.08673168     3.6212372e-19  0              3.4971317e-14 -5.9828895e-14  0              2.9992512    
Loop time of 313.747 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8261444.837 ns/day, 0.000 hours/ns, 9561.857 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.344     | 92.7       | 124.56     | 323.8 | 29.55
Neigh   | 0.82553    | 0.83826    | 0.85117    |   1.0 |  0.27
Comm    | 23.708     | 54.878     | 86.061     | 414.4 | 17.49
Output  | 0.19622    | 0.19638    | 0.19657    |   0.0 |  0.06
Modify  | 112.27     | 129.14     | 146.5      | 148.2 | 41.16
Other   |            | 35.99      |            |       | 11.47

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 196
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1350 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0025254195   7.1803888e-35  0             -0.0075762584   333701.56      0              3.2226508e+10 -5.9828895e-14  0              3.4972327    
    200000   4500           100            100            0.0049344203   8.975494e-36   0              0.014803261    93030.621      0              8.9842315e+09 -5.9828895e-14  0              3.1544075    
    300000   4500           100            100            0.00099502054  8.9743299e-42  0              0.0029850616   6388.9844      0              6.1700238e+08 -5.9828895e-14  0              3.0490812    
    400000   4500           100            100            0.00045051179  1.206664e-41   0              0.0013515354   1485.8643      0              1.4349414e+08 -5.9828895e-14  0              3.0112104    
    500000   4500           100            100            0.017166293   -1.7950964e-35  0              0.051498878    3514.1562      0              3.3937205e+08 -5.9828895e-14  0              2.9994585    
    600000   4500           100            100            0.033039592    8.9754844e-36  0              0.099118775    581.12815      0              56121197      -5.9828895e-14  0              2.9991772    
    700000   4500           100            100            0.035861665    1.8801573e-43  0              0.10758499     66.30147       0              6402921.4     -5.9828895e-14  0              2.999137     
    800000   4500           100            100            0.034602746    7.5993838e-44  0              0.10380824     2.584673       0              249609.22     -5.9828895e-14  0              2.9991556    
    900000   4500           100            100            0.028398375   -5.6096771e-37  0              0.085195124    0.35574178     0              34354.995     -5.9828895e-14  0              2.99926      
   1000000   4500           100            100            0.03005402    -2.8048388e-37  0              0.090162059    0.18151707     0              17529.62      -5.9828895e-14  0              2.9992317    
   1100000   4500           100            100            0.030223237   -3.5060485e-38  0              0.09066971     0.00847203     0              818.16801     -5.9828895e-14  0              2.9992287    
   1200000   4500           100            100            0.029936635    3.5060485e-38  0              0.089809904    0.00036154929  0              34.915842     -5.9828895e-14  0              2.9992336    
   1300000   4500           100            100            0.030030501   -3.5060485e-38  0              0.090091503    0.00039435051  0              38.08355      -5.9828895e-14  0              2.999232     
   1400000   4500           100            100            0.030030317   -7.0120969e-38  0              0.090090951    3.0630742e-05  0              2.9580978     -5.9828895e-14  0              2.999232     
   1500000   4500           100            100            0.030017988    7.0120969e-38  0              0.090053964    1.4497013e-07  0              0.014000178   -5.9828895e-14  0              2.9992322    
   1600000   4500           100            100            0.030023009    3.97426e-49    0              0.090069027    7.8412103e-07  0              0.075724797   -5.9828895e-14  0              2.9992321    
   1700000   4500           100            100            0.030022603    3.5060485e-38  0              0.09006781     9.5205193e-08  0              0.0091942361  -5.9828895e-14  0              2.9992321    
   1800000   4500           100            100            0.030022104    1.2433234e-50  0              0.090066313    6.4795931e-11  0              6.2575273e-06 -5.9828895e-14  0              2.9992321    
   1900000   4500           100            100            0.03002236    -3.5060485e-38  0              0.09006708     1.4063828e-09  0              0.00013581839 -5.9828895e-14  0              2.9992321    
   2000000   4500           100            100            0.030022322   -7.0120969e-38  0              0.090066967    2.6442045e-10  0              2.5535834e-05 -5.9828895e-14  0              2.9992321    
   2100000   4500           100            100            0.030022304   -7.0120969e-38  0              0.090066912    2.6753176e-12  0              2.5836302e-07 -5.9828895e-14  0              2.9992321    
   2200000   4500           100            100            0.030022316   -7.0120969e-38  0              0.090066949    2.2074686e-12  0              2.1318152e-07 -5.9828895e-14  0              2.9992321    
   2300000   4500           100            100            0.030022314    5.5250385e-55  0              0.090066941    6.6937008e-13  0              6.4642971e-08 -5.9828895e-14  0              2.9992321    
   2400000   4500           100            100            0.030022313    8.5765742e-56  0              0.090066939    1.8147751e-14  0              1.7525799e-09 -5.9828895e-14  0              2.9992321    
   2500000   4500           100            100            0.030022314    3.4603245e-57  0              0.090066941    2.7793218e-15  0              2.68407e-10   -5.9828895e-14  0              2.9992321    
   2600000   4500           100            100            0.030022314    1.4374228e-56  0              0.090066941    1.5561059e-15  0              1.5027757e-10 -5.9828895e-14  0              2.9992321    
   2700000   4500           100            100            0.030022314   -6.3108872e-37  0              0.090066941    1.6197926e-16  0              1.5642797e-11 -5.9828895e-14  0              2.9992321    
   2800000   4500           100            100            0.030022314   -7.0120969e-38  0              0.090066941    6.2835656e-18  0              6.0682179e-13 -5.9828895e-14  0              2.9992321    
   2900000   4500           100            100            0.030022314    2.6957869e-56  0              0.090066941    7.9756453e-18  0              7.7023074e-13 -5.9828895e-14  0              2.9992321    
   3000000   4500           100            100            0.030022314    2.68109e-56    0              0.090066941    2.2488261e-18  0              2.1717553e-13 -5.9828895e-14  0              2.9992321    
Loop time of 311.863 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8311347.254 ns/day, 0.000 hours/ns, 9619.615 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.47      | 92.785     | 124.69     | 323.6 | 29.75
Neigh   | 0.83443    | 0.84735    | 0.86052    |   1.0 |  0.27
Comm    | 23.549     | 54.806     | 85.531     | 413.5 | 17.57
Output  | 0.19453    | 0.19469    | 0.19487    |   0.0 |  0.06
Modify  | 110.82     | 127.44     | 144.36     | 147.2 | 40.87
Other   |            | 35.78      |            |       | 11.47

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 198
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1400 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0029100772   2.4904475e-41  0             -0.0087302316   243302.07      0              2.3496372e+10 -5.9828895e-14  0              3.5721949    
    200000   4500           100            100            0.0074341891   1.1749272e-41  0              0.022302567    176982.9       0              1.7091742e+10 -5.9828895e-14  0              3.0946103    
    300000   4500           100            100            0.0031087478  -1.7950954e-35  0              0.0093262435   46811.069      0              4.5206779e+09 -5.9828895e-14  0              3.020438     
    400000   4500           100            100           -0.0011820627  -1.7950952e-35  0             -0.0035461881   16541.322      0              1.5974425e+09 -5.9828895e-14  0              3.0002458    
    500000   4500           100            100            0.14016179    -1.7950961e-35  0              0.42048538     612.54274      0              59154994      -5.9828895e-14  0              2.9978517    
    600000   4500           100            100            0.002532926    4.4877425e-36  0              0.0075987779   132.12291      0              12759485      -5.9828895e-14  0              2.9998574    
    700000   4500           100            100            0.017511995    3.3658068e-36  0              0.052535986    0.92122785     0              88965.592     -5.9828895e-14  0              2.9994642    
    800000   4500           100            100            0.036096822   -2.8048387e-37  0              0.10829046     1.5657338      0              151207.36     -5.9828895e-14  0              2.9991315    
    900000   4500           100            100            0.030277687    5.8559288e-45  0              0.090833062    1.1198992      0              108151.85     -5.9828895e-14  0              2.999228     
   1000000   4500           100            100            0.030909245    1.7503071e-45  0              0.092727735    0.16659462     0              16088.516     -5.9828895e-14  0              2.999217     
   1100000   4500           100            100            0.031362355   -1.4024194e-37  0              0.094087066    0.0048207678   0              465.55525     -5.9828895e-14  0              2.9992095    
   1200000   4500           100            100            0.031046859   -8.7651211e-39  0              0.093140578    0.00034228432  0              33.05537      -5.9828895e-14  0              2.9992148    
   1300000   4500           100            100            0.031148501    1.9842182e-48  0              0.093445504    0.0003469315   0              33.504161     -5.9828895e-14  0              2.999213     
   1400000   4500           100            100            0.03113819     1.2887269e-48  0              0.093414571    5.0068093e-05  0              4.835218      -5.9828895e-14  0              2.9992132    
   1500000   4500           100            100            0.031130034    3.1942388e-49  0              0.093390101    1.3378213e-06  0              0.1291972     -5.9828895e-14  0              2.9992133    
   1600000   4500           100            100            0.031135565    1.1609311e-49  0              0.093406695    1.1790303e-07  0              0.01138623    -5.9828895e-14  0              2.9992133    
   1700000   4500           100            100            0.031133815    1.0298998e-49  0              0.093401445    1.0776901e-07  0              0.010407559   -5.9828895e-14  0              2.9992133    
   1800000   4500           100            100            0.031133979   -1.7530242e-38  0              0.093401937    1.4992535e-08  0              0.0014478717  -5.9828895e-14  0              2.9992133    
   1900000   4500           100            100            0.031134126    1.227117e-37   0              0.093402379    3.696496e-10   0              3.5698113e-05 -5.9828895e-14  0              2.9992133    
   2000000   4500           100            100            0.031134029    8.1068019e-52  0              0.093402088    4.0255896e-11  0              3.8876263e-06 -5.9828895e-14  0              2.9992133    
   2100000   4500           100            100            0.031134059    5.2590727e-38  0              0.093402178    3.3448273e-11  0              3.2301948e-06 -5.9828895e-14  0              2.9992133    
   2200000   4500           100            100            0.031134057   -1.7530242e-38  0              0.093402171    4.4843593e-12  0              4.3306733e-07 -5.9828895e-14  0              2.9992133    
   2300000   4500           100            100            0.031134054    1.7530242e-38  0              0.093402163    1.0103121e-13  0              9.7568713e-09 -5.9828895e-14  0              2.9992133    
   2400000   4500           100            100            0.031134056    3.5060485e-38  0              0.093402168    1.3754492e-14  0              1.3283104e-09 -5.9828895e-14  0              2.9992133    
   2500000   4500           100            100            0.031134055   -1.7530242e-38  0              0.093402166    1.0449968e-14  0              1.0091832e-09 -5.9828895e-14  0              2.9992133    
   2600000   4500           100            100            0.031134055    3.7576999e-58  0              0.093402166    1.361985e-15   0              1.3153077e-10 -5.9828895e-14  0              2.9992133    
   2700000   4500           100            100            0.031134056   -5.2590727e-38  0              0.093402167    4.7629694e-19  0              4.5997349e-14 -5.9828895e-14  0              2.9992133    
   2800000   4500           100            100            0.031134055    1.7530242e-38  0              0.093402166    3.1964052e-18  0              3.0868593e-13 -5.9828895e-14  0              2.9992133    
   2900000   4500           100            100            0.031134055   -1.7530242e-38  0              0.093402166    3.1647363e-18  0              3.0562758e-13 -5.9828895e-14  0              2.9992133    
   3000000   4500           100            100            0.031134055   -1.7530242e-38  0              0.093402166    4.083001e-19   0              3.9430701e-14 -5.9828895e-14  0              2.9992133    
Loop time of 312.872 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8284551.236 ns/day, 0.000 hours/ns, 9588.601 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.161     | 92.512     | 124.54     | 324.3 | 29.57
Neigh   | 0.84693    | 0.85944    | 0.87261    |   1.0 |  0.27
Comm    | 23.651     | 54.916     | 85.922     | 413.9 | 17.55
Output  | 0.19316    | 0.19333    | 0.19353    |   0.0 |  0.06
Modify  | 111.38     | 128.32     | 145.76     | 148.4 | 41.01
Other   |            | 36.07      |            |       | 11.53

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 202
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1450 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0030204786  -3.5901889e-35  0             -0.0090614357   167843.88      0              1.6209161e+10 -5.9828895e-14  0              3.6356113    
    200000   4500           100            100            0.01020367    -3.5901879e-35  0              0.03061101     286179.79      0              2.7637196e+10 -5.9828895e-14  0              3.0159946    
    300000   4500           100            100           -0.0018288952   4.4066866e-42  0             -0.0054866855   58810.763      0              5.6795225e+09 -5.9828895e-14  0              3.0111319    
    400000   4500           100            100            0.0002468271   1.328688e-41   0              0.00074048129  466.8046       0              45080647      -5.9828895e-14  0              3.0117896    
    500000   4500           100            100            0.078833451   -2.5243549e-36  0              0.23650035     3151.4597      0              3.0434542e+08 -5.9828895e-14  0              2.9985467    
    600000   4500           100            100            0.072891234    4.4877422e-36  0              0.2186737      102.91695      0              9938982.3     -5.9828895e-14  0              2.9986142    
    700000   4500           100            100            0.039229407    5.1637942e-44  0              0.11768822     64.183828      0              6198414.7     -5.9828895e-14  0              2.9990808    
    800000   4500           100            100            0.037696299   -5.6096775e-36  0              0.1130889      0.088479654    0              8544.7317     -5.9828895e-14  0              2.9991063    
    900000   4500           100            100            0.033630718    6.7581035e-48  0              0.10089215     0.72329768     0              69850.912     -5.9828895e-14  0              2.9991719    
   1000000   4500           100            100            0.032348253   -4.3825605e-38  0              0.097044759    0.18517119     0              17882.508     -5.9828895e-14  0              2.999193     
   1100000   4500           100            100            0.032125119    5.6096776e-37  0              0.096375356    0.0194121      0              1874.6817     -5.9828895e-14  0              2.9991967    
   1200000   4500           100            100            0.032161485   -7.0120969e-38  0              0.096484455    0.0006196032   0              59.836842     -5.9828895e-14  0              2.9991961    
   1300000   4500           100            100            0.032212277    2.8446774e-48  0              0.096636831    1.4486207e-05  0              1.3989742     -5.9828895e-14  0              2.9991952    
   1400000   4500           100            100            0.032237273   -1.4024194e-37  0              0.096711818    3.0460481e-05  0              2.9416552     -5.9828895e-14  0              2.9991948    
   1500000   4500           100            100            0.03224522     2.8048388e-37  0              0.09673566     7.4698753e-06  0              0.72138709    -5.9828895e-14  0              2.9991947    
   1600000   4500           100            100            0.032246578    6.8220817e-50  0              0.096739735    7.6307928e-07  0              0.073692735   -5.9828895e-14  0              2.9991946    
   1700000   4500           100            100            0.032246325    1.5629767e-50  0              0.096738975    2.2872148e-08  0              0.0022088283  -5.9828895e-14  0              2.9991946    
   1800000   4500           100            100            0.032245997    1.2510945e-50  0              0.096737992    7.1193586e-10  0              6.875367e-05  -5.9828895e-14  0              2.9991947    
   1900000   4500           100            100            0.032245839    1.4024194e-37  0              0.096737516    1.268201e-09   0              0.00012247377 -5.9828895e-14  0              2.9991947    
   2000000   4500           100            100            0.032245789    3.4536458e-52  0              0.096737367    3.0124902e-10  0              2.9092475e-05 -5.9828895e-14  0              2.9991947    
   2100000   4500           100            100            0.032245781   -2.8048388e-37  0              0.096737342    2.9963775e-11  0              2.8936869e-06 -5.9828895e-14  0              2.9991947    
   2200000   4500           100            100            0.032245782    2.8048388e-37  0              0.096737347    8.3994337e-13  0              8.1115719e-08 -5.9828895e-14  0              2.9991947    
   2300000   4500           100            100            0.032245784    1.3558894e-55  0              0.096737353    3.4189544e-14  0              3.3017814e-09 -5.9828895e-14  0              2.9991947    
   2400000   4500           100            100            0.032245786   -1.4024194e-37  0              0.096737357    5.2665969e-14  0              5.0861023e-09 -5.9828895e-14  0              2.9991947    
   2500000   4500           100            100            0.032245786   -1.4024194e-37  0              0.096737357    1.2142159e-14  0              1.1726028e-09 -5.9828895e-14  0              2.9991947    
   2600000   4500           100            100            0.032245786    4.2072582e-37  0              0.096737358    1.1402216e-15  0              1.1011444e-10 -5.9828895e-14  0              2.9991947    
   2700000   4500           100            100            0.032245786   -5.6096775e-37  0              0.096737358    1.0553882e-16  0              1.0192184e-11 -5.9828895e-14  0              2.9991947    
   2800000   4500           100            100            0.032245786    1.4024194e-37  0              0.096737358    2.1199398e-17  0              2.0472861e-12 -5.9828895e-14  0              2.9991947    
   2900000   4500           100            100            0.032245786    1.4024194e-37  0              0.096737357    1.0258273e-18  0              9.9067058e-14 -5.9828895e-14  0              2.9991947    
   3000000   4500           100            100            0.032245786   -1.4024194e-37  0              0.096737357    1.8015134e-18  0              1.7397727e-13 -5.9828895e-14  0              2.9991947    
Loop time of 312.328 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8298966.016 ns/day, 0.000 hours/ns, 9605.285 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.45      | 92.573     | 124.25     | 323.1 | 29.64
Neigh   | 0.84919    | 0.85527    | 0.86172    |   0.6 |  0.27
Comm    | 23.879     | 54.908     | 85.905     | 413.4 | 17.58
Output  | 0.19012    | 0.19029    | 0.19047    |   0.0 |  0.06
Modify  | 110.73     | 127.6      | 145.21     | 148.9 | 40.86
Other   |            | 36.2       |            |       | 11.59

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 202
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1500 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0028747328  -8.9754766e-36  0             -0.0086241983   106836.91      0              1.0317544e+10 -5.9828895e-14  0              3.6882723    
    200000   4500           100            100           -0.0019205036   1.5595441e-42  0             -0.0057615109   248509.62      0              2.3999281e+10 -5.9828895e-14  0              3.0395014    
    300000   4500           100            100           -0.00099196187  2.6926465e-35  0             -0.0029758856   10341.729      0              9.9873014e+08 -5.9828895e-14  0              3.0443081    
    400000   4500           100            100            0.31496206     2.4294465e-42  0              0.94488618     2583.2309      0              2.4946995e+08 -5.9828895e-14  0              2.9963136    
    500000   4500           100            100            0.00053410255 -1.1219354e-36  0              0.0016023077   2065.5523      0              1.9947626e+08 -5.9828895e-14  0              3.0007412    
    600000   4500           100            100            0.02557284     4.8289908e-44  0              0.076718519    599.55623      0              57900849      -5.9828895e-14  0              2.9993052    
    700000   4500           100            100            0.034518703   -2.8048386e-37  0              0.10355611     83.029776      0              8018421.5     -5.9828895e-14  0              2.9991589    
    800000   4500           100            100            0.036770387    5.6096776e-37  0              0.11031116     6.8500093      0              661524.87     -5.9828895e-14  0              2.9991214    
    900000   4500           100            100            0.035346071   -5.6096771e-37  0              0.10603821     0.0097491467   0              941.50281     -5.9828895e-14  0              2.9991438    
   1000000   4500           100            100            0.033674264   -4.2072581e-37  0              0.10102279     0.15476254     0              14945.859     -5.9828895e-14  0              2.999171     
   1100000   4500           100            100            0.033214058    2.5805175e-46  0              0.099642175    0.017842793    0              1723.1292     -5.9828895e-14  0              2.9991786    
   1200000   4500           100            100            0.033262528    2.1912803e-39  0              0.099787585    6.089298e-06   0              0.58806081    -5.9828895e-14  0              2.9991778    
   1300000   4500           100            100            0.033341323   -4.3825606e-39  0              0.10002397     0.00034424604  0              33.244818     -5.9828895e-14  0              2.9991765    
   1400000   4500           100            100            0.033364069   -8.7651212e-38  0              0.10009221     4.2631816e-05  0              4.1170757     -5.9828895e-14  0              2.9991761    
   1500000   4500           100            100            0.033362066    3.5060485e-38  0              0.1000862      1.3882865e-09  0              0.00013407077 -5.9828895e-14  0              2.9991762    
   1600000   4500           100            100            0.033358323   -8.7651212e-39  0              0.10007497     7.6678452e-07  0              0.074050561   -5.9828895e-14  0              2.9991762    
   1700000   4500           100            100            0.033357205    1.7530242e-38  0              0.10007162     1.0149442e-07  0              0.0098016045  -5.9828895e-14  0              2.9991763    
   1800000   4500           100            100            0.033357286    2.2497593e-55  0              0.10007186     4.4169386e-12  0              4.2655632e-07 -5.9828895e-14  0              2.9991763    
   1900000   4500           100            100            0.033357463    6.6334265e-53  0              0.10007239     1.70394e-09    0              0.00016455433 -5.9828895e-14  0              2.9991763    
   2000000   4500           100            100            0.033357518    5.7413825e-54  0              0.10007256     2.4112741e-10  0              2.3286359e-05 -5.9828895e-14  0              2.9991762    
   2100000   4500           100            100            0.033357515    2.1265737e-55  0              0.10007255     8.3455503e-14  0              8.0595351e-09 -5.9828895e-14  0              2.9991762    
   2200000   4500           100            100            0.033357507    8.7651212e-39  0              0.10007252     3.7758974e-12  0              3.6464915e-07 -5.9828895e-14  0              2.9991762    
   2300000   4500           100            100            0.033357504   -1.7530242e-38  0              0.10007251     5.723632e-13   0              5.5274741e-08 -5.9828895e-14  0              2.9991762    
   2400000   4500           100            100            0.033357504    3.0848291e-57  0              0.10007251     5.5342136e-16  0              5.3445474e-11 -5.9828895e-14  0              2.9991762    
   2500000   4500           100            100            0.033357505    1.7530242e-38  0              0.10007251     8.3418489e-15  0              8.0559606e-10 -5.9828895e-14  0              2.9991762    
   2600000   4500           100            100            0.033357505   -2.6295364e-38  0              0.10007251     1.395591e-15   0              1.3477619e-10 -5.9828895e-14  0              2.9991762    
   2700000   4500           100            100            0.033357505    7.0222007e-57  0              0.10007251     1.7680813e-17  0              1.7074864e-12 -5.9828895e-14  0              2.9991762    
   2800000   4500           100            100            0.033357505    8.5479067e-57  0              0.10007251     4.6040659e-19  0              4.4462773e-14 -5.9828895e-14  0              2.9991762    
   2900000   4500           100            100            0.033357505    8.8109436e-57  0              0.10007251     2.8317852e-21  0              2.7347355e-16 -5.9828895e-14  0              2.9991762    
   3000000   4500           100            100            0.033357505    8.9858632e-57  0              0.10007251     1.6648382e-18  0              1.6077815e-13 -5.9828895e-14  0              2.9991762    
Loop time of 313.645 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8264112.362 ns/day, 0.000 hours/ns, 9564.945 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.404     | 92.701     | 124.6      | 323.9 | 29.56
Neigh   | 0.88096    | 0.89422    | 0.90737    |   1.0 |  0.29
Comm    | 24.08      | 55.226     | 86.164     | 412.6 | 17.61
Output  | 0.19344    | 0.19361    | 0.19379    |   0.0 |  0.06
Modify  | 111.25     | 128.28     | 146.09     | 147.1 | 40.90
Other   |            | 36.35      |            |       | 11.59

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 210
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1550 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0024886526  -7.1803799e-35  0             -0.0074659578   59868.969      0              5.7817165e+09 -5.9828895e-14  0              3.7308813    
    200000   4500           100            100           -0.0022281498  -3.5901899e-35  0             -0.0066844494   140688.67      0              1.3586705e+10 -5.9828895e-14  0              3.1095157    
    300000   4500           100            100            0.00043311637  3.5901959e-35  0              0.0012993491   1345.8923      0              1.2997665e+08 -5.9828895e-14  0              3.0516746    
    400000   4500           100            100           -9.7588343e-05  1.6829033e-36  0             -0.00029276503  77.540294      0              7488286.6     -5.9828895e-14  0              3.0118359    
    500000   4500           100            100            0.00014752408  2.2438718e-36  0              0.00044257224  172.27477      0              16637064      -5.9828895e-14  0              3.0019647    
    600000   4500           100            100            0.0017104539   2.2438714e-36  0              0.0051313617   21.679466      0              2093647.7     -5.9828895e-14  0              2.9998886    
    700000   4500           100            100            0.026580783    1.0193408e-43  0              0.079742348    61.179938      0              5908320.5     -5.9828895e-14  0              2.9992905    
    800000   4500           100            100            0.032090207    1.4736137e-43  0              0.09627062     9.1026183      0              879065.72     -5.9828895e-14  0              2.9991978    
    900000   4500           100            100            0.03613695     2.1796281e-46  0              0.10841085     0.47016887     0              45405.544     -5.9828895e-14  0              2.999131     
   1000000   4500           100            100            0.033744439   -1.1219355e-36  0              0.10123332     0.0021876073   0              211.26345     -5.9828895e-14  0              2.9991699    
   1100000   4500           100            100            0.034716747    1.4114873e-46  0              0.10415024     0.003474256    0              335.51878     -5.9828895e-14  0              2.999154     
   1200000   4500           100            100            0.034405696    2.8048388e-37  0              0.10321709     0.0019423677   0              187.57997     -5.9828895e-14  0              2.9991591    
   1300000   4500           100            100            0.034477492   -1.4024194e-37  0              0.10343247     0.00042566235  0              41.107423     -5.9828895e-14  0              2.9991579    
   1400000   4500           100            100            0.034472256    2.9450807e-36  0              0.10341677     5.5908512e-05  0              5.3992439     -5.9828895e-14  0              2.999158     
   1500000   4500           100            100            0.034466158    6.267221e-50   0              0.10339847     4.3913573e-06  0              0.42408585    -5.9828895e-14  0              2.9991581    
   1600000   4500           100            100            0.034470779    1.105163e-50   0              0.10341234     1.3222947e-07  0              0.012769776   -5.9828895e-14  0              2.999158     
   1700000   4500           100            100            0.034468606    5.6096775e-37  0              0.10340582     1.783436e-09   0              0.00017223148 -5.9828895e-14  0              2.9991581    
   1800000   4500           100            100            0.034469396   -1.4024194e-37  0              0.10340819     5.6555529e-09  0              0.00054617282 -5.9828895e-14  0              2.999158     
   1900000   4500           100            100            0.034469174    1.4024194e-37  0              0.10340752     1.8392916e-09  0              0.00017762562 -5.9828895e-14  0              2.999158     
   2000000   4500           100            100            0.034469213    9.4241572e-53  0              0.10340764     3.1373308e-10  0              3.0298095e-05 -5.9828895e-14  0              2.999158     
   2100000   4500           100            100            0.034469217   -2.8048388e-37  0              0.10340765     3.3111462e-11  0              3.197668e-06  -5.9828895e-14  0              2.999158     
   2200000   4500           100            100            0.034469209   -1.4024194e-37  0              0.10340763     1.8782858e-12  0              1.813914e-07  -5.9828895e-14  0              2.999158     
   2300000   4500           100            100            0.034469214    1.2461951e-55  0              0.10340764     1.5440158e-14  0              1.4911e-09    -5.9828895e-14  0              2.999158     
   2400000   4500           100            100            0.034469212   -1.4024194e-37  0              0.10340764     1.0312528e-14  0              9.9591011e-10 -5.9828895e-14  0              2.999158     
   2500000   4500           100            100            0.034469212    2.8048388e-37  0              0.10340764     6.6501812e-15  0              6.422269e-10  -5.9828895e-14  0              2.999158     
   2600000   4500           100            100            0.034469212   -8.4145163e-37  0              0.10340764     1.5460844e-15  0              1.4930977e-10 -5.9828895e-14  0              2.999158     
   2700000   4500           100            100            0.034469212   -5.6096775e-37  0              0.10340764     2.1220908e-16  0              2.0493634e-11 -5.9828895e-14  0              2.999158     
   2800000   4500           100            100            0.034469212    3.0476645e-55  0              0.10340764     5.6580481e-19  0              5.4641378e-14 -5.9828895e-14  0              2.999158     
   2900000   4500           100            100            0.034469212    3.1403146e-55  0              0.10340764     3.3212184e-18  0              3.207395e-13  -5.9828895e-14  0              2.999158     
   3000000   4500           100            100            0.034469212    3.0207802e-55  0              0.10340764     4.866261e-18   0              4.6994866e-13 -5.9828895e-14  0              2.999158     
Loop time of 312.461 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8295442.537 ns/day, 0.000 hours/ns, 9601.207 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.563     | 92.715     | 124.16     | 322.9 | 29.67
Neigh   | 0.89819    | 0.91132    | 0.92483    |   1.0 |  0.29
Comm    | 23.901     | 54.948     | 85.913     | 413.6 | 17.59
Output  | 0.19457    | 0.19472    | 0.19492    |   0.0 |  0.06
Modify  | 111.07     | 127.86     | 144.82     | 148.4 | 40.92
Other   |            | 35.84      |            |       | 11.47

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 212
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1600 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0018761348  -1.4360735e-34  0             -0.0056284043   26594.012      0              2.5682593e+09 -5.9828895e-14  0              3.7640665    
    200000   4500           100            100           -0.0020097571  -3.5901815e-35  0             -0.0060292713   64209.3        0              6.2008746e+09 -5.9828895e-14  0              3.1601103    
    300000   4500           100            100            0.0023812146   3.5901949e-35  0              0.0071436439   29880.266      0              2.8856222e+09 -5.9828895e-14  0              3.0346894    
    400000   4500           100            100            0.002829482    1.5921089e-42  0              0.008488446    19197.429      0              1.8539503e+09 -5.9828895e-14  0              2.9999203    
    500000   4500           100            100           -0.00025666153  1.7950971e-35  0             -0.0007699846   567.54278      0              54809220      -5.9828895e-14  0              3.0016685    
    600000   4500           100            100            0.038886369   -8.9754831e-36  0              0.11665911     643.87663      0              62180996      -5.9828895e-14  0              2.9990922    
    700000   4500           100            100            0.044817624    2.0061487e-43  0              0.13445287     57.486144      0              5551600.3     -5.9828895e-14  0              2.9989983    
    800000   4500           100            100            0.030248071    1.4953047e-43  0              0.090744214    0.77381787     0              74729.791     -5.9828895e-14  0              2.9992281    
    900000   4500           100            100            0.037036051    7.0120969e-38  0              0.11110815     0.74356707     0              71808.386     -5.9828895e-14  0              2.9991166    
   1000000   4500           100            100            0.035797748    3.5332962e-46  0              0.10739324     0.18255836     0              17630.18      -5.9828895e-14  0              2.9991366    
   1100000   4500           100            100            0.035315926    1.4024194e-37  0              0.10594778     0.00079976933  0              77.235997     -5.9828895e-14  0              2.9991443    
   1200000   4500           100            100            0.035639468    1.4024194e-37  0              0.1069184      0.0022129586   0              213.7117      -5.9828895e-14  0              2.9991391    
   1300000   4500           100            100            0.035596623    7.0120969e-38  0              0.10678987     0.00036917668  0              35.652442     -5.9828895e-14  0              2.9991398    
   1400000   4500           100            100            0.035568011   -1.4024194e-37  0              0.10670403     1.3554299e-08  0              0.0013089772  -5.9828895e-14  0              2.9991402    
   1500000   4500           100            100            0.035583079    1.933699e-49   0              0.10674924     6.2329648e-06  0              0.60193513    -5.9828895e-14  0              2.99914      
   1600000   4500           100            100            0.035581896    7.0120969e-38  0              0.10674569     7.0026515e-07  0              0.067626596   -5.9828895e-14  0              2.99914      
   1700000   4500           100            100            0.035580297   -4.2072582e-37  0              0.10674089     2.9210271e-09  0              0.00028209189 -5.9828895e-14  0              2.99914      
   1800000   4500           100            100            0.03558098     1.4024194e-37  0              0.10674294     1.643264e-08   0              0.0015869468  -5.9828895e-14  0              2.99914      
   1900000   4500           100            100            0.035580966    2.0633983e-52  0              0.1067429      1.2284298e-09  0              0.00011863296 -5.9828895e-14  0              2.99914      
   2000000   4500           100            100            0.035580881    2.633819e-53   0              0.10674264     2.8942561e-11  0              2.7950654e-06 -5.9828895e-14  0              2.99914      
   2100000   4500           100            100            0.03558091    -1.4024194e-37  0              0.10674273     4.0894501e-11  0              3.9492982e-06 -5.9828895e-14  0              2.99914      
   2200000   4500           100            100            0.035580912   -2.1036291e-37  0              0.10674274     1.9455794e-12  0              1.8789013e-07 -5.9828895e-14  0              2.99914      
   2300000   4500           100            100            0.035580907   -2.1036291e-37  0              0.10674272     1.4747484e-13  0              1.4242064e-08 -5.9828895e-14  0              2.99914      
   2400000   4500           100            100            0.035580909    1.4024194e-37  0              0.10674273     9.6633603e-14  0              9.3321817e-09 -5.9828895e-14  0              2.99914      
   2500000   4500           100            100            0.035580909    1.8708727e-55  0              0.10674273     2.7460127e-15  0              2.6519025e-10 -5.9828895e-14  0              2.99914      
   2600000   4500           100            100            0.035580909   -2.1036291e-37  0              0.10674273     5.7309229e-16  0              5.5345151e-11 -5.9828895e-14  0              2.99914      
   2700000   4500           100            100            0.035580909   -1.0518145e-36  0              0.10674273     1.6897196e-16  0              1.6318102e-11 -5.9828895e-14  0              2.99914      
   2800000   4500           100            100            0.035580909    2.278428e-55   0              0.10674273     2.269097e-17   0              2.1913315e-12 -5.9828895e-14  0              2.99914      
   2900000   4500           100            100            0.035580909    2.3159222e-55  0              0.10674273     1.7679194e-20  0              1.70733e-15   -5.9828895e-14  0              2.99914      
   3000000   4500           100            100            0.035580909    1.4024194e-37  0              0.10674273     3.173877e-18   0              3.0651033e-13 -5.9828895e-14  0              2.99914      
Loop time of 315.062 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8226959.553 ns/day, 0.000 hours/ns, 9521.944 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.485     | 93.112     | 126.08     | 327.3 | 29.55
Neigh   | 0.91099    | 0.92369    | 0.93641    |   0.9 |  0.29
Comm    | 23.917     | 55.875     | 87.363     | 411.4 | 17.73
Output  | 0.19543    | 0.19558    | 0.19576    |   0.0 |  0.06
Modify  | 111        | 128.56     | 145.66     | 149.1 | 40.80
Other   |            | 36.4       |            |       | 11.55

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 218
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1650 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -0.0010495044   1.8310733e-40  0             -0.0031485131   6720.8798      0              6.4905446e+08 -5.9828895e-14  0              3.7883922    
    200000   4500           100            100           -0.0013105875   2.2438718e-36  0             -0.0039317626   17765.006      0              1.7156172e+09 -5.9828895e-14  0              3.1923829    
    300000   4500           100            100            0.48794412     1.2398354e-41  0              1.4638324      50769.979      0              4.9030011e+09 -5.9828895e-14  0              2.995091     
    400000   4500           100            100           -0.0005468537   1.1511504e-41  0             -0.0016405611   2786.6689      0              2.6911654e+08 -5.9828895e-14  0              3.0099753    
    500000   4500           100            100            0.019637988   -4.4877392e-36  0              0.058913964    4063.8078      0              3.9245347e+08 -5.9828895e-14  0              2.9994086    
    600000   4500           100            100            0.08398627    -5.6096767e-37  0              0.25195881     1.2644189      0              122108.53     -5.9828895e-14  0              2.9984751    
    700000   4500           100            100            0.027947314    2.2438718e-36  0              0.083841942    59.291447      0              5725943.5     -5.9828895e-14  0              2.9992664    
    800000   4500           100            100            0.038687564   -5.6096772e-37  0              0.11606269     10.203069      0              985339.34     -5.9828895e-14  0              2.9990901    
    900000   4500           100            100            0.03835399     5.6973291e-38  0              0.11506197     0.54946129     0              53063.039     -5.9828895e-14  0              2.9990958    
   1000000   4500           100            100            0.037438731    1.4024194e-37  0              0.11231619     0.0033836116   0              326.76499     -5.9828895e-14  0              2.9991103    
   1100000   4500           100            100            0.036947192    1.2859187e-48  0              0.11084158     0.0035404131   0              341.90776     -5.9828895e-14  0              2.9991182    
   1200000   4500           100            100            0.036756501    2.8048388e-37  0              0.1102695      0.0020700741   0              199.91294     -5.9828895e-14  0              2.9991212    
   1300000   4500           100            100            0.036699759    4.5709574e-51  0              0.11009928     0.00044703476  0              43.171417     -5.9828895e-14  0              2.9991221    
   1400000   4500           100            100            0.036688732   -1.4024194e-37  0              0.11006619     5.5841169e-05  0              5.3927404     -5.9828895e-14  0              2.9991223    
   1500000   4500           100            100            0.036689188    1.4024194e-37  0              0.11006756     3.893399e-06   0              0.37599661    -5.9828895e-14  0              2.9991223    
   1600000   4500           100            100            0.036690933    4.2072582e-37  0              0.1100728      7.3832499e-08  0              0.0071302143  -5.9828895e-14  0              2.9991222    
   1700000   4500           100            100            0.036691985    1.4024194e-37  0              0.11007595     7.5886819e-09  0              0.00073286058 -5.9828895e-14  0              2.9991222    
   1800000   4500           100            100            0.036692425    5.2833013e-51  0              0.11007727     8.3452508e-09  0              0.00080592459 -5.9828895e-14  0              2.9991222    
   1900000   4500           100            100            0.036692567   -1.4024194e-37  0              0.1100777      2.1830309e-09  0              0.0002108215  -5.9828895e-14  0              2.9991222    
   2000000   4500           100            100            0.036692599   -1.8231452e-36  0              0.1100778      3.1412966e-10  0              3.0336394e-05 -5.9828895e-14  0              2.9991222    
   2100000   4500           100            100            0.036692601   -1.4024194e-37  0              0.1100778      2.6331132e-11  0              2.5428723e-06 -5.9828895e-14  0              2.9991222    
   2200000   4500           100            100            0.036692598    3.3268024e-54  0              0.11007779     8.6762591e-13  0              8.37891e-08   -5.9828895e-14  0              2.9991222    
   2300000   4500           100            100            0.036692595   -2.8048388e-37  0              0.11007779     6.8049187e-15  0              6.5717034e-10 -5.9828895e-14  0              2.9991222    
   2400000   4500           100            100            0.036692594   -1.4024194e-37  0              0.11007778     3.0654318e-14  0              2.9603747e-09 -5.9828895e-14  0              2.9991222    
   2500000   4500           100            100            0.036692594    1.4024194e-37  0              0.11007778     1.0176304e-14  0              9.8275464e-10 -5.9828895e-14  0              2.9991222    
   2600000   4500           100            100            0.036692594   -2.8048388e-37  0              0.11007778     1.710439e-15   0              1.6518195e-10 -5.9828895e-14  0              2.9991222    
   2700000   4500           100            100            0.036692594    2.8048388e-37  0              0.11007778     2.1457863e-16  0              2.0722468e-11 -5.9828895e-14  0              2.9991222    
   2800000   4500           100            100            0.036692594    4.8727154e-55  0              0.11007778     1.5832216e-17  0              1.5289621e-12 -5.9828895e-14  0              2.9991222    
   2900000   4500           100            100            0.036692594    1.6829033e-36  0              0.11007778     3.3626137e-18  0              3.2473716e-13 -5.9828895e-14  0              2.9991222    
   3000000   4500           100            100            0.036692594   -1.4024194e-37  0              0.11007778     5.629097e-18   0              5.436179e-13  -5.9828895e-14  0              2.9991222    
Loop time of 311.383 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8324158.273 ns/day, 0.000 hours/ns, 9634.442 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.246     | 92.555     | 123.73     | 323.5 | 29.72
Neigh   | 0.94083    | 0.95377    | 0.96676    |   0.9 |  0.31
Comm    | 24.153     | 54.973     | 86.65      | 414.8 | 17.65
Output  | 0.19361    | 0.19376    | 0.19394    |   0.0 |  0.06
Modify  | 109.46     | 126.76     | 143.87     | 149.8 | 40.71
Other   |            | 35.95      |            |       | 11.55

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 220
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1700 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100           -1.9703918e-05  3.5526289e-40  0             -5.9111754e-05  1.7813945      0              172034.33     -5.9828895e-14  0              3.8043668    
    200000   4500           100            100           -0.00017084581  4.6297723e-41  0             -0.00051253743  213.37413      0              20606147      -5.9828895e-14  0              3.2073279    
    300000   4500           100            100           -0.0016168283   3.777834e-41   0             -0.004850485    37763.661      0              3.6469441e+09 -5.9828895e-14  0              3.0283005    
    400000   4500           100            100            0.001187445   -6.7316121e-36  0              0.0035623349   9005.6794      0              8.6970406e+08 -5.9828895e-14  0              3.0066015    
    500000   4500           100            100            0.15059668     5.8483746e-44  0              0.45179004     1104.5648      0              1.0667096e+08 -5.9828895e-14  0              2.9977531    
    600000   4500           100            100            0.045590426    1.1095683e-43  0              0.13677128     649.42064      0              62716397      -5.9828895e-14  0              2.9989814    
    700000   4500           100            100            0.041235396   -5.6096775e-37  0              0.12370619     85.662834      0              8272703.3     -5.9828895e-14  0              2.9990528    
    800000   4500           100            100            0.042080172    1.009742e-35   0              0.12624052     5.530428       0              534089.15     -5.9828895e-14  0              2.9990386    
    900000   4500           100            100            0.039866602    5.2889451e-45  0              0.11959981     0.064904479    0              6268.01       -5.9828895e-14  0              2.9990722    
   1000000   4500           100            100            0.038077817    2.8048388e-37  0              0.11423345     0.17886252     0              17273.262     -5.9828895e-14  0              2.9991002    
   1100000   4500           100            100            0.03764121     2.3744623e-46  0              0.11292363     0.01777458     0              1716.5417     -5.9828895e-14  0              2.9991071    
   1200000   4500           100            100            0.037704136    3.5060485e-38  0              0.11311241     1.1935721e-05  0              1.1526665     -5.9828895e-14  0              2.9991061    
   1300000   4500           100            100            0.037786527    6.9686874e-49  0              0.11335958     0.00035883832  0              34.654036     -5.9828895e-14  0              2.9991048    
   1400000   4500           100            100            0.037810529    7.0120969e-38  0              0.11343159     4.8496367e-05  0              4.683432      -5.9828895e-14  0              2.9991045    
   1500000   4500           100            100            0.03780906     9.3253875e-50  0              0.11342718     5.2562114e-08  0              0.0050760728  -5.9828895e-14  0              2.9991045    
   1600000   4500           100            100            0.037805319    3.5060485e-38  0              0.11341596     6.8642752e-07  0              0.066290257   -5.9828895e-14  0              2.9991045    
   1700000   4500           100            100            0.037804048   -3.5060485e-38  0              0.11341214     1.2582099e-07  0              0.012150891   -5.9828895e-14  0              2.9991046    
   1800000   4500           100            100            0.037804044   -7.0120969e-38  0              0.11341213     8.8024882e-10  0              8.5008131e-05 -5.9828895e-14  0              2.9991046    
   1900000   4500           100            100            0.037804209    2.9579277e-51  0              0.11341263     1.2357732e-09  0              0.00011934213 -5.9828895e-14  0              2.9991046    
   2000000   4500           100            100            0.037804275    7.0120969e-38  0              0.11341282     3.1258449e-10  0              3.0187172e-05 -5.9828895e-14  0              2.9991046    
   2100000   4500           100            100            0.037804279    7.0120969e-38  0              0.11341284     5.2357843e-12  0              5.0563457e-07 -5.9828895e-14  0              2.9991046    
   2200000   4500           100            100            0.037804272    1.4263909e-53  0              0.11341281     2.0604572e-12  0              1.989842e-07  -5.9828895e-14  0              2.9991046    
   2300000   4500           100            100            0.037804268    3.5060485e-38  0              0.1134128      7.4717391e-13  0              7.2156708e-08 -5.9828895e-14  0              2.9991046    
   2400000   4500           100            100            0.037804268    7.0120969e-38  0              0.1134128      2.2046111e-14  0              2.1290556e-09 -5.9828895e-14  0              2.9991046    
   2500000   4500           100            100            0.037804268   -1.7530242e-37  0              0.1134128      3.2480713e-15  0              3.1367548e-10 -5.9828895e-14  0              2.9991046    
   2600000   4500           100            100            0.037804268    1.1095068e-55  0              0.11341281     1.7104429e-15  0              1.6518234e-10 -5.9828895e-14  0              2.9991046    
   2700000   4500           100            100            0.037804268    1.0518145e-37  0              0.11341281     1.6608343e-17  0              1.6039149e-12 -5.9828895e-14  0              2.9991046    
   2800000   4500           100            100            0.037804268    3.5060485e-38  0              0.11341281     1.3795206e-17  0              1.3322422e-12 -5.9828895e-14  0              2.9991046    
   2900000   4500           100            100            0.037804268    1.4584136e-55  0              0.11341281     1.3272527e-18  0              1.2817657e-13 -5.9828895e-14  0              2.9991046    
   3000000   4500           100            100            0.037804268    3.5060485e-38  0              0.11341281     5.5403113e-18  0              5.3504361e-13 -5.9828895e-14  0              2.9991046    
Loop time of 313.255 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8274405.065 ns/day, 0.000 hours/ns, 9576.858 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.517     | 92.523     | 123.94     | 322.3 | 29.54
Neigh   | 0.95294    | 0.96327    | 0.97465    |   0.8 |  0.31
Comm    | 23.926     | 54.819     | 85.838     | 413.2 | 17.50
Output  | 0.19477    | 0.19492    | 0.19511    |   0.0 |  0.06
Modify  | 111.84     | 128.85     | 145.8      | 148.3 | 41.13
Other   |            | 35.9       |            |       | 11.46

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 222
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1750 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0012034471   1.3128985e-41  0              0.0036103412   6227.081       0              6.0136691e+08 -5.9828895e-14  0              3.8124514    
    200000   4500           100            100            0.0013734358  -1.7950955e-35  0              0.0041203073   10559.215      0              1.0197334e+09 -5.9828895e-14  0              3.2058454    
    300000   4500           100            100           -0.00058396552  1.7713258e-42  0             -0.0017518966   3117.1287      0              3.0102998e+08 -5.9828895e-14  0              3.0492173    
    400000   4500           100            100           -0.0010471646   1.6205815e-43  0             -0.0031414939   12207.825      0              1.1789443e+09 -5.9828895e-14  0              3.0045682    
    500000   4500           100            100            0.00052976452  8.9754907e-36  0              0.0015892936   2034.6903      0              1.9649582e+08 -5.9828895e-14  0              3.0008078    
    600000   4500           100            100            0.0097320245   2.2438718e-36  0              0.029196073    297.90366      0              28769403      -5.9828895e-14  0              2.999633     
    700000   4500           100            100            0.04233342     5.6096777e-37  0              0.12700026     86.971451      0              8399080.2     -5.9828895e-14  0              2.9990328    
    800000   4500           100            100            0.033304915    1.1219356e-36  0              0.099914745    0.54584937     0              52714.225     -5.9828895e-14  0              2.9991773    
    900000   4500           100            100            0.040777115   -1.4024194e-37  0              0.12233135     0.38393816     0              37078         -5.9828895e-14  0              2.9990583    
   1000000   4500           100            100            0.038628269   -1.4024194e-37  0              0.11588481     0.18046297     0              17427.822     -5.9828895e-14  0              2.9990915    
   1100000   4500           100            100            0.038834367   -3.5060484e-38  0              0.1165031      0.025180214    0              2431.7249     -5.9828895e-14  0              2.9990884    
   1200000   4500           100            100            0.038999763   -1.7530242e-38  0              0.11699929     0.0011507143   0              111.12776     -5.9828895e-14  0              2.9990858    
   1300000   4500           100            100            0.038879144    3.3056681e-48  0              0.11663743     2.8737762e-06  0              0.27752873    -5.9828895e-14  0              2.9990877    
   1400000   4500           100            100            0.038925742    3.5060485e-38  0              0.11677723     2.9510611e-05  0              2.8499235     -5.9828895e-14  0              2.9990869    
   1500000   4500           100            100            0.03891522    -8.7651212e-39  0              0.11674566     8.1593202e-06  0              0.78796874    -5.9828895e-14  0              2.9990871    
   1600000   4500           100            100            0.038915042    6.7566138e-49  0              0.11674513     8.1615599e-07  0              0.078818503   -5.9828895e-14  0              2.9990871    
   1700000   4500           100            100            0.03891653     1.8437287e-49  0              0.11674959     1.8399613e-08  0              0.0017769029  -5.9828895e-14  0              2.9990871    
   1800000   4500           100            100            0.03891571    -4.3825606e-39  0              0.11674713     1.780217e-09   0              0.00017192061 -5.9828895e-14  0              2.9990871    
   1900000   4500           100            100            0.038915979    1.2379217e-54  0              0.11674794     1.7476593e-09  0              0.00016877643 -5.9828895e-14  0              2.9990871    
   2000000   4500           100            100            0.038915935   -4.3825606e-39  0              0.1167478      3.2906038e-10  0              3.1778296e-05 -5.9828895e-14  0              2.9990871    
   2100000   4500           100            100            0.038915924   -1.7530242e-38  0              0.11674777     2.2784888e-11  0              2.2004014e-06 -5.9828895e-14  0              2.9990871    
   2200000   4500           100            100            0.038915936    4.3825606e-39  0              0.11674781     9.9464605e-14  0              9.6055796e-09 -5.9828895e-14  0              2.9990871    
   2300000   4500           100            100            0.038915931    8.7651212e-39  0              0.11674779     2.0157075e-13  0              1.946626e-08  -5.9828895e-14  0              2.9990871    
   2400000   4500           100            100            0.038915932   -8.7651212e-39  0              0.1167478      8.7969761e-14  0              8.4954899e-09 -5.9828895e-14  0              2.9990871    
   2500000   4500           100            100            0.038915932    8.7651212e-39  0              0.1167478      1.1982295e-14  0              1.1571643e-09 -5.9828895e-14  0              2.9990871    
   2600000   4500           100            100            0.038915932   -2.6295364e-38  0              0.1167478      5.9456008e-16  0              5.7418357e-11 -5.9828895e-14  0              2.9990871    
   2700000   4500           100            100            0.038915932    2.2217597e-56  0              0.1167478      6.7719185e-18  0              6.5398341e-13 -5.9828895e-14  0              2.9990871    
   2800000   4500           100            100            0.038915932   -8.7651212e-39  0              0.1167478      1.9446685e-17  0              1.8780217e-12 -5.9828895e-14  0              2.9990871    
   2900000   4500           100            100            0.038915932   -8.7651212e-39  0              0.1167478      4.5030345e-19  0              4.3487084e-14 -5.9828895e-14  0              2.9990871    
   3000000   4500           100            100            0.038915932   -1.3147682e-38  0              0.1167478      1.0086992e-18  0              9.7412947e-14 -5.9828895e-14  0              2.9990871    
Loop time of 313.013 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8280817.812 ns/day, 0.000 hours/ns, 9584.280 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.703     | 92.793     | 124.22     | 322.1 | 29.65
Neigh   | 0.94885    | 0.96128    | 0.97419    |   0.9 |  0.31
Comm    | 23.897     | 54.824     | 85.957     | 413.8 | 17.52
Output  | 0.1947     | 0.19486    | 0.19504    |   0.0 |  0.06
Modify  | 110.52     | 127.91     | 145.52     | 152.2 | 40.86
Other   |            | 36.33      |            |       | 11.61

Nlocal:         625.25 ave         751 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           7 max           4 min
Histogram: 1 0 0 2 0 0 0 0 0 1
Neighs:         875.25 ave        1126 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 224
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1800 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0026111045   1.4360807e-34  0              0.0078333136   25218.149      0              2.4353884e+09 -5.9828895e-14  0              3.8130649    
    200000   4500           100            100            0.0032898863   2.6926468e-35  0              0.0098696589   47926.542      0              4.6284024e+09 -5.9828895e-14  0              3.1887558    
    300000   4500           100            100            0.0010055063  -8.9754796e-36  0              0.0030165189   6516.483       0              6.2931529e+08 -5.9828895e-14  0              3.0485942    
    400000   4500           100            100            0.00043955957 -8.9754775e-36  0              0.0013186787   1419.2776      0              1.3706367e+08 -5.9828895e-14  0              3.0109239    
    500000   4500           100            100           -6.11097e-05    3.3658066e-36  0             -0.0001833291   29.969092      0              2894200.4     -5.9828895e-14  0              3.0019048    
    600000   4500           100            100            0.0034141382   4.5859152e-43  0              0.010242415    1.7828576      0              172175.63     -5.9828895e-14  0              2.9998203    
    700000   4500           100            100            0.026901847    1.2051195e-45  0              0.08070554     26.921441      0              2599880       -5.9828895e-14  0              2.9992873    
    800000   4500           100            100            0.043449997    5.6096777e-37  0              0.13034999     8.1764962      0              789627.48     -5.9828895e-14  0              2.999017     
    900000   4500           100            100            0.040186534    1.0125519e-44  0              0.1205596      1.6035632      0              154860.66     -5.9828895e-14  0              2.9990675    
   1000000   4500           100            100            0.039452395   -8.7651211e-38  0              0.11835718     0.097337791    0              9400.1871     -5.9828895e-14  0              2.9990787    
   1100000   4500           100            100            0.040311079   -1.4024194e-37  0              0.12093324     2.8480369e-06  0              0.27504302    -5.9828895e-14  0              2.9990654    
   1200000   4500           100            100            0.039953704   -2.8048388e-37  0              0.11986111     0.0017728942   0              171.21343     -5.9828895e-14  0              2.9990709    
   1300000   4500           100            100            0.040029274   -1.4024194e-37  0              0.12008782     0.00048519404  0              46.856567     -5.9828895e-14  0              2.9990698    
   1400000   4500           100            100            0.040036428    7.0120969e-38  0              0.12010928     3.7030037e-05  0              3.5760959     -5.9828895e-14  0              2.9990696    
   1500000   4500           100            100            0.04002269    -2.1036291e-37  0              0.12006807     9.6865686e-08  0              0.0093545947  -5.9828895e-14  0              2.9990699    
   1600000   4500           100            100            0.040029005    7.0120969e-38  0              0.12008701     4.0655216e-07  0              0.039261898   -5.9828895e-14  0              2.9990698    
   1700000   4500           100            100            0.04002748     4.6890483e-50  0              0.12008244     1.4276139e-07  0              0.013786873   -5.9828895e-14  0              2.9990698    
   1800000   4500           100            100            0.040027453   -2.8048388e-37  0              0.12008236     1.3352411e-08  0              0.0012894803  -5.9828895e-14  0              2.9990698    
   1900000   4500           100            100            0.040027668    1.4024194e-37  0              0.120083       1.2636492e-10  0              1.220342e-05  -5.9828895e-14  0              2.9990698    
   2000000   4500           100            100            0.040027558    3.3557386e-52  0              0.12008267     8.6338775e-11  0              8.3379809e-06 -5.9828895e-14  0              2.9990698    
   2100000   4500           100            100            0.040027588    7.7172497e-53  0              0.12008276     4.0853934e-11  0              3.9453805e-06 -5.9828895e-14  0              2.9990698    
   2200000   4500           100            100            0.040027587    4.9887916e-54  0              0.12008276     4.6212713e-12  0              4.4628931e-07 -5.9828895e-14  0              2.9990698    
   2300000   4500           100            100            0.040027583    2.8048388e-37  0              0.12008275     8.5269601e-14  0              8.2347277e-09 -5.9828895e-14  0              2.9990698    
   2400000   4500           100            100            0.040027585    7.0120969e-38  0              0.12008276     1.6546378e-14  0              1.5979307e-09 -5.9828895e-14  0              2.9990698    
   2500000   4500           100            100            0.040027585   -7.0120969e-38  0              0.12008275     1.1392027e-14  0              1.1001605e-09 -5.9828895e-14  0              2.9990698    
   2600000   4500           100            100            0.040027585   -7.0120969e-38  0              0.12008275     1.4969678e-15  0              1.4456644e-10 -5.9828895e-14  0              2.9990698    
   2700000   4500           100            100            0.040027585    7.6185859e-56  0              0.12008275     1.4307173e-17  0              1.3816844e-12 -5.9828895e-14  0              2.9990698    
   2800000   4500           100            100            0.040027585    6.6452269e-56  0              0.12008275     2.8258487e-17  0              2.7290024e-12 -5.9828895e-14  0              2.9990698    
   2900000   4500           100            100            0.040027585    7.0120969e-38  0              0.12008275     1.2182669e-18  0              1.1765149e-13 -5.9828895e-14  0              2.9990698    
   3000000   4500           100            100            0.040027585    2.1036291e-37  0              0.12008275     2.122946e-20   0              2.0501893e-15 -5.9828895e-14  0              2.9990698    
Loop time of 311.223 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8328438.065 ns/day, 0.000 hours/ns, 9639.396 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.532     | 92.682     | 123.75     | 321.3 | 29.78
Neigh   | 0.94416    | 0.95704    | 0.96976    |   0.9 |  0.31
Comm    | 23.979     | 54.731     | 86.165     | 413.0 | 17.59
Output  | 0.19515    | 0.19531    | 0.19548    |   0.0 |  0.06
Modify  | 109.48     | 126.73     | 143.76     | 149.4 | 40.72
Other   |            | 35.93      |            |       | 11.54

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 224
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1850 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0041952829   7.1804211e-35  0              0.012585849    56822.965      0              5.4875552e+09 -5.9828895e-14  0              3.8065891    
    200000   4500           100            100            0.0055492604   6.2828392e-35  0              0.016647781    111543.21      0              1.0772044e+10 -5.9828895e-14  0              3.1568084    
    300000   4500           100            100            0.0030988958  -3.5901871e-35  0              0.0092966875   46436.385      0              4.4844937e+09 -5.9828895e-14  0              3.0274555    
    400000   4500           100            100            0.38354003     3.3658065e-36  0              1.1506201      160.5096       0              15500869      -5.9828895e-14  0              2.9957995    
    500000   4500           100            100            0.0012742766   2.2222837e-43  0              0.0038228298   3713.8546      0              3.5865749e+08 -5.9828895e-14  0              2.9998781    
    600000   4500           100            100            0.010772022    3.0310678e-43  0              0.032316065    292.23669      0              28222128      -5.9828895e-14  0              2.999617     
    700000   4500           100            100            0.057418176   -4.4877415e-36  0              0.17225453     9.4230245      0              910008.26     -5.9828895e-14  0              2.9988173    
    800000   4500           100            100            0.040340362    2.8048388e-37  0              0.12102109     12.183727      0              1176617.2     -5.9828895e-14  0              2.9990656    
    900000   4500           100            100            0.039156008    8.7651224e-39  0              0.11746802     0.25785112     0              24901.416     -5.9828895e-14  0              2.9990834    
   1000000   4500           100            100            0.040479365    8.3359485e-47  0              0.12143809     0.065230744    0              6299.5184     -5.9828895e-14  0              2.9990628    
   1100000   4500           100            100            0.041138332    4.7195661e-48  0              0.123415       0.028412635    0              2743.8889     -5.9828895e-14  0              2.9990526    
   1200000   4500           100            100            0.041225962    1.4024194e-37  0              0.12367788     0.001133349    0              109.45073     -5.9828895e-14  0              2.9990513    
   1300000   4500           100            100            0.041174003    9.2261792e-49  0              0.12352201     7.6548544e-05  0              7.3925105     -5.9828895e-14  0              2.9990521    
   1400000   4500           100            100            0.041141708   -5.6096775e-37  0              0.12342512     6.2953669e-05  0              6.0796147     -5.9828895e-14  0              2.9990526    
   1500000   4500           100            100            0.041135638    2.8048388e-37  0              0.12340691     4.0841969e-06  0              0.3944225     -5.9828895e-14  0              2.9990527    
   1600000   4500           100            100            0.041137464    1.0878968e-49  0              0.12341239     5.6218782e-08  0              0.0054292076  -5.9828895e-14  0              2.9990527    
   1700000   4500           100            100            0.041138995    4.1716725e-49  0              0.12341698     1.304246e-07   0              0.012595474   -5.9828895e-14  0              2.9990526    
   1800000   4500           100            100            0.041139366   -1.4024194e-37  0              0.1234181      1.2817793e-08  0              0.0012378507  -5.9828895e-14  0              2.9990526    
   1900000   4500           100            100            0.041139313    2.9432229e-51  0              0.12341794     5.2933425e-12  0              5.1119313e-07 -5.9828895e-14  0              2.9990526    
   2000000   4500           100            100            0.041139243    3.2392401e-52  0              0.12341773     2.5084904e-10  0              2.4225205e-05 -5.9828895e-14  0              2.9990526    
   2100000   4500           100            100            0.041139222   -1.4024194e-37  0              0.12341767     3.6388277e-11  0              3.5141193e-06 -5.9828895e-14  0              2.9990526    
   2200000   4500           100            100            0.041139223    8.7515529e-54  0              0.12341767     1.0653595e-13  0              1.0288479e-08 -5.9828895e-14  0              2.9990526    
   2300000   4500           100            100            0.041139226    5.0865543e-55  0              0.12341768     4.4212327e-13  0              4.2697101e-08 -5.9828895e-14  0              2.9990526    
   2400000   4500           100            100            0.041139227    1.590841e-57   0              0.12341768     9.541463e-14   0              9.214462e-09  -5.9828895e-14  0              2.9990526    
   2500000   4500           100            100            0.041139227    1.7164678e-55  0              0.12341768     1.2564465e-15  0              1.2133861e-10 -5.9828895e-14  0              2.9990526    
   2600000   4500           100            100            0.041139227    1.4024194e-37  0              0.12341768     6.4588445e-16  0              6.2374897e-11 -5.9828895e-14  0              2.9990526    
   2700000   4500           100            100            0.041139227   -1.4024194e-37  0              0.12341768     2.3137285e-16  0              2.2344334e-11 -5.9828895e-14  0              2.9990526    
   2800000   4500           100            100            0.041139227    1.8136438e-55  0              0.12341768     2.6069136e-17  0              2.5175705e-12 -5.9828895e-14  0              2.9990526    
   2900000   4500           100            100            0.041139227   -1.4024194e-37  0              0.12341768     4.2626043e-18  0              4.1165181e-13 -5.9828895e-14  0              2.9990526    
   3000000   4500           100            100            0.041139227   -2.8048388e-37  0              0.12341768     5.7962197e-18  0              5.5975741e-13 -5.9828895e-14  0              2.9990526    
Loop time of 311.447 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8322435.825 ns/day, 0.000 hours/ns, 9632.449 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.405     | 92.595     | 123.76     | 322.6 | 29.73
Neigh   | 0.95822    | 0.97203    | 0.98476    |   1.0 |  0.31
Comm    | 23.962     | 54.918     | 86.301     | 413.8 | 17.63
Output  | 0.19351    | 0.19367    | 0.19385    |   0.0 |  0.06
Modify  | 109.71     | 126.83     | 143.72     | 148.9 | 40.72
Other   |            | 35.94      |            |       | 11.54

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 230
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1900 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0059487163  -7.1802897e-35  0              0.017846149    100911.86      0              9.7453451e+09 -5.9828895e-14  0              3.7933739    
    200000   4500           100            100            0.0081250208   1.7951022e-35  0              0.024375062    200726.17      0              1.9384697e+10 -5.9828895e-14  0              3.1106899    
    300000   4500           100            100            0.77420692     4.1604744e-41  0              2.3226208      16312.182      0              1.5753138e+09 -5.9828895e-14  0              2.9932817    
    400000   4500           100            100           -0.00035533086  1.7950971e-35  0             -0.0010659926   1110.6035      0              1.0725414e+08 -5.9828895e-14  0              3.0108563    
    500000   4500           100            100            0.15471758     4.4877436e-36  0              0.46415275     1546.5366      0              1.4935343e+08 -5.9828895e-14  0              2.9977129    
    600000   4500           100            100            0.029439378    1.0609037e-42  0              0.088318133    655.14917      0              63269617      -5.9828895e-14  0              2.9992472    
    700000   4500           100            100            0.03851216     2.8048389e-37  0              0.11553648     90.796995      0              8768523.9     -5.9828895e-14  0              2.9990918    
    800000   4500           100            100            0.041091723    2.8048388e-37  0              0.12327517     12.156889      0              1174025.3     -5.9828895e-14  0              2.9990528    
    900000   4500           100            100            0.041176145    8.4145164e-37  0              0.12352843     1.267529       0              122408.88     -5.9828895e-14  0              2.9990519    
   1000000   4500           100            100            0.041635447   -7.0120965e-38  0              0.12490634     0.089330539    0              8626.904      -5.9828895e-14  0              2.999045     
   1100000   4500           100            100            0.041975011    6.0790325e-47  0              0.12592503     0.0027724089   0              267.73941     -5.9828895e-14  0              2.9990398    
   1200000   4500           100            100            0.042145849    2.8048388e-37  0              0.12643755     1.5582074e-05  0              1.5048052     -5.9828895e-14  0              2.9990372    
   1300000   4500           100            100            0.042216407   -1.4024194e-37  0              0.12664922     9.225333e-05   0              8.9091663     -5.9828895e-14  0              2.9990362    
   1400000   4500           100            100            0.042241468   -7.0120969e-37  0              0.1267244      3.5471827e-05  0              3.4256151     -5.9828895e-14  0              2.9990358    
   1500000   4500           100            100            0.042249066   -1.4024194e-37  0              0.1267472      7.5623097e-06  0              0.73031374    -5.9828895e-14  0              2.9990357    
   1600000   4500           100            100            0.042250887    7.0120969e-37  0              0.12675266     1.1435345e-06  0              0.11043438    -5.9828895e-14  0              2.9990356    
   1700000   4500           100            100            0.042251114    2.3973245e-50  0              0.12675334     1.2864227e-07  0              0.01242335    -5.9828895e-14  0              2.9990356    
   1800000   4500           100            100            0.042251027   -9.8169357e-37  0              0.12675308     1.0187349e-08  0              0.00098382125 -5.9828895e-14  0              2.9990356    
   1900000   4500           100            100            0.042250938    1.4024194e-37  0              0.12675282     4.3250782e-10  0              4.1768509e-05 -5.9828895e-14  0              2.9990356    
   2000000   4500           100            100            0.04225089     1.4024194e-37  0              0.12675267     5.2283196e-13  0              5.0491368e-08 -5.9828895e-14  0              2.9990356    
   2100000   4500           100            100            0.042250869    1.4024194e-37  0              0.12675261     5.0771845e-12  0              4.9031814e-07 -5.9828895e-14  0              2.9990356    
   2200000   4500           100            100            0.042250862    2.8048388e-37  0              0.12675258     2.6008968e-12  0              2.51176e-07   -5.9828895e-14  0              2.9990356    
   2300000   4500           100            100            0.042250859    4.2506699e-55  0              0.12675258     6.2232362e-13  0              6.0099561e-08 -5.9828895e-14  0              2.9990356    
   2400000   4500           100            100            0.042250859    7.0120969e-37  0              0.12675258     1.0253858e-13  0              9.9024425e-09 -5.9828895e-14  0              2.9990356    
   2500000   4500           100            100            0.042250858    5.4310312e-55  0              0.12675258     1.2452507e-14  0              1.202574e-09  -5.9828895e-14  0              2.9990356    
   2600000   4500           100            100            0.042250858    1.4024194e-37  0              0.12675258     1.0247789e-15  0              9.8965812e-11 -5.9828895e-14  0              2.9990356    
   2700000   4500           100            100            0.042250858    5.6096775e-37  0              0.12675258     1.9449222e-17  0              1.8782667e-12 -5.9828895e-14  0              2.9990356    
   2800000   4500           100            100            0.042250858    7.0120969e-37  0              0.12675258     2.3834546e-17  0              2.3017699e-12 -5.9828895e-14  0              2.9990356    
   2900000   4500           100            100            0.042250858   -2.8048388e-37  0              0.12675258     2.4739743e-18  0              2.3891873e-13 -5.9828895e-14  0              2.9990356    
   3000000   4500           100            100            0.042250858    4.5576479e-55  0              0.12675258     5.5674575e-18  0              5.3766519e-13 -5.9828895e-14  0              2.9990356    
Loop time of 312.561 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8292792.894 ns/day, 0.000 hours/ns, 9598.140 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.4       | 92.531     | 123.81     | 322.8 | 29.60
Neigh   | 0.95904    | 0.97307    | 0.98806    |   1.0 |  0.31
Comm    | 23.939     | 54.895     | 86.231     | 413.6 | 17.56
Output  | 0.19168    | 0.19184    | 0.19202    |   0.0 |  0.06
Modify  | 110.35     | 127.65     | 145.01     | 150.7 | 40.84
Other   |            | 36.32      |            |       | 11.62

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 232
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1950 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0078647877   1.5146073e-40  0              0.023594363    157374.71      0              1.5198123e+10 -5.9828895e-14  0              3.7737394    
    200000   4500           100            100            0.01099299     5.5838597e-42  0              0.032978969    314869.5       0              3.0407843e+10 -5.9828895e-14  0              3.0510311    
    300000   4500           100            100           -0.0016390583   1.7950979e-35  0             -0.0049171748   39295.931      0              3.7949198e+09 -5.9828895e-14  0              3.0298291    
    400000   4500           100            100            0.0014479426   2.243872e-36   0              0.0043438277   12836.486      0              1.239656e+09  -5.9828895e-14  0              3.0050298    
    500000   4500           100            100            0.00040834337  1.7950972e-35  0              0.0012250301   1240.8392      0              1.1983137e+08 -5.9828895e-14  0              3.0012263    
    600000   4500           100            100            0.051938642    5.3852909e-35  0              0.15581593     705.60883      0              68142651      -5.9828895e-14  0              2.9988977    
    700000   4500           100            100            0.029012813   -1.1219355e-36  0              0.087038438    20.54524       0              1984112.2     -5.9828895e-14  0              2.9992503    
    800000   4500           100            100            0.0449248     -1.1219355e-36  0              0.1347744      11.990604      0              1157966.7     -5.9828895e-14  0              2.9989959    
    900000   4500           100            100            0.045449477   -5.6096773e-37  0              0.13634843     0.2174649      0              21001.204     -5.9828895e-14  0              2.9989875    
   1000000   4500           100            100            0.042967897    1.4024194e-37  0              0.12890369     0.16957507     0              16376.347     -5.9828895e-14  0              2.9990247    
   1100000   4500           100            100            0.043129759    2.8048388e-37  0              0.12938928     0.010721668    0              1035.4219     -5.9828895e-14  0              2.9990223    
   1200000   4500           100            100            0.043438898    1.4024194e-37  0              0.13031669     0.0018798881   0              181.54614     -5.9828895e-14  0              2.9990177    
   1300000   4500           100            100            0.043385047   -7.0120969e-38  0              0.13015514     0.00033253777  0              32.114118     -5.9828895e-14  0              2.9990185    
   1400000   4500           100            100            0.043350025    7.0120969e-38  0              0.13005008     1.427457e-05   0              1.3785358     -5.9828895e-14  0              2.999019     
   1500000   4500           100            100            0.043360826    3.782287e-49   0              0.13008248     7.8498479e-06  0              0.75808212    -5.9828895e-14  0              2.9990188    
   1600000   4500           100            100            0.043364295    5.3906575e-49  0              0.13009289     4.0360459e-08  0              0.0038977242  -5.9828895e-14  0              2.9990188    
   1700000   4500           100            100            0.043362505    7.4428395e-50  0              0.13008752     1.5232636e-07  0              0.01471059    -5.9828895e-14  0              2.9990188    
   1800000   4500           100            100            0.043362238   -7.0120969e-38  0              0.13008671     2.2125846e-10  0              2.1367558e-05 -5.9828895e-14  0              2.9990188    
   1900000   4500           100            100            0.043362502    2.0360522e-51  0              0.13008751     2.4829546e-09  0              0.00023978598 -5.9828895e-14  0              2.9990188    
   2000000   4500           100            100            0.043362509   -7.0120969e-38  0              0.13008753     5.2352742e-11  0              5.0558531e-06 -5.9828895e-14  0              2.9990188    
   2100000   4500           100            100            0.043362474    8.845066e-54   0              0.13008742     3.3598384e-11  0              3.2446914e-06 -5.9828895e-14  0              2.9990188    
   2200000   4500           100            100            0.043362476    7.2752783e-54  0              0.13008743     2.456213e-12   0              2.3720348e-07 -5.9828895e-14  0              2.9990188    
   2300000   4500           100            100            0.043362481    7.0120969e-38  0              0.13008744     3.569517e-13   0              3.447184e-08  -5.9828895e-14  0              2.9990188    
   2400000   4500           100            100            0.04336248    -2.1036291e-37  0              0.13008744     7.2841723e-14  0              7.0345322e-09 -5.9828895e-14  0              2.9990188    
   2500000   4500           100            100            0.043362479    1.4024194e-37  0              0.13008744     2.5531645e-15  0              2.4656636e-10 -5.9828895e-14  0              2.9990188    
   2600000   4500           100            100            0.04336248     1.425946e-55   0              0.13008744     1.6765421e-15  0              1.6190844e-10 -5.9828895e-14  0              2.9990188    
   2700000   4500           100            100            0.04336248    -7.0120969e-38  0              0.13008744     4.5387438e-19  0              4.3831939e-14 -5.9828895e-14  0              2.9990188    
   2800000   4500           100            100            0.04336248     7.0120969e-38  0              0.13008744     1.9996751e-18  0              1.9311431e-13 -5.9828895e-14  0              2.9990188    
   2900000   4500           100            100            0.04336248     9.9320794e-56  0              0.13008744     5.8591031e-18  0              5.6583024e-13 -5.9828895e-14  0              2.9990188    
   3000000   4500           100            100            0.04336248    -7.0120969e-38  0              0.13008744     5.2601822e-18  0              5.0799074e-13 -5.9828895e-14  0              2.9990188    
Loop time of 311.633 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8317477.151 ns/day, 0.000 hours/ns, 9626.710 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.257     | 92.532     | 124        | 324.3 | 29.69
Neigh   | 1.0774     | 1.0912     | 1.1049     |   0.9 |  0.35
Comm    | 24.031     | 55.13      | 86.577     | 414.4 | 17.69
Output  | 0.19213    | 0.1923     | 0.19247    |   0.0 |  0.06
Modify  | 109.78     | 126.84     | 143.78     | 148.8 | 40.70
Other   |            | 35.85      |            |       | 11.50

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 240
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3           # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+50)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

#variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -50-(v_ind*50)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -2250 ${n1e1} -50 50 -50 50 units box
region box block -2250 2250 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -2250 2250 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-2250 -50 -50) to (2250 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-2250 -50 -50) to (2250 50 50)
  create_atoms CPU = 0.000 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -2000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 2904 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 26.4 | 26.4 | 26.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   4500           100            100            0              0              0              0              0              0              0             -5.9828895e-14  0              6            
    100000   4500           100            100            0.0099373728  -2.2438704e-36  0              0.029812119    226115.66      0              2.1836632e+10 -5.9828895e-14  0              3.7479832    
    200000   4500           100            100            1.8420813     -3.3658061e-36  0              5.526244       38612.199      0              3.7288898e+09 -5.9828895e-14  0              2.9880175    
    300000   4500           100            100           -0.00063187234  4.4877442e-36  0             -0.001895617    3703.1861      0              3.576272e+08  -5.9828895e-14  0              3.0485945    
    400000   4500           100            100           -0.0011077034  -4.4877405e-36  0             -0.0033231103   14003.065      0              1.3523158e+09 -5.9828895e-14  0              3.0042955    
    500000   4500           100            100           -0.0003152581   9.5500194e-43  0             -0.0009457743   869.91105      0              84009783      -5.9828895e-14  0              3.0013744    
    600000   4500           100            100            0.070053146   -2.2438702e-36  0              0.21015944     543.55139      0              52492303      -5.9828895e-14  0              2.9986524    
    700000   4500           100            100            0.054706437    4.4877442e-36  0              0.16411931     65.085319      0              6285474.2     -5.9828895e-14  0              2.9988556    
    800000   4500           100            100            0.043304037    1.192843e-44   0              0.12991211     12.529197      0              1209980.2     -5.9828895e-14  0              2.9990191    
    900000   4500           100            100            0.044487354    2.8048388e-37  0              0.13346206     1.7091794      0              165060.31     -5.9828895e-14  0              2.9990021    
   1000000   4500           100            100            0.044562234    1.6829033e-36  0              0.1336867      0.22228639     0              21466.828     -5.9828895e-14  0              2.9990007    
   1100000   4500           100            100            0.044407401    8.4145163e-37  0              0.1332222      0.028094479    0              2713.1637     -5.9828895e-14  0              2.9990031    
   1200000   4500           100            100            0.044510107    1.4024194e-37  0              0.13353032     0.0034574252   0              333.89338     -5.9828895e-14  0              2.9990015    
   1300000   4500           100            100            0.044456866   -7.0120969e-38  0              0.1333706      0.00041257664  0              39.843699     -5.9828895e-14  0              2.9990024    
   1400000   4500           100            100            0.044481761   -2.8048388e-37  0              0.13344528     4.7644791e-05  0              4.6011929     -5.9828895e-14  0              2.999002     
   1500000   4500           100            100            0.044470828    3.7710315e-49  0              0.13341248     5.2965398e-06  0              0.5115019     -5.9828895e-14  0              2.9990021    
   1600000   4500           100            100            0.044475432    2.5917414e-50  0              0.1334263      5.6295913e-07  0              0.054366563   -5.9828895e-14  0              2.9990021    
   1700000   4500           100            100            0.044473553    2.1036291e-37  0              0.13342066     5.6583903e-08  0              0.0054644683  -5.9828895e-14  0              2.9990021    
   1800000   4500           100            100            0.044474301   -1.4024194e-37  0              0.1334229      5.2844101e-09  0              0.00051033051 -5.9828895e-14  0              2.9990021    
   1900000   4500           100            100            0.044474009   -7.0120969e-38  0              0.13342203     4.4457356e-10  0              4.2933732e-05 -5.9828895e-14  0              2.9990021    
   2000000   4500           100            100            0.044474121    2.2326042e-52  0              0.13342236     3.1681822e-11  0              3.0596036e-06 -5.9828895e-14  0              2.9990021    
   2100000   4500           100            100            0.044474079   -7.0120969e-38  0              0.13342224     1.6413239e-12  0              1.5850732e-07 -5.9828895e-14  0              2.9990021    
   2200000   4500           100            100            0.044474095   -9.8169357e-37  0              0.13342228     3.3588382e-14  0              3.2437256e-09 -5.9828895e-14  0              2.9990021    
   2300000   4500           100            100            0.044474089   -1.4024194e-37  0              0.13342227     1.1743602e-15  0              1.134113e-10  -5.9828895e-14  0              2.9990021    
   2400000   4500           100            100            0.044474091   -7.0120969e-38  0              0.13342227     2.4669219e-15  0              2.3823766e-10 -5.9828895e-14  0              2.9990021    
   2500000   4500           100            100            0.04447409     2.1632414e-58  0              0.13342227     9.5979131e-16  0              9.2689774e-11 -5.9828895e-14  0              2.9990021    
   2600000   4500           100            100            0.04447409    -1.4024194e-37  0              0.13342227     2.1957498e-16  0              2.120498e-11  -5.9828895e-14  0              2.9990021    
   2700000   4500           100            100            0.04447409     2.8048388e-37  0              0.13342227     2.938649e-17   0              2.8379369e-12 -5.9828895e-14  0              2.9990021    
   2800000   4500           100            100            0.04447409     2.8048388e-37  0              0.13342227     3.480881e-18   0              3.3615857e-13 -5.9828895e-14  0              2.9990021    
   2900000   4500           100            100            0.04447409     6.6746056e-56  0              0.13342227     1.812845e-20   0              1.7507159e-15 -5.9828895e-14  0              2.9990021    
   3000000   4500           100            100            0.04447409     6.8263002e-56  0              0.13342227     8.417447e-19   0              8.1289678e-14 -5.9828895e-14  0              2.9990021    
Loop time of 311 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8334415.898 ns/day, 0.000 hours/ns, 9646.315 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.315     | 92.629     | 123.92     | 323.6 | 29.78
Neigh   | 0.99691    | 1.0085     | 1.0204     |   0.9 |  0.32
Comm    | 23.713     | 54.724     | 86.426     | 415.6 | 17.60
Output  | 0.18625    | 0.1864     | 0.18657    |   0.0 |  0.06
Modify  | 109.07     | 126.51     | 143.48     | 149.4 | 40.68
Other   |            | 35.94      |            |       | 11.56

Nlocal:         625.25 ave         750 max         500 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           5.25 ave           6 max           4 min
Histogram: 1 0 0 0 0 1 0 0 0 2
Neighs:         875.25 ave        1125 max         625 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3501
Ave neighs/atom = 1.3998401
Neighbor list builds = 240
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 10000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 3:31:45

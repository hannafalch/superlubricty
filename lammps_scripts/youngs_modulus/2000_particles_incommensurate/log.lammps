LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018375757    1.2403874e-16  0              0.05512727     1555194.6      0              7.5094782e+13  0              0              3.3499484    
    200000   12000          100            100            0.0051126647   1.2403874e-16  0              0.015337994    257886.62      0              1.2452422e+13  0              0              3.1097441    
    300000   12000          100            100           -0.00157691    -1.2547382e-06  0             -0.0047294751   93120.972      0              4.4964785e+12  0              0              2.9994832    
    400000   12000          100            100            0.035250538   -0.016384829    0              0.12213644     15494.999      0              7.4819804e+11  0              0              2.983431     
    500000   12000          100            100            0.017792784   -0.012476939    0              0.065855292    2583.1018      0              1.2472874e+11  0              0              2.9878719    
    600000   12000          100            100            0.016620656   -0.012475994    0              0.062337961    211.44515      0              1.0209929e+10  0              0              2.9883233    
    700000   12000          100            100            0.020928975   -0.01195439     0              0.074741314    10.938783      0              5.2819469e+08  0              0              2.9871731    
    800000   12000          100            100            0.018904161   -0.011948974    0              0.068661457    0.10491434     0              5065937.9      0              0              2.9877134    
    900000   12000          100            100            0.019724958   -0.011893166    0              0.071068039    0.042189857    0              2037197.2      0              0              2.9874993    
   1000000   12000          100            100            0.019458268   -0.011861119    0              0.070235921    0.032663066    0              1577182.6      0              0              2.9875721    
   1100000   12000          100            100            0.019538889   -0.011863619    0              0.070480286    0.0090680811   0              437865.18      0              0              2.987551     
   1200000   12000          100            100            0.019520488   -0.011862998    0              0.070424462    0.0016461968   0              79488.95       0              0              2.9875557    
   1300000   12000          100            100            0.019522328   -0.011863051    0              0.070430035    0.00022195689  0              10717.504      0              0              2.9875553    
   1400000   12000          100            100            0.019523507   -0.011863097    0              0.070433618    2.2388647e-05  0              1081.0676      0              0              2.9875549    
   1500000   12000          100            100            0.019522468   -0.011863059    0              0.070430462    1.5322626e-06  0              73.987476      0              0              2.9875552    
   1600000   12000          100            100            0.019523015   -0.011863079    0              0.070432124    4.5805181e-08  0              2.2117683      0              0              2.9875551    
   1700000   12000          100            100            0.019522782   -0.01186307     0              0.070431416    3.3344982e-10  0              0.016101098    0              0              2.9875551    
   1800000   12000          100            100            0.019522868   -0.011863073    0              0.070431676    1.6422573e-09  0              0.07929873     0              0              2.9875551    
   1900000   12000          100            100            0.01952284    -0.011863072    0              0.070431593    6.2483782e-10  0              0.030171182    0              0              2.9875551    
   2000000   12000          100            100            0.019522847   -0.011863073    0              0.070431615    1.3376856e-10  0              0.0064592051   0              0              2.9875551    
   2100000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    2.0514075e-11  0              0.00099055125  0              0              2.9875551    
   2200000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    2.3702973e-12  0              0.00011445318  0              0              2.9875551    
   2300000   12000          100            100            0.019522846   -0.011863073    0              0.070431612    1.977077e-13   0              9.5465974e-06  0              0              2.9875551    
   2400000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    9.6529916e-15  0              4.6610842e-07  0              0              2.9875551    
   2500000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    7.1166182e-17  0              3.4363602e-09  0              0              2.9875551    
   2600000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    6.6336422e-17  0              3.2031484e-09  0              0              2.9875551    
   2700000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    9.2210689e-17  0              4.4525242e-09  0              0              2.9875551    
   2800000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    2.4354609e-17  0              1.1759969e-09  0              0              2.9875551    
   2900000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    1.2209661e-18  0              5.8956082e-11  0              0              2.9875551    
   3000000   12000          100            100            0.019522846   -0.011863073    0              0.070431611    9.4956683e-19  0              4.5851184e-11  0              0              2.9875551    
Loop time of 572.921 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4524182.386 ns/day, 0.000 hours/ns, 5236.322 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.997     | 118.04     | 156        | 337.7 | 20.60
Neigh   | 1.8274     | 1.8406     | 1.8532     |   0.9 |  0.32
Comm    | 23.732     | 61.715     | 99.805     | 461.5 | 10.77
Output  | 0.4867     | 0.48712    | 0.48764    |   0.1 |  0.09
Modify  | 271.52     | 312.73     | 354.58     | 230.1 | 54.58
Other   |            | 78.12      |            |       | 13.63

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018523408    1.2403874e-16  0              0.055570223    1573651.9      0              7.5986016e+13  0              0              3.3456743    
    200000   12000          100            100            0.0054244514   1.2403874e-16  0              0.016273354    283350.64      0              1.3681988e+13  0              0              3.1040121    
    300000   12000          100            100           -0.0013206316   1.2403874e-16  0             -0.0039618949   52642.795      0              2.5419322e+12  0              0              3.0158       
    400000   12000          100            100           -0.00015779138  1.2403874e-16  0             -0.00047337415  525.25121      0              2.5362501e+10  0              0              3.0000031    
    500000   12000          100            100            0.012617531   -0.014813006    0              0.052665599    2333.4137      0              1.126722e+11   0              0              2.9906001    
    600000   12000          100            100            0.014125862   -0.013729619    0              0.056107204    24.54544       0              1.1852114e+09  0              0              2.9903958    
    700000   12000          100            100            0.020184684   -0.012668313    0              0.073222366    37.226307      0              1.7975252e+09  0              0              2.9890254    
    800000   12000          100            100            0.019832558   -0.012373602    0              0.071871275    3.2591022      0              1.5737038e+08  0              0              2.9891147    
    900000   12000          100            100            0.01918864    -0.012247698    0              0.069813618    0.17862475     0              8625149.7      0              0              2.9892741    
   1000000   12000          100            100            0.019384621   -0.01227143     0              0.070425294    0.10684095     0              5158967.1      0              0              2.9892283    
   1100000   12000          100            100            0.019431687   -0.012272555    0              0.070567614    0.00019008161  0              9178.3607      0              0              2.9892169    
   1200000   12000          100            100            0.019394742   -0.012272112    0              0.070456337    0.0016198112   0              78214.883      0              0              2.9892254    
   1300000   12000          100            100            0.019396384   -0.012272166    0              0.070461319    0.00010857165  0              5242.5366      0              0              2.9892251    
   1400000   12000          100            100            0.019400869   -0.01227235     0              0.070474956    9.5620992e-06  0              461.71955      0              0              2.989224     
   1500000   12000          100            100            0.019399694   -0.012272303    0              0.070471384    4.1515664e-06  0              200.46428      0              0              2.9892243    
   1600000   12000          100            100            0.019399352   -0.012272289    0              0.070470345    7.1286113e-10  0              0.034421513    0              0              2.9892244    
   1700000   12000          100            100            0.01939958    -0.012272298    0              0.070471039    6.9451781e-08  0              3.3535779      0              0              2.9892243    
   1800000   12000          100            100            0.019399577   -0.012272298    0              0.070471028    3.5797734e-09  0              0.17285445     0              0              2.9892243    
   1900000   12000          100            100            0.019399547   -0.012272297    0              0.070470939    4.8582501e-10  0              0.023458751    0              0              2.9892243    
   2000000   12000          100            100            0.019399554   -0.012272297    0              0.070470959    1.5913304e-10  0              0.007683965    0              0              2.9892243    
   2100000   12000          100            100            0.019399557   -0.012272297    0              0.070470967    4.7379786e-14  0              2.2878003e-06  0              0              2.9892243    
   2200000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    2.9353383e-12  0              0.00014173698  0              0              2.9892243    
   2300000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    1.1425462e-13  0              5.5169467e-06  0              0              2.9892243    
   2400000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    2.4084896e-14  0              1.1629734e-06  0              0              2.9892243    
   2500000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    5.9281783e-15  0              2.8625051e-07  0              0              2.9892243    
   2600000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    1.8512251e-17  0              8.9389035e-10  0              0              2.9892243    
   2700000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    9.7783123e-17  0              4.721597e-09   0              0              2.9892243    
   2800000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    2.5138433e-17  0              1.2138449e-09  0              0              2.9892243    
   2900000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    1.1443007e-17  0              5.5254185e-10  0              0              2.9892243    
   3000000   12000          100            100            0.019399555   -0.012272297    0              0.070470963    2.233581e-20   0              1.0785163e-12  0              0              2.9892243    
Loop time of 571.153 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4538187.978 ns/day, 0.000 hours/ns, 5252.532 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.633     | 117.57     | 152.63     | 320.9 | 20.58
Neigh   | 1.8348     | 1.8525     | 1.8701     |   1.0 |  0.32
Comm    | 24.58      | 59.752     | 93.988     | 442.3 | 10.46
Output  | 0.48194    | 0.48237    | 0.48285    |   0.1 |  0.08
Modify  | 271.39     | 312.59     | 354.81     | 230.6 | 54.73
Other   |            | 78.9       |            |       | 13.81

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018628306    1.2403874e-16  0              0.055884918    1586825        0              7.6622099e+13  0              0              3.3425604    
    200000   12000          100            100            0.0056486195   1.2403874e-16  0              0.016945859    302124.96      0              1.4588533e+13  0              0              3.0995925    
    300000   12000          100            100           -0.0010745631   1.2403874e-16  0             -0.0032236892   31347.517      0              1.5136594e+12  0              0              3.0250817    
    400000   12000          100            100            0.0026113897  -0.00033529879  0              0.008169468    11825.505      0              5.7101132e+11  0              0              2.9972713    
    500000   12000          100            100            0.031087409   -0.013840234    0              0.10710246     1397.3628      0              6.7473649e+10  0              0              2.9880723    
    600000   12000          100            100            0.024967747   -0.012536126    0              0.087439367    25.672306      0              1.2396238e+09  0              0              2.9892585    
    700000   12000          100            100            0.020849041   -0.014021494    0              0.076568616    2.1350873      0              1.0309572e+08  0              0              2.9899538    
    800000   12000          100            100            0.019499173   -0.014181355    0              0.072678873    0.30869847     0              14905945       0              0              2.9902139    
    900000   12000          100            100            0.019040846   -0.014162261    0              0.071284799    0.048553663    0              2344482.6      0              0              2.9903088    
   1000000   12000          100            100            0.01887565    -0.01415526     0              0.070782209    0.0076782007   0              370752.83      0              0              2.9903432    
   1100000   12000          100            100            0.018816613   -0.014150731    0              0.07060057     0.0012076385   0              58312.539      0              0              2.9903557    
   1200000   12000          100            100            0.018795494   -0.014148441    0              0.070534922    0.00018746536  0              9052.0313      0              0              2.9903602    
   1300000   12000          100            100            0.018787662   -0.014148217    0              0.070511203    2.8743851e-05  0              1387.9377      0              0              2.9903619    
   1400000   12000          100            100            0.018784835   -0.014148133    0              0.070502637    4.35919e-06    0              210.48969      0              0              2.9903624    
   1500000   12000          100            100            0.018783814   -0.014148103    0              0.070499546    6.5477046e-07  0              31.616522      0              0              2.9903627    
   1600000   12000          100            100            0.018783446   -0.014148092    0              0.070498431    9.7517599e-08  0              4.7087759      0              0              2.9903627    
   1700000   12000          100            100            0.018783314   -0.014148088    0              0.070498029    1.4414191e-08  0              0.6960097      0              0              2.9903628    
   1800000   12000          100            100            0.018783266   -0.014148086    0              0.070497884    2.1161543e-09  0              0.10218152     0              0              2.9903628    
   1900000   12000          100            100            0.018783249   -0.014148086    0              0.070497832    3.0879919e-10  0              0.014910808    0              0              2.9903628    
   2000000   12000          100            100            0.018783242   -0.014148086    0              0.070497813    4.4808504e-11  0              0.0021636423   0              0              2.9903628    
   2100000   12000          100            100            0.01878324    -0.014148086    0              0.070497806    6.4692677e-12  0              0.00031237779  0              0              2.9903628    
   2200000   12000          100            100            0.018783239   -0.014148086    0              0.070497804    9.2975744e-13  0              4.489466e-05   0              0              2.9903628    
   2300000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    1.3302653e-13  0              6.4233752e-06  0              0              2.9903628    
   2400000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    1.8769654e-14  0              9.0631941e-07  0              0              2.9903628    
   2500000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    2.6827827e-15  0              1.2954198e-07  0              0              2.9903628    
   2600000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    4.5057411e-16  0              2.1756611e-08  0              0              2.9903628    
   2700000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    2.9618305e-19  0              1.430162e-11   0              0              2.9903628    
   2800000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    2.187675e-18   0              1.05635e-10    0              0              2.9903628    
   2900000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    1.3411698e-17  0              6.4760289e-10  0              0              2.9903628    
   3000000   12000          100            100            0.018783239   -0.014148086    0              0.070497803    4.688479e-18   0              2.2638987e-10  0              0              2.9903628    
Loop time of 567.293 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4569065.535 ns/day, 0.000 hours/ns, 5288.270 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.911     | 114.29     | 152.5      | 330.4 | 20.15
Neigh   | 1.8026     | 1.8189     | 1.8355     |   1.0 |  0.32
Comm    | 24.619     | 60.442     | 97.351     | 438.3 | 10.65
Output  | 0.47899    | 0.47946    | 0.48       |   0.1 |  0.08
Modify  | 271.67     | 312.62     | 352.94     | 223.5 | 55.11
Other   |            | 77.63      |            |       | 13.69

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018708264    1.2403874e-16  0              0.056124791    1596900.1      0              7.7108591e+13  0              0              3.340143     
    200000   12000          100            100            0.0058209266   1.2403874e-16  0              0.01746278     316813.73      0              1.5297801e+13  0              0              3.0960285    
    300000   12000          100            100           -0.00086873294  1.2403874e-16  0             -0.0026061988   19007.226      0              9.1779092e+11  0              0              3.0309167    
    400000   12000          100            100            0.035350252   -0.014208726    0              0.12025948     20580.46       0              9.9375677e+11  0              0              2.9886687    
    500000   12000          100            100            0.018574115   -0.011153856    0              0.0668762      3159.4421      0              1.5255815e+11  0              0              2.9915143    
    600000   12000          100            100            0.017045758   -0.015202947    0              0.066340221    396.4821       0              1.9144702e+10  0              0              2.9914412    
    700000   12000          100            100            0.01990497    -0.015512581    0              0.075227492    28.082348      0              1.3559961e+09  0              0              2.9909204    
    800000   12000          100            100            0.017487549   -0.015683271    0              0.068145917    0.10630234     0              5132959.8      0              0              2.991352     
    900000   12000          100            100            0.018531954   -0.015661972    0              0.071257833    0.26263291     0              12681603       0              0              2.9911563    
   1000000   12000          100            100            0.018243977   -0.015680988    0              0.070412919    0.11238208     0              5426528.3      0              0              2.99121      
   1100000   12000          100            100            0.018265782   -0.015681465    0              0.07047881     0.01510132     0              729188.67      0              0              2.9912053    
   1200000   12000          100            100            0.018290555   -0.015681881    0              0.070553546    0.00064259486  0              31028.606      0              0              2.9912009    
   1300000   12000          100            100            0.018273655   -0.015681376    0              0.070502341    3.6446655e-06  0              175.98785      0              0              2.991204     
   1400000   12000          100            100            0.018279939   -0.015681703    0              0.070521521    1.9793371e-05  0              955.75105      0              0              2.9912028    
   1500000   12000          100            100            0.018278596   -0.01568163     0              0.070517418    5.1733024e-06  0              249.80026      0              0              2.9912031    
   1600000   12000          100            100            0.018278526   -0.015681627    0              0.070517204    4.9265884e-07  0              23.788732      0              0              2.9912031    
   1700000   12000          100            100            0.018278744   -0.015681638    0              0.07051787     9.3984351e-09  0              0.4538168      0              0              2.991203     
   1800000   12000          100            100            0.018278629   -0.015681632    0              0.07051752     1.4494284e-09  0              0.069987709    0              0              2.9912031    
   1900000   12000          100            100            0.018278665   -0.015681634    0              0.07051763     1.1901758e-09  0              0.057469328    0              0              2.9912031    
   2000000   12000          100            100            0.01827866    -0.015681634    0              0.070517614    2.1167847e-10  0              0.010221196    0              0              2.9912031    
   2100000   12000          100            100            0.018278658   -0.015681634    0              0.070517609    1.3605577e-11  0              0.00065696461  0              0              2.9912031    
   2200000   12000          100            100            0.01827866    -0.015681634    0              0.070517614    2.7065201e-14  0              1.3068817e-06  0              0              2.9912031    
   2300000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    1.5612997e-13  0              7.5389574e-06  0              0              2.9912031    
   2400000   12000          100            100            0.01827866    -0.015681634    0              0.070517612    6.1041881e-14  0              2.947494e-06   0              0              2.9912031    
   2500000   12000          100            100            0.01827866    -0.015681634    0              0.070517612    7.550967e-15   0              3.6460917e-07  0              0              2.9912031    
   2600000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    2.2679706e-16  0              1.0951219e-08  0              0              2.9912031    
   2700000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    6.8017663e-18  0              3.2843295e-10  0              0              2.9912031    
   2800000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    2.7806463e-18  0              1.3426746e-10  0              0              2.9912031    
   2900000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    5.8436703e-18  0              2.8216992e-10  0              0              2.9912031    
   3000000   12000          100            100            0.018278659   -0.015681634    0              0.070517612    1.1240427e-18  0              5.4275997e-11  0              0              2.9912031    
Loop time of 565.601 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4582736.830 ns/day, 0.000 hours/ns, 5304.094 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.011     | 112.93     | 147.41     | 323.6 | 19.97
Neigh   | 1.8273     | 1.8479     | 1.8681     |   1.1 |  0.33
Comm    | 25.054     | 59.51      | 94.508     | 439.5 | 10.52
Output  | 0.48348    | 0.48394    | 0.48439    |   0.1 |  0.09
Modify  | 267.79     | 311.32     | 355.32     | 237.9 | 55.04
Other   |            | 79.51      |            |       | 14.06

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018772093    1.2403874e-16  0              0.056316279    1604964.2      0              7.749798e+13   0              0              3.3381856    
    200000   12000          100            100            0.0059593367   1.2403874e-16  0              0.01787801     328772.03      0              1.5875225e+13  0              0              3.0930619    
    300000   12000          100            100           -0.00069386647  1.2403874e-16  0             -0.0020815994   11456.335      0              5.5318541e+11  0              0              3.0348257    
    400000   12000          100            100            0.076125917   -0.022553114    0              0.25093087     31.822801      0              1.5366092e+09  0              0              2.9846142    
    500000   12000          100            100            0.010713626   -0.01756387     0              0.049704749    2778.1235      0              1.3414564e+11  0              0              2.9930941    
    600000   12000          100            100            0.014636436   -0.016058077    0              0.059967385    303.74078      0              1.4666555e+10  0              0              2.9924695    
    700000   12000          100            100            0.015921354   -0.01602926     0              0.063793322    3.0640925      0              1.4795406e+08  0              0              2.9922535    
    800000   12000          100            100            0.017379731   -0.016363875    0              0.068503068    2.6697591      0              1.2891311e+08  0              0              2.9919764    
    900000   12000          100            100            0.018047274   -0.016364865    0              0.070506687    1.0050559      0              48530550       0              0              2.991859     
   1000000   12000          100            100            0.018136465   -0.016383798    0              0.070793194    0.056774568    0              2741440.7      0              0              2.9918415    
   1100000   12000          100            100            0.018091102   -0.016380971    0              0.070654276    0.00064063281  0              30933.865      0              0              2.9918492    
   1200000   12000          100            100            0.01805837    -0.016378266    0              0.070553375    0.0018595301   0              89790.052      0              0              2.991855     
   1300000   12000          100            100            0.018049538   -0.016377514    0              0.070526127    0.00026171928  0              12637.487      0              0              2.9918566    
   1400000   12000          100            100            0.018049883   -0.016377534    0              0.070527184    2.5609175e-06  0              123.65754      0              0              2.9918566    
   1500000   12000          100            100            0.018051214   -0.016377644    0              0.070531285    2.0306746e-06  0              98.054008      0              0              2.9918563    
   1600000   12000          100            100            0.018051771   -0.016377691    0              0.070533003    7.3700242e-07  0              35.587209      0              0              2.9918562    
   1700000   12000          100            100            0.018051846   -0.016377697    0              0.070533236    3.9858715e-08  0              1.9246347      0              0              2.9918562    
   1800000   12000          100            100            0.018051807   -0.016377694    0              0.070533114    5.5826844e-10  0              0.026956785    0              0              2.9918562    
   1900000   12000          100            100            0.018051778   -0.016377692    0              0.070533027    1.3870524e-09  0              0.066975796    0              0              2.9918562    
   2000000   12000          100            100            0.018051771   -0.016377691    0              0.070533004    1.8872491e-10  0              0.0091128503   0              0              2.9918562    
   2100000   12000          100            100            0.018051771   -0.016377691    0              0.070533005    1.6272855e-12  0              7.8575792e-05  0              0              2.9918562    
   2200000   12000          100            100            0.018051773   -0.016377691    0              0.070533009    1.5571858e-12  0              7.5190929e-05  0              0              2.9918562    
   2300000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     5.4001103e-13  0              2.60752e-05    0              0              2.9918562    
   2400000   12000          100            100            0.018051773   -0.016377691    0              0.070533011    2.8031032e-14  0              1.3535182e-06  0              0              2.9918562    
   2500000   12000          100            100            0.018051773   -0.016377691    0              0.070533011    4.7915716e-16  0              2.3136784e-08  0              0              2.9918562    
   2600000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     1.0224359e-15  0              4.9369773e-08  0              0              2.9918562    
   2700000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     1.5765907e-16  0              7.6127923e-09  0              0              2.9918562    
   2800000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     3.0267193e-19  0              1.4614944e-11  0              0              2.9918562    
   2900000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     1.3331166e-17  0              6.4371427e-10  0              0              2.9918562    
   3000000   12000          100            100            0.018051773   -0.016377691    0              0.07053301     1.1739483e-17  0              5.6685761e-10  0              0              2.9918562    
Loop time of 564.854 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4588792.566 ns/day, 0.000 hours/ns, 5311.103 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.786     | 113.92     | 148.79     | 318.6 | 20.17
Neigh   | 1.8319     | 1.849      | 1.8657     |   1.0 |  0.33
Comm    | 26.099     | 59.354     | 93.995     | 431.0 | 10.51
Output  | 0.48398    | 0.48441    | 0.48492    |   0.1 |  0.09
Modify  | 270.4      | 311.89     | 352.26     | 227.5 | 55.22
Other   |            | 77.35      |            |       | 13.69

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018824737    1.2403874e-16  0              0.05647421     1611629.6      0              7.7819825e+13  0              0              3.3365528    
    200000   12000          100            100            0.0060740628   1.2403874e-16  0              0.018222188    338789.98      0              1.6358955e+13  0              0              3.0905333    
    300000   12000          100            100           -0.00054297209  1.2403874e-16  0             -0.0016289163   6706.8645      0              3.2385048e+11  0              0              3.0375599    
    400000   12000          100            100            0.042232596   -0.029616033    0              0.15631382     18037.307      0              8.7095702e+11  0              0              2.988557     
    500000   12000          100            100            0.018272816   -0.01079751     0              0.06561596     3404.1579      0              1.643746e+11   0              0              2.9927283    
    600000   12000          100            100            0.017130861   -0.016590542    0              0.067983126    446.49492      0              2.1559642e+10  0              0              2.9924987    
    700000   12000          100            100            0.01934123    -0.017209149    0              0.075232839    36.868189      0              1.7802329e+09  0              0              2.9921402    
    800000   12000          100            100            0.017149578   -0.016466999    0              0.067915734    0.31828844     0              15369010       0              0              2.9925261    
    900000   12000          100            100            0.018257504   -0.016634196    0              0.071406709    0.23717705     0              11452431       0              0              2.992336     
   1000000   12000          100            100            0.017960165   -0.016536936    0              0.070417432    0.12080314     0              5833151.4      0              0              2.9923903    
   1100000   12000          100            100            0.017982999   -0.016552969    0              0.070501965    0.016655813    0              804249.61      0              0              2.9923852    
   1200000   12000          100            100            0.018010315   -0.016555667    0              0.070586613    0.00065363394  0              31561.644      0              0              2.9923808    
   1300000   12000          100            100            0.017991509   -0.016553766    0              0.070528294    8.707162e-06   0              420.43769      0              0              2.9923839    
   1400000   12000          100            100            0.017998337   -0.016554473    0              0.070549484    2.543995e-05   0              1228.4042      0              0              2.9923828    
   1500000   12000          100            100            0.017997039   -0.016554335    0              0.070545453    5.8266608e-06  0              281.3486       0              0              2.992383     
   1600000   12000          100            100            0.017996853   -0.016554318    0              0.070544876    4.5155097e-07  0              21.80378       0              0              2.992383     
   1700000   12000          100            100            0.017997129   -0.016554346    0              0.070545734    2.777419e-09   0              0.13411162     0              0              2.992383     
   1800000   12000          100            100            0.017997      -0.016554333    0              0.070545333    3.6114756e-09  0              0.17438523     0              0              2.992383     
   1900000   12000          100            100            0.017997035   -0.016554336    0              0.070545442    1.6363346e-09  0              0.079012741    0              0              2.992383     
   2000000   12000          100            100            0.017997033   -0.016554336    0              0.070545435    2.1058717e-10  0              0.010168501    0              0              2.992383     
   2100000   12000          100            100            0.01799703    -0.016554336    0              0.070545424    7.2475222e-12  0              0.00034995691  0              0              2.992383     
   2200000   12000          100            100            0.017997032   -0.016554336    0              0.070545431    1.8776086e-13  0              9.0663e-06     0              0              2.992383     
   2300000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    3.5860735e-13  0              1.7315865e-05  0              0              2.992383     
   2400000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    7.6149429e-14  0              3.6769834e-06  0              0              2.992383     
   2500000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    5.3973534e-15  0              2.6061888e-07  0              0              2.992383     
   2600000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    3.5336028e-17  0              1.7062503e-09  0              0              2.992383     
   2700000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    9.606774e-17   0              4.6387674e-09  0              0              2.992383     
   2800000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    2.756505e-17   0              1.3310176e-09  0              0              2.992383     
   2900000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    7.4127033e-18  0              3.5793292e-10  0              0              2.992383     
   3000000   12000          100            100            0.017997031   -0.016554336    0              0.070545429    1.7676326e-17  0              8.5352652e-10  0              0              2.992383     
Loop time of 561.407 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4616967.905 ns/day, 0.000 hours/ns, 5343.713 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.716     | 112.62     | 147.54     | 313.0 | 20.06
Neigh   | 1.8231     | 1.839      | 1.8552     |   0.9 |  0.33
Comm    | 23.146     | 57.318     | 94.54      | 427.8 | 10.21
Output  | 0.48351    | 0.48396    | 0.48447    |   0.1 |  0.09
Modify  | 269.86     | 311.23     | 351.67     | 227.5 | 55.44
Other   |            | 77.92      |            |       | 13.88

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:          970.5 ave        1374 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018869223    1.2403874e-16  0              0.056607669    1617272.1      0              7.8092284e+13  0              0              3.33516      
    200000   12000          100            100            0.0061714052   1.2403874e-16  0              0.018514216    347364.34      0              1.6772981e+13  0              0              3.088339     
    300000   12000          100            100           -0.00041096468  1.2403874e-16  0             -0.001232894    3702.8763      0              1.7879865e+11  0              0              3.0395313    
    400000   12000          100            100            0.0065896738  -0.011565423    0              0.031334444    22799.353      0              1.1008992e+12  0              0              2.995012     
    500000   12000          100            100            0.025206383   -0.022728872    0              0.098348023    2811.9469      0              1.3577885e+11  0              0              2.9914718    
    600000   12000          100            100            0.024344161   -0.016518104    0              0.089550585    123.46936      0              5.9618936e+09  0              0              2.9918974    
    700000   12000          100            100            0.019961581   -0.016577343    0              0.076462085    26.273803      0              1.2686679e+09  0              0              2.992519     
    800000   12000          100            100            0.01836726    -0.017028329    0              0.072130109    5.5831679      0              2.6959119e+08  0              0              2.9927374    
    900000   12000          100            100            0.018001088   -0.016874469    0              0.070877732    0.97592528     0              47123939       0              0              2.9928024    
   1000000   12000          100            100            0.017906457   -0.016852645    0              0.070572016    0.14460882     0              6982642.2      0              0              2.9928187    
   1100000   12000          100            100            0.017891162   -0.016850518    0              0.070524003    0.01837615     0              887318.53      0              0              2.9928214    
   1200000   12000          100            100            0.017893669   -0.016850251    0              0.070531257    0.0019824009   0              95723.047      0              0              2.9928211    
   1300000   12000          100            100            0.0178974     -0.016850571    0              0.070542771    0.00017428036  0              8415.3749      0              0              2.9928205    
   1400000   12000          100            100            0.017899706   -0.016850773    0              0.070549891    1.1137395e-05  0              537.78495      0              0              2.9928202    
   1500000   12000          100            100            0.017900828   -0.016850873    0              0.070553357    3.415599e-07   0              16.492705      0              0              2.99282      
   1600000   12000          100            100            0.017901308   -0.016850916    0              0.070554841    1.1719102e-09  0              0.056587348    0              0              2.9928199    
   1700000   12000          100            100            0.017901496   -0.016850933    0              0.070555422    1.0379414e-08  0              0.50118474     0              0              2.9928199    
   1800000   12000          100            100            0.017901564   -0.016850939    0              0.070555632    4.4841121e-09  0              0.21652173     0              0              2.9928199    
   1900000   12000          100            100            0.017901587   -0.016850941    0              0.070555702    1.1183055e-09  0              0.053998971    0              0              2.9928199    
   2000000   12000          100            100            0.017901594   -0.016850942    0              0.070555723    2.1192505e-10  0              0.010233102    0              0              2.9928199    
   2100000   12000          100            100            0.017901595   -0.016850942    0              0.070555728    3.3243128e-11  0              0.0016051917   0              0              2.9928199    
   2200000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    4.4460024e-12  0              0.00021468155  0              0              2.9928199    
   2300000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    5.0708384e-13  0              2.4485264e-05  0              0              2.9928199    
   2400000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    4.7557217e-14  0              2.2963678e-06  0              0              2.9928199    
   2500000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    3.3057995e-15  0              1.5962523e-07  0              0              2.9928199    
   2600000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    1.499873e-16   0              7.2423499e-09  0              0              2.9928199    
   2700000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    2.5300366e-17  0              1.2216641e-09  0              0              2.9928199    
   2800000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    1.3910733e-17  0              6.7169952e-10  0              0              2.9928199    
   2900000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    4.6655233e-22  0              2.2528142e-14  0              0              2.9928199    
   3000000   12000          100            100            0.017901596   -0.016850942    0              0.070555729    1.2655251e-17  0              6.1107679e-10  0              0              2.9928199    
Loop time of 567.797 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4565012.469 ns/day, 0.000 hours/ns, 5283.579 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.671     | 110.6      | 146.44     | 326.5 | 19.48
Neigh   | 1.8274     | 1.8442     | 1.8614     |   1.0 |  0.32
Comm    | 25.912     | 59.715     | 95.998     | 433.5 | 10.52
Output  | 0.48295    | 0.48334    | 0.48379    |   0.1 |  0.09
Modify  | 269.75     | 314.72     | 358.59     | 229.0 | 55.43
Other   |            | 80.43      |            |       | 14.17

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018907533    1.2403874e-16  0              0.056722599    1622138.7      0              7.8327275e+13  0              0              3.3339511    
    200000   12000          100            100            0.0062555212   1.2403874e-16  0              0.018766564    354828.12      0              1.713338e+13   0              0              3.0864068    
    300000   12000          100            100           -0.00029411296  1.2403874e-16  0             -0.00088233888  1838.0622      0              8.8753443e+10  0              0              3.0409834    
    400000   12000          100            100           -0.0007006263  -4.7877875e-07  0             -0.0021014001   12119.826      0              5.8522301e+11  0              0              2.9999323    
    500000   12000          100            100            0.0049820713  -0.0047109887   0              0.019657203    9.2293117      0              4.4565043e+08  0              0              2.9964176    
    600000   12000          100            100            0.021348112   -0.01560804     0              0.079652375    408.91077      0              1.9744838e+10  0              0              2.9927825    
    700000   12000          100            100            0.017754174   -0.017002026    0              0.070264548    63.59923       0              3.0709792e+09  0              0              2.9931958    
    800000   12000          100            100            0.017355992   -0.017554829    0              0.069622804    7.531465       0              3.6366749e+08  0              0              2.993238     
    900000   12000          100            100            0.017876034   -0.017583065    0              0.071211166    0.70907613     0              34238749       0              0              2.9931573    
   1000000   12000          100            100            0.017567336   -0.017539234    0              0.070241243    0.046905426    0              2264895.2      0              0              2.9932053    
   1100000   12000          100            100            0.017718438   -0.017546801    0              0.070702115    0.0014825367   0              71586.392      0              0              2.9931827    
   1200000   12000          100            100            0.017655805   -0.017544677    0              0.070512093    4.7224488e-06  0              228.03015      0              0              2.9931919    
   1300000   12000          100            100            0.017678703   -0.0175463      0              0.070582409    4.4059903e-05  0              2127.495       0              0              2.9931885    
   1400000   12000          100            100            0.01767107    -0.017545744    0              0.070558954    1.8613873e-05  0              898.7973       0              0              2.9931896    
   1500000   12000          100            100            0.017673315   -0.017545905    0              0.070565849    4.443671e-06   0              214.56897      0              0              2.9931893    
   1600000   12000          100            100            0.017672775   -0.017545867    0              0.070564193    7.8697611e-07  0              38.00026       0              0              2.9931894    
   1700000   12000          100            100            0.01767285    -0.017545872    0              0.070564423    1.117961e-07   0              5.3982334      0              0              2.9931894    
   1800000   12000          100            100            0.01767287    -0.017545874    0              0.070564484    1.2922502e-08  0              0.62398136     0              0              2.9931894    
   1900000   12000          100            100            0.017672846   -0.017545872    0              0.070564411    1.175298e-09   0              0.056750936    0              0              2.9931894    
   2000000   12000          100            100            0.01767286    -0.017545873    0              0.070564454    7.4423288e-11  0              0.0035936342   0              0              2.9931894    
   2100000   12000          100            100            0.017672854   -0.017545873    0              0.070564434    1.9979483e-12  0              9.6473775e-05  0              0              2.9931894    
   2200000   12000          100            100            0.017672856   -0.017545873    0              0.070564442    2.8720263e-14  0              1.3867987e-06  0              0              2.9931894    
   2300000   12000          100            100            0.017672855   -0.017545873    0              0.070564439    9.3741378e-14  0              4.5264357e-06  0              0              2.9931894    
   2400000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     3.6753438e-14  0              1.774692e-06   0              0              2.9931894    
   2500000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     8.5110028e-15  0              4.1096587e-07  0              0              2.9931894    
   2600000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     1.4505393e-15  0              7.0041351e-08  0              0              2.9931894    
   2700000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     1.7907168e-16  0              8.6467305e-09  0              0              2.9931894    
   2800000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     2.1482576e-17  0              1.0373167e-09  0              0              2.9931894    
   2900000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     2.0568766e-17  0              9.9319209e-10  0              0              2.9931894    
   3000000   12000          100            100            0.017672856   -0.017545873    0              0.07056444     3.433637e-18   0              1.6579804e-10  0              0              2.9931894    
Loop time of 564.267 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4593571.262 ns/day, 0.000 hours/ns, 5316.633 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.014     | 112.09     | 146.12     | 312.9 | 19.86
Neigh   | 1.8226     | 1.838      | 1.8536     |   0.9 |  0.33
Comm    | 25.613     | 58.08      | 92.773     | 423.4 | 10.29
Output  | 0.48435    | 0.48477    | 0.48525    |   0.1 |  0.09
Modify  | 270.61     | 313.37     | 354.7      | 232.8 | 55.54
Other   |            | 78.4       |            |       | 13.89

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018941023    1.2403874e-16  0              0.05682307     1626398.8      0              7.8532976e+13  0              0              3.332887     
    200000   12000          100            100            0.0063292743   1.2403874e-16  0              0.018987823    361413.59      0              1.7451369e+13  0              0              3.0846853    
    300000   12000          100            100           -0.00018962873  1.2403874e-16  0             -0.0005688862   743.2136       0              3.5887125e+10  0              0              3.0420689    
    400000   12000          100            100           -0.00045344807  1.2403874e-16  0             -0.0013603442   4684.4456      0              2.2619512e+11  0              0              3.0029437    
    500000   12000          100            100            0.024997387   -0.016698762    0              0.091690922    3384.0481      0              1.6340357e+11  0              0              2.9926481    
    600000   12000          100            100            0.01052355    -0.017197456    0              0.048768107    0.51960653     0              25089940       0              0              2.994605     
    700000   12000          100            100            0.016706886   -0.017848597    0              0.067969255    59.482927      0              2.8722177e+09  0              0              2.9936208    
    800000   12000          100            100            0.018346255   -0.017806281    0              0.072845046    3.8786221      0              1.8728478e+08  0              0              2.9934013    
    900000   12000          100            100            0.017923595   -0.017843582    0              0.071614367    0.16594771     0              8013020.9      0              0              2.9934596    
   1000000   12000          100            100            0.017596195   -0.017816613    0              0.070605197    0.15377202     0              7425100.7      0              0              2.993506     
   1100000   12000          100            100            0.017545898   -0.017806637    0              0.070444332    0.0053508319   0              258372.52      0              0              2.9935131    
   1200000   12000          100            100            0.017571433   -0.017811543    0              0.070525843    0.00080874688  0              39051.492      0              0              2.9935093    
   1300000   12000          100            100            0.017587262   -0.017812135    0              0.070573921    0.00036243143  0              17500.517      0              0              2.9935071    
   1400000   12000          100            100            0.017588844   -0.017812197    0              0.070578729    5.8384494e-06  0              281.91783      0              0              2.9935069    
   1500000   12000          100            100            0.017587252   -0.017812128    0              0.070573884    3.0673713e-06  0              148.11238      0              0              2.9935071    
   1600000   12000          100            100            0.017586521   -0.017812098    0              0.070571661    7.9863891e-07  0              38.563415      0              0              2.9935072    
   1700000   12000          100            100            0.017586495   -0.017812097    0              0.070571583    3.3520715e-09  0              0.16185954     0              0              2.9935072    
   1800000   12000          100            100            0.017586584   -0.017812101    0              0.070571854    1.0065776e-08  0              0.4860403      0              0              2.9935072    
   1900000   12000          100            100            0.017586617   -0.017812102    0              0.070571953    1.6363796e-09  0              0.079014914    0              0              2.9935072    
   2000000   12000          100            100            0.017586616   -0.017812102    0              0.070571949    3.5246265e-14  0              1.701916e-06   0              0              2.9935072    
   2100000   12000          100            100            0.017586611   -0.017812102    0              0.070571934    2.9791515e-11  0              0.0014385257   0              0              2.9935072    
   2200000   12000          100            100            0.017586609   -0.017812102    0              0.07057193     3.0828419e-12  0              0.0001488594   0              0              2.9935072    
   2300000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    2.4020356e-14  0              1.159857e-06   0              0              2.9935072    
   2400000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    8.1033066e-14  0              3.9127967e-06  0              0              2.9935072    
   2500000   12000          100            100            0.01758661    -0.017812102    0              0.070571932    5.2594022e-15  0              2.5395771e-07  0              0              2.9935072    
   2600000   12000          100            100            0.01758661    -0.017812102    0              0.070571932    2.6396525e-16  0              1.2745937e-08  0              0              2.9935072    
   2700000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    1.3807757e-16  0              6.6672716e-09  0              0              2.9935072    
   2800000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    3.0956626e-17  0              1.4947847e-09  0              0              2.9935072    
   2900000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    5.8675278e-19  0              2.8332192e-11  0              0              2.9935072    
   3000000   12000          100            100            0.01758661    -0.017812102    0              0.070571931    5.5091314e-19  0              2.6601624e-11  0              0              2.9935072    
Loop time of 562.542 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4607653.803 ns/day, 0.000 hours/ns, 5332.933 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.048     | 110.19     | 142.82     | 308.4 | 19.59
Neigh   | 1.8051     | 1.832      | 1.8597     |   1.4 |  0.33
Comm    | 24.479     | 57.218     | 91.353     | 422.0 | 10.17
Output  | 0.4833     | 0.48371    | 0.48417    |   0.1 |  0.09
Modify  | 275.55     | 315.97     | 356.14     | 223.5 | 56.17
Other   |            | 76.85      |            |       | 13.66

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.018970661    1.2403874e-16  0              0.056911984    1630173.1      0              7.8715224e+13  0              0              3.3319398    
    200000   12000          100            100            0.0063947155   1.2403874e-16  0              0.019184147    367288.9       0              1.7735066e+13  0              0              3.0831364    
    300000   12000          100            100           -9.5397504e-05  1.2403874e-16  0             -0.00028619251  183.00828      0              8.8368148e+09  0              0              3.0428879    
    400000   12000          100            100           -0.00022181172  1.2403874e-16  0             -0.00066543515  1052.622       0              5.0827348e+10  0              0              3.0046087    
    500000   12000          100            100            0.032914452   -0.023733384    0              0.12247674     1824.8058      0              8.8113341e+10  0              0              2.9917746    
    600000   12000          100            100            0.023669667   -0.017860285    0              0.088869285    228.91215      0              1.1053349e+10  0              0              2.99301      
    700000   12000          100            100            0.017043967   -0.018628944    0              0.069760844    66.629901      0              3.2173194e+09  0              0              2.993813     
    800000   12000          100            100            0.016320112   -0.018775962    0              0.067736298    1.736437       0              83846330       0              0              2.99391      
    900000   12000          100            100            0.016902518   -0.018921037    0              0.069628592    0.37536786     0              18125171       0              0              2.9938271    
   1000000   12000          100            100            0.017218757   -0.018963378    0              0.070619648    0.15758518     0              7609224.2      0              0              2.9937829    
   1100000   12000          100            100            0.01725183    -0.01896492     0              0.070720409    0.0035061069   0              169297.35      0              0              2.9937782    
   1200000   12000          100            100            0.017219596   -0.018964454    0              0.070623242    0.0010255966   0              49522.392      0              0              2.9937824    
   1300000   12000          100            100            0.017203894   -0.018963699    0              0.07057538     0.00037025618  0              17878.346      0              0              2.9937845    
   1400000   12000          100            100            0.017202608   -0.018963574    0              0.070571398    6.4474166e-06  0              311.32267      0              0              2.9937847    
   1500000   12000          100            100            0.01720422    -0.018963715    0              0.070576376    2.7868774e-06  0              134.56834      0              0              2.9937845    
   1600000   12000          100            100            0.017204963   -0.018963782    0              0.07057867     8.649936e-07   0              41.767445      0              0              2.9937844    
   1700000   12000          100            100            0.01720501    -0.018963787    0              0.070578818    1.1337705e-08  0              0.54745719     0              0              2.9937844    
   1800000   12000          100            100            0.017204928   -0.01896378     0              0.070578564    7.472417e-09   0              0.36081628     0              0              2.9937844    
   1900000   12000          100            100            0.017204893   -0.018963776    0              0.070578455    2.0089532e-09  0              0.097005158    0              0              2.9937844    
   2000000   12000          100            100            0.017204891   -0.018963776    0              0.07057845     1.8767174e-11  0              0.00090619966  0              0              2.9937844    
   2100000   12000          100            100            0.017204895   -0.018963777    0              0.070578462    1.9795724e-11  0              0.00095586466  0              0              2.9937844    
   2200000   12000          100            100            0.017204897   -0.018963777    0              0.070578468    4.6381312e-12  0              0.00022395876  0              0              2.9937844    
   2300000   12000          100            100            0.017204897   -0.018963777    0              0.070578468    2.9063566e-14  0              1.4033756e-06  0              0              2.9937844    
   2400000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    5.1751962e-14  0              2.498917e-06   0              0              2.9937844    
   2500000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    1.0606356e-14  0              5.1214297e-07  0              0              2.9937844    
   2600000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    5.2874286e-17  0              2.55311e-09    0              0              2.9937844    
   2700000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    2.1523274e-16  0              1.0392819e-08  0              0              2.9937844    
   2800000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    1.6651255e-19  0              8.0402949e-12  0              0              2.9937844    
   2900000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    1.8245045e-17  0              8.8098791e-10  0              0              2.9937844    
   3000000   12000          100            100            0.017204897   -0.018963777    0              0.070578467    1.5366908e-17  0              7.4201298e-10  0              0              2.9937844    
Loop time of 559.328 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4634135.813 ns/day, 0.000 hours/ns, 5363.583 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.781     | 109.26     | 145.02     | 315.3 | 19.53
Neigh   | 1.8726     | 1.8901     | 1.9078     |   1.0 |  0.34
Comm    | 25.831     | 58.961     | 92.232     | 408.2 | 10.54
Output  | 0.48056    | 0.48103    | 0.48151    |   0.1 |  0.09
Modify  | 267        | 310.56     | 351.21     | 226.0 | 55.52
Other   |            | 78.17      |            |       | 13.98

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.01899716     1.2403874e-16  0              0.056991479    1633551.1      0              7.8878335e+13  0              0              3.3310886    
    200000   12000          100            100            0.0064533617   1.2403874e-16  0              0.019360085    372579.57      0              1.7990534e+13  0              0              3.0817314    
    300000   12000          100            100           -9.7798284e-06  1.2403874e-16  0             -2.9339485e-05  1.7231707      0              83205748       0              0              3.0435084    
    400000   12000          100            100           -6.8598366e-06  1.2403874e-16  0             -2.057951e-05   0.83287993     0              40216791       0              0              3.0053373    
    500000   12000          100            100            0.0064408123  -0.007195349    0              0.026517786    1749.8352      0              8.449328e+10   0              0              2.9962864    
    600000   12000          100            100            0.014060179   -0.01749137     0              0.059671907    407.5592       0              1.9679575e+10  0              0              2.9945314    
    700000   12000          100            100            0.018620675   -0.019559233    0              0.075421258    48.624744      0              2.3479149e+09  0              0              2.993821     
    800000   12000          100            100            0.016290324   -0.019846343    0              0.068717316    6.0619582      0              2.9271027e+08  0              0              2.9941109    
    900000   12000          100            100            0.017130634   -0.019867845    0              0.071259747    0.82131773     0              39658494       0              0              2.9939995    
   1000000   12000          100            100            0.016841827   -0.019812942    0              0.070338421    0.10983189     0              5303389        0              0              2.9940396    
   1100000   12000          100            100            0.016944715   -0.019839648    0              0.070673794    0.014720377    0              710794.31      0              0              2.994025     
   1200000   12000          100            100            0.016905461   -0.019835072    0              0.070551454    0.0019625713   0              94765.547      0              0              2.9940303    
   1300000   12000          100            100            0.016919773   -0.019836915    0              0.070596235    0.00026163384  0              12633.362      0              0              2.9940284    
   1400000   12000          100            100            0.016914519   -0.019836279    0              0.070579837    3.4881783e-05  0              1684.3165      0              0              2.9940291    
   1500000   12000          100            100            0.01691644    -0.01983652     0              0.07058584     4.6525804e-06  0              224.65646      0              0              2.9940288    
   1600000   12000          100            100            0.016915738   -0.019836429    0              0.070583643    6.2055949e-07  0              29.964597      0              0              2.9940289    
   1700000   12000          100            100            0.016915994   -0.019836463    0              0.070584447    8.2772258e-08  0              3.9967761      0              0              2.9940289    
   1800000   12000          100            100            0.016915901   -0.019836451    0              0.070584153    1.1040285e-08  0              0.53309587     0              0              2.9940289    
   1900000   12000          100            100            0.016915935   -0.019836455    0              0.07058426     1.4725779e-09  0              0.071105516    0              0              2.9940289    
   2000000   12000          100            100            0.016915922   -0.019836454    0              0.070584221    1.9641995e-10  0              0.0094844166   0              0              2.9940289    
   2100000   12000          100            100            0.016915927   -0.019836454    0              0.070584235    2.6200551e-11  0              0.0012651309   0              0              2.9940289    
   2200000   12000          100            100            0.016915925   -0.019836454    0              0.07058423     3.4963269e-12  0              0.00016882511  0              0              2.9940289    
   2300000   12000          100            100            0.016915926   -0.019836454    0              0.070584232    4.6630817e-13  0              2.2516353e-05  0              0              2.9940289    
   2400000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    6.2725556e-14  0              3.0287926e-06  0              0              2.9940289    
   2500000   12000          100            100            0.016915926   -0.019836454    0              0.070584232    8.4724109e-15  0              4.091024e-07   0              0              2.9940289    
   2600000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    1.1727958e-15  0              5.6630111e-08  0              0              2.9940289    
   2700000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    2.2454654e-16  0              1.0842549e-08  0              0              2.9940289    
   2800000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    1.988464e-17   0              9.6015809e-10  0              0              2.9940289    
   2900000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    2.3221247e-19  0              1.1212709e-11  0              0              2.9940289    
   3000000   12000          100            100            0.016915926   -0.019836454    0              0.070584231    7.4205247e-18  0              3.5831058e-10  0              0              2.9940289    
Loop time of 545.391 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4752553.542 ns/day, 0.000 hours/ns, 5500.641 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.304     | 102.27     | 134.77     | 315.6 | 18.75
Neigh   | 1.8466     | 1.8632     | 1.8796     |   0.9 |  0.34
Comm    | 23.611     | 55.152     | 88.234     | 424.2 | 10.11
Output  | 0.48183    | 0.48221    | 0.48261    |   0.1 |  0.09
Modify  | 266.03     | 307.37     | 349.09     | 230.5 | 56.36
Other   |            | 78.25      |            |       | 14.35

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019021057    1.2403874e-16  0              0.057063171    1636600.3      0              7.9025572e+13  0              0              3.3303174    
    200000   12000          100            100            0.0065063602   1.2403874e-16  0              0.019519081    377381.3       0              1.8222393e+13  0              0              3.0804479    
    300000   12000          100            100            6.8518155e-05  1.2403874e-16  0              0.00020555447  93.177345      0              4.4992005e+09  0              0              3.0439783    
    400000   12000          100            100            0.00019278835  1.2403874e-16  0              0.00057836505  729.70531      0              3.5234858e+10  0              0              3.0054028    
    500000   12000          100            100            0.0056657421  -0.0033343866   0              0.020331613    954.16313      0              4.6073123e+10  0              0              2.9969675    
    600000   12000          100            100            0.017846869   -0.021572518    0              0.075113126    511.55628      0              2.4701222e+10  0              0              2.9940459    
    700000   12000          100            100            0.020185571   -0.019476816    0              0.080033529    0.11090244     0              5355081.8      0              0              2.993873     
    800000   12000          100            100            0.017226551   -0.019959075    0              0.071638728    8.4939698      0              4.101434e+08   0              0              2.9942065    
    900000   12000          100            100            0.016664899   -0.019642004    0              0.069636702    0.48735233     0              23532500       0              0              2.9942864    
   1000000   12000          100            100            0.01683281    -0.019700221    0              0.070198652    0.04251344     0              2052821.8      0              0              2.9942625    
   1100000   12000          100            100            0.016964792   -0.019720303    0              0.070614679    0.021659768    0              1045872.7      0              0              2.9942455    
   1200000   12000          100            100            0.016975742   -0.019721015    0              0.070648241    0.00012073148  0              5829.6909      0              0              2.9942443    
   1300000   12000          100            100            0.01696086    -0.019718842    0              0.070601422    0.00028155735  0              13595.397      0              0              2.9942462    
   1400000   12000          100            100            0.016955509   -0.019718137    0              0.070584665    3.4478587e-05  0              1664.8476      0              0              2.9942469    
   1500000   12000          100            100            0.0169561     -0.019718222    0              0.070586521    4.9109707e-07  0              23.71332       0              0              2.9942468    
   1600000   12000          100            100            0.01695697    -0.019718338    0              0.070589247    9.3805461e-07  0              45.2953        0              0              2.9942467    
   1700000   12000          100            100            0.016957119   -0.019718358    0              0.070589715    2.5784006e-08  0              1.2450174      0              0              2.9942467    
   1800000   12000          100            100            0.016957042   -0.019718347    0              0.070589473    7.6156392e-09  0              0.36773196     0              0              2.9942467    
   1900000   12000          100            100            0.016957002   -0.019718342    0              0.070589347    1.9678493e-09  0              0.095020402    0              0              2.9942467    
   2000000   12000          100            100            0.016957002   -0.019718342    0              0.070589347    2.8123116e-16  0              1.3579646e-08  0              0              2.9942467    
   2100000   12000          100            100            0.016957007   -0.019718343    0              0.070589363    3.5190034e-11  0              0.0016992008   0              0              2.9942467    
   2200000   12000          100            100            0.016957008   -0.019718343    0              0.070589368    2.4182993e-12  0              0.00011677102  0              0              2.9942467    
   2300000   12000          100            100            0.016957008   -0.019718343    0              0.070589367    1.4649439e-13  0              7.0736899e-06  0              0              2.9942467    
   2400000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    9.5310329e-14  0              4.6021947e-06  0              0              2.9942467    
   2500000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    8.4489492e-16  0              4.0796952e-08  0              0              2.9942467    
   2600000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    1.1454872e-15  0              5.5311476e-08  0              0              2.9942467    
   2700000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    2.2783217e-16  0              1.10012e-08    0              0              2.9942467    
   2800000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    1.444781e-17   0              6.9763302e-10  0              0              2.9942467    
   2900000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    2.0957249e-17  0              1.0119506e-09  0              0              2.9942467    
   3000000   12000          100            100            0.016957008   -0.019718343    0              0.070589366    1.644488e-18   0              7.9406442e-11  0              0              2.9942467    
Loop time of 544.99 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4756049.552 ns/day, 0.000 hours/ns, 5504.687 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.037     | 102.31     | 134.75     | 315.7 | 18.77
Neigh   | 1.833      | 1.8493     | 1.8659     |   0.9 |  0.34
Comm    | 23.746     | 55.234     | 88.645     | 421.3 | 10.13
Output  | 0.47969    | 0.48011    | 0.48055    |   0.1 |  0.09
Modify  | 266.47     | 307.62     | 347.65     | 227.8 | 56.45
Other   |            | 77.5       |            |       | 14.22

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.01904277     1.2403874e-16  0              0.057128309    1639373.1      0              7.9159458e+13  0              0              3.3296138    
    200000   12000          100            100            0.0065546024   1.2403874e-16  0              0.019663807    381769         0              1.8434259e+13  0              0              3.0792683    
    300000   12000          100            100            0.00014053221  1.2403874e-16  0              0.00042159664  383.16633      0              1.8501731e+10  0              0              3.0443319    
    400000   12000          100            100            0.00037856075  1.2403874e-16  0              0.0011356823   2701.783       0              1.3045943e+11  0              0              3.0049925    
    500000   12000          100            100            0.022398297   -0.020092886    0              0.087287777    3863.7566      0              1.8656698e+11  0              0              2.9938671    
    600000   12000          100            100            0.015385508   -0.016175176    0              0.062331701    480.5048       0              2.3201857e+10  0              0              2.9947986    
    700000   12000          100            100            0.017534212   -0.019653866    0              0.072256502    69.634962      0              3.3624231e+09  0              0              2.9943839    
    800000   12000          100            100            0.017694573   -0.020052484    0              0.073136203    4.5659586      0              2.204738e+08   0              0              2.9943446    
    900000   12000          100            100            0.017239533   -0.020141285    0              0.071859885    0.01443987     0              697249.66      0              0              2.9943926    
   1000000   12000          100            100            0.016960188   -0.020107185    0              0.07098775     0.046154987    0              2228659.1      0              0              2.9944265    
   1100000   12000          100            100            0.016858965   -0.020076699    0              0.070653596    0.019780523    0              955130.65      0              0              2.9944398    
   1200000   12000          100            100            0.016834693   -0.020071888    0              0.070575969    0.0027980641   0              135108.5       0              0              2.9944429    
   1300000   12000          100            100            0.016834575   -0.020071833    0              0.070575558    0.00014133612  0              6824.6155      0              0              2.994443     
   1400000   12000          100            100            0.01683781    -0.020072268    0              0.070585697    3.0446174e-08  0              1.4701368      0              0              2.9944426    
   1500000   12000          100            100            0.016839703   -0.020072527    0              0.070591636    2.8577167e-06  0              137.98891      0              0              2.9944423    
   1600000   12000          100            100            0.016840369   -0.020072619    0              0.070593725    9.1646678e-07  0              44.252901      0              0              2.9944422    
   1700000   12000          100            100            0.016840502   -0.020072638    0              0.070594143    1.0848181e-07  0              5.2381983      0              0              2.9944422    
   1800000   12000          100            100            0.01684049    -0.020072637    0              0.070594106    3.9808281e-09  0              0.19221994     0              0              2.9944422    
   1900000   12000          100            100            0.016840465   -0.020072634    0              0.070594029    5.5157129e-11  0              0.0026633404   0              0              2.9944422    
   2000000   12000          100            100            0.016840452   -0.020072632    0              0.070593989    1.623772e-10   0              0.0078406138   0              0              2.9944422    
   2100000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    4.0952734e-11  0              0.001977461    0              0              2.9944422    
   2200000   12000          100            100            0.016840448   -0.020072631    0              0.070593974    4.0353645e-12  0              0.00019485331  0              0              2.9944422    
   2300000   12000          100            100            0.016840448   -0.020072631    0              0.070593975    9.6208547e-14  0              4.6455664e-06  0              0              2.9944422    
   2400000   12000          100            100            0.016840448   -0.020072631    0              0.070593975    7.6476573e-15  0              3.69278e-07    0              0              2.9944422    
   2500000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    8.4554659e-15  0              4.0828419e-07  0              0              2.9944422    
   2600000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    1.7757953e-15  0              8.5746798e-08  0              0              2.9944422    
   2700000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    4.0839694e-17  0              1.9720027e-09  0              0              2.9944422    
   2800000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    1.4323177e-17  0              6.9161493e-10  0              0              2.9944422    
   2900000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    2.6620362e-18  0              1.285402e-10   0              0              2.9944422    
   3000000   12000          100            100            0.016840448   -0.020072631    0              0.070593976    1.2771486e-17  0              6.1668935e-10  0              0              2.9944422    
Loop time of 543.359 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4770322.514 ns/day, 0.000 hours/ns, 5521.207 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.099     | 101.54     | 132.89     | 309.7 | 18.69
Neigh   | 1.83       | 1.8457     | 1.8609     |   0.9 |  0.34
Comm    | 23.853     | 55.491     | 86.583     | 413.2 | 10.21
Output  | 0.48022    | 0.48061    | 0.48102    |   0.1 |  0.09
Modify  | 266.22     | 307.09     | 347.87     | 228.9 | 56.52
Other   |            | 76.91      |            |       | 14.15

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019062624    1.2403874e-16  0              0.057187871    1641910.4      0              7.9281979e+13  0              0              3.328968     
    200000   12000          100            100            0.0065987888   1.2403874e-16  0              0.019796366    385801.89      0              1.8628992e+13  0              0              3.0781784    
    300000   12000          100            100            0.00020709503  1.2403874e-16  0              0.00062128508  818.69219      0              3.9531716e+10  0              0              3.0445945    
    400000   12000          100            100            0.00055180548  1.2403874e-16  0              0.0016554164   5546.9541      0              2.6784256e+11  0              0              3.0042378    
    500000   12000          100            100            0.042516129   -0.027076308    0              0.1546247      20.412684      0              9.8565544e+08  0              0              2.9920231    
    600000   12000          100            100            0.020523798   -0.020907026    0              0.08247842     443.38158      0              2.140931e+10   0              0              2.9941671    
    700000   12000          100            100            0.014560759   -0.017480917    0              0.061163194    1.2112453      0              58486700       0              0              2.9949936    
    800000   12000          100            100            0.018333597   -0.01846618     0              0.073466972    3.57128        0              1.7244433e+08  0              0              2.9945121    
    900000   12000          100            100            0.017259769   -0.018592092    0              0.0703714      1.2618042      0              60928007       0              0              2.9946269    
   1000000   12000          100            100            0.017236688   -0.018624496    0              0.070334561    0.11863353     0              5728388.8      0              0              2.9946295    
   1100000   12000          100            100            0.01737553    -0.018641043    0              0.070767632    0.0010996074   0              53096.104      0              0              2.9946127    
   1200000   12000          100            100            0.017304451   -0.018629794    0              0.070543147    0.00080706596  0              38970.327      0              0              2.9946213    
   1300000   12000          100            100            0.017324158   -0.01863232     0              0.070604794    0.00038293867  0              18490.738      0              0              2.9946189    
   1400000   12000          100            100            0.017323245   -0.018632225    0              0.070601961    4.3902643e-05  0              2119.9015      0              0              2.994619     
   1500000   12000          100            100            0.017321096   -0.018631938    0              0.070595226    8.3389346e-07  0              40.265731      0              0              2.9946193    
   1600000   12000          100            100            0.017322363   -0.018632104    0              0.070599193    1.5963805e-07  0              7.7083499      0              0              2.9946191    
   1700000   12000          100            100            0.017321976   -0.018632054    0              0.07059798     1.1221447e-07  0              5.418435       0              0              2.9946192    
   1800000   12000          100            100            0.017322013   -0.018632058    0              0.070598096    1.5634604e-08  0              0.75493906     0              0              2.9946192    
   1900000   12000          100            100            0.017322045   -0.018632063    0              0.070598197    4.7606403e-10  0              0.022987428    0              0              2.9946192    
   2000000   12000          100            100            0.017322023   -0.01863206     0              0.070598128    2.5972748e-11  0              0.001254131    0              0              2.9946192    
   2100000   12000          100            100            0.01732203    -0.018632061    0              0.070598151    3.1739645e-11  0              0.0015325938   0              0              2.9946192    
   2200000   12000          100            100            0.017322029   -0.01863206     0              0.070598148    5.3802044e-12  0              0.00025979081  0              0              2.9946192    
   2300000   12000          100            100            0.017322029   -0.01863206     0              0.070598146    2.3219546e-13  0              1.1211888e-05  0              0              2.9946192    
   2400000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    2.8209557e-15  0              1.3621385e-07  0              0              2.9946192    
   2500000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    8.61195e-15    0              4.1584024e-07  0              0              2.9946192    
   2600000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    1.8119804e-15  0              8.7494049e-08  0              0              2.9946192    
   2700000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    1.9387288e-16  0              9.3614273e-09  0              0              2.9946192    
   2800000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    2.1050111e-17  0              1.0164345e-09  0              0              2.9946192    
   2900000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    3.1556545e-19  0              1.5237526e-11  0              0              2.9946192    
   3000000   12000          100            100            0.017322029   -0.01863206     0              0.070598147    6.4767282e-18  0              3.1273803e-10  0              0              2.9946192    
Loop time of 546.294 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4744698.799 ns/day, 0.000 hours/ns, 5491.550 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.191     | 102.67     | 135.86     | 318.1 | 18.79
Neigh   | 1.8318     | 1.8474     | 1.8627     |   0.9 |  0.34
Comm    | 25.388     | 56.946     | 90.195     | 415.6 | 10.42
Output  | 0.48064    | 0.48103    | 0.48144    |   0.1 |  0.09
Modify  | 265.02     | 306.91     | 346.76     | 227.2 | 56.18
Other   |            | 77.44      |            |       | 14.18

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019080881    1.2403874e-16  0              0.057242643    1644245.4      0              7.9394724e+13  0              0              3.3283721    
    200000   12000          100            100            0.0066394806   1.2403874e-16  0              0.019918442    389527.66      0              1.8808897e+13  0              0              3.0771668    
    300000   12000          100            100            0.0002688959   1.2403874e-16  0              0.00080668769  1361.271       0              6.5730907e+10  0              0              3.0447851    
    400000   12000          100            100            0.00071375495  1.2403874e-16  0              0.0021412648   9005.2517      0              4.3483138e+11  0              0              3.0032327    
    500000   12000          100            100            0.017879953   -0.029698351    0              0.083338211    4049.6086      0              1.9554111e+11  0              0              2.9942836    
    600000   12000          100            100            0.012239972   -0.01295855     0              0.049678466    189.31563      0              9.1413745e+09  0              0              2.9956364    
    700000   12000          100            100            0.017689609   -0.018970722    0              0.072039549    72.424656      0              3.4971275e+09  0              0              2.9947207    
    800000   12000          100            100            0.018256027   -0.018260589    0              0.073028671    5.6415143      0              2.7240853e+08  0              0              2.9946929    
    900000   12000          100            100            0.017033413   -0.018176346    0              0.069276584    0.004845586    0              233976.01      0              0              2.9948297    
   1000000   12000          100            100            0.017537391   -0.018260946    0              0.070873119    0.12055621     0              5821227.7      0              0              2.99477      
   1100000   12000          100            100            0.017470384   -0.018247471    0              0.070658622    0.021370396    0              1031899.9      0              0              2.9947783    
   1200000   12000          100            100            0.017433172   -0.01824079     0              0.070540305    0.00035321941  0              17055.701      0              0              2.9947826    
   1300000   12000          100            100            0.017458773   -0.018245531    0              0.07062185     0.00012481333  0              6026.7888      0              0              2.9947795    
   1400000   12000          100            100            0.017452334   -0.018244314    0              0.070601316    5.6195394e-05  0              2713.4745      0              0              2.9947803    
   1500000   12000          100            100            0.01745178    -0.018244224    0              0.070599563    3.416506e-06   0              164.97085      0              0              2.9947804    
   1600000   12000          100            100            0.017452888   -0.018244427    0              0.070603092    3.1890561e-08  0              1.5398811      0              0              2.9947802    
   1700000   12000          100            100            0.017452468   -0.018244348    0              0.070601753    1.0686553e-07  0              5.1601541      0              0              2.9947803    
   1800000   12000          100            100            0.017452507   -0.018244356    0              0.070601878    1.4856404e-08  0              0.71736257     0              0              2.9947803    
   1900000   12000          100            100            0.017452546   -0.018244363    0              0.070602001    1.1282747e-10  0              0.0054480346   0              0              2.9947803    
   2000000   12000          100            100            0.017452524   -0.018244359    0              0.070601929    1.3383595e-10  0              0.0064624592   0              0              2.9947803    
   2100000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    4.3289543e-11  0              0.0020902971   0              0              2.9947803    
   2200000   12000          100            100            0.017452529   -0.01824436     0              0.070601948    1.9237607e-12  0              9.2891521e-05  0              0              2.9947803    
   2300000   12000          100            100            0.017452528   -0.01824436     0              0.070601944    6.8679326e-14  0              3.3162788e-06  0              0              2.9947803    
   2400000   12000          100            100            0.017452529   -0.01824436     0              0.070601946    9.1047522e-14  0              4.396359e-06   0              0              2.9947803    
   2500000   12000          100            100            0.017452529   -0.01824436     0              0.070601945    1.0199921e-14  0              4.9251768e-07  0              0              2.9947803    
   2600000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    7.1664162e-18  0              3.4604059e-10  0              0              2.9947803    
   2700000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    2.1666444e-16  0              1.046195e-08   0              0              2.9947803    
   2800000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    1.5423002e-18  0              7.4472155e-11  0              0              2.9947803    
   2900000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    6.858967e-18   0              3.3119497e-10  0              0              2.9947803    
   3000000   12000          100            100            0.017452528   -0.01824436     0              0.070601945    4.0252609e-18  0              1.9436545e-10  0              0              2.9947803    
Loop time of 547.9 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4730790.513 ns/day, 0.000 hours/ns, 5475.452 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.323     | 103.01     | 138.74     | 320.8 | 18.80
Neigh   | 1.8452     | 1.8606     | 1.877      |   0.9 |  0.34
Comm    | 25.016     | 58.003     | 93.25      | 409.1 | 10.59
Output  | 0.48345    | 0.48384    | 0.48426    |   0.1 |  0.09
Modify  | 263.83     | 307.31     | 346.66     | 224.4 | 56.09
Other   |            | 77.23      |            |       | 14.10

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019097754    1.2403874e-16  0              0.057293261    1646404.6      0              7.9498986e+13  0              0              3.3278196    
    200000   12000          100            100            0.0066771355   1.2403874e-16  0              0.020031406    392985.46      0              1.8975861e+13  0              0              3.0762239    
    300000   12000          100            100            0.00032650441  1.2403874e-16  0              0.00097951323  1982.5175      0              9.5728676e+10  0              0              3.0449181    
    400000   12000          100            100            0.00086551888  1.2403874e-16  0              0.0025965566   12891.196      0              6.224697e+11   0              0              3.0020455    
    500000   12000          100            100            0.0060480316  -0.0025739177   0              0.020718013    1748.2821      0              8.4418288e+10  0              0              2.9971992    
    600000   12000          100            100            0.02622025    -0.021508136    0              0.10016889     6.9760581      0              3.3684888e+08  0              0              2.9939534    
    700000   12000          100            100            0.019731234   -0.019268407    0              0.07846211     32.972105      0              1.5921049e+09  0              0              2.9946563    
    800000   12000          100            100            0.017760936   -0.018178566    0              0.071461375    9.5633857      0              4.6178167e+08  0              0              2.9948993    
    900000   12000          100            100            0.017266456   -0.018327986    0              0.070127353    1.170279       0              56508586       0              0              2.9949458    
   1000000   12000          100            100            0.017303623   -0.018291813    0              0.070202681    0.060922296    0              2941719.6      0              0              2.9949424    
   1100000   12000          100            100            0.017369918   -0.018313433    0              0.070423187    4.2526711e-05  0              2053.4627      0              0              2.9949343    
   1200000   12000          100            100            0.017409454   -0.018319391    0              0.070547754    0.00084295334  0              40703.2        0              0              2.9949298    
   1300000   12000          100            100            0.017424074   -0.018322285    0              0.070594507    0.00034778156  0              16793.127      0              0              2.9949281    
   1400000   12000          100            100            0.017427813   -0.018323016    0              0.070606456    5.6737344e-05  0              2739.6433      0              0              2.9949277    
   1500000   12000          100            100            0.017428147   -0.018323075    0              0.070607515    4.4781499e-06  0              216.23383      0              0              2.9949276    
   1600000   12000          100            100            0.01742785    -0.018323013    0              0.070606564    8.2750499e-08  0              3.9957254      0              0              2.9949277    
   1700000   12000          100            100            0.017427624   -0.018322968    0              0.070605841    1.1460742e-08  0              0.55339823     0              0              2.9949277    
   1800000   12000          100            100            0.017427526   -0.018322948    0              0.070605525    1.0824388e-08  0              0.52267096     0              0              2.9949277    
   1900000   12000          100            100            0.017427495   -0.018322942    0              0.070605428    2.4377251e-09  0              0.11770902     0              0              2.9949277    
   2000000   12000          100            100            0.01742749    -0.018322941    0              0.070605411    2.6586177e-10  0              0.012837513    0              0              2.9949277    
   2100000   12000          100            100            0.017427491   -0.018322941    0              0.070605414    1.140055e-11   0              0.00055049174  0              0              2.9949277    
   2200000   12000          100            100            0.017427492   -0.018322941    0              0.070605418    1.3251905e-14  0              6.3988707e-07  0              0              2.9949277    
   2300000   12000          100            100            0.017427493   -0.018322941    0              0.07060542     2.7146275e-13  0              1.3107965e-05  0              0              2.9949277    
   2400000   12000          100            100            0.017427493   -0.018322942    0              0.07060542     9.2473237e-14  0              4.4652017e-06  0              0              2.9949277    
   2500000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    1.3490705e-14  0              6.5141787e-07  0              0              2.9949277    
   2600000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    9.3808496e-16  0              4.5296765e-08  0              0              2.9949277    
   2700000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    6.8825806e-17  0              3.3233518e-09  0              0              2.9949277    
   2800000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    1.0994753e-17  0              5.3089726e-10  0              0              2.9949277    
   2900000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    5.5582988e-18  0              2.6839036e-10  0              0              2.9949277    
   3000000   12000          100            100            0.017427493   -0.018322942    0              0.070605421    3.2405643e-18  0              1.5647525e-10  0              0              2.9949277    
Loop time of 543.743 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4766960.654 ns/day, 0.000 hours/ns, 5517.316 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.426     | 102.02     | 134.54     | 312.9 | 18.76
Neigh   | 1.8072     | 1.8237     | 1.8398     |   0.9 |  0.34
Comm    | 23.839     | 55.009     | 88.134     | 416.8 | 10.12
Output  | 0.48075    | 0.48115    | 0.48157    |   0.1 |  0.09
Modify  | 265.16     | 306.72     | 347.46     | 227.6 | 56.41
Other   |            | 77.68      |            |       | 14.29

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019113415    1.2403874e-16  0              0.057340245    1648410.1      0              7.9595822e+13  0              0              3.3273052    
    200000   12000          100            100            0.0067121305   1.2403874e-16  0              0.020136392    396207.67      0              1.913145e+13   0              0              3.0753418    
    300000   12000          100            100            0.00038039918  1.2403874e-16  0              0.0011411975   2661.2538      0              1.2850242e+11  0              0              3.0450045    
    400000   12000          100            100            0.0010080808   1.2403874e-16  0              0.0030242424   17070.577      0              8.2427706e+11  0              0              3.0007267    
    500000   12000          100            100            0.0026918081  -0.002407266    0              0.01048269     75.443691      0              3.6429058e+09  0              0              2.9981152    
    600000   12000          100            100            0.011118231   -0.014128561    0              0.047483253    155.54938      0              7.5109228e+09  0              0              2.9959423    
    700000   12000          100            100            0.014502581   -0.017019677    0              0.06052742     1.2763432      0              61630047       0              0              2.995431     
    800000   12000          100            100            0.016920929   -0.017929242    0              0.06869203     7.5216975      0              3.6319585e+08  0              0              2.995133     
    900000   12000          100            100            0.017565869   -0.018458203    0              0.07115581     1.1637315      0              56192429       0              0              2.9950449    
   1000000   12000          100            100            0.017546248   -0.018467208    0              0.071105953    0.010014886    0              483583         0              0              2.995046     
   1100000   12000          100            100            0.017430748   -0.018457453    0              0.070749695    0.01026279     0              495553.39      0              0              2.9950583    
   1200000   12000          100            100            0.017384389   -0.018449745    0              0.070602913    0.003254456    0              157146.03      0              0              2.9950635    
   1300000   12000          100            100            0.01737954    -0.018448662    0              0.070587281    0.00012167284  0              5875.1458      0              0              2.995064     
   1400000   12000          100            100            0.017383566   -0.018449485    0              0.070600184    8.3074163e-06  0              401.1354       0              0              2.9950636    
   1500000   12000          100            100            0.017385951   -0.018449985    0              0.070607839    7.391861e-06   0              356.92651      0              0              2.9950633    
   1600000   12000          100            100            0.01738644    -0.018450091    0              0.070609411    6.1765434e-07  0              29.824317      0              0              2.9950633    
   1700000   12000          100            100            0.017386331   -0.018450069    0              0.070609063    6.3643963e-10  0              0.030731392    0              0              2.9950633    
   1800000   12000          100            100            0.017386219   -0.018450046    0              0.070608703    1.3472942e-08  0              0.65056016     0              0              2.9950633    
   1900000   12000          100            100            0.017386185   -0.018450038    0              0.070608595    2.1759911e-09  0              0.10507082     0              0              2.9950633    
   2000000   12000          100            100            0.017386186   -0.018450038    0              0.070608596    2.0847439e-11  0              0.0010066482   0              0              2.9950633    
   2100000   12000          100            100            0.017386191   -0.018450039    0              0.070608611    1.828574e-11   0              0.00088295297  0              0              2.9950633    
   2200000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    6.0218605e-12  0              0.00029077409  0              0              2.9950633    
   2300000   12000          100            100            0.017386193   -0.01845004     0              0.070608618    2.3495758e-13  0              1.1345261e-05  0              0              2.9950633    
   2400000   12000          100            100            0.017386193   -0.01845004     0              0.070608618    1.4509204e-14  0              7.0059752e-07  0              0              2.9950633    
   2500000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    1.3541681e-14  0              6.5387932e-07  0              0              2.9950633    
   2600000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    1.1312681e-15  0              5.4624887e-08  0              0              2.9950633    
   2700000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    3.324888e-17   0              1.6054694e-09  0              0              2.9950633    
   2800000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    2.6654018e-17  0              1.2870271e-09  0              0              2.9950633    
   2900000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    8.7832796e-18  0              4.2411314e-10  0              0              2.9950633    
   3000000   12000          100            100            0.017386192   -0.01845004     0              0.070608617    1.3805766e-17  0              6.6663102e-10  0              0              2.9950633    
Loop time of 546.505 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4742869.025 ns/day, 0.000 hours/ns, 5489.432 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.487     | 101.18     | 133.39     | 314.7 | 18.51
Neigh   | 1.7894     | 1.8045     | 1.8192     |   0.9 |  0.33
Comm    | 25.098     | 56.041     | 88.906     | 413.4 | 10.25
Output  | 0.47973    | 0.48012    | 0.48054    |   0.1 |  0.09
Modify  | 268.1      | 309.84     | 349.85     | 226.6 | 56.69
Other   |            | 77.16      |            |       | 14.12

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.01912801     1.2403874e-16  0              0.057384029    1650279.9      0              7.9686112e+13  0              0              3.3268245    
    200000   12000          100            100            0.0067447787   1.2403874e-16  0              0.020234336    399221.28      0              1.9276967e+13  0              0              3.0745137    
    300000   12000          100            100            0.00043098099  1.2403874e-16  0              0.001292943    3381.4513      0              1.6327818e+11  0              0              3.0450532    
    400000   12000          100            100            0.0016211534  -8.3614015e-06  0              0.0048718216   21431.703      0              1.0348602e+12  0              0              2.9993137    
    500000   12000          100            100            0.0082149481  -0.0045854294   0              0.029230274    2767.8881      0              1.3365141e+11  0              0              2.9969686    
    600000   12000          100            100            0.019145028   -0.016470466    0              0.07390555     578.53633      0              2.7935449e+10  0              0              2.9950947    
    700000   12000          100            100            0.019821119   -0.018580502    0              0.078043858    40.427625      0              1.9521053e+09  0              0              2.9949367    
    800000   12000          100            100            0.016631679   -0.016865842    0              0.066760877    0.015640837    0              755240.02      0              0              2.9953219    
    900000   12000          100            100            0.018055508   -0.01755577     0              0.071722294    0.55679126     0              26885457       0              0              2.9951513    
   1000000   12000          100            100            0.017686408   -0.017463858    0              0.070523082    0.18063342     0              8722141.5      0              0              2.9951913    
   1100000   12000          100            100            0.017682774   -0.017462874    0              0.070511195    0.017737746    0              856492.26      0              0              2.9951921    
   1200000   12000          100            100            0.017734743   -0.017474102    0              0.070678333    0.00025877361  0              12495.252      0              0              2.9951863    
   1300000   12000          100            100            0.017706746   -0.017468188    0              0.070588425    8.1380297e-05  0              3929.5633      0              0              2.9951894    
   1400000   12000          100            100            0.017715127   -0.017469937    0              0.070615318    5.037814e-05   0              2432.5801      0              0              2.9951885    
   1500000   12000          100            100            0.017714281   -0.017469773    0              0.070612616    7.1921808e-06  0              347.28467      0              0              2.9951885    
   1600000   12000          100            100            0.017713622   -0.017469629    0              0.070610496    2.6974822e-07  0              13.025176      0              0              2.9951886    
   1700000   12000          100            100            0.017714097   -0.01746973     0              0.07061202     5.5428992e-09  0              0.26764677     0              0              2.9951886    
   1800000   12000          100            100            0.017713925   -0.017469694    0              0.070611469    1.2175669e-08  0              0.58791947     0              0              2.9951886    
   1900000   12000          100            100            0.017713955   -0.0174697      0              0.070611567    2.550553e-09   0              0.12315708     0              0              2.9951886    
   2000000   12000          100            100            0.017713962   -0.017469702    0              0.070611587    1.6646929e-10  0              0.008038206    0              0              2.9951886    
   2100000   12000          100            100            0.017713954   -0.0174697      0              0.070611563    9.5689107e-14  0              4.6204845e-06  0              0              2.9951886    
   2200000   12000          100            100            0.017713957   -0.017469701    0              0.070611573    2.4280194e-12  0              0.00011724037  0              0              2.9951886    
   2300000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    8.0191482e-13  0              3.8721596e-05  0              0              2.9951886    
   2400000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    7.8917555e-14  0              3.8106463e-06  0              0              2.9951886    
   2500000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    1.1167593e-15  0              5.3924309e-08  0              0              2.9951886    
   2600000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    3.0379304e-16  0              1.4669079e-08  0              0              2.9951886    
   2700000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    1.4768346e-16  0              7.1311055e-09  0              0              2.9951886    
   2800000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    1.412497e-17   0              6.8204426e-10  0              0              2.9951886    
   2900000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    1.5735919e-18  0              7.5983122e-11  0              0              2.9951886    
   3000000   12000          100            100            0.017713957   -0.017469701    0              0.070611571    1.5485914e-18  0              7.4775935e-11  0              0              2.9951886    
Loop time of 545.826 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4748770.199 ns/day, 0.000 hours/ns, 5496.262 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.52      | 102.51     | 136.13     | 312.0 | 18.78
Neigh   | 1.8151     | 1.8427     | 1.8716     |   1.5 |  0.34
Comm    | 25.416     | 56.855     | 92.105     | 403.9 | 10.42
Output  | 0.4817     | 0.48209    | 0.48251    |   0.1 |  0.09
Modify  | 263.91     | 306.59     | 346.27     | 224.6 | 56.17
Other   |            | 77.55      |            |       | 14.21

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019141659    1.2403874e-16  0              0.057424976    1652029.6      0              7.9770595e+13  0              0              3.3263739    
    200000   12000          100            100            0.0067753428   1.2403874e-16  0              0.020326028    402049.08      0              1.9413511e+13  0              0              3.0737341    
    300000   12000          100            100            0.00047859377  1.2403874e-16  0              0.0014357813   4130.9297      0              1.9946781e+11  0              0              3.045071     
    400000   12000          100            100            0.0060432128  -0.00061563246  0              0.018745271    25498.575      0              1.2312349e+12  0              0              2.9978397    
    500000   12000          100            100            0.023282394   -0.019956561    0              0.089803744    4201.9778      0              2.0289847e+11  0              0              2.9947461    
    600000   12000          100            100            0.022608056   -0.022694293    0              0.090518461    344.49344      0              1.6634355e+10  0              0              2.9946708    
    700000   12000          100            100            0.016802663   -0.016943536    0              0.067351526    71.101033      0              3.4332144e+09  0              0              2.9954208    
    800000   12000          100            100            0.017417789   -0.01680854     0              0.069061907    8.9502578      0              4.3217592e+08  0              0              2.9953546    
    900000   12000          100            100            0.018275797   -0.01709235     0              0.07191974     0.28465649     0              13745043       0              0              2.9952618    
   1000000   12000          100            100            0.017721197   -0.016939262    0              0.070102851    0.012279616    0              592938.71      0              0              2.9953219    
   1100000   12000          100            100            0.017908137   -0.016996836    0              0.070721246    0.017373322    0              838895.53      0              0              2.9953011    
   1200000   12000          100            100            0.017877593   -0.016991164    0              0.070623942    0.0033212204   0              160369.85      0              0              2.9953044    
   1300000   12000          100            100            0.017868401   -0.016989448    0              0.070594651    0.00019788552  0              9555.1836      0              0              2.9953054    
   1400000   12000          100            100            0.017877534   -0.01699123     0              0.070623831    3.2821567e-10  0              0.01584836     0              0              2.9953044    
   1500000   12000          100            100            0.017873746   -0.016990468    0              0.070611705    3.5127765e-06  0              169.61941      0              0              2.9953048    
   1600000   12000          100            100            0.017874607   -0.016990646    0              0.070614465    1.0673086e-06  0              51.536514      0              0              2.9953047    
   1700000   12000          100            100            0.01787464    -0.016990651    0              0.070614571    1.0055279e-07  0              4.8553344      0              0              2.9953047    
   1800000   12000          100            100            0.017874506   -0.016990624    0              0.070614143    1.2970135e-09  0              0.062628142    0              0              2.9953047    
   1900000   12000          100            100            0.017874575   -0.016990638    0              0.070614365    5.1366607e-10  0              0.024803096    0              0              2.9953047    
   2000000   12000          100            100            0.017874555   -0.016990634    0              0.0706143      2.9882816e-10  0              0.014429342    0              0              2.9953047    
   2100000   12000          100            100            0.017874557   -0.016990634    0              0.070614306    4.1878743e-11  0              0.0020221746   0              0              2.9953047    
   2200000   12000          100            100            0.017874559   -0.016990635    0              0.070614311    1.5459395e-12  0              7.4647887e-05  0              0              2.9953047    
   2300000   12000          100            100            0.017874558   -0.016990634    0              0.070614308    3.3440155e-14  0              1.6147054e-06  0              0              2.9953047    
   2400000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    7.167335e-14   0              3.4608495e-06  0              0              2.9953047    
   2500000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    1.4969186e-14  0              7.2280842e-07  0              0              2.9953047    
   2600000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    9.3401083e-16  0              4.510004e-08   0              0              2.9953047    
   2700000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    1.3846477e-17  0              6.6859682e-10  0              0              2.9953047    
   2800000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    3.6331861e-17  0              1.7543355e-09  0              0              2.9953047    
   2900000   12000          100            100            0.017874558   -0.016990635    0              0.070614309    1.7578925e-17  0              8.488234e-10   0              0              2.9953047    
   3000000   12000          100            100            0.017874558   -0.016990634    0              0.070614309    1.8394607e-19  0              8.8820973e-12  0              0              2.9953047    
Loop time of 543.21 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4771633.713 ns/day, 0.000 hours/ns, 5522.724 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.255     | 101.69     | 134.48     | 319.1 | 18.72
Neigh   | 1.8248     | 1.8413     | 1.8568     |   0.9 |  0.34
Comm    | 25.233     | 56.752     | 90.25      | 418.5 | 10.45
Output  | 0.48075    | 0.48113    | 0.48156    |   0.1 |  0.09
Modify  | 264.56     | 305.93     | 345.54     | 226.5 | 56.32
Other   |            | 76.52      |            |       | 14.09

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019154464    1.2403874e-16  0              0.057463391    1653671.9      0              7.9849896e+13  0              0              3.32595      
    200000   12000          100            100            0.0068040455   1.2403874e-16  0              0.020412136    404710.4       0              1.9542017e+13  0              0              3.0729981    
    300000   12000          100            100            0.00052353302  1.2403874e-16  0              0.0015705991   4900.3559      0              2.3662065e+11  0              0              3.0450634    
    400000   12000          100            100            0.014182537   -0.0062377912   0              0.048785402    28230.044      0              1.3631278e+12  0              0              2.9963491    
    500000   12000          100            100            0.043216969   -0.029311176    0              0.15896208     666.45948      0              3.2180943e+10  0              0              2.9931206    
    600000   12000          100            100            0.01051359    -0.01149054     0              0.043031312    22.228215      0              1.073321e+09   0              0              2.9964167    
    700000   12000          100            100            0.017803115   -0.016340326    0              0.06974967     79.352961      0              3.8316705e+09  0              0              2.9954351    
    800000   12000          100            100            0.018978479   -0.017176784    0              0.074112222    2.7255394      0              1.3160654e+08  0              0              2.9952994    
    900000   12000          100            100            0.018370917   -0.016781264    0              0.071894015    0.37738407     0              18222526       0              0              2.9953719    
   1000000   12000          100            100            0.017950077   -0.016758257    0              0.070608488    0.1907081      0              9208611.7      0              0              2.9954134    
   1100000   12000          100            100            0.017898237   -0.016748933    0              0.070443644    0.0057897833   0              279567.91      0              0              2.9954186    
   1200000   12000          100            100            0.017933738   -0.016753759    0              0.070554972    0.00095097677  0              45919.265      0              0              2.9954149    
   1300000   12000          100            100            0.017953479   -0.016757141    0              0.070617579    0.00045809439  0              22119.739      0              0              2.9954128    
   1400000   12000          100            100            0.017955955   -0.016757546    0              0.070625412    1.3288889e-05  0              641.67289      0              0              2.9954126    
   1500000   12000          100            100            0.01795421    -0.016757239    0              0.07061987     2.3796811e-06  0              114.90629      0              0              2.9954128    
   1600000   12000          100            100            0.017953245   -0.016757073    0              0.070616807    1.1001009e-06  0              53.119934      0              0              2.9954129    
   1700000   12000          100            100            0.017953127   -0.016757054    0              0.070616436    3.0437086e-08  0              1.469698       0              0              2.9954129    
   1800000   12000          100            100            0.017953214   -0.016757069    0              0.070616712    5.9465146e-09  0              0.28713591     0              0              2.9954129    
   1900000   12000          100            100            0.017953262   -0.016757077    0              0.070616862    2.6409999e-09  0              0.12752443     0              0              2.9954129    
   2000000   12000          100            100            0.017953267   -0.016757078    0              0.070616879    6.9612427e-11  0              0.003361335    0              0              2.9954129    
   2100000   12000          100            100            0.017953263   -0.016757077    0              0.070616865    1.4845457e-11  0              0.00071683397  0              0              2.9954129    
   2200000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    6.3370407e-12  0              0.00030599302  0              0              2.9954129    
   2300000   12000          100            100            0.01795326    -0.016757077    0              0.070616857    1.586704e-13   0              7.6616259e-06  0              0              2.9954129    
   2400000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    3.6709493e-14  0              1.77257e-06    0              0              2.9954129    
   2500000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    1.5217758e-14  0              7.3481109e-07  0              0              2.9954129    
   2600000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    3.8020688e-16  0              1.8358829e-08  0              0              2.9954129    
   2700000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    3.1198281e-17  0              1.5064533e-09  0              0              2.9954129    
   2800000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    8.6730699e-18  0              4.187915e-10   0              0              2.9954129    
   2900000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    2.2500149e-18  0              1.0864517e-10  0              0              2.9954129    
   3000000   12000          100            100            0.01795326    -0.016757077    0              0.070616858    2.1207546e-17  0              1.0240365e-09  0              0              2.9954129    
Loop time of 543.815 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4766325.036 ns/day, 0.000 hours/ns, 5516.580 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.944     | 101.21     | 134.53     | 310.9 | 18.61
Neigh   | 1.8066     | 1.825      | 1.8432     |   1.0 |  0.34
Comm    | 25.067     | 56.258     | 90.481     | 403.1 | 10.35
Output  | 0.47989    | 0.4803     | 0.48073    |   0.1 |  0.09
Modify  | 265.53     | 307.58     | 347.96     | 224.0 | 56.56
Other   |            | 76.46      |            |       | 14.06

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019166512    1.2403874e-16  0              0.057499537    1655217.8      0              7.9924545e+13  0              0              3.3255503    
    200000   12000          100            100            0.0068310778   1.2403874e-16  0              0.020493233    407221.92      0              1.9663289e+13  0              0              3.0723015    
    300000   12000          100            100            0.0005660538   1.2403874e-16  0              0.0016981614   5682.5296      0              2.7438902e+11  0              0              3.0450349    
    400000   12000          100            100            0.025663585   -0.018195968    0              0.095186725    28532.379      0              1.3777264e+12  0              0              2.9949017    
    500000   12000          100            100            0.04031817    -0.031124037    0              0.15207855     1260.7331      0              6.087629e+10   0              0              2.9933926    
    600000   12000          100            100            0.020128345   -0.015739903    0              0.076124937    590.24968      0              2.8501045e+10  0              0              2.995358     
    700000   12000          100            100            0.018666084   -0.017130096    0              0.07312835     77.084586      0              3.7221388e+09  0              0              2.9954406    
    800000   12000          100            100            0.018634088   -0.016626353    0              0.072528616    8.5500426      0              4.1285096e+08  0              0              2.9954555    
    900000   12000          100            100            0.018376197   -0.016519296    0              0.071647888    0.78320174     0              37818009       0              0              2.9954819    
   1000000   12000          100            100            0.018211002   -0.016453371    0              0.071086378    0.055837974    0              2696215.9      0              0              2.9954992    
   1100000   12000          100            100            0.018124787   -0.016437013    0              0.070811373    0.0024903525   0              120250.21      0              0              2.9955078    
   1200000   12000          100            100            0.018087396   -0.016430676    0              0.070692864    1.5918486e-05  0              768.6467       0              0              2.9955115    
   1300000   12000          100            100            0.018072508   -0.016428237    0              0.07064576     1.479819e-05   0              714.55165      0              0              2.995513     
   1400000   12000          100            100            0.01806696    -0.016427321    0              0.070628201    1.0661127e-05  0              514.78768      0              0              2.9955136    
   1500000   12000          100            100            0.018065017   -0.016426998    0              0.070622048    3.2483995e-06  0              156.85359      0              0              2.9955138    
   1600000   12000          100            100            0.01806438    -0.016426892    0              0.070620032    7.087948e-07   0              34.225164      0              0              2.9955139    
   1700000   12000          100            100            0.018064189   -0.01642686     0              0.070619426    1.2682993e-07  0              6.1241634      0              0              2.9955139    
   1800000   12000          100            100            0.018064138   -0.016426851    0              0.070619266    1.9598705e-08  0              0.94635132     0              0              2.9955139    
   1900000   12000          100            100            0.018064128   -0.016426849    0              0.070619233    2.6686133e-09  0              0.12885779     0              0              2.9955139    
   2000000   12000          100            100            0.018064128   -0.016426849    0              0.070619232    3.208325e-10   0              0.015491853    0              0              2.9955139    
   2100000   12000          100            100            0.018064129   -0.016426849    0              0.070619235    3.3556224e-11  0              0.0016203099   0              0              2.9955139    
   2200000   12000          100            100            0.018064129   -0.016426849    0              0.070619237    2.9294835e-12  0              0.00014145427  0              0              2.9955139    
   2300000   12000          100            100            0.01806413    -0.016426849    0              0.070619239    1.92291e-13    0              9.2850441e-06  0              0              2.9955139    
   2400000   12000          100            100            0.01806413    -0.016426849    0              0.070619239    6.8340881e-15  0              3.2999366e-07  0              0              2.9955139    
   2500000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     1.5823933e-18  0              7.6408109e-11  0              0              2.9955139    
   2600000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     1.3047275e-16  0              6.300062e-09   0              0              2.9955139    
   2700000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     1.0943935e-16  0              5.2844344e-09  0              0              2.9955139    
   2800000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     3.7620843e-17  0              1.8165759e-09  0              0              2.9955139    
   2900000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     1.0319597e-17  0              4.9829641e-10  0              0              2.9955139    
   3000000   12000          100            100            0.01806413    -0.016426849    0              0.07061924     1.4003206e-17  0              6.7616469e-10  0              0              2.9955139    
Loop time of 540.636 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4794352.148 ns/day, 0.000 hours/ns, 5549.019 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.57      | 100.87     | 131.55     | 300.6 | 18.66
Neigh   | 1.8221     | 1.8457     | 1.8698     |   1.2 |  0.34
Comm    | 24.948     | 54.693     | 85.801     | 400.0 | 10.12
Output  | 0.47876    | 0.47915    | 0.47956    |   0.1 |  0.09
Modify  | 264.36     | 305.99     | 345.95     | 227.6 | 56.60
Other   |            | 76.75      |            |       | 14.20

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019177879    1.2403874e-16  0              0.057533638    1656677        0              7.9995002e+13  0              0              3.3251724    
    200000   12000          100            100            0.0068566021   1.2403874e-16  0              0.020569806    409597.86      0              1.9778015e+13  0              0              3.0716407    
    300000   12000          100            100            0.00060637612  1.2403874e-16  0              0.0018191284   6471.8398      0              3.1250198e+11  0              0              3.044989     
    400000   12000          100            100            0.041705522   -0.029883108    0              0.15499967     25738.521      0              1.2428211e+12  0              0              2.9935669    
    500000   12000          100            100            0.019023552   -0.026613728    0              0.083684384    4439.215       0              2.143538e+11   0              0              2.9951803    
    600000   12000          100            100            0.024880774   -0.022249245    0              0.096891568    223.06301      0              1.0770915e+10  0              0              2.9948458    
    700000   12000          100            100            0.017171669   -0.01528582     0              0.066800827    72.859613      0              3.51813e+09    0              0              2.9957234    
    800000   12000          100            100            0.016939861   -0.015808883    0              0.066628467    0.72141244     0              34834425       0              0              2.9957352    
    900000   12000          100            100            0.018386213   -0.015875494    0              0.071034132    1.3616476      0              65749090       0              0              2.9955964    
   1000000   12000          100            100            0.018416871   -0.015906702    0              0.071157316    0.016192227    0              781864.7       0              0              2.9955917    
   1100000   12000          100            100            0.018227434   -0.015873422    0              0.070555722    0.023672333    0              1143052.3      0              0              2.9956104    
   1200000   12000          100            100            0.018226      -0.015873025    0              0.070551026    0.00040058037  0              19342.593      0              0              2.9956107    
   1300000   12000          100            100            0.018251608   -0.015876824    0              0.070631647    0.0004093329   0              19765.221      0              0              2.9956082    
   1400000   12000          100            100            0.018251303   -0.015876803    0              0.070630713    9.478441e-06   0              457.67999      0              0              2.9956082    
   1500000   12000          100            100            0.018247876   -0.015876298    0              0.070619925    7.0284503e-06  0              339.37871      0              0              2.9956085    
   1600000   12000          100            100            0.018247984   -0.01587631     0              0.070620261    2.1574357e-07  0              10.417485      0              0              2.9956085    
   1700000   12000          100            100            0.018248441   -0.015876378    0              0.0706217      1.1986062e-07  0              5.7876402      0              0              2.9956085    
   1800000   12000          100            100            0.018248417   -0.015876375    0              0.070621627    4.7644605e-09  0              0.23005874     0              0              2.9956085    
   1900000   12000          100            100            0.018248357   -0.015876366    0              0.070621436    2.0292199e-09  0              0.097983765    0              0              2.9956085    
   2000000   12000          100            100            0.018248361   -0.015876366    0              0.070621449    1.0267062e-10  0              0.004957597    0              0              2.9956085    
   2100000   12000          100            100            0.018248369   -0.015876368    0              0.070621475    3.409293e-11   0              0.0016462256   0              0              2.9956085    
   2200000   12000          100            100            0.018248368   -0.015876368    0              0.070621472    2.1664341e-12  0              0.00010460935  0              0              2.9956085    
   2300000   12000          100            100            0.018248367   -0.015876367    0              0.070621469    5.6858065e-13  0              2.7454725e-05  0              0              2.9956085    
   2400000   12000          100            100            0.018248367   -0.015876367    0              0.070621469    4.5503649e-14  0              2.1972084e-06  0              0              2.9956085    
   2500000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     9.1705823e-15  0              4.428146e-07   0              0              2.9956085    
   2600000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     8.7904834e-16  0              4.2446099e-08  0              0              2.9956085    
   2700000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     9.038913e-17   0              4.3645676e-09  0              0              2.9956085    
   2800000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     3.7379512e-17  0              1.8049229e-09  0              0              2.9956085    
   2900000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     3.3724529e-19  0              1.6284368e-11  0              0              2.9956085    
   3000000   12000          100            100            0.018248367   -0.015876367    0              0.07062147     1.109072e-17   0              5.3553117e-10  0              0              2.9956085    
Loop time of 542.391 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4778837.393 ns/day, 0.000 hours/ns, 5531.062 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.23      | 102.31     | 134.42     | 308.2 | 18.86
Neigh   | 1.8157     | 1.8313     | 1.8462     |   0.9 |  0.34
Comm    | 23.848     | 54.63      | 85.827     | 412.3 | 10.07
Output  | 0.48019    | 0.48058    | 0.481      |   0.1 |  0.09
Modify  | 264.64     | 306.04     | 346.23     | 227.9 | 56.42
Other   |            | 77.1       |            |       | 14.21

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.01918863     1.2403874e-16  0              0.057565889    1658057.5      0              8.0061664e+13  0              0              3.3248143    
    200000   12000          100            100            0.0068807607   1.2403874e-16  0              0.020642282    411850.69      0              1.9886796e+13  0              0              3.0710125    
    300000   12000          100            100            0.00064469447  1.2403874e-16  0              0.0019340834   7263.9649      0              3.5075087e+11  0              0              3.0449287    
    400000   12000          100            100            0.061009057   -0.038891526    0              0.2219187      20060.594      0              9.6865429e+11  0              0              2.992416     
    500000   12000          100            100            0.0087698502  -0.0033275281   0              0.029637079    3311.0565      0              1.5987907e+11  0              0              2.9971604    
    600000   12000          100            100            0.011503354   -0.01184569     0              0.046355752    215.13325      0              1.0388015e+10  0              0              2.9965038    
    700000   12000          100            100            0.019223415   -0.015743402    0              0.073413649    78.269865      0              3.7793716e+09  0              0              2.9956186    
    800000   12000          100            100            0.018535463   -0.015445135    0              0.071051525    10.909655      0              5.2678819e+08  0              0              2.9956822    
    900000   12000          100            100            0.018118985   -0.015586486    0              0.069943443    1.1848344      0              57211412       0              0              2.9957188    
   1000000   12000          100            100            0.018473979   -0.015605165    0              0.071027101    0.097104294    0              4688818.8      0              0              2.9956848    
   1100000   12000          100            100            0.018291355   -0.015561907    0              0.070435972    0.0048454937   0              233971.55      0              0              2.9957031    
   1200000   12000          100            100            0.018374006   -0.015577319    0              0.070699338    4.2984962e-05  0              2075.59        0              0              2.995695     
   1300000   12000          100            100            0.018341072   -0.015573048    0              0.070596264    2.2955902e-05  0              1108.4584      0              0              2.9956981    
   1400000   12000          100            100            0.01835265    -0.015574365    0              0.070632314    1.761068e-05   0              850.35673      0              0              2.995697     
   1500000   12000          100            100            0.018349067   -0.015573965    0              0.070621165    5.1232636e-06  0              247.38406      0              0              2.9956974    
   1600000   12000          100            100            0.018349995   -0.015574067    0              0.070624052    1.0096577e-06  0              48.752759      0              0              2.9956973    
   1700000   12000          100            100            0.018349832   -0.01557405     0              0.070623548    1.5395321e-07  0              7.4338494      0              0              2.9956973    
   1800000   12000          100            100            0.018349821   -0.015574048    0              0.07062351     1.8769183e-08  0              0.90629667     0              0              2.9956973    
   1900000   12000          100            100            0.018349851   -0.015574052    0              0.070623604    1.7867943e-09  0              0.086277903    0              0              2.9956973    
   2000000   12000          100            100            0.018349831   -0.01557405     0              0.070623544    1.189289e-10   0              0.005742651    0              0              2.9956973    
   2100000   12000          100            100            0.018349841   -0.015574051    0              0.070623573    3.5530575e-12  0              0.00017156443  0              0              2.9956973    
   2200000   12000          100            100            0.018349837   -0.01557405     0              0.070623561    2.4682221e-14  0              1.1918161e-06  0              0              2.9956973    
   2300000   12000          100            100            0.018349838   -0.01557405     0              0.070623565    1.304142e-13   0              6.2972348e-06  0              0              2.9956973    
   2400000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    5.3328076e-14  0              2.5750219e-06  0              0              2.9956973    
   2500000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    1.2088349e-14  0              5.837031e-07   0              0              2.9956973    
   2600000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    2.0644807e-15  0              9.9686387e-08  0              0              2.9956973    
   2700000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    2.8253456e-16  0              1.3642583e-08  0              0              2.9956973    
   2800000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    2.7687708e-17  0              1.3369403e-09  0              0              2.9956973    
   2900000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    7.1666781e-18  0              3.4605324e-10  0              0              2.9956973    
   3000000   12000          100            100            0.018349838   -0.01557405     0              0.070623564    6.6100928e-19  0              3.1917773e-11  0              0              2.9956973    
Loop time of 540.934 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4791710.045 ns/day, 0.000 hours/ns, 5545.961 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.035     | 100.34     | 132.09     | 307.2 | 18.55
Neigh   | 1.802      | 1.8166     | 1.8308     |   0.9 |  0.34
Comm    | 23.837     | 54.341     | 86.992     | 410.5 | 10.05
Output  | 0.47722    | 0.47761    | 0.47803    |   0.1 |  0.09
Modify  | 263.84     | 305.94     | 347.55     | 230.4 | 56.56
Other   |            | 78.02      |            |       | 14.42

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019198819    1.2403874e-16  0              0.057596458    1659366.6      0              8.0124874e+13  0              0              3.3244742    
    200000   12000          100            100            0.0069036757   1.2403874e-16  0              0.020711027    413991.18      0              1.9990153e+13  0              0              3.0704142    
    300000   12000          100            100            0.00068117722  1.2403874e-16  0              0.0020435317   8055.4913      0              3.8897084e+11  0              0              3.0448565    
    400000   12000          100            100            0.079708324   -0.048038683    0              0.28716366     12751.004      0              6.1570034e+11  0              0              2.9915124    
    500000   12000          100            100            0.0022230249  -0.0021445159   0              0.0088135906   814.42776      0              3.9325802e+10  0              0              2.99846      
    600000   12000          100            100            0.014714657   -0.010983026    0              0.055126997    466.40634      0              2.2521093e+10  0              0              2.9962892    
    700000   12000          100            100            0.017910551   -0.015297561    0              0.069029216    82.16966       0              3.9676788e+09  0              0              2.9958233    
    800000   12000          100            100            0.019524841   -0.01551093     0              0.074085452    4.1833661      0              2.0199978e+08  0              0              2.99568      
    900000   12000          100            100            0.017817394   -0.015633554    0              0.069085736    0.057584382    0              2780543.7      0              0              2.9958275    
   1000000   12000          100            100            0.01841238    -0.015668424    0              0.070905563    0.15204863     0              7341884.2      0              0              2.9957724    
   1100000   12000          100            100            0.018347217   -0.015657375    0              0.070699026    0.023769784    0              1147757.8      0              0              2.9957789    
   1200000   12000          100            100            0.018299973   -0.015652882    0              0.070552802    0.00044717861  0              21592.654      0              0              2.9957832    
   1300000   12000          100            100            0.01833142    -0.015656015    0              0.070650275    0.00011258142  0              5436.1537      0              0              2.9957803    
   1400000   12000          100            100            0.018322838   -0.015655013    0              0.070623527    6.2112037e-05  0              2999.168       0              0              2.9957811    
   1500000   12000          100            100            0.018322723   -0.015655008    0              0.070623176    5.4066106e-06  0              261.06587      0              0              2.9957811    
   1600000   12000          100            100            0.018323928   -0.015655144    0              0.070626929    2.4079071e-09  0              0.11626922     0              0              2.995781     
   1700000   12000          100            100            0.018323371   -0.01565508     0              0.070625192    8.3179884e-08  0              4.0164589      0              0              2.995781     
   1800000   12000          100            100            0.018323474   -0.015655092    0              0.070625515    2.0656576e-08  0              0.99743211     0              0              2.995781     
   1900000   12000          100            100            0.0183235     -0.015655095    0              0.070625594    8.8074828e-10  0              0.042528182    0              0              2.995781     
   2000000   12000          100            100            0.018323474   -0.015655092    0              0.070625513    2.6595412e-11  0              0.0012841973   0              0              2.995781     
   2100000   12000          100            100            0.018323483   -0.015655093    0              0.070625541    4.1371215e-11  0              0.0019976679   0              0              2.995781     
   2200000   12000          100            100            0.018323482   -0.015655093    0              0.070625539    5.6024297e-12  0              0.00027052128  0              0              2.995781     
   2300000   12000          100            100            0.018323481   -0.015655093    0              0.070625536    6.9910285e-14  0              3.3757175e-06  0              0              2.995781     
   2400000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    3.6692375e-14  0              1.7717435e-06  0              0              2.995781     
   2500000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    1.6063812e-14  0              7.7566399e-07  0              0              2.995781     
   2600000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    1.2019675e-15  0              5.8038711e-08  0              0              2.995781     
   2700000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    5.6957706e-18  0              2.7502838e-10  0              0              2.995781     
   2800000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    3.819222e-17   0              1.8441656e-09  0              0              2.995781     
   2900000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    5.0638084e-18  0              2.4451319e-10  0              0              2.995781     
   3000000   12000          100            100            0.018323481   -0.015655093    0              0.070625537    9.969918e-18   0              4.8141166e-10  0              0              2.995781     
Loop time of 541.092 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4790310.930 ns/day, 0.000 hours/ns, 5544.341 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.366     | 100.19     | 131.23     | 306.7 | 18.52
Neigh   | 1.7887     | 1.8111     | 1.8342     |   1.2 |  0.33
Comm    | 24.881     | 55.111     | 87.03      | 404.3 | 10.19
Output  | 0.48221    | 0.48257    | 0.48297    |   0.1 |  0.09
Modify  | 264.98     | 306.45     | 346.37     | 227.6 | 56.64
Other   |            | 77.05      |            |       | 14.24

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019208498    1.2403874e-16  0              0.057625493    1660610.4      0              8.0184933e+13  0              0              3.3241505    
    200000   12000          100            100            0.0069254549   1.2403874e-16  0              0.020776365    416028.82      0              2.0088543e+13  0              0              3.0698434    
    300000   12000          100            100            0.00071597418  1.2403874e-16  0              0.0021479225   8843.7791      0              4.2703444e+11  0              0              3.0447742    
    400000   12000          100            100            0.095941933   -0.053253616    0              0.34107941     5785.7263      0              2.7937202e+11  0              0              2.9909028    
    500000   12000          100            100            0.0015092551  -0.00088857931  0              0.0054163446   21.276702      0              1.0273758e+09  0              0              2.9988635    
    600000   12000          100            100            0.027864786   -0.020136162    0              0.10373052     71.595156      0              3.4570738e+09  0              0              2.9949849    
    700000   12000          100            100            0.017762048   -0.015205934    0              0.068492078    81.466202      0              3.9337113e+09  0              0              2.9959289    
    800000   12000          100            100            0.017095885   -0.015149467    0              0.066437122    0.68844417     0              33242505       0              0              2.9959855    
    900000   12000          100            100            0.018063846   -0.015402968    0              0.069594507    0.89217337     0              43079859       0              0              2.9958899    
   1000000   12000          100            100            0.01849296    -0.015394323    0              0.070873202    0.16578962     0              8005387.2      0              0              2.9958526    
   1100000   12000          100            100            0.018477536   -0.015409693    0              0.0708423      1.6873544e-06  0              81.476307      0              0              2.9958537    
   1200000   12000          100            100            0.0184192     -0.015402857    0              0.070660457    0.0030213889   0              145892.06      0              0              2.9958591    
   1300000   12000          100            100            0.018402587   -0.015401014    0              0.070608773    0.00028024123  0              13531.846      0              0              2.9958606    
   1400000   12000          100            100            0.0184053     -0.015401333    0              0.070617234    4.9187883e-06  0              237.51068      0              0              2.9958603    
   1500000   12000          100            100            0.018408364   -0.015401678    0              0.070626769    8.5701063e-06  0              413.81976      0              0              2.99586      
   1600000   12000          100            100            0.018408943   -0.015401741    0              0.070628569    3.6430768e-07  0              17.591114      0              0              2.99586      
   1700000   12000          100            100            0.01840871    -0.015401714    0              0.070627844    4.2765084e-08  0              2.0649729      0              0              2.99586      
   1800000   12000          100            100            0.018408561   -0.015401698    0              0.07062738     2.0904048e-08  0              1.0093817      0              0              2.99586      
   1900000   12000          100            100            0.018408546   -0.015401696    0              0.070627334    2.810978e-10   0              0.013573207    0              0              2.99586      
   2000000   12000          100            100            0.018408562   -0.015401698    0              0.070627382    2.0240376e-10  0              0.0097733531   0              0              2.99586      
   2100000   12000          100            100            0.018408568   -0.015401698    0              0.070627403    4.3922981e-11  0              0.0021208836   0              0              2.99586      
   2200000   12000          100            100            0.018408568   -0.015401698    0              0.070627403    1.7530233e-14  0              8.4647219e-07  0              0              2.99586      
   2300000   12000          100            100            0.018408567   -0.015401698    0              0.070627401    7.1933938e-13  0              3.4734324e-05  0              0              2.99586      
   2400000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      7.6708721e-14  0              3.7039896e-06  0              0              2.99586      
   2500000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      8.5711588e-16  0              4.1387058e-08  0              0              2.99586      
   2600000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      2.1213894e-15  0              1.024343e-07   0              0              2.99586      
   2700000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      1.3175755e-16  0              6.3621006e-09  0              0              2.99586      
   2800000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      4.9853626e-18  0              2.4072532e-10  0              0              2.99586      
   2900000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      1.6518987e-19  0              7.9764274e-12  0              0              2.99586      
   3000000   12000          100            100            0.018408567   -0.015401698    0              0.0706274      6.3848493e-19  0              3.0830152e-11  0              0              2.99586      
Loop time of 542.858 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4774732.656 ns/day, 0.000 hours/ns, 5526.311 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.221     | 100.76     | 132.18     | 304.7 | 18.56
Neigh   | 1.85       | 1.866      | 1.8813     |   0.9 |  0.34
Comm    | 25.093     | 55.02      | 85.349     | 400.7 | 10.14
Output  | 0.48063    | 0.48104    | 0.48146    |   0.1 |  0.09
Modify  | 266.61     | 307.81     | 347.79     | 224.9 | 56.70
Other   |            | 76.92      |            |       | 14.17

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019217707    1.2403874e-16  0              0.057653121    1661794.4      0              8.0242103e+13  0              0              3.3238421    
    200000   12000          100            100            0.0069461932   1.2403874e-16  0              0.02083858     417972.02      0              2.0182373e+13  0              0              3.0692978    
    300000   12000          100            100            0.00074921799  1.2403874e-16  0              0.002247654    9626.7716      0              4.6484235e+11  0              0              3.0446837    
    400000   12000          100            100            0.10655651    -0.055936493    0              0.37560601     1153.9686      0              5.5721016e+10  0              0              2.9906106    
    500000   12000          100            100            0.0032682714  -0.0011304373   0              0.010935251    1263.3979      0              6.1004965e+10  0              0              2.9984567    
    600000   12000          100            100            0.01865003    -0.019630297    0              0.075580387    624.56967      0              3.0158234e+10  0              0              2.9957799    
    700000   12000          100            100            0.020239296   -0.015639187    0              0.076357076    66.249578      0              3.198955e+09   0              0              2.995768     
    800000   12000          100            100            0.018999793   -0.015835007    0              0.072834386    8.5368319      0              4.1221306e+08  0              0              2.9958699    
    900000   12000          100            100            0.01857808    -0.015696079    0              0.071430318    1.1468637      0              55377943       0              0              2.9959111    
   1000000   12000          100            100            0.018415895   -0.015671003    0              0.070918687    0.15494218     0              7481603.1      0              0              2.9959262    
   1100000   12000          100            100            0.018358842   -0.015658463    0              0.07073499     0.020797235    0              1004224.1      0              0              2.9959316    
   1200000   12000          100            100            0.018337679   -0.015654859    0              0.070667897    0.0027899341   0              134715.93      0              0              2.9959336    
   1300000   12000          100            100            0.018329934   -0.015653535    0              0.070643336    0.00037435439  0              18076.234      0              0              2.9959343    
   1400000   12000          100            100            0.0183271     -0.01565305     0              0.070634348    5.0234755e-05  0              2425.6565      0              0              2.9959346    
   1500000   12000          100            100            0.018326063   -0.015652872    0              0.070631059    6.7411919e-06  0              325.50803      0              0              2.9959347    
   1600000   12000          100            100            0.018325683   -0.015652807    0              0.070629856    9.0463433e-07  0              43.681554      0              0              2.9959347    
   1700000   12000          100            100            0.018325544   -0.015652783    0              0.070629416    1.2139764e-07  0              5.8618577      0              0              2.9959348    
   1800000   12000          100            100            0.018325494   -0.015652774    0              0.070629255    1.6290957e-08  0              0.78663201     0              0              2.9959348    
   1900000   12000          100            100            0.018325475   -0.015652771    0              0.070629196    2.1861146e-09  0              0.10555965     0              0              2.9959348    
   2000000   12000          100            100            0.018325468   -0.01565277     0              0.070629174    2.9335854e-10  0              0.014165234    0              0              2.9959348    
   2100000   12000          100            100            0.018325466   -0.015652769    0              0.070629167    3.9368797e-11  0              0.0019009783   0              0              2.9959348    
   2200000   12000          100            100            0.018325465   -0.015652769    0              0.070629164    5.2815607e-12  0              0.00025502766  0              0              2.9959348    
   2300000   12000          100            100            0.018325464   -0.015652769    0              0.070629163    7.0956305e-13  0              3.426226e-05   0              0              2.9959348    
   2400000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    9.5721943e-14  0              4.6220701e-06  0              0              2.9959348    
   2500000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    1.2987763e-14  0              6.271326e-07   0              0              2.9959348    
   2600000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    1.6955502e-15  0              8.1872052e-08  0              0              2.9959348    
   2700000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    2.3768082e-16  0              1.1476756e-08  0              0              2.9959348    
   2800000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    3.8024732e-17  0              1.8360782e-09  0              0              2.9959348    
   2900000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    7.3281401e-18  0              3.5384966e-10  0              0              2.9959348    
   3000000   12000          100            100            0.018325464   -0.015652769    0              0.070629162    1.2873778e-17  0              6.2162865e-10  0              0              2.9959348    
Loop time of 541.353 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4788005.163 ns/day, 0.000 hours/ns, 5541.673 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.882     | 100.28     | 132.14     | 310.8 | 18.52
Neigh   | 1.8062     | 1.8238     | 1.8412     |   1.0 |  0.34
Comm    | 25.262     | 55.809     | 88.2       | 407.4 | 10.31
Output  | 0.48313    | 0.48352    | 0.48394    |   0.1 |  0.09
Modify  | 264.7      | 306.36     | 346.19     | 226.6 | 56.59
Other   |            | 76.6       |            |       | 14.15

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019226486    1.2403874e-16  0              0.057679458    1662923.4      0              8.0296619e+13  0              0              3.3235476    
    200000   12000          100            100            0.0069659749   1.2403874e-16  0              0.020897925    419828.25      0              2.0272004e+13  0              0              3.0687756    
    300000   12000          100            100            0.00078102608  1.2403874e-16  0              0.0023430782   10402.857      0              5.0231674e+11  0              0              3.0445863    
    400000   12000          100            100            0.10941688    -0.05790455     0              0.3861552      97.356303      0              4.7009875e+09  0              0              2.9906336    
    500000   12000          100            100            0.0095528359  -0.0019759337   0              0.030634441    3552.5823      0              1.7154149e+11  0              0              2.9974273    
    600000   12000          100            100            0.010698341   -0.0081136387   0              0.040208662    22.495557      0              1.08623e+09    0              0              2.9969835    
    700000   12000          100            100            0.015525237   -0.014156461    0              0.060732171    26.992949      0              1.3033929e+09  0              0              2.9962998    
    800000   12000          100            100            0.018798824   -0.014847146    0              0.071243619    11.322657      0              5.4673058e+08  0              0              2.9959903    
    900000   12000          100            100            0.019048351   -0.015070904    0              0.072215958    0.13275473     0              6410250.6      0              0              2.9959612    
   1000000   12000          100            100            0.018675582   -0.015005471    0              0.071032215    0.11389818     0              5499735.7      0              0              2.995994     
   1100000   12000          100            100            0.018520805   -0.014981472    0              0.070543888    0.023609058    0              1139996.9      0              0              2.996008     
   1200000   12000          100            100            0.018522774   -0.014981612    0              0.070549935    6.9177666e-06  0              334.03419      0              0              2.9960079    
   1300000   12000          100            100            0.018544128   -0.014984905    0              0.07061729     0.00039183664  0              18920.389      0              0              2.996006     
   1400000   12000          100            100            0.01855052    -0.01498591     0              0.070637469    4.2464832e-05  0              2050.4748      0              0              2.9960054    
   1500000   12000          100            100            0.018549644   -0.014985782    0              0.070634715    3.9233435e-07  0              18.944422      0              0              2.9960055    
   1600000   12000          100            100            0.018548514   -0.014985607    0              0.070631151    1.1430078e-06  0              55.191755      0              0              2.9960056    
   1700000   12000          100            100            0.01854828    -0.01498557     0              0.070630411    6.1931879e-08  0              2.9904688      0              0              2.9960056    
   1800000   12000          100            100            0.018548359   -0.014985582    0              0.070630658    4.3458388e-09  0              0.209845       0              0              2.9960056    
   1900000   12000          100            100            0.018548415   -0.014985591    0              0.070630835    2.9060378e-09  0              0.14032217     0              0              2.9960056    
   2000000   12000          100            100            0.018548421   -0.014985592    0              0.070630856    6.3070184e-11  0              0.0030454335   0              0              2.9960056    
   2100000   12000          100            100            0.018548416   -0.014985591    0              0.070630839    2.2636942e-11  0              0.0010930569   0              0              2.9960056    
   2200000   12000          100            100            0.018548414   -0.014985591    0              0.070630831    6.4822904e-12  0              0.00031300661  0              0              2.9960056    
   2300000   12000          100            100            0.018548413   -0.014985591    0              0.070630831    2.4113855e-14  0              1.1643718e-06  0              0              2.9960056    
   2400000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    8.6137228e-14  0              4.1592585e-06  0              0              2.9960056    
   2500000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    1.2712724e-14  0              6.1385192e-07  0              0              2.9960056    
   2600000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    3.7412421e-18  0              1.8065119e-10  0              0              2.9960056    
   2700000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    2.6132474e-16  0              1.2618436e-08  0              0              2.9960056    
   2800000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    1.3513024e-19  0              6.5249555e-12  0              0              2.9960056    
   2900000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    8.3075566e-18  0              4.0114218e-10  0              0              2.9960056    
   3000000   12000          100            100            0.018548414   -0.014985591    0              0.070630832    1.6479841e-19  0              7.9575253e-12  0              0              2.9960056    
Loop time of 546.237 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4745191.093 ns/day, 0.000 hours/ns, 5492.119 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.062     | 100.16     | 131.19     | 308.8 | 18.34
Neigh   | 1.831      | 1.8445     | 1.8587     |   0.9 |  0.34
Comm    | 24.426     | 55.411     | 87.375     | 407.7 | 10.14
Output  | 0.48204    | 0.48244    | 0.48287    |   0.1 |  0.09
Modify  | 267.54     | 309.92     | 351.81     | 231.2 | 56.74
Other   |            | 78.42      |            |       | 14.36

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019234868    1.2403874e-16  0              0.057704605    1664001.8      0              8.034869e+13   0              0              3.323266     
    200000   12000          100            100            0.006984875    1.2403874e-16  0              0.020954625    421604.19      0              2.0357758e+13  0              0              3.0682751    
    300000   12000          100            100            0.000811505    1.2403874e-16  0              0.002434515    11170.831      0              5.3939944e+11  0              0              3.0444832    
    400000   12000          100            100            0.10393236    -0.060647287    0              0.37244436     2703.0445      0              1.3052035e+11  0              0              2.990946     
    500000   12000          100            100            0.02088416    -0.0098516856   0              0.072504165    4815.7029      0              2.3253306e+11  0              0              2.9960638    
    600000   12000          100            100            0.016459386   -0.01128054     0              0.060658698    590.65686      0              2.8520706e+10  0              0              2.9963769    
    700000   12000          100            100            0.02294883    -0.014564084    0              0.083410575    0.63432512     0              30629290       0              0              2.9957312    
    800000   12000          100            100            0.017919952   -0.013897197    0              0.067657054    6.7057911      0              3.2379865e+08  0              0              2.996155     
    900000   12000          100            100            0.018686245   -0.014257585    0              0.07031632     1.4975478      0              72311221       0              0              2.9960824    
   1000000   12000          100            100            0.018961069   -0.014283683    0              0.071166891    0.048650024    0              2349135.6      0              0              2.9960579    
   1100000   12000          100            100            0.018723085   -0.014253378    0              0.070422633    0.0036112167   0              174372.73      0              0              2.9960786    
   1200000   12000          100            100            0.018798575   -0.014264185    0              0.070659911    0.0033574002   0              162116.84      0              0              2.9960721    
   1300000   12000          100            100            0.018794626   -0.014263695    0              0.070647573    0.00037291804  0              18006.878      0              0              2.9960724    
   1400000   12000          100            100            0.018786361   -0.014262481    0              0.070621565    1.8269229e-06  0              88.215568      0              0              2.9960731    
   1500000   12000          100            100            0.018790797   -0.014263121    0              0.070635511    3.8100186e-06  0              183.97216      0              0              2.9960727    
   1600000   12000          100            100            0.01878981    -0.014262981    0              0.070632411    1.2180593e-06  0              58.815723      0              0              2.9960728    
   1700000   12000          100            100            0.018789681   -0.014262961    0              0.070632005    6.7413587e-08  0              3.2551608      0              0              2.9960728    
   1800000   12000          100            100            0.018789874   -0.014262989    0              0.070632612    6.4396111e-10  0              0.031094577    0              0              2.9960728    
   1900000   12000          100            100            0.0187898     -0.014262979    0              0.07063238     2.1925045e-09  0              0.1058682      0              0              2.9960728    
   2000000   12000          100            100            0.018789809   -0.01426298     0              0.070632408    3.5046378e-10  0              0.016922642    0              0              2.9960728    
   2100000   12000          100            100            0.018789815   -0.014262981    0              0.070632426    6.5747745e-12  0              0.00031747233  0              0              2.9960728    
   2200000   12000          100            100            0.018789811   -0.01426298     0              0.070632414    1.6917929e-12  0              8.1690625e-05  0              0              2.9960728    
   2300000   12000          100            100            0.018789812   -0.014262981    0              0.070632417    9.1713779e-13  0              4.4285302e-05  0              0              2.9960728    
   2400000   12000          100            100            0.018789812   -0.014262981    0              0.070632417    7.7396496e-14  0              3.7371998e-06  0              0              2.9960728    
   2500000   12000          100            100            0.018789812   -0.01426298     0              0.070632417    1.124058e-17   0              5.4276738e-10  0              0              2.9960728    
   2600000   12000          100            100            0.018789812   -0.01426298     0              0.070632417    1.357755e-15   0              6.5561131e-08  0              0              2.9960728    
   2700000   12000          100            100            0.018789812   -0.01426298     0              0.070632417    2.9659787e-16  0              1.432165e-08   0              0              2.9960728    
   2800000   12000          100            100            0.018789812   -0.01426298     0              0.070632417    3.4656877e-17  0              1.6734566e-09  0              0              2.9960728    
   2900000   12000          100            100            0.018789812   -0.01426298     0              0.070632417    1.411013e-17   0              6.813277e-10   0              0              2.9960728    
   3000000   12000          100            100            0.018789812   -0.014262981    0              0.070632417    7.3219359e-19  0              3.5355008e-11  0              0              2.9960728    
Loop time of 540.548 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4795136.545 ns/day, 0.000 hours/ns, 5549.927 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.273     | 99.244     | 129.84     | 306.8 | 18.36
Neigh   | 1.8407     | 1.8596     | 1.8772     |   1.0 |  0.34
Comm    | 23.826     | 54.758     | 86.038     | 407.4 | 10.13
Output  | 0.48227    | 0.48266    | 0.48308    |   0.1 |  0.09
Modify  | 266.12     | 307.33     | 347.9      | 229.4 | 56.86
Other   |            | 76.87      |            |       | 14.22

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019242885    1.2403874e-16  0              0.057728654    1665033.3      0              8.03985e+13    0              0              3.3229963    
    200000   12000          100            100            0.0070029601   1.2403874e-16  0              0.02100888     423305.78      0              2.0439921e+13  0              0              3.0677946    
    300000   12000          100            100            0.00084074986  1.2403874e-16  0              0.0025222496   11929.766      0              5.7604571e+11  0              0              3.0443754    
    400000   12000          100            100            0.091871796   -0.062512939    0              0.33812833     8016.4839      0              3.8708732e+11  0              0              2.9915044    
    500000   12000          100            100            0.034520804   -0.026666899    0              0.13022931     3307.7608      0              1.5971993e+11  0              0              2.9947762    
    600000   12000          100            100            0.028755584   -0.019429496    0              0.10569625     73.241137      0              3.5365524e+09  0              0              2.9952763    
    700000   12000          100            100            0.015309324   -0.013888438    0              0.05981641     20.550662      0              9.9231791e+08  0              0              2.9964424    
    800000   12000          100            100            0.020016459   -0.014863641    0              0.074913017    1.9448895      0              93911755       0              0              2.9960221    
    900000   12000          100            100            0.018171355   -0.014486222    0              0.069000287    0.10219183     0              4934477.5      0              0              2.9961816    
   1000000   12000          100            100            0.018886323   -0.014593136    0              0.071252105    0.0021119953   0              101980.7       0              0              2.9961199    
   1100000   12000          100            100            0.018625184   -0.01453193     0              0.070407481    0.00010169835  0              4910.6495      0              0              2.996143     
   1200000   12000          100            100            0.018722181   -0.014548415    0              0.070714959    0.00018182937  0              8779.8895      0              0              2.9961345    
   1300000   12000          100            100            0.018687529   -0.014543147    0              0.070605733    7.0511065e-05  0              3404.727       0              0              2.9961375    
   1400000   12000          100            100            0.018699484   -0.014544987    0              0.070643441    1.8182087e-05  0              877.94789      0              0              2.9961365    
   1500000   12000          100            100            0.018695484   -0.014544372    0              0.070630824    3.8290054e-06  0              184.88897      0              0              2.9961368    
   1600000   12000          100            100            0.018696772   -0.014544571    0              0.070634888    7.1060331e-07  0              34.312491      0              0              2.9961367    
   1700000   12000          100            100            0.018696378   -0.01454451     0              0.070633642    1.2044644e-07  0              5.8159277      0              0              2.9961368    
   1800000   12000          100            100            0.01869649    -0.014544527    0              0.070633998    1.9008571e-08  0              0.91785585     0              0              2.9961368    
   1900000   12000          100            100            0.018696462   -0.014544523    0              0.070633908    2.8236617e-09  0              0.13634452     0              0              2.9961368    
   2000000   12000          100            100            0.018696467   -0.014544524    0              0.070633925    3.9716798e-10  0              0.019177821    0              0              2.9961368    
   2100000   12000          100            100            0.018696467   -0.014544524    0              0.070633925    5.30328e-11    0              0.0025607641   0              0              2.9961368    
   2200000   12000          100            100            0.018696466   -0.014544524    0              0.070633923    6.7182485e-12  0              0.00032440018  0              0              2.9961368    
   2300000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    8.0605175e-13  0              3.8921354e-05  0              0              2.9961368    
   2400000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    8.9781168e-14  0              4.3352113e-06  0              0              2.9961368    
   2500000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    9.2566921e-15  0              4.4697253e-07  0              0              2.9961368    
   2600000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    9.3472656e-16  0              4.51346e-08    0              0              2.9961368    
   2700000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    6.482781e-17   0              3.1303029e-09  0              0              2.9961368    
   2800000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    2.6106398e-18  0              1.2605845e-10  0              0              2.9961368    
   2900000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    9.9254766e-19  0              4.7926574e-11  0              0              2.9961368    
   3000000   12000          100            100            0.018696467   -0.014544524    0              0.070633924    1.831849e-17   0              8.8453433e-10  0              0              2.9961368    
Loop time of 540.761 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4793246.927 ns/day, 0.000 hours/ns, 5547.739 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.125     | 99.507     | 130.13     | 306.7 | 18.40
Neigh   | 1.8412     | 1.8577     | 1.8739     |   1.0 |  0.34
Comm    | 23.426     | 53.918     | 85.33      | 408.5 |  9.97
Output  | 0.48052    | 0.48091    | 0.48134    |   0.1 |  0.09
Modify  | 267.08     | 307.83     | 348        | 228.2 | 56.92
Other   |            | 77.17      |            |       | 14.27

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019250562    1.2403874e-16  0              0.057751687    1666021.6      0              8.0446219e+13  0              0              3.3227377    
    200000   12000          100            100            0.0070202901   1.2403874e-16  0              0.02106087     424938.35      0              2.0518752e+13  0              0              3.0673328    
    300000   12000          100            100            0.00086884614  1.2403874e-16  0              0.0026065384   12678.966      0              6.1222189e+11  0              0              3.0442638    
    400000   12000          100            100            0.073797188   -0.068036963    0              0.28942853     14536.054      0              7.0189405e+11  0              0              2.9922546    
    500000   12000          100            100            0.046571565   -0.036198155    0              0.17591285     592.82379      0              2.8625339e+10  0              0              2.9940011    
    600000   12000          100            100            0.02155041    -0.018603602    0              0.083254833    578.71235      0              2.7943948e+10  0              0              2.9958589    
    700000   12000          100            100            0.020587535   -0.013337804    0              0.075100409    78.374994      0              3.7844479e+09  0              0              2.9960841    
    800000   12000          100            100            0.017355137   -0.013947153    0              0.066012564    0.039922464    0              1927712.9      0              0              2.9963243    
    900000   12000          100            100            0.019081248   -0.014126116    0              0.071369859    1.2864914      0              62120066       0              0              2.9961773    
   1000000   12000          100            100            0.018966472   -0.01415718     0              0.071056596    0.11881728     0              5737261.4      0              0              2.9961865    
   1100000   12000          100            100            0.018760754   -0.014137043    0              0.070419306    0.0031828554   0              153688.69      0              0              2.9962035    
   1200000   12000          100            100            0.01883083    -0.014146131    0              0.070638622    0.0038242772   0              184660.66      0              0              2.9961976    
   1300000   12000          100            100            0.018838785   -0.014147105    0              0.070663461    9.0868228e-05  0              4387.7015      0              0              2.9961969    
   1400000   12000          100            100            0.018827185   -0.014145594    0              0.070627148    3.2057851e-05  0              1547.9589      0              0              2.9961979    
   1500000   12000          100            100            0.018829327   -0.014145881    0              0.070633861    8.0952729e-06  0              390.89176      0              0              2.9961977    
   1600000   12000          100            100            0.018830291   -0.014146004    0              0.070636877    7.3814837e-10  0              0.035642543    0              0              2.9961976    
   1700000   12000          100            100            0.018829737   -0.014145931    0              0.070635142    1.4009743e-07  0              6.7648033      0              0              2.9961977    
   1800000   12000          100            100            0.018829761   -0.014145935    0              0.070635217    1.1486851e-08  0              0.55465894     0              0              2.9961977    
   1900000   12000          100            100            0.018829829   -0.014145943    0              0.070635429    4.2368487e-10  0              0.020458226    0              0              2.9961977    
   2000000   12000          100            100            0.018829807   -0.01414594     0              0.07063536     4.0302969e-10  0              0.019460861    0              0              2.9961977    
   2100000   12000          100            100            0.018829804   -0.01414594     0              0.070635351    7.7875415e-12  0              0.00037603251  0              0              2.9961977    
   2200000   12000          100            100            0.018829807   -0.014145941    0              0.070635363    3.6945234e-12  0              0.00017839531  0              0              2.9961977    
   2300000   12000          100            100            0.018829807   -0.014145941    0              0.070635361    8.202813e-13   0              3.9608448e-05  0              0              2.9961977    
   2400000   12000          100            100            0.018829806   -0.01414594     0              0.07063536     3.0142847e-17  0              1.4554902e-09  0              0              2.9961977    
   2500000   12000          100            100            0.018829807   -0.014145941    0              0.07063536     1.5139364e-14  0              7.3102569e-07  0              0              2.9961977    
   2600000   12000          100            100            0.018829807   -0.014145941    0              0.07063536     1.1472255e-15  0              5.5395414e-08  0              0              2.9961977    
   2700000   12000          100            100            0.018829807   -0.014145941    0              0.07063536     4.5035965e-17  0              2.1746256e-09  0              0              2.9961977    
   2800000   12000          100            100            0.018829807   -0.014145941    0              0.07063536     2.1443602e-17  0              1.0354348e-09  0              0              2.9961977    
   2900000   12000          100            100            0.018829807   -0.014145941    0              0.07063536     2.4931676e-19  0              1.2038614e-11  0              0              2.9961977    
   3000000   12000          100            100            0.018829807   -0.01414594     0              0.07063536     2.8421187e-18  0              1.3723574e-10  0              0              2.9961977    
Loop time of 538.94 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4809439.269 ns/day, 0.000 hours/ns, 5566.481 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.321     | 99.108     | 130.05     | 307.1 | 18.39
Neigh   | 1.8361     | 1.8494     | 1.8634     |   0.9 |  0.34
Comm    | 23.814     | 54.908     | 85.555     | 405.0 | 10.19
Output  | 0.52601    | 0.5264     | 0.52682    |   0.0 |  0.10
Modify  | 265.7      | 306.07     | 346.28     | 227.2 | 56.79
Other   |            | 76.48      |            |       | 14.19

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019257925    1.2403874e-16  0              0.057773775    1666969.5      0              8.0491993e+13  0              0              3.3224893    
    200000   12000          100            100            0.0070369177   1.2403874e-16  0              0.021110753    426506.63      0              2.0594479e+13  0              0              3.0668885    
    300000   12000          100            100            0.00089587083  1.2403874e-16  0              0.0026876125   13417.912      0              6.4790296e+11  0              0              3.0441489    
    400000   12000          100            100            0.053158177   -0.074052049    0              0.23352658     20787.72       0              1.0037646e+12  0              0              2.9931399    
    500000   12000          100            100            0.047528498   -0.038092321    0              0.18067782     320.50955      0              1.5476259e+10  0              0              2.993998     
    600000   12000          100            100            0.011496545   -0.0082435874   0              0.042733221    189.87867      0              9.1685614e+09  0              0              2.9970787    
    700000   12000          100            100            0.020112548   -0.014625954    0              0.074963599    79.041469      0              3.8166297e+09  0              0              2.9961379    
    800000   12000          100            100            0.020218539   -0.014660738    0              0.075316355    0.50022675     0              24154159       0              0              2.9961332    
    900000   12000          100            100            0.019123684   -0.014535289    0              0.07190634     0.76028856     0              36711613       0              0              2.9962227    
   1000000   12000          100            100            0.018686117   -0.014489206    0              0.070547556    0.21001452     0              10140849       0              0              2.9962584    
   1100000   12000          100            100            0.018646053   -0.014490457    0              0.070428615    0.0055775224   0              269318.59      0              0              2.9962614    
   1200000   12000          100            100            0.018688107   -0.014497818    0              0.070562138    0.00093177754  0              44992.203      0              0              2.9962578    
   1300000   12000          100            100            0.018710699   -0.014501626    0              0.070633722    0.00051494706  0              24864.95       0              0              2.9962559    
   1400000   12000          100            100            0.018714422   -0.01450223     0              0.070645495    2.8269281e-05  0              1365.0224      0              0              2.9962556    
   1500000   12000          100            100            0.018712933   -0.014501973    0              0.07064077     7.0537011e-07  0              34.059798      0              0              2.9962557    
   1600000   12000          100            100            0.018711815   -0.014501785    0              0.07063723     1.1278441e-06  0              54.459553      0              0              2.9962558    
   1700000   12000          100            100            0.018711551   -0.014501742    0              0.070636396    1.0749592e-07  0              5.1905933      0              0              2.9962558    
   1800000   12000          100            100            0.018711592   -0.014501749    0              0.070636525    4.2417548e-11  0              0.0020481916   0              0              2.9962558    
   1900000   12000          100            100            0.018711644   -0.014501758    0              0.07063669     2.1813358e-09  0              0.1053289      0              0              2.9962558    
   2000000   12000          100            100            0.01871166    -0.01450176     0              0.070636741    3.423235e-10   0              0.016529577    0              0              2.9962558    
   2100000   12000          100            100            0.01871166    -0.01450176     0              0.07063674     1.980128e-12   0              9.5613296e-05  0              0              2.9962558    
   2200000   12000          100            100            0.018711658   -0.01450176     0              0.070636733    3.6086496e-12  0              0.00017424878  0              0              2.9962558    
   2300000   12000          100            100            0.018711657   -0.01450176     0              0.07063673     9.545518e-13   0              4.609189e-05   0              0              2.9962558    
   2400000   12000          100            100            0.018711657   -0.01450176     0              0.07063673     2.3242348e-14  0              1.1222898e-06  0              0              2.9962558    
   2500000   12000          100            100            0.018711657   -0.01450176     0              0.07063673     4.6623808e-15  0              2.2512968e-07  0              0              2.9962558    
   2600000   12000          100            100            0.018711657   -0.01450176     0              0.070636731    2.373358e-15   0              1.1460096e-07  0              0              2.9962558    
   2700000   12000          100            100            0.018711657   -0.01450176     0              0.070636731    1.1268389e-16  0              5.4411018e-09  0              0              2.9962558    
   2800000   12000          100            100            0.018711657   -0.01450176     0              0.070636731    3.3285384e-18  0              1.6072321e-10  0              0              2.9962558    
   2900000   12000          100            100            0.018711657   -0.01450176     0              0.070636731    7.7986204e-18  0              3.7656747e-10  0              0              2.9962558    
   3000000   12000          100            100            0.018711657   -0.01450176     0              0.070636731    2.0472433e-17  0              9.8854054e-10  0              0              2.9962558    
Loop time of 540.547 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4795146.531 ns/day, 0.000 hours/ns, 5549.938 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.301     | 99.558     | 131.13     | 306.3 | 18.42
Neigh   | 1.8272     | 1.8448     | 1.8616     |   1.0 |  0.34
Comm    | 25.292     | 55.077     | 87.628     | 400.2 | 10.19
Output  | 0.48127    | 0.48167    | 0.48212    |   0.1 |  0.09
Modify  | 264.24     | 306.23     | 346.51     | 226.9 | 56.65
Other   |            | 77.35      |            |       | 14.31

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019264995    1.2403874e-16  0              0.057794984    1667880        0              8.0535958e+13  0              0              3.3222506    
    200000   12000          100            100            0.0070528925   1.2403874e-16  0              0.021158677    428015.05      0              2.0667315e+13  0              0              3.0664604    
    300000   12000          100            100            0.00092189501  1.2403874e-16  0              0.002765685    14146.275      0              6.8307297e+11  0              0              3.0440316    
    400000   12000          100            100            0.037350463   -0.064813416    0              0.1768648      25721.677      0              1.2420077e+12  0              0              2.9941067    
    500000   12000          100            100            0.034726712   -0.039621511    0              0.14380165     2746.8892      0              1.3263745e+11  0              0              2.9947129    
    600000   12000          100            100            0.012829374   -0.0065494468   0              0.045037569    272.05325      0              1.3136478e+10  0              0              2.9970669    
    700000   12000          100            100            0.015441251   -0.012523294    0              0.058847046    12.151814      0              5.8676761e+08  0              0              2.9966357    
    800000   12000          100            100            0.017642838   -0.013310581    0              0.066239096    1.6241892      0              78426282       0              0              2.9964289    
    900000   12000          100            100            0.018603706   -0.013229199    0              0.069040318    0.25753069     0              12435235       0              0              2.9963536    
   1000000   12000          100            100            0.018907071   -0.013337253    0              0.070058465    0.03881693     0              1874330.6      0              0              2.9963266    
   1100000   12000          100            100            0.019024479   -0.013353945    0              0.070427382    0.0056166089   0              271205.94      0              0              2.9963169    
   1200000   12000          100            100            0.019067206   -0.013359898    0              0.070561517    0.00080799127  0              39015.007      0              0              2.9963134    
   1300000   12000          100            100            0.019082737   -0.013362047    0              0.070610258    0.00011587646  0              5595.2594      0              0              2.9963121    
   1400000   12000          100            100            0.019088377   -0.013362826    0              0.070627958    1.657178e-05   0              800.19194      0              0              2.9963116    
   1500000   12000          100            100            0.019090425   -0.013363108    0              0.070634383    2.3639056e-06  0              114.14454      0              0              2.9963114    
   1600000   12000          100            100            0.019091168   -0.01336321     0              0.070636714    3.3639752e-07  0              16.243432      0              0              2.9963114    
   1700000   12000          100            100            0.019091437   -0.013363248    0              0.070637559    4.7763956e-08  0              2.3063505      0              0              2.9963114    
   1800000   12000          100            100            0.019091535   -0.013363261    0              0.070637866    6.7675742e-09  0              0.32678194     0              0              2.9963114    
   1900000   12000          100            100            0.01909157    -0.013363266    0              0.070637977    9.5694246e-10  0              0.046207327    0              0              2.9963114    
   2000000   12000          100            100            0.019091583   -0.013363268    0              0.070638017    1.3506325e-10  0              0.0065217209   0              0              2.9963114    
   2100000   12000          100            100            0.019091588   -0.013363268    0              0.070638032    1.9025479e-11  0              0.00091867231  0              0              2.9963114    
   2200000   12000          100            100            0.019091589   -0.013363269    0              0.070638037    2.6737599e-12  0              0.00012910629  0              0              2.9963114    
   2300000   12000          100            100            0.01909159    -0.013363269    0              0.070638039    3.7661428e-13  0              1.8185356e-05  0              0              2.9963114    
   2400000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     5.3411649e-14  0              2.5790574e-06  0              0              2.9963114    
   2500000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     7.3635365e-15  0              3.5555883e-07  0              0              2.9963114    
   2600000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     9.1644264e-16  0              4.4251735e-08  0              0              2.9963114    
   2700000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     1.1552815e-16  0              5.578441e-09   0              0              2.9963114    
   2800000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     3.5106352e-17  0              1.6951601e-09  0              0              2.9963114    
   2900000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     1.686024e-17   0              8.1412065e-10  0              0              2.9963114    
   3000000   12000          100            100            0.01909159    -0.013363269    0              0.07063804     1.544389e-17   0              7.4573016e-10  0              0              2.9963114    
Loop time of 542.287 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4779757.316 ns/day, 0.000 hours/ns, 5532.127 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.221     | 99.441     | 130.09     | 307.2 | 18.34
Neigh   | 1.8376     | 1.8548     | 1.8716     |   1.0 |  0.34
Comm    | 23.564     | 54.122     | 85.194     | 408.3 |  9.98
Output  | 0.48054    | 0.48093    | 0.48134    |   0.1 |  0.09
Modify  | 268.94     | 309.3      | 349.6      | 226.7 | 57.04
Other   |            | 77.09      |            |       | 14.22

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019271791    1.2403874e-16  0              0.057815373    1668755.6      0              8.0578234e+13  0              0              3.3220208    
    200000   12000          100            100            0.0070682575   1.2403874e-16  0              0.021204772    429467.49      0              2.0737448e+13  0              0              3.0660476    
    300000   12000          100            100            0.00094698107  1.2403874e-16  0              0.0028409432   14863.778      0              7.1771865e+11  0              0              3.0439122    
    400000   12000          100            100            0.025872566   -0.046946008    0              0.12456371     28845.769      0              1.3928589e+12  0              0              2.9951089    
    500000   12000          100            100            0.021562004   -0.025905003    0              0.090591014    4781.7595      0              2.3089405e+11  0              0              2.9958505    
    600000   12000          100            100            0.024017527   -0.013883613    0              0.085936194    570.20183      0              2.7533006e+10  0              0              2.9960015    
    700000   12000          100            100            0.022736767   -0.014418912    0              0.082629212    20.821841      0              1.0054122e+09  0              0              2.9960699    
    800000   12000          100            100            0.020393809   -0.013793001    0              0.074974428    2.5503292      0              1.2314627e+08  0              0              2.9962536    
    900000   12000          100            100            0.01899261    -0.013779973    0              0.070757802    1.6186273      0              78157721       0              0              2.9963607    
   1000000   12000          100            100            0.018805865   -0.013685857    0              0.070103451    0.071491498    0              3452068.6      0              0              2.9963782    
   1100000   12000          100            100            0.018908164   -0.01369914     0              0.070423631    0.0051336766   0              247886.87      0              0              2.9963701    
   1200000   12000          100            100            0.018974302   -0.013708595    0              0.0706315      0.0038994866   0              188292.25      0              0              2.9963647    
   1300000   12000          100            100            0.018985072   -0.013710165    0              0.070665383    0.00018105366  0              8742.4332      0              0              2.9963638    
   1400000   12000          100            100            0.018980163   -0.01370949     0              0.070649978    1.1635196e-05  0              561.82197      0              0              2.9963642    
   1500000   12000          100            100            0.018976903   -0.013709029    0              0.070639739    9.404589e-06   0              454.11394      0              0              2.9963645    
   1600000   12000          100            100            0.018976358   -0.013708949    0              0.070638023    4.5611103e-07  0              22.023969      0              0              2.9963645    
   1700000   12000          100            100            0.018976594   -0.013708982    0              0.070638764    2.6278623e-08  0              1.2689007      0              0              2.9963645    
   1800000   12000          100            100            0.018976754   -0.013709004    0              0.070639268    2.2670374e-08  0              1.0946712      0              0              2.9963645    
   1900000   12000          100            100            0.018976782   -0.013709008    0              0.070639354    1.1477981e-09  0              0.055423062    0              0              2.9963645    
   2000000   12000          100            100            0.018976771   -0.013709007    0              0.070639319    5.9172868e-11  0              0.002857246    0              0              2.9963645    
   2100000   12000          100            100            0.018976763   -0.013709006    0              0.070639294    5.4620583e-11  0              0.0026374325   0              0              2.9963645    
   2200000   12000          100            100            0.018976761   -0.013709006    0              0.07063929     2.883986e-12   0              0.00013925736  0              0              2.9963645    
   2300000   12000          100            100            0.018976762   -0.013709006    0              0.070639291    1.3278586e-13  0              6.4117539e-06  0              0              2.9963645    
   2400000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    1.311719e-13   0              6.3338215e-06  0              0              2.9963645    
   2500000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    7.2326076e-15  0              3.4923673e-07  0              0              2.9963645    
   2600000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    2.1748521e-16  0              1.0501582e-08  0              0              2.9963645    
   2700000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    2.9718246e-16  0              1.4349878e-08  0              0              2.9963645    
   2800000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    4.2817843e-19  0              2.0675204e-11  0              0              2.9963645    
   2900000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    1.0651121e-17  0              5.1430453e-10  0              0              2.9963645    
   3000000   12000          100            100            0.018976762   -0.013709006    0              0.070639293    1.2446542e-17  0              6.0099895e-10  0              0              2.9963645    
Loop time of 540.262 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4797674.507 ns/day, 0.000 hours/ns, 5552.864 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.61      | 99.505     | 130.6      | 305.0 | 18.42
Neigh   | 1.8217     | 1.8358     | 1.8507     |   0.9 |  0.34
Comm    | 23.997     | 54.92      | 84.773     | 401.9 | 10.17
Output  | 0.48126    | 0.48168    | 0.4821     |   0.1 |  0.09
Modify  | 266.98     | 306.96     | 346.85     | 227.4 | 56.82
Other   |            | 76.56      |            |       | 14.17

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019278332    1.2403874e-16  0              0.057834997    1669598.4      0              8.0618934e+13  0              0              3.3217993    
    200000   12000          100            100            0.0070830524   1.2403874e-16  0              0.021249157    430867.5       0              2.080505e+13   0              0              3.0656491    
    300000   12000          100            100            0.00097118751  1.2403874e-16  0              0.0029135625   15570.294      0              7.5183377e+11  0              0              3.0437912    
    400000   12000          100            100            0.018835242   -0.023493182    0              0.079998909    30154.715      0              1.4560633e+12  0              0              2.99611      
    500000   12000          100            100            0.012814105   -0.007408164    0              0.045850479    4677.1831      0              2.2584443e+11  0              0              2.99707      
    600000   12000          100            100            0.030165509   -0.018731282    0              0.10922781     30.873062      0              1.4907497e+09  0              0              2.9955384    
    700000   12000          100            100            0.017952631   -0.014200196    0              0.06805809     88.189825      0              4.258371e+09   0              0              2.9964765    
    800000   12000          100            100            0.017672111   -0.013331909    0              0.066348243    2.5823697      0              1.2469339e+08  0              0              2.996527     
    900000   12000          100            100            0.019631614   -0.013141084    0              0.072035927    0.66883707     0              32295748       0              0              2.9963805    
   1000000   12000          100            100            0.019253488   -0.013052755    0              0.070813219    0.20421761     0              9860937.4      0              0              2.9964107    
   1100000   12000          100            100            0.019127164   -0.013020946    0              0.070402438    0.0006430676   0              31051.433      0              0              2.9964214    
   1200000   12000          100            100            0.019218921   -0.013032115    0              0.070688876    0.0028059742   0              135490.45      0              0              2.9964141    
   1300000   12000          100            100            0.019208988   -0.013030906    0              0.07065787     0.00037566999  0              18139.759      0              0              2.9964149    
   1400000   12000          100            100            0.019199687   -0.013029691    0              0.070628752    1.5960198e-06  0              77.066083      0              0              2.9964156    
   1500000   12000          100            100            0.019203827   -0.013030221    0              0.070641701    8.8999714e-06  0              429.74777      0              0              2.9964153    
   1600000   12000          100            100            0.019203826   -0.013030224    0              0.070641703    5.3361879e-07  0              25.766541      0              0              2.9964153    
   1700000   12000          100            100            0.019203271   -0.013030152    0              0.070639964    3.2445356e-08  0              1.5666701      0              0              2.9964154    
   1800000   12000          100            100            0.019203438   -0.013030174    0              0.070640488    2.3232004e-08  0              1.1217903      0              0              2.9964153    
   1900000   12000          100            100            0.019203462   -0.013030177    0              0.070640564    4.7543639e-10  0              0.022957122    0              0              2.9964153    
   2000000   12000          100            100            0.019203432   -0.013030173    0              0.070640471    1.9276612e-10  0              0.009307986    0              0              2.9964153    
   2100000   12000          100            100            0.019203438   -0.013030174    0              0.070640488    5.0649425e-11  0              0.0024456795   0              0              2.9964153    
   2200000   12000          100            100            0.01920344    -0.013030174    0              0.070640496    7.9738824e-14  0              3.8503024e-06  0              0              2.9964153    
   2300000   12000          100            100            0.019203439   -0.013030174    0              0.070640491    7.5612455e-13  0              3.6510548e-05  0              0              2.9964153    
   2400000   12000          100            100            0.019203439   -0.013030174    0              0.070640491    8.967683e-14   0              4.3301732e-06  0              0              2.9964153    
   2500000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    7.5096198e-16  0              3.6261267e-08  0              0              2.9964153    
   2600000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    2.3536158e-15  0              1.1364768e-07  0              0              2.9964153    
   2700000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    8.57416e-17    0              4.140155e-09   0              0              2.9964153    
   2800000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    2.2147243e-19  0              1.0694111e-11  0              0              2.9964153    
   2900000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    4.5619189e-18  0              2.2027874e-10  0              0              2.9964153    
   3000000   12000          100            100            0.019203439   -0.013030174    0              0.070640492    1.9382646e-17  0              9.3591859e-10  0              0              2.9964153    
Loop time of 539.94 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4800531.274 ns/day, 0.000 hours/ns, 5556.170 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.14      | 99.411     | 130.8      | 307.6 | 18.41
Neigh   | 1.8228     | 1.8417     | 1.8601     |   1.0 |  0.34
Comm    | 23.783     | 53.897     | 86.017     | 407.8 |  9.98
Output  | 0.49055    | 0.49095    | 0.49136    |   0.1 |  0.09
Modify  | 265.97     | 307.28     | 347.34     | 227.9 | 56.91
Other   |            | 77.02      |            |       | 14.27

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019284635    1.2403874e-16  0              0.057853905    1670410.7      0              8.0658156e+13  0              0              3.3215858    
    200000   12000          100            100            0.0070973137   1.2403874e-16  0              0.021291941    432218.4       0              2.087028e+13   0              0              3.065264     
    300000   12000          100            100            0.00099456755  1.2403874e-16  0              0.0029837026   16265.763      0              7.8541547e+11  0              0              3.0436691    
    400000   12000          100            100            0.012501523   -0.007443207    0              0.044947777    29958.55       0              1.4465912e+12  0              0              2.9970831    
    500000   12000          100            100            0.0053092225  -0.0027414847   0              0.018669152    3139.061       0              1.5157402e+11  0              0              2.9981276    
    600000   12000          100            100            0.018557538   -0.016255731    0              0.071928345    687.99925      0              3.3221022e+10  0              0              2.9964186    
    700000   12000          100            100            0.01631738    -0.011833689    0              0.060785829    40.093876      0              1.9359898e+09  0              0              2.996724     
    800000   12000          100            100            0.020664795   -0.013202272    0              0.075196657    2.0631277      0              99621052       0              0              2.9963511    
    900000   12000          100            100            0.018517249   -0.013305431    0              0.06885718     0.03716327     0              1794481.3      0              0              2.9965092    
   1000000   12000          100            100            0.019315707   -0.013356988    0              0.07130411     0.0027080025   0              130759.75      0              0              2.9964476    
   1100000   12000          100            100            0.019039982   -0.013293534    0              0.070413481    0.0037892243   0              182968.08      0              0              2.9964698    
   1200000   12000          100            100            0.019134713   -0.013310656    0              0.070714794    0.0013441614   0              64904.745      0              0              2.9964623    
   1300000   12000          100            100            0.019104468   -0.013306987    0              0.070620392    0.00031448349  0              15185.282      0              0              2.9964647    
   1400000   12000          100            100            0.019112958   -0.013308024    0              0.070646897    5.8689247e-05  0              2833.8937      0              0              2.996464     
   1500000   12000          100            100            0.019110992   -0.01330779     0              0.070640767    9.3276414e-06  0              450.39842      0              0              2.9964642    
   1600000   12000          100            100            0.019111247   -0.013307818    0              0.070641558    1.2957132e-06  0              62.565352      0              0              2.9964642    
   1700000   12000          100            100            0.01911133    -0.013307829    0              0.07064182     1.5804083e-07  0              7.6312259      0              0              2.9964641    
   1800000   12000          100            100            0.019111237   -0.013307817    0              0.070641528    1.6697372e-08  0              0.80625636     0              0              2.9964642    
   1900000   12000          100            100            0.019111292   -0.013307824    0              0.0706417      1.467104e-09   0              0.070841203    0              0              2.9964641    
   2000000   12000          100            100            0.019111265   -0.013307821    0              0.070641617    9.6522085e-11  0              0.004660706    0              0              2.9964642    
   2100000   12000          100            100            0.019111277   -0.013307822    0              0.070641653    3.3403404e-12  0              0.00016129308  0              0              2.9964642    
   2200000   12000          100            100            0.019111272   -0.013307822    0              0.070641638    4.4192881e-16  0              2.1339161e-08  0              0              2.9964642    
   2300000   12000          100            100            0.019111274   -0.013307822    0              0.070641644    6.8122003e-14  0              3.2893677e-06  0              0              2.9964642    
   2400000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    3.274801e-14   0              1.5812842e-06  0              0              2.9964642    
   2500000   12000          100            100            0.019111274   -0.013307822    0              0.070641642    8.8392814e-15  0              4.2681726e-07  0              0              2.9964642    
   2600000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    1.8453919e-15  0              8.9107371e-08  0              0              2.9964642    
   2700000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    3.1393412e-16  0              1.5158755e-08  0              0              2.9964642    
   2800000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    3.4910783e-17  0              1.6857168e-09  0              0              2.9964642    
   2900000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    2.0735843e-19  0              1.0012597e-11  0              0              2.9964642    
   3000000   12000          100            100            0.019111273   -0.013307822    0              0.070641642    5.6492122e-18  0              2.7278024e-10  0              0              2.9964642    
Loop time of 540.591 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4794751.926 ns/day, 0.000 hours/ns, 5549.481 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.338     | 99.253     | 130.23     | 308.5 | 18.36
Neigh   | 1.8021     | 1.8184     | 1.8343     |   1.0 |  0.34
Comm    | 24.913     | 55.194     | 86.578     | 403.3 | 10.21
Output  | 0.4794     | 0.47979    | 0.48022    |   0.1 |  0.09
Modify  | 266.44     | 307.12     | 347.01     | 225.7 | 56.81
Other   |            | 76.72      |            |       | 14.19

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019290713    1.2403874e-16  0              0.05787214     1671194.3      0              8.0695992e+13  0              0              3.3213795    
    200000   12000          100            100            0.0071110739   1.2403874e-16  0              0.021333222    433523.1       0              2.0933279e+13  0              0              3.0648916    
    300000   12000          100            100            0.0010171692   1.2403874e-16  0              0.0030515075   16950.165      0              8.1846278e+11  0              0              3.043546     
    400000   12000          100            100            0.0047453691  -0.005633787    0              0.019869894    28704.445      0              1.3860349e+12  0              0              2.9980107    
    500000   12000          100            100            0.001658631   -0.0011988719   0              0.006174765    1453.728       0              7.0195322e+10  0              0              2.9989051    
    600000   12000          100            100            0.011151136   -0.0061849541   0              0.039638363    130.04242      0              6.279283e+09   0              0              2.9973789    
    700000   12000          100            100            0.02358347    -0.013359697    0              0.084110106    8.3974006      0              4.0548042e+08  0              0              2.9961939    
    800000   12000          100            100            0.017601839   -0.013084609    0              0.065890125    0.91255845     0              44064182       0              0              2.9966311    
    900000   12000          100            100            0.019691308   -0.012693223    0              0.071767148    1.0306437      0              49766096       0              0              2.9964828    
   1000000   12000          100            100            0.019288605   -0.012757341    0              0.070623155    0.22329647     0              10782187       0              0              2.9965118    
   1100000   12000          100            100            0.019252763   -0.012743547    0              0.070501837    0.02039177     0              984645.57      0              0              2.9965144    
   1200000   12000          100            100            0.019325837   -0.012750767    0              0.070728278    0.00042836417  0              20684.173      0              0              2.9965089    
   1300000   12000          100            100            0.019288119   -0.012746932    0              0.07061129     4.8906841e-05  0              2361.5363      0              0              2.9965118    
   1400000   12000          100            100            0.019300534   -0.012748194    0              0.070649796    4.7591844e-05  0              2298.0398      0              0              2.9965109    
   1500000   12000          100            100            0.019298287   -0.012747959    0              0.07064282     9.762395e-06   0              471.39112      0              0              2.996511     
   1600000   12000          100            100            0.019297944   -0.012747927    0              0.070641758    8.3560205e-07  0              40.348233      0              0              2.9965111    
   1700000   12000          100            100            0.019298448   -0.012747978    0              0.070643321    1.4134915e-08  0              0.68252445     0              0              2.996511     
   1800000   12000          100            100            0.019298197   -0.012747952    0              0.070642543    2.779365e-09   0              0.13420559     0              0              2.996511     
   1900000   12000          100            100            0.019298277   -0.01274796     0              0.070642791    2.2109183e-09  0              0.10675733     0              0              2.996511     
   2000000   12000          100            100            0.019298263   -0.012747959    0              0.070642749    4.2513942e-10  0              0.020528461    0              0              2.996511     
   2100000   12000          100            100            0.019298261   -0.012747959    0              0.070642741    3.4012337e-11  0              0.001642334    0              0              2.996511     
   2200000   12000          100            100            0.019298264   -0.012747959    0              0.070642751    4.4406858e-13  0              2.1442482e-05  0              0              2.996511     
   2300000   12000          100            100            0.019298262   -0.012747959    0              0.070642746    1.5187314e-13  0              7.3334106e-06  0              0              2.996511     
   2400000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    1.0297714e-13  0              4.9723974e-06  0              0              2.996511     
   2500000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    1.8433097e-14  0              8.9006828e-07  0              0              2.996511     
   2600000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    1.3988044e-15  0              6.754326e-08   0              0              2.996511     
   2700000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    4.0652107e-17  0              1.9629448e-09  0              0              2.996511     
   2800000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    1.6978678e-17  0              8.1983958e-10  0              0              2.996511     
   2900000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    9.823595e-18   0              4.7434625e-10  0              0              2.996511     
   3000000   12000          100            100            0.019298263   -0.012747959    0              0.070642748    7.36023e-19    0              3.5539916e-11  0              0              2.996511     
Loop time of 539.16 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4807482.078 ns/day, 0.000 hours/ns, 5564.215 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.137     | 98.875     | 129.62     | 306.1 | 18.34
Neigh   | 1.8392     | 1.8525     | 1.8658     |   0.9 |  0.34
Comm    | 23.841     | 54.619     | 85.509     | 404.6 | 10.13
Output  | 0.48119    | 0.48161    | 0.48203    |   0.1 |  0.09
Modify  | 266.09     | 306.77     | 346.67     | 227.7 | 56.90
Other   |            | 76.56      |            |       | 14.20

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019296581    1.2403874e-16  0              0.057889744    1671950.9      0              8.0732526e+13  0              0              3.3211803    
    200000   12000          100            100            0.0071243631   1.2403874e-16  0              0.021373089    434784.32      0              2.0994179e+13  0              0              3.0645312    
    300000   12000          100            100            0.001039037    1.2403874e-16  0              0.0031171109   17623.547      0              8.5097802e+11  0              0              3.0434224    
    400000   12000          100            100            0.0012333446  -0.00072994944  0              0.0044299832   26845.505      0              1.2962734e+12  0              0              2.9988831    
    500000   12000          100            100            0.00049794043 -0.00046509664  0              0.0019589179   344.74592      0              1.6646547e+10  0              0              2.9993741    
    600000   12000          100            100            0.012701543   -0.0045108704   0              0.042615499    242.9382       0              1.1730616e+10  0              0              2.9973359    
    700000   12000          100            100            0.017717369   -0.014396094    0              0.067548203    88.918208      0              4.293542e+09   0              0              2.9966276    
    800000   12000          100            100            0.021008573   -0.012719282    0              0.075745       0.062537167    0              3019696        0              0              2.9964337    
    900000   12000          100            100            0.019178439   -0.013111194    0              0.07064651     1.6775618      0              81003454       0              0              2.9965567    
   1000000   12000          100            100            0.018991266   -0.012993657    0              0.069967455    0.0010076576   0              48656.181      0              0              2.9965726    
   1100000   12000          100            100            0.019212828   -0.013038021    0              0.070676505    0.029662106    0              1432276.9      0              0              2.9965552    
   1200000   12000          100            100            0.019230968   -0.013040024    0              0.070732927    0.00019205552  0              9273.6736      0              0              2.9965539    
   1300000   12000          100            100            0.019199356   -0.01303601     0              0.070634077    0.00049688632  0              23992.862      0              0              2.9965563    
   1400000   12000          100            100            0.019198829   -0.013035962    0              0.07063245     1.0516139e-05  0              507.78672      0              0              2.9965564    
   1500000   12000          100            100            0.019203093   -0.013036549    0              0.070645828    7.7873812e-06  0              376.02477      0              0              2.996556     
   1600000   12000          100            100            0.019202897   -0.013036519    0              0.070645209    3.7256357e-07  0              17.989761      0              0              2.9965561    
   1700000   12000          100            100            0.019202336   -0.013036442    0              0.070643451    1.1325295e-07  0              5.4685797      0              0              2.9965561    
   1800000   12000          100            100            0.019202398   -0.013036451    0              0.070643644    1.0621689e-08  0              0.51288334     0              0              2.9965561    
   1900000   12000          100            100            0.019202469   -0.01303646     0              0.070643868    1.5005856e-09  0              0.072457909    0              0              2.9965561    
   2000000   12000          100            100            0.019202457   -0.013036459    0              0.070643828    2.6467823e-10  0              0.012780365    0              0              2.9965561    
   2100000   12000          100            100            0.019202448   -0.013036457    0              0.070643801    1.7505678e-11  0              0.00084528656  0              0              2.9965561    
   2200000   12000          100            100            0.01920245    -0.013036458    0              0.070643808    5.9867174e-12  0              0.00028907716  0              0              2.9965561    
   2300000   12000          100            100            0.019202451   -0.013036458    0              0.070643811    1.6721816e-13  0              8.0743664e-06  0              0              2.9965561    
   2400000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     1.2576095e-13  0              6.072546e-06   0              0              2.9965561    
   2500000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     1.1192944e-15  0              5.4046723e-08  0              0              2.9965561    
   2600000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     2.4533178e-15  0              1.1846194e-07  0              0              2.9965561    
   2700000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     6.8589545e-18  0              3.3119436e-10  0              0              2.9965561    
   2800000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     4.0845142e-17  0              1.9722657e-09  0              0              2.9965561    
   2900000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     1.1799419e-17  0              5.6975173e-10  0              0              2.9965561    
   3000000   12000          100            100            0.019202451   -0.013036458    0              0.07064381     8.370689e-19   0              4.0419061e-11  0              0              2.9965561    
Loop time of 540.359 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4796813.462 ns/day, 0.000 hours/ns, 5551.867 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.942     | 99.424     | 129.89     | 304.8 | 18.40
Neigh   | 1.8487     | 1.8641     | 1.8794     |   0.9 |  0.34
Comm    | 24.44      | 54.619     | 85.158     | 401.6 | 10.11
Output  | 0.47977    | 0.48014    | 0.48055    |   0.1 |  0.09
Modify  | 266.11     | 306.87     | 347.04     | 227.7 | 56.79
Other   |            | 77.1       |            |       | 14.27

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019302251    1.2403874e-16  0              0.057906753    1672682.2      0              8.0767835e+13  0              0              3.3209875    
    200000   12000          100            100            0.0071372089   1.2403874e-16  0              0.021411627    436004.56      0              2.10531e+13    0              0              3.064182     
    300000   12000          100            100            0.0010602128   1.2403874e-16  0              0.0031806385   18286.025      0              8.8296671e+11  0              0              3.0432985    
    400000   12000          100            100           -0.00076941307  1.3340981e-05  0             -0.0023215802   24766.809      0              1.1959006e+12  0              0              2.9996971    
    500000   12000          100            100            0.00028927312 -0.00040077111  0              0.0012685905   0.75378566     0              36397612       0              0              2.9995494    
    600000   12000          100            100            0.022328682   -0.010601653    0              0.077587699    683.44698      0              3.3001209e+10  0              0              2.9964491    
    700000   12000          100            100            0.016565364   -0.0098506179   0              0.059546711    30.485962      0              1.472058e+09   0              0              2.9968813    
    800000   12000          100            100            0.017705569   -0.012572982    0              0.065689689    0.48239069     0              23292920       0              0              2.9967207    
    900000   12000          100            100            0.018986705   -0.012632909    0              0.069593024    1.1639081      0              56200958       0              0              2.9966244    
   1000000   12000          100            100            0.019380937   -0.012628532    0              0.070771344    0.21851113     0              10551121       0              0              2.9965962    
   1100000   12000          100            100            0.019403476   -0.012641189    0              0.070851616    0.0096361422   0              465294.82      0              0              2.9965944    
   1200000   12000          100            100            0.019367359   -0.01263348     0              0.070735559    0.00012989156  0              6271.9987      0              0              2.9965973    
   1300000   12000          100            100            0.019344859   -0.012629953    0              0.070664531    0.00036608467  0              17676.918      0              0              2.996599     
   1400000   12000          100            100            0.019337968   -0.012629055    0              0.07064296     7.1963172e-05  0              3474.844       0              0              2.9965995    
   1500000   12000          100            100            0.019337407   -0.012628987    0              0.070641207    3.4984349e-06  0              168.9269       0              0              2.9965996    
   1600000   12000          100            100            0.019338038   -0.012629072    0              0.070643186    2.5727451e-08  0              1.2422865      0              0              2.9965995    
   1700000   12000          100            100            0.019338444   -0.012629126    0              0.070644458    1.1234397e-07  0              5.4246884      0              0              2.9965995    
   1800000   12000          100            100            0.019338572   -0.012629143    0              0.070644857    2.3682715e-08  0              1.1435535      0              0              2.9965995    
   1900000   12000          100            100            0.019338584   -0.012629144    0              0.070644896    1.2623159e-09  0              0.060952715    0              0              2.9965995    
   2000000   12000          100            100            0.019338573   -0.012629143    0              0.070644862    4.3013275e-12  0              0.00020769571  0              0              2.9965995    
   2100000   12000          100            100            0.019338566   -0.012629142    0              0.07064484     3.4303373e-11  0              0.0016563871   0              0              2.9965995    
   2200000   12000          100            100            0.019338563   -0.012629142    0              0.070644832    7.7685654e-12  0              0.00037511622  0              0              2.9965995    
   2300000   12000          100            100            0.019338563   -0.012629142    0              0.070644831    4.5045031e-13  0              2.1750633e-05  0              0              2.9965995    
   2400000   12000          100            100            0.019338563   -0.012629142    0              0.070644832    4.1926491e-16  0              2.0244802e-08  0              0              2.9965995    
   2500000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    1.029936e-14   0              4.9731923e-07  0              0              2.9965995    
   2600000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    2.5485262e-15  0              1.2305921e-07  0              0              2.9965995    
   2700000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    1.2058341e-16  0              5.8225411e-09  0              0              2.9965995    
   2800000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    2.5530881e-18  0              1.2327949e-10  0              0              2.9965995    
   2900000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    1.6698373e-17  0              8.0630467e-10  0              0              2.9965995    
   3000000   12000          100            100            0.019338564   -0.012629142    0              0.070644832    6.2768336e-20  0              3.0308583e-12  0              0              2.9965995    
Loop time of 543.742 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4766969.400 ns/day, 0.000 hours/ns, 5517.326 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.398     | 99.608     | 131.52     | 309.5 | 18.32
Neigh   | 1.8302     | 1.8473     | 1.8632     |   0.9 |  0.34
Comm    | 25.406     | 55.628     | 88.232     | 403.2 | 10.23
Output  | 0.47754    | 0.47796    | 0.47839    |   0.1 |  0.09
Modify  | 267.03     | 309.19     | 348.67     | 224.8 | 56.86
Other   |            | 76.99      |            |       | 14.16

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:            970 ave        1372 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019307734    1.2403874e-16  0              0.057923203    1673389.5      0              8.0801988e+13  0              0              3.320801     
    200000   12000          100            100            0.0071496362   1.2403874e-16  0              0.021448909    437186.08      0              2.1110151e+13  0              0              3.0638435    
    300000   12000          100            100            0.0010807339   1.2403874e-16  0              0.0032422016   18937.694      0              9.1443347e+11  0              0              3.0431744    
    400000   12000          100            100           -0.00092875934  1.2403874e-16  0             -0.002786278    22747.52       0              1.0983963e+12  0              0              3.0004539    
    500000   12000          100            100            0.0006269145  -0.00036559676  0              0.0022463403   380.80855      0              1.8387882e+10  0              0              2.9994608    
    600000   12000          100            100            0.031012833   -0.018445445    0              0.11148395     31.254881      0              1.5091863e+09  0              0              2.9957813    
    700000   12000          100            100            0.023378952   -0.01272391     0              0.082860766    27.861284      0              1.3453217e+09  0              0              2.9963646    
    800000   12000          100            100            0.02097218    -0.01223251     0              0.075149049    3.2811278      0              1.5843392e+08  0              0              2.9965366    
    900000   12000          100            100            0.01999057    -0.012376828    0              0.072348538    0.33887259     0              16362944       0              0              2.9966012    
   1000000   12000          100            100            0.019626183   -0.012412346    0              0.071290895    0.031746439    0              1532921.9      0              0              2.996626     
   1100000   12000          100            100            0.019490146   -0.012418538    0              0.070888977    0.0026468023   0              127804.61      0              0              2.9966355    
   1200000   12000          100            100            0.019441788   -0.012411469    0              0.070736832    0.00018575927  0              8969.6503      0              0              2.9966391    
   1300000   12000          100            100            0.019423586   -0.012408883    0              0.07067964     9.2720194e-06  0              447.71263      0              0              2.9966404    
   1400000   12000          100            100            0.01941679    -0.012407928    0              0.070658297    1.548457e-07   0              7.4769447      0              0              2.996641     
   1500000   12000          100            100            0.019414271   -0.012407576    0              0.07065039     1.478121e-08   0              0.71373171     0              0              2.9966411    
   1600000   12000          100            100            0.019413345   -0.012407446    0              0.070647481    2.0066959e-08  0              0.96896164     0              0              2.9966412    
   1700000   12000          100            100            0.019413007   -0.012407399    0              0.070646418    7.5929583e-09  0              0.36663678     0              0              2.9966412    
   1800000   12000          100            100            0.019412884   -0.012407381    0              0.070646033    1.9908286e-09  0              0.096129988    0              0              2.9966412    
   1900000   12000          100            100            0.01941284    -0.012407375    0              0.070645894    4.3619343e-10  0              0.021062219    0              0              2.9966412    
   2000000   12000          100            100            0.019412824   -0.012407373    0              0.070645845    8.5777254e-11  0              0.0041418766   0              0              2.9966412    
   2100000   12000          100            100            0.019412818   -0.012407372    0              0.070645827    1.5674206e-11  0              0.00075685132  0              0              2.9966412    
   2200000   12000          100            100            0.019412816   -0.012407372    0              0.070645821    2.712149e-12   0              0.00013095997  0              0              2.9966412    
   2300000   12000          100            100            0.019412816   -0.012407372    0              0.070645819    4.5167199e-13  0              2.1809624e-05  0              0              2.9966412    
   2400000   12000          100            100            0.019412815   -0.012407372    0              0.070645818    7.2232193e-14  0              3.4878341e-06  0              0              2.9966412    
   2500000   12000          100            100            0.019412815   -0.012407372    0              0.070645818    1.1242697e-14  0              5.428696e-07   0              0              2.9966412    
   2600000   12000          100            100            0.019412815   -0.012407372    0              0.070645818    1.744901e-15   0              8.4255023e-08  0              0              2.9966412    
   2700000   12000          100            100            0.019412815   -0.012407372    0              0.070645817    2.0116612e-16  0              9.7135919e-09  0              0              2.9966412    
   2800000   12000          100            100            0.019412815   -0.012407372    0              0.070645817    4.1357153e-17  0              1.9969889e-09  0              0              2.9966412    
   2900000   12000          100            100            0.019412815   -0.012407372    0              0.070645817    1.1557972e-18  0              5.5809311e-11  0              0              2.9966412    
   3000000   12000          100            100            0.019412815   -0.012407372    0              0.070645817    1.6939227e-17  0              8.1793463e-10  0              0              2.9966412    
Loop time of 541.66 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4785285.580 ns/day, 0.000 hours/ns, 5538.525 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.456     | 99.133     | 129.75     | 303.6 | 18.30
Neigh   | 1.8205     | 1.8371     | 1.8534     |   1.0 |  0.34
Comm    | 23.952     | 53.644     | 85.214     | 404.8 |  9.90
Output  | 0.48095    | 0.48133    | 0.48176    |   0.1 |  0.09
Modify  | 266.56     | 308.11     | 349.87     | 230.5 | 56.88
Other   |            | 78.46      |            |       | 14.48

Nlocal:         1414.5 ave        1709 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:            970 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3880
Ave neighs/atom = 0.68575468
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -6000.00000000001 6000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -6000.00000000001 6000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-6000 -50 -50) to (6000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4242.64068711929 4242.64068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2829 atoms
  using lattice units in orthogonal box = (-6000 -50 -50) to (6000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2829 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2829 settings made for mass


group substrate region substrate           # Define gorup
2829 atoms in group substrate
group slider1 region slider1
2829 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2829 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 7742 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 49.12 | 49.12 | 49.12 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12000          100            100            4.1346247e-17  1.2403874e-16  0              0              0              0              0              0              0              6            
    100000   12000          100            100            0.019313041    1.2403874e-16  0              0.057939124    1674074.2      0              8.083505e+13   0              0              3.3206202    
    200000   12000          100            100            0.0071616682   1.2403874e-16  0              0.021485005    438330.98      0              2.1165434e+13  0              0              3.0635152    
    300000   12000          100            100            0.0011006343   1.2403874e-16  0              0.0033019029   19578.675      0              9.4538414e+11  0              0              3.0430503    
    400000   12000          100            100           -0.00089513936  1.2403874e-16  0             -0.0026854181   20879.327      0              1.008188e+12   0              0              3.0011578    
    500000   12000          100            100            0.0018475749   1.2569731e-05  0              0.0055301551   1366.09        0              6.5963599e+10  0              0              2.9991415    
    600000   12000          100            100            0.024933032   -0.018736719    0              0.093535814    484.55184      0              2.3397274e+10  0              0              2.9961715    
    700000   12000          100            100            0.019604395   -0.01421773     0              0.073030914    92.399532      0              4.4616427e+09  0              0              2.9966213    
    800000   12000          100            100            0.018409824   -0.012180016    0              0.067409489    7.8365747      0              3.7840015e+08  0              0              2.9967571    
    900000   12000          100            100            0.01887676    -0.01211853     0              0.068748811    2.9837064e-05  0              1440.725       0              0              2.9967265    
   1000000   12000          100            100            0.019337892   -0.012205516    0              0.070219193    0.14206097     0              6859615.9      0              0              2.9966918    
   1100000   12000          100            100            0.019490582   -0.012236323    0              0.070708069    0.029226114    0              1411224.5      0              0              2.9966802    
   1200000   12000          100            100            0.019497995   -0.012237882    0              0.070731866    0.00076152798  0              36771.461      0              0              2.9966795    
   1300000   12000          100            100            0.019480954   -0.012234781    0              0.070677643    0.00010511899  0              5075.8196      0              0              2.9966808    
   1400000   12000          100            100            0.019472136   -0.012233144    0              0.070649551    7.1008198e-05  0              3428.7318      0              0              2.9966815    
   1500000   12000          100            100            0.019470365   -0.012232807    0              0.070643901    6.2618032e-06  0              302.36007      0              0              2.9966816    
   1600000   12000          100            100            0.019470734   -0.012232872    0              0.070645073    4.035434e-10   0              0.019485667    0              0              2.9966816    
   1700000   12000          100            100            0.019471142   -0.012232948    0              0.070646372    1.0687337e-07  0              5.1605324      0              0              2.9966815    
   1800000   12000          100            100            0.01947128    -0.012232973    0              0.070646813    2.3473983e-08  0              1.1334746      0              0              2.9966815    
   1900000   12000          100            100            0.019471289   -0.012232975    0              0.070646841    7.0872447e-10  0              0.034221768    0              0              2.9966815    
   2000000   12000          100            100            0.019471274   -0.012232973    0              0.070646795    6.931364e-11   0              0.0033469076   0              0              2.9966815    
   2100000   12000          100            100            0.019471266   -0.012232971    0              0.07064677     5.4898916e-11  0              0.0026508722   0              0              2.9966815    
   2200000   12000          100            100            0.019471265   -0.012232971    0              0.070646764    5.2612934e-12  0              0.00025404903  0              0              2.9966815    
   2300000   12000          100            100            0.019471265   -0.012232971    0              0.070646765    3.7885167e-15  0              1.8293392e-07  0              0              2.9966815    
   2400000   12000          100            100            0.019471265   -0.012232971    0              0.070646766    7.7420977e-14  0              3.7383819e-06  0              0              2.9966815    
   2500000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    1.8923286e-14  0              9.1373774e-07  0              0              2.9966815    
   2600000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    6.7460294e-16  0              3.2574162e-08  0              0              2.9966815    
   2700000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    9.4217468e-18  0              4.5494243e-10  0              0              2.9966815    
   2800000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    4.3495926e-17  0              2.1002626e-09  0              0              2.9966815    
   2900000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    5.3363007e-18  0              2.5767086e-10  0              0              2.9966815    
   3000000   12000          100            100            0.019471265   -0.012232971    0              0.070646767    2.7586232e-18  0              1.3320404e-10  0              0              2.9966815    
Loop time of 541.501 on 4 procs for 3000000 steps with 5658 atoms

Performance: 4786694.280 ns/day, 0.000 hours/ns, 5540.155 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.695     | 99.155     | 129.38     | 301.7 | 18.31
Neigh   | 1.8509     | 1.8666     | 1.8818     |   0.9 |  0.34
Comm    | 24.484     | 54.397     | 85.421     | 398.4 | 10.05
Output  | 0.48055    | 0.48094    | 0.48136    |   0.1 |  0.09
Modify  | 266.52     | 308.01     | 348.97     | 228.9 | 56.88
Other   |            | 77.59      |            |       | 14.33

Nlocal:         1414.5 ave        1708 max        1121 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:            3.5 ave           4 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:          970.5 ave        1373 max         568 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 3882
Ave neighs/atom = 0.68610817
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 6:05:36

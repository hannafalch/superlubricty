LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027075015    1.0583189e-20  0              0.081225044    1168384.7      0              5.6417117e+13 -1.5            0              3.3268976    
    200000   6000           100            100            0.0097924656   2.6576258e-21  0              0.029377397    294073.55      0              1.4199759e+13 -1.5            0              3.070477     
    300000   6000           100            100            0.0013760274   5.9940671e-22  0              0.0041280822   11047.413      0              5.3344005e+11 -1.5            0              3.0441249    
    400000   6000           100            100           -0.0010945615  -1.3259928e-21  0             -0.0032836845   10592.52       0              5.1147488e+11 -1.5            0              3.0037741    
    500000   6000           100            100            0.067444569   -3.1176419e-16  0              0.20233371     2182.8433      0              1.0540169e+11 -1.5            0              2.9964155    
    600000   6000           100            100            0.052321082   -2.3871617e-16  0              0.15696325     18.498834      0              8.9324249e+08 -1.5            0              2.9969925    
    700000   6000           100            100            0.029896825   -1.3707694e-16  0              0.089690474    41.095997      0              1.9843786e+09 -1.5            0              2.9979245    
    800000   6000           100            100            0.033308051   -1.5205116e-16  0              0.099924152    7.073011       0              3.4153039e+08 -1.5            0              2.9977747    
    900000   6000           100            100            0.033687099   -1.5401556e-16  0              0.1010613      0.68557088     0              33103764      -1.5            0              2.9977559    
   1000000   6000           100            100            0.033071261   -1.511362e-16   0              0.099213782    0.03373158     0              1628777.3     -1.5            0              2.9977839    
   1100000   6000           100            100            0.033409273   -1.526924e-16   0              0.10022782     0.00013263464  0              6404.4523     -1.5            0              2.9977687    
   1200000   6000           100            100            0.033275446   -1.5208171e-16  0              0.099826337    0.00024769919  0              11960.507     -1.5            0              2.9977747    
   1300000   6000           100            100            0.03331671    -1.5226831e-16  0              0.099950131    0.00012659196  0              6112.6726     -1.5            0              2.9977729    
   1400000   6000           100            100            0.033307663   -1.5222809e-16  0              0.099922988    2.553134e-05   0              1232.817      -1.5            0              2.9977733    
   1500000   6000           100            100            0.033308158   -1.522299e-16   0              0.099924474    3.0545413e-06  0              147.49287     -1.5            0              2.9977733    
   1600000   6000           100            100            0.033308978   -1.5223378e-16  0              0.099926933    2.1131771e-07  0              10.203776     -1.5            0              2.9977732    
   1700000   6000           100            100            0.033308405   -1.5223113e-16  0              0.099925214    4.7186585e-09  0              0.22784713    -1.5            0              2.9977732    
   1800000   6000           100            100            0.03330866    -1.522323e-16   0              0.099925979    2.1006051e-10  0              0.01014307    -1.5            0              2.9977732    
   1900000   6000           100            100            0.033308572   -1.522319e-16   0              0.099925717    3.0991908e-10  0              0.014964883   -1.5            0              2.9977732    
   2000000   6000           100            100            0.033308595   -1.5223201e-16  0              0.099925785    8.4090277e-11  0              0.0040604185  -1.5            0              2.9977732    
   2100000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    1.2412434e-11  0              0.00059935202 -1.5            0              2.9977732    
   2200000   6000           100            100            0.033308591   -1.5223199e-16  0              0.099925773    1.1094445e-12  0              5.3571104e-05 -1.5            0              2.9977732    
   2300000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925776    4.7270197e-14  0              2.2825087e-06 -1.5            0              2.9977732    
   2400000   6000           100            100            0.033308591   -1.5223199e-16  0              0.099925774    1.9010479e-17  0              9.1794798e-10 -1.5            0              2.9977732    
   2500000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    6.1422863e-16  0              2.9658902e-08 -1.5            0              2.9977732    
   2600000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    1.9621571e-16  0              9.4745545e-09 -1.5            0              2.9977732    
   2700000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    1.8132907e-17  0              8.7557316e-10 -1.5            0              2.9977732    
   2800000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    4.4156523e-18  0              2.1321605e-10 -1.5            0              2.9977732    
   2900000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    3.0556935e-18  0              1.475485e-10  -1.5            0              2.9977732    
   3000000   6000           100            100            0.033308592   -1.5223199e-16  0              0.099925775    1.3311331e-18  0              6.4275653e-11 -1.5            0              2.9977732    
Loop time of 485.209 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5342023.010 ns/day, 0.000 hours/ns, 6182.897 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 205.66     | 210.83     | 215.78     |  31.3 | 43.45
Neigh   | 0.94305    | 0.95159    | 0.95767    |   0.6 |  0.20
Comm    | 24.326     | 29.327     | 35.009     |  91.6 |  6.04
Output  | 0.37667    | 0.3767     | 0.37677    |   0.0 |  0.08
Modify  | 213.86     | 217.28     | 221.27     |  23.1 | 44.78
Other   |            | 26.44      |            |       |  5.45

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02720083     1.0373282e-20  0              0.081602491    1176443.7      0              5.6806255e+13 -1.5            0              3.3240154    
    200000   6000           100            100            0.010044968    2.9081539e-21  0              0.030134905    305954.05      0              1.4773426e+13 -1.5            0              3.0658562    
    300000   6000           100            100            0.0017492594   6.3135846e-22  0              0.0052477781   17111.588      0              8.2625734e+11 -1.5            0              3.0425408    
    400000   6000           100            100           -0.00044236909 -8.3327187e-22  0             -0.0013271073   1511.544       0              7.2987051e+10 -1.5            0              3.0090954    
    500000   6000           100            100            0.043049539   -1.9248653e-16  0              0.12914862     3795.0981      0              1.832517e+11  -1.5            0              2.997846     
    600000   6000           100            100            0.01831671    -8.2685857e-17  0              0.054950131    226.88104      0              1.0955273e+10 -1.5            0              2.9987748    
    700000   6000           100            100            0.030015502   -1.3754778e-16  0              0.090046506    52.625927      0              2.5411177e+09 -1.5            0              2.9982819    
    800000   6000           100            100            0.035639954   -1.62846e-16    0              0.10691986     2.1801059      0              1.0526951e+08 -1.5            0              2.9980765    
    900000   6000           100            100            0.033949012   -1.5497819e-16  0              0.10184704     0.58150715     0              28078899      -1.5            0              2.9981389    
   1000000   6000           100            100            0.033103501   -1.5115059e-16  0              0.099310504    0.0788737      0              3808528.7     -1.5            0              2.9981697    
   1100000   6000           100            100            0.03320563    -1.5163947e-16  0              0.099616891    0.0034651542   0              167319.89     -1.5            0              2.9981658    
   1200000   6000           100            100            0.03332515    -1.5218396e-16  0              0.099975449    0.0018512102   0              89388.313     -1.5            0              2.9981614    
   1300000   6000           100            100            0.033327997   -1.5219399e-16  0              0.099983992    3.1041291e-06  0              149.88729     -1.5            0              2.9981613    
   1400000   6000           100            100            0.033313348   -1.5212686e-16  0              0.099940043    3.1772017e-05  0              1534.157      -1.5            0              2.9981618    
   1500000   6000           100            100            0.033311071   -1.5211681e-16  0              0.099933214    2.6751611e-07  0              12.917396     -1.5            0              2.9981619    
   1600000   6000           100            100            0.033312613   -1.5212392e-16  0              0.09993784     4.1018328e-07  0              19.806283     -1.5            0              2.9981619    
   1700000   6000           100            100            0.033313102   -1.5212612e-16  0              0.099939305    2.2173283e-08  0              1.0706685     -1.5            0              2.9981618    
   1800000   6000           100            100            0.033312972   -1.5212551e-16  0              0.099938915    3.7160673e-09  0              0.17943559    -1.5            0              2.9981618    
   1900000   6000           100            100            0.033312893   -1.5212516e-16  0              0.09993868     7.1268705e-10  0              0.034413107   -1.5            0              2.9981618    
   2000000   6000           100            100            0.033312899   -1.5212519e-16  0              0.099938698    1.7308648e-11  0              0.00083577267 -1.5            0              2.9981618    
   2100000   6000           100            100            0.03331291    -1.5212524e-16  0              0.09993873     1.5204499e-11  0              0.00073417086 -1.5            0              2.9981618    
   2200000   6000           100            100            0.033312911   -1.5212524e-16  0              0.099938732    1.2499339e-16  0              6.0354836e-09 -1.5            0              2.9981618    
   2300000   6000           100            100            0.03331291    -1.5212523e-16  0              0.099938729    2.4184885e-13  0              1.1678016e-05 -1.5            0              2.9981618    
   2400000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    3.8663826e-15  0              1.8669378e-07 -1.5            0              2.9981618    
   2500000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    2.9222501e-15  0              1.41105e-07   -1.5            0              2.9981618    
   2600000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    2.3066251e-16  0              1.1137867e-08 -1.5            0              2.9981618    
   2700000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    5.8915521e-17  0              2.8448197e-09 -1.5            0              2.9981618    
   2800000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    2.6776274e-18  0              1.2929305e-10 -1.5            0              2.9981618    
   2900000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    1.1590977e-19  0              5.5968681e-12 -1.5            0              2.9981618    
   3000000   6000           100            100            0.033312909   -1.5212523e-16  0              0.099938728    7.9919157e-18  0              3.8590101e-10 -1.5            0              2.9981618    
Loop time of 460.095 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5633621.671 ns/day, 0.000 hours/ns, 6520.395 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 199.67     | 202.68     | 206.36     |  21.1 | 44.05
Neigh   | 0.95273    | 0.95607    | 0.95935    |   0.3 |  0.21
Comm    | 24.851     | 27.92      | 30.908     |  45.5 |  6.07
Output  | 0.32691    | 0.32698    | 0.32711    |   0.0 |  0.07
Modify  | 202.5      | 203.8      | 205.27     |   7.8 | 44.29
Other   |            | 24.42      |            |       |  5.31

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027288853    1.0699149e-20  0              0.08186656     1182100.9      0              5.7079423e+13 -1.5            0              3.3219574    
    200000   6000           100            100            0.010223453    2.975235e-21   0              0.030670359    314443.05      0              1.518333e+13  -1.5            0              3.0624843    
    300000   6000           100            100            0.0020179813   4.003298e-22   0              0.0060539439   22126.364      0              1.0684029e+12 -1.5            0              3.0410077    
    400000   6000           100            100            5.1774734e-05 -8.319136e-22   0              0.0001553242   19.59427       0              9.461372e+08  -1.5            0              3.0104659    
    500000   6000           100            100           -0.00051995824 -2.6861645e-21  0             -0.0015598747   2132.8115      0              1.0298583e+11 -1.5            0              3.0000373    
    600000   6000           100            100            0.016176678   -7.2906015e-17  0              0.048530034    233.25366      0              1.1262984e+10 -1.5            0              2.9990291    
    700000   6000           100            100            0.03189674    -1.4621229e-16  0              0.09569022     69.463804      0              3.3541585e+09 -1.5            0              2.998458     
    800000   6000           100            100            0.036375785   -1.6614413e-16  0              0.10912736     0.24962487     0              12053492      -1.5            0              2.9983201    
    900000   6000           100            100            0.033622401   -1.5347352e-16  0              0.1008672      1.0522845      0              50811051      -1.5            0              2.9984066    
   1000000   6000           100            100            0.032960275   -1.5050922e-16  0              0.098880825    0.022545963    0              1088663.9     -1.5            0              2.9984273    
   1100000   6000           100            100            0.033244583   -1.518248e-16   0              0.099733749    0.013431544    0              648561.17     -1.5            0              2.9984181    
   1200000   6000           100            100            0.033354253   -1.523197e-16   0              0.10006276     0.00086816093  0              41920.384     -1.5            0              2.9984147    
   1300000   6000           100            100            0.033328198   -1.52198e-16    0              0.099984595    0.00014352058  0              6930.095      -1.5            0              2.9984155    
   1400000   6000           100            100            0.033311994   -1.521245e-16   0              0.099935982    2.3082969e-05  0              1114.594      -1.5            0              2.998416     
   1500000   6000           100            100            0.03331382    -1.5213323e-16  0              0.09994146     1.1638289e-06  0              56.197132     -1.5            0              2.998416     
   1600000   6000           100            100            0.033316032   -1.521433e-16   0              0.099948096    4.9623368e-07  0              23.961348     -1.5            0              2.9984159    
   1700000   6000           100            100            0.033316001   -1.5214311e-16  0              0.099948004    5.2679691e-09  0              0.25437138    -1.5            0              2.9984159    
   1800000   6000           100            100            0.033315719   -1.5214182e-16  0              0.099947157    9.1287142e-09  0              0.44079294    -1.5            0              2.9984159    
   1900000   6000           100            100            0.033315697   -1.5214173e-16  0              0.099947092    2.7986167e-13  0              1.3513519e-05 -1.5            0              2.9984159    
   2000000   6000           100            100            0.033315731   -1.5214188e-16  0              0.099947193    1.4681721e-10  0              0.0070892776  -1.5            0              2.9984159    
   2100000   6000           100            100            0.033315737   -1.5214191e-16  0              0.099947211    1.0589081e-12  0              5.1130881e-05 -1.5            0              2.9984159    
   2200000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947199    2.0669935e-12  0              9.9807719e-05 -1.5            0              2.9984159    
   2300000   6000           100            100            0.033315732   -1.5214189e-16  0              0.099947196    6.8071522e-14  0              3.2869302e-06 -1.5            0              2.9984159    
   2400000   6000           100            100            0.033315732   -1.5214189e-16  0              0.099947197    2.5178654e-14  0              1.2157871e-06 -1.5            0              2.9984159    
   2500000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    2.2243556e-15  0              1.0740617e-07 -1.5            0              2.9984159    
   2600000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    3.3603353e-16  0              1.6225857e-08 -1.5            0              2.9984159    
   2700000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    3.3004968e-17  0              1.5936918e-09 -1.5            0              2.9984159    
   2800000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    5.353022e-18   0              2.5847827e-10 -1.5            0              2.9984159    
   2900000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    1.4884757e-18  0              7.1873165e-11 -1.5            0              2.9984159    
   3000000   6000           100            100            0.033315733   -1.5214189e-16  0              0.099947198    6.4672696e-18  0              3.1228131e-10 -1.5            0              2.9984159    
Loop time of 457.145 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5669970.070 ns/day, 0.000 hours/ns, 6562.465 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 200.24     | 201.56     | 202.81     |   7.8 | 44.09
Neigh   | 0.93749    | 0.94073    | 0.94432    |   0.3 |  0.21
Comm    | 25.895     | 26.603     | 27.603     |  14.1 |  5.82
Output  | 0.32959    | 0.32965    | 0.32975    |   0.0 |  0.07
Modify  | 202.12     | 203.3      | 204.11     |   5.1 | 44.47
Other   |            | 24.41      |            |       |  5.34

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027355127    1.0666979e-20  0              0.08206538     1186370.9      0              5.7285603e+13 -1.5            0              3.3203848    
    200000   6000           100            100            0.010358851    3.0659421e-21  0              0.031076554    320932.79      0              1.5496696e+13 -1.5            0              3.0598679    
    300000   6000           100            100            0.0022244566   1.0332708e-21  0              0.0066733697   26320.943      0              1.2709441e+12 -1.5            0              3.0396196    
    400000   6000           100            100            0.00044211338 -7.60231e-22    0              0.0013263402   1317.0293      0              6.3594629e+10 -1.5            0              3.0102881    
    500000   6000           100            100            0.00050261658 -2.2889205e-21  0              0.0015078497   1697.0287      0              8.1943445e+10 -1.5            0              3.0005116    
    600000   6000           100            100            0.039646523   -1.8264956e-16  0              0.11893957     570.18859      0              2.7532366e+10 -1.5            0              2.9984172    
    700000   6000           100            100            0.024523275   -1.1184693e-16  0              0.073569826    7.213488       0              3.4831352e+08 -1.5            0              2.9988575    
    800000   6000           100            100            0.036633337   -1.6737164e-16  0              0.10990001     0.68826483     0              33233845      -1.5            0              2.9985053    
    900000   6000           100            100            0.032170309   -1.4691757e-16  0              0.096510928    0.11884645     0              5738669.6     -1.5            0              2.9986298    
   1000000   6000           100            100            0.033718791   -1.5401984e-16  0              0.10115637     0.021636297    0              1044739.3     -1.5            0              2.9985859    
   1100000   6000           100            100            0.033179197   -1.5154238e-16  0              0.099537591    0.0036876241   0              178062.17     -1.5            0              2.9986011    
   1200000   6000           100            100            0.03336545    -1.5239842e-16  0              0.10009635     0.00060328626  0              29130.534     -1.5            0              2.9985959    
   1300000   6000           100            100            0.033301426   -1.5210384e-16  0              0.099904277    9.5044288e-05  0              4589.3485     -1.5            0              2.9985977    
   1400000   6000           100            100            0.033323298   -1.5220461e-16  0              0.099969894    1.4552927e-05  0              702.70878     -1.5            0              2.9985971    
   1500000   6000           100            100            0.033315872   -1.5217035e-16  0              0.099947615    2.1749243e-06  0              105.01931     -1.5            0              2.9985973    
   1600000   6000           100            100            0.033318376   -1.5218192e-16  0              0.099955127    3.1849758e-07  0              15.379108     -1.5            0              2.9985972    
   1700000   6000           100            100            0.033317538   -1.5217804e-16  0              0.099952614    4.582395e-08   0              2.2126745     -1.5            0              2.9985972    
   1800000   6000           100            100            0.033317816   -1.5217933e-16  0              0.099953447    6.4913954e-09  0              0.31344625    -1.5            0              2.9985972    
   1900000   6000           100            100            0.033317725   -1.521789e-16   0              0.099953174    9.0686685e-10  0              0.043789355   -1.5            0              2.9985972    
   2000000   6000           100            100            0.033317754   -1.5217904e-16  0              0.099953263    1.2510076e-10  0              0.0060406679  -1.5            0              2.9985972    
   2100000   6000           100            100            0.033317745   -1.52179e-16    0              0.099953234    1.7063119e-11  0              0.00082391693 -1.5            0              2.9985972    
   2200000   6000           100            100            0.033317748   -1.5217901e-16  0              0.099953243    2.3032148e-12  0              0.000111214   -1.5            0              2.9985972    
   2300000   6000           100            100            0.033317747   -1.5217901e-16  0              0.09995324     3.0755147e-13  0              1.485056e-05  -1.5            0              2.9985972    
   2400000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    4.092999e-14   0              1.9763627e-06 -1.5            0              2.9985972    
   2500000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    5.3971418e-15  0              2.6060866e-07 -1.5            0              2.9985972    
   2600000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    6.9645255e-16  0              3.3629201e-08 -1.5            0              2.9985972    
   2700000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    3.3438341e-18  0              1.6146178e-10 -1.5            0              2.9985972    
   2800000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    1.4693287e-19  0              7.0948623e-12 -1.5            0              2.9985972    
   2900000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    8.3182341e-18  0              4.0165775e-10 -1.5            0              2.9985972    
   3000000   6000           100            100            0.033317747   -1.5217901e-16  0              0.099953241    9.3532823e-18  0              4.5163653e-10 -1.5            0              2.9985972    
Loop time of 458.85 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5648910.541 ns/day, 0.000 hours/ns, 6538.091 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 197.93     | 200.16     | 203.41     |  14.3 | 43.62
Neigh   | 0.95431    | 0.95685    | 0.95922    |   0.2 |  0.21
Comm    | 25.272     | 27.204     | 28.669     |  23.9 |  5.93
Output  | 0.32833    | 0.32838    | 0.32847    |   0.0 |  0.07
Modify  | 202.93     | 205.42     | 206.69     |  10.5 | 44.77
Other   |            | 24.79      |            |       |  5.40

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027407489    1.0857651e-20  0              0.082222467    1189751.1      0              5.744882e+13  -1.5            0              3.3191277    
    200000   6000           100            100            0.010466481    2.9242052e-21  0              0.031399444    326122.19      0              1.5747274e+13 -1.5            0              3.0577517    
    300000   6000           100            100            0.0023901648   1.0693884e-21  0              0.0071704945   29890.512      0              1.4433058e+12 -1.5            0              3.0383786    
    400000   6000           100            100            0.000760795   -4.5608313e-22  0              0.002282385    3727.1557      0              1.7997101e+11 -1.5            0              3.0094387    
    500000   6000           100            100            0.11781552    -5.3796284e-16  0              0.35344655     593.19931      0              2.8643472e+10 -1.5            0              2.9970662    
    600000   6000           100            100            0.0079391949  -3.6438185e-17  0              0.023817585    4.4353976      0              2.1416948e+08 -1.5            0              2.9995125    
    700000   6000           100            100            0.02687144    -1.2324951e-16  0              0.080614321    49.647382      0              2.3972944e+09 -1.5            0              2.998901     
    800000   6000           100            100            0.030365788   -1.3887605e-16  0              0.091097365    3.768627       0              1.8197351e+08 -1.5            0              2.9988096    
    900000   6000           100            100            0.032040025   -1.4641291e-16  0              0.096120075    0.082324895    0              3975174.5     -1.5            0              2.9987668    
   1000000   6000           100            100            0.032854148   -1.5010724e-16  0              0.098562444    0.004450116    0              214880.17     -1.5            0              2.9987461    
   1100000   6000           100            100            0.033178816   -1.5158883e-16  0              0.099536448    0.0064822178   0              313003.1      -1.5            0              2.9987378    
   1200000   6000           100            100            0.033286917   -1.5208484e-16  0              0.09986075     0.0019395811   0              93655.43      -1.5            0              2.9987351    
   1300000   6000           100            100            0.033316049   -1.5221956e-16  0              0.099948147    0.00034134918  0              16482.53      -1.5            0              2.9987343    
   1400000   6000           100            100            0.033321286   -1.5224428e-16  0              0.099963858    4.1534736e-05  0              2005.5638     -1.5            0              2.9987342    
   1500000   6000           100            100            0.033320994   -1.5224325e-16  0              0.099962982    3.4300631e-06  0              165.62547     -1.5            0              2.9987342    
   1600000   6000           100            100            0.033320137   -1.5223944e-16  0              0.099960412    1.5036593e-07  0              7.2606328     -1.5            0              2.9987342    
   1700000   6000           100            100            0.033319616   -1.5223708e-16  0              0.099958848    2.9674159e-10  0              0.014328589   -1.5            0              2.9987342    
   1800000   6000           100            100            0.033319385   -1.5223603e-16  0              0.099958155    1.452114e-09   0              0.07011739    -1.5            0              2.9987342    
   1900000   6000           100            100            0.0333193     -1.5223565e-16  0              0.099957901    7.3135381e-10  0              0.035314458   -1.5            0              2.9987342    
   2000000   6000           100            100            0.033319275   -1.5223553e-16  0              0.099957825    1.6351351e-10  0              0.007895482   -1.5            0              2.9987342    
   2100000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957807    2.3997518e-11  0              0.0011587542  -1.5            0              2.9987342    
   2200000   6000           100            100            0.033319268   -1.522355e-16   0              0.099957805    2.4571778e-12  0              0.00011864832 -1.5            0              2.9987342    
   2300000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957806    1.6000409e-13  0              7.7260248e-06 -1.5            0              2.9987342    
   2400000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957807    3.7422066e-15  0              1.8069776e-07 -1.5            0              2.9987342    
   2500000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957807    9.4157527e-17  0              4.54653e-09   -1.5            0              2.9987342    
   2600000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957807    3.1873814e-16  0              1.5390724e-08 -1.5            0              2.9987342    
   2700000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957808    1.9702485e-17  0              9.5136249e-10 -1.5            0              2.9987342    
   2800000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957808    3.5064991e-18  0              1.6931629e-10 -1.5            0              2.9987342    
   2900000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957808    4.0615005e-18  0              1.9611532e-10 -1.5            0              2.9987342    
   3000000   6000           100            100            0.033319269   -1.522355e-16   0              0.099957808    2.4713668e-18  0              1.1933346e-10 -1.5            0              2.9987342    
Loop time of 456.935 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5672580.209 ns/day, 0.000 hours/ns, 6565.486 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 199.99     | 200.78     | 201.71     |   4.5 | 43.94
Neigh   | 0.95577    | 0.95788    | 0.95991    |   0.2 |  0.21
Comm    | 25.858     | 26.393     | 26.867     |   7.5 |  5.78
Output  | 0.32864    | 0.3287     | 0.32881    |   0.0 |  0.07
Modify  | 203.09     | 204.07     | 204.8      |   4.3 | 44.66
Other   |            | 24.41      |            |       |  5.34

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027450295    1.0338262e-20  0              0.082350885    1192518.7      0              5.7582459e+13 -1.5            0              3.3180904    
    200000   6000           100            100            0.01055489     3.1859058e-21  0              0.031664671    330405.08      0              1.5954079e+13 -1.5            0              3.0559894    
    300000   6000           100            100            0.0025273112   1.1050545e-21  0              0.0075819336   32976.104      0              1.592298e+12  -1.5            0              3.0372687    
    400000   6000           100            100            0.001027646   -3.9153743e-22  0              0.003082938    6566.1897      0              3.170578e+11  -1.5            0              3.0082912    
    500000   6000           100            100            0.0167004     -8.1560784e-17  0              0.050101201    4463.6574      0              2.1553404e+11 -1.5            0              2.9992476    
    600000   6000           100            100            0.0076539986  -3.4607145e-17  0              0.022961996    72.224226      0              3.4874494e+09 -1.5            0              2.9995696    
    700000   6000           100            100            0.036477257   -1.6626698e-16  0              0.10943177     80.513064      0              3.8876877e+09 -1.5            0              2.9987725    
    800000   6000           100            100            0.03321027    -1.5217094e-16  0              0.099630809    11.113026      0              5.3660827e+08 -1.5            0              2.9988437    
    900000   6000           100            100            0.033126862   -1.5148918e-16  0              0.099380587    1.3907972      0              67156622      -1.5            0              2.9988469    
   1000000   6000           100            100            0.033449315   -1.530686e-16   0              0.10034794     0.16903894     0              8162285.4     -1.5            0              2.9988389    
   1100000   6000           100            100            0.033252839   -1.5213412e-16  0              0.099758518    0.01983305     0              957666.99     -1.5            0              2.9988436    
   1200000   6000           100            100            0.033351798   -1.525988e-16   0              0.10005539     0.0022515267   0              108718.17     -1.5            0              2.9988413    
   1300000   6000           100            100            0.033306866   -1.5238931e-16  0              0.099920598    0.00024547305  0              11853.015     -1.5            0              2.9988424    
   1400000   6000           100            100            0.033326112   -1.5247862e-16  0              0.099978336    2.5563015e-05  0              1234.3465     -1.5            0              2.9988419    
   1500000   6000           100            100            0.0333182     -1.5244203e-16  0              0.0999546      2.514442e-06   0              121.41341     -1.5            0              2.9988421    
   1600000   6000           100            100            0.033321354   -1.5245658e-16  0              0.099964063    2.2968171e-07  0              11.090508     -1.5            0              2.998842     
   1700000   6000           100            100            0.033320127   -1.5245093e-16  0              0.099960382    1.890237e-08   0              0.91272779    -1.5            0              2.998842     
   1800000   6000           100            100            0.033320595   -1.5245308e-16  0              0.099961784    1.3201845e-09  0              0.063746986   -1.5            0              2.998842     
   1900000   6000           100            100            0.03332042    -1.5245227e-16  0              0.09996126     6.7586933e-11  0              0.0032635311  -1.5            0              2.998842     
   2000000   6000           100            100            0.033320484   -1.5245257e-16  0              0.099961453    1.4224792e-12  0              6.8686431e-05 -1.5            0              2.998842     
   2100000   6000           100            100            0.033320461   -1.5245246e-16  0              0.099961383    4.1206651e-14  0              1.9897217e-06 -1.5            0              2.998842     
   2200000   6000           100            100            0.033320469   -1.524525e-16   0              0.099961408    8.7540814e-14  0              4.2270326e-06 -1.5            0              2.998842     
   2300000   6000           100            100            0.033320466   -1.5245249e-16  0              0.099961399    3.3864122e-14  0              1.6351773e-06 -1.5            0              2.998842     
   2400000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961402    8.6106105e-15  0              4.1577557e-07 -1.5            0              2.998842     
   2500000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    1.7382472e-15  0              8.3933735e-08 -1.5            0              2.998842     
   2600000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    3.0867876e-16  0              1.4904992e-08 -1.5            0              2.998842     
   2700000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    1.156413e-16   0              5.5839047e-09 -1.5            0              2.998842     
   2800000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    4.9948879e-18  0              2.4118526e-10 -1.5            0              2.998842     
   2900000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    8.2919592e-18  0              4.0038904e-10 -1.5            0              2.998842     
   3000000   6000           100            100            0.033320467   -1.5245249e-16  0              0.099961401    6.1168162e-18  0              2.9535916e-10 -1.5            0              2.998842     
Loop time of 456.477 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5678266.289 ns/day, 0.000 hours/ns, 6572.067 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.56     | 200.37     | 203.11     |  11.9 | 43.89
Neigh   | 0.95125    | 0.95298    | 0.95469    |   0.2 |  0.21
Comm    | 25.21      | 27.076     | 28.252     |  21.9 |  5.93
Output  | 0.32965    | 0.32971    | 0.32981    |   0.0 |  0.07
Modify  | 202.59     | 203.59     | 205.37     |   7.5 | 44.60
Other   |            | 24.17      |            |       |  5.29

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027486192    1.1301532e-20  0              0.082458577    1194842.7      0              5.7694679e+13 -1.5            0              3.3172134    
    200000   6000           100            100            0.010629345    2.8141991e-21  0              0.031888034    334026.06      0              1.6128923e+13 -1.5            0              3.0544881    
    300000   6000           100            100            0.0026435253   1.1542379e-21  0              0.007930576    35680.815      0              1.7228988e+12 -1.5            0              3.0362707    
    400000   6000           100            100            0.0012556541  -2.8134312e-22  0              0.0037669624   9529.6146      0              4.6015098e+11 -1.5            0              3.0070203    
    500000   6000           100            100           -0.00026879137 -1.5325949e-21  0             -0.0008063741   543.20098      0              2.6229231e+10 -1.5            0              3.0014775    
    600000   6000           100            100            0.0053075952  -2.4579566e-17  0              0.015922785    14.18032       0              6.8471692e+08 -1.5            0              2.9996837    
    700000   6000           100            100            0.045426345   -2.0751693e-16  0              0.13627904     3.8148064      0              1.8420335e+08 -1.5            0              2.9986842    
    800000   6000           100            100            0.032366222   -1.4777595e-16  0              0.097098666    11.087761      0              5.3538832e+08 -1.5            0              2.9989509    
    900000   6000           100            100            0.031805096   -1.4544024e-16  0              0.095415289    0.0036141546   0              174514.59     -1.5            0              2.9989622    
   1000000   6000           100            100            0.033240383   -1.5202114e-16  0              0.099721148    0.18744556     0              9051075.5     -1.5            0              2.9989311    
   1100000   6000           100            100            0.03350531    -1.5320574e-16  0              0.10051593     0.0026876462   0              129776.82     -1.5            0              2.9989255    
   1200000   6000           100            100            0.03335717    -1.5252244e-16  0              0.10007151     0.0023224633   0              112143.44     -1.5            0              2.9989287    
   1300000   6000           100            100            0.033302903   -1.5227689e-16  0              0.099908709    0.00017735694  0              8563.932      -1.5            0              2.9989299    
   1400000   6000           100            100            0.033314294   -1.5233009e-16  0              0.099942881    1.8590007e-05  0              897.64491     -1.5            0              2.9989296    
   1500000   6000           100            100            0.033322816   -1.5236889e-16  0              0.099968449    5.2996385e-06  0              255.90058     -1.5            0              2.9989295    
   1600000   6000           100            100            0.033322544   -1.5236747e-16  0              0.099967631    5.3620766e-08  0              2.5891549     -1.5            0              2.9989295    
   1700000   6000           100            100            0.033321416   -1.5236232e-16  0              0.099964248    1.0663541e-07  0              5.1490421     -1.5            0              2.9989295    
   1800000   6000           100            100            0.033321294   -1.5236178e-16  0              0.099963883    2.4818322e-10  0              0.01198388    -1.5            0              2.9989295    
   1900000   6000           100            100            0.033321422   -1.5236237e-16  0              0.099964265    1.5657606e-09  0              0.075604977   -1.5            0              2.9989295    
   2000000   6000           100            100            0.033321455   -1.5236252e-16  0              0.099964364    5.6420048e-11  0              0.0027243222  -1.5            0              2.9989295    
   2100000   6000           100            100            0.033321443   -1.5236246e-16  0              0.099964329    1.6138677e-11  0              0.00077927895 -1.5            0              2.9989295    
   2200000   6000           100            100            0.033321437   -1.5236244e-16  0              0.099964312    2.3040722e-12  0              0.0001112554  -1.5            0              2.9989295    
   2300000   6000           100            100            0.033321438   -1.5236244e-16  0              0.099964314    9.1231904e-14  0              4.4052621e-06 -1.5            0              2.9989295    
   2400000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    5.6172343e-14  0              2.7123614e-06 -1.5            0              2.9989295    
   2500000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    3.1850433e-17  0              1.5379434e-09 -1.5            0              2.9989295    
   2600000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    9.641872e-16   0              4.6557149e-08 -1.5            0              2.9989295    
   2700000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    4.6577549e-17  0              2.2490631e-09 -1.5            0              2.9989295    
   2800000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    1.028661e-18   0              4.967036e-11  -1.5            0              2.9989295    
   2900000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    7.8926743e-18  0              3.81109e-10   -1.5            0              2.9989295    
   3000000   6000           100            100            0.033321439   -1.5236244e-16  0              0.099964316    1.626903e-21   0              7.8557322e-14 -1.5            0              2.9989295    
Loop time of 460.29 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5631233.425 ns/day, 0.000 hours/ns, 6517.631 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 194.85     | 199.82     | 203.54     |  23.1 | 43.41
Neigh   | 0.9553     | 0.95835    | 0.96158    |   0.3 |  0.21
Comm    | 25.208     | 28.329     | 33.417     |  64.1 |  6.15
Output  | 0.32793    | 0.32796    | 0.32804    |   0.0 |  0.07
Modify  | 206.16     | 206.77     | 208.17     |   5.7 | 44.92
Other   |            | 24.08      |            |       |  5.23

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 170
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027516894    1.0950807e-20  0              0.082550683    1196832.6      0              5.7790764e+13 -1.5            0              3.3164585    
    200000   6000           100            100            0.010693249    3.1305747e-21  0              0.032079747    337144.25      0              1.6279489e+13 -1.5            0              3.053187     
    300000   6000           100            100            0.0027437912   1.004243e-21   0              0.0082313735   38078.989      0              1.8386981e+12 -1.5            0              3.0353683    
    400000   6000           100            100            0.0014536023  -2.0606184e-22  0              0.0043608068   12474.354      0              6.0234193e+11 -1.5            0              3.0057132    
    500000   6000           100            100            0.00017461818 -1.4508538e-21  0              0.00052385453  215.96644      0              1.0428246e+10 -1.5            0              3.001767     
    600000   6000           100            100            0.02624874    -1.2187594e-16  0              0.07874622     706.3398       0              3.4106621e+10 -1.5            0              2.9991421    
    700000   6000           100            100            0.044435038   -2.0289793e-16  0              0.13330511     26.520884      0              1.2805986e+09 -1.5            0              2.9987921    
    800000   6000           100            100            0.03629121    -1.6586614e-16  0              0.10887363     7.1177144      0              3.4368895e+08 -1.5            0              2.9989443    
    900000   6000           100            100            0.03425483    -1.566741e-16   0              0.10276449     1.0579841      0              51086266      -1.5            0              2.9989838    
   1000000   6000           100            100            0.033619983   -1.5381687e-16  0              0.10085995     0.14886041     0              7187936.4     -1.5            0              2.9989963    
   1100000   6000           100            100            0.033415861   -1.529004e-16   0              0.10024758     0.020608784    0              995124.44     -1.5            0              2.9990003    
   1200000   6000           100            100            0.033350953   -1.5260989e-16  0              0.10005286     0.0028178613   0              136064.44     -1.5            0              2.9990015    
   1300000   6000           100            100            0.033330748   -1.5251983e-16  0              0.099992243    0.00038078446  0              18386.719     -1.5            0              2.9990019    
   1400000   6000           100            100            0.033324638   -1.5249275e-16  0              0.099973913    5.0878922e-05  0              2456.761      -1.5            0              2.9990021    
   1500000   6000           100            100            0.033322864   -1.5248495e-16  0              0.099968593    6.7247024e-06  0              324.71181     -1.5            0              2.9990021    
   1600000   6000           100            100            0.033322381   -1.5248285e-16  0              0.099967143    8.7947351e-07  0              42.466628     -1.5            0              2.9990021    
   1700000   6000           100            100            0.033322263   -1.5248235e-16  0              0.099966789    1.1383428e-07  0              5.4966499     -1.5            0              2.9990021    
   1800000   6000           100            100            0.033322241   -1.5248226e-16  0              0.099966722    1.4584063e-08  0              0.7042122     -1.5            0              2.9990021    
   1900000   6000           100            100            0.03332224    -1.5248226e-16  0              0.099966719    1.8494385e-09  0              0.089302766   -1.5            0              2.9990021    
   2000000   6000           100            100            0.033322242   -1.5248228e-16  0              0.099966726    2.320735e-10   0              0.011205999   -1.5            0              2.9990021    
   2100000   6000           100            100            0.033322244   -1.5248229e-16  0              0.099966731    2.8802295e-11  0              0.0013907597  -1.5            0              2.9990021    
   2200000   6000           100            100            0.033322245   -1.5248229e-16  0              0.099966734    3.53255e-12    0              0.0001705742  -1.5            0              2.9990021    
   2300000   6000           100            100            0.033322245   -1.5248229e-16  0              0.099966736    4.2832765e-13  0              2.0682409e-05 -1.5            0              2.9990021    
   2400000   6000           100            100            0.033322245   -1.5248229e-16  0              0.099966736    5.112708e-14   0              2.4687437e-06 -1.5            0              2.9990021    
   2500000   6000           100            100            0.033322245   -1.5248229e-16  0              0.099966736    6.0285082e-15  0              2.9109509e-07 -1.5            0              2.9990021    
   2600000   6000           100            100            0.033322246   -1.5248229e-16  0              0.099966737    6.0745799e-16  0              2.9331972e-08 -1.5            0              2.9990021    
   2700000   6000           100            100            0.033322246   -1.5248229e-16  0              0.099966737    1.2934224e-16  0              6.2454738e-09 -1.5            0              2.9990021    
   2800000   6000           100            100            0.033322246   -1.5248229e-16  0              0.099966737    1.6268118e-19  0              7.855292e-12  -1.5            0              2.9990021    
   2900000   6000           100            100            0.033322246   -1.5248229e-16  0              0.099966737    2.1410913e-18  0              1.0338564e-10 -1.5            0              2.9990021    
   3000000   6000           100            100            0.033322246   -1.524823e-16   0              0.099966737    2.3983594e-18  0              1.1580819e-10 -1.5            0              2.9990021    
Loop time of 460.336 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5630667.157 ns/day, 0.000 hours/ns, 6516.976 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 197.72     | 200.69     | 203.92     |  19.0 | 43.60
Neigh   | 0.95956    | 0.96258    | 0.96612    |   0.3 |  0.21
Comm    | 24.601     | 27.732     | 31.165     |  57.8 |  6.02
Output  | 0.32855    | 0.32858    | 0.32863    |   0.0 |  0.07
Modify  | 205.29     | 206.28     | 208.07     |   7.5 | 44.81
Other   |            | 24.34      |            |       |  5.29

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 170
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02754357     1.0811258e-20  0              0.082630711    1198563.3      0              5.7874333e+13 -1.5            0              3.3157986    
    200000   6000           100            100            0.010748952    3.1436021e-21  0              0.032246857    339869.99      0              1.6411106e+13 -1.5            0              3.0520434    
    300000   6000           100            100            0.0028315755   9.06804e-22    0              0.0084947266   40226.695      0              1.9424031e+12 -1.5            0              3.0345471    
    400000   6000           100            100            0.0016277482  -2.7785194e-22  0              0.0048832447   15333.548      0              7.4040214e+11 -1.5            0              3.0044144    
    500000   6000           100            100            0.00057416015 -1.3629939e-21  0              0.0017224805   2190.8611      0              1.0578884e+11 -1.5            0              3.000879     
    600000   6000           100            100            0.071013889   -3.2394909e-16  0              0.21304167     99.081762      0              4.7843037e+09 -1.5            0              2.9984508    
    700000   6000           100            100            0.027347889   -1.2461307e-16  0              0.082043668    77.876534      0              3.7603791e+09 -1.5            0              2.9991813    
    800000   6000           100            100            0.033331775   -1.5230783e-16  0              0.099995324    12.753451      0              6.158185e+08  -1.5            0              2.9990642    
    900000   6000           100            100            0.034450497   -1.5759551e-16  0              0.10335149     0.9345342      0              45125312      -1.5            0              2.9990427    
   1000000   6000           100            100            0.033931619   -1.5528609e-16  0              0.10179486     0.0027752965   0              134009.14     -1.5            0              2.9990522    
   1100000   6000           100            100            0.033499792   -1.5332291e-16  0              0.10049938     0.0092786191   0              448031.31     -1.5            0              2.9990602    
   1200000   6000           100            100            0.033338343   -1.5258262e-16  0              0.10001503     0.0033214653   0              160381.67     -1.5            0              2.9990632    
   1300000   6000           100            100            0.033308384   -1.5244308e-16  0              0.099925153    0.0003270238   0              15790.809     -1.5            0              2.9990638    
   1400000   6000           100            100            0.033313266   -1.5246432e-16  0              0.099939799    4.6466298e-06  0              224.36913     -1.5            0              2.9990637    
   1500000   6000           100            100            0.033319691   -1.5249345e-16  0              0.099959074    1.3982628e-06  0              67.517107     -1.5            0              2.9990636    
   1600000   6000           100            100            0.033322459   -1.5250611e-16  0              0.099967376    8.1225433e-07  0              39.220855     -1.5            0              2.9990635    
   1700000   6000           100            100            0.033323096   -1.5250906e-16  0              0.099969287    1.051474e-07   0              5.0771915     -1.5            0              2.9990635    
   1800000   6000           100            100            0.033323077   -1.52509e-16    0              0.09996923     3.0914951e-09  0              0.14927724    -1.5            0              2.9990635    
   1900000   6000           100            100            0.033322985   -1.5250858e-16  0              0.099968956    1.5005479e-10  0              0.0072456088  -1.5            0              2.9990635    
   2000000   6000           100            100            0.033322939   -1.5250837e-16  0              0.099968818    1.8513338e-10  0              0.0089394285  -1.5            0              2.9990635    
   2100000   6000           100            100            0.033322927   -1.5250831e-16  0              0.09996878     3.1521593e-11  0              0.0015220649  -1.5            0              2.9990635    
   2200000   6000           100            100            0.033322926   -1.5250831e-16  0              0.099968778    1.4869357e-12  0              7.1798805e-05 -1.5            0              2.9990635    
   2300000   6000           100            100            0.033322927   -1.5250832e-16  0              0.099968781    5.7617606e-15  0              2.782148e-07  -1.5            0              2.9990635    
   2400000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    3.8448738e-14  0              1.856552e-06  -1.5            0              2.9990635    
   2500000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    8.882931e-15   0              4.2892495e-07 -1.5            0              2.9990635    
   2600000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    6.6599336e-16  0              3.2158436e-08 -1.5            0              2.9990635    
   2700000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    1.1112598e-16  0              5.3658759e-09 -1.5            0              2.9990635    
   2800000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    1.1960511e-18  0              5.7753028e-11 -1.5            0              2.9990635    
   2900000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    5.2524742e-18  0              2.5362318e-10 -1.5            0              2.9990635    
   3000000   6000           100            100            0.033322928   -1.5250832e-16  0              0.099968784    1.7374287e-18  0              8.3894214e-11 -1.5            0              2.9990635    
Loop time of 444.381 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5832835.938 ns/day, 0.000 hours/ns, 6750.968 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 172.33     | 181.34     | 191.61     |  63.6 | 40.81
Neigh   | 0.97782    | 0.98096    | 0.9841     |   0.3 |  0.22
Comm    | 25.007     | 34.33      | 43.965     | 158.9 |  7.73
Output  | 0.32912    | 0.32917    | 0.32925    |   0.0 |  0.07
Modify  | 201.95     | 203.09     | 205.4      |   9.5 | 45.70
Other   |            | 24.31      |            |       |  5.47

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027567049    1.0824463e-20  0              0.082701146    1200087.9      0              5.7947951e+13 -1.5            0              3.3152146    
    200000   6000           100            100            0.010798112    3.5343605e-21  0              0.032394336    342281.51      0              1.6527549e+13 -1.5            0              3.0510269    
    300000   6000           100            100            0.002909338    1.0495092e-21  0              0.008728014    42165.979      0              2.0360442e+12 -1.5            0              3.0337957    
    400000   6000           100            100            0.0017826098  -1.4391956e-22  0              0.0053478295   18076.546      0              8.7285171e+11 -1.5            0              3.0031472    
    500000   6000           100            100            0.025590377   -1.1327812e-16  0              0.076771131    5089.3129      0              2.4574471e+11 -1.5            0              2.9992767    
    600000   6000           100            100            0.0029250011  -1.2922717e-17  0              0.0087750034   60.459959      0              2.919395e+09  -1.5            0              2.9998292    
    700000   6000           100            100            0.029052187   -1.3338545e-16  0              0.087156562    93.049395      0              4.4930223e+09 -1.5            0              2.9991914    
    800000   6000           100            100            0.02896048    -1.3244116e-16  0              0.086881441    2.8626873      0              1.3822892e+08 -1.5            0              2.9991949    
    900000   6000           100            100            0.031858444   -1.4551302e-16  0              0.095575332    0.54336485     0              26237144      -1.5            0              2.9991426    
   1000000   6000           100            100            0.033430538   -1.5271107e-16  0              0.10029162     0.21288746     0              10279573      -1.5            0              2.9991145    
   1100000   6000           100            100            0.033545779   -1.5326553e-16  0              0.10063734     0.001988389    0              96012.187     -1.5            0              2.9991124    
   1200000   6000           100            100            0.03337655    -1.5249877e-16  0              0.10012965     0.0021047847   0              101632.52     -1.5            0              2.9991154    
   1300000   6000           100            100            0.033310939   -1.5219735e-16  0              0.099932816    0.00038200089  0              18445.456     -1.5            0              2.9991165    
   1400000   6000           100            100            0.03331291    -1.5220504e-16  0              0.099938729    7.712135e-11   0              0.003723914   -1.5            0              2.9991165    
   1500000   6000           100            100            0.033321936   -1.522461e-16   0              0.099965809    6.3254648e-06  0              305.43406     -1.5            0              2.9991163    
   1600000   6000           100            100            0.033324402   -1.5225748e-16  0              0.099973207    5.7218428e-07  0              27.628731     -1.5            0              2.9991163    
   1700000   6000           100            100            0.033323985   -1.5225563e-16  0              0.099971954    9.1098902e-09  0              0.43988399    -1.5            0              2.9991163    
   1800000   6000           100            100            0.033323542   -1.5225361e-16  0              0.099970626    1.5871092e-08  0              0.76635824    -1.5            0              2.9991163    
   1900000   6000           100            100            0.033323462   -1.5225324e-16  0              0.099970387    6.5935872e-10  0              0.031838073   -1.5            0              2.9991163    
   2000000   6000           100            100            0.033323495   -1.5225338e-16  0              0.099970486    7.1569552e-11  0              0.0034558375  -1.5            0              2.9991163    
   2100000   6000           100            100            0.033323515   -1.5225348e-16  0              0.099970546    3.4219268e-11  0              0.001652326   -1.5            0              2.9991163    
   2200000   6000           100            100            0.033323517   -1.5225349e-16  0              0.099970552    4.5632341e-13  0              2.2034224e-05 -1.5            0              2.9991163    
   2300000   6000           100            100            0.033323515   -1.5225348e-16  0              0.099970546    3.0256688e-13  0              1.4609872e-05 -1.5            0              2.9991163    
   2400000   6000           100            100            0.033323514   -1.5225347e-16  0              0.099970543    6.3929926e-14  0              3.0869473e-06 -1.5            0              2.9991163    
   2500000   6000           100            100            0.033323514   -1.5225347e-16  0              0.099970543    2.959956e-17   0              1.4292568e-09 -1.5            0              2.9991163    
   2600000   6000           100            100            0.033323515   -1.5225347e-16  0              0.099970544    1.0337812e-15  0              4.9917594e-08 -1.5            0              2.9991163    
   2700000   6000           100            100            0.033323515   -1.5225347e-16  0              0.099970544    5.3731067e-18  0              2.5944809e-10 -1.5            0              2.9991163    
   2800000   6000           100            100            0.033323515   -1.5225347e-16  0              0.099970544    6.8510193e-19  0              3.308112e-11  -1.5            0              2.9991163    
   2900000   6000           100            100            0.033323515   -1.5225347e-16  0              0.099970544    9.4917545e-18  0              4.5832286e-10 -1.5            0              2.9991163    
   3000000   6000           100            100            0.033323515   -1.5225347e-16  0              0.099970544    5.5227025e-20  0              2.6667154e-12 -1.5            0              2.9991163    
Loop time of 423.854 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6115313.802 ns/day, 0.000 hours/ns, 7077.909 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.55     | 169.48     | 170.82     |   6.7 | 39.99
Neigh   | 0.9786     | 0.98201    | 0.98522    |   0.3 |  0.23
Comm    | 25.123     | 26.158     | 27.389     |  19.8 |  6.17
Output  | 0.33044    | 0.33048    | 0.33054    |   0.0 |  0.08
Modify  | 201.43     | 202.16     | 203.57     |   5.8 | 47.70
Other   |            | 24.74      |            |       |  5.84

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027587933    1.0845442e-20  0              0.082763798    1201445        0              5.8013479e+13 -1.5            0              3.3146931    
    200000   6000           100            100            0.010841946    3.7259002e-21  0              0.032525838    344436.5       0              1.6631606e+13 -1.5            0              3.0501147    
    300000   6000           100            100            0.0029789217   1.3930143e-21  0              0.0089367652   43930.098      0              2.1212272e+12 -1.5            0              3.0331046    
    400000   6000           100            100            0.0019216185  -1.9141785e-22  0              0.0057648556   20692.482      0              9.9916588e+11 -1.5            0              3.0019228    
    500000   6000           100            100            0.13893834    -6.3639963e-16  0              0.41681501     1303.3755      0              6.2935338e+10 -1.5            0              2.9978339    
    600000   6000           100            100            0.068446428   -3.1408261e-16  0              0.20533928     286.82125      0              1.3849572e+10 -1.5            0              2.9986435    
    700000   6000           100            100            0.035091923   -1.5983508e-16  0              0.10527577     104.68785      0              5.0550015e+09 -1.5            0              2.9991349    
    800000   6000           100            100            0.037676152   -1.7219771e-16  0              0.11302846     4.4649967      0              2.1559871e+08 -1.5            0              2.9990912    
    900000   6000           100            100            0.034943207   -1.5990239e-16  0              0.10482962     0.44981204     0              21719814      -1.5            0              2.9991352    
   1000000   6000           100            100            0.033238601   -1.5210053e-16  0              0.099715804    0.22329653     0              10782190      -1.5            0              2.9991636    
   1100000   6000           100            100            0.033092392   -1.5140384e-16  0              0.099277176    0.0022136749   0              106890.44     -1.5            0              2.9991661    
   1200000   6000           100            100            0.033270045   -1.5220911e-16  0              0.099810134    0.0022741725   0              109811.65     -1.5            0              2.9991631    
   1300000   6000           100            100            0.033338789   -1.525251e-16   0              0.10001637     0.00037556585  0              18134.731     -1.5            0              2.999162     
   1400000   6000           100            100            0.033335095   -1.5250959e-16  0              0.10000528     5.3195813e-07  0              25.686354     -1.5            0              2.999162     
   1500000   6000           100            100            0.033325214   -1.5246458e-16  0              0.099975643    7.2788442e-06  0              351.46934     -1.5            0              2.9991622    
   1600000   6000           100            100            0.033322932   -1.5245401e-16  0              0.099968796    4.3467271e-07  0              20.988789     -1.5            0              2.9991622    
   1700000   6000           100            100            0.033323567   -1.5245685e-16  0              0.0999707      2.6636807e-08  0              1.2861961     -1.5            0              2.9991622    
   1800000   6000           100            100            0.033324037   -1.5245901e-16  0              0.099972112    1.701065e-08   0              0.82138342    -1.5            0              2.9991622    
   1900000   6000           100            100            0.033324087   -1.5245924e-16  0              0.099972262    2.372513e-10   0              0.011456016   -1.5            0              2.9991622    
   2000000   6000           100            100            0.033324041   -1.5245903e-16  0              0.099972122    1.5592957e-10  0              0.0075292807  -1.5            0              2.9991622    
   2100000   6000           100            100            0.033324021   -1.5245894e-16  0              0.099972063    2.9899072e-11  0              0.0014437192  -1.5            0              2.9991622    
   2200000   6000           100            100            0.033324022   -1.5245894e-16  0              0.099972065    6.2837688e-15  0              3.0342071e-07 -1.5            0              2.9991622    
   2300000   6000           100            100            0.033324024   -1.5245896e-16  0              0.099972073    5.2789996e-13  0              2.54904e-05   -1.5            0              2.9991622    
   2400000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972075    3.6693113e-14  0              1.7717791e-06 -1.5            0              2.9991622    
   2500000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972075    1.7037459e-15  0              8.2267792e-08 -1.5            0              2.9991622    
   2600000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972074    1.2844745e-15  0              6.2022677e-08 -1.5            0              2.9991622    
   2700000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972074    5.2999998e-17  0              2.5591802e-09 -1.5            0              2.9991622    
   2800000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972074    1.0184378e-17  0              4.9176719e-10 -1.5            0              2.9991622    
   2900000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972074    2.6132134e-18  0              1.2618272e-10 -1.5            0              2.9991622    
   3000000   6000           100            100            0.033324025   -1.5245896e-16  0              0.099972074    3.800593e-18   0              1.8351703e-10 -1.5            0              2.9991622    
Loop time of 423.594 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6119061.785 ns/day, 0.000 hours/ns, 7082.247 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.34     | 169.32     | 169.79     |   4.4 | 39.97
Neigh   | 0.9766     | 0.98015    | 0.98363    |   0.3 |  0.23
Comm    | 25.315     | 25.943     | 26.877     |  11.4 |  6.12
Output  | 0.32682    | 0.32688    | 0.32695    |   0.0 |  0.08
Modify  | 202.21     | 202.48     | 202.74     |   1.4 | 47.80
Other   |            | 24.54      |            |       |  5.79

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02760668     1.0807557e-20  0              0.082820041    1202664.2      0              5.8072348e+13 -1.5            0              3.3142227    
    200000   6000           100            100            0.010881385    3.173465e-21   0              0.032644154    346379.2       0              1.6725412e+13 -1.5            0              3.0492892    
    300000   6000           100            100            0.0030417169   7.4709613e-22  0              0.0091251507   45545.125      0              2.1992111e+12 -1.5            0              3.0324657    
    400000   6000           100            100            0.0020473824  -1.0761788e-22  0              0.0061421473   23179.791      0              1.1192692e+12 -1.5            0              3.0007463    
    500000   6000           100            100            0.13289164    -6.1016301e-16  0              0.39867492     1901.1489      0              9.1799676e+10 -1.5            0              2.9979891    
    600000   6000           100            100            0.0018808563  -8.0171761e-18  0              0.0056425689   99.985983      0              4.8279653e+09 -1.5            0              2.9998877    
    700000   6000           100            100            0.041899513   -1.9200296e-16  0              0.12569854     75.479022      0              3.6446118e+09 -1.5            0              2.9990695    
    800000   6000           100            100            0.03399643    -1.5556921e-16  0              0.10198929     13.88042       0              6.7023583e+08 -1.5            0              2.9991912    
    900000   6000           100            100            0.032072975   -1.466037e-16   0              0.096218926    1.0700987      0              51671238      -1.5            0              2.9992225    
   1000000   6000           100            100            0.032626451   -1.4906101e-16  0              0.097879352    2.1452242e-06  0              103.5852      -1.5            0              2.9992138    
   1100000   6000           100            100            0.033167355   -1.5152226e-16  0              0.099502064    0.018253624    0              881402.17     -1.5            0              2.9992051    
   1200000   6000           100            100            0.033343526   -1.5233179e-16  0              0.10003058     0.0037261018   0              179920.12     -1.5            0              2.9992023    
   1300000   6000           100            100            0.033353354   -1.5238013e-16  0              0.10006006     0.00010411249  0              5027.2195     -1.5            0              2.9992022    
   1400000   6000           100            100            0.033335084   -1.5229761e-16  0              0.10000525     1.055812e-05   0              509.81381     -1.5            0              2.9992024    
   1500000   6000           100            100            0.033325553   -1.5225405e-16  0              0.099976659    7.7573238e-06  0              374.57341     -1.5            0              2.9992026    
   1600000   6000           100            100            0.033323595   -1.5224498e-16  0              0.099970784    7.0834597e-07  0              34.203492     -1.5            0              2.9992026    
   1700000   6000           100            100            0.033323937   -1.5224648e-16  0              0.09997181     4.8082101e-10  0              0.023217126   -1.5            0              2.9992026    
   1800000   6000           100            100            0.033324344   -1.5224834e-16  0              0.099973031    9.7101607e-09  0              0.46886891    -1.5            0              2.9992026    
   1900000   6000           100            100            0.033324484   -1.5224898e-16  0              0.099973452    2.2484088e-09  0              0.10856761    -1.5            0              2.9992026    
   2000000   6000           100            100            0.033324495   -1.5224903e-16  0              0.099973485    7.6739535e-11  0              0.0037054775  -1.5            0              2.9992026    
   2100000   6000           100            100            0.033324482   -1.5224897e-16  0              0.099973446    4.612686e-12   0              0.0002227301  -1.5            0              2.9992026    
   2200000   6000           100            100            0.033324474   -1.5224894e-16  0              0.099973423    4.4123154e-12  0              0.00021305492 -1.5            0              2.9992026    
   2300000   6000           100            100            0.033324473   -1.5224893e-16  0              0.099973419    4.5528239e-13  0              2.1983957e-05 -1.5            0              2.9992026    
   2400000   6000           100            100            0.033324473   -1.5224893e-16  0              0.099973419    1.1633709e-15  0              5.6175017e-08 -1.5            0              2.9992026    
   2500000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     5.0953344e-15  0              2.4603546e-07 -1.5            0              2.9992026    
   2600000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     1.3204302e-15  0              6.3758849e-08 -1.5            0              2.9992026    
   2700000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     1.4739082e-17  0              7.1169752e-10 -1.5            0              2.9992026    
   2800000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     6.6721807e-19  0              3.2217573e-11 -1.5            0              2.9992026    
   2900000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     4.8969996e-18  0              2.3645859e-10 -1.5            0              2.9992026    
   3000000   6000           100            100            0.033324473   -1.5224893e-16  0              0.09997342     5.7526489e-19  0              2.7777483e-11 -1.5            0              2.9992026    
Loop time of 423.8 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6116093.996 ns/day, 0.000 hours/ns, 7078.812 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.87     | 168.7      | 170.26     |   7.3 | 39.81
Neigh   | 0.97723    | 0.97979    | 0.98226    |   0.2 |  0.23
Comm    | 24.651     | 25.751     | 26.621     |  14.3 |  6.08
Output  | 0.32699    | 0.32704    | 0.32711    |   0.0 |  0.08
Modify  | 202.72     | 203.53     | 204.29     |   4.2 | 48.03
Other   |            | 24.51      |            |       |  5.78

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02762364     1.0829968e-20  0              0.082870919    1203767.7      0              5.8125635e+13 -1.5            0              3.3137956    
    200000   6000           100            100            0.010917138    3.3349011e-21  0              0.032751414    348143.48      0              1.6810603e+13 -1.5            0              3.0485369    
    300000   6000           100            100            0.0030987843   1.2350775e-21  0              0.0092963528   47031.53       0              2.2709843e+12 -1.5            0              3.0318728    
    400000   6000           100            100            0.013956077   -5.6823005e-17  0              0.041868232    25433.218      0              1.2280791e+12 -1.5            0              2.9996196    
    500000   6000           100            100            0.02483408    -1.1811903e-16  0              0.07450224     5285.7262      0              2.552288e+11  -1.5            0              2.9993604    
    600000   6000           100            100            0.081524285   -3.7248575e-16  0              0.24457286     0.06583649     0              3179008.5     -1.5            0              2.9986172    
    700000   6000           100            100            0.019826045   -9.1008539e-17  0              0.059478135    19.856337      0              9.5879145e+08 -1.5            0              2.9994604    
    800000   6000           100            100            0.028637091   -1.3111478e-16  0              0.085911274    4.1883986      0              2.0224278e+08 -1.5            0              2.9993113    
    900000   6000           100            100            0.031404188   -1.436468e-16   0              0.094212563    0.16897011     0              8158961.8     -1.5            0              2.9992679    
   1000000   6000           100            100            0.032599657   -1.4907949e-16  0              0.097798972    3.9437406e-05  0              1904.2912     -1.5            0              2.9992495    
   1100000   6000           100            100            0.033079112   -1.5126632e-16  0              0.099237335    0.0034446382   0              166329.25     -1.5            0              2.9992422    
   1200000   6000           100            100            0.033251364   -1.5205455e-16  0              0.099754092    0.0015359146   0              74163.82      -1.5            0              2.9992396    
   1300000   6000           100            100            0.033306592   -1.523082e-16   0              0.099919776    0.00036440869  0              17595.991     -1.5            0              2.9992387    
   1400000   6000           100            100            0.033321922   -1.52379e-16    0              0.099965766    6.2871599e-05  0              3035.8445     -1.5            0              2.9992385    
   1500000   6000           100            100            0.033325224   -1.5239442e-16  0              0.099975671    8.5904634e-06  0              414.80274     -1.5            0              2.9992385    
   1600000   6000           100            100            0.033325492   -1.5239578e-16  0              0.099976475    9.4246766e-07  0              45.50839      -1.5            0              2.9992384    
   1700000   6000           100            100            0.033325248   -1.5239471e-16  0              0.099975744    7.9670879e-08  0              3.8470216     -1.5            0              2.9992385    
   1800000   6000           100            100            0.033325048   -1.5239381e-16  0              0.099975143    4.4572054e-09  0              0.2152225     -1.5            0              2.9992385    
   1900000   6000           100            100            0.033324943   -1.5239334e-16  0              0.099974829    8.0954676e-11  0              0.0039090116  -1.5            0              2.9992385    
   2000000   6000           100            100            0.033324897   -1.5239313e-16  0              0.099974692    6.2117114e-12  0              0.00029994131 -1.5            0              2.9992385    
   2100000   6000           100            100            0.03332488    -1.5239305e-16  0              0.09997464     8.1605898e-12  0              0.00039404568 -1.5            0              2.9992385    
   2200000   6000           100            100            0.033324874   -1.5239302e-16  0              0.099974622    2.628376e-12   0              0.00012691487 -1.5            0              2.9992385    
   2300000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974617    5.3811905e-13  0              2.5983843e-05 -1.5            0              2.9992385    
   2400000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    8.4039021e-14  0              4.0579436e-06 -1.5            0              2.9992385    
   2500000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    1.0613143e-14  0              5.1247068e-07 -1.5            0              2.9992385    
   2600000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    1.0435877e-15  0              5.0391116e-08 -1.5            0              2.9992385    
   2700000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    7.9710134e-20  0              3.8489171e-12 -1.5            0              2.9992385    
   2800000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    8.2153224e-19  0              3.9668852e-11 -1.5            0              2.9992385    
   2900000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    2.3427124e-20  0              1.131212e-12  -1.5            0              2.9992385    
   3000000   6000           100            100            0.033324872   -1.5239301e-16  0              0.099974615    1.6765208e-18  0              8.0953189e-11 -1.5            0              2.9992385    
Loop time of 422.654 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6132669.296 ns/day, 0.000 hours/ns, 7097.997 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.04     | 168.99     | 169.81     |   5.7 | 39.98
Neigh   | 0.95847    | 0.96196    | 0.96536    |   0.3 |  0.23
Comm    | 25.008     | 25.917     | 27.016     |  17.4 |  6.13
Output  | 0.32821    | 0.32826    | 0.32833    |   0.0 |  0.08
Modify  | 201.49     | 201.91     | 202.37     |   2.2 | 47.77
Other   |            | 24.55      |            |       |  5.81

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027639083    1.112067e-20   0              0.08291725     1204773.2      0              5.8174184e+13 -1.5            0              3.3134056    
    200000   6000           100            100            0.010949748    3.5244508e-21  0              0.032849244    349755.21      0              1.6888428e+13 -1.5            0              3.0478477    
    300000   6000           100            100            0.0031509787   1.1591096e-21  0              0.0094529361   48406.415      0              2.3373726e+12 -1.5            0              3.0313204    
    400000   6000           100            100            0.093935773   -4.2492209e-16  0              0.28180732     24577.744      0              1.1867713e+12 -1.5            0              2.9985667    
    500000   6000           100            100           -0.00062932389 -1.1910801e-21  0             -0.0018879717   3188.958       0              1.5398337e+11 -1.5            0              3.0006409    
    600000   6000           100            100            0.0023282136  -1.1664209e-17  0              0.0069846407   247.94682      0              1.1972465e+10 -1.5            0              2.9998698    
    700000   6000           100            100            0.021685018   -9.8760124e-17  0              0.065055053    49.702981      0              2.3999791e+09 -1.5            0              2.9994537    
    800000   6000           100            100            0.027730363   -1.2691028e-16  0              0.08319109     0.66650213     0              32183002      -1.5            0              2.9993545    
    900000   6000           100            100            0.031804771   -1.4553594e-16  0              0.095414313    0.91084839     0              43981609      -1.5            0              2.9992927    
   1000000   6000           100            100            0.033086512   -1.5135914e-16  0              0.099259535    0.2243654      0              10833802      -1.5            0              2.9992739    
   1100000   6000           100            100            0.03336929    -1.5263071e-16  0              0.10010787     0.031236954    0              1508320.7     -1.5            0              2.9992699    
   1200000   6000           100            100            0.033383954   -1.526891e-16   0              0.10015186     0.0026234095   0              126675.06     -1.5            0              2.9992697    
   1300000   6000           100            100            0.033356883   -1.5256259e-16  0              0.10007065     9.5408756e-05  0              4606.9474     -1.5            0              2.9992701    
   1400000   6000           100            100            0.033337786   -1.5247465e-16  0              0.10001336     1.584958e-07   0              7.653195      -1.5            0              2.9992703    
   1500000   6000           100            100            0.033329132   -1.5243503e-16  0              0.099987395    2.2943307e-06  0              110.78502     -1.5            0              2.9992705    
   1600000   6000           100            100            0.03332609    -1.5242118e-16  0              0.099978271    8.3266773e-07  0              40.206545     -1.5            0              2.9992705    
   1700000   6000           100            100            0.033325273   -1.5241748e-16  0              0.099975818    1.4829023e-07  0              7.1604044     -1.5            0              2.9992705    
   1800000   6000           100            100            0.033325145   -1.5241692e-16  0              0.099975435    1.6183266e-08  0              0.78143199    -1.5            0              2.9992705    
   1900000   6000           100            100            0.03332517    -1.5241703e-16  0              0.099975509    9.7484876e-10  0              0.047071958   -1.5            0              2.9992705    
   2000000   6000           100            100            0.033325202   -1.5241718e-16  0              0.099975605    1.1838563e-11  0              0.00057164185 -1.5            0              2.9992705    
   2100000   6000           100            100            0.033325219   -1.5241726e-16  0              0.099975656    3.3932242e-12  0              0.00016384665 -1.5            0              2.9992705    
   2200000   6000           100            100            0.033325226   -1.5241729e-16  0              0.099975677    2.6134844e-12  0              0.00012619581 -1.5            0              2.9992705    
   2300000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975683    6.254905e-13   0              3.0202698e-05 -1.5            0              2.9992705    
   2400000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975685    8.7446053e-14  0              4.2224569e-06 -1.5            0              2.9992705    
   2500000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975685    7.4472132e-15  0              3.5959927e-07 -1.5            0              2.9992705    
   2600000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975684    2.5349113e-16  0              1.2240179e-08 -1.5            0              2.9992705    
   2700000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975684    3.2499456e-17  0              1.5692824e-09 -1.5            0              2.9992705    
   2800000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975684    5.0618253e-18  0              2.4441743e-10 -1.5            0              2.9992705    
   2900000   6000           100            100            0.033325228   -1.524173e-16   0              0.099975684    2.2361401e-18  0              1.079752e-10  -1.5            0              2.9992705    
   3000000   6000           100            100            0.033325228   -1.5241731e-16  0              0.099975684    5.665752e-20   0              2.7357889e-12 -1.5            0              2.9992705    
Loop time of 423.002 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6127631.720 ns/day, 0.000 hours/ns, 7092.166 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.42     | 169.49     | 170.34     |   5.8 | 40.07
Neigh   | 0.98058    | 0.98562    | 0.99061    |   0.5 |  0.23
Comm    | 25.115     | 25.906     | 26.793     |  11.9 |  6.12
Output  | 0.32678    | 0.32681    | 0.32688    |   0.0 |  0.08
Modify  | 201.71     | 202.02     | 202.32     |   1.6 | 47.76
Other   |            | 24.27      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027653232    1.1040819e-20  0              0.082959695    1205694.8      0              5.8218687e+13 -1.5            0              3.313047     
    200000   6000           100            100            0.010979688    3.1160946e-21  0              0.032939064    351237.16      0              1.6959985e+13 -1.5            0              3.047212     
    300000   6000           100            100            0.0031989976   1.5210605e-21  0              0.0095969928   49684.174      0              2.399071e+12  -1.5            0              3.0308035    
    400000   6000           100            100            0.20348421    -9.2375955e-16  0              0.61045264     18350.709      0              8.8609007e+11 -1.5            0              2.9976731    
    500000   6000           100            100           -0.00044588154 -1.1518856e-21  0             -0.0013376446   1545.061       0              7.4605467e+10 -1.5            0              3.0015075    
    600000   6000           100            100            0.023337388   -1.0499943e-16  0              0.070012164    846.93212      0              4.0895321e+10 -1.5            0              2.9994532    
    700000   6000           100            100            0.031281906   -1.4214391e-16  0              0.093845718    116.10626      0              5.6063559e+09 -1.5            0              2.9993302    
    800000   6000           100            100            0.028231867   -1.2909188e-16  0              0.0846956      4.0250253      0              1.9435407e+08 -1.5            0              2.9993724    
    900000   6000           100            100            0.03447093    -1.5752988e-16  0              0.10341279     1.4219784      0              68662247      -1.5            0              2.9992833    
   1000000   6000           100            100            0.03400448    -1.553009e-16   0              0.10201344     0.063334241    0              3058183.8     -1.5            0              2.99929      
   1100000   6000           100            100            0.033200033   -1.5163358e-16  0              0.099600098    0.026293676    0              1269627.5     -1.5            0              2.9993012    
   1200000   6000           100            100            0.033233205   -1.51798e-16    0              0.099699614    0.00069260993  0              33443.655     -1.5            0              2.9993007    
   1300000   6000           100            100            0.033338224   -1.5227728e-16  0              0.10001467     0.00048295336  0              23320.089     -1.5            0              2.9992992    
   1400000   6000           100            100            0.033337975   -1.5227445e-16  0              0.10001392     6.5681205e-06  0              317.15103     -1.5            0              2.9992993    
   1500000   6000           100            100            0.033324385   -1.5221237e-16  0              0.099973156    8.636028e-06   0              417.00289     -1.5            0              2.9992994    
   1600000   6000           100            100            0.033323899   -1.5221036e-16  0              0.099971696    4.7906495e-08  0              2.3132332     -1.5            0              2.9992994    
   1700000   6000           100            100            0.033325636   -1.5221831e-16  0              0.099976909    1.5074319e-07  0              7.2788491     -1.5            0              2.9992994    
   1800000   6000           100            100            0.033325766   -1.5221888e-16  0              0.099977298    1.8070998e-10  0              0.008725838   -1.5            0              2.9992994    
   1900000   6000           100            100            0.033325546   -1.5221787e-16  0              0.099976638    2.5709042e-09  0              0.12413976    -1.5            0              2.9992994    
   2000000   6000           100            100            0.033325521   -1.5221776e-16  0              0.099976563    4.0510178e-14  0              1.9560915e-06 -1.5            0              2.9992994    
   2100000   6000           100            100            0.033325548   -1.5221788e-16  0              0.099976645    4.2860296e-11  0              0.0020695703  -1.5            0              2.9992994    
   2200000   6000           100            100            0.033325553   -1.522179e-16   0              0.099976658    7.6454385e-14  0              3.6917087e-06 -1.5            0              2.9992994    
   2300000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976648    6.9924278e-13  0              3.3763932e-05 -1.5            0              2.9992994    
   2400000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976646    4.6836974e-15  0              2.2615898e-07 -1.5            0              2.9992994    
   2500000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976647    1.1025773e-14  0              5.3239512e-07 -1.5            0              2.9992994    
   2600000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976648    1.3003844e-16  0              6.2790909e-09 -1.5            0              2.9992994    
   2700000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976648    7.8701598e-17  0              3.8002185e-09 -1.5            0              2.9992994    
   2800000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976647    2.4926919e-20  0              1.2036317e-12 -1.5            0              2.9992994    
   2900000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976647    9.9238843e-18  0              4.7918886e-10 -1.5            0              2.9992994    
   3000000   6000           100            100            0.033325549   -1.5221789e-16  0              0.099976647    1.9574966e-18  0              9.4520506e-11 -1.5            0              2.9992994    
Loop time of 424.9 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6100253.610 ns/day, 0.000 hours/ns, 7060.479 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.6      | 169.41     | 170.16     |   4.5 | 39.87
Neigh   | 0.98447    | 0.99014    | 0.99656    |   0.6 |  0.23
Comm    | 25.388     | 25.796     | 26.329     |   7.4 |  6.07
Output  | 0.32692    | 0.32697    | 0.32705    |   0.0 |  0.08
Modify  | 201.87     | 203.28     | 204.82     |   7.6 | 47.84
Other   |            | 25.09      |            |       |  5.91

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02766626     1.0490489e-20  0              0.082998781    1206544        0              5.8259692e+13 -1.5            0              3.3127155    
    200000   6000           100            100            0.011007301    3.1592968e-21  0              0.033021903    352605.77      0              1.7026071e+13 -1.5            0              3.0466234    
    300000   6000           100            100            0.0032433806   1.4756585e-21  0              0.0097301417   50876.041      0              2.4566219e+12 -1.5            0              3.0303185    
    400000   6000           100            100            0.30875684    -1.4119819e-15  0              0.92627052     9099.6127      0              4.3938773e+11 -1.5            0              2.9970319    
    500000   6000           100            100           -0.00027318474 -1.0654371e-21  0             -0.00081955422  561.3482       0              2.7105496e+10 -1.5            0              3.0020477    
    600000   6000           100            100            0.078640426   -3.6111204e-16  0              0.23592128     233.14374      0              1.1257677e+10 -1.5            0              2.9988027    
    700000   6000           100            100            0.036906643   -1.6792453e-16  0              0.11071993     115.77415      0              5.5903196e+09 -1.5            0              2.9992798    
    800000   6000           100            100            0.032741723   -1.4992307e-16  0              0.098225168    15.517827      0              7.4930031e+08 -1.5            0              2.9993329    
    900000   6000           100            100            0.034159358   -1.560378e-16   0              0.10247807     1.7505059      0              84525665      -1.5            0              2.9993146    
   1000000   6000           100            100            0.032768012   -1.4979906e-16  0              0.098304035    0.13653181     0              6592632.6     -1.5            0              2.9993331    
   1100000   6000           100            100            0.033590441   -1.5352513e-16  0              0.10077132     0.0056937775   0              274932.14     -1.5            0              2.9993221    
   1200000   6000           100            100            0.033221852   -1.518469e-16   0              0.099665557    5.1226199e-06  0              247.35298     -1.5            0              2.999327     
   1300000   6000           100            100            0.033360912   -1.5248247e-16  0              0.10008274     6.8060142e-05  0              3286.3807     -1.5            0              2.9993251    
   1400000   6000           100            100            0.033315945   -1.5227612e-16  0              0.099947835    3.348214e-05   0              1616.7327     -1.5            0              2.9993258    
   1500000   6000           100            100            0.033327893   -1.5233128e-16  0              0.099983679    7.7640173e-06  0              374.89661     -1.5            0              2.9993256    
   1600000   6000           100            100            0.033325753   -1.5232124e-16  0              0.09997726     1.2253397e-06  0              59.16727      -1.5            0              2.9993256    
   1700000   6000           100            100            0.033325632   -1.5232079e-16  0              0.099976897    1.4188942e-07  0              6.8513321     -1.5            0              2.9993256    
   1800000   6000           100            100            0.03332599    -1.5232239e-16  0              0.099977969    1.1585785e-08  0              0.55943609    -1.5            0              2.9993256    
   1900000   6000           100            100            0.033325767   -1.5232139e-16  0              0.099977302    5.2661075e-10  0              0.025428149   -1.5            0              2.9993256    
   2000000   6000           100            100            0.033325869   -1.5232185e-16  0              0.099977608    1.8382068e-12  0              8.8760428e-05 -1.5            0              2.9993256    
   2100000   6000           100            100            0.03332583    -1.5232167e-16  0              0.099977491    4.2656234e-12  0              0.00020597169 -1.5            0              2.9993256    
   2200000   6000           100            100            0.033325843   -1.5232173e-16  0              0.099977529    2.4059493e-12  0              0.00011617468 -1.5            0              2.9993256    
   2300000   6000           100            100            0.03332584    -1.5232171e-16  0              0.099977519    5.8736119e-13  0              2.836157e-05  -1.5            0              2.9993256    
   2400000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    9.5695848e-14  0              4.62081e-06   -1.5            0              2.9993256    
   2500000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    1.1422931e-14  0              5.5157243e-07 -1.5            0              2.9993256    
   2600000   6000           100            100            0.03332584    -1.5232172e-16  0              0.09997752     1.0768342e-15  0              5.199647e-08  -1.5            0              2.9993256    
   2700000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    1.3165497e-17  0              6.3571475e-10 -1.5            0              2.9993256    
   2800000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    4.3369206e-18  0              2.0941438e-10 -1.5            0              2.9993256    
   2900000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    1.1328447e-21  0              5.4701016e-14 -1.5            0              2.9993256    
   3000000   6000           100            100            0.03332584    -1.5232172e-16  0              0.099977521    1.080376e-20   0              5.2167488e-13 -1.5            0              2.9993256    
Loop time of 421.789 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6145245.699 ns/day, 0.000 hours/ns, 7112.553 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.19     | 168.62     | 168.91     |   2.0 | 39.98
Neigh   | 0.97418    | 0.97533    | 0.97648    |   0.1 |  0.23
Comm    | 25.338     | 25.625     | 26.099     |   6.0 |  6.08
Output  | 0.32807    | 0.32809    | 0.32814    |   0.0 |  0.08
Modify  | 201.9      | 202.05     | 202.25     |   1.0 | 47.90
Other   |            | 24.19      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027678311    1.0890576e-20  0              0.083034932    1207329.7      0              5.8297629e+13 -1.5            0              3.3124087    
    200000   6000           100            100            0.011032861    2.9447135e-21  0              0.033098584    353874.16      0              1.7087317e+13 -1.5            0              3.0460769    
    300000   6000           100            100            0.0032845388   1.1540272e-21  0              0.0098536163   51990.546      0              2.5104374e+12 -1.5            0              3.0298628    
    400000   6000           100            100            0.38029043    -1.7330782e-15  0              1.1408713      1757.6292      0              8.4869625e+10 -1.5            0              2.996704     
    500000   6000           100            100           -0.0001104145  -9.5155906e-22  0             -0.00033124349  88.561715      0              4.2763283e+09 -1.5            0              3.0023326    
    600000   6000           100            100            0.001387247   -7.6749772e-18  0              0.004161741    310.92394      0              1.5013404e+10 -1.5            0              2.9999143    
    700000   6000           100            100            0.036189792   -1.6458425e-16  0              0.10856938     120.22931      0              5.8054429e+09 -1.5            0              2.9993144    
    800000   6000           100            100            0.039793737   -1.8184897e-16  0              0.11938121     0.28369128     0              13698437      -1.5            0              2.9992678    
    900000   6000           100            100            0.032030143   -1.4643617e-16  0              0.096090429    1.4171454      0              68428882      -1.5            0              2.9993663    
   1000000   6000           100            100            0.032965689   -1.5059528e-16  0              0.098897067    0.21659896     0              10458788      -1.5            0              2.9993543    
   1100000   6000           100            100            0.033623419   -1.5363249e-16  0              0.10087026     0.00025489936  0              12308.178     -1.5            0              2.9993456    
   1200000   6000           100            100            0.033263037   -1.5198918e-16  0              0.099789112    0.0029594048   0              142899.06     -1.5            0              2.9993503    
   1300000   6000           100            100            0.033310927   -1.5220262e-16  0              0.09993278     0.00049078164  0              23698.089     -1.5            0              2.9993497    
   1400000   6000           100            100            0.033339875   -1.5233644e-16  0              0.10001962     1.2902063e-06  0              62.299444     -1.5            0              2.9993493    
   1500000   6000           100            100            0.033322986   -1.522594e-16   0              0.099968958    5.9986334e-06  0              289.65254     -1.5            0              2.9993495    
   1600000   6000           100            100            0.033325475   -1.5227052e-16  0              0.099976424    1.1057338e-06  0              53.391927     -1.5            0              2.9993495    
   1700000   6000           100            100            0.033326742   -1.5227639e-16  0              0.099980227    5.066926e-09   0              0.24466372    -1.5            0              2.9993495    
   1800000   6000           100            100            0.033325952   -1.5227278e-16  0              0.099977856    1.207144e-08   0              0.58288664    -1.5            0              2.9993495    
   1900000   6000           100            100            0.03332608    -1.5227336e-16  0              0.099978239    2.4790785e-09  0              0.11970583    -1.5            0              2.9993495    
   2000000   6000           100            100            0.033326135   -1.5227361e-16  0              0.099978405    1.7307307e-11  0              0.00083570791 -1.5            0              2.9993495    
   2100000   6000           100            100            0.033326098   -1.5227344e-16  0              0.099978294    2.4104614e-11  0              0.0011639255  -1.5            0              2.9993495    
   2200000   6000           100            100            0.033326104   -1.5227347e-16  0              0.099978313    5.531164e-12   0              0.00026708011 -1.5            0              2.9993495    
   2300000   6000           100            100            0.033326107   -1.5227348e-16  0              0.09997832     5.3727841e-14  0              2.5943251e-06 -1.5            0              2.9993495    
   2400000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978315    4.8067703e-14  0              2.3210174e-06 -1.5            0              2.9993495    
   2500000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978316    1.2290641e-14  0              5.9347105e-07 -1.5            0              2.9993495    
   2600000   6000           100            100            0.033326106   -1.5227348e-16  0              0.099978317    1.0376353e-16  0              5.0103697e-09 -1.5            0              2.9993495    
   2700000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978316    6.0823942e-17  0              2.9369705e-09 -1.5            0              2.9993495    
   2800000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978316    6.2025162e-18  0              2.9949731e-10 -1.5            0              2.9993495    
   2900000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978316    7.1798531e-18  0              3.4668941e-10 -1.5            0              2.9993495    
   3000000   6000           100            100            0.033326105   -1.5227348e-16  0              0.099978316    7.3327835e-18  0              3.5407387e-10 -1.5            0              2.9993495    
Loop time of 421.985 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6142393.741 ns/day, 0.000 hours/ns, 7109.252 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.69     | 168.03     | 169.55     |   9.0 | 39.82
Neigh   | 0.96857    | 0.97258    | 0.97607    |   0.3 |  0.23
Comm    | 24.47      | 26.027     | 27.54      |  25.9 |  6.17
Output  | 0.32721    | 0.32724    | 0.32729    |   0.0 |  0.08
Modify  | 201.71     | 202.18     | 202.56     |   2.5 | 47.91
Other   |            | 24.45      |            |       |  5.79

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027689505    1.108173e-20   0              0.083068515    1208059.9      0              5.8332889e+13 -1.5            0              3.3121225    
    200000   6000           100            100            0.011056658    3.096956e-21   0              0.033169974    355056.43      0              1.7144404e+13 -1.5            0              3.045566     
    300000   6000           100            100            0.0033229201   1.5228082e-21  0              0.0099687602   53037.807      0              2.5610059e+12 -1.5            0              3.0294323    
    400000   6000           100            100            0.40003635    -1.8274487e-15  0              1.200109       272.14914      0              1.3141108e+10 -1.5            0              2.9967013    
    500000   6000           100            100            4.329634e-05  -1.0345301e-21  0              0.00012988902  13.861751      0              6.6933437e+08 -1.5            0              3.0024162    
    600000   6000           100            100            0.00320663    -1.3757897e-17  0              0.0096198899   435.11868      0              2.1010324e+10 -1.5            0              2.999875     
    700000   6000           100            100            0.029364612   -1.3373688e-16  0              0.088093836    119.39793      0              5.7652988e+09 -1.5            0              2.999424     
    800000   6000           100            100            0.031212064   -1.426738e-16   0              0.093636193    14.580026      0              7.0401729e+08 -1.5            0              2.9993988    
    900000   6000           100            100            0.033609935   -1.5379757e-16  0              0.1008298      2.0882272      0              1.0083302e+08 -1.5            0              2.999368     
   1000000   6000           100            100            0.033833859   -1.5489215e-16  0              0.10150158     0.17836509     0              8612611.9     -1.5            0              2.9993651    
   1100000   6000           100            100            0.033607819   -1.5388313e-16  0              0.10082346     0.0057925874   0              279703.32     -1.5            0              2.9993678    
   1200000   6000           100            100            0.033436181   -1.5310447e-16  0              0.10030854     5.2274211e-05  0              2524.1346     -1.5            0              2.99937      
   1300000   6000           100            100            0.033358425   -1.5274958e-16  0              0.10007527     0.00020645553  0              9968.9985     -1.5            0              2.999371     
   1400000   6000           100            100            0.033332137   -1.52629e-16    0              0.099996412    6.4475481e-05  0              3113.2902     -1.5            0              2.9993713    
   1500000   6000           100            100            0.033325805   -1.5259972e-16  0              0.099977415    9.9174019e-06  0              478.87585     -1.5            0              2.9993714    
   1600000   6000           100            100            0.033325259   -1.5259707e-16  0              0.099975778    8.5526783e-07  0              41.297823     -1.5            0              2.9993714    
   1700000   6000           100            100            0.033325739   -1.5259921e-16  0              0.099977217    2.8581386e-08  0              1.3800928     -1.5            0              2.9993714    
   1800000   6000           100            100            0.033326109   -1.5260089e-16  0              0.099978328    2.0548104e-10  0              0.0099219438  -1.5            0              2.9993714    
   1900000   6000           100            100            0.033326278   -1.5260166e-16  0              0.099978835    9.5197531e-10  0              0.045967481   -1.5            0              2.9993714    
   2000000   6000           100            100            0.033326336   -1.5260192e-16  0              0.099979007    3.026724e-10   0              0.014614967   -1.5            0              2.9993714    
   2100000   6000           100            100            0.03332635    -1.5260199e-16  0              0.099979049    4.7069009e-11  0              0.002272794   -1.5            0              2.9993714    
   2200000   6000           100            100            0.033326351   -1.5260199e-16  0              0.099979052    4.1021859e-12  0              0.00019807987 -1.5            0              2.9993714    
   2300000   6000           100            100            0.03332635    -1.5260199e-16  0              0.099979049    1.4075978e-13  0              6.7967858e-06 -1.5            0              2.9993714    
   2400000   6000           100            100            0.033326349   -1.5260198e-16  0              0.099979047    8.4558417e-16  0              4.0830233e-08 -1.5            0              2.9993714    
   2500000   6000           100            100            0.033326349   -1.5260198e-16  0              0.099979046    4.5277094e-15  0              2.1862688e-07 -1.5            0              2.9993714    
   2600000   6000           100            100            0.033326348   -1.5260198e-16  0              0.099979045    1.3849657e-15  0              6.6875038e-08 -1.5            0              2.9993714    
   2700000   6000           100            100            0.033326348   -1.5260198e-16  0              0.099979045    2.1902626e-16  0              1.0575994e-08 -1.5            0              2.9993714    
   2800000   6000           100            100            0.033326348   -1.5260198e-16  0              0.099979045    1.9830254e-17  0              9.5753202e-10 -1.5            0              2.9993714    
   2900000   6000           100            100            0.033326348   -1.5260198e-16  0              0.099979045    1.5124492e-18  0              7.3030758e-11 -1.5            0              2.9993714    
   3000000   6000           100            100            0.033326348   -1.5260198e-16  0              0.099979045    2.9387456e-19  0              1.4190151e-11 -1.5            0              2.9993714    
Loop time of 421.608 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6147894.808 ns/day, 0.000 hours/ns, 7115.619 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.1      | 167.99     | 169.2      |   7.0 | 39.84
Neigh   | 0.99183    | 0.99613    | 1.0002     |   0.4 |  0.24
Comm    | 24.971     | 25.993     | 27.124     |  20.0 |  6.17
Output  | 0.4579     | 0.45793    | 0.45798    |   0.0 |  0.11
Modify  | 201.22     | 201.74     | 202.43     |   3.1 | 47.85
Other   |            | 24.44      |            |       |  5.80

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027699942    1.1058197e-20  0              0.083099827    1208741        0              5.8365779e+13 -1.5            0              3.311855     
    200000   6000           100            100            0.011078867    3.4351928e-21  0              0.0332366      356160.97      0              1.7197739e+13 -1.5            0              3.0450879    
    300000   6000           100            100            0.0033588026   1.1586196e-21  0              0.010076408    54023.774      0              2.6086147e+12 -1.5            0              3.0290252    
    400000   6000           100            100            0.36573384    -1.6929913e-15  0              1.0972015      5041.6545      0              2.4344345e+11 -1.5            0              2.9969889    
    500000   6000           100            100            0.00018868854 -1.0267238e-21  0              0.00056606561  251.39192      0              1.2138816e+10 -1.5            0              3.0023403    
    600000   6000           100            100            0.077805921   -3.5394565e-16  0              0.23341776     373.0513       0              1.8013312e+10 -1.5            0              2.9989312    
    700000   6000           100            100            0.019594418   -8.912721e-17   0              0.058783253    50.556393      0              2.4411873e+09 -1.5            0              2.9995742    
    800000   6000           100            100            0.030843253   -1.4125455e-16  0              0.09252976     14.402858      0              6.9546246e+08 -1.5            0              2.9994215    
    900000   6000           100            100            0.035314324   -1.6147672e-16  0              0.10594297     0.72796103     0              35150633      -1.5            0              2.9993674    
   1000000   6000           100            100            0.034043584   -1.5559096e-16  0              0.10213075     0.094147113    0              4546027.1     -1.5            0              2.9993828    
   1100000   6000           100            100            0.033244194   -1.5194813e-16  0              0.099732582    0.033778064    0              1631021.8     -1.5            0              2.9993925    
   1200000   6000           100            100            0.033213503   -1.5182036e-16  0              0.099640508    3.312537e-05   0              1599.5056     -1.5            0              2.9993929    
   1300000   6000           100            100            0.033309197   -1.5225942e-16  0              0.099927592    0.00050220527  0              24249.695     -1.5            0              2.9993917    
   1400000   6000           100            100            0.033336936   -1.5238501e-16  0              0.10001081     3.9680872e-05  0              1916.0473     -1.5            0              2.9993914    
   1500000   6000           100            100            0.033331392   -1.5235916e-16  0              0.099994177    1.8102198e-06  0              87.409036     -1.5            0              2.9993914    
   1600000   6000           100            100            0.033326422   -1.5233647e-16  0              0.099979267    1.3228684e-06  0              63.876582     -1.5            0              2.9993915    
   1700000   6000           100            100            0.03332591    -1.523342e-16   0              0.09997773     1.2211585e-08  0              0.58965372    -1.5            0              2.9993915    
   1800000   6000           100            100            0.033326427   -1.5233658e-16  0              0.099979282    1.4826535e-08  0              0.7159203     -1.5            0              2.9993915    
   1900000   6000           100            100            0.033326622   -1.5233746e-16  0              0.099979866    1.9800992e-09  0              0.095611902   -1.5            0              2.9993915    
   2000000   6000           100            100            0.033326603   -1.5233737e-16  0              0.099979809    2.2716513e-11  0              0.0010968991  -1.5            0              2.9993915    
   2100000   6000           100            100            0.033326573   -1.5233724e-16  0              0.09997972     4.8304093e-11  0              0.0023324318  -1.5            0              2.9993915    
   2200000   6000           100            100            0.033326568   -1.5233721e-16  0              0.099979705    1.222196e-12   0              5.9015472e-05 -1.5            0              2.9993915    
   2300000   6000           100            100            0.033326571   -1.5233723e-16  0              0.099979713    3.9642578e-13  0              1.9141982e-05 -1.5            0              2.9993915    
   2400000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979717    8.949363e-14   0              4.3213271e-06 -1.5            0              2.9993915    
   2500000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979717    3.8531337e-17  0              1.8605403e-09 -1.5            0              2.9993915    
   2600000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979716    1.6609435e-15  0              8.0201016e-08 -1.5            0              2.9993915    
   2700000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979716    4.5408467e-17  0              2.1926124e-09 -1.5            0              2.9993915    
   2800000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979716    1.9972133e-17  0              9.6438284e-10 -1.5            0              2.9993915    
   2900000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979716    5.3718533e-18  0              2.5938757e-10 -1.5            0              2.9993915    
   3000000   6000           100            100            0.033326572   -1.5233723e-16  0              0.099979716    1.4773909e-17  0              7.133792e-10  -1.5            0              2.9993915    
Loop time of 423.196 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6124820.364 ns/day, 0.000 hours/ns, 7088.912 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.85     | 168.81     | 170.07     |   6.2 | 39.89
Neigh   | 0.97462    | 0.97859    | 0.98223    |   0.4 |  0.23
Comm    | 24.888     | 25.928     | 26.994     |  15.2 |  6.13
Output  | 0.34034    | 0.3404     | 0.34047    |   0.0 |  0.08
Modify  | 202.41     | 202.84     | 203.39     |   2.5 | 47.93
Other   |            | 24.29      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027709705    1.0961996e-20  0              0.083129114    1209378.3      0              5.8396551e+13 -1.5            0              3.3116043    
    200000   6000           100            100            0.01109967     3.0390178e-21  0              0.033299011    357196.68      0              1.7247749e+13 -1.5            0              3.0446386    
    300000   6000           100            100            0.0033924717   1.3882274e-21  0              0.010177415    54954.935      0              2.6535771e+12 -1.5            0              3.0286392    
    400000   6000           100            100            0.28957361    -1.3403263e-15  0              0.86872083     13169.819      0              6.3592343e+11 -1.5            0              2.9974984    
    500000   6000           100            100            0.00032643846 -8.7249772e-22  0              0.00097931537  734.82141      0              3.5481896e+10 -1.5            0              3.0021372    
    600000   6000           100            100            0.054463932   -2.5147497e-16  0              0.1633918      829.62722      0              4.0059729e+10 -1.5            0              2.9991781    
    700000   6000           100            100            0.015946471   -7.3113855e-17  0              0.047839414    6.3438553      0              3.0632207e+08 -1.5            0              2.9996387    
    800000   6000           100            100            0.037206854   -1.6983199e-16  0              0.11162056     11.820188      0              5.707546e+08  -1.5            0              2.9993656    
    900000   6000           100            100            0.032020814   -1.4647337e-16  0              0.096062443    1.6000682      0              77261569      -1.5            0              2.9994254    
   1000000   6000           100            100            0.033812235   -1.5453675e-16  0              0.10143671     0.20351769     0              9827141       -1.5            0              2.9994044    
   1100000   6000           100            100            0.033141496   -1.515155e-16   0              0.099424487    0.025034557    0              1208829.2     -1.5            0              2.9994122    
   1200000   6000           100            100            0.033397063   -1.5266804e-16  0              0.10019119     0.0030796361   0              148704.61     -1.5            0              2.9994092    
   1300000   6000           100            100            0.033300189   -1.5223074e-16  0              0.099900567    0.00037611699  0              18161.343     -1.5            0              2.9994104    
   1400000   6000           100            100            0.033336798   -1.5239614e-16  0              0.10001039     4.575021e-05   0              2209.1139     -1.5            0              2.9994099    
   1500000   6000           100            100            0.033323015   -1.5233382e-16  0              0.099969046    5.5340818e-06  0              267.22101     -1.5            0              2.9994101    
   1600000   6000           100            100            0.033328188   -1.5235722e-16  0              0.099984563    6.6576348e-07  0              32.147336     -1.5            0              2.99941      
   1700000   6000           100            100            0.033326252   -1.5234846e-16  0              0.099978757    7.9606671e-08  0              3.8439212     -1.5            0              2.9994101    
   1800000   6000           100            100            0.033326974   -1.5235173e-16  0              0.099980923    9.4567781e-09  0              0.45663397    -1.5            0              2.9994101    
   1900000   6000           100            100            0.033326706   -1.5235051e-16  0              0.099980117    1.115401e-09   0              0.053858724   -1.5            0              2.9994101    
   2000000   6000           100            100            0.033326805   -1.5235097e-16  0              0.099980416    1.3054531e-10  0              0.006303566   -1.5            0              2.9994101    
   2100000   6000           100            100            0.033326769   -1.523508e-16   0              0.099980306    1.5130819e-11  0              0.00073061308 -1.5            0              2.9994101    
   2200000   6000           100            100            0.033326782   -1.5235086e-16  0              0.099980346    1.7381245e-12  0              8.3927811e-05 -1.5            0              2.9994101    
   2300000   6000           100            100            0.033326777   -1.5235084e-16  0              0.099980331    1.9767374e-13  0              9.5449574e-06 -1.5            0              2.9994101    
   2400000   6000           100            100            0.033326779   -1.5235085e-16  0              0.099980337    2.1785026e-14  0              1.0519209e-06 -1.5            0              2.9994101    
   2500000   6000           100            100            0.033326778   -1.5235084e-16  0              0.099980335    2.3821989e-15  0              1.1502786e-07 -1.5            0              2.9994101    
   2600000   6000           100            100            0.033326779   -1.5235084e-16  0              0.099980336    1.7487107e-16  0              8.4438979e-09 -1.5            0              2.9994101    
   2700000   6000           100            100            0.033326778   -1.5235084e-16  0              0.099980335    8.7810436e-17  0              4.2400517e-09 -1.5            0              2.9994101    
   2800000   6000           100            100            0.033326778   -1.5235084e-16  0              0.099980335    2.4420579e-17  0              1.1791824e-09 -1.5            0              2.9994101    
   2900000   6000           100            100            0.033326778   -1.5235084e-16  0              0.099980335    1.5567022e-17  0              7.5167579e-10 -1.5            0              2.9994101    
   3000000   6000           100            100            0.033326778   -1.5235084e-16  0              0.099980335    2.4874803e-18  0              1.2011152e-10 -1.5            0              2.9994101    
Loop time of 422.539 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6134349.444 ns/day, 0.000 hours/ns, 7099.941 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.2      | 168.84     | 169.85     |   5.0 | 39.96
Neigh   | 0.99319    | 0.99728    | 1.0016     |   0.4 |  0.24
Comm    | 25.153     | 25.938     | 26.483     |   9.6 |  6.14
Output  | 0.32883    | 0.32887    | 0.32894    |   0.0 |  0.08
Modify  | 201.61     | 201.92     | 202.52     |   2.5 | 47.79
Other   |            | 24.52      |            |       |  5.80

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027718863    1.0956485e-20  0              0.083156589    1209976.3      0              5.8425426e+13 -1.5            0              3.3113691    
    200000   6000           100            100            0.011119182    3.3506332e-21  0              0.033357546    358168.92      0              1.7294695e+13 -1.5            0              3.0442166    
    300000   6000           100            100            0.0034240856   1.1737965e-21  0              0.010272257    55834.512      0              2.6960488e+12 -1.5            0              3.0282734    
    400000   6000           100            100            0.19240628    -9.0477469e-16  0              0.57721885     20790.133      0              1.0038811e+12 -1.5            0              2.9981466    
    500000   6000           100            100            0.00045708613 -9.0165205e-22  0              0.0013712584   1411.9561      0              6.8178308e+10 -1.5            0              3.0018328    
    600000   6000           100            100           -0.00018206028 -2.4918469e-21  0             -0.00054618084  245.22627      0              1.1841099e+10 -1.5            0              3.0000251    
    700000   6000           100            100            0.029716576   -1.3671959e-16  0              0.089149729    128.16952      0              6.1888475e+09 -1.5            0              2.9994678    
    800000   6000           100            100            0.030036382   -1.3765881e-16  0              0.090109145    13.513658      0              6.5252617e+08 -1.5            0              2.9994651    
    900000   6000           100            100            0.030796952   -1.4088414e-16  0              0.092390856    0.0046410309   0              224098.77     -1.5            0              2.9994566    
   1000000   6000           100            100            0.032915264   -1.505241e-16   0              0.098745793    0.23202452     0              11203634      -1.5            0              2.9994321    
   1100000   6000           100            100            0.033540952   -1.5340601e-16  0              0.10062286     0.022230415    0              1073427.2     -1.5            0              2.9994249    
   1200000   6000           100            100            0.033441336   -1.5296272e-16  0              0.10032401     0.00040719156  0              19661.823     -1.5            0              2.999426     
   1300000   6000           100            100            0.033331705   -1.5246217e-16  0              0.099995115    0.00062936815  0              30389.936     -1.5            0              2.9994272    
   1400000   6000           100            100            0.033313475   -1.5237743e-16  0              0.099940425    2.0410774e-05  0              985.56322     -1.5            0              2.9994274    
   1500000   6000           100            100            0.033322515   -1.5241828e-16  0              0.099967545    3.8882808e-06  0              187.75117     -1.5            0              2.9994273    
   1600000   6000           100            100            0.033327455   -1.5244091e-16  0              0.099982364    1.3169545e-06  0              63.591021     -1.5            0              2.9994273    
   1700000   6000           100            100            0.033327686   -1.5244204e-16  0              0.099983059    4.962017e-09   0              0.23959804    -1.5            0              2.9994273    
   1800000   6000           100            100            0.033327111   -1.5243942e-16  0              0.099981332    1.6630624e-08  0              0.80303329    -1.5            0              2.9994273    
   1900000   6000           100            100            0.033326917   -1.5243853e-16  0              0.099980751    2.1006731e-09  0              0.10143399    -1.5            0              2.9994273    
   2000000   6000           100            100            0.033326937   -1.5243862e-16  0              0.09998081     1.3727712e-11  0              0.00066286207 -1.5            0              2.9994273    
   2100000   6000           100            100            0.033326967   -1.5243876e-16  0              0.099980902    4.907614e-11   0              0.0023697112  -1.5            0              2.9994273    
   2200000   6000           100            100            0.033326973   -1.5243879e-16  0              0.09998092     2.279655e-12   0              0.00011007638 -1.5            0              2.9994273    
   2300000   6000           100            100            0.033326971   -1.5243878e-16  0              0.099980914    2.2913913e-13  0              1.1064309e-05 -1.5            0              2.9994273    
   2400000   6000           100            100            0.03332697    -1.5243877e-16  0              0.099980909    1.1050307e-13  0              5.3357977e-06 -1.5            0              2.9994273    
   2500000   6000           100            100            0.03332697    -1.5243877e-16  0              0.099980909    1.11431e-15    0              5.3806044e-08 -1.5            0              2.9994273    
   2600000   6000           100            100            0.03332697    -1.5243877e-16  0              0.099980909    1.2767834e-15  0              6.1651303e-08 -1.5            0              2.9994273    
   2700000   6000           100            100            0.03332697    -1.5243877e-16  0              0.09998091     2.4078601e-16  0              1.1626695e-08 -1.5            0              2.9994273    
   2800000   6000           100            100            0.03332697    -1.5243877e-16  0              0.09998091     2.9055585e-17  0              1.4029902e-09 -1.5            0              2.9994273    
   2900000   6000           100            100            0.03332697    -1.5243877e-16  0              0.09998091     1.2034021e-17  0              5.8107981e-10 -1.5            0              2.9994273    
   3000000   6000           100            100            0.03332697    -1.5243877e-16  0              0.09998091     1.4447502e-17  0              6.9761819e-10 -1.5            0              2.9994273    
Loop time of 422.757 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6131182.930 ns/day, 0.000 hours/ns, 7096.277 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.01     | 168.99     | 170.12     |   5.8 | 39.97
Neigh   | 0.98872    | 0.9923     | 0.99568    |   0.3 |  0.23
Comm    | 25.06      | 25.939     | 27.109     |  15.0 |  6.14
Output  | 0.32764    | 0.32767    | 0.32772    |   0.0 |  0.08
Modify  | 201.83     | 202.12     | 202.82     |   2.9 | 47.81
Other   |            | 24.39      |            |       |  5.77

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027727482    1.177266e-20   0              0.083182447    1210539.5      0              5.8452619e+13 -1.5            0              3.3111465    
    200000   6000           100            100            0.011137604    2.982002e-21   0              0.033412812    359087.74      0              1.7339062e+13 -1.5            0              3.0438163    
    300000   6000           100            100            0.0034539781   1.0973575e-21  0              0.010361934    56670.865      0              2.7364333e+12 -1.5            0              3.027924     
    400000   6000           100            100            0.096462788   -4.6923553e-16  0              0.28938836     25356.746      0              1.2243865e+12 -1.5            0              2.9988564    
    500000   6000           100            100            0.0005813305  -7.5849332e-22  0              0.0017439915   2242.8075      0              1.0829715e+11 -1.5            0              3.0014468    
    600000   6000           100            100            0.00015521113 -2.3002309e-21  0              0.00046563339  171.49116      0              8.2806946e+09 -1.5            0              3.0000823    
    700000   6000           100            100            0.05386638    -2.4637276e-16  0              0.16159914     8.5560323      0              4.1314018e+08 -1.5            0              2.9992329    
    800000   6000           100            100            0.032959667   -1.5037606e-16  0              0.098879       17.516866      0              8.4582679e+08 -1.5            0              2.999448     
    900000   6000           100            100            0.031001584   -1.4168027e-16  0              0.093004752    0.44024277     0              21257748      -1.5            0              2.9994696    
   1000000   6000           100            100            0.032513105   -1.4865059e-16  0              0.097539314    0.074842924    0              3613897       -1.5            0              2.9994524    
   1100000   6000           100            100            0.033302152   -1.5224955e-16  0              0.099906457    0.038346771    0              1851628.3     -1.5            0              2.9994436    
   1200000   6000           100            100            0.033423008   -1.5279094e-16  0              0.10026902     0.0019204078   0              92729.618     -1.5            0              2.9994422    
   1300000   6000           100            100            0.033369286   -1.5254191e-16  0              0.10010786     5.8426506e-05  0              2821.2069     -1.5            0              2.9994428    
   1400000   6000           100            100            0.033331815   -1.5237067e-16  0              0.099995444    7.7381267e-05  0              3736.4645     -1.5            0              2.9994433    
   1500000   6000           100            100            0.033323571   -1.5233344e-16  0              0.099970712    6.6634092e-06  0              321.75218     -1.5            0              2.9994433    
   1600000   6000           100            100            0.033325088   -1.5234056e-16  0              0.099975264    8.8158929e-09  0              0.42568792    -1.5            0              2.9994433    
   1700000   6000           100            100            0.033326776   -1.5234829e-16  0              0.099980327    1.3950876e-07  0              6.7363787     -1.5            0              2.9994433    
   1800000   6000           100            100            0.033327264   -1.5235051e-16  0              0.099981793    1.9480015e-08  0              0.94062019    -1.5            0              2.9994433    
   1900000   6000           100            100            0.033327244   -1.523504e-16   0              0.099981731    6.7066163e-11  0              0.003238385   -1.5            0              2.9994433    
   2000000   6000           100            100            0.033327172   -1.5235007e-16  0              0.099981515    2.1923576e-10  0              0.01058611    -1.5            0              2.9994433    
   2100000   6000           100            100            0.033327145   -1.5234995e-16  0              0.099981435    5.0140735e-11  0              0.0024211167  -1.5            0              2.9994433    
   2200000   6000           100            100            0.033327144   -1.5234995e-16  0              0.099981431    9.0843777e-13  0              4.3865209e-05 -1.5            0              2.9994433    
   2300000   6000           100            100            0.033327147   -1.5234996e-16  0              0.09998144     2.8194113e-13  0              1.3613928e-05 -1.5            0              2.9994433    
   2400000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    1.1523956e-13  0              5.564506e-06  -1.5            0              2.9994433    
   2500000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    4.8673806e-15  0              2.3502839e-07 -1.5            0              2.9994433    
   2600000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    1.6572738e-16  0              8.0023819e-09 -1.5            0              2.9994433    
   2700000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    2.39254e-16    0              1.155272e-08  -1.5            0              2.9994433    
   2800000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    2.7387048e-17  0              1.3224225e-09 -1.5            0              2.9994433    
   2900000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    1.2661771e-17  0              6.1139162e-10 -1.5            0              2.9994433    
   3000000   6000           100            100            0.033327148   -1.5234997e-16  0              0.099981444    1.159316e-17   0              5.5979219e-10 -1.5            0              2.9994433    
Loop time of 423.609 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6118847.056 ns/day, 0.000 hours/ns, 7081.999 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.81     | 169.93     | 171.52     |   8.0 | 40.11
Neigh   | 0.9807     | 0.98417    | 0.9876     |   0.3 |  0.23
Comm    | 25.26      | 26.318     | 27.585     |  16.2 |  6.21
Output  | 0.32727    | 0.32731    | 0.32737    |   0.0 |  0.08
Modify  | 200.94     | 201.66     | 202.39     |   3.6 | 47.60
Other   |            | 24.4       |            |       |  5.76

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027735611    1.1251859e-20  0              0.083206832    1211070.6      0              5.8478263e+13 -1.5            0              3.3109369    
    200000   6000           100            100            0.011154973    2.6218292e-21  0              0.033464918    359954.69      0              1.7380924e+13 -1.5            0              3.0434385    
    300000   6000           100            100            0.0034821997   1.435569e-21   0              0.010446599    57464.6        0              2.7747599e+12 -1.5            0              3.0275915    
    400000   6000           100            100            0.022394425   -1.2339166e-16  0              0.067183276    26420.874      0              1.2757695e+12 -1.5            0              2.9995642    
    500000   6000           100            100            0.00069957238 -9.2023297e-22  0              0.0020987171   3194.4891      0              1.5425045e+11 -1.5            0              3.0009959    
    600000   6000           100            100            0.035432783   -1.6052282e-16  0              0.10629835     1012.5859      0              4.8894151e+10 -1.5            0              2.9994399    
    700000   6000           100            100            0.035017282   -1.5924937e-16  0              0.10505184     136.08188      0              6.570907e+09  -1.5            0              2.9994416    
    800000   6000           100            100            0.038908334   -1.7806221e-16  0              0.116725       8.0149307      0              3.8701232e+08 -1.5            0              2.999399     
    900000   6000           100            100            0.031026016   -1.4180007e-16  0              0.093078047    0.56509671     0              27286498      -1.5            0              2.9994836    
   1000000   6000           100            100            0.034205972   -1.5639537e-16  0              0.10261792     0.051412063    0              2482504.5     -1.5            0              2.9994487    
   1100000   6000           100            100            0.033000726   -1.508689e-16   0              0.099002179    0.0043830202   0              211640.36     -1.5            0              2.9994618    
   1200000   6000           100            100            0.033448263   -1.5291929e-16  0              0.10034479     0.00033711549  0              16278.101     -1.5            0              2.9994569    
   1300000   6000           100            100            0.033282922   -1.5216237e-16  0              0.099848766    2.0983372e-05  0              1013.2119     -1.5            0              2.9994587    
   1400000   6000           100            100            0.033343508   -1.5243953e-16  0              0.10003052     8.2318011e-07  0              39.748422     -1.5            0              2.9994581    
   1500000   6000           100            100            0.033321447   -1.5233869e-16  0              0.099964341    3.1968775e-09  0              0.15436577    -1.5            0              2.9994583    
   1600000   6000           100            100            0.033329426   -1.5237513e-16  0              0.099988277    5.9740298e-09  0              0.28846452    -1.5            0              2.9994582    
   1700000   6000           100            100            0.033326559   -1.5236205e-16  0              0.099979676    3.9564719e-09  0              0.19104387    -1.5            0              2.9994583    
   1800000   6000           100            100            0.033327582   -1.5236671e-16  0              0.099982747    1.2362474e-09  0              0.059693961   -1.5            0              2.9994583    
   1900000   6000           100            100            0.033327219   -1.5236506e-16  0              0.099981658    2.9221797e-10  0              0.01411016    -1.5            0              2.9994583    
   2000000   6000           100            100            0.033327347   -1.5236564e-16  0              0.099982041    5.9533568e-11  0              0.0028746629  -1.5            0              2.9994583    
   2100000   6000           100            100            0.033327302   -1.5236544e-16  0              0.099981907    1.1039541e-11  0              0.00053305992 -1.5            0              2.9994583    
   2200000   6000           100            100            0.033327318   -1.5236551e-16  0              0.099981954    1.9215782e-12  0              9.2786135e-05 -1.5            0              2.9994583    
   2300000   6000           100            100            0.033327313   -1.5236549e-16  0              0.099981938    3.1996412e-13  0              1.5449922e-05 -1.5            0              2.9994583    
   2400000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981943    5.0413691e-14  0              2.4342967e-06 -1.5            0              2.9994583    
   2500000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981941    7.798745e-15   0              3.7657349e-07 -1.5            0              2.9994583    
   2600000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981942    1.1003473e-15  0              5.3131835e-08 -1.5            0              2.9994583    
   2700000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981942    2.4846632e-16  0              1.1997549e-08 -1.5            0              2.9994583    
   2800000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981942    7.5797975e-18  0              3.660013e-10  -1.5            0              2.9994583    
   2900000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981942    3.3505643e-18  0              1.6178676e-10 -1.5            0              2.9994583    
   3000000   6000           100            100            0.033327314   -1.5236549e-16  0              0.099981942    9.7885761e-18  0              4.7265531e-10 -1.5            0              2.9994583    
Loop time of 423.524 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6120080.627 ns/day, 0.000 hours/ns, 7083.427 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.19     | 169.39     | 170.31     |   6.4 | 39.99
Neigh   | 0.9897     | 0.99662    | 1.0036     |   0.7 |  0.24
Comm    | 25.468     | 26.351     | 27.56      |  16.7 |  6.22
Output  | 0.32955    | 0.32959    | 0.32965    |   0.0 |  0.08
Modify  | 201.81     | 201.99     | 202.17     |   1.1 | 47.69
Other   |            | 24.47      |            |       |  5.78

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027743298    1.1031953e-20  0              0.083229893    1211573        0              5.8502525e+13 -1.5            0              3.3107379    
    200000   6000           100            100            0.011171425    3.249531e-21   0              0.033514276    360776.59      0              1.7420611e+13 -1.5            0              3.0430795    
    300000   6000           100            100            0.0035089585   1.5211298e-21  0              0.010526875    58220.883      0              2.8112781e+12 -1.5            0              3.0272737    
    400000   6000           100            100           -0.001591714    1.4854545e-24  0             -0.0047751419   25373.31       0              1.2251863e+12 -1.5            0              3.0002323    
    500000   6000           100            100            0.00081229416 -7.1567003e-22  0              0.0024368825   4241.3757      0              2.0480085e+11 -1.5            0              3.000493     
    600000   6000           100            100            0.098084843   -4.486995e-16   0              0.29425453     7.3706315      0              3.5590142e+08 -1.5            0              2.9989163    
    700000   6000           100            100            0.014244726   -6.5364311e-17  0              0.042734177    2.3105246      0              1.1156696e+08 -1.5            0              2.9997003    
    800000   6000           100            100            0.026515577   -1.2146232e-16  0              0.079546732    2.7345337      0              1.3204084e+08 -1.5            0              2.9995466    
    900000   6000           100            100            0.030663784   -1.4028599e-16  0              0.091991353    0.067222125    0              3245915.9     -1.5            0              2.9995008    
   1000000   6000           100            100            0.032686605   -1.495173e-16   0              0.098059814    0.17516659     0              8458167.6     -1.5            0              2.9994791    
   1100000   6000           100            100            0.033324644   -1.5244824e-16  0              0.099973933    0.039906579    0              1926945.9     -1.5            0              2.9994723    
   1200000   6000           100            100            0.033409601   -1.5284668e-16  0              0.1002288      0.0030717893   0              148325.71     -1.5            0              2.9994714    
   1300000   6000           100            100            0.033372968   -1.5268288e-16  0              0.1001189      2.0143816e-05  0              972.67277     -1.5            0              2.9994718    
   1400000   6000           100            100            0.033341802   -1.5254114e-16  0              0.10002541     2.2457717e-05  0              1084.4028     -1.5            0              2.9994721    
   1500000   6000           100            100            0.033329433   -1.5248451e-16  0              0.0999883      1.0171636e-05  0              491.15191     -1.5            0              2.9994722    
   1600000   6000           100            100            0.033326685   -1.5247181e-16  0              0.099980056    1.2936225e-06  0              62.4644       -1.5            0              2.9994722    
   1700000   6000           100            100            0.033326783   -1.5247219e-16  0              0.099980348    4.4362837e-08  0              2.1421226     -1.5            0              2.9994722    
   1800000   6000           100            100            0.033327194   -1.5247405e-16  0              0.099981581    1.0306454e-09  0              0.04976618    -1.5            0              2.9994722    
   1900000   6000           100            100            0.033327407   -1.5247502e-16  0              0.099982221    2.0290168e-09  0              0.09797396    -1.5            0              2.9994722    
   2000000   6000           100            100            0.033327471   -1.5247532e-16  0              0.099982413    4.2405052e-10  0              0.020475882   -1.5            0              2.9994722    
   2100000   6000           100            100            0.033327478   -1.5247535e-16  0              0.099982435    2.9851446e-11  0              0.0014414195  -1.5            0              2.9994722    
   2200000   6000           100            100            0.033327474   -1.5247533e-16  0              0.099982422    1.0660524e-13  0              5.1475853e-06 -1.5            0              2.9994722    
   2300000   6000           100            100            0.033327471   -1.5247532e-16  0              0.099982412    2.8272462e-13  0              1.365176e-05  -1.5            0              2.9994722    
   2400000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    1.1167177e-13  0              5.3922303e-06 -1.5            0              2.9994722    
   2500000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    1.3133747e-14  0              6.3418165e-07 -1.5            0              2.9994722    
   2600000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    3.186049e-16   0              1.5384291e-08 -1.5            0              2.9994722    
   2700000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    1.6012536e-17  0              7.7318807e-10 -1.5            0              2.9994722    
   2800000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    3.0758593e-17  0              1.4852224e-09 -1.5            0              2.9994722    
   2900000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    4.3927688e-18  0              2.1211109e-10 -1.5            0              2.9994722    
   3000000   6000           100            100            0.033327469   -1.5247531e-16  0              0.099982408    1.376401e-20   0              6.6461479e-13 -1.5            0              2.9994722    
Loop time of 423.286 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6123521.148 ns/day, 0.000 hours/ns, 7087.409 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.48     | 168.88     | 169.15     |   1.9 | 39.90
Neigh   | 0.96665    | 0.96971    | 0.97286    |   0.3 |  0.23
Comm    | 25.854     | 26.008     | 26.343     |   3.9 |  6.14
Output  | 0.32763    | 0.32766    | 0.32772    |   0.0 |  0.08
Modify  | 202.56     | 202.77     | 203.1      |   1.4 | 47.90
Other   |            | 24.33      |            |       |  5.75

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027750581    1.1035926e-20  0              0.083251742    1212049.3      0              5.8525521e+13 -1.5            0              3.310549     
    200000   6000           100            100            0.01118702     3.2107351e-21  0              0.03356106     361556.19      0              1.7458255e+13 -1.5            0              3.0427387    
    300000   6000           100            100            0.0035343495   1.681955e-21   0              0.010603049    58941.813      0              2.8460892e+12 -1.5            0              3.02697      
    400000   6000           100            100           -0.0015606036  -8.4281237e-23  0             -0.0046818108   24173.504      0              1.167252e+12  -1.5            0              3.0008515    
    500000   6000           100            100            0.0019763981  -5.5515628e-18  0              0.0059291942   5361.4108      0              2.5888334e+11 -1.5            0              2.9999486    
    600000   6000           100            100            0.047186512   -2.1928762e-16  0              0.14155954     979.52665      0              4.7297836e+10 -1.5            0              2.9993477    
    700000   6000           100            100            0.044895538   -2.0582566e-16  0              0.13468661     101.94891      0              4.9227479e+09 -1.5            0              2.9993711    
    800000   6000           100            100            0.031275111   -1.4259927e-16  0              0.093825334    17.056062      0              8.2357618e+08 -1.5            0              2.9995072    
    900000   6000           100            100            0.030976494   -1.4158699e-16  0              0.092929483    0.66798538     0              32254623      -1.5            0              2.9995097    
   1000000   6000           100            100            0.034016904   -1.5544457e-16  0              0.10205071     0.16466139     0              7950909.1     -1.5            0              2.9994782    
   1100000   6000           100            100            0.033541166   -1.5323122e-16  0              0.1006235      0.026631849    0              1285956.7     -1.5            0              2.9994832    
   1200000   6000           100            100            0.033209878   -1.5172751e-16  0              0.099629633    0.0009794271   0              47293.029     -1.5            0              2.9994866    
   1300000   6000           100            100            0.033315158   -1.5221237e-16  0              0.099945475    0.0006401466   0              30910.388     -1.5            0              2.9994855    
   1400000   6000           100            100            0.033344563   -1.5234493e-16  0              0.10003369     6.043184e-07   0              29.180373     -1.5            0              2.9994852    
   1500000   6000           100            100            0.033327027   -1.5226455e-16  0              0.099981082    1.1515992e-05  0              556.06606     -1.5            0              2.9994854    
   1600000   6000           100            100            0.033325486   -1.5225778e-16  0              0.099976459    1.1622406e-07  0              5.6120441     -1.5            0              2.9994854    
   1700000   6000           100            100            0.033327969   -1.5226912e-16  0              0.099983906    1.5772736e-07  0              7.6160897     -1.5            0              2.9994853    
   1800000   6000           100            100            0.033327846   -1.5226852e-16  0              0.099983538    9.2343811e-09  0              0.44589522    -1.5            0              2.9994853    
   1900000   6000           100            100            0.033327539   -1.5226712e-16  0              0.099982617    1.5332975e-09  0              0.074037451   -1.5            0              2.9994854    
   2000000   6000           100            100            0.033327595   -1.5226738e-16  0              0.099982785    3.0992637e-10  0              0.014965235   -1.5            0              2.9994853    
   2100000   6000           100            100            0.033327628   -1.5226753e-16  0              0.099982883    7.8556324e-12  0              0.00037932037 -1.5            0              2.9994853    
   2200000   6000           100            100            0.033327616   -1.5226748e-16  0              0.099982848    7.0480843e-12  0              0.00034032677 -1.5            0              2.9994853    
   2300000   6000           100            100            0.033327613   -1.5226747e-16  0              0.09998284     4.0313819e-16  0              1.94661e-08   -1.5            0              2.9994853    
   2400000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    1.207188e-13   0              5.8290788e-06 -1.5            0              2.9994853    
   2500000   6000           100            100            0.033327615   -1.5226748e-16  0              0.099982846    1.9047537e-15  0              9.1973741e-08 -1.5            0              2.9994853    
   2600000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    1.5763361e-15  0              7.611563e-08  -1.5            0              2.9994853    
   2700000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    2.6366143e-16  0              1.2731267e-08 -1.5            0              2.9994853    
   2800000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    4.8471097e-19  0              2.3404958e-11 -1.5            0              2.9994853    
   2900000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    8.1075613e-18  0              3.9148512e-10 -1.5            0              2.9994853    
   3000000   6000           100            100            0.033327615   -1.5226747e-16  0              0.099982845    1.4663037e-18  0              7.0802557e-11 -1.5            0              2.9994853    
Loop time of 424.572 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6104968.704 ns/day, 0.000 hours/ns, 7065.936 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.35     | 169.45     | 171.4      |  14.7 | 39.91
Neigh   | 1.0005     | 1.0052     | 1.0099     |   0.5 |  0.24
Comm    | 24.785     | 26.942     | 29.116     |  38.8 |  6.35
Output  | 0.32772    | 0.32776    | 0.32783    |   0.0 |  0.08
Modify  | 202.22     | 202.41     | 202.62     |   1.0 | 47.67
Other   |            | 24.45      |            |       |  5.76

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027757495    1.0946527e-20  0              0.083272485    1212501.4      0              5.8547354e+13 -1.5            0              3.3103697    
    200000   6000           100            100            0.011201842    3.4633246e-21  0              0.033605525    362297.67      0              1.7494058e+13 -1.5            0              3.042414     
    300000   6000           100            100            0.0035585194   1.6190943e-21  0              0.010675558    59631.049      0              2.8793699e+12 -1.5            0              3.0266787    
    400000   6000           100            100           -0.0015307757   2.1706842e-22  0             -0.0045923272   23062.448      0              1.1136031e+12 -1.5            0              3.0014268    
    500000   6000           100            100            0.046504495   -2.1262639e-16  0              0.13951348     5846.3331      0              2.822985e+11  -1.5            0              2.9993816    
    600000   6000           100            100           -0.00023710886 -2.0234305e-21  0             -0.00071132658  420.5582       0              2.0307251e+10 -1.5            0              3.0000096    
    700000   6000           100            100            0.038757749   -1.7654082e-16  0              0.11627325     134.54867      0              6.4968735e+09 -1.5            0              2.9994458    
    800000   6000           100            100            0.0408643     -1.869045e-16   0              0.1225929      2.3586398      0              1.1389028e+08 -1.5            0              2.9994247    
    900000   6000           100            100            0.033520817   -1.535676e-16   0              0.10056245     2.4197045      0              1.1683887e+08 -1.5            0              2.9994956    
   1000000   6000           100            100            0.032356436   -1.4812322e-16  0              0.097069309    0.029643595    0              1431383.1     -1.5            0              2.9995075    
   1100000   6000           100            100            0.033572429   -1.5368205e-16  0              0.10071729     0.023329511    0              1126498.6     -1.5            0              2.9994952    
   1200000   6000           100            100            0.033384192   -1.5283735e-16  0              0.10015258     0.0043920541   0              212076.58     -1.5            0              2.9994971    
   1300000   6000           100            100            0.033279648   -1.5235487e-16  0              0.099838943    6.2979762e-07  0              30.410673     -1.5            0              2.9994982    
   1400000   6000           100            100            0.033334252   -1.5260375e-16  0              0.10000276     7.8399141e-05  0              3785.6139     -1.5            0              2.9994976    
   1500000   6000           100            100            0.033332143   -1.5259492e-16  0              0.099996429    5.9842493e-06  0              288.95798     -1.5            0              2.9994976    
   1600000   6000           100            100            0.033325641   -1.5256506e-16  0              0.099976924    2.0090316e-07  0              9.7008945     -1.5            0              2.9994977    
   1700000   6000           100            100            0.033327788   -1.5257481e-16  0              0.099983364    2.0027236e-07  0              9.6704355     -1.5            0              2.9994977    
   1800000   6000           100            100            0.033328016   -1.5257589e-16  0              0.099984049    4.9724696e-09  0              0.24010276    -1.5            0              2.9994977    
   1900000   6000           100            100            0.033327671   -1.5257431e-16  0              0.099983013    1.4404218e-09  0              0.069552815   -1.5            0              2.9994977    
   2000000   6000           100            100            0.033327741   -1.5257462e-16  0              0.099983222    4.0432703e-10  0              0.019523505   -1.5            0              2.9994977    
   2100000   6000           100            100            0.033327766   -1.5257474e-16  0              0.099983297    7.1946475e-13  0              3.4740378e-05 -1.5            0              2.9994977    
   2200000   6000           100            100            0.033327749   -1.5257466e-16  0              0.099983248    5.6376556e-12  0              0.00027222221 -1.5            0              2.9994977    
   2300000   6000           100            100            0.033327751   -1.5257467e-16  0              0.099983253    6.2804376e-13  0              3.0325986e-05 -1.5            0              2.9994977    
   2400000   6000           100            100            0.033327753   -1.5257468e-16  0              0.099983258    6.3846229e-15  0              3.0829059e-07 -1.5            0              2.9994977    
   2500000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    1.5886682e-14  0              7.67111e-07   -1.5            0              2.9994977    
   2600000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    6.4897352e-16  0              3.1336609e-08 -1.5            0              2.9994977    
   2700000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    2.4875531e-16  0              1.2011504e-08 -1.5            0              2.9994977    
   2800000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    4.9972171e-18  0              2.4129773e-10 -1.5            0              2.9994977    
   2900000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    1.8811505e-18  0              9.0834027e-11 -1.5            0              2.9994977    
   3000000   6000           100            100            0.033327752   -1.5257467e-16  0              0.099983256    1.1957498e-17  0              5.773848e-10  -1.5            0              2.9994977    
Loop time of 424.228 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6109922.851 ns/day, 0.000 hours/ns, 7071.670 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.02     | 169.98     | 171.72     |  13.4 | 40.07
Neigh   | 0.97348    | 0.97717    | 0.98071    |   0.4 |  0.23
Comm    | 24.834     | 26.895     | 28.923     |  36.3 |  6.34
Output  | 0.32577    | 0.32581    | 0.32587    |   0.0 |  0.08
Modify  | 201.34     | 201.75     | 202.27     |   2.4 | 47.56
Other   |            | 24.3       |            |       |  5.73

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027764071    1.083236e-20   0              0.083292212    1212931.5      0              5.8568121e+13 -1.5            0              3.310199     
    200000   6000           100            100            0.011215937    3.3570919e-21  0              0.033647811    363003.25      0              1.7528128e+13 -1.5            0              3.042105     
    300000   6000           100            100            0.0035815085   1.3828332e-21  0              0.010744526    60289.289      0              2.911154e+12  -1.5            0              3.0264       
    400000   6000           100            100           -0.0015021884  -2.9907277e-22  0             -0.0045065653   22032.555      0              1.0638732e+12 -1.5            0              3.0019618    
    500000   6000           100            100            0.11815587    -5.4368493e-16  0              0.35446761     4384.2597      0              2.1170021e+11 -1.5            0              2.9988644    
    600000   6000           100            100            8.3330846e-06 -1.8522262e-21  0              2.4999254e-05  0.58499472     0              28247301      -1.5            0              3.0002346    
    700000   6000           100            100            0.014865131   -6.8513745e-17  0              0.044595392    27.124905      0              1.3097646e+09 -1.5            0              2.9997128    
    800000   6000           100            100            0.038470801   -1.7630957e-16  0              0.1154124      11.332302      0              5.4719631e+08 -1.5            0              2.9994596    
    900000   6000           100            100            0.036242397   -1.6588984e-16  0              0.10872719     0.010370376    0              500748.33     -1.5            0              2.9994811    
   1000000   6000           100            100            0.034186792   -1.5646472e-16  0              0.10256037     0.10621481     0              5128733.1     -1.5            0              2.9995009    
   1100000   6000           100            100            0.03344066    -1.5306428e-16  0              0.10032198     0.038183077    0              1843724.1     -1.5            0              2.9995082    
   1200000   6000           100            100            0.033280998   -1.5234367e-16  0              0.099842994    0.0047912312   0              231351.41     -1.5            0              2.9995098    
   1300000   6000           100            100            0.033286374   -1.5237217e-16  0              0.099859122    0.00020012816  0              9663.4726     -1.5            0              2.9995097    
   1400000   6000           100            100            0.033310243   -1.5248233e-16  0              0.099930729    8.5516548e-07  0              41.29288      -1.5            0              2.9995095    
   1500000   6000           100            100            0.0333232     -1.5254165e-16  0              0.099969599    5.6241517e-06  0              271.57016     -1.5            0              2.9995093    
   1600000   6000           100            100            0.033327501   -1.5256123e-16  0              0.099982503    1.5272717e-06  0              73.746483     -1.5            0              2.9995093    
   1700000   6000           100            100            0.033328273   -1.525647e-16   0              0.09998482     1.5831673e-07  0              7.6445481     -1.5            0              2.9995093    
   1800000   6000           100            100            0.033328155   -1.5256413e-16  0              0.099984465    4.4352275e-09  0              0.21416126    -1.5            0              2.9995093    
   1900000   6000           100            100            0.033327987   -1.5256336e-16  0              0.09998396     1.8860741e-10  0              0.0091071769  -1.5            0              2.9995093    
   2000000   6000           100            100            0.033327906   -1.5256299e-16  0              0.099983717    2.7312035e-10  0              0.013188004   -1.5            0              2.9995093    
   2100000   6000           100            100            0.033327881   -1.5256288e-16  0              0.099983644    5.8710775e-11  0              0.0028349332  -1.5            0              2.9995093    
   2200000   6000           100            100            0.033327878   -1.5256286e-16  0              0.099983634    4.9724745e-12  0              0.000240103   -1.5            0              2.9995093    
   2300000   6000           100            100            0.033327879   -1.5256287e-16  0              0.099983638    7.6557984e-14  0              3.696711e-06  -1.5            0              2.9995093    
   2400000   6000           100            100            0.03332788    -1.5256287e-16  0              0.099983641    1.7624658e-14  0              8.5103167e-07 -1.5            0              2.9995093    
   2500000   6000           100            100            0.033327881   -1.5256287e-16  0              0.099983643    1.2354725e-14  0              5.9656544e-07 -1.5            0              2.9995093    
   2600000   6000           100            100            0.033327881   -1.5256287e-16  0              0.099983643    2.1479755e-15  0              1.0371805e-07 -1.5            0              2.9995093    
   2700000   6000           100            100            0.033327881   -1.5256287e-16  0              0.099983643    6.6635265e-18  0              3.2175785e-10 -1.5            0              2.9995093    
   2800000   6000           100            100            0.033327881   -1.5256287e-16  0              0.099983643    7.3608103e-18  0              3.5542718e-10 -1.5            0              2.9995093    
   2900000   6000           100            100            0.033327881   -1.5256287e-16  0              0.099983643    5.3713831e-20  0              2.5936486e-12 -1.5            0              2.9995093    
   3000000   6000           100            100            0.033327881   -1.5256288e-16  0              0.099983643    2.5987607e-18  0              1.2548485e-10 -1.5            0              2.9995093    
Loop time of 422.567 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6133941.082 ns/day, 0.000 hours/ns, 7099.469 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.07     | 168.43     | 169.28     |   3.8 | 39.86
Neigh   | 0.99862    | 1.0033     | 1.0078     |   0.4 |  0.24
Comm    | 25.002     | 25.796     | 26.284     |   9.9 |  6.10
Output  | 0.3284     | 0.32844    | 0.32851    |   0.0 |  0.08
Modify  | 202.25     | 202.59     | 202.98     |   2.0 | 47.94
Other   |            | 24.42      |            |       |  5.78

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027770337    1.1591787e-20  0              0.083311012    1213341.5      0              5.858792e+13  -1.5            0              3.310036     
    200000   6000           100            100            0.011229403    3.7587102e-21  0              0.033688208    363677.79      0              1.7560699e+13 -1.5            0              3.0418087    
    300000   6000           100            100            0.0036035155   1.8619987e-21  0              0.010810546    60921.853      0              2.9416983e+12 -1.5            0              3.0261314    
    400000   6000           100            100           -0.0014746752   1.9174387e-22  0             -0.0044240256   21072.708      0              1.0175257e+12 -1.5            0              3.0024619    
    500000   6000           100            100            0.18538574    -8.4457246e-16  0              0.55615722     1679.9687      0              8.1119678e+10 -1.5            0              2.9984964    
    600000   6000           100            100            0.00024735427 -1.7452039e-21  0              0.0007420628   428.08222      0              2.0670558e+10 -1.5            0              3.000035     
    700000   6000           100            100            0.057103179   -2.6107115e-16  0              0.17130954     3.0947151      0              1.4943272e+08 -1.5            0              2.9993129    
    800000   6000           100            100            0.030855433   -1.4135099e-16  0              0.0925663      17.431527      0              8.4170604e+08 -1.5            0              2.9995438    
    900000   6000           100            100            0.032999963   -1.5073709e-16  0              0.09899989     2.468437       0              1.1919199e+08 -1.5            0              2.9995236    
   1000000   6000           100            100            0.033696323   -1.5406928e-16  0              0.10108897     0.28626688     0              13822803      -1.5            0              2.9995167    
   1100000   6000           100            100            0.033112968   -1.5135391e-16  0              0.099338904    0.029003308    0              1400465.9     -1.5            0              2.9995223    
   1200000   6000           100            100            0.033430201   -1.528189e-16   0              0.1002906      0.0025095568   0              121177.52     -1.5            0              2.9995193    
   1300000   6000           100            100            0.033284265   -1.5214773e-16  0              0.099852795    0.00016788615  0              8106.6211     -1.5            0              2.9995207    
   1400000   6000           100            100            0.0333454     -1.524281e-16   0              0.1000362      6.6255061e-06  0              319.92198     -1.5            0              2.9995201    
   1500000   6000           100            100            0.033321488   -1.5231868e-16  0              0.099964465    1.4079215e-08  0              0.67983489    -1.5            0              2.9995203    
   1600000   6000           100            100            0.03333031    -1.5235897e-16  0              0.099990931    6.3529139e-08  0              3.0675948     -1.5            0              2.9995202    
   1700000   6000           100            100            0.033327232   -1.5234494e-16  0              0.099981695    3.7027702e-08  0              1.7879352     -1.5            0              2.9995203    
   1800000   6000           100            100            0.033328244   -1.5234954e-16  0              0.099984731    1.0457642e-08  0              0.50496211    -1.5            0              2.9995203    
   1900000   6000           100            100            0.033327934   -1.5234814e-16  0              0.099983803    2.183405e-09   0              0.10542882    -1.5            0              2.9995203    
   2000000   6000           100            100            0.03332802    -1.5234852e-16  0              0.099984059    3.7955559e-10  0              0.018327381   -1.5            0              2.9995203    
   2100000   6000           100            100            0.033328      -1.5234844e-16  0              0.099984       5.7628541e-11  0              0.002782676   -1.5            0              2.9995203    
   2200000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984008    7.7908663e-12  0              0.00037619305 -1.5            0              2.9995203    
   2300000   6000           100            100            0.033328003   -1.5234845e-16  0              0.09998401     9.422102e-13   0              4.5495959e-05 -1.5            0              2.9995203    
   2400000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984008    1.0144293e-13  0              4.898316e-06  -1.5            0              2.9995203    
   2500000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984009    9.4495295e-15  0              4.5628396e-07 -1.5            0              2.9995203    
   2600000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984008    5.9560624e-16  0              2.8759694e-08 -1.5            0              2.9995203    
   2700000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984009    3.1242208e-17  0              1.5085744e-09 -1.5            0              2.9995203    
   2800000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984009    3.4860038e-17  0              1.6832665e-09 -1.5            0              2.9995203    
   2900000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984009    1.3224456e-17  0              6.3856166e-10 -1.5            0              2.9995203    
   3000000   6000           100            100            0.033328003   -1.5234845e-16  0              0.099984009    9.3829742e-20  0              4.5307025e-12 -1.5            0              2.9995203    
Loop time of 423.18 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6125058.880 ns/day, 0.000 hours/ns, 7089.189 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.43     | 169.08     | 171.32     |  10.9 | 39.95
Neigh   | 1.0042     | 1.0095     | 1.0144     |   0.5 |  0.24
Comm    | 25.328     | 26.839     | 28.803     |  27.4 |  6.34
Output  | 0.32867    | 0.32872    | 0.3288     |   0.0 |  0.08
Modify  | 200.63     | 201.6      | 202.98     |   6.0 | 47.64
Other   |            | 24.32      |            |       |  5.75

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.02777632     1.098557e-20   0              0.08332896     1213733.2      0              5.8606832e+13 -1.5            0              3.3098795    
    200000   6000           100            100            0.011242257    3.5696221e-21  0              0.033726772    364322.09      0              1.759181e+13  -1.5            0              3.0415255    
    300000   6000           100            100            0.0036245197   1.5029266e-21  0              0.010873559    61527.809      0              2.9709577e+12 -1.5            0              3.0258735    
    400000   6000           100            100           -0.0014482366  -2.441395e-22   0             -0.0043447099   20178.516      0              9.7434831e+11 -1.5            0              3.0029293    
    500000   6000           100            100            0.21892338    -1.0000079e-15  0              0.65677014     34.18115       0              1.6504854e+09 -1.5            0              2.9983537    
    600000   6000           100            100            0.035834089   -1.6282001e-16  0              0.10750227     1078.2201      0              5.2063389e+10 -1.5            0              2.9995111    
    700000   6000           100            100            0.015509263   -7.0440934e-17  0              0.046527789    43.449801      0              2.0980354e+09 -1.5            0              2.9997191    
    800000   6000           100            100            0.02623828    -1.2005452e-16  0              0.078714841    4.5773001      0              2.2102144e+08 -1.5            0              2.9995996    
    900000   6000           100            100            0.030812259   -1.4085695e-16  0              0.092436778    0.72764996     0              35135613      -1.5            0              2.9995545    
   1000000   6000           100            100            0.032369923   -1.4793017e-16  0              0.097109768    0.070913701    0              3424168.8     -1.5            0              2.9995396    
   1100000   6000           100            100            0.032964656   -1.5063293e-16  0              0.098893967    0.0058508742   0              282517.78     -1.5            0              2.999534     
   1200000   6000           100            100            0.033192022   -1.5166729e-16  0              0.099576067    0.00039966491  0              19298.388     -1.5            0              2.9995319    
   1300000   6000           100            100            0.033277806   -1.52058e-16    0              0.099833419    1.9068506e-05  0              920.74991     -1.5            0              2.9995311    
   1400000   6000           100            100            0.033309744   -1.5220359e-16  0              0.099929231    2.7854082e-07  0              13.449739     -1.5            0              2.9995308    
   1500000   6000           100            100            0.033321486   -1.5225717e-16  0              0.099964459    3.6260201e-08  0              1.7508753     -1.5            0              2.9995307    
   1600000   6000           100            100            0.033325753   -1.5227666e-16  0              0.099977258    4.2229469e-08  0              2.0391099     -1.5            0              2.9995307    
   1700000   6000           100            100            0.033327284   -1.5228366e-16  0              0.099981853    1.5054499e-08  0              0.7269279     -1.5            0              2.9995306    
   1800000   6000           100            100            0.033327828   -1.5228615e-16  0              0.099983484    3.7565761e-09  0              0.18139162    -1.5            0              2.9995306    
   1900000   6000           100            100            0.033328019   -1.5228702e-16  0              0.099984056    7.8437316e-10  0              0.037874573   -1.5            0              2.9995306    
   2000000   6000           100            100            0.033328084   -1.5228732e-16  0              0.099984253    1.467822e-10   0              0.0070875871  -1.5            0              2.9995306    
   2100000   6000           100            100            0.033328107   -1.5228743e-16  0              0.099984321    2.5475565e-11  0              0.0012301238  -1.5            0              2.9995306    
   2200000   6000           100            100            0.033328114   -1.5228746e-16  0              0.099984343    4.1767587e-12  0              0.00020168073 -1.5            0              2.9995306    
   2300000   6000           100            100            0.033328117   -1.5228747e-16  0              0.099984351    6.5416069e-13  0              3.1587079e-05 -1.5            0              2.9995306    
   2400000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984353    9.8358537e-14  0              4.7493817e-06 -1.5            0              2.9995306    
   2500000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    1.4370879e-14  0              6.9391832e-07 -1.5            0              2.9995306    
   2600000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    1.9706733e-15  0              9.5156759e-08 -1.5            0              2.9995306    
   2700000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    1.0374091e-16  0              5.0092773e-09 -1.5            0              2.9995306    
   2800000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    3.9569571e-18  0              1.910673e-10  -1.5            0              2.9995306    
   2900000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    1.0478984e-17  0              5.0599265e-10 -1.5            0              2.9995306    
   3000000   6000           100            100            0.033328118   -1.5228748e-16  0              0.099984354    6.1669296e-18  0              2.9777896e-10 -1.5            0              2.9995306    
Loop time of 421.689 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6146711.313 ns/day, 0.000 hours/ns, 7114.249 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.29     | 167.74     | 168.12     |   2.8 | 39.78
Neigh   | 0.98462    | 0.98938    | 0.9944     |   0.4 |  0.23
Comm    | 25.608     | 25.927     | 26.175     |   4.2 |  6.15
Output  | 0.32861    | 0.32866    | 0.32872    |   0.0 |  0.08
Modify  | 201.96     | 202.31     | 202.69     |   1.8 | 47.98
Other   |            | 24.4       |            |       |  5.79

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027782035    1.1301131e-20  0              0.083346104    1214107.2      0              5.8624889e+13 -1.5            0              3.3097309    
    200000   6000           100            100            0.01125455     3.415589e-21   0              0.033763649    364938.57      0              1.7621577e+13 -1.5            0              3.0412542    
    300000   6000           100            100            0.0036446472   1.4320569e-21  0              0.010933941    62110.494      0              2.9990935e+12 -1.5            0              3.025625     
    400000   6000           100            100           -0.0014227646   3.2619431e-22  0             -0.0042682939   19342.432      0              9.3397684e+11 -1.5            0              3.0033675    
    500000   6000           100            100            0.20496463    -9.4109712e-16  0              0.61489388     913.20759      0              4.4095526e+10 -1.5            0              2.9984553    
    600000   6000           100            100            0.098853726   -4.5165283e-16  0              0.29656118     184.79036      0              8.9228652e+09 -1.5            0              2.9990523    
    700000   6000           100            100            0.04556607    -2.0902018e-16  0              0.13669821     111.40898      0              5.3795408e+09 -1.5            0              2.9994329    
    800000   6000           100            100            0.025142954   -1.1493555e-16  0              0.075428863    0.035374772    0              1708121.1     -1.5            0              2.9996192    
    900000   6000           100            100            0.036304389   -1.6596641e-16  0              0.10891317     0.16652423     0              8040859.1     -1.5            0              2.9995135    
   1000000   6000           100            100            0.032428945   -1.482099e-16   0              0.097286835    0.10937395     0              5281276.6     -1.5            0              2.9995488    
   1100000   6000           100            100            0.033547063   -1.533538e-16   0              0.10064119     0.030342622    0              1465136.6     -1.5            0              2.9995384    
   1200000   6000           100            100            0.033298707   -1.5220138e-16  0              0.099896122    0.0054455612   0              262946.66     -1.5            0              2.9995407    
   1300000   6000           100            100            0.033319424   -1.5230331e-16  0              0.099958272    0.0007217922   0              34852.762     -1.5            0              2.9995405    
   1400000   6000           100            100            0.033337975   -1.523855e-16   0              0.10001392     7.0870984e-05  0              3422.1062     -1.5            0              2.9995404    
   1500000   6000           100            100            0.033322828   -1.5231708e-16  0              0.099968485    4.6204934e-06  0              223.10709     -1.5            0              2.9995405    
   1600000   6000           100            100            0.033330582   -1.5235231e-16  0              0.099991746    1.1954687e-07  0              5.7724906     -1.5            0              2.9995404    
   1700000   6000           100            100            0.03332735    -1.5233757e-16  0              0.099982051    2.3158941e-09  0              0.11182624    -1.5            0              2.9995405    
   1800000   6000           100            100            0.033328509   -1.5234288e-16  0              0.099985528    5.9909522e-09  0              0.28928164    -1.5            0              2.9995405    
   1900000   6000           100            100            0.033328152   -1.5234124e-16  0              0.099984457    2.0885771e-09  0              0.10084991    -1.5            0              2.9995405    
   2000000   6000           100            100            0.033328241   -1.5234165e-16  0              0.099984723    4.2430421e-10  0              0.020488132   -1.5            0              2.9995405    
   2100000   6000           100            100            0.033328228   -1.5234159e-16  0              0.099984684    6.1976797e-11  0              0.0029926377  -1.5            0              2.9995405    
   2200000   6000           100            100            0.033328225   -1.5234157e-16  0              0.099984675    6.7567106e-12  0              0.00032625738 -1.5            0              2.9995405    
   2300000   6000           100            100            0.033328229   -1.5234159e-16  0              0.099984686    5.1747214e-13  0              2.4986878e-05 -1.5            0              2.9995405    
   2400000   6000           100            100            0.033328227   -1.5234158e-16  0              0.09998468     2.0835518e-14  0              1.0060726e-06 -1.5            0              2.9995405    
   2500000   6000           100            100            0.033328228   -1.5234158e-16  0              0.099984683    1.6450768e-17  0              7.9434871e-10 -1.5            0              2.9995405    
   2600000   6000           100            100            0.033328227   -1.5234158e-16  0              0.099984682    2.1776158e-16  0              1.0514927e-08 -1.5            0              2.9995405    
   2700000   6000           100            100            0.033328227   -1.5234158e-16  0              0.099984682    3.687481e-18   0              1.7805526e-10 -1.5            0              2.9995405    
   2800000   6000           100            100            0.033328227   -1.5234158e-16  0              0.099984682    1.9495913e-17  0              9.4138788e-10 -1.5            0              2.9995405    
   2900000   6000           100            100            0.033328227   -1.5234158e-16  0              0.099984682    1.1633004e-17  0              5.6171612e-10 -1.5            0              2.9995405    
   3000000   6000           100            100            0.033328227   -1.5234158e-16  0              0.099984682    1.3698691e-18  0              6.6146075e-11 -1.5            0              2.9995405    
Loop time of 422.346 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6137146.401 ns/day, 0.000 hours/ns, 7103.179 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.65     | 167.85     | 168.93     |   7.9 | 39.74
Neigh   | 1.0097     | 1.012      | 1.0142     |   0.2 |  0.24
Comm    | 25.263     | 26.351     | 27.679     |  21.0 |  6.24
Output  | 0.32609    | 0.32611    | 0.32616    |   0.0 |  0.08
Modify  | 202        | 202.35     | 202.68     |   1.7 | 47.91
Other   |            | 24.46      |            |       |  5.79

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027787507    1.1394909e-20  0              0.08336252     1214465.5      0              5.8642192e+13 -1.5            0              3.3095877    
    200000   6000           100            100            0.011266328    3.4677046e-21  0              0.033798984    365529.59      0              1.7650116e+13 -1.5            0              3.0409939    
    300000   6000           100            100            0.0036639229   1.5067959e-21  0              0.010991769    62670.368      0              3.0261278e+12 -1.5            0              3.0253858    
    400000   6000           100            100           -0.0013982359   5.4897233e-23  0             -0.0041947078   18560.299      0              8.9621041e+11 -1.5            0              3.0037787    
    500000   6000           100            100            0.15165634    -7.0006971e-16  0              0.45496903     3419.7056      0              1.6512535e+11 -1.5            0              2.9987599    
    600000   6000           100            100            0.08751693    -4.0319367e-16  0              0.26255079     467.74874      0              2.2585913e+10 -1.5            0              2.9991414    
    700000   6000           100            100            0.023540993   -1.0675625e-16  0              0.070622979    123.70071      0              5.9730647e+09 -1.5            0              2.9996443    
    800000   6000           100            100            0.025661294   -1.1711061e-16  0              0.076983883    3.0595168      0              1.4773311e+08 -1.5            0              2.999622     
    900000   6000           100            100            0.031211521   -1.4250068e-16  0              0.093634562    1.3625942      0              65794797      -1.5            0              2.9995692    
   1000000   6000           100            100            0.033104565   -1.5118979e-16  0              0.099313695    0.32515356     0              15700502      -1.5            0              2.9995519    
   1100000   6000           100            100            0.033476064   -1.529135e-16   0              0.10042819     0.038439271    0              1856094.8     -1.5            0              2.9995485    
   1200000   6000           100            100            0.033447206   -1.5279266e-16  0              0.10034162     0.0019719119   0              95216.568     -1.5            0              2.9995487    
   1300000   6000           100            100            0.033381064   -1.5249373e-16  0              0.10014319     1.7842879e-06  0              86.156876     -1.5            0              2.9995493    
   1400000   6000           100            100            0.033344781   -1.5232848e-16  0              0.10003434     2.4817228e-05  0              1198.3351     -1.5            0              2.9995496    
   1500000   6000           100            100            0.033331422   -1.5226734e-16  0              0.099994266    1.0196552e-05  0              492.355       -1.5            0              2.9995498    
   1600000   6000           100            100            0.033328059   -1.5225184e-16  0              0.099984176    1.6521644e-06  0              79.777105     -1.5            0              2.9995498    
   1700000   6000           100            100            0.033327763   -1.5225042e-16  0              0.099983288    1.3135942e-07  0              6.3428762     -1.5            0              2.9995498    
   1800000   6000           100            100            0.033328022   -1.5225158e-16  0              0.099984066    2.7016071e-09  0              0.13045094    -1.5            0              2.9995498    
   1900000   6000           100            100            0.033328218   -1.5225247e-16  0              0.099984654    2.4896392e-10  0              0.012021577   -1.5            0              2.9995498    
   2000000   6000           100            100            0.033328303   -1.5225286e-16  0              0.099984908    2.6712154e-10  0              0.012898343   -1.5            0              2.9995498    
   2100000   6000           100            100            0.033328329   -1.5225298e-16  0              0.099984986    6.1581914e-11  0              0.0029735702  -1.5            0              2.9995498    
   2200000   6000           100            100            0.033328333   -1.52253e-16    0              0.099985       6.8845646e-12  0              0.00033243098 -1.5            0              2.9995498    
   2300000   6000           100            100            0.033328333   -1.52253e-16    0              0.099984998    3.2173467e-13  0              1.5535416e-05 -1.5            0              2.9995498    
   2400000   6000           100            100            0.033328332   -1.5225299e-16  0              0.099984995    2.9127312e-18  0              1.4064537e-10 -1.5            0              2.9995498    
   2500000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984994    5.0530154e-15  0              2.4399203e-07 -1.5            0              2.9995498    
   2600000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984993    1.9437602e-15  0              9.3857224e-08 -1.5            0              2.9995498    
   2700000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984993    2.8400042e-16  0              1.3713364e-08 -1.5            0              2.9995498    
   2800000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984993    7.4410775e-19  0              3.59303e-11   -1.5            0              2.9995498    
   2900000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984993    1.4712556e-17  0              7.1041667e-10 -1.5            0              2.9995498    
   3000000   6000           100            100            0.033328331   -1.5225299e-16  0              0.099984993    4.5348331e-18  0              2.1897086e-10 -1.5            0              2.9995498    
Loop time of 420.842 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6159084.968 ns/day, 0.000 hours/ns, 7128.571 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.1      | 167.56     | 167.81     |   2.2 | 39.81
Neigh   | 0.97882    | 0.98303    | 0.98781    |   0.4 |  0.23
Comm    | 25.404     | 25.745     | 26.136     |   5.1 |  6.12
Output  | 0.32731    | 0.32735    | 0.32742    |   0.0 |  0.08
Modify  | 201.88     | 202.01     | 202.19     |   0.8 | 48.00
Other   |            | 24.21      |            |       |  5.75

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027792751    1.1634868e-20  0              0.083378252    1214808.9      0              5.8658773e+13 -1.5            0              3.3094506    
    200000   6000           100            100            0.01127762     3.3664583e-21  0              0.03383286     366096.51      0              1.767749e+13  -1.5            0              3.0407439    
    300000   6000           100            100            0.0036824347   9.2300707e-22  0              0.011047304    63209.756      0              3.0521729e+12 -1.5            0              3.0251549    
    400000   6000           100            100           -0.0013745569  -2.9493383e-22  0             -0.0041236706   17826.149      0              8.6076093e+11 -1.5            0              3.0041658    
    500000   6000           100            100            0.082340653   -3.8872208e-16  0              0.24702196     5500.8295      0              2.6561537e+11 -1.5            0              2.999188     
    600000   6000           100            100            0.023372145   -1.1071512e-16  0              0.070116434    1077.8895      0              5.2047428e+10 -1.5            0              2.9996479    
    700000   6000           100            100            0.037418695   -1.7191515e-16  0              0.11225608     149.18196      0              7.2034632e+09 -1.5            0              2.999522     
    800000   6000           100            100            0.026263833   -1.1989004e-16  0              0.0787915      6.1659696      0              2.9773261e+08 -1.5            0              2.9996238    
    900000   6000           100            100            0.034643174   -1.5845436e-16  0              0.10392952     2.1707502      0              1.0481776e+08 -1.5            0              2.999547     
   1000000   6000           100            100            0.033601695   -1.5354778e-16  0              0.10080508     0.32408713     0              15649008      -1.5            0              2.9995563    
   1100000   6000           100            100            0.032994117   -1.5082271e-16  0              0.09898235     0.01526114     0              736905.82     -1.5            0              2.9995616    
   1200000   6000           100            100            0.033476518   -1.5301782e-16  0              0.10042955     3.9914129e-05  0              1927.3105     -1.5            0              2.9995574    
   1300000   6000           100            100            0.033290762   -1.5216743e-16  0              0.099872287    0.00038468596  0              18575.108     -1.5            0              2.999559     
   1400000   6000           100            100            0.033329803   -1.5234791e-16  0              0.099989409    9.9026353e-05  0              4781.6282     -1.5            0              2.9995587    
   1500000   6000           100            100            0.03333259    -1.523597e-16   0              0.09999777     8.4464962e-06  0              407.85107     -1.5            0              2.9995586    
   1600000   6000           100            100            0.033325965   -1.5232967e-16  0              0.099977895    8.866436e-08   0              4.2812846     -1.5            0              2.9995587    
   1700000   6000           100            100            0.03332924    -1.5234463e-16  0              0.099987721    4.6524954e-08  0              2.2465235     -1.5            0              2.9995587    
   1800000   6000           100            100            0.033328306   -1.5234033e-16  0              0.099984917    2.4755103e-08  0              1.1953353     -1.5            0              2.9995587    
   1900000   6000           100            100            0.033328392   -1.5234074e-16  0              0.099985175    3.3961283e-09  0              0.16398688    -1.5            0              2.9995587    
   2000000   6000           100            100            0.033328467   -1.5234108e-16  0              0.0999854      1.3176377e-10  0              0.0063624011  -1.5            0              2.9995587    
   2100000   6000           100            100            0.033328414   -1.5234084e-16  0              0.099985243    1.6910536e-12  0              8.1654925e-05 -1.5            0              2.9995587    
   2200000   6000           100            100            0.033328433   -1.5234093e-16  0              0.0999853      4.8990336e-12  0              0.0002365568  -1.5            0              2.9995587    
   2300000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    1.0914796e-12  0              5.2703643e-05 -1.5            0              2.9995587    
   2400000   6000           100            100            0.033328429   -1.5234091e-16  0              0.099985287    8.0447618e-14  0              3.8845275e-06 -1.5            0              2.9995587    
   2500000   6000           100            100            0.03332843    -1.5234091e-16  0              0.09998529     4.0220571e-16  0              1.9421074e-08 -1.5            0              2.9995587    
   2600000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    6.0094015e-16  0              2.9017249e-08 -1.5            0              2.9995587    
   2700000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    1.5900939e-16  0              7.6779942e-09 -1.5            0              2.9995587    
   2800000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    3.6758718e-17  0              1.774947e-09  -1.5            0              2.9995587    
   2900000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    2.3341072e-19  0              1.1270568e-11 -1.5            0              2.9995587    
   3000000   6000           100            100            0.03332843    -1.5234091e-16  0              0.099985289    2.0127652e-18  0              9.7189229e-11 -1.5            0              2.9995587    
Loop time of 425.158 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6096558.512 ns/day, 0.000 hours/ns, 7056.202 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.12     | 169.76     | 173.11     |  19.2 | 39.93
Neigh   | 0.97956    | 0.98311    | 0.98669    |   0.3 |  0.23
Comm    | 24.549     | 27.556     | 30.284     |  50.6 |  6.48
Output  | 0.32777    | 0.3278     | 0.32787    |   0.0 |  0.08
Modify  | 201.63     | 202.12     | 202.91     |   3.4 | 47.54
Other   |            | 24.41      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027797783    1.165692e-20   0              0.08339335     1215138.5      0              5.867469e+13  -1.5            0              3.3093187    
    200000   6000           100            100            0.011288455    3.9396005e-21  0              0.033865364    366640.72      0              1.7703768e+13 -1.5            0              3.0405039    
    300000   6000           100            100            0.0037002074   1.6961122e-21  0              0.011100622    63729.163      0              3.0772532e+12 -1.5            0              3.0249321    
    400000   6000           100            100           -0.0013517033   2.5982249e-24  0             -0.0040551098   17136.616      0              8.2746587e+11 -1.5            0              3.0045304    
    500000   6000           100            100            0.02294113    -1.1230923e-16  0              0.068823391    6008.9247      0              2.9014947e+11 -1.5            0              2.9996542    
    600000   6000           100            100           -0.00023272155 -1.5751828e-21  0             -0.00069816465  404.76943      0              1.9544867e+10 -1.5            0              3.0000927    
    700000   6000           100            100            0.025735795   -1.1672823e-16  0              0.077207386    139.20881      0              6.7218954e+09 -1.5            0              2.999637     
    800000   6000           100            100            0.026228572   -1.1964955e-16  0              0.078685716    6.5190499      0              3.1478159e+08 -1.5            0              2.9996313    
    900000   6000           100            100            0.032171364   -1.4686536e-16  0              0.096514093    2.3054205      0              1.1132051e+08 -1.5            0              2.9995774    
   1000000   6000           100            100            0.033764171   -1.542111e-16   0              0.10129251     0.29904518     0              14439821      -1.5            0              2.9995634    
   1100000   6000           100            100            0.033712178   -1.5400741e-16  0              0.10113653     0.0073126534   0              353101.86     -1.5            0              2.9995638    
   1200000   6000           100            100            0.033469584   -1.5290763e-16  0              0.10040875     0.00074398831  0              35924.533     -1.5            0              2.9995659    
   1300000   6000           100            100            0.033351278   -1.5236714e-16  0              0.10005383     0.00063671048  0              30744.471     -1.5            0              2.9995669    
   1400000   6000           100            100            0.033321864   -1.5223166e-16  0              0.099965591    8.9581764e-05  0              4325.5828     -1.5            0              2.9995672    
   1500000   6000           100            100            0.033322115   -1.5223223e-16  0              0.099966346    2.5336195e-06  0              122.33942     -1.5            0              2.9995672    
   1600000   6000           100            100            0.033326085   -1.5225022e-16  0              0.099978255    1.7136272e-07  0              8.2744924     -1.5            0              2.9995671    
   1700000   6000           100            100            0.033328101   -1.5225943e-16  0              0.099984304    1.7763336e-07  0              8.5772792     -1.5            0              2.9995671    
   1800000   6000           100            100            0.033328624   -1.5226183e-16  0              0.099985872    2.6734347e-08  0              1.2909059     -1.5            0              2.9995671    
   1900000   6000           100            100            0.03332863    -1.5226187e-16  0              0.099985891    8.6304029e-10  0              0.041673127   -1.5            0              2.9995671    
   2000000   6000           100            100            0.033328566   -1.5226158e-16  0              0.099985697    3.8209716e-11  0              0.0018450104  -1.5            0              2.9995671    
   2100000   6000           100            100            0.033328531   -1.5226142e-16  0              0.099985594    4.9359079e-11  0              0.0023833733  -1.5            0              2.9995671    
   2200000   6000           100            100            0.033328522   -1.5226138e-16  0              0.099985566    7.946099e-12   0              0.00038368868 -1.5            0              2.9995671    
   2300000   6000           100            100            0.033328522   -1.5226138e-16  0              0.099985565    2.9033232e-13  0              1.4019109e-05 -1.5            0              2.9995671    
   2400000   6000           100            100            0.033328523   -1.5226138e-16  0              0.099985568    7.9506692e-15  0              3.8390936e-07 -1.5            0              2.9995671    
   2500000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     1.3634855e-14  0              6.5837834e-07 -1.5            0              2.9995671    
   2600000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     2.3990823e-15  0              1.158431e-07  -1.5            0              2.9995671    
   2700000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     2.6632973e-16  0              1.2860109e-08 -1.5            0              2.9995671    
   2800000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     2.3425586e-17  0              1.1311377e-09 -1.5            0              2.9995671    
   2900000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     8.509037e-18   0              4.1087094e-10 -1.5            0              2.9995671    
   3000000   6000           100            100            0.033328523   -1.5226138e-16  0              0.09998557     1.9571557e-20  0              9.4504045e-13 -1.5            0              2.9995671    
Loop time of 421.506 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6149372.711 ns/day, 0.000 hours/ns, 7117.330 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.39     | 168.29     | 169.25     |   5.9 | 39.92
Neigh   | 0.97885    | 0.98209    | 0.98581    |   0.3 |  0.23
Comm    | 24.844     | 25.816     | 26.844     |  16.2 |  6.12
Output  | 0.32758    | 0.32764    | 0.32774    |   0.0 |  0.08
Modify  | 201.82     | 201.9      | 202.02     |   0.5 | 47.90
Other   |            | 24.19      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027802619    1.1114183e-20  0              0.083407856    1215455.3      0              5.8689989e+13 -1.5            0              3.3091917    
    200000   6000           100            100            0.011298892    3.5328522e-21  0              0.033896675    367165.25      0              1.7729096e+13 -1.5            0              3.040272     
    300000   6000           100            100            0.0037173332   1.4658456e-21  0              0.011151999    64231.108      0              3.1014903e+12 -1.5            0              3.0247164    
    400000   6000           100            100           -0.0013295903   2.7867033e-22  0             -0.0039887708   16486.839      0              7.9609045e+11 -1.5            0              3.0048749    
    500000   6000           100            100           -0.00080045846 -8.1707705e-22  0             -0.0024013754   5338.9204      0              2.5779736e+11 -1.5            0              3.0000964    
    600000   6000           100            100           -5.9074922e-05 -1.5815616e-21  0             -0.00017722477  24.908551      0              1.2027448e+09 -1.5            0              3.0002935    
    700000   6000           100            100            0.039727238   -1.8281034e-16  0              0.11918171     146.69445      0              7.08335e+09   -1.5            0              2.9995212    
    800000   6000           100            100            0.025504881   -1.167561e-16   0              0.076514642    4.0110608      0              1.9367977e+08 -1.5            0              2.9996448    
    900000   6000           100            100            0.034894261   -1.5993092e-16  0              0.10468278     2.066322       0              99775296      -1.5            0              2.9995618    
   1000000   6000           100            100            0.033612767   -1.5392476e-16  0              0.1008383      0.33149048     0              16006489      -1.5            0              2.9995728    
   1100000   6000           100            100            0.032965715   -1.5101746e-16  0              0.098897144    0.012365094    0              597066.15     -1.5            0              2.9995782    
   1200000   6000           100            100            0.033477653   -1.5335084e-16  0              0.10043296     0.00032765137  0              15821.112     -1.5            0              2.9995739    
   1300000   6000           100            100            0.033299682   -1.525342e-16   0              0.099899047    0.000567256    0              27390.762     -1.5            0              2.9995754    
   1400000   6000           100            100            0.033323981   -1.5264775e-16  0              0.099971942    9.6895783e-05  0              4678.7506     -1.5            0              2.9995752    
   1500000   6000           100            100            0.033334763   -1.5269618e-16  0              0.10000429     3.7394733e-06  0              180.56578     -1.5            0              2.9995751    
   1600000   6000           100            100            0.033326066   -1.5265654e-16  0              0.099978198    8.6760556e-08  0              4.1893568     -1.5            0              2.9995752    
   1700000   6000           100            100            0.033329115   -1.5267053e-16  0              0.099987345    1.6277776e-07  0              7.8599557     -1.5            0              2.9995752    
   1800000   6000           100            100            0.033328688   -1.5266854e-16  0              0.099986065    2.8317567e-08  0              1.3673539     -1.5            0              2.9995752    
   1900000   6000           100            100            0.033328509   -1.5266773e-16  0              0.099985526    1.1253132e-09  0              0.054337349   -1.5            0              2.9995752    
   2000000   6000           100            100            0.033328656   -1.526684e-16   0              0.099985969    2.2899438e-11  0              0.0011057319  -1.5            0              2.9995752    
   2100000   6000           100            100            0.033328604   -1.5266816e-16  0              0.099985813    4.6716329e-11  0              0.0022557643  -1.5            0              2.9995752    
   2200000   6000           100            100            0.033328612   -1.526682e-16   0              0.099985835    8.274844e-12   0              0.0003995626  -1.5            0              2.9995752    
   2300000   6000           100            100            0.033328615   -1.5266821e-16  0              0.099985844    3.3822194e-13  0              1.6331527e-05 -1.5            0              2.9995752    
   2400000   6000           100            100            0.033328612   -1.526682e-16   0              0.099985837    6.0163695e-15  0              2.9050895e-07 -1.5            0              2.9995752    
   2500000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    1.3550701e-14  0              6.5431484e-07 -1.5            0              2.9995752    
   2600000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    2.4168248e-15  0              1.1669982e-07 -1.5            0              2.9995752    
   2700000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    2.104097e-16   0              1.0159931e-08 -1.5            0              2.9995752    
   2800000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    1.5122189e-17  0              7.301964e-10  -1.5            0              2.9995752    
   2900000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    8.1103487e-19  0              3.9161971e-11 -1.5            0              2.9995752    
   3000000   6000           100            100            0.033328613   -1.526682e-16   0              0.099985839    1.0479557e-18  0              5.0602029e-11 -1.5            0              2.9995752    
Loop time of 425.728 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6088391.875 ns/day, 0.000 hours/ns, 7046.750 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.38     | 169.74     | 174.19     |  25.5 | 39.87
Neigh   | 0.99268    | 0.99639    | 0.99969    |   0.3 |  0.23
Comm    | 24.568     | 28.436     | 31.988     |  66.4 |  6.68
Output  | 0.32538    | 0.32542    | 0.32548    |   0.0 |  0.08
Modify  | 201.31     | 201.99     | 203.21     |   5.1 | 47.45
Other   |            | 24.23      |            |       |  5.69

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027807271    1.1456783e-20  0              0.083421812    1215760.3      0              5.8704712e+13 -1.5            0              3.3090693    
    200000   6000           100            100            0.01130894     3.962919e-21   0              0.033926819    367670.48      0              1.7753492e+13 -1.5            0              3.0400485    
    300000   6000           100            100            0.0037338427   1.5572477e-21  0              0.011201528    64716.328      0              3.1249199e+12 -1.5            0              3.0245075    
    400000   6000           100            100           -0.0013081918   2.3189002e-22  0             -0.0039245755   15874.03       0              7.6650009e+11 -1.5            0              3.0052006    
    500000   6000           100            100           -0.00074455131 -6.308887e-22   0             -0.0022336539   4566.2265      0              2.2048674e+11 -1.5            0              3.0004925    
    600000   6000           100            100            0.00011063679 -1.4890895e-21  0              0.00033191036  88.034258      0              4.2508593e+09 -1.5            0              3.0002731    
    700000   6000           100            100            0.019777098   -8.9871052e-17  0              0.059331295    106.76836      0              5.1554622e+09 -1.5            0              2.9997067    
    800000   6000           100            100            0.024622383   -1.1270556e-16  0              0.073867149    0.54468143     0              26300717      -1.5            0              2.9996592    
    900000   6000           100            100            0.030814967   -1.4098577e-16  0              0.092444902    1.1035129      0              53284691      -1.5            0              2.9996042    
   1000000   6000           100            100            0.033129257   -1.5159612e-16  0              0.09938777     0.34520686     0              16668804      -1.5            0              2.9995846    
   1100000   6000           100            100            0.033558881   -1.5358934e-16  0              0.10067664     0.033321838    0              1608992.3     -1.5            0              2.999581     
   1200000   6000           100            100            0.033478609   -1.5323438e-16  0              0.10043583     0.00045474841  0              21958.173     -1.5            0              2.9995816    
   1300000   6000           100            100            0.03337916    -1.5278238e-16  0              0.10013748     0.00015323087  0              7398.9702     -1.5            0              2.9995824    
   1400000   6000           100            100            0.033336243   -1.5258603e-16  0              0.10000873     8.9058634e-05  0              4300.3227     -1.5            0              2.9995828    
   1500000   6000           100            100            0.033326163   -1.5253952e-16  0              0.099978488    1.1939244e-05  0              576.50335     -1.5            0              2.9995829    
   1600000   6000           100            100            0.03332635    -1.5254017e-16  0              0.09997905     3.8991305e-07  0              18.827506     -1.5            0              2.9995829    
   1700000   6000           100            100            0.033327767   -1.525466e-16   0              0.099983302    1.3397423e-08  0              0.6469136     -1.5            0              2.9995829    
   1800000   6000           100            100            0.033328505   -1.5254996e-16  0              0.099985514    2.0673285e-08  0              0.99823892    -1.5            0              2.9995829    
   1900000   6000           100            100            0.033328716   -1.5255093e-16  0              0.099986148    3.8635075e-09  0              0.18655495    -1.5            0              2.9995829    
   2000000   6000           100            100            0.033328733   -1.5255102e-16  0              0.099986199    2.1394436e-10  0              0.010330607   -1.5            0              2.9995829    
   2100000   6000           100            100            0.033328715   -1.5255093e-16  0              0.099986144    6.6959745e-14  0              3.2332464e-06 -1.5            0              2.9995829    
   2200000   6000           100            100            0.033328703   -1.5255088e-16  0              0.099986108    4.2063947e-12  0              0.00020311175 -1.5            0              2.9995829    
   2300000   6000           100            100            0.033328699   -1.5255086e-16  0              0.099986096    1.1393884e-12  0              5.5016989e-05 -1.5            0              2.9995829    
   2400000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986094    9.4737277e-14  0              4.574524e-06  -1.5            0              2.9995829    
   2500000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986094    6.9059354e-16  0              3.334629e-08  -1.5            0              2.9995829    
   2600000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986095    7.5684918e-16  0              3.6545538e-08 -1.5            0              2.9995829    
   2700000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986095    2.086643e-16   0              1.0075652e-08 -1.5            0              2.9995829    
   2800000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986095    4.0778858e-17  0              1.9690651e-09 -1.5            0              2.9995829    
   2900000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986095    4.0802742e-21  0              1.9702184e-13 -1.5            0              2.9995829    
   3000000   6000           100            100            0.033328698   -1.5255086e-16  0              0.099986095    5.92872e-18    0              2.8627667e-10 -1.5            0              2.9995829    
Loop time of 433.307 on 4 procs for 3000000 steps with 4000 atoms

Performance: 5981905.452 ns/day, 0.000 hours/ns, 6923.502 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.45     | 173.95     | 179.87     |  41.6 | 40.15
Neigh   | 0.95782    | 0.95937    | 0.96101    |   0.2 |  0.22
Comm    | 25.049     | 30.704     | 36.386     | 102.1 |  7.09
Output  | 0.3259     | 0.32595    | 0.32602    |   0.0 |  0.08
Modify  | 202.77     | 203.06     | 203.82     |   3.1 | 46.86
Other   |            | 24.3       |            |       |  5.61

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027811749    1.1307915e-20  0              0.083435246    1216053.7      0              5.8718883e+13 -1.5            0              3.3089515    
    200000   6000           100            100            0.01131861     2.8633389e-21  0              0.033955831    368156.92      0              1.777698e+13  -1.5            0              3.0398332    
    300000   6000           100            100            0.0037497308   9.2844338e-22  0              0.011249192    65184.515      0              3.1475269e+12 -1.5            0              3.0243057    
    400000   6000           100            100           -0.0012875073  -2.5543711e-22  0             -0.0038625219   15296.305      0              7.3860382e+11 -1.5            0              3.0055086    
    500000   6000           100            100           -0.00069028701 -6.7358272e-22  0             -0.002070861    3881.9607      0              1.8744599e+11 -1.5            0              3.0008453    
    600000   6000           100            100            0.00027639081 -1.5027305e-21  0              0.00082917242  531.83372      0              2.5680347e+10 -1.5            0              3.0000607    
    700000   6000           100            100            0.051673937   -2.3703567e-16  0              0.15502181     84.964643      0              4.1026385e+09 -1.5            0              2.9994503    
    800000   6000           100            100            0.024701056   -1.1317032e-16  0              0.074103169    1.5458851      0              74645261      -1.5            0              2.9996643    
    900000   6000           100            100            0.036676983   -1.6782619e-16  0              0.11003095     0.049526429    0              2391454       -1.5            0              2.9995632    
   1000000   6000           100            100            0.032433228   -1.4838827e-16  0              0.097299685    0.15990752     0              7721361.9     -1.5            0              2.9995976    
   1100000   6000           100            100            0.03341998    -1.5294243e-16  0              0.10025994     0.044867673    0              2166499.4     -1.5            0              2.9995894    
   1200000   6000           100            100            0.033392396   -1.5279548e-16  0              0.10017719     0.0051558358   0              248956.86     -1.5            0              2.9995897    
   1300000   6000           100            100            0.03327949    -1.5228589e-16  0              0.099838471    0.00020626189  0              9959.6483     -1.5            0              2.9995906    
   1400000   6000           100            100            0.033349323   -1.5260401e-16  0              0.10004797     9.4309243e-07  0              45.538558     -1.5            0              2.99959      
   1500000   6000           100            100            0.033323195   -1.5248437e-16  0              0.099969585    5.9803221e-06  0              288.76835     -1.5            0              2.9995903    
   1600000   6000           100            100            0.033329366   -1.5251284e-16  0              0.099988097    1.7027074e-06  0              82.217647     -1.5            0              2.9995902    
   1700000   6000           100            100            0.033329167   -1.525118e-16   0              0.099987501    1.9749272e-07  0              9.5362167     -1.5            0              2.9995902    
   1800000   6000           100            100            0.033328477   -1.5250869e-16  0              0.099985431    8.0415571e-09  0              0.38829801    -1.5            0              2.9995902    
   1900000   6000           100            100            0.033328907   -1.5251065e-16  0              0.099986721    3.1011237e-11  0              0.0014974216  -1.5            0              2.9995902    
   2000000   6000           100            100            0.033328745   -1.5250991e-16  0              0.099986236    2.2431621e-10  0              0.010831427   -1.5            0              2.9995902    
   2100000   6000           100            100            0.033328784   -1.5251009e-16  0              0.099986351    6.4632568e-11  0              0.0031208754  -1.5            0              2.9995902    
   2200000   6000           100            100            0.033328782   -1.5251008e-16  0              0.099986347    7.5594467e-12  0              0.00036501863 -1.5            0              2.9995902    
   2300000   6000           100            100            0.033328778   -1.5251006e-16  0              0.099986335    3.1330831e-13  0              1.5128537e-05 -1.5            0              2.9995902    
   2400000   6000           100            100            0.033328781   -1.5251007e-16  0              0.099986343    8.7013737e-16  0              4.201582e-08  -1.5            0              2.9995902    
   2500000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     8.5036082e-15  0              4.1060881e-07 -1.5            0              2.9995902    
   2600000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     2.5692721e-15  0              1.2406095e-07 -1.5            0              2.9995902    
   2700000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     3.1878585e-16  0              1.5393028e-08 -1.5            0              2.9995902    
   2800000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     4.0014296e-17  0              1.9321472e-09 -1.5            0              2.9995902    
   2900000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     2.9870112e-21  0              1.4423208e-13 -1.5            0              2.9995902    
   3000000   6000           100            100            0.03332878    -1.5251007e-16  0              0.09998634     5.2527898e-18  0              2.5363842e-10 -1.5            0              2.9995902    
Loop time of 425.856 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6086568.672 ns/day, 0.000 hours/ns, 7044.640 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.16     | 169.92     | 172.74     |  20.1 | 39.90
Neigh   | 0.97951    | 0.98346    | 0.9874     |   0.4 |  0.23
Comm    | 25.101     | 27.918     | 30.731     |  49.9 |  6.56
Output  | 0.32444    | 0.32448    | 0.32454    |   0.0 |  0.08
Modify  | 201.98     | 202.21     | 202.5      |   1.6 | 47.48
Other   |            | 24.5       |            |       |  5.75

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027816064    1.1101708e-20  0              0.083448191    1216336.6      0              5.8732539e+13 -1.5            0              3.3088381    
    200000   6000           100            100            0.011327918    3.4327645e-21  0              0.033983755    368625.3       0              1.7799597e+13 -1.5            0              3.0396259    
    300000   6000           100            100            0.0037650414   1.704732e-21   0              0.011295124    65636.824      0              3.1693673e+12 -1.5            0              3.0241105    
    400000   6000           100            100           -0.0012674766   4.509721e-23   0             -0.0038024297   14750.304      0              7.1223937e+11 -1.5            0              3.0058005    
    500000   6000           100            100           -0.00063759625 -7.4870156e-22  0             -0.0019127888   3277.3211      0              1.5825011e+11 -1.5            0              3.0011591    
    600000   6000           100            100            0.023025424   -1.0517653e-16  0              0.069076271    1119.5138      0              5.4057314e+10 -1.5            0              2.999689     
    700000   6000           100            100            0.011473955   -5.2282217e-17  0              0.034421866    19.100044      0              9.2227278e+08 -1.5            0              2.9998028    
    800000   6000           100            100            0.027258524   -1.2498428e-16  0              0.081775571    12.007437      0              5.7979616e+08 -1.5            0              2.9996474    
    900000   6000           100            100            0.030585209   -1.400054e-16   0              0.091755628    0.93254869     0              45029439      -1.5            0              2.9996196    
   1000000   6000           100            100            0.032127781   -1.4699119e-16  0              0.096383342    0.012087838    0              583678.43     -1.5            0              2.999607     
   1100000   6000           100            100            0.032903933   -1.5052509e-16  0              0.0987118      0.0036360668   0              175572.65     -1.5            0              2.9996007    
   1200000   6000           100            100            0.033211833   -1.5193245e-16  0              0.0996355      0.0028753932   0              138842.45     -1.5            0              2.9995982    
   1300000   6000           100            100            0.033308972   -1.5237829e-16  0              0.099926915    0.00071414768  0              34483.636     -1.5            0              2.9995974    
   1400000   6000           100            100            0.033331331   -1.5248168e-16  0              0.099993994    0.0001046394   0              5052.6619     -1.5            0              2.9995972    
   1500000   6000           100            100            0.033333053   -1.5249007e-16  0              0.099999158    9.6453267e-06  0              465.73831     -1.5            0              2.9995972    
   1600000   6000           100            100            0.033331241   -1.5248197e-16  0              0.099993722    4.4408698e-07  0              21.443371     -1.5            0              2.9995972    
   1700000   6000           100            100            0.033329847   -1.5247565e-16  0              0.099989541    5.7376348e-10  0              0.027704985   -1.5            0              2.9995972    
   1800000   6000           100            100            0.033329185   -1.5247263e-16  0              0.099987554    5.134179e-09   0              0.24791113    -1.5            0              2.9995972    
   1900000   6000           100            100            0.03332894    -1.5247151e-16  0              0.099986819    2.4358279e-09  0              0.11761741    -1.5            0              2.9995972    
   2000000   6000           100            100            0.033328868   -1.5247118e-16  0              0.099986604    5.0502867e-10  0              0.024386027   -1.5            0              2.9995972    
   2100000   6000           100            100            0.033328854   -1.5247111e-16  0              0.099986562    6.4732175e-11  0              0.0031256851  -1.5            0              2.9995972    
   2200000   6000           100            100            0.033328854   -1.5247111e-16  0              0.099986563    5.0851255e-12  0              0.00024554251 -1.5            0              2.9995972    
   2300000   6000           100            100            0.033328856   -1.5247112e-16  0              0.099986569    1.6081412e-13  0              7.7651384e-06 -1.5            0              2.9995972    
   2400000   6000           100            100            0.033328857   -1.5247113e-16  0              0.099986572    1.2470169e-15  0              6.0213982e-08 -1.5            0              2.9995972    
   2500000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986574    5.5668296e-15  0              2.6880228e-07 -1.5            0              2.9995972    
   2600000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986575    2.0473627e-15  0              9.8859819e-08 -1.5            0              2.9995972    
   2700000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986575    3.2393419e-16  0              1.5641623e-08 -1.5            0              2.9995972    
   2800000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986575    4.0100722e-17  0              1.9363204e-09 -1.5            0              2.9995972    
   2900000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986575    1.3492502e-20  0              6.5150465e-13 -1.5            0              2.9995972    
   3000000   6000           100            100            0.033328858   -1.5247113e-16  0              0.099986575    8.2253603e-18  0              3.9717321e-10 -1.5            0              2.9995972    
Loop time of 428.324 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6051493.409 ns/day, 0.000 hours/ns, 7004.043 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 165.94     | 171.16     | 176.59     |  37.7 | 39.96
Neigh   | 0.99599    | 0.99854    | 1.0012     |   0.2 |  0.23
Comm    | 24.652     | 29.781     | 35.156     |  93.0 |  6.95
Output  | 0.32762    | 0.32767    | 0.32773    |   0.0 |  0.08
Modify  | 201.58     | 201.93     | 202.6      |   2.8 | 47.14
Other   |            | 24.13      |            |       |  5.63

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027820225    1.1805628e-20  0              0.083460676    1216609.3      0              5.8745708e+13 -1.5            0              3.3087289    
    200000   6000           100            100            0.011336905    2.9164762e-21  0              0.034010715    369077.73      0              1.7821443e+13 -1.5            0              3.0394255    
    300000   6000           100            100            0.0037798404   1.5742111e-21  0              0.011339521    66075.082      0              3.1905293e+12 -1.5            0              3.023921     
    400000   6000           100            100           -0.0012480434   3.1643541e-22  0             -0.0037441303   14233.029      0              6.8726202e+11 -1.5            0              3.0060777    
    500000   6000           100            100           -0.00058635038 -6.5120753e-22  0             -0.0017590511   2743.8913      0              1.3249269e+11 -1.5            0              3.0014378    
    600000   6000           100            100            0.080124793   -3.676378e-16   0              0.24037438     737.11125      0              3.5592464e+10 -1.5            0              2.9992912    
    700000   6000           100            100            0.061425005   -2.805516e-16   0              0.18427502     0.87772666     0              42382279      -1.5            0              2.9994048    
    800000   6000           100            100            0.033282996   -1.5243752e-16  0              0.099848989    21.454948      0              1.0359827e+09 -1.5            0              2.9996039    
    900000   6000           100            100            0.033313796   -1.5211061e-16  0              0.099941387    2.8072423      0              1.3555169e+08 -1.5            0              2.9996043    
   1000000   6000           100            100            0.033031963   -1.5099141e-16  0              0.099095888    0.34656992     0              16734621      -1.5            0              2.9996063    
   1100000   6000           100            100            0.03354142    -1.5326057e-16  0              0.10062426     0.037394388    0              1805641.2     -1.5            0              2.9996023    
   1200000   6000           100            100            0.033217836   -1.5180114e-16  0              0.099653509    0.0033575123   0              162122.25     -1.5            0              2.9996049    
   1300000   6000           100            100            0.033378772   -1.5253083e-16  0              0.10013632     0.00023238643  0              11221.109     -1.5            0              2.9996036    
   1400000   6000           100            100            0.033308629   -1.522118e-16   0              0.099925887    9.4433924e-06  0              455.98762     -1.5            0              2.9996041    
   1500000   6000           100            100            0.033336609   -1.5233936e-16  0              0.10000983     2.4043905e-08  0              1.1609941     -1.5            0              2.9996039    
   1600000   6000           100            100            0.033326223   -1.5229192e-16  0              0.09997867     8.610999e-08   0              4.1579433     -1.5            0              2.999604     
   1700000   6000           100            100            0.033329823   -1.523084e-16   0              0.09998947     5.0789082e-08  0              2.452423      -1.5            0              2.999604     
   1800000   6000           100            100            0.033328665   -1.5230308e-16  0              0.099985996    1.4194652e-08  0              0.68540897    -1.5            0              2.999604     
   1900000   6000           100            100            0.033329004   -1.5230464e-16  0              0.099987012    2.8946237e-09  0              0.13977102    -1.5            0              2.999604     
   2000000   6000           100            100            0.033328919   -1.5230425e-16  0              0.099986756    4.8511256e-10  0              0.023424349   -1.5            0              2.999604     
   2100000   6000           100            100            0.033328934   -1.5230432e-16  0              0.099986802    6.9875554e-11  0              0.0033740404  -1.5            0              2.999604     
   2200000   6000           100            100            0.033328934   -1.5230432e-16  0              0.099986803    8.7735883e-12  0              0.00042364518 -1.5            0              2.999604     
   2300000   6000           100            100            0.033328932   -1.5230431e-16  0              0.099986796    9.5778157e-13  0              4.6247844e-05 -1.5            0              2.999604     
   2400000   6000           100            100            0.033328934   -1.5230432e-16  0              0.099986801    8.8541046e-14  0              4.2753303e-06 -1.5            0              2.999604     
   2500000   6000           100            100            0.033328933   -1.5230431e-16  0              0.099986799    6.2908883e-15  0              3.0376448e-07 -1.5            0              2.999604     
   2600000   6000           100            100            0.033328933   -1.5230432e-16  0              0.0999868      1.8270851e-16  0              8.8223402e-09 -1.5            0              2.999604     
   2700000   6000           100            100            0.033328933   -1.5230431e-16  0              0.099986799    3.9795993e-17  0              1.9216061e-09 -1.5            0              2.999604     
   2800000   6000           100            100            0.033328933   -1.5230431e-16  0              0.099986799    8.8801878e-18  0              4.2879249e-10 -1.5            0              2.999604     
   2900000   6000           100            100            0.033328933   -1.5230431e-16  0              0.099986799    7.5132071e-18  0              3.6278588e-10 -1.5            0              2.999604     
   3000000   6000           100            100            0.033328933   -1.5230432e-16  0              0.099986799    9.8481051e-18  0              4.7552975e-10 -1.5            0              2.999604     
Loop time of 422.202 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6139238.520 ns/day, 0.000 hours/ns, 7105.600 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.17     | 168.57     | 170.48     |  10.2 | 39.93
Neigh   | 0.96196    | 0.96453    | 0.96713    |   0.3 |  0.23
Comm    | 24.623     | 26.162     | 27.683     |  27.1 |  6.20
Output  | 0.32489    | 0.32494    | 0.32501    |   0.0 |  0.08
Modify  | 201.46     | 201.96     | 202.83     |   3.7 | 47.84
Other   |            | 24.21      |            |       |  5.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027824248    1.0936971e-20  0              0.083472744    1216873.2      0              5.8758451e+13 -1.5            0              3.3086223    
    200000   6000           100            100            0.011345639    3.3504863e-21  0              0.034036917    369517.68      0              1.7842686e+13 -1.5            0              3.0392297    
    300000   6000           100            100            0.0037942331   1.3301489e-21  0              0.011382699    66502.32       0              3.211159e+12  -1.5            0              3.0237357    
    400000   6000           100            100           -0.0012291284   5.3843109e-23  0             -0.0036873853   13741.11       0              6.6350902e+11 -1.5            0              3.0063419    
    500000   6000           100            100           -0.0005364493  -6.0150453e-22  0             -0.0016093479   2274.5972      0              1.0983216e+11 -1.5            0              3.0016849    
    600000   6000           100            100            0.11554541    -5.2973033e-16  0              0.34663622     4.0052119      0              1.9339735e+08 -1.5            0              2.9991077    
    700000   6000           100            100            0.012621102   -5.8134503e-17  0              0.037863306    43.815422      0              2.1156899e+09 -1.5            0              2.9997953    
    800000   6000           100            100            0.040791891   -1.8658823e-16  0              0.12237567     9.1642084      0              4.4250682e+08 -1.5            0              2.999554     
    900000   6000           100            100            0.036473358   -1.6669128e-16  0              0.10942007     0.56307204     0              27188734      -1.5            0              2.9995862    
   1000000   6000           100            100            0.0344761     -1.5753221e-16  0              0.1034283      0.064636498    0              3121065.2     -1.5            0              2.9996015    
   1100000   6000           100            100            0.033743336   -1.5417337e-16  0              0.10123001     0.0083595454   0              403652.53     -1.5            0              2.9996072    
   1200000   6000           100            100            0.033478602   -1.529599e-16   0              0.10043581     0.0011009626   0              53161.546     -1.5            0              2.9996093    
   1300000   6000           100            100            0.033383031   -1.525218e-16   0              0.10014909     0.00014543655  0              7022.6104     -1.5            0              2.99961      
   1400000   6000           100            100            0.033348518   -1.5236359e-16  0              0.10004556     1.9223353e-05  0              928.22692     -1.5            0              2.9996103    
   1500000   6000           100            100            0.033336053   -1.5230645e-16  0              0.10000816     2.5411618e-06  0              122.70361     -1.5            0              2.9996104    
   1600000   6000           100            100            0.033331551   -1.5228581e-16  0              0.099994653    3.3591458e-07  0              16.220113     -1.5            0              2.9996104    
   1700000   6000           100            100            0.033329925   -1.5227836e-16  0              0.099989774    4.4401508e-08  0              2.1439899     -1.5            0              2.9996104    
   1800000   6000           100            100            0.033329337   -1.5227567e-16  0              0.099988011    5.8686389e-09  0              0.28337557    -1.5            0              2.9996104    
   1900000   6000           100            100            0.033329125   -1.5227469e-16  0              0.099987375    7.7555311e-10  0              0.037448684   -1.5            0              2.9996104    
   2000000   6000           100            100            0.033329048   -1.5227434e-16  0              0.099987145    1.0253246e-10  0              0.0049509256  -1.5            0              2.9996104    
   2100000   6000           100            100            0.033329021   -1.5227421e-16  0              0.099987062    1.355616e-11   0              0.00065457847 -1.5            0              2.9996104    
   2200000   6000           100            100            0.033329011   -1.5227417e-16  0              0.099987032    1.7862568e-12  0              8.6251948e-05 -1.5            0              2.9996104    
   2300000   6000           100            100            0.033329007   -1.5227415e-16  0              0.099987021    2.3547097e-13  0              1.137005e-05  -1.5            0              2.9996104    
   2400000   6000           100            100            0.033329006   -1.5227415e-16  0              0.099987017    3.141895e-14   0              1.5171087e-06 -1.5            0              2.9996104    
   2500000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987016    4.2613828e-15  0              2.0576692e-07 -1.5            0              2.9996104    
   2600000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987015    6.8856738e-16  0              3.3248454e-08 -1.5            0              2.9996104    
   2700000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987015    5.9820368e-17  0              2.8885115e-09 -1.5            0              2.9996104    
   2800000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987015    3.4474089e-18  0              1.6646304e-10 -1.5            0              2.9996104    
   2900000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987015    9.2509837e-18  0              4.466969e-10  -1.5            0              2.9996104    
   3000000   6000           100            100            0.033329005   -1.5227414e-16  0              0.099987015    1.6703141e-18  0              8.0653488e-11 -1.5            0              2.9996104    
Loop time of 430.44 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6021750.852 ns/day, 0.000 hours/ns, 6969.619 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.38     | 171.75     | 178.66     |  34.7 | 39.90
Neigh   | 0.98163    | 0.98441    | 0.98723    |   0.3 |  0.23
Comm    | 25.159     | 30.172     | 35.453     |  89.2 |  7.01
Output  | 0.32563    | 0.32568    | 0.32574    |   0.0 |  0.08
Modify  | 201.05     | 202.84     | 206.83     |  16.3 | 47.12
Other   |            | 24.36      |            |       |  5.66

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1000*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000 ${n1e1} -50 50 -50 50 units box
region box block -3000 3000 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000 3000 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2000 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  2000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2000 settings made for mass


group substrate region substrate           # Define gorup
2000 atoms in group substrate
group slider1 region slider1
2000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   6000           100            100            0.027828131    1.1117037e-20  0              0.083484392    1217127.6      0              5.8770738e+13 -1.5            0              3.3085205    
    200000   6000           100            100            0.01135401     3.8039005e-21  0              0.03406203     369939.37      0              1.7863048e+13 -1.5            0              3.039043     
    300000   6000           100            100            0.003808012    1.6058822e-21  0              0.011424036    66912.238      0              3.2309525e+12 -1.5            0              3.0235583    
    400000   6000           100            100           -0.0012108817   5.6647111e-23  0             -0.0036326452   13277.202      0              6.4110858e+11 -1.5            0              3.0065919    
    500000   6000           100            100           -0.00048804542 -4.9243364e-22  0             -0.0014641362   1865.2352      0              9.0065531e+10 -1.5            0              3.0019023    
    600000   6000           100            100            0.089572375   -4.1212264e-16  0              0.26871713     594.45963      0              2.8704328e+10 -1.5            0              2.9992574    
    700000   6000           100            100            0.040960376   -1.8620566e-16  0              0.12288113     153.62443      0              7.4179739e+09 -1.5            0              2.9995612    
    800000   6000           100            100            0.042930983   -1.9605488e-16  0              0.12879295     1.8721986      0              90401772      -1.5            0              2.9995463    
    900000   6000           100            100            0.030939797   -1.4148229e-16  0              0.09281939     1.5352858      0              74133455      -1.5            0              2.9996351    
   1000000   6000           100            100            0.033834096   -1.5456865e-16  0              0.10150229     0.31675424     0              15294929      -1.5            0              2.9996128    
   1100000   6000           100            100            0.033280126   -1.5209672e-16  0              0.099840377    0.048465937    0              2340246.7     -1.5            0              2.999617     
   1200000   6000           100            100            0.033296305   -1.5214832e-16  0              0.099888915    0.0061544082   0              297174.35     -1.5            0              2.9996169    
   1300000   6000           100            100            0.033357929   -1.5243757e-16  0              0.10007379     0.00064481827  0              31135.967     -1.5            0              2.9996164    
   1400000   6000           100            100            0.033313414   -1.522318e-16   0              0.099940242    5.2930272e-05  0              2555.8134     -1.5            0              2.9996168    
   1500000   6000           100            100            0.033336116   -1.5233617e-16  0              0.10000835     2.9048471e-06  0              140.26467     -1.5            0              2.9996166    
   1600000   6000           100            100            0.033326258   -1.52291e-16    0              0.099978775    5.0853941e-08  0              2.4555548     -1.5            0              2.9996167    
   1700000   6000           100            100            0.033330098   -1.5230855e-16  0              0.099990294    4.5129125e-09  0              0.21791239    -1.5            0              2.9996166    
   1800000   6000           100            100            0.033328735   -1.5230233e-16  0              0.099986205    5.7622139e-09  0              0.27823669    -1.5            0              2.9996167    
   1900000   6000           100            100            0.033329174   -1.5230433e-16  0              0.099987522    1.9053354e-09  0              0.092001826   -1.5            0              2.9996167    
   2000000   6000           100            100            0.033329049   -1.5230376e-16  0              0.099987147    4.0895204e-10  0              0.019746831   -1.5            0              2.9996167    
   2100000   6000           100            100            0.033329078   -1.5230389e-16  0              0.099987234    6.8208305e-11  0              0.0032935349  -1.5            0              2.9996167    
   2200000   6000           100            100            0.033329074   -1.5230388e-16  0              0.099987223    9.3657566e-12  0              0.00045223887 -1.5            0              2.9996167    
   2300000   6000           100            100            0.033329073   -1.5230387e-16  0              0.099987219    1.0646972e-12  0              5.1410419e-05 -1.5            0              2.9996167    
   2400000   6000           100            100            0.033329074   -1.5230388e-16  0              0.099987223    9.7959613e-14  0              4.7301191e-06 -1.5            0              2.9996167    
   2500000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987221    6.7334687e-15  0              3.251351e-07  -1.5            0              2.9996167    
   2600000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987222    2.8964505e-16  0              1.3985923e-08 -1.5            0              2.9996167    
   2700000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987222    9.8296822e-18  0              4.7464018e-10 -1.5            0              2.9996167    
   2800000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987222    3.4477514e-17  0              1.6647958e-09 -1.5            0              2.9996167    
   2900000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987222    9.1462286e-19  0              4.4163864e-11 -1.5            0              2.9996167    
   3000000   6000           100            100            0.033329074   -1.5230387e-16  0              0.099987222    1.4503357e-17  0              7.0031519e-10 -1.5            0              2.9996167    
Loop time of 426.215 on 4 procs for 3000000 steps with 4000 atoms

Performance: 6081432.844 ns/day, 0.000 hours/ns, 7038.695 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.79     | 170.39     | 173.1      |  21.1 | 39.98
Neigh   | 0.95996    | 0.96389    | 0.96773    |   0.3 |  0.23
Comm    | 24.753     | 27.545     | 31.19      |  53.8 |  6.46
Output  | 0.32938    | 0.32942    | 0.32949    |   0.0 |  0.08
Modify  | 202        | 202.7      | 203.93     |   5.4 | 47.56
Other   |            | 24.28      |            |       |  5.70

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 4:48:05

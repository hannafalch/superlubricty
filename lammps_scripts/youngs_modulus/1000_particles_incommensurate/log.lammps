LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.004 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018377269    2.9030295e-16  0              0.055131806    777245.31      0              3.7530394e+13  1.6929675e-13  0              3.3519811    
    200000   6000           100            100            0.0050312124   2.9030295e-16  0              0.015093637    125556.71      0              6.062684e+12   1.6929675e-13  0              3.1133307    
    300000   6000           100            100            0.0033672167   0.0033397099   0              0.0067619401   53680.218      0              2.5920256e+12  1.6929675e-13  0              2.9949022    
    400000   6000           100            100            0.069911631    0.041410761    0              0.16832413     3703.4565      0              1.7882666e+11  1.6929675e-13  0              2.9806158    
    500000   6000           100            100            0.034541091    0.018950284    0              0.08467299     1177.7465      0              5.6869165e+10  1.6929675e-13  0              2.986266     
    600000   6000           100            100            0.023787293    0.013494492    0              0.057867386    25.429348      0              1.2278922e+09  1.6929675e-13  0              2.9887366    
    700000   6000           100            100            0.029935564    0.014172131    0              0.075634562    0.1476061      0              7127370.1      1.6929675e-13  0              2.987101     
    800000   6000           100            100            0.027708514    0.0143041      0              0.068821443    0.75259653     0              36340193       1.6929675e-13  0              2.9876943    
    900000   6000           100            100            0.028399604    0.014337397    0              0.070861415    0.27510752     0              13283957       1.6929675e-13  0              2.9875164    
   1000000   6000           100            100            0.02823631     0.014303054    0              0.070405877    0.053478001    0              2582261.3      1.6929675e-13  0              2.9875548    
   1100000   6000           100            100            0.028245905    0.014301943    0              0.070435774    0.0069749996   0              336797.77      1.6929675e-13  0              2.987553     
   1200000   6000           100            100            0.028260115    0.014303526    0              0.070476818    0.0006031006   0              29121.569      1.6929675e-13  0              2.987549     
   1300000   6000           100            100            0.028249331    0.014302378    0              0.070445617    2.6507302e-05  0              1279.9427      1.6929675e-13  0              2.9875519    
   1400000   6000           100            100            0.028254592    0.014302929    0              0.070460847    1.9304233e-08  0              0.93213231     1.6929675e-13  0              2.9875505    
   1500000   6000           100            100            0.02825254     0.014302716    0              0.070454904    3.5408598e-07  0              17.097545      1.6929675e-13  0              2.987551     
   1600000   6000           100            100            0.0282532      0.014302784    0              0.070456815    1.7094492e-07  0              8.2543185      1.6929675e-13  0              2.9875509    
   1700000   6000           100            100            0.028253036    0.014302767    0              0.07045634     3.8009251e-08  0              1.8353307      1.6929675e-13  0              2.9875509    
   1800000   6000           100            100            0.028253056    0.014302769    0              0.0704564      5.5049489e-09  0              0.26581428     1.6929675e-13  0              2.9875509    
   1900000   6000           100            100            0.028253065    0.01430277     0              0.070456424    5.3896871e-10  0              0.02602487     1.6929675e-13  0              2.9875509    
   2000000   6000           100            100            0.028253056    0.014302769    0              0.0704564      3.0281591e-11  0              0.0014621897   1.6929675e-13  0              2.9875509    
   2100000   6000           100            100            0.028253061    0.01430277     0              0.070456413    3.0615847e-13  0              1.4783297e-05  1.6929675e-13  0              2.9875509    
   2200000   6000           100            100            0.028253059    0.014302769    0              0.070456408    1.3485706e-13  0              6.5117649e-06  1.6929675e-13  0              2.9875509    
   2300000   6000           100            100            0.02825306     0.014302769    0              0.070456409    1.0094821e-13  0              4.8744277e-06  1.6929675e-13  0              2.9875509    
   2400000   6000           100            100            0.028253059    0.014302769    0              0.070456409    2.6245812e-14  0              1.2673163e-06  1.6929675e-13  0              2.9875509    
   2500000   6000           100            100            0.028253059    0.014302769    0              0.070456409    4.213142e-15   0              2.0343755e-07  1.6929675e-13  0              2.9875509    
   2600000   6000           100            100            0.02825306     0.014302769    0              0.070456409    4.8499911e-16  0              2.3418871e-08  1.6929675e-13  0              2.9875509    
   2700000   6000           100            100            0.028253059    0.014302769    0              0.070456409    9.0119065e-18  0              4.3515271e-10  1.6929675e-13  0              2.9875509    
   2800000   6000           100            100            0.028253059    0.014302769    0              0.070456409    2.6804645e-18  0              1.2943004e-10  1.6929675e-13  0              2.9875509    
   2900000   6000           100            100            0.028253059    0.014302769    0              0.070456409    1.6243517e-18  0              7.8434131e-11  1.6929675e-13  0              2.9875509    
   3000000   6000           100            100            0.028253059    0.014302769    0              0.070456409    4.0632482e-18  0              1.9619971e-10  1.6929675e-13  0              2.9875509    
Loop time of 310.438 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8349495.106 ns/day, 0.000 hours/ns, 9663.767 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.648     | 59.189     | 78.217     | 239.2 | 19.07
Neigh   | 0.91455    | 0.92651    | 0.93902    |   0.9 |  0.30
Comm    | 23.269     | 41.656     | 60.21      | 278.7 | 13.42
Output  | 0.27117    | 0.27142    | 0.2717     |   0.0 |  0.09
Modify  | 145.02     | 166.21     | 188.02     | 157.7 | 53.54
Other   |            | 42.19      |            |       | 13.59

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018526002    2.9030295e-16  0              0.055578006    786593.65      0              3.7981792e+13  1.6929675e-13  0              3.3473472    
    200000   6000           100            100            0.0053573988   2.9030295e-16  0              0.016072196    138789.13      0              6.7016302e+12  1.6929675e-13  0              3.1070811    
    300000   6000           100            100           -0.0014040339   2.9030295e-16  0             -0.0042121018   30956.656      0              1.4947861e+12  1.6929675e-13  0              3.0129701    
    400000   6000           100            100           -0.00017971826  0.0001871962   0             -0.00072635097  1513.7969      0              7.3095834e+10  1.6929675e-13  0              2.9992059    
    500000   6000           100            100            0.028474416    0.015771385    0              0.069651862    1465.7832      0              7.0777427e+10  1.6929675e-13  0              2.9892028    
    600000   6000           100            100            0.022916515    0.013169482    0              0.055580063    9.054435       0              4.3720626e+08  1.6929675e-13  0              2.9904262    
    700000   6000           100            100            0.028420485    0.015058146    0              0.070203308    25.396726      0              1.226317e+09   1.6929675e-13  0              2.9892568    
    800000   6000           100            100            0.029114002    0.014775828    0              0.072566177    0.10690368     0              5161996.3      1.6929675e-13  0              2.9890644    
    900000   6000           100            100            0.028264289    0.014621183    0              0.070171685    0.37684907     0              18196693       1.6929675e-13  0              2.9892462    
   1000000   6000           100            100            0.028297426    0.014614059    0              0.070278218    0.023322159    0              1126143.6      1.6929675e-13  0              2.9892397    
   1100000   6000           100            100            0.028399713    0.014621018    0              0.07057812     0.0029933179   0              144536.61      1.6929675e-13  0              2.9892165    
   1200000   6000           100            100            0.028376034    0.014617952    0              0.07051015     0.00091592474  0              44226.728      1.6929675e-13  0              2.9892215    
   1300000   6000           100            100            0.028366291    0.014616615    0              0.070482259    3.5134843e-06  0              169.65358      1.6929675e-13  0              2.9892237    
   1400000   6000           100            100            0.028371208    0.014617262    0              0.070496361    1.9219838e-05  0              928.05719      1.6929675e-13  0              2.9892227    
   1500000   6000           100            100            0.028371627    0.014617324    0              0.070497556    2.8887272e-07  0              13.94863       1.6929675e-13  0              2.9892226    
   1600000   6000           100            100            0.028370894    0.014617227    0              0.070495455    2.3975442e-07  0              11.576883      1.6929675e-13  0              2.9892227    
   1700000   6000           100            100            0.02837097     0.014617236    0              0.070495673    2.556829e-08   0              1.2346012      1.6929675e-13  0              2.9892227    
   1800000   6000           100            100            0.028371054    0.014617247    0              0.070495915    1.3494066e-09  0              0.065158016    1.6929675e-13  0              2.9892227    
   1900000   6000           100            100            0.028371029    0.014617244    0              0.070495843    7.8326146e-10  0              0.037820893    1.6929675e-13  0              2.9892227    
   2000000   6000           100            100            0.028371022    0.014617243    0              0.070495823    1.4149682e-14  0              6.8323748e-07  1.6929675e-13  0              2.9892227    
   2100000   6000           100            100            0.028371027    0.014617244    0              0.070495836    1.384656e-11   0              0.00066860085  1.6929675e-13  0              2.9892227    
   2200000   6000           100            100            0.028371027    0.014617244    0              0.070495837    4.6889079e-13  0              2.2641058e-05  1.6929675e-13  0              2.9892227    
   2300000   6000           100            100            0.028371026    0.014617244    0              0.070495835    1.399145e-13   0              6.7559705e-06  1.6929675e-13  0              2.9892227    
   2400000   6000           100            100            0.028371026    0.014617244    0              0.070495835    2.527698e-14   0              1.2205349e-06  1.6929675e-13  0              2.9892227    
   2500000   6000           100            100            0.028371026    0.014617244    0              0.070495835    4.5566408e-16  0              2.2002388e-08  1.6929675e-13  0              2.9892227    
   2600000   6000           100            100            0.028371026    0.014617244    0              0.070495835    6.3075553e-16  0              3.0456927e-08  1.6929675e-13  0              2.9892227    
   2700000   6000           100            100            0.028371026    0.014617244    0              0.070495835    1.3979798e-18  0              6.7503441e-11  1.6929675e-13  0              2.9892227    
   2800000   6000           100            100            0.028371026    0.014617244    0              0.070495835    1.3233916e-17  0              6.3901844e-10  1.6929675e-13  0              2.9892227    
   2900000   6000           100            100            0.028371026    0.014617244    0              0.070495835    7.4747708e-18  0              3.6092993e-10  1.6929675e-13  0              2.9892227    
   3000000   6000           100            100            0.028371026    0.014617244    0              0.070495835    2.7944402e-18  0              1.3493352e-10  1.6929675e-13  0              2.9892227    
Loop time of 305.185 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8493207.030 ns/day, 0.000 hours/ns, 9830.101 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.931     | 59.413     | 77.845     | 229.9 | 19.47
Neigh   | 0.91568    | 0.92699    | 0.93859    |   0.9 |  0.30
Comm    | 23.027     | 40.962     | 58.294     | 270.1 | 13.42
Output  | 0.27253    | 0.27275    | 0.27302    |   0.0 |  0.09
Modify  | 138.94     | 161.11     | 183.04     | 162.2 | 52.79
Other   |            | 42.5       |            |       | 13.93

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:          485.5 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018631592    2.9030295e-16  0              0.055894775    793258.31      0              3.8303605e+13  1.6929675e-13  0              3.3439973    
    200000   6000           100            100            0.0055910327   2.9030295e-16  0              0.016773098    148523.31      0              7.171659e+12   1.6929675e-13  0              3.1023029    
    300000   6000           100            100           -0.0011567183   2.9030295e-16  0             -0.0034701549   18747.036      0              9.0522727e+11  1.6929675e-13  0              3.0232202    
    400000   6000           100            100            0.0007679594   1.6538194e-05  0              0.00228734     3414.5281      0              1.6487534e+11  1.6929675e-13  0              2.999234     
    500000   6000           100            100            0.047103569    0.021248786    0              0.12006192     142.30723      0              6.8715069e+09  1.6929675e-13  0              2.9873942    
    600000   6000           100            100            0.034869862    0.016499253    0              0.088110334    8.7115774      0              4.206509e+08   1.6929675e-13  0              2.9892296    
    700000   6000           100            100            0.030369737    0.014466653    0              0.076642556    2.2783078      0              1.1001133e+08  1.6929675e-13  0              2.9899553    
    800000   6000           100            100            0.029195628    0.014869585    0              0.072717299    0.36734453     0              17737753       1.6929675e-13  0              2.9902148    
    900000   6000           100            100            0.028760604    0.014967137    0              0.071314676    0.057976606    0              2799482.8      1.6929675e-13  0              2.9903092    
   1000000   6000           100            100            0.028593462    0.014971651    0              0.070808734    0.0091556604   0              442094.08      1.6929675e-13  0              2.9903434    
   1100000   6000           100            100            0.028530118    0.014964371    0              0.070625984    0.0014244294   0              68780.6        1.6929675e-13  0              2.9903558    
   1200000   6000           100            100            0.02850726     0.014961812    0              0.070559967    0.0002189451   0              10572.075      1.6929675e-13  0              2.9903603    
   1300000   6000           100            100            0.028499013    0.014960898    0              0.07053614     3.3295927e-05  0              1607.7411      1.6929675e-13  0              2.9903619    
   1400000   6000           100            100            0.02849604     0.01496057     0              0.07052755     5.0156526e-06  0              242.18791      1.6929675e-13  0              2.9903625    
   1500000   6000           100            100            0.02849497     0.014960452    0              0.070524457    7.4918268e-07  0              36.17535       1.6929675e-13  0              2.9903627    
   1600000   6000           100            100            0.028494585    0.01496041     0              0.070523345    1.1105768e-07  0              5.3625778      1.6929675e-13  0              2.9903627    
   1700000   6000           100            100            0.028494447    0.014960395    0              0.070522945    1.6350424e-08  0              0.78950345     1.6929675e-13  0              2.9903628    
   1800000   6000           100            100            0.028494397    0.014960389    0              0.070522802    2.3921702e-09  0              0.11550934     1.6929675e-13  0              2.9903628    
   1900000   6000           100            100            0.028494379    0.014960387    0              0.070522751    3.4800158e-10  0              0.016803751    1.6929675e-13  0              2.9903628    
   2000000   6000           100            100            0.028494373    0.014960386    0              0.070522732    5.0356363e-11  0              0.0024315285   1.6929675e-13  0              2.9903628    
   2100000   6000           100            100            0.028494371    0.014960386    0              0.070522726    7.2520771e-12  0              0.00035017685  1.6929675e-13  0              2.9903628    
   2200000   6000           100            100            0.02849437     0.014960386    0              0.070522723    1.0383663e-12  0              5.0138993e-05  1.6929675e-13  0              2.9903628    
   2300000   6000           100            100            0.02849437     0.014960386    0              0.070522723    1.4818051e-13  0              7.1551064e-06  1.6929675e-13  0              2.9903628    
   2400000   6000           100            100            0.028494369    0.014960386    0              0.070522722    2.104281e-14   0              1.016082e-06   1.6929675e-13  0              2.9903628    
   2500000   6000           100            100            0.028494369    0.014960386    0              0.070522722    2.9813622e-15  0              1.4395931e-07  1.6929675e-13  0              2.9903628    
   2600000   6000           100            100            0.028494369    0.014960386    0              0.070522722    4.442419e-16   0              2.1450852e-08  1.6929675e-13  0              2.9903628    
   2700000   6000           100            100            0.028494369    0.014960386    0              0.070522722    3.9343236e-17  0              1.8997441e-09  1.6929675e-13  0              2.9903628    
   2800000   6000           100            100            0.028494369    0.014960386    0              0.070522722    5.3911702e-18  0              2.6032031e-10  1.6929675e-13  0              2.9903628    
   2900000   6000           100            100            0.028494369    0.014960386    0              0.070522722    9.7998657e-19  0              4.7320044e-11  1.6929675e-13  0              2.9903628    
   3000000   6000           100            100            0.028494369    0.014960386    0              0.070522722    3.1160322e-18  0              1.5046204e-10  1.6929675e-13  0              2.9903628    
Loop time of 303.638 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8536492.150 ns/day, 0.000 hours/ns, 9880.199 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.999     | 57.079     | 75.576     | 223.5 | 18.80
Neigh   | 0.91846    | 0.92728    | 0.93781    |   0.7 |  0.31
Comm    | 22.909     | 40.311     | 60.439     | 257.9 | 13.28
Output  | 0.27163    | 0.27184    | 0.27214    |   0.0 |  0.09
Modify  | 141.6      | 162.8      | 183.93     | 155.6 | 53.62
Other   |            | 42.25      |            |       | 13.92

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:          485.5 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018712033    2.9030295e-16  0              0.056136099    798351.37      0              3.8549531e+13  1.6929675e-13  0              3.3414113    
    200000   6000           100            100            0.0057700794   2.9030295e-16  0              0.017310238    156123.65      0              7.5386524e+12  1.6929675e-13  0              3.0984741    
    300000   6000           100            100           -0.00094810427  2.9030295e-16  0             -0.0028443128   11624.43       0              5.6130214e+11  1.6929675e-13  0              3.0296543    
    400000   6000           100            100            0.027247545    0.010010992    0              0.071731643    11686.09       0              5.6427946e+11  1.6929675e-13  0              2.9913566    
    500000   6000           100            100            0.018697958    0.0058521885   0              0.050241687    1325.1471      0              6.3986611e+10  1.6929675e-13  0              2.9926636    
    600000   6000           100            100            0.029936189    0.016337801    0              0.073470765    209.7182       0              1.0126541e+10  1.6929675e-13  0              2.9909964    
    700000   6000           100            100            0.028710023    0.013140615    0              0.072989453    25.115256      0              1.2127258e+09  1.6929675e-13  0              2.9910613    
    800000   6000           100            100            0.027296944    0.013459894    0              0.068430937    1.0308277      0              49774982       1.6929675e-13  0              2.9913346    
    900000   6000           100            100            0.028399425    0.013758205    0              0.07144007     0.0063762206   0              307884.87      1.6929675e-13  0              2.9911476    
   1000000   6000           100            100            0.027985534    0.013646334    0              0.070310269    0.03377058     0              1630660.4      1.6929675e-13  0              2.9912185    
   1100000   6000           100            100            0.028073472    0.013664449    0              0.070555967    0.0090353983   0              436287.05      1.6929675e-13  0              2.9912026    
   1200000   6000           100            100            0.028076964    0.013664936    0              0.070565958    0.00089878934  0              43399.321      1.6929675e-13  0              2.9912022    
   1300000   6000           100            100            0.028063106    0.013662017    0              0.070527301    2.0121211e-05  0              971.58125      1.6929675e-13  0              2.9912046    
   1400000   6000           100            100            0.028070603    0.01366363     0              0.070548178    2.0743394e-06  0              100.16242      1.6929675e-13  0              2.9912033    
   1500000   6000           100            100            0.028068153    0.013663095    0              0.070541363    2.0412077e-06  0              98.562614      1.6929675e-13  0              2.9912037    
   1600000   6000           100            100            0.028068556    0.013663186    0              0.070542481    3.9422928e-07  0              19.035921      1.6929675e-13  0              2.9912036    
   1700000   6000           100            100            0.028068652    0.013663205    0              0.070542752    2.86574e-08    0              1.3837633      1.6929675e-13  0              2.9912036    
   1800000   6000           100            100            0.028068543    0.013663182    0              0.070542447    1.7210036e-10  0              0.0083101107   1.6929675e-13  0              2.9912036    
   1900000   6000           100            100            0.028068593    0.013663193    0              0.070542586    2.2952725e-10  0              0.01108305     1.6929675e-13  0              2.9912036    
   2000000   6000           100            100            0.028068579    0.01366319     0              0.070542547    1.0947032e-10  0              0.00528593     1.6929675e-13  0              2.9912036    
   2100000   6000           100            100            0.02806858     0.01366319     0              0.07054255     1.5850789e-11  0              0.00076537785  1.6929675e-13  0              2.9912036    
   2200000   6000           100            100            0.028068581    0.01366319     0              0.070542554    7.8417806e-13  0              3.7865152e-05  1.6929675e-13  0              2.9912036    
   2300000   6000           100            100            0.02806858     0.01366319     0              0.070542551    6.0884015e-16  0              2.9398712e-08  1.6929675e-13  0              2.9912036    
   2400000   6000           100            100            0.028068581    0.01366319     0              0.070542552    1.7782603e-14  0              8.5865828e-07  1.6929675e-13  0              2.9912036    
   2500000   6000           100            100            0.028068581    0.01366319     0              0.070542552    5.3530232e-15  0              2.5847833e-07  1.6929675e-13  0              2.9912036    
   2600000   6000           100            100            0.028068581    0.01366319     0              0.070542552    6.2407495e-16  0              3.0134346e-08  1.6929675e-13  0              2.9912036    
   2700000   6000           100            100            0.028068581    0.01366319     0              0.070542552    1.9734332e-19  0              9.5290028e-12  1.6929675e-13  0              2.9912036    
   2800000   6000           100            100            0.028068581    0.01366319     0              0.070542552    2.8154671e-18  0              1.3594883e-10  1.6929675e-13  0              2.9912036    
   2900000   6000           100            100            0.028068581    0.01366319     0              0.070542552    3.4009786e-19  0              1.6422109e-11  1.6929675e-13  0              2.9912036    
   3000000   6000           100            100            0.028068581    0.01366319     0              0.070542552    7.5174315e-18  0              3.6298986e-10  1.6929675e-13  0              2.9912036    
Loop time of 299.935 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8641881.856 ns/day, 0.000 hours/ns, 10002.178 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.177     | 56.269     | 75.035     | 228.3 | 18.76
Neigh   | 0.92049    | 0.93203    | 0.9434     |   0.8 |  0.31
Comm    | 22.155     | 39.924     | 58.718     | 263.2 | 13.31
Output  | 0.27206    | 0.27225    | 0.27248    |   0.0 |  0.09
Modify  | 138.85     | 160.77     | 181.12     | 157.0 | 53.60
Other   |            | 41.77      |            |       | 13.93

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018776221    2.9030295e-16  0              0.056328663    802425.22      0              3.8746242e+13  1.6929675e-13  0              3.3393264    
    200000   6000           100            100            0.0059135734   2.9030295e-16  0              0.01774072     162300.97      0              7.8369332e+12  1.6929675e-13  0              3.0953023    
    300000   6000           100            100           -0.00077008686  2.9030295e-16  0             -0.0023102606   7220.1111      0              3.4863333e+11  1.6929675e-13  0              3.0339631    
    400000   6000           100            100            0.091360245    0.039392896    0              0.23468784     2003.2897      0              9.6731691e+10  1.6929675e-13  0              2.9851583    
    500000   6000           100            100            0.026141923    0.012276935    0              0.066148833    1686.5965      0              8.143971e+10   1.6929675e-13  0              2.9920461    
    600000   6000           100            100            0.025512623    0.01109692     0              0.065440949    210.74649      0              1.0176194e+10  1.6929675e-13  0              2.9921326    
    700000   6000           100            100            0.024948212    0.010363411    0              0.064481226    8.1094676      0              3.9157717e+08  1.6929675e-13  0              2.9922108    
    800000   6000           100            100            0.026573109    0.011623402    0              0.068095924    0.40061057     0              19344051       1.6929675e-13  0              2.9920016    
    900000   6000           100            100            0.027342349    0.011792813    0              0.070234235    0.4694094      0              22666100       1.6929675e-13  0              2.9918769    
   1000000   6000           100            100            0.027517908    0.011810634    0              0.07074309     0.052483348    0              2534233.1      1.6929675e-13  0              2.9918466    
   1100000   6000           100            100            0.02749776     0.011807487    0              0.070685794    0.00015711994  0              7586.7598      1.6929675e-13  0              2.9918496    
   1200000   6000           100            100            0.02746405     0.01180075     0              0.0705914      0.00062502524  0              30180.232      1.6929675e-13  0              2.991855     
   1300000   6000           100            100            0.027451409    0.011798157    0              0.070556069    0.00017110542  0              8262.0684      1.6929675e-13  0              2.991857     
   1400000   6000           100            100            0.027450165    0.011797883    0              0.070552613    6.8249441e-06  0              329.55213      1.6929675e-13  0              2.9918573    
   1500000   6000           100            100            0.027451294    0.011798106    0              0.070555775    3.1693743e-07  0              15.303774      1.6929675e-13  0              2.9918571    
   1600000   6000           100            100            0.027451975    0.011798245    0              0.07055768     3.6858373e-07  0              17.797589      1.6929675e-13  0              2.991857     
   1700000   6000           100            100            0.027452134    0.011798278    0              0.070558125    4.0544593e-08  0              1.9577533      1.6929675e-13  0              2.9918569    
   1800000   6000           100            100            0.027452116    0.011798275    0              0.070558073    1.0818149e-10  0              0.0052236971   1.6929675e-13  0              2.9918569    
   1900000   6000           100            100            0.027452086    0.011798269    0              0.070557989    4.9558657e-10  0              0.023930102    1.6929675e-13  0              2.9918569    
   2000000   6000           100            100            0.027452075    0.011798266    0              0.070557958    1.333282e-10   0              0.0064379417   1.6929675e-13  0              2.9918569    
   2100000   6000           100            100            0.027452074    0.011798266    0              0.070557955    5.1978038e-12  0              0.00025098335  1.6929675e-13  0              2.9918569    
   2200000   6000           100            100            0.027452075    0.011798266    0              0.070557958    2.5848315e-13  0              1.2481226e-05  1.6929675e-13  0              2.9918569    
   2300000   6000           100            100            0.027452075    0.011798266    0              0.070557959    2.8912916e-13  0              1.3961012e-05  1.6929675e-13  0              2.9918569    
   2400000   6000           100            100            0.027452075    0.011798267    0              0.07055796     3.1591836e-14  0              1.5254567e-06  1.6929675e-13  0              2.9918569    
   2500000   6000           100            100            0.027452075    0.011798267    0              0.07055796     4.8826026e-17  0              2.3576341e-09  1.6929675e-13  0              2.9918569    
   2600000   6000           100            100            0.027452075    0.011798267    0              0.07055796     3.9364684e-16  0              1.9007797e-08  1.6929675e-13  0              2.9918569    
   2700000   6000           100            100            0.027452075    0.011798267    0              0.07055796     6.9772071e-17  0              3.3690436e-09  1.6929675e-13  0              2.9918569    
   2800000   6000           100            100            0.027452075    0.011798267    0              0.07055796     4.2780297e-21  0              2.0657074e-13  1.6929675e-13  0              2.9918569    
   2900000   6000           100            100            0.027452075    0.011798266    0              0.07055796     4.4394692e-20  0              2.1436608e-12  1.6929675e-13  0              2.9918569    
   3000000   6000           100            100            0.027452075    0.011798267    0              0.07055796     9.3799532e-18  0              4.5292437e-10  1.6929675e-13  0              2.9918569    
Loop time of 303.392 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8543400.169 ns/day, 0.000 hours/ns, 9888.195 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.293     | 56.489     | 74.507     | 228.5 | 18.62
Neigh   | 0.91821    | 0.9287     | 0.93915    |   0.8 |  0.31
Comm    | 23.022     | 40.114     | 57.081     | 261.3 | 13.22
Output  | 0.27068    | 0.27088    | 0.27113    |   0.0 |  0.09
Modify  | 141.08     | 162.65     | 184.99     | 163.1 | 53.61
Other   |            | 42.94      |            |       | 14.15

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018829147    2.9030295e-16  0              0.05648744     805790.91      0              3.8908759e+13  1.6929675e-13  0              3.3375928    
    200000   6000           100            100            0.0060322935   2.9030295e-16  0              0.018096881    167468.81      0              8.0864697e+12  1.6929675e-13  0              3.0926092    
    300000   6000           100            100           -0.00061607835  2.9030295e-16  0             -0.0018482351   4406.3869      0              2.1276865e+11  1.6929675e-13  0              3.0369787    
    400000   6000           100            100            0.084742246    0.043622       0              0.21060474     5048.8261      0              2.4378974e+11  1.6929675e-13  0              2.9867546    
    500000   6000           100            100            0.01783654     0.0041048475   0              0.049404773    1467.1481      0              7.0843329e+10  1.6929675e-13  0              2.9937061    
    600000   6000           100            100            0.028609313    0.011968927    0              0.073859012    226.74458      0              1.0948684e+10  1.6929675e-13  0              2.9921841    
    700000   6000           100            100            0.028238521    0.010762785    0              0.073952777    25.145277      0              1.2141754e+09  1.6929675e-13  0              2.9922106    
    800000   6000           100            100            0.025844779    0.0095628178   0              0.06797152     0.46012334     0              22217710       1.6929675e-13  0              2.9925239    
    900000   6000           100            100            0.027167684    0.010017237    0              0.071485816    0.097977692    0              4730992.1      1.6929675e-13  0              2.9923335    
   1000000   6000           100            100            0.02677695     0.0098861975   0              0.070444654    0.065365551    0              3156268.5      1.6929675e-13  0              2.9923905    
   1100000   6000           100            100            0.0268016      0.0098922392   0              0.070512562    0.0082631573   0              398998.29      1.6929675e-13  0              2.9923863    
   1200000   6000           100            100            0.026839004    0.00989985     0              0.070617163    0.00016342999  0              7891.4493      1.6929675e-13  0              2.9923808    
   1300000   6000           100            100            0.026816342    0.0098951343   0              0.070553891    3.1126905e-05  0              1503.0069      1.6929675e-13  0              2.9923842    
   1400000   6000           100            100            0.026823065    0.0098965638   0              0.070572631    2.1208862e-05  0              1024.1         1.6929675e-13  0              2.9923831    
   1500000   6000           100            100            0.026822624    0.0098964586   0              0.070571414    2.6787094e-06  0              129.34529      1.6929675e-13  0              2.9923832    
   1600000   6000           100            100            0.02682195     0.0098963215   0              0.07056953     5.2781369e-08  0              2.5486234      1.6929675e-13  0              2.9923833    
   1700000   6000           100            100            0.026822359    0.0098964067   0              0.070570669    1.0126878e-08  0              0.48899071     1.6929675e-13  0              2.9923833    
   1800000   6000           100            100            0.026822238    0.009896381    0              0.070570332    6.8814587e-09  0              0.33228101     1.6929675e-13  0              2.9923833    
   1900000   6000           100            100            0.026822245    0.0098963829   0              0.070570354    8.6810133e-10  0              0.041917506    1.6929675e-13  0              2.9923833    
   2000000   6000           100            100            0.026822258    0.0098963853   0              0.070570388    1.7045249e-11  0              0.00082305405  1.6929675e-13  0              2.9923833    
   2100000   6000           100            100            0.02682225     0.0098963838   0              0.070570367    3.2937541e-12  0              0.0001590436   1.6929675e-13  0              2.9923833    
   2200000   6000           100            100            0.026822252    0.0098963843   0              0.070570373    2.2326619e-12  0              0.00010780725  1.6929675e-13  0              2.9923833    
   2300000   6000           100            100            0.026822252    0.0098963842   0              0.070570373    2.8152532e-13  0              1.359385e-05   1.6929675e-13  0              2.9923833    
   2400000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    5.5903819e-15  0              2.6993953e-07  1.6929675e-13  0              2.9923833    
   2500000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    1.059023e-15   0              5.1136432e-08  1.6929675e-13  0              2.9923833    
   2600000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    7.3958022e-16  0              3.5711682e-08  1.6929675e-13  0              2.9923833    
   2700000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    3.7215599e-17  0              1.7970081e-09  1.6929675e-13  0              2.9923833    
   2800000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    7.5010167e-19  0              3.6219725e-11  1.6929675e-13  0              2.9923833    
   2900000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    3.03927e-18    0              1.4675547e-10  1.6929675e-13  0              2.9923833    
   3000000   6000           100            100            0.026822252    0.0098963842   0              0.070570372    3.0177372e-19  0              1.4571573e-11  1.6929675e-13  0              2.9923833    
Loop time of 301.942 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8584422.860 ns/day, 0.000 hours/ns, 9935.675 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.669     | 55.426     | 72.813     | 221.1 | 18.36
Neigh   | 0.91894    | 0.93007    | 0.94148    |   0.8 |  0.31
Comm    | 23.004     | 39.45      | 57.064     | 252.1 | 13.07
Output  | 0.27045    | 0.27066    | 0.27092    |   0.0 |  0.09
Modify  | 141.74     | 163.67     | 185.39     | 156.8 | 54.21
Other   |            | 42.19      |            |       | 13.97

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018873864    2.9030295e-16  0              0.056621592    808639.28      0              3.9046297e+13  1.6929675e-13  0              3.3361178    
    200000   6000           100            100            0.0061328773   2.9030295e-16  0              0.018398632    171887.07      0              8.2998117e+12  1.6929675e-13  0              3.090279     
    300000   6000           100            100           -0.00048112298  2.9030295e-16  0             -0.0014433689   2584.9483      0              1.248179e+11   1.6929675e-13  0              3.0391561    
    400000   6000           100            100            0.02669099     0.013069297    0              0.067003673    12473.693      0              6.0231001e+11  1.6929675e-13  0              2.9928527    
    500000   6000           100            100            0.047437595    0.025159636    0              0.11715315     864.69719      0              4.1753133e+10  1.6929675e-13  0              2.9907097    
    600000   6000           100            100            0.035418386    0.013955946    0              0.09229921     19.569273      0              9.4493013e+08  1.6929675e-13  0              2.9917808    
    700000   6000           100            100            0.028999519    0.009716582    0              0.077281975    9.4475915      0              4.5619038e+08  1.6929675e-13  0              2.9924812    
    800000   6000           100            100            0.026944583    0.0086036418   0              0.072230108    2.859371       0              1.3806879e+08  1.6929675e-13  0              2.9927332    
    900000   6000           100            100            0.026412656    0.0084473832   0              0.070790585    0.54915051     0              26516513       1.6929675e-13  0              2.9928074    
   1000000   6000           100            100            0.026301185    0.0084058968   0              0.07049766     0.073869027    0              3566871        1.6929675e-13  0              2.992823     
   1100000   6000           100            100            0.026300681    0.0084056588   0              0.070496386    0.0068206503   0              329344.79      1.6929675e-13  0              2.9928234    
   1200000   6000           100            100            0.026314323    0.0084076244   0              0.070535344    0.00035286323  0              17038.503      1.6929675e-13  0              2.9928215    
   1300000   6000           100            100            0.026323541    0.0084089833   0              0.070561638    2.1981507e-06  0              106.14083      1.6929675e-13  0              2.9928202    
   1400000   6000           100            100            0.026327881    0.0084096314   0              0.07057401     2.3408384e-06  0              113.03071      1.6929675e-13  0              2.9928195    
   1500000   6000           100            100            0.026329548    0.0084098826   0              0.07057876     1.4957941e-06  0              72.226545      1.6929675e-13  0              2.9928193    
   1600000   6000           100            100            0.02633008     0.0084099637   0              0.070580278    3.7589965e-07  0              18.150849      1.6929675e-13  0              2.9928192    
   1700000   6000           100            100            0.026330213    0.0084099843   0              0.070580656    6.0577147e-08  0              2.9250537      1.6929675e-13  0              2.9928192    
   1800000   6000           100            100            0.026330231    0.0084099871   0              0.070580705    6.7907167e-09  0              0.32789941     1.6929675e-13  0              2.9928192    
   1900000   6000           100            100            0.026330225    0.0084099863   0              0.070580687    4.8869478e-10  0              0.023597322    1.6929675e-13  0              2.9928192    
   2000000   6000           100            100            0.026330218    0.0084099853   0              0.070580669    1.3923504e-11  0              0.00067231619  1.6929675e-13  0              2.9928192    
   2100000   6000           100            100            0.026330215    0.0084099848   0              0.070580659    2.218603e-13   0              1.071284e-05   1.6929675e-13  0              2.9928192    
   2200000   6000           100            100            0.026330213    0.0084099846   0              0.070580655    6.6582317e-13  0              3.2150218e-05  1.6929675e-13  0              2.9928192    
   2300000   6000           100            100            0.026330213    0.0084099845   0              0.070580653    2.3329739e-13  0              1.1265096e-05  1.6929675e-13  0              2.9928192    
   2400000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    4.564274e-14   0              2.2039246e-06  1.6929675e-13  0              2.9928192    
   2500000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    6.1312501e-15  0              2.9605613e-07  1.6929675e-13  0              2.9928192    
   2600000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    6.0251027e-16  0              2.9093065e-08  1.6929675e-13  0              2.9928192    
   2700000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    2.9369173e-18  0              1.4181323e-10  1.6929675e-13  0              2.9928192    
   2800000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    1.6803938e-18  0              8.1140205e-11  1.6929675e-13  0              2.9928192    
   2900000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    8.2844211e-18  0              4.0002505e-10  1.6929675e-13  0              2.9928192    
   3000000   6000           100            100            0.026330212    0.0084099845   0              0.070580653    8.8963522e-18  0              4.2957301e-10  1.6929675e-13  0              2.9928192    
Loop time of 301.84 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8587333.072 ns/day, 0.000 hours/ns, 9939.043 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.573     | 55.122     | 71.664     | 220.2 | 18.26
Neigh   | 0.91603    | 0.9267     | 0.93745    |   0.8 |  0.31
Comm    | 22.83      | 39.166     | 55.87      | 256.3 | 12.98
Output  | 0.26929    | 0.26949    | 0.26975    |   0.0 |  0.09
Modify  | 140.8      | 162.36     | 186.48     | 166.9 | 53.79
Other   |            | 43.99      |            |       | 14.57

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018912358    2.9030295e-16  0              0.056737074    811094.62      0              3.9164856e+13  1.6929675e-13  0              3.334841     
    200000   6000           100            100            0.0062196731   2.9030295e-16  0              0.018659019    175728.77      0              8.4853136e+12  1.6929675e-13  0              3.0882329    
    300000   6000           100            100           -0.00036154131  2.9030295e-16  0             -0.0010846239   1412.7374      0              6.8216033e+10  1.6929675e-13  0              3.0407637    
    400000   6000           100            100            0.00099464772  0.0015455357   0              0.0014384075   8339.2596      0              4.02673e+11    1.6929675e-13  0              2.9983941    
    500000   6000           100            100            0.008047704    0.0044157216   0              0.01972739     70.208035      0              3.3900947e+09  1.6929675e-13  0              2.9963715    
    600000   6000           100            100            0.02795652     0.0086120807   0              0.075257478    238.57215      0              1.1519795e+10  1.6929675e-13  0              2.992988     
    700000   6000           100            100            0.026168333    0.0075280499   0              0.070976949    32.84041       0              1.5857459e+09  1.6929675e-13  0              2.9931609    
    800000   6000           100            100            0.025657915    0.0072332476   0              0.069740499    4.0334026      0              1.9475858e+08  1.6929675e-13  0              2.9932318    
    900000   6000           100            100            0.026223474    0.0075907196   0              0.071079703    0.4704728      0              22717448       1.6929675e-13  0              2.9931632    
   1000000   6000           100            100            0.025985567    0.007607638    0              0.070349063    0.050650469    0              2445729.9      1.6929675e-13  0              2.9931997    
   1100000   6000           100            100            0.026103345    0.0076134731   0              0.070696562    0.0049940385   0              241144.25      1.6929675e-13  0              2.9931825    
   1200000   6000           100            100            0.026050189    0.0076063764   0              0.070544191    0.00043174481  0              20847.412      1.6929675e-13  0              2.99319      
   1300000   6000           100            100            0.026072287    0.007609305    0              0.070607555    3.0442284e-05  0              1469.9489      1.6929675e-13  0              2.9931869    
   1400000   6000           100            100            0.026063467    0.00760814     0              0.070582261    1.4235255e-06  0              68.736953      1.6929675e-13  0              2.9931881    
   1500000   6000           100            100            0.026066868    0.0076085874   0              0.070592016    1.453835e-08   0              0.70200491     1.6929675e-13  0              2.9931877    
   1600000   6000           100            100            0.026065596    0.0076084207   0              0.070588369    5.3554872e-09  0              0.25859731     1.6929675e-13  0              2.9931878    
   1700000   6000           100            100            0.026066058    0.0076084809   0              0.070589692    4.7668733e-09  0              0.23017525     1.6929675e-13  0              2.9931878    
   1800000   6000           100            100            0.026065895    0.0076084598   0              0.070589226    1.6023865e-09  0              0.077373507    1.6929675e-13  0              2.9931878    
   1900000   6000           100            100            0.026065951    0.007608467    0              0.070589385    3.8545932e-10  0              0.018612451    1.6929675e-13  0              2.9931878    
   2000000   6000           100            100            0.026065933    0.0076084646   0              0.070589333    7.7473004e-11  0              0.0037408941   1.6929675e-13  0              2.9931878    
   2100000   6000           100            100            0.026065938    0.0076084654   0              0.070589349    1.382947e-11   0              0.00066777563  1.6929675e-13  0              2.9931878    
   2200000   6000           100            100            0.026065937    0.0076084652   0              0.070589344    2.2606326e-12  0              0.00010915786  1.6929675e-13  0              2.9931878    
   2300000   6000           100            100            0.026065937    0.0076084652   0              0.070589346    3.4393398e-13  0              1.6607341e-05  1.6929675e-13  0              2.9931878    
   2400000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    4.9018764e-14  0              2.3669407e-06  1.6929675e-13  0              2.9931878    
   2500000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    6.5906177e-15  0              3.1823734e-07  1.6929675e-13  0              2.9931878    
   2600000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    8.4876159e-16  0              4.098366e-08   1.6929675e-13  0              2.9931878    
   2700000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    1.1945784e-16  0              5.7681918e-09  1.6929675e-13  0              2.9931878    
   2800000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    1.6425795e-17  0              7.9314285e-10  1.6929675e-13  0              2.9931878    
   2900000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    5.1455938e-18  0              2.4846231e-10  1.6929675e-13  0              2.9931878    
   3000000   6000           100            100            0.026065937    0.0076084652   0              0.070589345    9.3233906e-20  0              4.5019317e-12  1.6929675e-13  0              2.9931878    
Loop time of 302.607 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8565553.478 ns/day, 0.000 hours/ns, 9913.835 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.763     | 55.043     | 72.596     | 221.3 | 18.19
Neigh   | 0.91272    | 0.92358    | 0.93483    |   0.8 |  0.31
Comm    | 22.847     | 39.194     | 56.833     | 248.9 | 12.95
Output  | 0.27064    | 0.27086    | 0.27111    |   0.0 |  0.09
Modify  | 141.77     | 163.99     | 186.26     | 163.4 | 54.19
Other   |            | 43.19      |            |       | 14.27

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018945998    2.9030295e-16  0              0.056837995    813242.92      0              3.926859e+13   1.6929675e-13  0              3.3337198    
    200000   6000           100            100            0.0062956829   2.9030295e-16  0              0.018887049    179115.02      0              8.6488232e+12  1.6929675e-13  0              3.0864143    
    300000   6000           100            100           -0.00025453906  2.9030295e-16  0             -0.00076361718  680.67763      0              3.2867487e+10  1.6929675e-13  0              3.0419693    
    400000   6000           100            100           -0.00056368528  2.9030295e-16  0             -0.0016910558   3733.7701      0              1.802904e+11   1.6929675e-13  0              3.0020248    
    500000   6000           100            100            0.026047753    0.0051919811   0              0.072951278    1904.6814      0              9.1970246e+10  1.6929675e-13  0              2.9934596    
    600000   6000           100            100            0.018467492    0.0065715303   0              0.048830946    9.5398656      0              4.6064597e+08  1.6929675e-13  0              2.9945925    
    700000   6000           100            100            0.025013042    0.0067443429   0              0.068294783    31.516995      0              1.5218429e+09  1.6929675e-13  0              2.9936038    
    800000   6000           100            100            0.026706865    0.0073688317   0              0.072751765    2.3580419      0              1.138614e+08   1.6929675e-13  0              2.9934043    
    900000   6000           100            100            0.026252654    0.0070326412   0              0.071725321    0.024603568    0              1188018.3      1.6929675e-13  0              2.9934533    
   1000000   6000           100            100            0.025888274    0.0069144982   0              0.070750323    0.071265917    0              3441176.1      1.6929675e-13  0              2.9934981    
   1100000   6000           100            100            0.025807505    0.0069163225   0              0.070506193    0.0070615931   0              340979.06      1.6929675e-13  0              2.9935091    
   1200000   6000           100            100            0.025819412    0.0069177796   0              0.070540456    7.4488056e-06  0              359.67616      1.6929675e-13  0              2.9935074    
   1300000   6000           100            100            0.025835457    0.0069195927   0              0.070586777    0.00015298092  0              7386.9011      1.6929675e-13  0              2.9935052    
   1400000   6000           100            100            0.025840182    0.006920109    0              0.070600437    2.0326012e-05  0              981.4704       1.6929675e-13  0              2.9935046    
   1500000   6000           100            100            0.025839889    0.0069200716   0              0.070599596    1.3249467e-08  0              0.63976937     1.6929675e-13  0              2.9935047    
   1600000   6000           100            100            0.025839139    0.0069199877   0              0.070597429    3.1403091e-07  0              15.163429      1.6929675e-13  0              2.9935048    
   1700000   6000           100            100            0.025838883    0.0069199596   0              0.070596688    5.5856985e-08  0              2.6971339      1.6929675e-13  0              2.9935048    
   1800000   6000           100            100            0.025838882    0.0069199598   0              0.070596687    3.1898949e-10  0              0.015402861    1.6929675e-13  0              2.9935048    
   1900000   6000           100            100            0.025838917    0.0069199636   0              0.070596787    6.108519e-10   0              0.029495852    1.6929675e-13  0              2.9935048    
   2000000   6000           100            100            0.02583893     0.0069199651   0              0.070596826    1.4740796e-10  0              0.0071178026   1.6929675e-13  0              2.9935048    
   2100000   6000           100            100            0.025838931    0.0069199652   0              0.070596828    2.1448763e-12  0              0.0001035684   1.6929675e-13  0              2.9935048    
   2200000   6000           100            100            0.02583893     0.006919965    0              0.070596824    1.1109993e-12  0              5.364618e-05   1.6929675e-13  0              2.9935048    
   2300000   6000           100            100            0.025838929    0.006919965    0              0.070596822    3.7480755e-13  0              1.8098115e-05  1.6929675e-13  0              2.9935048    
   2400000   6000           100            100            0.025838929    0.006919965    0              0.070596821    9.9406503e-15  0              4.7999843e-07  1.6929675e-13  0              2.9935048    
   2500000   6000           100            100            0.025838929    0.006919965    0              0.070596822    1.847145e-15   0              8.9192021e-08  1.6929675e-13  0              2.9935048    
   2600000   6000           100            100            0.025838929    0.006919965    0              0.070596822    9.176191e-16   0              4.4308542e-08  1.6929675e-13  0              2.9935048    
   2700000   6000           100            100            0.025838929    0.006919965    0              0.070596822    7.4625895e-17  0              3.6034174e-09  1.6929675e-13  0              2.9935048    
   2800000   6000           100            100            0.025838929    0.006919965    0              0.070596822    6.765669e-19   0              3.2668994e-11  1.6929675e-13  0              2.9935048    
   2900000   6000           100            100            0.025838929    0.006919965    0              0.070596822    1.5269091e-18  0              7.3728975e-11  1.6929675e-13  0              2.9935048    
   3000000   6000           100            100            0.025838929    0.006919965    0              0.070596822    9.5441071e-18  0              4.6085077e-10  1.6929675e-13  0              2.9935048    
Loop time of 296.744 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8734813.173 ns/day, 0.000 hours/ns, 10109.737 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.345     | 54.303     | 71.405     | 226.0 | 18.30
Neigh   | 0.92194    | 0.93357    | 0.94546    |   0.9 |  0.31
Comm    | 22.423     | 39.171     | 55.986     | 260.7 | 13.20
Output  | 0.27172    | 0.27193    | 0.2722     |   0.0 |  0.09
Modify  | 140.14     | 160.87     | 180.98     | 157.9 | 54.21
Other   |            | 41.19      |            |       | 13.88

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.018975762    2.9030295e-16  0              0.056927286    815145.62      0              3.9360465e+13  1.6929675e-13  0              3.3327238    
    200000   6000           100            100            0.0063630567   2.9030295e-16  0              0.01908917     182133.53      0              8.7945763e+12  1.6929675e-13  0              3.0847815    
    300000   6000           100            100           -0.00015799235  2.9030295e-16  0             -0.00047397704  255.55374      0              1.2339776e+10  1.6929675e-13  0              3.0428829    
    400000   6000           100            100           -0.00033162588  2.9030295e-16  0             -0.00099487764  1210.8688      0              5.8468523e+10  1.6929675e-13  0              3.0041707    
    500000   6000           100            100            0.053447438    0.023229739    0              0.13711257     387.07534      0              1.8690483e+10  1.6929675e-13  0              2.9913111    
    600000   6000           100            100            0.033702149    0.0094311607   0              0.091675287    78.545635      0              3.7926876e+09  1.6929675e-13  0              2.992903     
    700000   6000           100            100            0.025587634    0.0069250837   0              0.069837818    34.425239      0              1.6622716e+09  1.6929675e-13  0              2.9938074    
    800000   6000           100            100            0.024738238    0.00668002     0              0.067534694    0.44382261     0              21430605       1.6929675e-13  0              2.993917     
    900000   6000           100            100            0.025521829    0.0066781253   0              0.069887363    0.38959916     0              18812349       1.6929675e-13  0              2.9938137    
   1000000   6000           100            100            0.025859194    0.0067300063   0              0.070847576    0.058114371    0              2806135        1.6929675e-13  0              2.9937709    
   1100000   6000           100            100            0.025828579    0.0067285062   0              0.070757231    0.00073934942  0              35700.538      1.6929675e-13  0              2.9937745    
   1200000   6000           100            100            0.025777485    0.0067257499   0              0.070606704    0.0015040562   0              72625.492      1.6929675e-13  0              2.9937811    
   1300000   6000           100            100            0.025769588    0.0067253059   0              0.070583459    2.9962598e-05  0              1446.7866      1.6929675e-13  0              2.9937821    
   1400000   6000           100            100            0.025774593    0.0067255705   0              0.070598209    1.5397578e-05  0              743.49395      1.6929675e-13  0              2.9937815    
   1500000   6000           100            100            0.025776833    0.0067256926   0              0.070604806    2.7530055e-06  0              132.93278      1.6929675e-13  0              2.9937812    
   1600000   6000           100            100            0.025776687    0.0067256857   0              0.070604376    1.8743702e-08  0              0.90506627     1.6929675e-13  0              2.9937812    
   1700000   6000           100            100            0.025776352    0.0067256677   0              0.070603388    6.5137276e-08  0              3.1452459      1.6929675e-13  0              2.9937813    
   1800000   6000           100            100            0.025776293    0.0067256644   0              0.070603214    1.7359451e-09  0              0.083822578    1.6929675e-13  0              2.9937813    
   1900000   6000           100            100            0.025776324    0.006725666    0              0.070603305    6.0005501e-10  0              0.028974509    1.6929675e-13  0              2.9937813    
   2000000   6000           100            100            0.025776339    0.0067256668   0              0.07060335     1.291571e-10   0              0.0062365342   1.6929675e-13  0              2.9937813    
   2100000   6000           100            100            0.025776338    0.0067256668   0              0.070603349    3.8109563e-13  0              1.8401744e-05  1.6929675e-13  0              2.9937813    
   2200000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    2.7976754e-12  0              0.00013508973  1.6929675e-13  0              2.9937813    
   2300000   6000           100            100            0.025776336    0.0067256667   0              0.070603341    9.6516621e-14  0              4.6604422e-06  1.6929675e-13  0              2.9937813    
   2400000   6000           100            100            0.025776336    0.0067256667   0              0.070603341    2.3079397e-14  0              1.1144215e-06  1.6929675e-13  0              2.9937813    
   2500000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    6.0584832e-15  0              2.9254247e-07  1.6929675e-13  0              2.9937813    
   2600000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    9.2961086e-18  0              4.4887581e-10  1.6929675e-13  0              2.9937813    
   2700000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    1.2627188e-16  0              6.0972171e-09  1.6929675e-13  0              2.9937813    
   2800000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    1.6461846e-19  0              7.9488363e-12  1.6929675e-13  0              2.9937813    
   2900000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    4.650508e-20   0              2.2455639e-12  1.6929675e-13  0              2.9937813    
   3000000   6000           100            100            0.025776336    0.0067256667   0              0.070603342    4.7705029e-18  0              2.3035051e-10  1.6929675e-13  0              2.9937813    
Loop time of 300.832 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8616112.544 ns/day, 0.000 hours/ns, 9972.352 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.672     | 56.224     | 72.811     | 220.1 | 18.69
Neigh   | 0.94418    | 0.95609    | 0.96727    |   0.8 |  0.32
Comm    | 22.889     | 39.183     | 55.968     | 258.5 | 13.02
Output  | 0.27027    | 0.27049    | 0.27078    |   0.0 |  0.09
Modify  | 140.3      | 161.18     | 184.25     | 164.0 | 53.58
Other   |            | 43.02      |            |       | 14.30

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019002367    2.9030295e-16  0              0.0570071      816847.96      0              3.9442664e+13  1.6929675e-13  0              3.3318302    
    200000   6000           100            100            0.0064233795   2.9030295e-16  0              0.019270138    184849.6       0              8.9257258e+12  1.6929675e-13  0              3.0833029    
    300000   6000           100            100           -7.0237897e-05  2.9030295e-16  0             -0.00021071369  49.101956      0              2.3709577e+09  1.6929675e-13  0              3.0435791    
    400000   6000           100            100           -0.00011550505  2.9030295e-16  0             -0.00034651514  138.45462      0              6.6854781e+09  1.6929675e-13  0              3.005278     
    500000   6000           100            100            0.013788803    0.0064834868   0              0.034882923    1335.6449      0              6.4493512e+10  1.6929675e-13  0              2.9957354    
    600000   6000           100            100            0.021446672    0.0073113872   0              0.057028628    179.27629      0              8.6566104e+09  1.6929675e-13  0              2.9946488    
    700000   6000           100            100            0.027486677    0.0071379684   0              0.075322064    25.884264      0              1.2498585e+09  1.6929675e-13  0              2.9938228    
    800000   6000           100            100            0.025513143    0.0073161752   0              0.069223254    3.8843158      0              1.8755971e+08  1.6929675e-13  0              2.9940865    
    900000   6000           100            100            0.026005064    0.0070685688   0              0.070946623    0.58489365     0              28242421       1.6929675e-13  0              2.9940098    
   1000000   6000           100            100            0.025876743    0.0070880263   0              0.070542202    0.083394999    0              4026846        1.6929675e-13  0              2.9940283    
   1100000   6000           100            100            0.025900681    0.0070900014   0              0.070612042    0.01149168     0              554892.09      1.6929675e-13  0              2.9940248    
   1200000   6000           100            100            0.025901845    0.0070896177   0              0.070615917    0.0015295369   0              73855.863      1.6929675e-13  0              2.9940248    
   1300000   6000           100            100            0.025897788    0.0070896774   0              0.070603687    0.0001963861   0              9482.782       1.6929675e-13  0              2.9940253    
   1400000   6000           100            100            0.025900591    0.0070896725   0              0.0706121      2.428455e-05   0              1172.614       1.6929675e-13  0              2.9940249    
   1500000   6000           100            100            0.025899084    0.0070896217   0              0.07060763     2.881956e-06   0              139.15934      1.6929675e-13  0              2.9940251    
   1600000   6000           100            100            0.025899798    0.0070896462   0              0.070609748    3.2646226e-07  0              15.763694      1.6929675e-13  0              2.994025     
   1700000   6000           100            100            0.025899482    0.0070896353   0              0.07060881     3.4987222e-08  0              1.6894077      1.6929675e-13  0              2.9940251    
   1800000   6000           100            100            0.025899616    0.0070896399   0              0.070609207    3.497011e-09   0              0.16885815     1.6929675e-13  0              2.9940251    
   1900000   6000           100            100            0.025899561    0.007089638    0              0.070609044    3.180617e-10   0              0.015358061    1.6929675e-13  0              2.9940251    
   2000000   6000           100            100            0.025899583    0.0070896388   0              0.070609109    2.5117802e-11  0              0.0012128488   1.6929675e-13  0              2.9940251    
   2100000   6000           100            100            0.025899574    0.0070896385   0              0.070609084    1.5509539e-12  0              7.4890011e-05  1.6929675e-13  0              2.9940251    
   2200000   6000           100            100            0.025899577    0.0070896386   0              0.070609094    5.3419295e-14  0              2.5794266e-06  1.6929675e-13  0              2.9940251    
   2300000   6000           100            100            0.025899576    0.0070896385   0              0.07060909     1.0406439e-18  0              5.0248969e-11  1.6929675e-13  0              2.9940251    
   2400000   6000           100            100            0.025899577    0.0070896386   0              0.070609091    9.8881928e-16  0              4.7746544e-08  1.6929675e-13  0              2.9940251    
   2500000   6000           100            100            0.025899576    0.0070896386   0              0.070609091    5.4126126e-16  0              2.6135569e-08  1.6929675e-13  0              2.9940251    
   2600000   6000           100            100            0.025899577    0.0070896386   0              0.070609091    1.7838089e-16  0              8.6133748e-09  1.6929675e-13  0              2.9940251    
   2700000   6000           100            100            0.025899576    0.0070896386   0              0.070609091    6.974283e-17   0              3.3676316e-09  1.6929675e-13  0              2.9940251    
   2800000   6000           100            100            0.025899576    0.0070896386   0              0.070609091    1.6991327e-17  0              8.2045038e-10  1.6929675e-13  0              2.9940251    
   2900000   6000           100            100            0.025899576    0.0070896386   0              0.070609091    7.5544578e-21  0              3.6477773e-13  1.6929675e-13  0              2.9940251    
   3000000   6000           100            100            0.025899576    0.0070896385   0              0.070609091    1.0335274e-18  0              4.990534e-11   1.6929675e-13  0              2.9940251    
Loop time of 300.051 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8638540.253 ns/day, 0.000 hours/ns, 9998.310 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.609     | 53.786     | 69.799     | 216.7 | 17.93
Neigh   | 0.92685    | 0.93961    | 0.95216    |   0.9 |  0.31
Comm    | 23.61      | 39.135     | 55.142     | 246.4 | 13.04
Output  | 0.28198    | 0.28219    | 0.28247    |   0.0 |  0.09
Modify  | 141.29     | 163.01     | 185.73     | 164.7 | 54.33
Other   |            | 42.9       |            |       | 14.30

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019026356    2.9030295e-16  0              0.057079067    818384.18      0              3.9516843e+13  1.6929675e-13  0              3.3310218    
    200000   6000           100            100            0.0064778492   2.9030295e-16  0              0.019433548    187313.01      0              9.044675e+12   1.6929675e-13  0              3.0819545    
    300000   6000           100            100            1.0038708e-05  2.9030295e-16  0              3.0116124e-05  1.095921       0              52918102       1.6929675e-13  0              3.0441104    
    400000   6000           100            100            8.577491e-05   2.9030295e-16  0              0.00025732473  74.328592      0              3.5890617e+09  1.6929675e-13  0              3.0056457    
    500000   6000           100            100            0.0064405096   0.0030429111   0              0.016278618    183.22914      0              8.8474794e+09  1.6929675e-13  0              2.9972607    
    600000   6000           100            100            0.028470565    0.0072950962   0              0.078116598    247.3996       0              1.1946042e+10  1.6929675e-13  0              2.9939262    
    700000   6000           100            100            0.029196125    0.0073714381   0              0.080216935    0.0076986641   0              371740.94      1.6929675e-13  0              2.9938633    
    800000   6000           100            100            0.026515145    0.0071573562   0              0.07238808     3.6047703      0              1.7406145e+08  1.6929675e-13  0              2.9941726    
    900000   6000           100            100            0.025754636    0.0072318521   0              0.070032055    0.50597509     0              24431726       1.6929675e-13  0              2.9942668    
   1000000   6000           100            100            0.025805287    0.0072624428   0              0.070153419    0.00034825842  0              16816.153      1.6929675e-13  0              2.9942609    
   1100000   6000           100            100            0.025926665    0.0072656411   0              0.070514353    0.0077814387   0              375737.82      1.6929675e-13  0              2.9942461    
   1200000   6000           100            100            0.025968165    0.0072669943   0              0.070637502    0.0013476968   0              65075.457      1.6929675e-13  0              2.9942411    
   1300000   6000           100            100            0.025967922    0.0072670904   0              0.070636677    5.6914787e-06  0              274.82114      1.6929675e-13  0              2.9942412    
   1400000   6000           100            100            0.02596218     0.0072667403   0              0.070619799    1.6080315e-05  0              776.46085      1.6929675e-13  0              2.9942419    
   1500000   6000           100            100            0.02595999     0.007266611    0              0.070613359    3.5255353e-06  0              170.23548      1.6929675e-13  0              2.9942422    
   1600000   6000           100            100            0.025959912    0.0072666074   0              0.070613128    3.601446e-08   0              1.7390094      1.6929675e-13  0              2.9942422    
   1700000   6000           100            100            0.025960176    0.0072666233   0              0.070613905    3.1971607e-08  0              1.5437945      1.6929675e-13  0              2.9942421    
   1800000   6000           100            100            0.025960289    0.00726663     0              0.070614237    9.0134777e-09  0              0.43522858     1.6929675e-13  0              2.9942421    
   1900000   6000           100            100            0.025960297    0.0072666304   0              0.070614262    1.6424504e-10  0              0.0079308054   1.6929675e-13  0              2.9942421    
   2000000   6000           100            100            0.025960285    0.0072666297   0              0.070614227    6.0696068e-11  0              0.0029307959   1.6929675e-13  0              2.9942421    
   2100000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     2.2539706e-11  0              0.0010883618   1.6929675e-13  0              2.9942421    
   2200000   6000           100            100            0.025960279    0.0072666293   0              0.070614208    6.3305121e-13  0              3.0567777e-05  1.6929675e-13  0              2.9942421    
   2300000   6000           100            100            0.02596028     0.0072666294   0              0.070614209    1.0897359e-13  0              5.2619444e-06  1.6929675e-13  0              2.9942421    
   2400000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     5.521561e-14   0              2.6661642e-06  1.6929675e-13  0              2.9942421    
   2500000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     2.2074134e-15  0              1.0658809e-07  1.6929675e-13  0              2.9942421    
   2600000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     1.5545947e-16  0              7.5065815e-09  1.6929675e-13  0              2.9942421    
   2700000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     1.1235692e-16  0              5.4253138e-09  1.6929675e-13  0              2.9942421    
   2800000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     1.709795e-17   0              8.2559884e-10  1.6929675e-13  0              2.9942421    
   2900000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     1.4779987e-20  0              7.1367266e-13  1.6929675e-13  0              2.9942421    
   3000000   6000           100            100            0.02596028     0.0072666294   0              0.07061421     1.4150063e-19  0              6.8325589e-12  1.6929675e-13  0              2.9942421    
Loop time of 296.215 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8750392.887 ns/day, 0.000 hours/ns, 10127.770 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 37.803     | 54.082     | 70.175     | 214.9 | 18.26
Neigh   | 0.91477    | 0.92645    | 0.93792    |   0.9 |  0.31
Comm    | 23.172     | 38.61      | 54.498     | 246.9 | 13.03
Output  | 0.27139    | 0.27158    | 0.27183    |   0.0 |  0.09
Modify  | 140.4      | 160.82     | 181.65     | 155.6 | 54.29
Other   |            | 41.5       |            |       | 14.01

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019048147    2.9030295e-16  0              0.057144442    819780.74      0              3.9584278e+13  1.6929675e-13  0              3.3302853    
    200000   6000           100            100            0.0065273953   2.9030295e-16  0              0.019582186    189562.67      0              9.1533028e+12  1.6929675e-13  0              3.0807168    
    300000   6000           100            100            8.3886045e-05  2.9030295e-16  0              0.00025165813  69.375954      0              3.3499166e+09  1.6929675e-13  0              3.0445142    
    400000   6000           100            100            0.0002734505   2.9030295e-16  0              0.00082035151  720.38772      0              3.4784945e+10  1.6929675e-13  0              3.0054792    
    500000   6000           100            100            0.025284847    0.0065244052   0              0.069330135    2057.5964      0              9.9353965e+10  1.6929675e-13  0              2.9945449    
    600000   6000           100            100            0.022356702    0.0070585363   0              0.06001157     227.13807      0              1.0967685e+10  1.6929675e-13  0              2.9948908    
    700000   6000           100            100            0.026610843    0.0067976654   0              0.073034863    34.693218      0              1.6752113e+09  1.6929675e-13  0              2.9943497    
    800000   6000           100            100            0.026988903    0.007221093    0              0.073745617    1.1679655      0              56396876       1.6929675e-13  0              2.9943167    
    900000   6000           100            100            0.026362189    0.0072338087   0              0.071852759    0.0614998      0              2969605.2      1.6929675e-13  0              2.9943885    
   1000000   6000           100            100            0.026031687    0.0072678997   0              0.07082716     0.071277479    0              3441734.4      1.6929675e-13  0              2.9944286    
   1100000   6000           100            100            0.025940926    0.0072618411   0              0.070560936    0.010724709    0              517857.81      1.6929675e-13  0              2.9944393    
   1200000   6000           100            100            0.025940925    0.0072617853   0              0.07056099     0.00030310767  0              14635.985      1.6929675e-13  0              2.9944394    
   1300000   6000           100            100            0.025953126    0.0072625498   0              0.070596828    2.4694801e-05  0              1192.4236      1.6929675e-13  0              2.994438     
   1400000   6000           100            100            0.025959409    0.0072629535   0              0.070615273    2.4004272e-05  0              1159.0804      1.6929675e-13  0              2.9944372    
   1500000   6000           100            100            0.025961001    0.007263058    0              0.070619945    3.4336449e-06  0              165.79842      1.6929675e-13  0              2.9944371    
   1600000   6000           100            100            0.025960975    0.0072630574   0              0.070619869    8.6815032e-08  0              4.1919872      1.6929675e-13  0              2.9944371    
   1700000   6000           100            100            0.025960748    0.007263043    0              0.070619201    9.5247553e-09  0              0.45991635     1.6929675e-13  0              2.9944371    
   1800000   6000           100            100            0.025960634    0.0072630357   0              0.070618868    8.0738831e-09  0              0.38985892     1.6929675e-13  0              2.9944371    
   1900000   6000           100            100            0.025960607    0.0072630338   0              0.070618786    1.096654e-09   0              0.052953495    1.6929675e-13  0              2.9944371    
   2000000   6000           100            100            0.025960608    0.0072630339   0              0.070618789    2.4569597e-11  0              0.0011863779   1.6929675e-13  0              2.9944371    
   2100000   6000           100            100            0.025960612    0.0072630342   0              0.070618801    3.6213667e-12  0              0.00017486284  1.6929675e-13  0              2.9944371    
   2200000   6000           100            100            0.025960614    0.0072630343   0              0.070618807    2.7093697e-12  0              0.00013082577  1.6929675e-13  0              2.9944371    
   2300000   6000           100            100            0.025960614    0.0072630343   0              0.070618809    3.4925766e-13  0              1.6864402e-05  1.6929675e-13  0              2.9944371    
   2400000   6000           100            100            0.025960614    0.0072630343   0              0.070618809    7.0050413e-15  0              3.3824837e-07  1.6929675e-13  0              2.9944371    
   2500000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    1.3080573e-15  0              6.3161405e-08  1.6929675e-13  0              2.9944371    
   2600000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    8.8753099e-16  0              4.2855695e-08  1.6929675e-13  0              2.9944371    
   2700000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    8.5363868e-17  0              4.1219157e-09  1.6929675e-13  0              2.9944371    
   2800000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    8.0458531e-19  0              3.8850545e-11  1.6929675e-13  0              2.9944371    
   2900000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    7.4133928e-18  0              3.5796621e-10  1.6929675e-13  0              2.9944371    
   3000000   6000           100            100            0.025960614    0.0072630343   0              0.070618808    6.0014237e-18  0              2.8978727e-10  1.6929675e-13  0              2.9944371    
Loop time of 294.188 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8810707.299 ns/day, 0.000 hours/ns, 10197.578 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 35.53      | 51.271     | 67.547     | 217.3 | 17.43
Neigh   | 0.933      | 0.94342    | 0.95416    |   0.8 |  0.32
Comm    | 22.908     | 38.197     | 53.934     | 238.7 | 12.98
Output  | 0.27027    | 0.27049    | 0.27072    |   0.0 |  0.09
Modify  | 140.79     | 161.37     | 182.15     | 159.3 | 54.85
Other   |            | 42.14      |            |       | 14.32

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.01906807     2.9030295e-16  0              0.057204211    821058.42      0              3.9645973e+13  1.6929675e-13  0              3.3296102    
    200000   6000           100            100            0.0065727481   2.9030295e-16  0              0.019718244    191629.33      0              9.2530947e+12  1.6929675e-13  0              3.0795748    
    300000   6000           100            100            0.00015215557  2.9030295e-16  0              0.00045646671  223.7751       0              1.0805299e+10  1.6929675e-13  0              3.0448184    
    400000   6000           100            100            0.0004487536   2.9030295e-16  0              0.0013462608   1870.7233      0              9.0330533e+10  1.6929675e-13  0              3.0049229    
    500000   6000           100            100            0.057671905    0.019016388    0              0.15399933     82.609533      0              3.9889187e+09  1.6929675e-13  0              2.992051     
    600000   6000           100            100            0.031051799    0.0082972009   0              0.084858196    205.97614      0              9.9458505e+09  1.6929675e-13  0              2.9940813    
    700000   6000           100            100            0.022694904    0.0068802121   0              0.061204499    1.7932906      0              86591585       1.6929675e-13  0              2.9949864    
    800000   6000           100            100            0.02740949     0.0081684334   0              0.074060038    0.61133849     0              29519348       1.6929675e-13  0              2.994485     
    900000   6000           100            100            0.025949017    0.0080630596   0              0.069783993    0.41083668     0              19837833       1.6929675e-13  0              2.9946447    
   1000000   6000           100            100            0.026252135    0.0080616305   0              0.070694775    0.088987936    0              4296909        1.6929675e-13  0              2.994611     
   1100000   6000           100            100            0.026248649    0.0080569444   0              0.070689002    0.010461514    0              505149.06      1.6929675e-13  0              2.9946108    
   1200000   6000           100            100            0.026209054    0.0080557914   0              0.070571371    0.00061091508  0              29498.903      1.6929675e-13  0              2.9946154    
   1300000   6000           100            100            0.026235117    0.0080585575   0              0.070646793    3.6843059e-06  0              177.90195      1.6929675e-13  0              2.9946125    
   1400000   6000           100            100            0.02622406     0.0080573829   0              0.070614798    4.4445155e-06  0              214.60975      1.6929675e-13  0              2.9946137    
   1500000   6000           100            100            0.026227563    0.0080577491   0              0.07062494     2.5443686e-06  0              122.85845      1.6929675e-13  0              2.9946133    
   1600000   6000           100            100            0.026226829    0.0080576738   0              0.070622812    5.2982269e-07  0              25.583241      1.6929675e-13  0              2.9946134    
   1700000   6000           100            100            0.026226823    0.0080576722   0              0.070622797    6.1007367e-08  0              2.9458274      1.6929675e-13  0              2.9946134    
   1800000   6000           100            100            0.026226925    0.0080576833   0              0.070623093    3.4467051e-09  0              0.16642905     1.6929675e-13  0              2.9946134    
   1900000   6000           100            100            0.026226861    0.0080576765   0              0.070622907    1.601438e-11   0              0.00077327708  1.6929675e-13  0              2.9946134    
   2000000   6000           100            100            0.026226888    0.0080576793   0              0.070622985    2.872547e-11   0              0.0013870501   1.6929675e-13  0              2.9946134    
   2100000   6000           100            100            0.02622688     0.0080576785   0              0.070622961    1.5496881e-11  0              0.00074828891  1.6929675e-13  0              2.9946134    
   2200000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    3.1530624e-12  0              0.0001522501   1.6929675e-13  0              2.9946134    
   2300000   6000           100            100            0.026226882    0.0080576786   0              0.070622966    3.5584499e-13  0              1.7182481e-05  1.6929675e-13  0              2.9946134    
   2400000   6000           100            100            0.026226881    0.0080576786   0              0.070622965    1.931823e-14   0              9.328082e-07   1.6929675e-13  0              2.9946134    
   2500000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    7.6943981e-17  0              3.7153495e-09  1.6929675e-13  0              2.9946134    
   2600000   6000           100            100            0.026226881    0.0080576786   0              0.070622965    1.7551474e-16  0              8.4749787e-09  1.6929675e-13  0              2.9946134    
   2700000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    5.7902898e-17  0              2.7959237e-09  1.6929675e-13  0              2.9946134    
   2800000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    8.360906e-18   0              4.0371823e-10  1.6929675e-13  0              2.9946134    
   2900000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    9.0442404e-18  0              4.36714e-10    1.6929675e-13  0              2.9946134    
   3000000   6000           100            100            0.026226881    0.0080576786   0              0.070622966    1.4839107e-18  0              7.1652739e-11  1.6929675e-13  0              2.9946134    
Loop time of 288.943 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8970622.442 ns/day, 0.000 hours/ns, 10382.665 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.992     | 50.45      | 65.753     | 214.8 | 17.46
Neigh   | 0.9403     | 0.95016    | 0.9601     |   0.7 |  0.33
Comm    | 22.328     | 37.193     | 52.109     | 241.8 | 12.87
Output  | 0.26959    | 0.26978    | 0.27002    |   0.0 |  0.09
Modify  | 139.51     | 159.31     | 179.54     | 155.6 | 55.14
Other   |            | 40.77      |            |       | 14.11

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019086388    2.9030295e-16  0              0.057259165    822233.89      0              3.9702732e+13  1.6929675e-13  0              3.328988     
    200000   6000           100            100            0.0066144916   2.9030295e-16  0              0.019843475    193537.77      0              9.3452463e+12  1.6929675e-13  0              3.0785158    
    300000   6000           100            100            0.00021554764  2.9030295e-16  0              0.00064664292  442.31718      0              2.1357914e+10  1.6929675e-13  0              3.0450435    
    400000   6000           100            100            0.00061284295  2.9030295e-16  0              0.0018385289   3380.2637      0              1.6322084e+11  1.6929675e-13  0              3.0040804    
    500000   6000           100            100            0.036949279    0.0083509206   0              0.10249692     1777.1654      0              8.5812956e+10  1.6929675e-13  0              2.9936679    
    600000   6000           100            100            0.018545988    0.0071376025   0              0.048500361    78.232371      0              3.7775612e+09  1.6929675e-13  0              2.995679     
    700000   6000           100            100            0.026411521    0.0082613601   0              0.070973204    37.985365      0              1.8341773e+09  1.6929675e-13  0              2.9947544    
    800000   6000           100            100            0.027265894    0.0079782707   0              0.073819413    1.4233427      0              68728126       1.6929675e-13  0              2.9946586    
    900000   6000           100            100            0.025677836    0.007554413    0              0.069479096    0.18951071     0              9150794.2      1.6929675e-13  0              2.9948169    
   1000000   6000           100            100            0.026082919    0.0076768738   0              0.070571883    0.091309329    0              4409000.7      1.6929675e-13  0              2.9947756    
   1100000   6000           100            100            0.026161632    0.0076854632   0              0.070799432    0.0014523373   0              70128.169      1.6929675e-13  0              2.9947676    
   1200000   6000           100            100            0.026085335    0.0076768551   0              0.070579149    0.00081554134  0              39379.572      1.6929675e-13  0              2.9947757    
   1300000   6000           100            100            0.026099052    0.0076785113   0              0.070618645    0.00020158179  0              9733.6632      1.6929675e-13  0              2.9947742    
   1400000   6000           100            100            0.026104971    0.0076791836   0              0.07063573     4.4423399e-07  0              21.45047       1.6929675e-13  0              2.9947736    
   1500000   6000           100            100            0.026101246    0.0076787484   0              0.07062499     2.8854946e-06  0              139.33021      1.6929675e-13  0              2.994774     
   1600000   6000           100            100            0.026101633    0.0076787962   0              0.070626102    3.9584958e-07  0              19.11416       1.6929675e-13  0              2.9947739    
   1700000   6000           100            100            0.026102011    0.0076788396   0              0.070627194    8.2574995e-10  0              0.03987251     1.6929675e-13  0              2.9947739    
   1800000   6000           100            100            0.026101839    0.0076788194   0              0.070626697    8.7947162e-09  0              0.42466537     1.6929675e-13  0              2.9947739    
   1900000   6000           100            100            0.026101843    0.00767882     0              0.070626708    6.7175485e-10  0              0.032436638    1.6929675e-13  0              2.9947739    
   2000000   6000           100            100            0.026101865    0.0076788225   0              0.070626772    1.9242125e-11  0              0.00092913337  1.6929675e-13  0              2.9947739    
   2100000   6000           100            100            0.026101857    0.0076788216   0              0.07062675     2.3821983e-11  0              0.0011502783   1.6929675e-13  0              2.9947739    
   2200000   6000           100            100            0.026101857    0.0076788216   0              0.070626748    9.2209754e-13  0              4.452479e-05   1.6929675e-13  0              2.9947739    
   2300000   6000           100            100            0.026101858    0.0076788217   0              0.070626752    1.2353686e-13  0              5.965153e-06   1.6929675e-13  0              2.9947739    
   2400000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    5.789899e-14   0              2.795735e-06   1.6929675e-13  0              2.9947739    
   2500000   6000           100            100            0.026101857    0.0076788217   0              0.070626751    7.7468017e-16  0              3.7406533e-08  1.6929675e-13  0              2.9947739    
   2600000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    5.4164174e-16  0              2.6153941e-08  1.6929675e-13  0              2.9947739    
   2700000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    9.796476e-17   0              4.7303677e-09  1.6929675e-13  0              2.9947739    
   2800000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    2.2565969e-18  0              1.0896299e-10  1.6929675e-13  0              2.9947739    
   2900000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    9.5714642e-18  0              4.6217175e-10  1.6929675e-13  0              2.9947739    
   3000000   6000           100            100            0.026101858    0.0076788217   0              0.070626751    2.5882305e-19  0              1.2497639e-11  1.6929675e-13  0              2.9947739    
Loop time of 289.085 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8966236.201 ns/day, 0.000 hours/ns, 10377.588 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.563     | 50.062     | 65.352     | 215.5 | 17.32
Neigh   | 0.90375    | 0.91356    | 0.92363    |   0.8 |  0.32
Comm    | 22.351     | 37.21      | 52.228     | 241.6 | 12.87
Output  | 0.31758    | 0.31777    | 0.318      |   0.0 |  0.11
Modify  | 139.84     | 159.71     | 179.92     | 155.9 | 55.25
Other   |            | 40.87      |            |       | 14.14

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019103314    2.9030295e-16  0              0.057309942    823320.64      0              3.9755207e+13  1.6929675e-13  0              3.3284118    
    200000   6000           100            100            0.0066531026   2.9030295e-16  0              0.019959308    195308.29      0              9.4307384e+12  1.6929675e-13  0              3.0775297    
    300000   6000           100            100            0.00027464791  2.9030295e-16  0              0.00082394372  708.76631      0              3.4223789e+10  1.6929675e-13  0              3.0452053    
    400000   6000           100            100            0.0007667726   2.9030295e-16  0              0.0023003178   5145.0378      0              2.4843546e+11  1.6929675e-13  0              3.0030274    
    500000   6000           100            100            0.010850635    0.0050086336   0              0.027543271    1294.0493      0              6.248501e+10   1.6929675e-13  0              2.9967632    
    600000   6000           100            100            0.036242841    0.0079851744   0              0.10074335     0.53712045     0              25935624       1.6929675e-13  0              2.9939345    
    700000   6000           100            100            0.029276865    0.0084248648   0              0.07940573     12.314801      0              5.9463769e+08  1.6929675e-13  0              2.9946186    
    800000   6000           100            100            0.026720262    0.0075954328   0              0.072565353    3.8862704      0              1.8765409e+08  1.6929675e-13  0              2.994854     
    900000   6000           100            100            0.026092833    0.0075094424   0              0.070769058    0.69083641     0              33358018       1.6929675e-13  0              2.9949168    
   1000000   6000           100            100            0.025975895    0.0074594508   0              0.070468233    0.083772348    0              4045066.9      1.6929675e-13  0              2.994927     
   1100000   6000           100            100            0.025989964    0.0074661286   0              0.070503764    0.0067435833   0              325623.5       1.6929675e-13  0              2.9949255    
   1200000   6000           100            100            0.026013012    0.0074717869   0              0.07056725     0.00025935575  0              12523.361      1.6929675e-13  0              2.9949231    
   1300000   6000           100            100            0.026026008    0.007473002    0              0.070605023    6.5583365e-08  0              3.166786       1.6929675e-13  0              2.9949218    
   1400000   6000           100            100            0.026031777    0.007473527    0              0.070621803    5.4713688e-06  0              264.19282      1.6929675e-13  0              2.9949212    
   1500000   6000           100            100            0.026033895    0.0074737169   0              0.070627967    2.3515963e-06  0              113.55017      1.6929675e-13  0              2.9949209    
   1600000   6000           100            100            0.026034538    0.007473774    0              0.070629841    5.0858372e-07  0              24.557688      1.6929675e-13  0              2.9949209    
   1700000   6000           100            100            0.026034685    0.0074737867   0              0.070630268    7.3806634e-08  0              3.5638582      1.6929675e-13  0              2.9949209    
   1800000   6000           100            100            0.026034696    0.0074737876   0              0.070630302    7.4196882e-09  0              0.35827019     1.6929675e-13  0              2.9949209    
   1900000   6000           100            100            0.026034684    0.0074737865   0              0.070630267    4.4862465e-10  0              0.021662479    1.6929675e-13  0              2.9949209    
   2000000   6000           100            100            0.026034675    0.0074737856   0              0.070630239    6.7916484e-12  0              0.00032794439  1.6929675e-13  0              2.9949209    
   2100000   6000           100            100            0.02603467     0.0074737852   0              0.070630225    1.2182137e-12  0              5.8823177e-05  1.6929675e-13  0              2.9949209    
   2200000   6000           100            100            0.026034668    0.007473785    0              0.070630219    1.1896003e-12  0              5.7441539e-05  1.6929675e-13  0              2.9949209    
   2300000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    3.3918687e-13  0              1.637812e-05   1.6929675e-13  0              2.9949209    
   2400000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    5.9407082e-14  0              2.8685554e-06  1.6929675e-13  0              2.9949209    
   2500000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    7.1573672e-15  0              3.4560365e-07  1.6929675e-13  0              2.9949209    
   2600000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    5.4727617e-16  0              2.6426008e-08  1.6929675e-13  0              2.9949209    
   2700000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    2.9448286e-17  0              1.4219523e-09  1.6929675e-13  0              2.9949209    
   2800000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    2.7066015e-18  0              1.306921e-10   1.6929675e-13  0              2.9949209    
   2900000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    8.0479615e-19  0              3.8860726e-11  1.6929675e-13  0              2.9949209    
   3000000   6000           100            100            0.026034667    0.0074737849   0              0.070630217    5.4632621e-18  0              2.6380137e-10  1.6929675e-13  0              2.9949209    
Loop time of 289.492 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8953614.771 ns/day, 0.000 hours/ns, 10362.980 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.924     | 50.401     | 65.874     | 215.3 | 17.41
Neigh   | 0.90783    | 0.91776    | 0.92889    |   0.8 |  0.32
Comm    | 22.008     | 37.193     | 52.081     | 243.3 | 12.85
Output  | 0.27014    | 0.27033    | 0.27055    |   0.0 |  0.09
Modify  | 139.24     | 159.24     | 179.98     | 157.8 | 55.01
Other   |            | 41.47      |            |       | 14.33

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019119022    2.9030295e-16  0              0.057357066    824329.74      0              3.9803933e+13  1.6929675e-13  0              3.327876     
    200000   6000           100            100            0.0066889717   2.9030295e-16  0              0.020066915    196957.64      0              9.5103794e+12  1.6929675e-13  0              3.0766079    
    300000   6000           100            100            0.00032994397  2.9030295e-16  0              0.00098983192  1010.9499      0              4.8815155e+10  1.6929675e-13  0              3.045316     
    400000   6000           100            100            0.00091149431  2.9030295e-16  0              0.0027344829   7089.5392      0              3.4232848e+11  1.6929675e-13  0              3.0018196    
    500000   6000           100            100            0.0039516153   0.0021399172   0              0.0097149288   2.9187318      0              1.4093511e+08  1.6929675e-13  0              2.9981496    
    600000   6000           100            100            0.018232801    0.0067401515   0              0.047958251    93.113872      0              4.4961357e+09  1.6929675e-13  0              2.9959117    
    700000   6000           100            100            0.022474362    0.0067524514   0              0.060670635    2.5307435      0              1.2220054e+08  1.6929675e-13  0              2.9954188    
    800000   6000           100            100            0.025670565    0.0071923014   0              0.069819395    5.0075617      0              2.4179723e+08  1.6929675e-13  0              2.9950869    
    900000   6000           100            100            0.026316381    0.0071700725   0              0.071779071    0.25622161     0              12372025       1.6929675e-13  0              2.9950167    
   1000000   6000           100            100            0.026086778    0.0071728803   0              0.071087454    0.022456491    0              1084343.6      1.6929675e-13  0              2.9950401    
   1100000   6000           100            100            0.025926944    0.0071660405   0              0.07061479     0.012705364    0              613496.56      1.6929675e-13  0              2.9950566    
   1200000   6000           100            100            0.025910578    0.007164917    0              0.070566816    0.00018102029  0              8740.8221      1.6929675e-13  0              2.9950583    
   1300000   6000           100            100            0.025927345    0.0071659844   0              0.070616049    0.00012455076  0              6014.1105      1.6929675e-13  0              2.9950567    
   1400000   6000           100            100            0.02593455     0.0071664561   0              0.070637195    2.6394987e-05  0              1274.5194      1.6929675e-13  0              2.9950559    
   1500000   6000           100            100            0.025934441    0.0071664524   0              0.07063687     8.4851677e-10  0              0.040971838    1.6929675e-13  0              2.9950559    
   1600000   6000           100            100            0.025933438    0.0071663877   0              0.070633928    4.6619709e-07  0              22.510989      1.6929675e-13  0              2.995056     
   1700000   6000           100            100            0.025933154    0.007166369    0              0.070633094    4.3024958e-08  0              2.0775212      1.6929675e-13  0              2.995056     
   1800000   6000           100            100            0.025933205    0.0071663721   0              0.070633242    9.0436042e-10  0              0.043668328    1.6929675e-13  0              2.995056     
   1900000   6000           100            100            0.025933258    0.0071663755   0              0.070633398    1.3601966e-09  0              0.065679027    1.6929675e-13  0              2.995056     
   2000000   6000           100            100            0.025933267    0.0071663761   0              0.070633425    4.8228721e-11  0              0.0023287923   1.6929675e-13  0              2.995056     
   2100000   6000           100            100            0.025933263    0.0071663758   0              0.070633412    8.3745017e-12  0              0.00040437472  1.6929675e-13  0              2.995056     
   2200000   6000           100            100            0.02593326     0.0071663757   0              0.070633404    3.230461e-12   0              0.0001559874   1.6929675e-13  0              2.995056     
   2300000   6000           100            100            0.02593326     0.0071663757   0              0.070633404    2.1531531e-14  0              1.0396806e-06  1.6929675e-13  0              2.995056     
   2400000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    3.9006257e-14  0              1.8834726e-06  1.6929675e-13  0              2.995056     
   2500000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    6.2565973e-15  0              3.0210869e-07  1.6929675e-13  0              2.995056     
   2600000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    5.5356631e-18  0              2.6729736e-10  1.6929675e-13  0              2.995056     
   2700000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    1.3643325e-16  0              6.5878733e-09  1.6929675e-13  0              2.995056     
   2800000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    1.1969114e-18  0              5.7794566e-11  1.6929675e-13  0              2.995056     
   2900000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    5.7859899e-18  0              2.7938475e-10  1.6929675e-13  0              2.995056     
   3000000   6000           100            100            0.02593326     0.0071663757   0              0.070633405    6.221772e-18   0              3.004271e-10   1.6929675e-13  0              2.995056     
Loop time of 290.475 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8923311.698 ns/day, 0.000 hours/ns, 10327.907 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.978     | 50.718     | 66.279     | 218.2 | 17.46
Neigh   | 0.90206    | 0.91364    | 0.92529    |   0.9 |  0.31
Comm    | 22.812     | 37.869     | 53.276     | 243.2 | 13.04
Output  | 0.27126    | 0.27144    | 0.27165    |   0.0 |  0.09
Modify  | 140.03     | 159.75     | 179.89     | 153.8 | 55.00
Other   |            | 40.95      |            |       | 14.10

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019133658    2.9030295e-16  0              0.057400973    825270.43      0              3.9849355e+13  1.6929675e-13  0              3.3273758    
    200000   6000           100            100            0.0067224235   2.9030295e-16  0              0.02016727     198499.77      0              9.5848436e+12  1.6929675e-13  0              3.0757432    
    300000   6000           100            100            0.0003818468   2.9030295e-16  0              0.0011455404   1339.6337      0              6.4686118e+10  1.6929675e-13  0              3.0453852    
    400000   6000           100            100            0.0010478571   2.9030295e-16  0              0.0031435714   9158.2805      0              4.4222059e+11  1.6929675e-13  0              3.0004989    
    500000   6000           100            100            0.0078983639   0.0023712043   0              0.021323887    998.78078      0              4.8227549e+10  1.6929675e-13  0              2.9974036    
    600000   6000           100            100            0.026791262    0.0078569229   0              0.072516863    297.02058      0              1.4342061e+10  1.6929675e-13  0              2.995135     
    700000   6000           100            100            0.02818969     0.0076177145   0              0.076951357    26.230783      0              1.2665906e+09  1.6929675e-13  0              2.9949656    
    800000   6000           100            100            0.024731765    0.0072052991   0              0.066989996    0.68684699     0              33165383       1.6929675e-13  0              2.9953074    
    900000   6000           100            100            0.026517693    0.0074790959   0              0.072073984    0.018804508    0              908002.41      1.6929675e-13  0              2.9951323    
   1000000   6000           100            100            0.0258742      0.007392678    0              0.070229921    0.040856438    0              1972811.2      1.6929675e-13  0              2.9951945    
   1100000   6000           100            100            0.026034633    0.0074062677   0              0.070697631    0.011773051    0              568478.48      1.6929675e-13  0              2.9951789    
   1200000   6000           100            100            0.026019256    0.0074050921   0              0.070652676    0.0016504407   0              79693.876      1.6929675e-13  0              2.9951803    
   1300000   6000           100            100            0.0260073      0.0074040279   0              0.070617871    0.00011680125  0              5639.9141      1.6929675e-13  0              2.9951815    
   1400000   6000           100            100            0.026016854    0.0074048535   0              0.070645708    1.670096e-06   0              80.642959      1.6929675e-13  0              2.9951805    
   1500000   6000           100            100            0.026012487    0.0074044808   0              0.070632981    4.1791764e-07  0              20.179747      1.6929675e-13  0              2.995181     
   1600000   6000           100            100            0.026013933    0.0074046029   0              0.070637195    3.3448397e-07  0              16.151034      1.6929675e-13  0              2.9951808    
   1700000   6000           100            100            0.026013616    0.0074045767   0              0.070636272    7.5488931e-08  0              3.6450903      1.6929675e-13  0              2.9951808    
   1800000   6000           100            100            0.02601362     0.0074045767   0              0.070636282    8.8388941e-09  0              0.42679856     1.6929675e-13  0              2.9951808    
   1900000   6000           100            100            0.02601366     0.0074045802   0              0.0706364      4.7633842e-10  0              0.023000677    1.6929675e-13  0              2.9951808    
   2000000   6000           100            100            0.026013634    0.007404578    0              0.070636325    9.949268e-13   0              4.8041454e-05  1.6929675e-13  0              2.9951808    
   2100000   6000           100            100            0.026013645    0.0074045789   0              0.070636356    5.3542948e-12  0              0.00025853974  1.6929675e-13  0              2.9951808    
   2200000   6000           100            100            0.026013642    0.0074045787   0              0.070636347    2.5012916e-12  0              0.00012077842  1.6929675e-13  0              2.9951808    
   2300000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    4.5957176e-13  0              2.2191076e-05  1.6929675e-13  0              2.9951808    
   2400000   6000           100            100            0.026013642    0.0074045787   0              0.070636349    4.4756199e-14  0              2.1611167e-06  1.6929675e-13  0              2.9951808    
   2500000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    1.7363475e-15  0              8.3842006e-08  1.6929675e-13  0              2.9951808    
   2600000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    1.008276e-17   0              4.8686039e-10  1.6929675e-13  0              2.9951808    
   2700000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    3.8361611e-17  0              1.8523449e-09  1.6929675e-13  0              2.9951808    
   2800000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    7.3069116e-18  0              3.5282461e-10  1.6929675e-13  0              2.9951808    
   2900000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    2.1173661e-18  0              1.0224003e-10  1.6929675e-13  0              2.9951808    
   3000000   6000           100            100            0.026013642    0.0074045787   0              0.070636348    2.6207787e-18  0              1.2654803e-10  1.6929675e-13  0              2.9951808    
Loop time of 291.692 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8886100.330 ns/day, 0.000 hours/ns, 10284.838 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.685     | 50.167     | 66.017     | 216.1 | 17.20
Neigh   | 0.90802    | 0.91932    | 0.93111    |   0.9 |  0.32
Comm    | 22.497     | 37.418     | 52.838     | 238.7 | 12.83
Output  | 0.27037    | 0.27056    | 0.27078    |   0.0 |  0.09
Modify  | 139.83     | 160.97     | 181.71     | 161.8 | 55.19
Other   |            | 41.95      |            |       | 14.38

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019147343    2.9030295e-16  0              0.057442029    826150.43      0              3.9891847e+13  1.6929675e-13  0              3.3269073    
    200000   6000           100            100            0.0067537278   2.9030295e-16  0              0.020261183    199946.33      0              9.6546929e+12  1.6929675e-13  0              3.0749298    
    300000   6000           100            100            0.00043070314  2.9030295e-16  0              0.0012921094   1687.7213      0              8.1494021e+10  1.6929675e-13  0              3.0454202    
    400000   6000           100            100            0.0020600263   7.8818081e-05  0              0.0061012608   11294.279      0              5.4536032e+11  1.6929675e-13  0              2.999097     
    500000   6000           100            100            0.026192531    0.006851598    0              0.071725996    2235.8901      0              1.0796313e+11  1.6929675e-13  0              2.9953099    
    600000   6000           100            100            0.033367785    0.0082802838   0              0.091823071    162.68689      0              7.8555678e+09  1.6929675e-13  0              2.994628     
    700000   6000           100            100            0.025575839    0.0078423916   0              0.068885125    39.144034      0              1.8901253e+09  1.6929675e-13  0              2.9953616    
    800000   6000           100            100            0.025084191    0.0073213779   0              0.067931196    2.9787226      0              1.4383185e+08  1.6929675e-13  0              2.9953857    
    900000   6000           100            100            0.026483922    0.0073317931   0              0.072119974    0.0014990925   0              72385.812      1.6929675e-13  0              2.9952477    
   1000000   6000           100            100            0.0258749      0.0073056348   0              0.070319066    0.062863718    0              3035463.9      1.6929675e-13  0              2.9953075    
   1100000   6000           100            100            0.025967444    0.0073143179   0              0.070588014    0.012355001    0              596578.77      1.6929675e-13  0              2.9952982    
   1200000   6000           100            100            0.026007708    0.0073173425   0              0.070705783    0.00030389747  0              14674.121      1.6929675e-13  0              2.9952944    
   1300000   6000           100            100            0.025976743    0.0073149546   0              0.070615274    4.8372306e-05  0              2335.7255      1.6929675e-13  0              2.9952974    
   1400000   6000           100            100            0.025985536    0.007315566    0              0.070641043    3.0732828e-05  0              1483.9783      1.6929675e-13  0              2.9952966    
   1500000   6000           100            100            0.02598565     0.0073155688   0              0.070641381    2.5974975e-06  0              125.42386      1.6929675e-13  0              2.9952966    
   1600000   6000           100            100            0.025984414    0.0073154859   0              0.070637756    3.0912668e-11  0              0.0014926621   1.6929675e-13  0              2.9952967    
   1700000   6000           100            100            0.025984967    0.0073155236   0              0.070639377    4.8192922e-08  0              2.3270637      1.6929675e-13  0              2.9952966    
   1800000   6000           100            100            0.025984879    0.0073155175   0              0.07063912     1.0030707e-08  0              0.48434695     1.6929675e-13  0              2.9952966    
   1900000   6000           100            100            0.025984845    0.0073155152   0              0.07063902     2.7156118e-10  0              0.013112717    1.6929675e-13  0              2.9952966    
   2000000   6000           100            100            0.025984873    0.0073155171   0              0.070639101    3.4917696e-11  0              0.0016860506   1.6929675e-13  0              2.9952966    
   2100000   6000           100            100            0.025984865    0.0073155165   0              0.070639077    2.4345965e-11  0              0.0011755795   1.6929675e-13  0              2.9952966    
   2200000   6000           100            100            0.025984865    0.0073155165   0              0.070639077    2.1681404e-12  0              0.00010469174  1.6929675e-13  0              2.9952966    
   2300000   6000           100            100            0.025984866    0.0073155166   0              0.07063908     1.560439e-16   0              7.5348017e-09  1.6929675e-13  0              2.9952966    
   2400000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    3.7078879e-14  0              1.7904064e-06  1.6929675e-13  0              2.9952966    
   2500000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    8.1482892e-15  0              3.9345172e-07  1.6929675e-13  0              2.9952966    
   2600000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    2.51963e-16    0              1.2166391e-08  1.6929675e-13  0              2.9952966    
   2700000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    3.1033091e-17  0              1.4984769e-09  1.6929675e-13  0              2.9952966    
   2800000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    1.8822867e-17  0              9.0888888e-10  1.6929675e-13  0              2.9952966    
   2900000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    3.5878389e-18  0              1.732439e-10   1.6929675e-13  0              2.9952966    
   3000000   6000           100            100            0.025984865    0.0073155166   0              0.070639079    2.5920684e-18  0              1.2516171e-10  1.6929675e-13  0              2.9952966    
Loop time of 290.507 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8922340.221 ns/day, 0.000 hours/ns, 10326.783 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 35.011     | 50.234     | 65.921     | 213.4 | 17.29
Neigh   | 0.93188    | 0.94164    | 0.95185    |   0.7 |  0.32
Comm    | 23.003     | 38.085     | 53.004     | 236.7 | 13.11
Output  | 0.2893     | 0.2895     | 0.28973    |   0.0 |  0.10
Modify  | 140.47     | 160.16     | 179.95     | 153.9 | 55.13
Other   |            | 40.8       |            |       | 14.04

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:          485.5 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019160181    2.9030295e-16  0              0.057480542    826976.29      0              3.9931725e+13  1.6929675e-13  0              3.326467     
    200000   6000           100            100            0.0067831136   2.9030295e-16  0              0.020349341    201307.26      0              9.7204071e+12  1.6929675e-13  0              3.0741624    
    300000   6000           100            100            0.00047681374  2.9030295e-16  0              0.0014304412   2049.7486      0              9.8975023e+10  1.6929675e-13  0              3.0454273    
    400000   6000           100            100            0.0079600318   0.0016341741   0              0.022245921    13216.746      0              6.3818937e+11  1.6929675e-13  0              2.9976444    
    500000   6000           100            100            0.052797129    0.011007066    0              0.14738432     797.20887      0              3.8494363e+10  1.6929675e-13  0              2.9933838    
    600000   6000           100            100            0.017327824    0.0090392519   0              0.04294422     15.377573      0              7.4252799e+08  1.6929675e-13  0              2.9964081    
    700000   6000           100            100            0.024790662    0.0063367311   0              0.068035254    38.707455      0              1.8690445e+09  1.6929675e-13  0              2.9954836    
    800000   6000           100            100            0.026887604    0.0074471602   0              0.07321565     3.300586       0              1.5937348e+08  1.6929675e-13  0              2.99532      
    900000   6000           100            100            0.026455179    0.0072151447   0              0.072150392    0.0011258835   0              54364.887      1.6929675e-13  0              2.9953558    
   1000000   6000           100            100            0.026102232    0.0072735811   0              0.071033114    0.050232278    0              2425536.9      1.6929675e-13  0              2.995392     
   1100000   6000           100            100            0.025963572    0.0072574776   0              0.070633238    0.013308446    0              642617.22      1.6929675e-13  0              2.9954048    
   1200000   6000           100            100            0.025947099    0.007256488    0              0.070584808    0.00073266908  0              35377.968      1.6929675e-13  0              2.9954063    
   1300000   6000           100            100            0.025957235    0.0072571503   0              0.070614556    4.4251967e-06  0              213.67691      1.6929675e-13  0              2.9954053    
   1400000   6000           100            100            0.025964486    0.0072576146   0              0.070635844    2.1981737e-05  0              1061.4194      1.6929675e-13  0              2.9954046    
   1500000   6000           100            100            0.025966719    0.0072577556   0              0.0706424      4.1721669e-06  0              201.45901      1.6929675e-13  0              2.9954044    
   1600000   6000           100            100            0.02596685     0.0072577629   0              0.070642786    1.4591807e-07  0              7.0458612      1.6929675e-13  0              2.9954044    
   1700000   6000           100            100            0.025966614    0.0072577475   0              0.070642094    7.3144643e-09  0              0.3531893      1.6929675e-13  0              2.9954044    
   1800000   6000           100            100            0.025966479    0.0072577389   0              0.070641699    8.8093449e-09  0              0.42537174     1.6929675e-13  0              2.9954044    
   1900000   6000           100            100            0.025966444    0.0072577367   0              0.070641597    1.2281512e-09  0              0.059303024    1.6929675e-13  0              2.9954045    
   2000000   6000           100            100            0.025966445    0.0072577368   0              0.070641599    2.2530678e-11  0              0.0010879258   1.6929675e-13  0              2.9954045    
   2100000   6000           100            100            0.02596645     0.0072577371   0              0.070641614    5.588246e-12   0              0.0002698364   1.6929675e-13  0              2.9954045    
   2200000   6000           100            100            0.025966453    0.0072577373   0              0.070641621    3.2829382e-12  0              0.00015852134  1.6929675e-13  0              2.9954045    
   2300000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    3.3789149e-13  0              1.6315571e-05  1.6929675e-13  0              2.9954045    
   2400000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    2.0212897e-15  0              9.7600845e-08  1.6929675e-13  0              2.9954045    
   2500000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    3.1411571e-15  0              1.5167523e-07  1.6929675e-13  0              2.9954045    
   2600000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    1.1481376e-15  0              5.5439457e-08  1.6929675e-13  0              2.9954045    
   2700000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    7.6877025e-17  0              3.7121164e-09  1.6929675e-13  0              2.9954045    
   2800000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    4.3656586e-19  0              2.1080203e-11  1.6929675e-13  0              2.9954045    
   2900000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    9.7490941e-18  0              4.7074886e-10  1.6929675e-13  0              2.9954045    
   3000000   6000           100            100            0.025966453    0.0072577373   0              0.070641622    4.2232966e-18  0              2.0392788e-10  1.6929675e-13  0              2.9954045    
Loop time of 290.36 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8926838.355 ns/day, 0.000 hours/ns, 10331.989 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.535     | 50.329     | 66.714     | 217.0 | 17.33
Neigh   | 0.90147    | 0.91207    | 0.92321    |   0.8 |  0.31
Comm    | 22.372     | 37.662     | 53.557     | 236.4 | 12.97
Output  | 0.26879    | 0.269      | 0.26924    |   0.0 |  0.09
Modify  | 139.42     | 159.95     | 180.06     | 153.7 | 55.09
Other   |            | 41.24      |            |       | 14.20

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019172259    2.9030295e-16  0              0.057516776    827753.57      0              3.9969257e+13  1.6929675e-13  0              3.3260522    
    200000   6000           100            100            0.0068107775   2.9030295e-16  0              0.020432333    202591.09      0              9.7823988e+12  1.6929675e-13  0              3.0734367    
    300000   6000           100            100            0.00052043996  2.9030295e-16  0              0.0015613199   2421.4822      0              1.1692471e+11  1.6929675e-13  0              3.0454112    
    400000   6000           100            100            0.020008503    0.0051448758   0              0.054880632    14400.501      0              6.9534863e+11  1.6929675e-13  0              2.9961848    
    500000   6000           100            100            0.059209013    0.013699939    0              0.1639271      227.46297      0              1.0983373e+10  1.6929675e-13  0              2.9931461    
    600000   6000           100            100            0.027764227    0.0080669892   0              0.075225692    303.21322      0              1.4641081e+10  1.6929675e-13  0              2.9953785    
    700000   6000           100            100            0.0277372      0.008177838    0              0.075033762    35.52161       0              1.7152114e+09  1.6929675e-13  0              2.9953735    
    800000   6000           100            100            0.027139547    0.0076183818   0              0.07380026     2.4666998      0              1.1910811e+08  1.6929675e-13  0              2.9954076    
    900000   6000           100            100            0.026512557    0.0073999479   0              0.072137723    0.044288372    0              2138527        1.6929675e-13  0              2.9954582    
   1000000   6000           100            100            0.026194473    0.0073922676   0              0.07119115     0.0050738771   0              244999.37      1.6929675e-13  0              2.9954877    
   1100000   6000           100            100            0.026064231    0.0073914528   0              0.070801241    0.0055442967   0              267714.24      1.6929675e-13  0              2.9955       
   1200000   6000           100            100            0.026021105    0.0073902371   0              0.070673077    0.0015389606   0              74310.899      1.6929675e-13  0              2.9955041    
   1300000   6000           100            100            0.026010614    0.0073900451   0              0.070641797    0.00024364168  0              11764.585      1.6929675e-13  0              2.9955051    
   1400000   6000           100            100            0.026009551    0.0073900101   0              0.070638642    2.4115499e-05  0              1164.4511      1.6929675e-13  0              2.9955052    
   1500000   6000           100            100            0.026010289    0.0073900725   0              0.070640795    1.2204189e-06  0              58.929661      1.6929675e-13  0              2.9955052    
   1600000   6000           100            100            0.026010918    0.0073901277   0              0.070642626    3.6091641e-09  0              0.17427362     1.6929675e-13  0              2.9955051    
   1700000   6000           100            100            0.026011229    0.0073901554   0              0.070643532    1.1997347e-08  0              0.57930894     1.6929675e-13  0              2.9955051    
   1800000   6000           100            100            0.026011347    0.0073901661   0              0.070643876    6.3379578e-09  0              0.3060373      1.6929675e-13  0              2.9955051    
   1900000   6000           100            100            0.026011383    0.0073901693   0              0.07064398     1.3863446e-09  0              0.066941619    1.6929675e-13  0              2.9955051    
   2000000   6000           100            100            0.02601139     0.00739017     0              0.070644001    1.847653e-10   0              0.0089216551   1.6929675e-13  0              2.9955051    
   2100000   6000           100            100            0.02601139     0.00739017     0              0.070644       1.4910837e-11  0              0.00071999094  1.6929675e-13  0              2.9955051    
   2200000   6000           100            100            0.026011389    0.0073901699   0              0.070643997    4.7838008e-13  0              2.3099262e-05  1.6929675e-13  0              2.9955051    
   2300000   6000           100            100            0.026011388    0.0073901698   0              0.070643995    4.5783587e-15  0              2.2107255e-07  1.6929675e-13  0              2.9955051    
   2400000   6000           100            100            0.026011388    0.0073901698   0              0.070643995    1.8752548e-14  0              9.0549341e-07  1.6929675e-13  0              2.9955051    
   2500000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    6.3299027e-15  0              3.0564835e-07  1.6929675e-13  0              2.9955051    
   2600000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    1.153561e-15   0              5.5701333e-08  1.6929675e-13  0              2.9955051    
   2700000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    1.2696116e-16  0              6.1305e-09     1.6929675e-13  0              2.9955051    
   2800000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    1.297974e-18   0              6.267452e-11   1.6929675e-13  0              2.9955051    
   2900000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    1.2439869e-19  0              6.0067674e-12  1.6929675e-13  0              2.9955051    
   3000000   6000           100            100            0.026011388    0.0073901698   0              0.070643994    5.1408901e-18  0              2.4823518e-10  1.6929675e-13  0              2.9955051    
Loop time of 288.932 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8970965.311 ns/day, 0.000 hours/ns, 10383.062 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.617     | 49.986     | 65.321     | 212.2 | 17.30
Neigh   | 0.9305     | 0.94075    | 0.95109    |   0.8 |  0.33
Comm    | 22.8       | 37.671     | 52.277     | 237.4 | 13.04
Output  | 0.26844    | 0.26863    | 0.26885    |   0.0 |  0.09
Modify  | 139.43     | 159.29     | 179.2      | 155.3 | 55.13
Other   |            | 40.77      |            |       | 14.11

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019183652    2.9030295e-16  0              0.057550955    828487.06      0              4.0004675e+13  1.6929675e-13  0              3.3256604    
    200000   6000           100            100            0.0068368895   2.9030295e-16  0              0.020510668    203805.26      0              9.8410266e+12  1.6929675e-13  0              3.0727488    
    300000   6000           100            100            0.00056180823  2.9030295e-16  0              0.0016854247   2799.611       0              1.351832e+11   1.6929675e-13  0              3.0453758    
    400000   6000           100            100            0.036965746    0.007223537    0              0.1036737      14324.574      0              6.9168242e+11  1.6929675e-13  0              2.994776     
    500000   6000           100            100            0.038096277    0.011268522    0              0.10302031     2007.0881      0              9.6915103e+10  1.6929675e-13  0              2.9946552    
    600000   6000           100            100            0.035181586    0.0077691019   0              0.097775657    105.31263      0              5.08517e+09    1.6929675e-13  0              2.994817     
    700000   6000           100            100            0.023884799    0.0066732481   0              0.064981148    31.784547      0              1.534762e+09   1.6929675e-13  0              2.9957735    
    800000   6000           100            100            0.024692233    0.0068193186   0              0.06725738     1.9250124      0              92951958       1.6929675e-13  0              2.9957072    
    900000   6000           100            100            0.026388934    0.0073811706   0              0.071785632    0.35845144     0              17308337       1.6929675e-13  0              2.9955647    
   1000000   6000           100            100            0.026092425    0.0073332584   0              0.070944016    0.073205084    0              3534811.5      1.6929675e-13  0              2.9955899    
   1100000   6000           100            100            0.025921779    0.0073163491   0              0.070448987    0.0016322457   0              78815.303      1.6929675e-13  0              2.9956054    
   1200000   6000           100            100            0.025985814    0.0073219789   0              0.070635462    0.0018001081   0              86920.777      1.6929675e-13  0              2.9955997    
   1300000   6000           100            100            0.025999189    0.0073231725   0              0.070674395    7.8591535e-07  0              37.94904       1.6929675e-13  0              2.9955985    
   1400000   6000           100            100            0.025988574    0.007322261    0              0.070643461    3.1154648e-05  0              1504.3465      1.6929675e-13  0              2.9955994    
   1500000   6000           100            100            0.025988357    0.0073222364   0              0.070642835    9.0676311e-07  0              43.784345      1.6929675e-13  0              2.9955995    
   1600000   6000           100            100            0.025989819    0.0073223633   0              0.070647094    3.7161858e-07  0              17.944131      1.6929675e-13  0              2.9955993    
   1700000   6000           100            100            0.02598963     0.0073223477   0              0.070646543    4.8049707e-08  0              2.3201484      1.6929675e-13  0              2.9955994    
   1800000   6000           100            100            0.025989462    0.0073223329   0              0.070646052    2.4391813e-09  0              0.11777934     1.6929675e-13  0              2.9955994    
   1900000   6000           100            100            0.025989512    0.0073223372   0              0.070646199    1.3608511e-09  0              0.065710628    1.6929675e-13  0              2.9955994    
   2000000   6000           100            100            0.025989527    0.0073223386   0              0.070646244    1.315198e-12   0              6.3506203e-05  1.6929675e-13  0              2.9955994    
   2100000   6000           100            100            0.025989518    0.0073223378   0              0.070646217    2.6418205e-11  0              0.0012756406   1.6929675e-13  0              2.9955994    
   2200000   6000           100            100            0.025989518    0.0073223377   0              0.070646215    3.7565916e-13  0              1.8139236e-05  1.6929675e-13  0              2.9955994    
   2300000   6000           100            100            0.025989519    0.0073223378   0              0.070646219    3.6108574e-13  0              1.7435538e-05  1.6929675e-13  0              2.9955994    
   2400000   6000           100            100            0.025989519    0.0073223378   0              0.070646219    2.9890074e-14  0              1.4432847e-06  1.6929675e-13  0              2.9955994    
   2500000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    2.923093e-15   0              1.411457e-07   1.6929675e-13  0              2.9955994    
   2600000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    9.9650741e-16  0              4.8117777e-08  1.6929675e-13  0              2.9955994    
   2700000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    1.116383e-17   0              5.3906141e-10  1.6929675e-13  0              2.9955994    
   2800000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    1.8778716e-17  0              9.0675697e-10  1.6929675e-13  0              2.9955994    
   2900000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    3.0241436e-19  0              1.4602507e-11  1.6929675e-13  0              2.9955994    
   3000000   6000           100            100            0.025989519    0.0073223378   0              0.070646218    8.4186253e-18  0              4.0650529e-10  1.6929675e-13  0              2.9955994    
Loop time of 288.769 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8976041.646 ns/day, 0.000 hours/ns, 10388.937 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.429     | 49.894     | 65.303     | 215.1 | 17.28
Neigh   | 0.90978    | 0.9203     | 0.93089    |   0.8 |  0.32
Comm    | 22.513     | 37.213     | 52.261     | 239.9 | 12.89
Output  | 0.27231    | 0.2725     | 0.27273    |   0.0 |  0.09
Modify  | 139.57     | 159.48     | 179.53     | 155.5 | 55.23
Other   |            | 40.99      |            |       | 14.19

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019194425    2.9030295e-16  0              0.057583275    829180.9       0              4.0038178e+13  1.6929675e-13  0              3.3252893    
    200000   6000           100            100            0.0068615954   2.9030295e-16  0              0.020584786    204956.16      0              9.8965993e+12  1.6929675e-13  0              3.0720952    
    300000   6000           100            100            0.00060111574  2.9030295e-16  0              0.0018033472   3181.5299      0              1.5362469e+11  1.6929675e-13  0              3.0453245    
    400000   6000           100            100            0.058641461    0.010708921    0              0.16521546     12710.041      0              6.1372238e+11  1.6929675e-13  0              2.9934852    
    500000   6000           100            100            0.016324612    0.0087307778   0              0.040243058    2005.6653      0              9.6846402e+10  1.6929675e-13  0              2.99669      
    600000   6000           100            100            0.018711558    0.0096477181   0              0.046486957    115.67182      0              5.5853782e+09  1.6929675e-13  0              2.9964867    
    700000   6000           100            100            0.028065967    0.008610742    0              0.075587159    35.193002      0              1.6993441e+09  1.6929675e-13  0              2.9955455    
    800000   6000           100            100            0.02566854     0.0075428246   0              0.069462795    5.2568353      0              2.5383376e+08  1.6929675e-13  0              2.9957221    
    900000   6000           100            100            0.026134541    0.0075886321   0              0.070814991    0.75478049     0              36445648       1.6929675e-13  0              2.9956837    
   1000000   6000           100            100            0.026100662    0.0076215299   0              0.070680456    0.10218186     0              4933996.2      1.6929675e-13  0              2.9956867    
   1100000   6000           100            100            0.026071382    0.0076125888   0              0.070601558    0.013102483    0              632672.03      1.6929675e-13  0              2.9956895    
   1200000   6000           100            100            0.026097387    0.0076145175   0              0.070677643    0.0015881188   0              76684.573      1.6929675e-13  0              2.995687     
   1300000   6000           100            100            0.026082257    0.0076134292   0              0.070633343    0.00018055714  0              8718.458       1.6929675e-13  0              2.9956884    
   1400000   6000           100            100            0.026089718    0.0076139623   0              0.070655192    1.9042441e-05  0              919.49135      1.6929675e-13  0              2.9956877    
   1500000   6000           100            100            0.026086354    0.0076137242   0              0.070645338    1.8227158e-06  0              88.012421      1.6929675e-13  0              2.9956881    
   1600000   6000           100            100            0.026087785    0.0076138251   0              0.070649531    1.520448e-07   0              7.3416995      1.6929675e-13  0              2.9956879    
   1700000   6000           100            100            0.026087202    0.0076137842   0              0.070647822    1.0105383e-08  0              0.48795279     1.6929675e-13  0              2.995688     
   1800000   6000           100            100            0.026087432    0.0076138002   0              0.070648495    4.1115671e-10  0              0.019853286    1.6929675e-13  0              2.995688     
   1900000   6000           100            100            0.026087344    0.0076137941   0              0.070648238    1.3103796e-12  0              6.3273543e-05  1.6929675e-13  0              2.995688     
   2000000   6000           100            100            0.026087377    0.0076137964   0              0.070648333    3.6205199e-12  0              0.00017482195  1.6929675e-13  0              2.995688     
   2100000   6000           100            100            0.026087365    0.0076137956   0              0.070648299    2.3454717e-12  0              0.00011325443  1.6929675e-13  0              2.995688     
   2200000   6000           100            100            0.026087369    0.0076137958   0              0.070648311    7.2718084e-13  0              3.511296e-05   1.6929675e-13  0              2.995688     
   2300000   6000           100            100            0.026087368    0.0076137957   0              0.070648307    1.6905033e-13  0              8.1628354e-06  1.6929675e-13  0              2.995688     
   2400000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    3.3612663e-14  0              1.6230352e-06  1.6929675e-13  0              2.995688     
   2500000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    5.9888356e-15  0              2.8917944e-07  1.6929675e-13  0              2.995688     
   2600000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    9.8963262e-16  0              4.7785817e-08  1.6929675e-13  0              2.995688     
   2700000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    1.4748233e-16  0              7.1213941e-09  1.6929675e-13  0              2.995688     
   2800000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    1.6686218e-17  0              8.0571775e-10  1.6929675e-13  0              2.995688     
   2900000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    9.5750318e-18  0              4.6234402e-10  1.6929675e-13  0              2.995688     
   3000000   6000           100            100            0.026087368    0.0076137958   0              0.070648308    5.3489698e-20  0              2.5828261e-12  1.6929675e-13  0              2.995688     
Loop time of 289.467 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8954374.689 ns/day, 0.000 hours/ns, 10363.860 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.392     | 50.012     | 65.689     | 214.1 | 17.28
Neigh   | 0.91324    | 0.92013    | 0.92705    |   0.6 |  0.32
Comm    | 22.48      | 37.274     | 52.613     | 236.7 | 12.88
Output  | 0.27029    | 0.27049    | 0.27073    |   0.0 |  0.09
Modify  | 140.1      | 160.04     | 180.11     | 154.3 | 55.29
Other   |            | 40.95      |            |       | 14.15

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019204635    2.9030295e-16  0              0.057613906    829838.71      0              4.0069941e+13  1.6929675e-13  0              3.3249372    
    200000   6000           100            100            0.0068850232   2.9030295e-16  0              0.02065507     206049.4       0              9.9493879e+12  1.6929675e-13  0              3.0714731    
    300000   6000           100            100            0.00063853719  2.9030295e-16  0              0.0019156116   3565.2021      0              1.7215085e+11  1.6929675e-13  0              3.0452598    
    400000   6000           100            100            0.085533904    0.023774936    0              0.23282678     9725.2227      0              4.695962e+11   1.6929675e-13  0              2.9923803    
    500000   6000           100            100            0.0046256349   0.0021357061   0              0.011741199    713.32085      0              3.4443711e+10  1.6929675e-13  0              2.9982097    
    600000   6000           100            100            0.0211279      0.0088846582   0              0.054499043    231.62092      0              1.1184145e+10  1.6929675e-13  0              2.9962995    
    700000   6000           100            100            0.024722794    0.0073531612   0              0.066815221    38.374423      0              1.8529635e+09  1.6929675e-13  0              2.9958817    
    800000   6000           100            100            0.027633104    0.0079585157   0              0.074940796    0.34991315     0              16896054       1.6929675e-13  0              2.9956458    
    900000   6000           100            100            0.025699645    0.0075526781   0              0.069546256    0.3975646      0              19196972       1.6929675e-13  0              2.995805     
   1000000   6000           100            100            0.026008409    0.0075507353   0              0.070474493    0.094968804    0              4585703.6      1.6929675e-13  0              2.9957763    
   1100000   6000           100            100            0.026141941    0.0075635034   0              0.07086232     0.00059806966  0              28878.643      1.6929675e-13  0              2.9957651    
   1200000   6000           100            100            0.02605156     0.0075555685   0              0.070599112    0.0010844606   0              52364.719      1.6929675e-13  0              2.9957729    
   1300000   6000           100            100            0.026065291    0.0075561344   0              0.070639737    0.0002216677   0              10703.54       1.6929675e-13  0              2.9957717    
   1400000   6000           100            100            0.026072424    0.0075563952   0              0.070660875    6.4745021e-07  0              31.263054      1.6929675e-13  0              2.9957711    
   1500000   6000           100            100            0.026068065    0.007556233    0              0.070647963    2.9662106e-06  0              143.2277       1.6929675e-13  0              2.9957714    
   1600000   6000           100            100            0.026068639    0.0075562555   0              0.070649661    5.1067229e-07  0              24.658537      1.6929675e-13  0              2.9957714    
   1700000   6000           100            100            0.026069024    0.0075562696   0              0.070650803    3.8238107e-10  0              0.018463813    1.6929675e-13  0              2.9957714    
   1800000   6000           100            100            0.026068811    0.0075562616   0              0.070650172    7.9876004e-09  0              0.38569264     1.6929675e-13  0              2.9957714    
   1900000   6000           100            100            0.026068834    0.0075562625   0              0.07065024     1.1623242e-09  0              0.056124476    1.6929675e-13  0              2.9957714    
   2000000   6000           100            100            0.026068855    0.0075562633   0              0.070650301    1.4388525e-15  0              6.9477037e-08  1.6929675e-13  0              2.9957714    
   2100000   6000           100            100            0.026068844    0.0075562629   0              0.07065027     2.1216842e-11  0              0.0010244854   1.6929675e-13  0              2.9957714    
   2200000   6000           100            100            0.026068845    0.0075562629   0              0.070650273    2.6101294e-12  0              0.00012603381  1.6929675e-13  0              2.9957714    
   2300000   6000           100            100            0.026068846    0.007556263    0              0.070650276    2.6021392e-15  0              1.2564799e-07  1.6929675e-13  0              2.9957714    
   2400000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    5.5474079e-14  0              2.6786447e-06  1.6929675e-13  0              2.9957714    
   2500000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    5.8588456e-15  0              2.8290268e-07  1.6929675e-13  0              2.9957714    
   2600000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    1.3468638e-17  0              6.5035234e-10  1.6929675e-13  0              2.9957714    
   2700000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    1.3120399e-16  0              6.3353711e-09  1.6929675e-13  0              2.9957714    
   2800000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    7.76886e-18    0              3.7513045e-10  1.6929675e-13  0              2.9957714    
   2900000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    5.9213295e-18  0              2.8591981e-10  1.6929675e-13  0              2.9957714    
   3000000   6000           100            100            0.026068846    0.0075562629   0              0.070650275    9.0940149e-20  0              4.3911743e-12  1.6929675e-13  0              2.9957714    
Loop time of 292.678 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8856163.491 ns/day, 0.000 hours/ns, 10250.189 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.541     | 50.032     | 65.646     | 216.8 | 17.09
Neigh   | 0.92771    | 0.93883    | 0.94999    |   0.8 |  0.32
Comm    | 23.006     | 38.1       | 53.527     | 240.9 | 13.02
Output  | 0.27182    | 0.27204    | 0.27229    |   0.0 |  0.09
Modify  | 142.01     | 162.18     | 182.29     | 156.9 | 55.41
Other   |            | 41.16      |            |       | 14.06

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019214332    2.9030295e-16  0              0.057642996    830463.63      0              4.0100117e+13  1.6929675e-13  0              3.3246024    
    200000   6000           100            100            0.0069072848   2.9030295e-16  0              0.020721854    207089.92      0              9.999631e+12   1.6929675e-13  0              3.0708798    
    300000   6000           100            100            0.00067422668  2.9030295e-16  0              0.00202268     3949.0225      0              1.9068417e+11  1.6929675e-13  0              3.045184     
    400000   6000           100            100            0.11306916     0.041633399    0              0.29757408     6036.9267      0              2.9150159e+11  1.6929675e-13  0              2.9915211    
    500000   6000           100            100            0.0022673668   0.0016654868   0              0.0051366136   13.017755      0              6.2858082e+08  1.6929675e-13  0              2.9988627    
    600000   6000           100            100            0.037304609    0.0080457856   0              0.10386804     40.23505       0              1.9428066e+09  1.6929675e-13  0              2.9949757    
    700000   6000           100            100            0.026608068    0.0089048624   0              0.070919343    43.073464      0              2.0798634e+09  1.6929675e-13  0              2.9958481    
    800000   6000           100            100            0.025137917    0.0081680814   0              0.06724567     2.2819457      0              1.1018699e+08  1.6929675e-13  0              2.9959523    
    900000   6000           100            100            0.025751441    0.0081943247   0              0.069059998    0.032500177    0              1569317.2      1.6929675e-13  0              2.9958968    
   1000000   6000           100            100            0.026186785    0.0081877175   0              0.070372637    0.08257411     0              3987208.2      1.6929675e-13  0              2.9958581    
   1100000   6000           100            100            0.026309161    0.0081900262   0              0.070737458    0.01190305     0              574755.68      1.6929675e-13  0              2.9958475    
   1200000   6000           100            100            0.026306457    0.0081899493   0              0.070729423    0.00014348855  0              6928.5485      1.6929675e-13  0              2.9958479    
   1300000   6000           100            100            0.026288714    0.008189584    0              0.070676558    8.3284736e-05  0              4021.5218      1.6929675e-13  0              2.9958494    
   1400000   6000           100            100            0.026280835    0.0081894269   0              0.070653078    3.4295188e-05  0              1655.9919      1.6929675e-13  0              2.9958501    
   1500000   6000           100            100            0.026279562    0.0081894025   0              0.070649282    2.2304702e-06  0              107.70142      1.6929675e-13  0              2.9958502    
   1600000   6000           100            100            0.026280031    0.0081894121   0              0.07065068     8.9308326e-09  0              0.43123794     1.6929675e-13  0              2.9958502    
   1700000   6000           100            100            0.02628042     0.0081894199   0              0.070651841    6.0086314e-08  0              2.9013531      1.6929675e-13  0              2.9958501    
   1800000   6000           100            100            0.026280538    0.0081894223   0              0.070652193    1.0249018e-08  0              0.4948884      1.6929675e-13  0              2.9958501    
   1900000   6000           100            100            0.026280541    0.0081894223   0              0.0706522      1.9735858e-10  0              0.0095297393   1.6929675e-13  0              2.9958501    
   2000000   6000           100            100            0.026280526    0.008189422    0              0.070652156    5.049351e-11   0              0.0024381509   1.6929675e-13  0              2.9958501    
   2100000   6000           100            100            0.026280519    0.0081894218   0              0.070652134    2.699834e-11   0              0.0013036532   1.6929675e-13  0              2.9958501    
   2200000   6000           100            100            0.026280517    0.0081894218   0              0.07065213     2.1270665e-12  0              0.00010270843  1.6929675e-13  0              2.9958501    
   2300000   6000           100            100            0.026280518    0.0081894218   0              0.070652131    4.4634227e-16  0              2.1552271e-08  1.6929675e-13  0              2.9958501    
   2400000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    4.2313581e-14  0              2.0431714e-06  1.6929675e-13  0              2.9958501    
   2500000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    8.7493634e-15  0              4.2247544e-07  1.6929675e-13  0              2.9958501    
   2600000   6000           100            100            0.026280518    0.0081894218   0              0.070652133    2.3588602e-16  0              1.1390092e-08  1.6929675e-13  0              2.9958501    
   2700000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    3.8531841e-17  0              1.8605647e-09  1.6929675e-13  0              2.9958501    
   2800000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    1.8034703e-17  0              8.7083129e-10  1.6929675e-13  0              2.9958501    
   2900000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    6.690212e-18   0              3.230464e-10   1.6929675e-13  0              2.9958501    
   3000000   6000           100            100            0.026280518    0.0081894218   0              0.070652132    7.9181157e-18  0              3.8233747e-10  1.6929675e-13  0              2.9958501    
Loop time of 288.098 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8996941.579 ns/day, 0.000 hours/ns, 10413.127 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.339     | 49.694     | 65.048     | 214.6 | 17.25
Neigh   | 0.92892    | 0.94097    | 0.9536     |   0.9 |  0.33
Comm    | 21.969     | 36.97      | 51.678     | 241.3 | 12.83
Output  | 0.27291    | 0.2731     | 0.27332    |   0.0 |  0.09
Modify  | 139.45     | 159.35     | 179.57     | 155.9 | 55.31
Other   |            | 40.87      |            |       | 14.19

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019223559    2.9030295e-16  0              0.057670676    831058.43      0              4.0128837e+13  1.6929675e-13  0              3.3242835    
    200000   6000           100            100            0.0069284774   2.9030295e-16  0              0.020785432    208082.01      0              1.0047536e+13  1.6929675e-13  0              3.0703131    
    300000   6000           100            100            0.00070832017  2.9030295e-16  0              0.0021249605   4331.7185      0              2.0916319e+11  1.6929675e-13  0              3.0450988    
    400000   6000           100            100            0.13548028     0.056397076    0              0.35004377     2631.7875      0              1.270796e+11   1.6929675e-13  0              2.9909505    
    500000   6000           100            100            0.0031863873   0.0017003455   0              0.0078588163   355.25719      0              1.7154098e+10  1.6929675e-13  0              2.9986833    
    600000   6000           100            100            0.027882611    0.0074872082   0              0.076160626    315.71577      0              1.5244785e+10  1.6929675e-13  0              2.9957549    
    700000   6000           100            100            0.026942343    0.0068646782   0              0.073962352    40.213411      0              1.9417617e+09  1.6929675e-13  0              2.9958254    
    800000   6000           100            100            0.026319886    0.0080237349   0              0.070935923    5.8114992      0              2.806165e+08   1.6929675e-13  0              2.9959144    
    900000   6000           100            100            0.026169428    0.0082128122   0              0.070295472    0.75182718     0              36303044       1.6929675e-13  0              2.9959341    
   1000000   6000           100            100            0.026172156    0.0081678382   0              0.070348631    0.079792808    0              3852909.1      1.6929675e-13  0              2.9959331    
   1100000   6000           100            100            0.026218989    0.0081690345   0              0.070487932    0.0064528038   0              311582.8       1.6929675e-13  0              2.9959293    
   1200000   6000           100            100            0.026249557    0.0081695817   0              0.070579088    0.00032392783  0              15641.315      1.6929675e-13  0              2.9959267    
   1300000   6000           100            100            0.026264633    0.0081698661   0              0.070624032    3.018753e-06   0              145.76478      1.6929675e-13  0              2.9959254    
   1400000   6000           100            100            0.026271039    0.00816999     0              0.070643126    1.469769e-06   0              70.969885      1.6929675e-13  0              2.9959249    
   1500000   6000           100            100            0.026273479    0.0081700378   0              0.070650399    1.1670067e-06  0              56.350576      1.6929675e-13  0              2.9959247    
   1600000   6000           100            100            0.026274319    0.0081700544   0              0.070652902    3.4890343e-07  0              16.847298      1.6929675e-13  0              2.9959246    
   1700000   6000           100            100            0.026274576    0.0081700595   0              0.07065367     7.1151398e-08  0              3.4356464      1.6929675e-13  0              2.9959246    
   1800000   6000           100            100            0.026274643    0.0081700609   0              0.070653868    1.1364049e-08  0              0.54872925     1.6929675e-13  0              2.9959246    
   1900000   6000           100            100            0.026274655    0.0081700611   0              0.070653903    1.4798846e-09  0              0.071458333    1.6929675e-13  0              2.9959246    
   2000000   6000           100            100            0.026274654    0.0081700611   0              0.070653901    1.5598271e-10  0              0.0075318466   1.6929675e-13  0              2.9959246    
   2100000   6000           100            100            0.026274652    0.0081700611   0              0.070653895    1.2492357e-11  0              0.00060321123  1.6929675e-13  0              2.9959246    
   2200000   6000           100            100            0.026274651    0.008170061    0              0.070653891    6.1548709e-13  0              2.9719669e-05  1.6929675e-13  0              2.9959246    
   2300000   6000           100            100            0.02627465     0.008170061    0              0.070653889    5.1513363e-15  0              2.4873959e-07  1.6929675e-13  0              2.9959246    
   2400000   6000           100            100            0.02627465     0.008170061    0              0.070653888    2.9434965e-15  0              1.4213091e-07  1.6929675e-13  0              2.9959246    
   2500000   6000           100            100            0.02627465     0.008170061    0              0.070653888    2.3463833e-15  0              1.1329845e-07  1.6929675e-13  0              2.9959246    
   2600000   6000           100            100            0.026274649    0.008170061    0              0.070653887    6.667337e-16   0              3.2194184e-08  1.6929675e-13  0              2.9959246    
   2700000   6000           100            100            0.026274649    0.008170061    0              0.070653887    1.1427165e-16  0              5.5177692e-09  1.6929675e-13  0              2.9959246    
   2800000   6000           100            100            0.026274649    0.008170061    0              0.070653887    2.1513763e-17  0              1.0388226e-09  1.6929675e-13  0              2.9959246    
   2900000   6000           100            100            0.026274649    0.008170061    0              0.070653887    1.5426733e-19  0              7.4490174e-12  1.6929675e-13  0              2.9959246    
   3000000   6000           100            100            0.026274649    0.008170061    0              0.070653887    1.4209923e-19  0              6.8614634e-12  1.6929675e-13  0              2.9959246    
Loop time of 289.162 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8963821.228 ns/day, 0.000 hours/ns, 10374.793 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.451     | 49.879     | 65.692     | 216.0 | 17.25
Neigh   | 0.96909    | 0.98137    | 0.99458    |   0.9 |  0.34
Comm    | 22.716     | 37.559     | 52.791     | 237.5 | 12.99
Output  | 0.27106    | 0.27126    | 0.2715     |   0.0 |  0.09
Modify  | 139.55     | 159.37     | 179.35     | 153.3 | 55.11
Other   |            | 41.1       |            |       | 14.21

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019232354    2.9030295e-16  0              0.057697061    831625.57      0              4.0156223e+13  1.6929675e-13  0              3.3239792    
    200000   6000           100            100            0.0069486887   2.9030295e-16  0              0.020846066    209029.55      0              1.0093289e+13  1.6929675e-13  0              3.0697708    
    300000   6000           100            100            0.00074094025  2.9030295e-16  0              0.0022228208   4712.3047      0              2.2754033e+11  1.6929675e-13  0              3.0450059    
    400000   6000           100            100            0.14868119     0.063444104    0              0.38259948     461.33475      0              2.2276204e+10  1.6929675e-13  0              2.9906893    
    500000   6000           100            100            0.0084453594   0.0036125998   0              0.021723478    1423.5056      0              6.8735992e+10  1.6929675e-13  0              2.9978293    
    600000   6000           100            100            0.016125899    0.0083572635   0              0.040020432    12.936199      0              6.2464273e+08  1.6929675e-13  0              2.9969763    
    700000   6000           100            100            0.024176299    0.010231776    0              0.06229712     22.964962      0              1.1088958e+09  1.6929675e-13  0              2.9962425    
    800000   6000           100            100            0.027410079    0.0089683321   0              0.073261906    4.0421113      0              1.9517909e+08  1.6929675e-13  0              2.9959239    
    900000   6000           100            100            0.026970323    0.0087256116   0              0.072185357    0.13211588     0              6379402.9      1.6929675e-13  0              2.9959519    
   1000000   6000           100            100            0.026390301    0.008650814    0              0.070520088    0.10201395     0              4925888.8      1.6929675e-13  0              2.9959986    
   1100000   6000           100            100            0.026359893    0.0086496389   0              0.070430039    4.3429908e-07  0              20.970748      1.6929675e-13  0              2.9960015    
   1200000   6000           100            100            0.026429937    0.0086520485   0              0.070637761    0.0018435455   0              89018.216      1.6929675e-13  0              2.9959956    
   1300000   6000           100            100            0.026445234    0.0086525835   0              0.070683119    4.8007475e-05  0              2318.1092      1.6929675e-13  0              2.9959943    
   1400000   6000           100            100            0.026438228    0.0086523488   0              0.070662336    2.1918461e-05  0              1058.364       1.6929675e-13  0              2.9959949    
   1500000   6000           100            100            0.026435052    0.0086522393   0              0.070652917    2.8193469e-06  0              136.13617      1.6929675e-13  0              2.9959952    
   1600000   6000           100            100            0.02643549     0.0086522535   0              0.070654217    1.3201262e-07  0              6.3744171      1.6929675e-13  0              2.9959951    
   1700000   6000           100            100            0.026435988    0.0086522705   0              0.070655693    8.071048e-08   0              3.8972202      1.6929675e-13  0              2.9959951    
   1800000   6000           100            100            0.026436008    0.0086522713   0              0.070655753    1.3727961e-11  0              0.0006628741   1.6929675e-13  0              2.9959951    
   1900000   6000           100            100            0.026435944    0.0086522692   0              0.070655564    1.5106035e-09  0              0.072941638    1.6929675e-13  0              2.9959951    
   2000000   6000           100            100            0.026435931    0.0086522687   0              0.070655526    3.2386797e-11  0              0.0015638425   1.6929675e-13  0              2.9959951    
   2100000   6000           100            100            0.026435938    0.0086522689   0              0.070655545    1.8751158e-11  0              0.00090542633  1.6929675e-13  0              2.9959951    
   2200000   6000           100            100            0.026435941    0.008652269    0              0.070655553    2.1189438e-12  0              0.00010231621  1.6929675e-13  0              2.9959951    
   2300000   6000           100            100            0.02643594     0.008652269    0              0.070655552    1.2351549e-13  0              5.9641209e-06  1.6929675e-13  0              2.9959951    
   2400000   6000           100            100            0.02643594     0.008652269    0              0.070655551    6.3612306e-14  0              3.0716106e-06  1.6929675e-13  0              2.9959951    
   2500000   6000           100            100            0.02643594     0.008652269    0              0.070655551    6.3079829e-17  0              3.0458992e-09  1.6929675e-13  0              2.9959951    
   2600000   6000           100            100            0.02643594     0.008652269    0              0.070655551    1.2425347e-15  0              5.9997553e-08  1.6929675e-13  0              2.9959951    
   2700000   6000           100            100            0.02643594     0.008652269    0              0.070655551    3.4226659e-17  0              1.6526829e-09  1.6929675e-13  0              2.9959951    
   2800000   6000           100            100            0.02643594     0.008652269    0              0.070655551    1.6574222e-17  0              8.0030988e-10  1.6929675e-13  0              2.9959951    
   2900000   6000           100            100            0.02643594     0.008652269    0              0.070655551    7.9910292e-21  0              3.858582e-13   1.6929675e-13  0              2.9959951    
   3000000   6000           100            100            0.02643594     0.008652269    0              0.070655551    2.0319195e-19  0              9.8114123e-12  1.6929675e-13  0              2.9959951    
Loop time of 289.164 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8963762.175 ns/day, 0.000 hours/ns, 10374.725 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.073     | 49.517     | 65.313     | 216.9 | 17.12
Neigh   | 0.92818    | 0.93915    | 0.95127    |   0.8 |  0.32
Comm    | 22.474     | 37.365     | 52.634     | 238.7 | 12.92
Output  | 0.27111    | 0.27129    | 0.27151    |   0.0 |  0.09
Modify  | 140.17     | 160.15     | 180.19     | 154.2 | 55.38
Other   |            | 40.93      |            |       | 14.15

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019240751    2.9030295e-16  0              0.057722253    832167.22      0              4.0182377e+13  1.6929675e-13  0              3.3236883    
    200000   6000           100            100            0.0069679957   2.9030295e-16  0              0.020903987    209935.97      0              1.0137057e+13  1.6929675e-13  0              3.0692512    
    300000   6000           100            100            0.00077219382  2.9030295e-16  0              0.0023165815   5089.9768      0              2.4577676e+11  1.6929675e-13  0              3.0449066    
    400000   6000           100            100            0.15203346     0.064999946    0              0.39110044     87.433974      0              4.2218737e+09  1.6929675e-13  0              2.9907336    
    500000   6000           100            100            0.021122046    0.0074718788   0              0.05589426     2360.8817      0              1.1399853e+11  1.6929675e-13  0              2.9965431    
    600000   6000           100            100            0.023366443    0.0099049265   0              0.060194404    297.38986      0              1.4359892e+10  1.6929675e-13  0              2.9963795    
    700000   6000           100            100            0.030328113    0.0080393544   0              0.082944984    4.3483842      0              2.0996791e+08  1.6929675e-13  0              2.9957333    
    800000   6000           100            100            0.02532136     0.0095544538   0              0.066409626    0.86576404     0              41804647       1.6929675e-13  0              2.9961809    
    900000   6000           100            100            0.026916483    0.009264761    0              0.071484687    0.61666535     0              29776563       1.6929675e-13  0              2.9960398    
   1000000   6000           100            100            0.026649981    0.0092081314   0              0.070741811    0.10566381     0              5102127.4      1.6929675e-13  0              2.9960595    
   1100000   6000           100            100            0.026562499    0.0091918172   0              0.070495681    0.0071760294   0              346504.78      1.6929675e-13  0              2.9960666    
   1200000   6000           100            100            0.026645001    0.0091947284   0              0.070740274    3.5012217e-05  0              1690.6146      1.6929675e-13  0              2.9960598    
   1300000   6000           100            100            0.026607865    0.0091934636   0              0.070630132    6.3158553e-05  0              3049.7005      1.6929675e-13  0              2.9960628    
   1400000   6000           100            100            0.026618531    0.0091938269   0              0.070661765    2.9796619e-05  0              1438.7721      1.6929675e-13  0              2.9960619    
   1500000   6000           100            100            0.026617279    0.0091937866   0              0.07065805     4.5396673e-06  0              219.20428      1.6929675e-13  0              2.996062     
   1600000   6000           100            100            0.026616576    0.0091937615   0              0.070655967    2.6436183e-07  0              12.765087      1.6929675e-13  0              2.9960621    
   1700000   6000           100            100            0.026617157    0.0091937816   0              0.070657689    2.0963493e-10  0              0.010122521    1.6929675e-13  0              2.9960621    
   1800000   6000           100            100            0.026616911    0.0091937732   0              0.07065696     3.6950065e-09  0              0.17841864     1.6929675e-13  0              2.9960621    
   1900000   6000           100            100            0.026616977    0.0091937754   0              0.070657155    1.4140304e-09  0              0.068278467    1.6929675e-13  0              2.9960621    
   2000000   6000           100            100            0.026616971    0.0091937753   0              0.070657139    1.9221713e-10  0              0.0092814773   1.6929675e-13  0              2.9960621    
   2100000   6000           100            100            0.026616966    0.0091937751   0              0.070657122    9.394505e-12   0              0.00045362702  1.6929675e-13  0              2.9960621    
   2200000   6000           100            100            0.02661697     0.0091937752   0              0.070657134    4.9786708e-15  0              2.404022e-07   1.6929675e-13  0              2.9960621    
   2300000   6000           100            100            0.026616968    0.0091937751   0              0.070657129    2.0612582e-13  0              9.9530781e-06  1.6929675e-13  0              2.9960621    
   2400000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    6.6222425e-14  0              3.1976439e-06  1.6929675e-13  0              2.9960621    
   2500000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    7.9346655e-15  0              3.831366e-07   1.6929675e-13  0              2.9960621    
   2600000   6000           100            100            0.026616969    0.0091937752   0              0.07065713     3.3483477e-16  0              1.6167973e-08  1.6929675e-13  0              2.9960621    
   2700000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    1.1737362e-17  0              5.667552e-10   1.6929675e-13  0              2.9960621    
   2800000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    7.692324e-18   0              3.7143479e-10  1.6929675e-13  0              2.9960621    
   2900000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    2.747735e-18   0              1.3267829e-10  1.6929675e-13  0              2.9960621    
   3000000   6000           100            100            0.026616969    0.0091937752   0              0.070657131    1.8552692e-18  0              8.9584312e-11  1.6929675e-13  0              2.9960621    
Loop time of 290.194 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8931959.182 ns/day, 0.000 hours/ns, 10337.916 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.083     | 49.431     | 65.039     | 215.2 | 17.03
Neigh   | 0.92395    | 0.93653    | 0.94978    |   0.9 |  0.32
Comm    | 22.537     | 37.266     | 52.363     | 237.4 | 12.84
Output  | 0.27366    | 0.27386    | 0.27409    |   0.0 |  0.09
Modify  | 140.62     | 160.87     | 181.54     | 155.5 | 55.44
Other   |            | 41.41      |            |       | 14.27

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019248781    2.9030295e-16  0              0.057746343    832685.33      0              4.0207395e+13  1.6929675e-13  0              3.3234099    
    200000   6000           100            100            0.0069864669   2.9030295e-16  0              0.020959401    210804.31      0              1.0178986e+13  1.6929675e-13  0              3.0687526    
    300000   6000           100            100            0.00080217907  2.9030295e-16  0              0.0024065372   5464.1306      0              2.6384331e+11  1.6929675e-13  0              3.0448018    
    400000   6000           100            100            0.14693674     0.065214851    0              0.37559537     1507.4945      0              7.2791515e+10  1.6929675e-13  0              2.9910575    
    500000   6000           100            100            0.039590062    0.0081259644   0              0.11064422     2089.7409      0              1.0090611e+11  1.6929675e-13  0              2.9951871    
    600000   6000           100            100            0.038008188    0.0081224759   0              0.10590209     39.88137       0              1.9257286e+09  1.6929675e-13  0              2.9952647    
    700000   6000           100            100            0.023062961    0.010492396    0              0.058696486    3.3691789      0              1.6268559e+08  1.6929675e-13  0              2.9964653    
    800000   6000           100            100            0.028152692    0.0090778033   0              0.075380273    0.031446543    0              1518441        1.6929675e-13  0              2.9959989    
    900000   6000           100            100            0.02619037     0.009444671    0              0.06912644     0.15632876     0              7548556.2      1.6929675e-13  0              2.9961681    
   1000000   6000           100            100            0.02682405     0.0093869311   0              0.071085219    0.05829234     0              2814728.5      1.6929675e-13  0              2.996114     
   1100000   6000           100            100            0.026650499    0.0093825617   0              0.070568936    0.012377914    0              597685.15      1.6929675e-13  0              2.9961283    
   1200000   6000           100            100            0.026682072    0.0093830506   0              0.070663165    0.0019682397   0              95039.251      1.6929675e-13  0              2.9961256    
   1300000   6000           100            100            0.026683543    0.0093830635   0              0.070667566    0.00024551478  0              11855.03       1.6929675e-13  0              2.9961255    
   1400000   6000           100            100            0.026678277    0.0093829848   0              0.070651845    2.3536072e-05  0              1136.4727      1.6929675e-13  0              2.996126     
   1500000   6000           100            100            0.026681719    0.0093830373   0              0.070662121    1.5421113e-06  0              74.463038      1.6929675e-13  0              2.9961257    
   1600000   6000           100            100            0.02668005     0.0093830115   0              0.070657137    4.1842701e-08  0              2.0204343      1.6929675e-13  0              2.9961258    
   1700000   6000           100            100            0.02668074     0.0093830223   0              0.070659197    6.7357098e-10  0              0.032524332    1.6929675e-13  0              2.9961258    
   1800000   6000           100            100            0.026680488    0.0093830183   0              0.070658445    2.0704118e-09  0              0.099972777    1.6929675e-13  0              2.9961258    
   1900000   6000           100            100            0.026680569    0.0093830196   0              0.070658687    7.8132591e-10  0              0.037727432    1.6929675e-13  0              2.9961258    
   2000000   6000           100            100            0.026680547    0.0093830192   0              0.070658621    1.7393747e-10  0              0.0083988179   1.6929675e-13  0              2.9961258    
   2100000   6000           100            100            0.026680551    0.0093830193   0              0.070658634    2.8605453e-11  0              0.0013812549   1.6929675e-13  0              2.9961258    
   2200000   6000           100            100            0.026680551    0.0093830193   0              0.070658634    3.6835214e-12  0              0.00017786406  1.6929675e-13  0              2.9961258    
   2300000   6000           100            100            0.026680551    0.0093830193   0              0.070658632    3.67472e-13    0              1.7743908e-05  1.6929675e-13  0              2.9961258    
   2400000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    2.5325844e-14  0              1.2228944e-06  1.6929675e-13  0              2.9961258    
   2500000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    7.5067501e-16  0              3.624741e-08   1.6929675e-13  0              2.9961258    
   2600000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    1.1671366e-17  0              5.6356851e-10  1.6929675e-13  0              2.9961258    
   2700000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    8.7628078e-18  0              4.2312463e-10  1.6929675e-13  0              2.9961258    
   2800000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    6.46538e-18    0              3.1219006e-10  1.6929675e-13  0              2.9961258    
   2900000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    1.3043743e-18  0              6.2983569e-11  1.6929675e-13  0              2.9961258    
   3000000   6000           100            100            0.026680551    0.0093830193   0              0.070658633    1.056213e-18   0              5.1000747e-11  1.6929675e-13  0              2.9961258    
Loop time of 290.626 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8918680.972 ns/day, 0.000 hours/ns, 10322.547 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 33.955     | 49.299     | 64.863     | 212.9 | 16.96
Neigh   | 0.92127    | 0.93349    | 0.94576    |   0.9 |  0.32
Comm    | 22.866     | 37.827     | 52.761     | 234.0 | 13.02
Output  | 0.27185    | 0.27205    | 0.27228    |   0.0 |  0.09
Modify  | 140.29     | 160.65     | 181.42     | 160.4 | 55.28
Other   |            | 41.65      |            |       | 14.33

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019256471    2.9030295e-16  0              0.057769414    833181.63      0              4.0231359e+13  1.6929675e-13  0              3.323143     
    200000   6000           100            100            0.0070041626   2.9030295e-16  0              0.021012488    211637.25      0              1.0219205e+13  1.6929675e-13  0              3.0682736    
    300000   6000           100            100            0.00083098415  2.9030295e-16  0              0.0024929525   5834.2959      0              2.8171727e+11  1.6929675e-13  0              3.0446926    
    400000   6000           100            100            0.1330556      0.05926028     0              0.33990651     4225.7871      0              2.0404814e+11  1.6929675e-13  0              2.9916184    
    500000   6000           100            100            0.059044246    0.012411986    0              0.16472075     722.76223      0              3.4899601e+10  1.6929675e-13  0              2.9941983    
    600000   6000           100            100            0.03060177     0.0080101227   0              0.083795188    291.14769      0              1.405848e+10   1.6929675e-13  0              2.9958364    
    700000   6000           100            100            0.028993552    0.0089438723   0              0.078036784    31.226527      0              1.5078172e+09  1.6929675e-13  0              2.9959976    
    800000   6000           100            100            0.025607777    0.010406502    0              0.066416829    1.0788578      0              52094184       1.6929675e-13  0              2.9963029    
    900000   6000           100            100            0.02668794     0.0099678164   0              0.070096003    0.73305413     0              35396561       1.6929675e-13  0              2.996201     
   1000000   6000           100            100            0.027089517    0.0099834884   0              0.071285064    0.0047340625   0              228590.94      1.6929675e-13  0              2.9961697    
   1100000   6000           100            100            0.026887154    0.0099760814   0              0.07068538     0.014647615    0              707280.9       1.6929675e-13  0              2.9961859    
   1200000   6000           100            100            0.026849672    0.0099750621   0              0.070573954    9.2646429e-08  0              4.4735645      1.6929675e-13  0              2.9961888    
   1300000   6000           100            100            0.02687978     0.009975908    0              0.070663433    0.00026519549  0              12805.341      1.6929675e-13  0              2.9961864    
   1400000   6000           100            100            0.026882462    0.0099759807   0              0.070671405    1.7590314e-06  0              84.937333      1.6929675e-13  0              2.9961862    
   1500000   6000           100            100            0.026878191    0.0099758564   0              0.070658715    4.3674398e-06  0              210.88804      1.6929675e-13  0              2.9961865    
   1600000   6000           100            100            0.026878166    0.0099758564   0              0.070658643    1.1809614e-07  0              5.70244        1.6929675e-13  0              2.9961865    
   1700000   6000           100            100            0.026878744    0.0099758731   0              0.070660359    6.4773072e-08  0              3.1276598      1.6929675e-13  0              2.9961865    
   1800000   6000           100            100            0.026878702    0.0099758718   0              0.070660233    4.4083766e-09  0              0.21286473     1.6929675e-13  0              2.9961865    
   1900000   6000           100            100            0.026878627    0.0099758696   0              0.070660012    8.44301e-10    0              0.040768274    1.6929675e-13  0              2.9961865    
   2000000   6000           100            100            0.026878639    0.00997587     0              0.070660046    1.2633667e-10  0              0.0061003457   1.6929675e-13  0              2.9961865    
   2100000   6000           100            100            0.026878648    0.0099758702   0              0.070660073    9.171233e-12   0              0.00044284602  1.6929675e-13  0              2.9961865    
   2200000   6000           100            100            0.026878645    0.0099758702   0              0.070660066    3.0759596e-12  0              0.00014852708  1.6929675e-13  0              2.9961865    
   2300000   6000           100            100            0.026878644    0.0099758701   0              0.070660063    7.2706499e-14  0              3.5107366e-06  1.6929675e-13  0              2.9961865    
   2400000   6000           100            100            0.026878645    0.0099758701   0              0.070660064    6.6241381e-14  0              3.1985592e-06  1.6929675e-13  0              2.9961865    
   2500000   6000           100            100            0.026878645    0.0099758701   0              0.070660065    2.666419e-16   0              1.2875183e-08  1.6929675e-13  0              2.9961865    
   2600000   6000           100            100            0.026878645    0.0099758701   0              0.070660065    1.3029872e-15  0              6.2916587e-08  1.6929675e-13  0              2.9961865    
   2700000   6000           100            100            0.026878645    0.0099758701   0              0.070660064    1.1658495e-17  0              5.6294698e-10  1.6929675e-13  0              2.9961865    
   2800000   6000           100            100            0.026878645    0.0099758701   0              0.070660064    2.0067246e-17  0              9.6897548e-10  1.6929675e-13  0              2.9961865    
   2900000   6000           100            100            0.026878645    0.0099758701   0              0.070660064    5.1664035e-18  0              2.4946714e-10  1.6929675e-13  0              2.9961865    
   3000000   6000           100            100            0.026878645    0.0099758702   0              0.070660065    4.3432354e-18  0              2.0971929e-10  1.6929675e-13  0              2.9961865    
Loop time of 290.678 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8917073.633 ns/day, 0.000 hours/ns, 10320.687 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 33.937     | 49.536     | 65.642     | 215.5 | 17.04
Neigh   | 0.93816    | 0.95154    | 0.96508    |   1.0 |  0.33
Comm    | 22.698     | 38.035     | 53.247     | 235.1 | 13.08
Output  | 0.27167    | 0.27187    | 0.2721     |   0.0 |  0.09
Modify  | 140.65     | 160.73     | 181.03     | 155.4 | 55.29
Other   |            | 41.16      |            |       | 14.16

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019263846    2.9030295e-16  0              0.057791538    833657.67      0              4.0254345e+13  1.6929675e-13  0              3.3228868    
    200000   6000           100            100            0.0070211381   2.9030295e-16  0              0.021063414    212437.26      0              1.0257835e+13  1.6929675e-13  0              3.0678129    
    300000   6000           100            100            0.00085868848  2.9030295e-16  0              0.0025760654   6200.1103      0              2.9938114e+11  1.6929675e-13  0              3.0445797    
    400000   6000           100            100            0.10985949     0.039338887    0              0.29023959     7498.0558      0              3.6205428e+11  1.6929675e-13  0              2.992364     
    500000   6000           100            100            0.066227727    0.012766922    0              0.18591626     4.3876737      0              2.1186506e+08  1.6929675e-13  0              2.9939142    
    600000   6000           100            100            0.016981822    0.0082712752   0              0.04267419     99.383371      0              4.7988673e+09  1.6929675e-13  0              2.9970662    
    700000   6000           100            100            0.027239788    0.0098721631   0              0.071847201    44.999908      0              2.1728845e+09  1.6929675e-13  0              2.996208     
    800000   6000           100            100            0.027988894    0.0096904199   0              0.074276263    2.6575529      0              1.2832372e+08  1.6929675e-13  0              2.9961488    
    900000   6000           100            100            0.027510595    0.010104174    0              0.07242761     0.0027427269   0              132436.47      1.6929675e-13  0              2.9961979    
   1000000   6000           100            100            0.027111943    0.010127049    0              0.07120878     0.032476159    0              1568157.5      1.6929675e-13  0              2.9962301    
   1100000   6000           100            100            0.026959318    0.010128169    0              0.070749784    0.012938356    0              624746.93      1.6929675e-13  0              2.9962421    
   1200000   6000           100            100            0.026922311    0.010126541    0              0.070640392    0.0018869399   0              91113.577      1.6929675e-13  0              2.9962449    
   1300000   6000           100            100            0.026921167    0.010126506    0              0.070636994    0.00011107935  0              5363.6243      1.6929675e-13  0              2.996245     
   1400000   6000           100            100            0.02692547     0.010126697    0              0.070649712    1.7770191e-07  0              8.5805894      1.6929675e-13  0              2.9962446    
   1500000   6000           100            100            0.026928187    0.010126816    0              0.070657745    1.3675582e-06  0              66.03449       1.6929675e-13  0              2.9962444    
   1600000   6000           100            100            0.026929225    0.010126862    0              0.070660815    5.6722967e-07  0              27.389491      1.6929675e-13  0              2.9962444    
   1700000   6000           100            100            0.026929477    0.010126873    0              0.07066156     8.4597494e-08  0              4.0849102      1.6929675e-13  0              2.9962443    
   1800000   6000           100            100            0.026929488    0.010126873    0              0.07066159     5.1393269e-09  0              0.2481597      1.6929675e-13  0              2.9962443    
   1900000   6000           100            100            0.02692946     0.010126872    0              0.070661507    1.2171948e-11  0              0.00058773979  1.6929675e-13  0              2.9962443    
   2000000   6000           100            100            0.026929442    0.010126871    0              0.070661454    5.7516953e-11  0              0.0027772878   1.6929675e-13  0              2.9962443    
   2100000   6000           100            100            0.026929435    0.010126871    0              0.070661433    2.4851688e-11  0              0.001199999    1.6929675e-13  0              2.9962443    
   2200000   6000           100            100            0.026929433    0.010126871    0              0.070661428    3.788364e-12   0              0.00018292654  1.6929675e-13  0              2.9962443    
   2300000   6000           100            100            0.026929433    0.010126871    0              0.070661428    2.3734903e-13  0              1.1460735e-05  1.6929675e-13  0              2.9962443    
   2400000   6000           100            100            0.026929433    0.010126871    0              0.070661428    7.3614383e-16  0              3.5545751e-08  1.6929675e-13  0              2.9962443    
   2500000   6000           100            100            0.026929433    0.010126871    0              0.070661429    2.4291067e-15  0              1.1729287e-07  1.6929675e-13  0              2.9962443    
   2600000   6000           100            100            0.026929433    0.010126871    0              0.070661429    1.0661109e-15  0              5.147868e-08   1.6929675e-13  0              2.9962443    
   2700000   6000           100            100            0.026929433    0.010126871    0              0.070661429    1.5111984e-16  0              7.297036e-09   1.6929675e-13  0              2.9962443    
   2800000   6000           100            100            0.026929433    0.010126871    0              0.070661429    4.6429079e-18  0              2.2418941e-10  1.6929675e-13  0              2.9962443    
   2900000   6000           100            100            0.026929433    0.010126871    0              0.070661429    9.5020262e-18  0              4.5881884e-10  1.6929675e-13  0              2.9962443    
   3000000   6000           100            100            0.026929433    0.010126871    0              0.070661429    1.9584077e-20  0              9.4564497e-13  1.6929675e-13  0              2.9962443    
Loop time of 289.088 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8966121.246 ns/day, 0.000 hours/ns, 10377.455 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.224     | 49.248     | 64.28      | 212.1 | 17.04
Neigh   | 0.92873    | 0.94155    | 0.95466    |   0.9 |  0.33
Comm    | 23.225     | 37.824     | 53.456     | 235.6 | 13.08
Output  | 0.27432    | 0.27452    | 0.27477    |   0.0 |  0.09
Modify  | 139.31     | 159.85     | 179.79     | 155.4 | 55.29
Other   |            | 40.95      |            |       | 14.16

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019270927    2.9030295e-16  0              0.05781278     834114.85      0              4.0276421e+13  1.6929675e-13  0              3.3226407    
    200000   6000           100            100            0.0070374432   2.9030295e-16  0              0.02111233     213206.57      0              1.0294982e+13  1.6929675e-13  0              3.0673692    
    300000   6000           100            100            0.00088536379  2.9030295e-16  0              0.0026560914   6561.2983      0              3.1682161e+11  1.6929675e-13  0              3.0444639    
    400000   6000           100            100            0.08643342     0.025658782    0              0.23364148     10605.372      0              5.1209544e+11  1.6929675e-13  0              2.9932395    
    500000   6000           100            100            0.058586351    0.013990491    0              0.16176856     878.97875      0              4.2442738e+10  1.6929675e-13  0              2.9943931    
    600000   6000           100            100            0.017815731    0.0088299732   0              0.044617221    134.22052      0              6.4810288e+09  1.6929675e-13  0              2.9970663    
    700000   6000           100            100            0.023582557    0.010553054    0              0.060194617    15.349995      0              7.4119632e+08  1.6929675e-13  0              2.9965862    
    800000   6000           100            100            0.026202881    0.010956486    0              0.067652155    3.7089097      0              1.7908997e+08  1.6929675e-13  0              2.9963804    
    900000   6000           100            100            0.026911167    0.010688626    0              0.070044876    0.72431439     0              34974550       1.6929675e-13  0              2.9963164    
   1000000   6000           100            100            0.02712305     0.010738612    0              0.070630538    0.11124516     0              5371630.7      1.6929675e-13  0              2.9963007    
   1100000   6000           100            100            0.027153686    0.010740417    0              0.070720641    0.014219429    0              686605.34      1.6929675e-13  0              2.9962982    
   1200000   6000           100            100            0.027149258    0.010740246    0              0.070707528    0.0015173788   0              73268.79       1.6929675e-13  0              2.9962985    
   1300000   6000           100            100            0.02714214     0.010739904    0              0.070686517    0.00012775532  0              6168.847       1.6929675e-13  0              2.996299     
   1400000   6000           100            100            0.027137694    0.010739661    0              0.07067342     7.2510801e-06  0              350.12871      1.6929675e-13  0              2.9962993    
   1500000   6000           100            100            0.02713551     0.010739491    0              0.07066704     1.3637149e-07  0              6.584891       1.6929675e-13  0              2.9962995    
   1600000   6000           100            100            0.02713458     0.010739419    0              0.07066432     1.0682427e-08  0              0.51581619     1.6929675e-13  0              2.9962996    
   1700000   6000           100            100            0.02713422     0.010739391    0              0.070663268    1.4986125e-08  0              0.72362635     1.6929675e-13  0              2.9962996    
   1800000   6000           100            100            0.027134092    0.010739381    0              0.070662895    5.2007342e-09  0              0.25112484     1.6929675e-13  0              2.9962996    
   1900000   6000           100            100            0.027134051    0.010739378    0              0.070662774    1.1689994e-09  0              0.056446796    1.6929675e-13  0              2.9962996    
   2000000   6000           100            100            0.027134039    0.010739377    0              0.07066274     2.0485292e-10  0              0.0098916144   1.6929675e-13  0              2.9962996    
   2100000   6000           100            100            0.027134036    0.010739377    0              0.070662732    2.9722429e-11  0              0.0014351897   1.6929675e-13  0              2.9962996    
   2200000   6000           100            100            0.027134036    0.010739377    0              0.070662731    3.621938e-12   0              0.00017489042  1.6929675e-13  0              2.9962996    
   2300000   6000           100            100            0.027134036    0.010739377    0              0.070662732    3.6348024e-13  0              1.755116e-05   1.6929675e-13  0              2.9962996    
   2400000   6000           100            100            0.027134036    0.010739377    0              0.070662732    2.828488e-14   0              1.3657756e-06  1.6929675e-13  0              2.9962996    
   2500000   6000           100            100            0.027134036    0.010739377    0              0.070662732    1.3536704e-15  0              6.53639e-08    1.6929675e-13  0              2.9962996    
   2600000   6000           100            100            0.027134037    0.010739377    0              0.070662732    2.9159262e-18  0              1.4079964e-10  1.6929675e-13  0              2.9962996    
   2700000   6000           100            100            0.027134037    0.010739377    0              0.070662733    1.6165974e-22  0              7.8059703e-15  1.6929675e-13  0              2.9962996    
   2800000   6000           100            100            0.027134037    0.010739377    0              0.070662733    1.7301105e-18  0              8.3540843e-11  1.6929675e-13  0              2.9962996    
   2900000   6000           100            100            0.027134037    0.010739377    0              0.070662733    1.8599474e-18  0              8.9810203e-11  1.6929675e-13  0              2.9962996    
   3000000   6000           100            100            0.027134037    0.010739377    0              0.070662733    6.3750356e-18  0              3.0782765e-10  1.6929675e-13  0              2.9962996    
Loop time of 288.769 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8976037.060 ns/day, 0.000 hours/ns, 10388.932 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.106     | 49.218     | 64.266     | 214.2 | 17.04
Neigh   | 0.91568    | 0.92805    | 0.94077    |   0.9 |  0.32
Comm    | 22.517     | 37.231     | 51.814     | 238.1 | 12.89
Output  | 0.26868    | 0.26886    | 0.26907    |   0.0 |  0.09
Modify  | 139.7      | 159.84     | 180.19     | 159.1 | 55.35
Other   |            | 41.28      |            |       | 14.30

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019277734    2.9030295e-16  0              0.057833201    834554.46      0              4.0297648e+13  1.6929675e-13  0              3.3224038    
    200000   6000           100            100            0.0070531225   2.9030295e-16  0              0.021159367    213947.19      0              1.0330744e+13  1.6929675e-13  0              3.0669416    
    300000   6000           100            100            0.00091107535  2.9030295e-16  0              0.0027332261   6917.6574      0              3.3402892e+11  1.6929675e-13  0              3.0443456    
    400000   6000           100            100            0.065981623    0.021388996    0              0.17655587     13041.237      0              6.2971468e+11  1.6929675e-13  0              2.9941933    
    500000   6000           100            100            0.040853946    0.011792887    0              0.11076895     2152.2959      0              1.0392667e+11  1.6929675e-13  0              2.9954106    
    600000   6000           100            100            0.031727781    0.0095503851   0              0.085632958    292.47795      0              1.4122714e+10  1.6929675e-13  0              2.995999     
    700000   6000           100            100            0.031076934    0.0091487639   0              0.084082038    2.6579132      0              1.2834112e+08  1.6929675e-13  0              2.9960243    
    800000   6000           100            100            0.02779408     0.010098065    0              0.073284176    4.4154484      0              2.132062e+08   1.6929675e-13  0              2.9962844    
    900000   6000           100            100            0.026568535    0.010208432    0              0.069497173    0.48945201     0              23633886       1.6929675e-13  0              2.9963821    
   1000000   6000           100            100            0.026771393    0.010255225    0              0.070058954    0.017568451    0              848317.62      1.6929675e-13  0              2.9963682    
   1100000   6000           100            100            0.026990426    0.010276308    0              0.070694969    0.014944024    0              721593.43      1.6929675e-13  0              2.9963518    
   1200000   6000           100            100            0.027010008    0.01027794     0              0.070752085    5.4928922e-05  0              2652.321       1.6929675e-13  0              2.9963503    
   1300000   6000           100            100            0.026984657    0.010275967    0              0.070678004    0.0002233195   0              10783.299      1.6929675e-13  0              2.9963522    
   1400000   6000           100            100            0.026976783    0.010275342    0              0.070655008    1.6719726e-05  0              807.33571      1.6929675e-13  0              2.9963528    
   1500000   6000           100            100            0.026978571    0.010275477    0              0.070660235    1.3654122e-06  0              65.930869      1.6929675e-13  0              2.9963526    
   1600000   6000           100            100            0.026980002    0.01027559     0              0.070664416    6.2851812e-07  0              30.348891      1.6929675e-13  0              2.9963525    
   1700000   6000           100            100            0.026980057    0.010275595    0              0.070664576    4.163351e-11   0              0.0020103332   1.6929675e-13  0              2.9963525    
   1800000   6000           100            100            0.026979875    0.010275581    0              0.070664045    1.1134519e-08  0              0.53764608     1.6929675e-13  0              2.9963525    
   1900000   6000           100            100            0.02697983     0.010275577    0              0.070663914    5.1492018e-10  0              0.024863652    1.6929675e-13  0              2.9963526    
   2000000   6000           100            100            0.026979846    0.010275578    0              0.070663958    9.080941e-11   0              0.0043848614   1.6929675e-13  0              2.9963526    
   2100000   6000           100            100            0.026979855    0.010275579    0              0.070663985    2.5293038e-11  0              0.0012213103   1.6929675e-13  0              2.9963525    
   2200000   6000           100            100            0.026979855    0.010275579    0              0.070663985    5.965177e-14   0              2.8803705e-06  1.6929675e-13  0              2.9963525    
   2300000   6000           100            100            0.026979853    0.010275579    0              0.070663981    5.3086066e-13  0              2.5633361e-05  1.6929675e-13  0              2.9963525    
   2400000   6000           100            100            0.026979853    0.010275579    0              0.07066398     1.4224463e-14  0              6.8684841e-07  1.6929675e-13  0              2.9963525    
   2500000   6000           100            100            0.026979853    0.010275579    0              0.070663981    5.2692882e-15  0              2.5443507e-07  1.6929675e-13  0              2.9963525    
   2600000   6000           100            100            0.026979853    0.010275579    0              0.070663981    9.2090577e-16  0              4.4467244e-08  1.6929675e-13  0              2.9963525    
   2700000   6000           100            100            0.026979853    0.010275579    0              0.070663981    6.7972169e-19  0              3.2821328e-11  1.6929675e-13  0              2.9963525    
   2800000   6000           100            100            0.026979853    0.010275579    0              0.070663981    2.1718911e-17  0              1.0487285e-09  1.6929675e-13  0              2.9963525    
   2900000   6000           100            100            0.026979853    0.010275579    0              0.070663981    9.7047406e-18  0              4.6860719e-10  1.6929675e-13  0              2.9963525    
   3000000   6000           100            100            0.026979853    0.010275579    0              0.070663981    2.5573965e-18  0              1.2348752e-10  1.6929675e-13  0              2.9963525    
Loop time of 290.078 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8935528.906 ns/day, 0.000 hours/ns, 10342.047 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.615     | 49.703     | 65.04      | 212.9 | 17.13
Neigh   | 0.9334     | 0.94456    | 0.95689    |   0.9 |  0.33
Comm    | 22.948     | 37.802     | 52.7       | 235.7 | 13.03
Output  | 0.27331    | 0.2735     | 0.27372    |   0.0 |  0.09
Modify  | 140.15     | 160.36     | 180.2      | 155.4 | 55.28
Other   |            | 41         |            |       | 14.13

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:          485.5 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019284285    2.9030295e-16  0              0.057852855    834977.62      0              4.0318081e+13  1.6929675e-13  0              3.3221757    
    200000   6000           100            100            0.0070682171   2.9030295e-16  0              0.021204651    214660.95      0              1.0365209e+13  1.6929675e-13  0              3.0665289    
    300000   6000           100            100            0.00093588295  2.9030295e-16  0              0.0028076488   7269.0483      0              3.5099633e+11  1.6929675e-13  0              3.0442254    
    400000   6000           100            100            0.048617688    0.021838592    0              0.12401447     14573.046      0              7.0368022e+11  1.6929675e-13  0              2.995181     
    500000   6000           100            100            0.025158271    0.014789041    0              0.060685772    2508.1524      0              1.211097e+11   1.6929675e-13  0              2.9966269    
    600000   6000           100            100            0.039375557    0.0083788863   0              0.10974779     13.665147      0              6.5984104e+08  1.6929675e-13  0              2.9955198    
    700000   6000           100            100            0.025553257    0.011744353    0              0.064915418    38.160363      0              1.8426273e+09  1.6929675e-13  0              2.9965469    
    800000   6000           100            100            0.026399649    0.011156456    0              0.068042492    4.4384472      0              2.1431673e+08  1.6929675e-13  0              2.9964718    
    900000   6000           100            100            0.027831631    0.011007094    0              0.072487799    0.005903617    0              285064.54      1.6929675e-13  0              2.9963574    
   1000000   6000           100            100            0.027057294    0.010965049    0              0.070206833    0.060905568    0              2940911.9      1.6929675e-13  0              2.9964146    
   1100000   6000           100            100            0.027203218    0.010979825    0              0.07062983     0.014930919    0              720960.62      1.6929675e-13  0              2.9964042    
   1200000   6000           100            100            0.02724254     0.010984618    0              0.070743002    0.00051289359  0              24765.796      1.6929675e-13  0              2.9964012    
   1300000   6000           100            100            0.027205209    0.010981352    0              0.070634276    3.7168992e-05  0              1794.7576      1.6929675e-13  0              2.996404     
   1400000   6000           100            100            0.027217073    0.010982375    0              0.070668845    3.417091e-05   0              1649.991       1.6929675e-13  0              2.9964031    
   1500000   6000           100            100            0.027216669    0.010982347    0              0.07066766     3.4463861e-06  0              166.41365      1.6929675e-13  0              2.9964032    
   1600000   6000           100            100            0.027215255    0.010982222    0              0.070663543    3.9238713e-09  0              0.1894697      1.6929675e-13  0              2.9964033    
   1700000   6000           100            100            0.027215957    0.010982283    0              0.070665589    4.9076879e-08  0              2.3697468      1.6929675e-13  0              2.9964032    
   1800000   6000           100            100            0.027215826    0.010982272    0              0.070665207    1.2087538e-08  0              0.58366394     1.6929675e-13  0              2.9964032    
   1900000   6000           100            100            0.027215792    0.010982269    0              0.070665106    4.2074119e-10  0              0.020316086    1.6929675e-13  0              2.9964032    
   2000000   6000           100            100            0.027215825    0.010982272    0              0.070665204    2.9398111e-11  0              0.0014195296   1.6929675e-13  0              2.9964032    
   2100000   6000           100            100            0.027215814    0.010982271    0              0.070665173    2.7546972e-11  0              0.0013301447   1.6929675e-13  0              2.9964032    
   2200000   6000           100            100            0.027215815    0.010982271    0              0.070665174    2.8024534e-12  0              0.00013532045  1.6929675e-13  0              2.9964032    
   2300000   6000           100            100            0.027215816    0.010982271    0              0.070665178    3.5824209e-15  0              1.7298228e-07  1.6929675e-13  0              2.9964032    
   2400000   6000           100            100            0.027215815    0.010982271    0              0.070665176    3.9319071e-14  0              1.8985772e-06  1.6929675e-13  0              2.9964032    
   2500000   6000           100            100            0.027215816    0.010982271    0              0.070665176    9.799127e-15   0              4.7316477e-07  1.6929675e-13  0              2.9964032    
   2600000   6000           100            100            0.027215816    0.010982271    0              0.070665176    3.7131302e-16  0              1.7929377e-08  1.6929675e-13  0              2.9964032    
   2700000   6000           100            100            0.027215816    0.010982271    0              0.070665176    5.5561464e-17  0              2.6828642e-09  1.6929675e-13  0              2.9964032    
   2800000   6000           100            100            0.027215816    0.010982271    0              0.070665176    2.2454139e-17  0              1.08423e-09    1.6929675e-13  0              2.9964032    
   2900000   6000           100            100            0.027215816    0.010982271    0              0.070665176    2.1911914e-18  0              1.0580479e-10  1.6929675e-13  0              2.9964032    
   3000000   6000           100            100            0.027215816    0.010982271    0              0.070665176    9.5677723e-18  0              4.6199348e-10  1.6929675e-13  0              2.9964032    
Loop time of 288.501 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8984370.461 ns/day, 0.000 hours/ns, 10398.577 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.366     | 49.352     | 64.254     | 212.1 | 17.11
Neigh   | 0.91585    | 0.92485    | 0.93437    |   0.7 |  0.32
Comm    | 23.383     | 37.834     | 53.209     | 234.8 | 13.11
Output  | 0.2667     | 0.2669     | 0.26714    |   0.0 |  0.09
Modify  | 138.76     | 159.09     | 179.04     | 155.6 | 55.14
Other   |            | 41.03      |            |       | 14.22

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019290597    2.9030295e-16  0              0.05787179     835385.41      0              4.0337772e+13  1.6929675e-13  0              3.3219557    
    200000   6000           100            100            0.0070827643   2.9030295e-16  0              0.021248293    215349.53      0              1.0398458e+13  1.6929675e-13  0              3.0661303    
    300000   6000           100            100            0.00095984014  2.9030295e-16  0              0.0028795204   7615.3642      0              3.6771868e+11  1.6929675e-13  0              3.0441037    
    400000   6000           100            100            0.03133163     0.014630142    0              0.079364748    15205.151      0              7.3420233e+11  1.6929675e-13  0              2.9961672    
    500000   6000           100            100            0.010549199    0.0049131575   0              0.02673444     1927.9655      0              9.3094552e+10  1.6929675e-13  0              2.9977587    
    600000   6000           100            100            0.027823175    0.010979858    0              0.072489667    348.30255      0              1.6818284e+10  1.6929675e-13  0              2.9963932    
    700000   6000           100            100            0.024418766    0.01013154     0              0.063124757    31.75071       0              1.5331281e+09  1.6929675e-13  0              2.9966496    
    800000   6000           100            100            0.027969767    0.010396442    0              0.073512859    4.2517642      0              2.0530248e+08  1.6929675e-13  0              2.9963801    
    900000   6000           100            100            0.026779856    0.010730992    0              0.069608576    0.56019931     0              27050020       1.6929675e-13  0              2.9964789    
   1000000   6000           100            100            0.0272395      0.010651425    0              0.071067076    0.073284396    0              3538641.2      1.6929675e-13  0              2.9964417    
   1100000   6000           100            100            0.027049581    0.010635117    0              0.070513625    0.0094466487   0              456144.86      1.6929675e-13  0              2.9964558    
   1200000   6000           100            100            0.027121802    0.010641098    0              0.07072431     0.0012191467   0              58868.232      1.6929675e-13  0              2.9964504    
   1300000   6000           100            100            0.027094378    0.010638797    0              0.070644338    0.00015675639  0              7569.2049      1.6929675e-13  0              2.9964524    
   1400000   6000           100            100            0.027104769    0.010639663    0              0.070674644    2.0111836e-05  0              971.12858      1.6929675e-13  0              2.9964517    
   1500000   6000           100            100            0.027100838    0.010639335    0              0.070663179    2.5727341e-06  0              124.22812      1.6929675e-13  0              2.9964519    
   1600000   6000           100            100            0.027102323    0.010639459    0              0.070667509    3.2816698e-07  0              15.846009      1.6929675e-13  0              2.9964518    
   1700000   6000           100            100            0.027101763    0.010639412    0              0.070665876    4.1729331e-08  0              2.0149601      1.6929675e-13  0              2.9964519    
   1800000   6000           100            100            0.027101974    0.01063943     0              0.070666491    5.2889024e-09  0              0.25538217     1.6929675e-13  0              2.9964519    
   1900000   6000           100            100            0.027101894    0.010639423    0              0.07066626     6.6798919e-10  0              0.032254807    1.6929675e-13  0              2.9964519    
   2000000   6000           100            100            0.027101924    0.010639426    0              0.070666347    8.4056669e-11  0              0.0040587957   1.6929675e-13  0              2.9964519    
   2100000   6000           100            100            0.027101913    0.010639425    0              0.070666314    1.0533774e-11  0              0.00050863827  1.6929675e-13  0              2.9964519    
   2200000   6000           100            100            0.027101917    0.010639425    0              0.070666327    1.3149315e-12  0              6.3493337e-05  1.6929675e-13  0              2.9964519    
   2300000   6000           100            100            0.027101916    0.010639425    0              0.070666322    1.6322448e-13  0              7.8815261e-06  1.6929675e-13  0              2.9964519    
   2400000   6000           100            100            0.027101916    0.010639425    0              0.070666324    2.0126316e-14  0              9.7182777e-07  1.6929675e-13  0              2.9964519    
   2500000   6000           100            100            0.027101916    0.010639425    0              0.070666323    2.3511567e-15  0              1.1352894e-07  1.6929675e-13  0              2.9964519    
   2600000   6000           100            100            0.027101916    0.010639425    0              0.070666323    3.1504642e-16  0              1.5212464e-08  1.6929675e-13  0              2.9964519    
   2700000   6000           100            100            0.027101916    0.010639425    0              0.070666323    5.8223927e-18  0              2.8114251e-10  1.6929675e-13  0              2.9964519    
   2800000   6000           100            100            0.027101916    0.010639425    0              0.070666323    6.1575013e-20  0              2.973237e-12   1.6929675e-13  0              2.9964519    
   2900000   6000           100            100            0.027101916    0.010639425    0              0.070666323    1.6768293e-19  0              8.0968086e-12  1.6929675e-13  0              2.9964519    
   3000000   6000           100            100            0.027101916    0.010639425    0              0.070666323    6.2002501e-24  0              2.9938789e-16  1.6929675e-13  0              2.9964519    
Loop time of 288.202 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8993685.384 ns/day, 0.000 hours/ns, 10409.358 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.105     | 49.238     | 64.62      | 212.8 | 17.08
Neigh   | 0.95154    | 0.96371    | 0.97631    |   0.9 |  0.33
Comm    | 22.091     | 37.145     | 52.728     | 238.8 | 12.89
Output  | 0.26876    | 0.26894    | 0.26916    |   0.0 |  0.09
Modify  | 138.75     | 159.28     | 179.98     | 157.4 | 55.27
Other   |            | 41.3       |            |       | 14.33

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019296684    2.9030295e-16  0              0.057890052    835778.78      0              4.0356766e+13  1.6929675e-13  0              3.3217435    
    200000   6000           100            100            0.0070967981   2.9030295e-16  0              0.021290394    216014.48      0              1.0430566e+13  1.6929675e-13  0              3.0657449    
    300000   6000           100            100            0.00098299822  2.9030295e-16  0              0.0029489947   7956.5705      0              3.8419431e+11  1.6929675e-13  0              3.0439809    
    400000   6000           100            100            0.017779335    0.0090223263   0              0.044315677    15094.038      0              7.288371e+11   1.6929675e-13  0              2.997126     
    500000   6000           100            100            0.0039491084   0.0023226711   0              0.0095246543   1050.9085      0              5.074461e+10   1.6929675e-13  0              2.9986465    
    600000   6000           100            100            0.015833585    0.0078916359   0              0.039609119    69.85931       0              3.3732561e+09  1.6929675e-13  0              2.9973643    
    700000   6000           100            100            0.031663901    0.010066628    0              0.084925074    0.099174947    0              4788803.3      1.6929675e-13  0              2.9961639    
    800000   6000           100            100            0.025994847    0.01073574     0              0.067248801    3.3649332      0              1.6248058e+08  1.6929675e-13  0              2.996585     
    900000   6000           100            100            0.027013686    0.010738295    0              0.070302764    0.82316197     0              39747545       1.6929675e-13  0              2.9965069    
   1000000   6000           100            100            0.027372377    0.010828374    0              0.071288758    0.020819606    0              1005304.3      1.6929675e-13  0              2.9964834    
   1100000   6000           100            100            0.027083319    0.010800524    0              0.070449434    0.0036899334   0              178173.68      1.6929675e-13  0              2.996504     
   1200000   6000           100            100            0.027161581    0.010807704    0              0.070677038    0.0020645505   0              99689.755      1.6929675e-13  0              2.9964983    
   1300000   6000           100            100            0.02716695     0.010808149    0              0.070692701    0.00012647927  0              6107.2311      1.6929675e-13  0              2.9964979    
   1400000   6000           100            100            0.027154092    0.010806964    0              0.070655313    1.7271077e-06  0              83.395851      1.6929675e-13  0              2.9964989    
   1500000   6000           100            100            0.027158869    0.01080741     0              0.070669198    4.318973e-06   0              208.54775      1.6929675e-13  0              2.9964985    
   1600000   6000           100            100            0.027158559    0.010807379    0              0.070668298    5.0677899e-07  0              24.470544      1.6929675e-13  0              2.9964985    
   1700000   6000           100            100            0.027158048    0.010807332    0              0.070666811    5.9473856e-10  0              0.028717797    1.6929675e-13  0              2.9964986    
   1800000   6000           100            100            0.027158308    0.010807356    0              0.070667569    7.315887e-09   0              0.353258       1.6929675e-13  0              2.9964985    
   1900000   6000           100            100            0.027158266    0.010807352    0              0.070667445    1.590304e-09   0              0.076790091    1.6929675e-13  0              2.9964986    
   2000000   6000           100            100            0.027158249    0.010807351    0              0.070667396    3.0576635e-11  0              0.0014764363   1.6929675e-13  0              2.9964986    
   2100000   6000           100            100            0.027158262    0.010807352    0              0.070667434    9.0671135e-12  0              0.00043781846  1.6929675e-13  0              2.9964986    
   2200000   6000           100            100            0.027158259    0.010807352    0              0.070667424    4.1354431e-12  0              0.00019968575  1.6929675e-13  0              2.9964986    
   2300000   6000           100            100            0.027158258    0.010807352    0              0.070667423    2.1619645e-13  0              1.0439353e-05  1.6929675e-13  0              2.9964986    
   2400000   6000           100            100            0.027158259    0.010807352    0              0.070667425    5.6012139e-15  0              2.7046257e-07  1.6929675e-13  0              2.9964986    
   2500000   6000           100            100            0.027158259    0.010807352    0              0.070667424    9.0283065e-15  0              4.3594461e-07  1.6929675e-13  0              2.9964986    
   2600000   6000           100            100            0.027158259    0.010807352    0              0.070667424    8.6661394e-16  0              4.1845686e-08  1.6929675e-13  0              2.9964986    
   2700000   6000           100            100            0.027158259    0.010807352    0              0.070667424    1.440951e-17   0              6.9578365e-10  1.6929675e-13  0              2.9964986    
   2800000   6000           100            100            0.027158259    0.010807352    0              0.070667424    5.3467642e-18  0              2.5817611e-10  1.6929675e-13  0              2.9964986    
   2900000   6000           100            100            0.027158259    0.010807352    0              0.070667424    9.1728503e-18  0              4.4292411e-10  1.6929675e-13  0              2.9964986    
   3000000   6000           100            100            0.027158259    0.010807352    0              0.070667424    7.9042616e-18  0              3.816685e-10   1.6929675e-13  0              2.9964986    
Loop time of 289.29 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8959876.812 ns/day, 0.000 hours/ns, 10370.228 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.358     | 49.439     | 64.663     | 213.1 | 17.09
Neigh   | 0.92494    | 0.93722    | 0.94974    |   0.9 |  0.32
Comm    | 23.314     | 38.023     | 52.908     | 234.6 | 13.14
Output  | 0.27166    | 0.27186    | 0.27209    |   0.0 |  0.09
Modify  | 139.75     | 159.7      | 179.55     | 154.3 | 55.20
Other   |            | 40.92      |            |       | 14.14

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.01930256     2.9030295e-16  0              0.05790768     836158.58      0              4.0375105e+13  1.6929675e-13  0              3.3215384    
    200000   6000           100            100            0.0071103499   2.9030295e-16  0              0.02133105     216657.19      0              1.0461601e+13  1.6929675e-13  0              3.065372     
    300000   6000           100            100            0.0010054028   2.9030295e-16  0              0.0030162084   8292.6411      0              4.0042196e+11  1.6929675e-13  0              3.0438572    
    400000   6000           100            100            0.0082186131   0.0052599486   0              0.019395891    14462.533      0              6.9834394e+11  1.6929675e-13  0              2.9980406    
    500000   6000           100            100            0.0013195385   0.0010817214   0              0.002876894    359.08537      0              1.7338947e+10  1.6929675e-13  0              2.9992352    
    600000   6000           100            100            0.016721026    0.0080679952   0              0.042095083    117.36997      0              5.6673757e+09  1.6929675e-13  0              2.9973369    
    700000   6000           100            100            0.025015931    0.010691292    0              0.064356502    37.781657      0              1.824341e+09   1.6929675e-13  0              2.9966956    
    800000   6000           100            100            0.028495975    0.010664902    0              0.074823024    2.2193683      0              1.0716535e+08  1.6929675e-13  0              2.9964429    
    900000   6000           100            100            0.027634529    0.010755803    0              0.072147783    0.33751871     0              16297571       1.6929675e-13  0              2.9965081    
   1000000   6000           100            100            0.027076744    0.010809273    0              0.070420961    0.10039735     0              4847828.7      1.6929675e-13  0              2.9965496    
   1100000   6000           100            100            0.027066352    0.010783474    0              0.070415582    7.0901579e-05  0              3423.5835      1.6929675e-13  0              2.9965495    
   1200000   6000           100            100            0.02714572     0.010791326    0              0.070645834    0.0019883871   0              96012.095      1.6929675e-13  0              2.9965439    
   1300000   6000           100            100            0.027163572    0.010793124    0              0.070697594    7.6076443e-05  0              3673.4592      1.6929675e-13  0              2.9965427    
   1400000   6000           100            100            0.027156793    0.01079241     0              0.070677968    1.6676408e-05  0              805.24404      1.6929675e-13  0              2.9965432    
   1500000   6000           100            100            0.027152888    0.010792011    0              0.070666655    4.3205203e-06  0              208.62246      1.6929675e-13  0              2.9965434    
   1600000   6000           100            100            0.027152939    0.010792018    0              0.070666799    8.2763794e-09  0              0.39963674     1.6929675e-13  0              2.9965434    
   1700000   6000           100            100            0.027153477    0.010792074    0              0.070668356    9.0200775e-08  0              4.3554726      1.6929675e-13  0              2.9965434    
   1800000   6000           100            100            0.027153589    0.010792085    0              0.070668681    2.9304896e-09  0              0.14150285     1.6929675e-13  0              2.9965434    
   1900000   6000           100            100            0.027153541    0.01079208     0              0.070668543    8.1343941e-10  0              0.039278078    1.6929675e-13  0              2.9965434    
   2000000   6000           100            100            0.027153515    0.010792077    0              0.070668468    1.8506511e-10  0              0.0089361318   1.6929675e-13  0              2.9965434    
   2100000   6000           100            100            0.027153516    0.010792077    0              0.070668471    7.0015577e-13  0              3.3808017e-05  1.6929675e-13  0              2.9965434    
   2200000   6000           100            100            0.02715352     0.010792078    0              0.070668481    4.0754555e-12  0              0.00019678916  1.6929675e-13  0              2.9965434    
   2300000   6000           100            100            0.02715352     0.010792078    0              0.070668483    1.1180789e-13  0              5.398803e-06   1.6929675e-13  0              2.9965434    
   2400000   6000           100            100            0.02715352     0.010792078    0              0.070668482    3.9035719e-14  0              1.8848952e-06  1.6929675e-13  0              2.9965434    
   2500000   6000           100            100            0.02715352     0.010792078    0              0.070668482    7.960913e-15   0              3.84404e-07    1.6929675e-13  0              2.9965434    
   2600000   6000           100            100            0.02715352     0.010792078    0              0.070668482    2.7567783e-17  0              1.3311496e-09  1.6929675e-13  0              2.9965434    
   2700000   6000           100            100            0.02715352     0.010792078    0              0.070668482    1.8099357e-16  0              8.7395318e-09  1.6929675e-13  0              2.9965434    
   2800000   6000           100            100            0.02715352     0.010792078    0              0.070668482    2.5784581e-19  0              1.2450451e-11  1.6929675e-13  0              2.9965434    
   2900000   6000           100            100            0.02715352     0.010792078    0              0.070668482    8.5958442e-18  0              4.1506255e-10  1.6929675e-13  0              2.9965434    
   3000000   6000           100            100            0.02715352     0.010792078    0              0.070668482    8.3772355e-18  0              4.0450672e-10  1.6929675e-13  0              2.9965434    
Loop time of 288.71 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8977852.887 ns/day, 0.000 hours/ns, 10391.033 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.159     | 49.239     | 64.257     | 213.0 | 17.05
Neigh   | 0.92344    | 0.93522    | 0.94762    |   0.9 |  0.32
Comm    | 22.61      | 37.017     | 51.544     | 236.2 | 12.82
Output  | 0.26887    | 0.26905    | 0.26926    |   0.0 |  0.09
Modify  | 140.44     | 160.24     | 180.14     | 156.1 | 55.50
Other   |            | 41.01      |            |       | 14.20

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019308238    2.9030295e-16  0              0.057924714    836525.62      0              4.0392828e+13  1.6929675e-13  0              3.3213401    
    200000   6000           100            100            0.0071234472   2.9030295e-16  0              0.021370342    217278.93      0              1.0491622e+13  1.6929675e-13  0              3.0650108    
    300000   6000           100            100            0.0010270949   2.9030295e-16  0              0.0030812847   8623.5609      0              4.1640089e+11  1.6929675e-13  0              3.043733     
    400000   6000           100            100            0.0021801937   0.0022936789   0              0.0042469022   13536.814      0              6.536443e+11   1.6929675e-13  0              2.9989015    
    500000   6000           100            100            0.00070335059  0.00092331398  0              0.0011867378   27.217551      0              1.3142381e+09  1.6929675e-13  0              2.9995275    
    600000   6000           100            100            0.029088358    0.010407735    0              0.076857341    348.65948      0              1.6835518e+10  1.6929675e-13  0              2.9964544    
    700000   6000           100            100            0.023825518    0.0098461885   0              0.061630365    26.902296      0              1.2990156e+09  1.6929675e-13  0              2.9968147    
    800000   6000           100            100            0.025415834    0.010361306    0              0.065886197    0.77011382     0              37186040       1.6929675e-13  0              2.9967039    
    900000   6000           100            100            0.026539998    0.01083461     0              0.068785383    0.0057974826   0              279939.69      1.6929675e-13  0              2.996632     
   1000000   6000           100            100            0.026982337    0.010889796    0              0.070057215    0.027109281    0              1309010.1      1.6929675e-13  0              2.9966011    
   1100000   6000           100            100            0.027133582    0.010889254    0              0.070511492    0.0098410391   0              475188.56      1.6929675e-13  0              2.9965902    
   1200000   6000           100            100            0.027179929    0.010894251    0              0.070645536    0.0019899241   0              96086.311      1.6929675e-13  0              2.9965871    
   1300000   6000           100            100            0.027190042    0.010895485    0              0.070674641    0.00027887985  0              13466.11       1.6929675e-13  0              2.9965864    
   1400000   6000           100            100            0.027190578    0.010895537    0              0.070676196    2.7521426e-05  0              1328.9112      1.6929675e-13  0              2.9965864    
   1500000   6000           100            100            0.027189576    0.010895406    0              0.070673321    1.653791e-06   0              79.85565       1.6929675e-13  0              2.9965864    
   1600000   6000           100            100            0.027188828    0.01089531     0              0.070671173    2.5563029e-08  0              1.2343472      1.6929675e-13  0              2.9965865    
   1700000   6000           100            100            0.027188459    0.010895263    0              0.070670113    4.298905e-09   0              0.20757874     1.6929675e-13  0              2.9965865    
   1800000   6000           100            100            0.02718831     0.010895244    0              0.070669687    4.3254183e-09  0              0.20885897     1.6929675e-13  0              2.9965865    
   1900000   6000           100            100            0.02718826     0.010895238    0              0.070669543    1.2607516e-09  0              0.06087718     1.6929675e-13  0              2.9965865    
   2000000   6000           100            100            0.027188247    0.010895236    0              0.070669503    2.2726843e-10  0              0.010973979    1.6929675e-13  0              2.9965865    
   2100000   6000           100            100            0.027188244    0.010895236    0              0.070669496    2.8925597e-11  0              0.0013967136   1.6929675e-13  0              2.9965865    
   2200000   6000           100            100            0.027188244    0.010895236    0              0.070669496    2.5394655e-12  0              0.0001226217   1.6929675e-13  0              2.9965865    
   2300000   6000           100            100            0.027188245    0.010895236    0              0.070669498    1.2218619e-13  0              5.8999338e-06  1.6929675e-13  0              2.9965865    
   2400000   6000           100            100            0.027188245    0.010895236    0              0.070669498    3.5258956e-16  0              1.7025288e-08  1.6929675e-13  0              2.9965865    
   2500000   6000           100            100            0.027188245    0.010895236    0              0.070669499    1.1709955e-15  0              5.6543183e-08  1.6929675e-13  0              2.9965865    
   2600000   6000           100            100            0.027188245    0.010895236    0              0.070669499    5.8380916e-16  0              2.8190055e-08  1.6929675e-13  0              2.9965865    
   2700000   6000           100            100            0.027188245    0.010895236    0              0.070669499    1.7707918e-16  0              8.5505198e-09  1.6929675e-13  0              2.9965865    
   2800000   6000           100            100            0.027188245    0.010895236    0              0.070669499    1.8904582e-17  0              9.1283462e-10  1.6929675e-13  0              2.9965865    
   2900000   6000           100            100            0.027188245    0.010895236    0              0.070669499    3.1825142e-18  0              1.5367222e-10  1.6929675e-13  0              2.9965865    
   3000000   6000           100            100            0.027188245    0.010895236    0              0.070669499    6.4503466e-18  0              3.1146415e-10  1.6929675e-13  0              2.9965865    
Loop time of 290.088 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8935207.892 ns/day, 0.000 hours/ns, 10341.676 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.207     | 49.084     | 64.002     | 211.9 | 16.92
Neigh   | 0.93041    | 0.93811    | 0.94655    |   0.7 |  0.32
Comm    | 23.271     | 37.756     | 53.071     | 235.3 | 13.02
Output  | 0.26542    | 0.26561    | 0.26585    |   0.0 |  0.09
Modify  | 138.75     | 159.66     | 181.8      | 161.5 | 55.04
Other   |            | 42.39      |            |       | 14.61

Nlocal:          707.5 ave         854 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           4 max           4 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:            485 ave         686 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019313729    2.9030295e-16  0              0.057941186    836880.64      0              4.0409971e+13  1.6929675e-13  0              3.3211482    
    200000   6000           100            100            0.0071361166   2.9030295e-16  0              0.02140835     217880.89      0              1.0520688e+13  1.6929675e-13  0              3.0646608    
    300000   6000           100            100            0.0010481136   2.9030295e-16  0              0.0031443409   8949.3568      0              4.3213241e+11  1.6929675e-13  0              3.0436084    
    400000   6000           100            100           -0.00067872484  0.00033174626  0             -0.0023679208   12505.049      0              6.0382406e+11  1.6929675e-13  0              2.9997056    
    500000   6000           100            100            0.00073719717  0.00071534826  0              0.0014962433   65.652577      0              3.170128e+09   1.6929675e-13  0              2.9995486    
    600000   6000           100            100            0.040141832    0.0087711828   0              0.11165431     19.558621      0              9.4441582e+08  1.6929675e-13  0              2.9957695    
    700000   6000           100            100            0.031864477    0.010954995    0              0.084638435    4.7463962      0              2.2918649e+08  1.6929675e-13  0              2.9963135    
    800000   6000           100            100            0.029060238    0.01122691     0              0.075953804    0.004350193    0              210055.25      1.6929675e-13  0              2.9965052    
    900000   6000           100            100            0.02783427     0.011084053    0              0.072418759    0.14704008     0              7100039.4      1.6929675e-13  0              2.9965867    
   1000000   6000           100            100            0.027399757    0.011041556    0              0.071157715    0.060318521    0              2912565.5      1.6929675e-13  0              2.9966164    
   1100000   6000           100            100            0.027263103    0.011020344    0              0.070768964    0.013444787    0              649200.62      1.6929675e-13  0              2.9966257    
   1200000   6000           100            100            0.027229017    0.011014916    0              0.070672136    0.0021325906   0              102975.17      1.6929675e-13  0              2.996628     
   1300000   6000           100            100            0.027224145    0.011014105    0              0.07065833     0.00025401724  0              12265.584      1.6929675e-13  0              2.9966284    
   1400000   6000           100            100            0.027225412    0.011014285    0              0.07066195     2.1798822e-05  0              1052.5871      1.6929675e-13  0              2.9966283    
   1500000   6000           100            100            0.027226935    0.011014517    0              0.070666287    1.0873474e-06  0              52.504114      1.6929675e-13  0              2.9966282    
   1600000   6000           100            100            0.027227805    0.011014652    0              0.070668763    6.942186e-09   0              0.33521332     1.6929675e-13  0              2.9966282    
   1700000   6000           100            100            0.027228195    0.011014713    0              0.070669872    6.9949315e-09  0              0.33776021     1.6929675e-13  0              2.9966281    
   1800000   6000           100            100            0.027228344    0.011014736    0              0.070670296    4.679272e-09   0              0.2259453      1.6929675e-13  0              2.9966281    
   1900000   6000           100            100            0.027228393    0.011014744    0              0.070670436    1.2591683e-09  0              0.06080073     1.6929675e-13  0              2.9966281    
   2000000   6000           100            100            0.027228407    0.011014746    0              0.070670475    2.2602981e-10  0              0.01091417     1.6929675e-13  0              2.9966281    
   2100000   6000           100            100            0.02722841     0.011014746    0              0.070670482    3.0177443e-11  0              0.0014571607   1.6929675e-13  0              2.9966281    
   2200000   6000           100            100            0.02722841     0.011014746    0              0.070670482    2.9861554e-12  0              0.00014419076  1.6929675e-13  0              2.9966281    
   2300000   6000           100            100            0.027228409    0.011014746    0              0.070670481    1.9424561e-13  0              9.3794254e-06  1.6929675e-13  0              2.9966281    
   2400000   6000           100            100            0.027228409    0.011014746    0              0.07067048     4.6664225e-15  0              2.2532484e-07  1.6929675e-13  0              2.9966281    
   2500000   6000           100            100            0.027228409    0.011014746    0              0.07067048     1.9524297e-16  0              9.4275845e-09  1.6929675e-13  0              2.9966281    
   2600000   6000           100            100            0.027228409    0.011014746    0              0.07067048     3.491998e-16   0              1.6861609e-08  1.6929675e-13  0              2.9966281    
   2700000   6000           100            100            0.027228409    0.011014746    0              0.07067048     6.4985807e-17  0              3.137932e-09   1.6929675e-13  0              2.9966281    
   2800000   6000           100            100            0.027228409    0.011014746    0              0.07067048     1.0342455e-17  0              4.9940016e-10  1.6929675e-13  0              2.9966281    
   2900000   6000           100            100            0.027228409    0.011014746    0              0.07067048     3.1573252e-18  0              1.5245593e-10  1.6929675e-13  0              2.9966281    
   3000000   6000           100            100            0.027228409    0.011014746    0              0.07067048     2.2759266e-19  0              1.0989635e-11  1.6929675e-13  0              2.9966281    
Loop time of 289.095 on 4 procs for 3000000 steps with 2830 atoms

Performance: 8965908.879 ns/day, 0.000 hours/ns, 10377.209 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.134     | 49.251     | 64.34      | 214.6 | 17.04
Neigh   | 0.92698    | 0.93891    | 0.95139    |   0.9 |  0.32
Comm    | 22.759     | 37.396     | 52.08      | 237.5 | 12.94
Output  | 0.274      | 0.2742     | 0.27444    |   0.0 |  0.09
Modify  | 140.04     | 160.03     | 180.35     | 156.5 | 55.36
Other   |            | 41.2       |            |       | 14.25

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:          485.5 ave         688 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1942
Ave neighs/atom = 0.68621908
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 ${n1e1} -50 50 -50 50 units box
region box block -3000.00000000001 3000.00000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -3000.00000000001 3000.00000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-3000 -50 -50) to (3000 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -2121.32034355965 2121.32034355965 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1415 atoms
  using lattice units in orthogonal box = (-3000 -50 -50) to (3000 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1415 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1415 settings made for mass


group substrate region substrate           # Define gorup
1415 atoms in group substrate
group slider1 region slider1
1415 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1415 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 3871 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.95 | 30.95 | 30.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6000           100            100            9.6767651e-17  2.9030295e-16  0              0              0              0              0              1.6929675e-13  0              6            
    100000   6000           100            100            0.019319043    2.9030295e-16  0              0.057957129    837224.3       0              4.0426565e+13  1.6929675e-13  0              3.3209624    
    200000   6000           100            100            0.0071483819   2.9030295e-16  0              0.021445146    218464.14      0              1.0548852e+13  1.6929675e-13  0              3.0643213    
    300000   6000           100            100            0.0010684958   2.9030295e-16  0              0.0032054875   9270.0827      0              4.4761912e+11  1.6929675e-13  0              3.0434838    
    400000   6000           100            100           -0.00093348203  2.9030295e-16  0             -0.0028004461   11502.881      0              5.5543297e+11  1.6929675e-13  0              3.0004543    
    500000   6000           100            100            0.0014279956   0.00082087928  0              0.0034631074   429.70884      0              2.0749102e+10  1.6929675e-13  0              2.99933      
    600000   6000           100            100            0.035019418    0.010401188    0              0.094657067    236.9135       0              1.1439705e+10  1.6929675e-13  0              2.9961385    
    700000   6000           100            100            0.026953053    0.01129892     0              0.069560238    48.172477      0              2.3260765e+09  1.6929675e-13  0              2.9966895    
    800000   6000           100            100            0.025355308    0.010275988    0              0.065789937    0.81822748     0              39509277       1.6929675e-13  0              2.9967839    
    900000   6000           100            100            0.026709357    0.010711353    0              0.069416717    0.49940901     0              24114674       1.6929675e-13  0              2.9966982    
   1000000   6000           100            100            0.027302015    0.01086752     0              0.071038524    0.087405392    0              4220493.6      1.6929675e-13  0              2.9966598    
   1100000   6000           100            100            0.027262306    0.010861258    0              0.070925659    0.00075528099  0              36469.816      1.6929675e-13  0              2.9966622    
   1200000   6000           100            100            0.027176091    0.010848209    0              0.070680065    0.0021280183   0              102754.39      1.6929675e-13  0              2.996668     
   1300000   6000           100            100            0.027161698    0.010845944    0              0.07063915     4.704384e-05   0              2271.5787      1.6929675e-13  0              2.996669     
   1400000   6000           100            100            0.027170023    0.010847201    0              0.070662867    2.1614428e-05  0              1043.6834      1.6929675e-13  0              2.9966684    
   1500000   6000           100            100            0.02717387     0.010847793    0              0.070673818    3.9574398e-06  0              191.0906       1.6929675e-13  0              2.9966682    
   1600000   6000           100            100            0.027173629    0.01084776     0              0.070673127    2.9378058e-08  0              1.4185613      1.6929675e-13  0              2.9966682    
   1700000   6000           100            100            0.027173055    0.010847672    0              0.070671492    9.4535854e-08  0              4.5647981      1.6929675e-13  0              2.9966682    
   1800000   6000           100            100            0.027172956    0.010847657    0              0.070671211    2.2360273e-09  0              0.10796975     1.6929675e-13  0              2.9966682    
   1900000   6000           100            100            0.027173011    0.010847665    0              0.070671367    9.3819048e-10  0              0.045301861    1.6929675e-13  0              2.9966682    
   2000000   6000           100            100            0.027173037    0.010847669    0              0.070671441    1.7925642e-10  0              0.0086556511   1.6929675e-13  0              2.9966682    
   2100000   6000           100            100            0.027173035    0.010847669    0              0.070671437    1.1332745e-12  0              5.4721769e-05  1.6929675e-13  0              2.9966682    
   2200000   6000           100            100            0.027173031    0.010847668    0              0.070671426    4.1953078e-12  0              0.0002025764   1.6929675e-13  0              2.9966682    
   2300000   6000           100            100            0.027173031    0.010847668    0              0.070671424    1.0609694e-13  0              5.1230418e-06  1.6929675e-13  0              2.9966682    
   2400000   6000           100            100            0.027173031    0.010847668    0              0.070671425    4.0778477e-14  0              1.9690467e-06  1.6929675e-13  0              2.9966682    
   2500000   6000           100            100            0.027173031    0.010847668    0              0.070671425    8.1089033e-15  0              3.9154992e-07  1.6929675e-13  0              2.9966682    
   2600000   6000           100            100            0.027173031    0.010847668    0              0.070671425    5.1152074e-17  0              2.4699506e-09  1.6929675e-13  0              2.9966682    
   2700000   6000           100            100            0.027173031    0.010847668    0              0.070671425    1.5930898e-16  0              7.6924607e-09  1.6929675e-13  0              2.9966682    
   2800000   6000           100            100            0.027173031    0.010847668    0              0.070671425    1.5091956e-17  0              7.2873652e-10  1.6929675e-13  0              2.9966682    
   2900000   6000           100            100            0.027173031    0.010847668    0              0.070671425    9.851823e-18   0              4.7570928e-10  1.6929675e-13  0              2.9966682    
   3000000   6000           100            100            0.027173031    0.010847668    0              0.070671425    5.872809e-19   0              2.8357693e-11  1.6929675e-13  0              2.9966682    
Loop time of 287.393 on 4 procs for 3000000 steps with 2830 atoms

Performance: 9019009.810 ns/day, 0.000 hours/ns, 10438.669 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 34.062     | 49.022     | 63.942     | 211.6 | 17.06
Neigh   | 0.93579    | 0.94705    | 0.95851    |   0.8 |  0.33
Comm    | 22.41      | 37.063     | 52.192     | 236.8 | 12.90
Output  | 0.26478    | 0.26498    | 0.26521    |   0.0 |  0.09
Modify  | 138.48     | 158.78     | 179.63     | 157.7 | 55.25
Other   |            | 41.31      |            |       | 14.37

Nlocal:          707.5 ave         855 max         561 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:              4 ave           5 max           3 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:            485 ave         687 max         284 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1940
Ave neighs/atom = 0.68551237
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 3:15:36

LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 15000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027084716    3.3421514e-20  0              0.081254148    1754381.5      0              8.4712803e+13 -1.5            0              3.3243215    
    200000   9000           100            100            0.0099535331   7.8828669e-21  0              0.029860599    452878.11      0              2.1867863e+13 -1.5            0              3.0646376    
    300000   9000           100            100            0.0017281125   5.96542e-22    0              0.0051843375   25134.574      0              1.2136586e+12 -1.5            0              3.0407149    
    400000   9000           100            100           -0.00055445153 -5.2565082e-21  0             -0.0016633546   3641.4229      0              1.7583128e+11 -1.5            0              3.0075702    
    500000   9000           100            100           -0.00015226638 -1.8082515e-20  0             -0.00045679914  255.61498      0              1.2342732e+10 -1.5            0              3.000217     
    600000   9000           100            100            0.022060226   -1.1497841e-15  0              0.066180678    336.15708      0              1.6231822e+10 -1.5            0              2.9982989    
    700000   9000           100            100            0.032517005   -1.6713486e-15  0              0.097551014    71.670933      0              3.4607329e+09 -1.5            0              2.9978126    
    800000   9000           100            100            0.034548003   -1.7832492e-15  0              0.10364401     5.6298041      0              2.7184309e+08 -1.5            0              2.9977172    
    900000   9000           100            100            0.032656131   -1.683892e-15   0              0.097968393    0.18284771     0              8829061.7     -1.5            0              2.9978026    
   1000000   9000           100            100            0.033558342   -1.7306536e-15  0              0.10067503     0.00041536308  0              20056.397     -1.5            0              2.9977621    
   1100000   9000           100            100            0.033234421   -1.7140185e-15  0              0.099703263    0.0040536569   0              195736.58     -1.5            0              2.9977765    
   1200000   9000           100            100            0.033324034   -1.7185695e-15  0              0.099972103    0.0013299447   0              64218.27      -1.5            0              2.9977726    
   1300000   9000           100            100            0.033308037   -1.7177792e-15  0              0.09992411     0.00021473753  0              10368.907     -1.5            0              2.9977733    
   1400000   9000           100            100            0.033307081   -1.7177171e-15  0              0.099921244    2.1037976e-05  0              1015.8486     -1.5            0              2.9977733    
   1500000   9000           100            100            0.033309581   -1.7178496e-15  0              0.099928742    1.0979066e-06  0              53.013979     -1.5            0              2.9977732    
   1600000   9000           100            100            0.033308168   -1.7177761e-15  0              0.099924504    8.2837977e-09  0              0.39999494    -1.5            0              2.9977733    
   1700000   9000           100            100            0.033308732   -1.7178052e-15  0              0.099926195    4.8772089e-09  0              0.23550296    -1.5            0              2.9977732    
   1800000   9000           100            100            0.033308557   -1.7177962e-15  0              0.09992567     2.8688277e-09  0              0.13852542    -1.5            0              2.9977732    
   1900000   9000           100            100            0.033308596   -1.7177982e-15  0              0.099925788    5.9345125e-10  0              0.028655637   -1.5            0              2.9977732    
   2000000   9000           100            100            0.033308593   -1.7177981e-15  0              0.099925779    7.1742318e-11  0              0.0034641798  -1.5            0              2.9977732    
   2100000   9000           100            100            0.03330859    -1.7177979e-15  0              0.09992577     5.0980426e-12  0              0.00024616623 -1.5            0              2.9977732    
   2200000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925777    1.3289806e-13  0              6.4171719e-06 -1.5            0              2.9977732    
   2300000   9000           100            100            0.033308591   -1.717798e-15   0              0.099925774    2.1275931e-15  0              1.0273386e-07 -1.5            0              2.9977732    
   2400000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    5.0931036e-15  0              2.4592774e-07 -1.5            0              2.9977732    
   2500000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    1.4277642e-15  0              6.8941622e-08 -1.5            0              2.9977732    
   2600000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    1.2841505e-16  0              6.2007033e-09 -1.5            0              2.9977732    
   2700000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    3.6156546e-18  0              1.7458702e-10 -1.5            0              2.9977732    
   2800000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    1.5090843e-17  0              7.2868278e-10 -1.5            0              2.9977732    
   2900000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    1.5982901e-18  0              7.7175708e-11 -1.5            0              2.9977732    
   3000000   9000           100            100            0.033308592   -1.717798e-15   0              0.099925775    5.8118727e-18  0              2.8063453e-10 -1.5            0              2.9977732    
Loop time of 714.45 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3627965.571 ns/day, 0.000 hours/ns, 4199.034 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 316.97     | 320.12     | 325.07     |  16.8 | 44.81
Neigh   | 1.5235     | 1.5442     | 1.5646     |   1.6 |  0.22
Comm    | 36.284     | 39.777     | 43.029     |  45.9 |  5.57
Output  | 0.44571    | 0.44584    | 0.44602    |   0.0 |  0.06
Modify  | 309.02     | 310.68     | 312.99     |   9.0 | 43.49
Other   |            | 41.89      |            |       |  5.86

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 166
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 20000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027208938    3.3321838e-20  0              0.081626815    1766185.3      0              8.5282767e+13 -1.5            0              3.3218441    
    200000   9000           100            100            0.010180797    8.2745097e-21  0              0.030542392    468977.95      0              2.2645267e+13 -1.5            0              3.0608599    
    300000   9000           100            100            0.0020533919   9.5809328e-22  0              0.0061601756   34266.396      0              1.6546016e+12 -1.5            0              3.0391561    
    400000   9000           100            100            6.5076859e-05 -4.0660297e-21  0              0.00019523058  46.119395      0              2.2269405e+09 -1.5            0              3.0096766    
    500000   9000           100            100            0.068547303   -3.5774879e-15  0              0.20564191     3738.2053      0              1.8050455e+11 -1.5            0              2.9970082    
    600000   9000           100            100            0.054915058   -2.8337398e-15  0              0.16474517     9.0149406      0              4.3529922e+08 -1.5            0              2.9974336    
    700000   9000           100            100            0.031815375   -1.6354224e-15  0              0.095446126    80.87182       0              3.9050108e+09 -1.5            0              2.9982208    
    800000   9000           100            100            0.030848297   -1.5916589e-15  0              0.092544891    0.045410978    0              2192733.6     -1.5            0              2.9982536    
    900000   9000           100            100            0.03320838    -1.7138895e-15  0              0.09962514     1.2280745      0              59299320      -1.5            0              2.9981653    
   1000000   9000           100            100            0.033600885   -1.7334648e-15  0              0.10080265     0.012886669    0              622251.15     -1.5            0              2.9981512    
   1100000   9000           100            100            0.033362138   -1.721006e-15   0              0.10008641     0.0143207      0              691495.34     -1.5            0              2.9981601    
   1200000   9000           100            100            0.033284406   -1.7170594e-15  0              0.099853219    0.00084705239  0              40901.128     -1.5            0              2.9981629    
   1300000   9000           100            100            0.033303283   -1.7180586e-15  0              0.099909849    0.00011542635  0              5573.5252     -1.5            0              2.9981622    
   1400000   9000           100            100            0.033315123   -1.718665e-15   0              0.099945368    2.4059563e-05  0              1161.7502     -1.5            0              2.9981618    
   1500000   9000           100            100            0.033314359   -1.718622e-15   0              0.099943078    4.4917779e-07  0              21.689188     -1.5            0              2.9981618    
   1600000   9000           100            100            0.033312828   -1.718543e-15   0              0.099938484    4.6238535e-07  0              22.326934     -1.5            0              2.9981619    
   1700000   9000           100            100            0.033312723   -1.7185381e-15  0              0.09993817     3.9346642e-11  0              0.0018999085  -1.5            0              2.9981619    
   1800000   9000           100            100            0.033312895   -1.718547e-15   0              0.099938686    6.6452447e-09  0              0.32087509    -1.5            0              2.9981618    
   1900000   9000           100            100            0.03331293    -1.7185487e-15  0              0.09993879     1.2629985e-10  0              0.006098568   -1.5            0              2.9981618    
   2000000   9000           100            100            0.033312914   -1.7185479e-15  0              0.099938741    7.0993303e-11  0              0.0034280125  -1.5            0              2.9981618    
   2100000   9000           100            100            0.033312907   -1.7185476e-15  0              0.099938722    5.9646205e-12  0              0.00028801018 -1.5            0              2.9981618    
   2200000   9000           100            100            0.033312909   -1.7185476e-15  0              0.099938726    4.9828139e-13  0              2.4060225e-05 -1.5            0              2.9981618    
   2300000   9000           100            100            0.03331291    -1.7185477e-15  0              0.099938729    1.4948212e-13  0              7.2179564e-06 -1.5            0              2.9981618    
   2400000   9000           100            100            0.03331291    -1.7185477e-15  0              0.099938729    1.312895e-15   0              6.3394999e-08 -1.5            0              2.9981618    
   2500000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    2.6391838e-15  0              1.2743674e-07 -1.5            0              2.9981618    
   2600000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    7.1804917e-18  0              3.4672025e-10 -1.5            0              2.9981618    
   2700000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    2.3826842e-17  0              1.1505129e-09 -1.5            0              2.9981618    
   2800000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    1.9600103e-19  0              9.4641882e-12 -1.5            0              2.9981618    
   2900000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    1.2425591e-17  0              5.9998734e-10 -1.5            0              2.9981618    
   3000000   9000           100            100            0.033312909   -1.7185477e-15  0              0.099938728    5.6181936e-20  0              2.7128246e-12 -1.5            0              2.9981618    
Loop time of 708.7 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3657401.037 ns/day, 0.000 hours/ns, 4233.103 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 315.76     | 319.2      | 324.7      |  18.9 | 45.04
Neigh   | 1.5435     | 1.5649     | 1.5865     |   1.7 |  0.22
Comm    | 36.866     | 40.065     | 42.1       |  31.8 |  5.65
Output  | 0.44351    | 0.4436     | 0.44374    |   0.0 |  0.06
Modify  | 303.4      | 305.66     | 309.17     |  12.4 | 43.13
Other   |            | 41.76      |            |       |  5.89

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 25000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02729591     3.3463665e-20  0              0.081887731    1774481.5      0              8.568336e+13  -1.5            0              3.3200563    
    200000   9000           100            100            0.010342412    8.3885003e-21  0              0.031027236    480539.39      0              2.3203527e+13 -1.5            0              3.058064     
    300000   9000           100            100            0.0022886203   1.8468952e-21  0              0.0068658609   41552.828      0              2.0064374e+12 -1.5            0              3.0377309    
    400000   9000           100            100            0.00052500727 -3.3742965e-21  0              0.0015750218   2753.082       0              1.3293648e+11 -1.5            0              3.0094125    
    500000   9000           100            100            0.00025414709 -9.2834648e-21  0              0.00076244128  676.74342      0              3.2677518e+10 -1.5            0              3.0008139    
    600000   9000           100            100            0.058011388   -2.9922733e-15  0              0.17403417     8.2375783      0              3.9776318e+08 -1.5            0              2.9977062    
    700000   9000           100            100            0.029612146   -1.5213604e-15  0              0.088836439    74.289671      0              3.5871823e+09 -1.5            0              2.9985385    
    800000   9000           100            100            0.030719852   -1.5849572e-15  0              0.092159556    1.8399456      0              88844386      -1.5            0              2.9984989    
    900000   9000           100            100            0.03359779    -1.73314e-15    0              0.10079337     1.2957819      0              62568672      -1.5            0              2.9984066    
   1000000   9000           100            100            0.033659035   -1.7355043e-15  0              0.10097711     0.004954167    0              239218.99     -1.5            0              2.9984051    
   1100000   9000           100            100            0.033311227   -1.7175309e-15  0              0.09993368     0.021017962    0              1014882.2     -1.5            0              2.9984161    
   1200000   9000           100            100            0.033273494   -1.7156785e-15  0              0.099820481    1.8384165e-05  0              887.70551     -1.5            0              2.9984173    
   1300000   9000           100            100            0.033312524   -1.7177041e-15  0              0.099937573    0.00029969674  0              14471.283     -1.5            0              2.998416     
   1400000   9000           100            100            0.033320603   -1.7181105e-15  0              0.09996181     4.2469007e-06  0              205.06764     -1.5            0              2.9984158    
   1500000   9000           100            100            0.033316557   -1.7178993e-15  0              0.09994967     3.7237226e-06  0              179.80524     -1.5            0              2.9984159    
   1600000   9000           100            100            0.033315211   -1.717831e-15   0              0.099945634    1.7881506e-07  0              8.6343392     -1.5            0              2.9984159    
   1700000   9000           100            100            0.033315586   -1.7178507e-15  0              0.099946757    3.9180214e-08  0              1.8918723     -1.5            0              2.9984159    
   1800000   9000           100            100            0.033315783   -1.7178608e-15  0              0.099947349    4.7864474e-09  0              0.23112042    -1.5            0              2.9984159    
   1900000   9000           100            100            0.033315755   -1.7178593e-15  0              0.099947265    3.2441765e-10  0              0.015664967   -1.5            0              2.9984159    
   2000000   9000           100            100            0.033315728   -1.7178579e-15  0              0.099947185    1.0086046e-10  0              0.0048701905  -1.5            0              2.9984159    
   2100000   9000           100            100            0.033315729   -1.717858e-15   0              0.099947188    1.7037939e-12  0              8.2270107e-05 -1.5            0              2.9984159    
   2200000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    1.7992754e-12  0              8.6880568e-05 -1.5            0              2.9984159    
   2300000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947199    1.8849028e-15  0              9.1015209e-08 -1.5            0              2.9984159    
   2400000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    2.7981681e-14  0              1.3511352e-06 -1.5            0              2.9984159    
   2500000   9000           100            100            0.033315732   -1.7178581e-15  0              0.099947197    4.2742658e-17  0              2.06389e-09   -1.5            0              2.9984159    
   2600000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    4.0944169e-16  0              1.9770474e-08 -1.5            0              2.9984159    
   2700000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    3.4700981e-17  0              1.6755862e-09 -1.5            0              2.9984159    
   2800000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    2.1029957e-17  0              1.0154614e-09 -1.5            0              2.9984159    
   2900000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    4.0925793e-18  0              1.9761601e-10 -1.5            0              2.9984159    
   3000000   9000           100            100            0.033315733   -1.7178581e-15  0              0.099947198    5.5568543e-18  0              2.6832061e-10 -1.5            0              2.9984159    
Loop time of 711.813 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3641407.443 ns/day, 0.000 hours/ns, 4214.592 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 320.86     | 323.77     | 327.39     |  13.6 | 45.49
Neigh   | 1.5436     | 1.5647     | 1.5861     |   1.7 |  0.22
Comm    | 37.131     | 39.821     | 42.509     |  36.2 |  5.59
Output  | 0.44463    | 0.44472    | 0.44484    |   0.0 |  0.06
Modify  | 304.01     | 304.74     | 306.22     |   5.1 | 42.81
Other   |            | 41.47      |            |       |  5.83

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 30000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027361429    3.364031e-20   0              0.082084288    1780749.1      0              8.5986e+13    -1.5            0              3.3186792    
    200000   9000           100            100            0.010465593    8.6550899e-21  0              0.03139678     489413.94      0              2.3632048e+13 -1.5            0              3.0558711    
    300000   9000           100            100            0.0024701032   1.8421503e-21  0              0.0074103096   47542.135      0              2.2956396e+12 -1.5            0              3.0364679    
    400000   9000           100            100            0.00088478675 -3.1096908e-21  0              0.0026543602   7440.1886      0              3.5926008e+11 -1.5            0              3.0083064    
    500000   9000           100            100            0.1002794     -5.1349985e-15  0              0.30083819     1984.6933      0              9.5833738e+10 -1.5            0              2.997084     
    600000   9000           100            100            0.013182177   -6.7270551e-16  0              0.039546532    217.52925      0              1.0503709e+10 -1.5            0              2.9992498    
    700000   9000           100            100            0.042324771   -2.1830146e-15  0              0.12697431     6.7936555      0              3.2804131e+08 -1.5            0              2.9983552    
    800000   9000           100            100            0.030301992   -1.5655297e-15  0              0.090905977    1.0359107      0              50020418      -1.5            0              2.9986829    
    900000   9000           100            100            0.034403117   -1.776145e-15   0              0.10320935     0.089157345    0              4305089.1     -1.5            0              2.998567     
   1000000   9000           100            100            0.032934169   -1.7006494e-15  0              0.098802506    0.0058998517   0              284882.72     -1.5            0              2.998608     
   1100000   9000           100            100            0.033453607   -1.7273715e-15  0              0.10036082     0.00029124964  0              14063.403     -1.5            0              2.9985934    
   1200000   9000           100            100            0.033269942   -1.717914e-15   0              0.099809826    6.1237941e-06  0              295.6961      -1.5            0              2.9985986    
   1300000   9000           100            100            0.03333451    -1.7212419e-15  0              0.10000353     1.3238801e-07  0              6.3925434     -1.5            0              2.9985968    
   1400000   9000           100            100            0.033311896   -1.7200753e-15  0              0.099935687    3.1176465e-07  0              15.053999     -1.5            0              2.9985974    
   1500000   9000           100            100            0.033319781   -1.7204825e-15  0              0.099959343    1.1958131e-07  0              5.7741537     -1.5            0              2.9985972    
   1600000   9000           100            100            0.033317043   -1.7203409e-15  0              0.099951129    3.0021274e-08  0              1.4496199     -1.5            0              2.9985972    
   1700000   9000           100            100            0.033317989   -1.7203899e-15  0              0.099953968    6.1953742e-09  0              0.29915245    -1.5            0              2.9985972    
   1800000   9000           100            100            0.033317664   -1.720373e-15   0              0.099952991    1.140313e-09   0              0.055061633   -1.5            0              2.9985972    
   1900000   9000           100            100            0.033317775   -1.7203788e-15  0              0.099953326    1.9464124e-10  0              0.0093985287  -1.5            0              2.9985972    
   2000000   9000           100            100            0.033317737   -1.7203769e-15  0              0.099953212    3.1472836e-11  0              0.0015197106  -1.5            0              2.9985972    
   2100000   9000           100            100            0.03331775    -1.7203775e-15  0              0.099953251    4.8864547e-12  0              0.00023594941 -1.5            0              2.9985972    
   2200000   9000           100            100            0.033317746   -1.7203773e-15  0              0.099953238    7.332467e-13   0              3.5405859e-05 -1.5            0              2.9985972    
   2300000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953242    1.0812886e-13  0              5.2211557e-06 -1.5            0              2.9985972    
   2400000   9000           100            100            0.033317747   -1.7203773e-15  0              0.099953241    1.5434521e-14  0              7.452778e-07  -1.5            0              2.9985972    
   2500000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    2.1170116e-15  0              1.0222292e-07 -1.5            0              2.9985972    
   2600000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    2.4626102e-16  0              1.1891063e-08 -1.5            0              2.9985972    
   2700000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    5.4700913e-18  0              2.6413113e-10 -1.5            0              2.9985972    
   2800000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    5.9479241e-18  0              2.8720397e-10 -1.5            0              2.9985972    
   2900000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    1.1172219e-17  0              5.3946648e-10 -1.5            0              2.9985972    
   3000000   9000           100            100            0.033317747   -1.7203774e-15  0              0.099953241    1.1595195e-17  0              5.5989047e-10 -1.5            0              2.9985972    
Loop time of 711.383 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3643606.649 ns/day, 0.000 hours/ns, 4217.137 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 314.38     | 319.72     | 322.8      |  18.8 | 44.94
Neigh   | 1.6034     | 1.6204     | 1.6362     |   1.2 |  0.23
Comm    | 35.901     | 39.219     | 44.462     |  56.1 |  5.51
Output  | 0.44936    | 0.44956    | 0.44999    |   0.0 |  0.06
Modify  | 304.71     | 307.67     | 310.15     |  12.7 | 43.25
Other   |            | 42.71      |            |       |  6.00

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 35000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027413218    3.4223472e-20  0              0.082239653    1785714.4      0              8.6225757e+13 -1.5            0              3.3175718    
    200000   9000           100            100            0.010563859    8.5732752e-21  0              0.031691578    496532.13      0              2.3975759e+13 -1.5            0              3.0540833    
    300000   9000           100            100            0.0026162509   2.1740176e-21  0              0.0078487528   52587.858      0              2.5392795e+12 -1.5            0              3.0353507    
    400000   9000           100            100            0.0011769467  -2.5032543e-21  0              0.0035308401   12684.159      0              6.1247265e+11 -1.5            0              3.0068933    
    500000   9000           100            100            0.017793207   -9.7535907e-16  0              0.053379622    6239.1928      0              3.0126829e+11 -1.5            0              2.9991439    
    600000   9000           100            100            0.053627042   -2.7508574e-15  0              0.16088113     481.18288      0              2.3234599e+10 -1.5            0              2.9982663    
    700000   9000           100            100            0.034000199   -1.747398e-15   0              0.1020006      111.11561      0              5.3653749e+09 -1.5            0              2.9987197    
    800000   9000           100            100            0.034594025   -1.7826726e-15  0              0.10378208     11.986135      0              5.7876757e+08 -1.5            0              2.998703     
    900000   9000           100            100            0.034182557   -1.763122e-15   0              0.10254767     0.86340446     0              41690711      -1.5            0              2.9987127    
   1000000   9000           100            100            0.033719503   -1.739748e-15   0              0.10115851     0.028224848    0              1362876.9     -1.5            0              2.9987242    
   1100000   9000           100            100            0.033469783   -1.7269882e-15  0              0.10040935     4.5752156e-05  0              2209.2079     -1.5            0              2.9987304    
   1200000   9000           100            100            0.033366566   -1.7216791e-15  0              0.1000997      0.00062791488  0              30319.762     -1.5            0              2.998733     
   1300000   9000           100            100            0.033331078   -1.7198433e-15  0              0.099993234    0.0002327775   0              11239.992     -1.5            0              2.9987339    
   1400000   9000           100            100            0.033321018   -1.7193191e-15  0              0.099963054    4.4978541e-05  0              2171.8528     -1.5            0              2.9987342    
   1500000   9000           100            100            0.033318935   -1.719209e-15   0              0.099956806    5.8787947e-06  0              283.86596     -1.5            0              2.9987342    
   1600000   9000           100            100            0.033318839   -1.7192029e-15  0              0.099956517    5.3236956e-07  0              25.706221     -1.5            0              2.9987342    
   1700000   9000           100            100            0.033319034   -1.7192126e-15  0              0.099957102    2.8703429e-08  0              1.3859859     -1.5            0              2.9987342    
   1800000   9000           100            100            0.033319171   -1.7192196e-15  0              0.099957514    3.5259473e-10  0              0.017025538   -1.5            0              2.9987342    
   1900000   9000           100            100            0.033319235   -1.7192228e-15  0              0.099957706    7.8223214e-11  0              0.003777119   -1.5            0              2.9987342    
   2000000   9000           100            100            0.03331926    -1.7192241e-15  0              0.099957779    6.3947624e-11  0              0.0030878019  -1.5            0              2.9987342    
   2100000   9000           100            100            0.033319267   -1.7192245e-15  0              0.099957801    1.6363079e-11  0              0.00079011455 -1.5            0              2.9987342    
   2200000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957807    2.5929975e-12  0              0.00012520657 -1.5            0              2.9987342    
   2300000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    2.8688089e-13  0              1.3852452e-05 -1.5            0              2.9987342    
   2400000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    2.0969911e-14  0              1.012562e-06  -1.5            0              2.9987342    
   2500000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    8.3923062e-16  0              4.0523443e-08 -1.5            0              2.9987342    
   2600000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    6.3225525e-17  0              3.0529343e-09 -1.5            0              2.9987342    
   2700000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    4.0741652e-17  0              1.9672686e-09 -1.5            0              2.9987342    
   2800000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    1.3434202e-17  0              6.4868952e-10 -1.5            0              2.9987342    
   2900000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    8.4478193e-18  0              4.0791496e-10 -1.5            0              2.9987342    
   3000000   9000           100            100            0.033319269   -1.7192246e-15  0              0.099957808    1.9050468e-20  0              9.1987891e-13 -1.5            0              2.9987342    
Loop time of 716.933 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3615401.412 ns/day, 0.000 hours/ns, 4184.492 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 313.61     | 320.5      | 332.27     |  40.0 | 44.70
Neigh   | 1.5991     | 1.6145     | 1.6309     |   1.2 |  0.23
Comm    | 35.774     | 44.146     | 53.381     |  99.2 |  6.16
Output  | 0.4455     | 0.44566    | 0.44597    |   0.0 |  0.06
Modify  | 305.84     | 309.21     | 316.7      |  24.8 | 43.13
Other   |            | 41.02      |            |       |  5.72

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 40000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02745557     3.4337379e-20  0              0.08236671     1789782.4      0              8.6422186e+13 -1.5            0              3.3166535    
    200000   9000           100            100            0.010644829    8.940533e-21   0              0.031934486    502423.12      0              2.4260214e+13 -1.5            0              3.0525845    
    300000   9000           100            100            0.0027375925   1.8547028e-21  0              0.0082127775   56922.899      0              2.7486031e+12 -1.5            0              3.0343567    
    400000   9000           100            100            0.0014208564  -2.415169e-21   0              0.0042625692   17951.962      0              8.6683599e+11 -1.5            0              3.0053891    
    500000   9000           100            100           -0.0001832253  -6.6264886e-21  0             -0.00054967589  372.29078      0              1.7976589e+10 -1.5            0              3.0014339    
    600000   9000           100            100            0.064371243   -3.3121681e-15  0              0.19311373     92.427999      0              4.4630173e+09 -1.5            0              2.9982054    
    700000   9000           100            100            0.035359616   -1.830645e-15   0              0.10607885     114.19427      0              5.5140328e+09 -1.5            0              2.9987928    
    800000   9000           100            100            0.031457155   -1.6203876e-15  0              0.094371466    10.984963      0              5.3042457e+08 -1.5            0              2.9988864    
    900000   9000           100            100            0.034124127   -1.7607141e-15  0              0.10237238     1.1444632      0              55262032      -1.5            0              2.9988232    
   1000000   9000           100            100            0.032993264   -1.7015056e-15  0              0.098979792    0.11281714     0              5447535.7     -1.5            0              2.9988497    
   1100000   9000           100            100            0.033449064   -1.7252864e-15  0              0.10034719     0.010609238    0              512282.15     -1.5            0              2.998839     
   1200000   9000           100            100            0.03327119    -1.7160307e-15  0              0.09981357     0.00091705885  0              44281.49      -1.5            0              2.9988432    
   1300000   9000           100            100            0.033338971   -1.7195498e-15  0              0.10001691     7.0680625e-05  0              3412.9144     -1.5            0              2.9988416    
   1400000   9000           100            100            0.033313645   -1.7182375e-15  0              0.099940936    4.4995695e-06  0              217.26811     -1.5            0              2.9988422    
   1500000   9000           100            100            0.033322941   -1.7187184e-15  0              0.099968823    1.9412902e-07  0              9.3737956     -1.5            0              2.998842     
   1600000   9000           100            100            0.033319584   -1.718545e-15   0              0.099958751    2.0285275e-09  0              0.097950331   -1.5            0              2.9988421    
   1700000   9000           100            100            0.033320778   -1.7186065e-15  0              0.099962333    5.3428317e-10  0              0.025798622   -1.5            0              2.998842     
   1800000   9000           100            100            0.033320359   -1.718585e-15   0              0.099961078    4.7212371e-10  0              0.022797164   -1.5            0              2.998842     
   1900000   9000           100            100            0.033320504   -1.7185924e-15  0              0.099961511    1.5173254e-10  0              0.0073266211  -1.5            0              2.998842     
   2000000   9000           100            100            0.033320455   -1.7185899e-15  0              0.099961364    3.4969785e-11  0              0.0016885658  -1.5            0              2.998842     
   2100000   9000           100            100            0.033320471   -1.7185907e-15  0              0.099961413    6.7919775e-12  0              0.00032796029 -1.5            0              2.998842     
   2200000   9000           100            100            0.033320466   -1.7185905e-15  0              0.099961397    1.1816707e-12  0              5.705865e-05  -1.5            0              2.998842     
   2300000   9000           100            100            0.033320467   -1.7185906e-15  0              0.099961402    1.9150467e-13  0              9.2470753e-06 -1.5            0              2.998842     
   2400000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    2.9356567e-14  0              1.4175236e-06 -1.5            0              2.998842     
   2500000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    4.2346827e-15  0              2.0447767e-07 -1.5            0              2.998842     
   2600000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    4.8229241e-16  0              2.3288174e-08 -1.5            0              2.998842     
   2700000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    7.2160932e-17  0              3.4843931e-09 -1.5            0              2.998842     
   2800000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    9.4326404e-19  0              4.5546845e-11 -1.5            0              2.998842     
   2900000   9000           100            100            0.033320467   -1.7185905e-15  0              0.099961401    5.5095527e-18  0              2.6603658e-10 -1.5            0              2.998842     
   3000000   9000           100            100            0.033320467   -1.7185906e-15  0              0.099961401    7.051178e-18   0              3.4047615e-10 -1.5            0              2.998842     
Loop time of 720.611 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3596948.921 ns/day, 0.000 hours/ns, 4163.135 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 319.08     | 324.44     | 329.96     |  24.3 | 45.02
Neigh   | 1.5789     | 1.5931     | 1.6077     |   1.1 |  0.22
Comm    | 36.742     | 41.449     | 46.874     |  69.5 |  5.75
Output  | 0.44545    | 0.44569    | 0.44622    |   0.0 |  0.06
Modify  | 308.17     | 310.58     | 312.53     |   9.2 | 43.10
Other   |            | 42.11      |            |       |  5.84

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 45000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027491097    3.4158044e-20  0              0.082473291    1793200.1      0              8.6587217e+13 -1.5            0              3.3158741    
    200000   9000           100            100            0.010713177    8.9049665e-21  0              0.03213953     507413.93      0              2.4501203e+13 -1.5            0              3.0513011    
    300000   9000           100            100            0.0028406782   2.1664785e-21  0              0.0085220347   60706.802      0              2.9313142e+12 -1.5            0              3.0334659    
    400000   9000           100            100            0.0016288681  -2.0462683e-21  0              0.0048866042   23035.513      0              1.1123025e+12 -1.5            0              3.0038874    
    500000   9000           100            100            0.00031227252 -6.0196935e-21  0              0.00093681756  1011.4565      0              4.8839614e+10 -1.5            0              3.0013691    
    600000   9000           100            100            0.054123064   -2.775393e-15   0              0.16236919     630.51211      0              3.0445173e+10 -1.5            0              2.9985254    
    700000   9000           100            100            0.024875509   -1.2893438e-15  0              0.074626528    52.703877      0              2.5448816e+09 -1.5            0              2.9991174    
    800000   9000           100            100            0.035986515   -1.859648e-15   0              0.10795954     8.7851557      0              4.2420373e+08 -1.5            0              2.9988725    
    900000   9000           100            100            0.034528852   -1.7820626e-15  0              0.10358656     0.55198229     0              26653249      -1.5            0              2.9989039    
   1000000   9000           100            100            0.033143375   -1.7108105e-15  0              0.099430126    0.20956411     0              10119101      -1.5            0              2.9989334    
   1100000   9000           100            100            0.033147791   -1.7113555e-15  0              0.099443373    0.0008844533   0              42707.085     -1.5            0              2.9989332    
   1200000   9000           100            100            0.033319718   -1.7202411e-15  0              0.099959153    0.0037215166   0              179698.72     -1.5            0              2.9989295    
   1300000   9000           100            100            0.033342803   -1.7213948e-15  0              0.10002841     2.1654173e-05  0              1045.6025     -1.5            0              2.998929     
   1400000   9000           100            100            0.033324576   -1.7204474e-15  0              0.099973728    4.824727e-05   0              2329.688      -1.5            0              2.9989294    
   1500000   9000           100            100            0.033319213   -1.7201744e-15  0              0.099957638    2.3393119e-06  0              112.957       -1.5            0              2.9989295    
   1600000   9000           100            100            0.033320744   -1.7202548e-15  0              0.099962232    4.2768388e-07  0              20.651324     -1.5            0              2.9989295    
   1700000   9000           100            100            0.03332162    -1.7202997e-15  0              0.099964861    7.8215874e-08  0              3.7767646     -1.5            0              2.9989295    
   1800000   9000           100            100            0.03332155    -1.7202959e-15  0              0.09996465     1.8487541e-09  0              0.08926972    -1.5            0              2.9989295    
   1900000   9000           100            100            0.033321431   -1.7202898e-15  0              0.099964294    1.6525651e-09  0              0.079796456   -1.5            0              2.9989295    
   2000000   9000           100            100            0.033321424   -1.7202894e-15  0              0.099964272    4.9384621e-14  0              2.3846066e-06 -1.5            0              2.9989295    
   2100000   9000           100            100            0.033321438   -1.7202901e-15  0              0.099964313    2.5222758e-11  0              0.0012179167  -1.5            0              2.9989295    
   2200000   9000           100            100            0.03332144    -1.7202902e-15  0              0.099964321    5.1236941e-13  0              2.4740485e-05 -1.5            0              2.9989295    
   2300000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964317    2.7646583e-13  0              1.3349546e-05 -1.5            0              2.9989295    
   2400000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    2.6011244e-14  0              1.2559899e-06 -1.5            0              2.9989295    
   2500000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    2.0149204e-15  0              9.7293296e-08 -1.5            0              2.9989295    
   2600000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    6.3862528e-16  0              3.0836929e-08 -1.5            0              2.9989295    
   2700000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    8.9691275e-17  0              4.3308707e-09 -1.5            0              2.9989295    
   2800000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    8.2316862e-18  0              3.9747867e-10 -1.5            0              2.9989295    
   2900000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    3.6166145e-19  0              1.7463337e-11 -1.5            0              2.9989295    
   3000000   9000           100            100            0.033321439   -1.7202902e-15  0              0.099964316    1.2151794e-17  0              5.8676662e-10 -1.5            0              2.9989295    
Loop time of 709.436 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3653608.545 ns/day, 0.000 hours/ns, 4228.714 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 308.44     | 316.06     | 321.63     |  27.2 | 44.55
Neigh   | 1.6024     | 1.6158     | 1.6294     |   1.0 |  0.23
Comm    | 36.558     | 41.146     | 49.292     |  81.4 |  5.80
Output  | 0.44319    | 0.4434     | 0.44392    |   0.0 |  0.06
Modify  | 305.82     | 307.34     | 310.36     |  10.2 | 43.32
Other   |            | 42.83      |            |       |  6.04

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 168
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 50000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02752149     3.4125782e-20  0              0.082564471    1796127.8      0              8.6728583e+13 -1.5            0              3.3152007    
    200000   9000           100            100            0.01077198     9.315902e-21   0              0.03231594     511721.07      0              2.4709179e+13 -1.5            0              3.0501833    
    300000   9000           100            100            0.0029298493   2.4172267e-21  0              0.008789548    64053.173      0              3.0928985e+12 -1.5            0              3.0326613    
    400000   9000           100            100            0.0018092917  -2.1229267e-21  0              0.0054278751   27858.563      0              1.3451903e+12 -1.5            0              3.0024296    
    500000   9000           100            100            0.00084082643 -5.2370912e-18  0              0.0025224793   5490.2053      0              2.6510236e+11 -1.5            0              2.9999813    
    600000   9000           100            100            0.013212965   -6.6719151e-16  0              0.039638896    599.74071      0              2.8959332e+10 -1.5            0              2.9994682    
    700000   9000           100            100            0.027118977   -1.4057309e-15  0              0.081356932    95.829798      0              4.627278e+09  -1.5            0              2.9991281    
    800000   9000           100            100            0.032349043   -1.6717096e-15  0              0.097047128    15.582342      0              7.5241551e+08 -1.5            0              2.9990208    
    900000   9000           100            100            0.033138993   -1.7107979e-15  0              0.099416978    2.0176435      0              97424786      -1.5            0              2.9990055    
   1000000   9000           100            100            0.033299053   -1.7184542e-15  0              0.099897159    0.25464379     0              12295837      -1.5            0              2.9990025    
   1100000   9000           100            100            0.033327808   -1.7197244e-15  0              0.099983423    0.031756859    0              1533425.1     -1.5            0              2.999002     
   1200000   9000           100            100            0.03332898    -1.7197095e-15  0              0.099986941    0.0039191135   0              189239.96     -1.5            0              2.999002     
   1300000   9000           100            100            0.033326288   -1.7195441e-15  0              0.099978865    0.00047865816  0              23112.69      -1.5            0              2.999002     
   1400000   9000           100            100            0.033324253   -1.7194299e-15  0              0.099972758    5.7845505e-05  0              2793.1524     -1.5            0              2.9990021    
   1500000   9000           100            100            0.033323155   -1.71937e-15    0              0.099969466    6.9147205e-06  0              333.88711     -1.5            0              2.9990021    
   1600000   9000           100            100            0.033322636   -1.7193421e-15  0              0.099967908    8.1721429e-07  0              39.460353     -1.5            0              2.9990021    
   1700000   9000           100            100            0.033322407   -1.71933e-15    0              0.099967222    9.5427856e-08  0              4.6078696     -1.5            0              2.9990021    
   1800000   9000           100            100            0.033322311   -1.7193249e-15  0              0.099966932    1.1001418e-08  0              0.53121913    -1.5            0              2.9990021    
   1900000   9000           100            100            0.033322271   -1.7193228e-15  0              0.099966814    1.2507797e-09  0              0.060395677   -1.5            0              2.9990021    
   2000000   9000           100            100            0.033322256   -1.7193219e-15  0              0.099966767    1.4005663e-10  0              0.0067628332  -1.5            0              2.9990021    
   2100000   9000           100            100            0.033322249   -1.7193216e-15  0              0.099966748    1.5420811e-11  0              0.00074461577 -1.5            0              2.9990021    
   2200000   9000           100            100            0.033322247   -1.7193215e-15  0              0.099966741    1.665833e-12   0              8.0437113e-05 -1.5            0              2.9990021    
   2300000   9000           100            100            0.033322246   -1.7193215e-15  0              0.099966738    1.7689979e-13  0              8.5418577e-06 -1.5            0              2.9990021    
   2400000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    1.8234289e-14  0              8.8046856e-07 -1.5            0              2.9990021    
   2500000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    1.8684721e-15  0              9.0221829e-08 -1.5            0              2.9990021    
   2600000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    8.3365826e-17  0              4.0254374e-09 -1.5            0              2.9990021    
   2700000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    1.0043312e-16  0              4.8495561e-09 -1.5            0              2.9990021    
   2800000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    7.7501907e-18  0              3.7422897e-10 -1.5            0              2.9990021    
   2900000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    1.1534931e-17  0              5.5698055e-10 -1.5            0              2.9990021    
   3000000   9000           100            100            0.033322246   -1.7193214e-15  0              0.099966737    1.0857663e-17  0              5.2427767e-10 -1.5            0              2.9990021    
Loop time of 714.789 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3626242.887 ns/day, 0.000 hours/ns, 4197.040 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 315.28     | 319.1      | 324.13     |  18.3 | 44.64
Neigh   | 1.6191     | 1.6343     | 1.6498     |   1.1 |  0.23
Comm    | 37.592     | 40.689     | 41.868     |  28.1 |  5.69
Output  | 0.43645    | 0.43661    | 0.43695    |   0.0 |  0.06
Modify  | 308.52     | 311.19     | 313.33     |  10.9 | 43.54
Other   |            | 41.74      |            |       |  5.84

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 170
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 55000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027547905    3.4290632e-20  0              0.082643714    1798675.1      0              8.6851585e+13 -1.5            0              3.3146103    
    200000   9000           100            100            0.010823326    8.9557483e-21  0              0.032469979    515492         0              2.4891264e+13 -1.5            0              3.0491971    
    300000   9000           100            100            0.0030080729   2.4851113e-21  0              0.0090242186   67043.576      0              3.2372943e+12 -1.5            0              3.03193      
    400000   9000           100            100            0.0019679006  -1.8615955e-21  0              0.0059037017   32399.914      0              1.5644759e+12 -1.5            0              3.0010338    
    500000   9000           100            100            0.096271548   -4.9202769e-15  0              0.28881464     4794.0429      0              2.3148717e+11 -1.5            0              2.9981097    
    600000   9000           100            100            0.012651049   -6.6803424e-16  0              0.037953147    654.16813      0              3.1587438e+10 -1.5            0              2.9995026    
    700000   9000           100            100            0.043894969   -2.2679564e-15  0              0.13168491     48.074276      0              2.3213347e+09 -1.5            0              2.9988735    
    800000   9000           100            100            0.035352515   -1.8254568e-15  0              0.10605755     13.675292      0              6.603309e+08  -1.5            0              2.9990252    
    900000   9000           100            100            0.032947187   -1.6999805e-15  0              0.098841561    2.0311112      0              98075092      -1.5            0              2.9990703    
   1000000   9000           100            100            0.032857936   -1.6946441e-15  0              0.098573808    0.086408804    0              4172371.9     -1.5            0              2.9990722    
   1100000   9000           100            100            0.033125694   -1.7082385e-15  0              0.099377082    0.00062222421  0              30044.98      -1.5            0              2.9990672    
   1200000   9000           100            100            0.033278191   -1.7160829e-15  0              0.099834572    0.0024826745   0              119879.47     -1.5            0              2.9990644    
   1300000   9000           100            100            0.033324276   -1.718476e-15   0              0.099972828    0.00052249504  0              25229.416     -1.5            0              2.9990635    
   1400000   9000           100            100            0.033329223   -1.7187422e-15  0              0.09998767     3.2335247e-05  0              1561.3533     -1.5            0              2.9990634    
   1500000   9000           100            100            0.033326041   -1.7185818e-15  0              0.099978122    1.1451458e-08  0              0.55294992    -1.5            0              2.9990635    
   1600000   9000           100            100            0.033323764   -1.718465e-15   0              0.099971291    4.2895527e-07  0              20.712715     -1.5            0              2.9990635    
   1700000   9000           100            100            0.033322975   -1.7184241e-15  0              0.099968924    1.2586161e-07  0              6.0774069     -1.5            0              2.9990635    
   1800000   9000           100            100            0.033322848   -1.7184174e-15  0              0.099968544    1.0622661e-08  0              0.51293027    -1.5            0              2.9990635    
   1900000   9000           100            100            0.033322881   -1.718419e-15   0              0.099968642    8.8012686e-11  0              0.0042498176  -1.5            0              2.9990635    
   2000000   9000           100            100            0.033322913   -1.7184207e-15  0              0.09996874     6.388038e-11   0              0.0030845549  -1.5            0              2.9990635    
   2100000   9000           100            100            0.033322926   -1.7184214e-15  0              0.099968779    2.8508804e-11  0              0.0013765881  -1.5            0              2.9990635    
   2200000   9000           100            100            0.033322929   -1.7184215e-15  0              0.099968787    3.1894777e-12  0              0.00015400846 -1.5            0              2.9990635    
   2300000   9000           100            100            0.033322929   -1.7184215e-15  0              0.099968787    6.9320071e-14  0              3.3472181e-06 -1.5            0              2.9990635    
   2400000   9000           100            100            0.033322928   -1.7184215e-15  0              0.099968785    7.5538408e-15  0              3.6474794e-07 -1.5            0              2.9990635    
   2500000   9000           100            100            0.033322928   -1.7184214e-15  0              0.099968785    5.8721661e-15  0              2.8354588e-07 -1.5            0              2.9990635    
   2600000   9000           100            100            0.033322928   -1.7184214e-15  0              0.099968784    9.3919774e-16  0              4.5350498e-08 -1.5            0              2.9990635    
   2700000   9000           100            100            0.033322928   -1.7184214e-15  0              0.099968784    1.7639934e-17  0              8.5176928e-10 -1.5            0              2.9990635    
   2800000   9000           100            100            0.033322928   -1.7184214e-15  0              0.099968784    1.1282619e-17  0              5.447973e-10  -1.5            0              2.9990635    
   2900000   9000           100            100            0.033322928   -1.7184214e-15  0              0.099968784    1.1445993e-18  0              5.5268606e-11 -1.5            0              2.9990635    
   3000000   9000           100            100            0.033322928   -1.7184215e-15  0              0.099968784    1.1551676e-20  0              5.5778908e-13 -1.5            0              2.9990635    
Loop time of 719 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3605007.075 ns/day, 0.000 hours/ns, 4172.462 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 315.22     | 326.16     | 336.07     |  45.6 | 45.36
Neigh   | 1.6049     | 1.6181     | 1.6308     |   1.0 |  0.23
Comm    | 34.174     | 42.881     | 54.255     | 132.4 |  5.96
Output  | 0.43803    | 0.43819    | 0.43854    |   0.0 |  0.06
Modify  | 305.73     | 307.18     | 309.71     |   8.6 | 42.72
Other   |            | 40.72      |            |       |  5.66

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 170
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 60000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027571157    3.4039448e-20  0              0.082713471    1800919.9      0              8.6959978e+13 -1.5            0              3.3140864    
    200000   9000           100            100            0.010868731    8.6235898e-21  0              0.032606192    518834.37      0              2.5052655e+13 -1.5            0              3.0483169    
    300000   9000           100            100            0.0030775285   2.4583873e-21  0              0.0092325855   69741.077      0              3.367547e+12  -1.5            0              3.0312608    
    400000   9000           100            100            0.0085547827  -3.4556514e-16  0              0.025664348    36596.301      0              1.7671044e+12 -1.5            0              2.9997057    
    500000   9000           100            100            0.14330386    -7.4533713e-15  0              0.42991159     808.52687      0              3.9040869e+10 -1.5            0              2.9976593    
    600000   9000           100            100            0.071020504   -3.6527549e-15  0              0.21306151     182.43039      0              8.8089107e+09 -1.5            0              2.9985382    
    700000   9000           100            100            0.029594165   -1.5195143e-15  0              0.088782494    130.84793      0              6.3181784e+09 -1.5            0              2.9991857    
    800000   9000           100            100            0.035959264   -1.8528097e-15  0              0.10787779     12.520075      0              6.0454962e+08 -1.5            0              2.9990709    
    900000   9000           100            100            0.034996831   -1.8056479e-15  0              0.10499049     0.033700413    0              1627272.3     -1.5            0              2.9990869    
   1000000   9000           100            100            0.03350452    -1.7289203e-15  0              0.10051356     0.25395332     0              12262497      -1.5            0              2.999113     
   1100000   9000           100            100            0.033169098   -1.7113813e-15  0              0.099507294    0.016323035    0              788180.95     -1.5            0              2.999119     
   1200000   9000           100            100            0.033254768   -1.7156983e-15  0              0.099764303    0.00062781068  0              30314.731     -1.5            0              2.9991175    
   1300000   9000           100            100            0.033322408   -1.7191866e-15  0              0.099967225    0.00055072629  0              26592.602     -1.5            0              2.9991163    
   1400000   9000           100            100            0.0333318     -1.7196836e-15  0              0.099995401    1.4741486e-05  0              711.81358     -1.5            0              2.9991162    
   1500000   9000           100            100            0.033326117   -1.7193943e-15  0              0.099978351    3.2333054e-06  0              156.12475     -1.5            0              2.9991163    
   1600000   9000           100            100            0.03332325    -1.719246e-15   0              0.099969751    1.031642e-06   0              49.814298     -1.5            0              2.9991163    
   1700000   9000           100            100            0.03332311    -1.7192381e-15  0              0.09996933     5.8972712e-09  0              0.28475812    -1.5            0              2.9991163    
   1800000   9000           100            100            0.033323427   -1.7192544e-15  0              0.099970282    1.0899971e-08  0              0.52632059    -1.5            0              2.9991163    
   1900000   9000           100            100            0.033323539   -1.7192602e-15  0              0.099970618    1.6539946e-09  0              0.07986548    -1.5            0              2.9991163    
   2000000   9000           100            100            0.033323533   -1.7192599e-15  0              0.099970598    9.6814639e-13  0              4.6748324e-05 -1.5            0              2.9991163    
   2100000   9000           100            100            0.033323517   -1.7192591e-15  0              0.099970551    2.9021229e-11  0              0.0014013313  -1.5            0              2.9991163    
   2200000   9000           100            100            0.033323513   -1.7192589e-15  0              0.099970539    2.1849832e-12  0              0.00010550502 -1.5            0              2.9991163    
   2300000   9000           100            100            0.033323514   -1.7192589e-15  0              0.099970541    5.5192119e-14  0              2.6650299e-06 -1.5            0              2.9991163    
   2400000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    6.4997471e-14  0              3.1384952e-06 -1.5            0              2.9991163    
   2500000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    2.084329e-15   0              1.0064479e-07 -1.5            0              2.9991163    
   2600000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    2.7621902e-16  0              1.3337628e-08 -1.5            0              2.9991163    
   2700000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    2.6138625e-17  0              1.2621406e-09 -1.5            0              2.9991163    
   2800000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    4.6640649e-18  0              2.25211e-10   -1.5            0              2.9991163    
   2900000   9000           100            100            0.033323515   -1.7192589e-15  0              0.099970544    5.577967e-18   0              2.6934006e-10 -1.5            0              2.9991163    
   3000000   9000           100            100            0.033323515   -1.719259e-15   0              0.099970544    1.6936124e-17  0              8.1778484e-10 -1.5            0              2.9991163    
Loop time of 713.707 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3631743.721 ns/day, 0.000 hours/ns, 4203.407 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 307.8      | 317.39     | 329.34     |  51.3 | 44.47
Neigh   | 1.6243     | 1.6374     | 1.6505     |   1.0 |  0.23
Comm    | 34.456     | 44.412     | 54.585     | 147.6 |  6.22
Output  | 0.43927    | 0.43956    | 0.44022    |   0.1 |  0.06
Modify  | 305.82     | 307.73     | 311.59     |  12.9 | 43.12
Other   |            | 42.1       |            |       |  5.90

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 65000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027591844    3.4536791e-20  0              0.082775531    1802918.7      0              8.7056491e+13 -1.5            0              3.3136176    
    200000   9000           100            100            0.010909262    8.9143518e-21  0              0.032727787    521824.14      0              2.519702e+13  -1.5            0              3.0475251    
    300000   9000           100            100            0.0031397618   2.5453435e-21  0              0.0094192853   72191.381      0              3.4858634e+12 -1.5            0              3.0306456    
    400000   9000           100            100            0.084195819   -4.2943078e-15  0              0.25258746     36076.5        0              1.7420051e+12 -1.5            0              2.9984726    
    500000   9000           100            100            0.04296938    -2.2749313e-15  0              0.12890814     7508.562       0              3.6256159e+11 -1.5            0              2.998995     
    600000   9000           100            100            0.0018917263  -1.0063906e-16  0              0.0056751789   17.435958      0              8.4192e+08    -1.5            0              2.9998745    
    700000   9000           100            100            0.037439216   -1.9397045e-15  0              0.11231765     134.84091      0              6.5109851e+09 -1.5            0              2.9990927    
    800000   9000           100            100            0.030909801   -1.597859e-15   0              0.092729404    14.161239      0              6.8379557e+08 -1.5            0              2.9992026    
    900000   9000           100            100            0.031579821   -1.6299115e-15  0              0.094739464    0.0063989348   0              308981.66     -1.5            0              2.9991917    
   1000000   9000           100            100            0.033110782   -1.7085736e-15  0              0.099332345    0.25740523     0              12429177      -1.5            0              2.9991659    
   1100000   9000           100            100            0.033485724   -1.7281525e-15  0              0.10045717     0.017175987    0              829366.96     -1.5            0              2.9991595    
   1200000   9000           100            100            0.033395315   -1.7235948e-15  0              0.10018595     0.0007619541   0              36792.037     -1.5            0              2.999161     
   1300000   9000           100            100            0.03332338    -1.7198834e-15  0              0.099970139    0.00057854169  0              27935.708     -1.5            0              2.9991622    
   1400000   9000           100            100            0.0333149     -1.7194325e-15  0              0.099944701    1.0033522e-05  0              484.48288     -1.5            0              2.9991624    
   1500000   9000           100            100            0.03332159    -1.7197739e-15  0              0.099964769    4.6050364e-06  0              222.36073     -1.5            0              2.9991623    
   1600000   9000           100            100            0.033324499   -1.7199247e-15  0              0.099973496    9.7873602e-07  0              47.25966      -1.5            0              2.9991622    
   1700000   9000           100            100            0.033324461   -1.7199234e-15  0              0.099973383    1.1486884e-11  0              0.00055466051 -1.5            0              2.9991622    
   1800000   9000           100            100            0.033324086   -1.7199041e-15  0              0.099972257    1.5191457e-08  0              0.73354111    -1.5            0              2.9991622    
   1900000   9000           100            100            0.033323987   -1.7198989e-15  0              0.09997196     1.1839073e-09  0              0.057166646   -1.5            0              2.9991622    
   2000000   9000           100            100            0.033324007   -1.7198999e-15  0              0.09997202     3.5820442e-11  0              0.0017296409  -1.5            0              2.9991622    
   2100000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    3.5644881e-11  0              0.0017211637  -1.5            0              2.9991622    
   2200000   9000           100            100            0.033324027   -1.719901e-15   0              0.099972081    7.9786794e-13  0              3.8526187e-05 -1.5            0              2.9991622    
   2300000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972076    2.5382734e-13  0              1.2256414e-05 -1.5            0              2.9991622    
   2400000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    6.3013862e-14  0              3.0427139e-06 -1.5            0              2.9991622    
   2500000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    4.2111447e-17  0              2.0334111e-09 -1.5            0              2.9991622    
   2600000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    1.0150801e-15  0              4.9014587e-08 -1.5            0              2.9991622    
   2700000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    1.0617484e-17  0              5.1268032e-10 -1.5            0              2.9991622    
   2800000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    1.0218814e-17  0              4.9342997e-10 -1.5            0              2.9991622    
   2900000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    1.0757212e-17  0              5.1942729e-10 -1.5            0              2.9991622    
   3000000   9000           100            100            0.033324025   -1.7199009e-15  0              0.099972074    2.222591e-17   0              1.0732097e-09 -1.5            0              2.9991622    
Loop time of 708.062 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3660695.904 ns/day, 0.000 hours/ns, 4236.917 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 310.36     | 316.66     | 326.63     |  35.0 | 44.72
Neigh   | 1.6187     | 1.6247     | 1.6305     |   0.4 |  0.23
Comm    | 34.691     | 42.012     | 49.332     | 100.5 |  5.93
Output  | 0.44058    | 0.44092    | 0.44175    |   0.1 |  0.06
Modify  | 302.65     | 305.66     | 310.64     |  17.1 | 43.17
Other   |            | 41.67      |            |       |  5.88

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 70000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027610417    3.3705413e-20  0              0.082831251    1804714.8      0              8.714322e+13  -1.5            0              3.3131938    
    200000   9000           100            100            0.010945792    8.9747052e-21  0              0.032837376    524523.74      0              2.5327374e+13 -1.5            0              3.0468061    
    300000   9000           100            100            0.0031960421   2.9613261e-21  0              0.0095881262   74434.073      0              3.594155e+12  -1.5            0              3.0300764    
    400000   9000           100            100            0.19297824    -9.9719293e-15  0              0.57893473     26297.967      0              1.2698347e+12 -1.5            0              2.9974441    
    500000   9000           100            100           -0.00063020568 -5.0135177e-21  0             -0.001890617    4798.2768      0              2.3169161e+11 -1.5            0              3.0004714    
    600000   9000           100            100            0.075772283   -3.897895e-15   0              0.22731685     134.21353      0              6.480691e+09  -1.5            0              2.9986225    
    700000   9000           100            100            0.020674968   -1.0631815e-15  0              0.062024905    24.882602      0              1.2014918e+09 -1.5            0              2.9994209    
    800000   9000           100            100            0.030319209   -1.561237e-15   0              0.090957627    12.507844      0              6.0395905e+08 -1.5            0              2.9992519    
    900000   9000           100            100            0.0337304     -1.7383881e-15  0              0.1011912      2.3027433      0              1.1119123e+08 -1.5            0              2.9991964    
   1000000   9000           100            100            0.033908459   -1.7484039e-15  0              0.10172538     0.060898082    0              2940550.4     -1.5            0              2.9991934    
   1100000   9000           100            100            0.033534339   -1.7293334e-15  0              0.10060302     0.0065051052   0              314108.25     -1.5            0              2.9991993    
   1200000   9000           100            100            0.033344919   -1.7195604e-15  0              0.10003476     0.0044960885   0              217100.03     -1.5            0              2.9992023    
   1300000   9000           100            100            0.033307243   -1.7175872e-15  0              0.099921728    0.00039357297  0              19004.23      -1.5            0              2.9992029    
   1400000   9000           100            100            0.033314197   -1.717933e-15   0              0.099942592    1.9131609e-07  0              9.2379693     -1.5            0              2.9992028    
   1500000   9000           100            100            0.033322046   -1.7183358e-15  0              0.099966139    5.2876045e-06  0              255.3195      -1.5            0              2.9992027    
   1600000   9000           100            100            0.033324681   -1.7184724e-15  0              0.099974042    1.1728715e-06  0              56.633769     -1.5            0              2.9992026    
   1700000   9000           100            100            0.033324871   -1.7184828e-15  0              0.099974614    3.8011563e-08  0              1.8354423     -1.5            0              2.9992026    
   1800000   9000           100            100            0.033324625   -1.7184703e-15  0              0.099973876    2.4046617e-09  0              0.11611251    -1.5            0              2.9992026    
   1900000   9000           100            100            0.033324491   -1.7184634e-15  0              0.099973474    2.1567271e-09  0              0.10414063    -1.5            0              2.9992026    
   2000000   9000           100            100            0.033324462   -1.7184618e-15  0              0.099973387    2.130201e-10   0              0.010285978   -1.5            0              2.9992026    
   2100000   9000           100            100            0.033324466   -1.718462e-15   0              0.099973399    4.6552259e-13  0              2.247842e-05  -1.5            0              2.9992026    
   2200000   9000           100            100            0.033324472   -1.7184623e-15  0              0.099973415    2.3398558e-12  0              0.00011298326 -1.5            0              2.9992026    
   2300000   9000           100            100            0.033324474   -1.7184624e-15  0              0.099973421    5.9171449e-13  0              2.8571775e-05 -1.5            0              2.9992026    
   2400000   9000           100            100            0.033324474   -1.7184624e-15  0              0.099973421    2.3266934e-14  0              1.123477e-06  -1.5            0              2.9992026    
   2500000   9000           100            100            0.033324474   -1.7184624e-15  0              0.099973421    7.0911232e-16  0              3.4240496e-08 -1.5            0              2.9992026    
   2600000   9000           100            100            0.033324473   -1.7184624e-15  0              0.09997342     1.1232941e-15  0              5.4239852e-08 -1.5            0              2.9992026    
   2700000   9000           100            100            0.033324473   -1.7184624e-15  0              0.09997342     1.4677087e-17  0              7.08704e-10   -1.5            0              2.9992026    
   2800000   9000           100            100            0.033324473   -1.7184624e-15  0              0.09997342     5.9154029e-18  0              2.8563363e-10 -1.5            0              2.9992026    
   2900000   9000           100            100            0.033324473   -1.7184624e-15  0              0.09997342     2.1731612e-17  0              1.0493418e-09 -1.5            0              2.9992026    
   3000000   9000           100            100            0.033324473   -1.7184624e-15  0              0.09997342     1.1526565e-17  0              5.5657656e-10 -1.5            0              2.9992026    
Loop time of 711.699 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3641989.243 ns/day, 0.000 hours/ns, 4215.265 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 307.06     | 314.19     | 321.9      |  38.3 | 44.15
Neigh   | 1.6425     | 1.656      | 1.6721     |   1.0 |  0.23
Comm    | 35.356     | 42.828     | 50.3       | 109.9 |  6.02
Output  | 0.4363     | 0.43648    | 0.43684    |   0.0 |  0.06
Modify  | 307.93     | 309.03     | 310.63     |   6.0 | 43.42
Other   |            | 43.56      |            |       |  6.12

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 75000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027627221    3.4365515e-20  0              0.082881664    1806341.1      0              8.7221748e+13 -1.5            0              3.3128082    
    200000   9000           100            100            0.010978944    9.548974e-21   0              0.032936833    526977.84      0              2.5445874e+13 -1.5            0              3.0461494    
    300000   9000           100            100            0.0032472615   2.8623866e-21  0              0.0097417845   76496.946      0              3.6937638e+12 -1.5            0              3.0295481    
    400000   9000           100            100            0.29581683    -1.5306479e-14  0              0.88745049     11681.728      0              5.6406883e+11 -1.5            0              2.9967422    
    500000   9000           100            100           -0.00042325351 -4.8352914e-21  0             -0.0012697605   2079.6369      0              1.0041822e+11 -1.5            0              3.0014335    
    600000   9000           100            100            0.0042469281  -2.3100738e-16  0              0.012740784    413.14611      0              1.9949347e+10 -1.5            0              2.9998013    
    700000   9000           100            100            0.041758711   -2.1464795e-15  0              0.12527613     111.32053      0              5.3752698e+09 -1.5            0              2.9991163    
    800000   9000           100            100            0.035999246   -1.8541355e-15  0              0.10799774     15.073953      0              7.2786725e+08 -1.5            0              2.9991988    
    900000   9000           100            100            0.034703704   -1.7891956e-15  0              0.10411111     1.2159344      0              58713122      -1.5            0              2.9992178    
   1000000   9000           100            100            0.033937815   -1.7502814e-15  0              0.10181344     0.059031328    0              2850411.6     -1.5            0              2.9992292    
   1100000   9000           100            100            0.033563829   -1.7311461e-15  0              0.10069149     0.00057450536  0              27740.808     -1.5            0              2.9992348    
   1200000   9000           100            100            0.033408331   -1.723155e-15   0              0.10022499     0.00021005662  0              10142.882     -1.5            0              2.9992372    
   1300000   9000           100            100            0.033350881   -1.7201922e-15  0              0.10005264     0.00016281087  0              7861.554      -1.5            0              2.9992381    
   1400000   9000           100            100            0.033331844   -1.7192068e-15  0              0.099995531    4.5579047e-05  0              2200.8491     -1.5            0              2.9992384    
   1500000   9000           100            100            0.033326282   -1.7189176e-15  0              0.099978846    8.589608e-06   0              414.76143     -1.5            0              2.9992384    
   1600000   9000           100            100            0.033324941   -1.7188473e-15  0              0.099974824    1.253533e-06   0              60.528622     -1.5            0              2.9992385    
   1700000   9000           100            100            0.033324741   -1.7188365e-15  0              0.099974223    1.4699563e-07  0              7.0978929     -1.5            0              2.9992385    
   1800000   9000           100            100            0.033324775   -1.7188381e-15  0              0.099974325    1.3613846e-08  0              0.65736392    -1.5            0              2.9992385    
   1900000   9000           100            100            0.033324823   -1.7188405e-15  0              0.09997447     9.0802077e-10  0              0.043845073   -1.5            0              2.9992385    
   2000000   9000           100            100            0.033324851   -1.7188419e-15  0              0.099974554    3.0900024e-11  0              0.0014920516  -1.5            0              2.9992385    
   2100000   9000           100            100            0.033324864   -1.7188426e-15  0              0.099974592    3.680398e-15   0              1.7771325e-07 -1.5            0              2.9992385    
   2200000   9000           100            100            0.033324869   -1.7188428e-15  0              0.099974608    5.4973111e-13  0              2.6544548e-05 -1.5            0              2.9992385    
   2300000   9000           100            100            0.033324871   -1.7188429e-15  0              0.099974613    2.4202333e-13  0              1.168644e-05  -1.5            0              2.9992385    
   2400000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    5.6039074e-14  0              2.7059263e-06 -1.5            0              2.9992385    
   2500000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    9.5023133e-15  0              4.588327e-07  -1.5            0              2.9992385    
   2600000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    1.2206146e-15  0              5.8939112e-08 -1.5            0              2.9992385    
   2700000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    5.0782156e-17  0              2.4520886e-09 -1.5            0              2.9992385    
   2800000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    2.9518238e-18  0              1.4253301e-10 -1.5            0              2.9992385    
   2900000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    6.6508196e-21  0              3.2114428e-13 -1.5            0              2.9992385    
   3000000   9000           100            100            0.033324872   -1.718843e-15   0              0.099974615    2.2835297e-17  0              1.1026348e-09 -1.5            0              2.9992385    
Loop time of 702.772 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3688252.379 ns/day, 0.000 hours/ns, 4268.811 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 309.37     | 311.22     | 314.55     |  11.4 | 44.29
Neigh   | 1.6273     | 1.6393     | 1.6527     |   0.9 |  0.23
Comm    | 36.968     | 39.225     | 41.126     |  26.8 |  5.58
Output  | 0.43423    | 0.4344     | 0.43473    |   0.0 |  0.06
Modify  | 304.8      | 307.4      | 309.8      |  10.9 | 43.74
Other   |            | 42.84      |            |       |  6.10

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 80000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027642526    3.4458983e-20  0              0.082927577    1807823.1      0              8.7293309e+13 -1.5            0              3.3124556    
    200000   9000           100            100            0.011009209    9.2853285e-21  0              0.033027628    529221.54      0              2.5554214e+13 -1.5            0              3.0455466    
    300000   9000           100            100            0.0032941554   3.1841168e-21  0              0.0098824663   78403.684      0              3.7858333e+12 -1.5            0              3.0290559    
    400000   9000           100            100            0.35981105    -1.8619094e-14  0              1.0794332      1336.7498      0              6.4546862e+10 -1.5            0              2.9964369    
    500000   9000           100            100           -0.00023024609 -4.5102208e-21  0             -0.00069073828  593.23756      0              2.8645319e+10 -1.5            0              3.0019885    
    600000   9000           100            100            0.030772229   -1.564244e-15   0              0.092316688    1251.6769      0              6.0439e+10    -1.5            0              2.9993137    
    700000   9000           100            100            0.049109591   -2.5357491e-15  0              0.14732877     11.54608       0              5.5751888e+08 -1.5            0              2.9990549    
    800000   9000           100            100            0.037698927   -1.9432448e-15  0              0.11309678     8.2701001      0              3.9933354e+08 -1.5            0              2.9992084    
    900000   9000           100            100            0.034006991   -1.7538125e-15  0              0.10202097     2.2790759      0              1.1004842e+08 -1.5            0              2.9992608    
   1000000   9000           100            100            0.03322991    -1.7143714e-15  0              0.099689729    0.31872611     0              15390143      -1.5            0              2.999272     
   1100000   9000           100            100            0.033180406   -1.712083e-15   0              0.099541219    0.027059517    0              1306607.2     -1.5            0              2.9992727    
   1200000   9000           100            100            0.033246096   -1.7155573e-15  0              0.099738289    0.0010406473   0              50249.133     -1.5            0              2.9992717    
   1300000   9000           100            100            0.033293715   -1.7180342e-15  0              0.099881146    2.1769823e-07  0              10.511869     -1.5            0              2.999271     
   1400000   9000           100            100            0.033315391   -1.7191544e-15  0              0.099946173    1.9046023e-05  0              919.6643      -1.5            0              2.9992707    
   1500000   9000           100            100            0.033323017   -1.7195465e-15  0              0.099969051    7.2153258e-06  0              348.40226     -1.5            0              2.9992706    
   1600000   9000           100            100            0.033325078   -1.7196518e-15  0              0.099975235    1.2971097e-06  0              62.632786     -1.5            0              2.9992705    
   1700000   9000           100            100            0.033325413   -1.7196685e-15  0              0.099976239    1.4247076e-07  0              6.8794029     -1.5            0              2.9992705    
   1800000   9000           100            100            0.033325363   -1.7196658e-15  0              0.09997609     8.7837724e-09  0              0.42413693    -1.5            0              2.9992705    
   1900000   9000           100            100            0.03332529    -1.7196619e-15  0              0.099975869    1.2831499e-10  0              0.0061958719  -1.5            0              2.9992705    
   2000000   9000           100            100            0.03332525    -1.7196598e-15  0              0.09997575     2.2065542e-11  0              0.001065466   -1.5            0              2.9992705    
   2100000   9000           100            100            0.033325234   -1.719659e-15   0              0.099975702    1.9232674e-11  0              0.000928677   -1.5            0              2.9992705    
   2200000   9000           100            100            0.033325229   -1.7196588e-15  0              0.099975687    4.6898106e-12  0              0.00022645417 -1.5            0              2.9992705    
   2300000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    6.5384047e-13  0              3.1571616e-05 -1.5            0              2.9992705    
   2400000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    5.5662732e-14  0              2.6877541e-06 -1.5            0              2.9992705    
   2500000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    2.1351533e-15  0              1.0309891e-07 -1.5            0              2.9992705    
   2600000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    2.4025361e-18  0              1.1600987e-10 -1.5            0              2.9992705    
   2700000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    1.6978905e-16  0              8.1985055e-09 -1.5            0              2.9992705    
   2800000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    1.1944394e-18  0              5.7675206e-11 -1.5            0              2.9992705    
   2900000   9000           100            100            0.033325228   -1.7196587e-15  0              0.099975684    3.1519529e-18  0              1.5219653e-10 -1.5            0              2.9992705    
   3000000   9000           100            100            0.033325228   -1.7196588e-15  0              0.099975684    6.5641594e-19  0              3.1695976e-11 -1.5            0              2.9992705    
Loop time of 713.544 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3632572.543 ns/day, 0.000 hours/ns, 4204.366 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 317.51     | 321.3      | 325.26     |  16.7 | 45.03
Neigh   | 1.5875     | 1.6006     | 1.613      |   0.9 |  0.22
Comm    | 37.134     | 40.205     | 42.537     |  31.8 |  5.63
Output  | 0.43537    | 0.43563    | 0.43623    |   0.1 |  0.06
Modify  | 306.88     | 308.71     | 310.51     |   7.3 | 43.26
Other   |            | 41.3       |            |       |  5.79

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 85000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027656548    3.4454826e-20  0              0.082969645    1809182        0              8.7358922e+13 -1.5            0              3.3121307    
    200000   9000           100            100            0.011037024    9.3880248e-21  0              0.033111073    531286.52      0              2.5653925e+13 -1.5            0              3.0449895    
    300000   9000           100            100            0.0033373543   2.9615866e-21  0              0.010012063    80175.332      0              3.8713799e+12 -1.5            0              3.0285952    
    400000   9000           100            100            0.3670813     -1.9114596e-14  0              1.1012439      1535.5212      0              7.4144825e+10 -1.5            0              2.9965272    
    500000   9000           100            100           -4.9846061e-05 -4.5122324e-21  0             -0.00014953818  26.413772      0              1.2754265e+09 -1.5            0              3.0022358    
    600000   9000           100            100            0.064474464   -3.3440954e-15  0              0.19342339     757.06294      0              3.655586e+10  -1.5            0              2.9989091    
    700000   9000           100            100            0.041506965   -2.148723e-15   0              0.1245209      125.00912      0              6.0362431e+09 -1.5            0              2.9991876    
    800000   9000           100            100            0.036384958   -1.8745685e-15  0              0.10915487     15.264598      0              7.370728e+08  -1.5            0              2.9992577    
    900000   9000           100            100            0.031596307   -1.6297178e-15  0              0.094788922    0.73292054     0              35390110      -1.5            0              2.999324     
   1000000   9000           100            100            0.032909579   -1.6983079e-15  0              0.098728737    0.22676644     0              10949740      -1.5            0              2.9993052    
   1100000   9000           100            100            0.033530413   -1.7300861e-15  0              0.10059124     0.015717817    0              758957.12     -1.5            0              2.9992965    
   1200000   9000           100            100            0.033385675   -1.7225039e-15  0              0.10015702     0.0030879741   0              149107.22     -1.5            0              2.9992986    
   1300000   9000           100            100            0.033301944   -1.7182117e-15  0              0.099905832    0.00032126624  0              15512.797     -1.5            0              2.9992998    
   1400000   9000           100            100            0.03331706    -1.7190072e-15  0              0.099951181    4.0216815e-05  0              1941.926      -1.5            0              2.9992995    
   1500000   9000           100            100            0.033328211   -1.7195795e-15  0              0.099984632    6.271748e-06   0              302.84027     -1.5            0              2.9992994    
   1600000   9000           100            100            0.033326722   -1.7195007e-15  0              0.099980167    4.9925969e-07  0              24.107464     -1.5            0              2.9992994    
   1700000   9000           100            100            0.033325257   -1.7194254e-15  0              0.099975772    1.1771407e-07  0              5.6839912     -1.5            0              2.9992994    
   1800000   9000           100            100            0.03332539    -1.7194325e-15  0              0.09997617     5.82186e-09    0              0.28111679    -1.5            0              2.9992994    
   1900000   9000           100            100            0.03332558    -1.7194423e-15  0              0.09997674     2.1373367e-09  0              0.10320434    -1.5            0              2.9992994    
   2000000   9000           100            100            0.03332557    -1.7194417e-15  0              0.099976711    6.2272091e-11  0              0.0030068964  -1.5            0              2.9992994    
   2100000   9000           100            100            0.033325546   -1.7194405e-15  0              0.099976638    3.7673709e-11  0              0.0018191286  -1.5            0              2.9992994    
   2200000   9000           100            100            0.033325546   -1.7194405e-15  0              0.099976639    5.8517773e-13  0              2.8256139e-05 -1.5            0              2.9992994    
   2300000   9000           100            100            0.033325549   -1.7194407e-15  0              0.099976648    6.4606005e-13  0              3.1195927e-05 -1.5            0              2.9992994    
   2400000   9000           100            100            0.03332555    -1.7194407e-15  0              0.099976649    4.4278119e-15  0              2.1380319e-07 -1.5            0              2.9992994    
   2500000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    1.080055e-14   0              5.2151991e-07 -1.5            0              2.9992994    
   2600000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    2.7732273e-17  0              1.3390922e-09 -1.5            0              2.9992994    
   2700000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    1.5394901e-16  0              7.4336468e-09 -1.5            0              2.9992994    
   2800000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    4.0488892e-19  0              1.9550637e-11 -1.5            0              2.9992994    
   2900000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    4.5507897e-18  0              2.1974135e-10 -1.5            0              2.9992994    
   3000000   9000           100            100            0.033325549   -1.7194406e-15  0              0.099976647    8.271227e-18   0              3.9938795e-10 -1.5            0              2.9992994    
Loop time of 682.969 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3795196.458 ns/day, 0.000 hours/ns, 4392.588 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 271.57     | 280.82     | 293.53     |  47.8 | 41.12
Neigh   | 1.6734     | 1.6866     | 1.7032     |   1.0 |  0.25
Comm    | 38.75      | 46.879     | 52.221     |  74.1 |  6.86
Output  | 0.43679    | 0.4371     | 0.43777    |   0.1 |  0.06
Modify  | 303.98     | 309        | 318.11     |  30.7 | 45.24
Other   |            | 44.15      |            |       |  6.46

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 90000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027669463    3.4278372e-20  0              0.083008389    1810434.3      0              8.7419392e+13 -1.5            0              3.31183      
    200000   9000           100            100            0.011062724    9.5798237e-21  0              0.033188171    533196.92      0              2.5746171e+13 -1.5            0              3.0444718    
    300000   9000           100            100            0.0033773613   3.1815427e-21  0              0.010132084    81828.94       0              3.9512266e+12 -1.5            0              3.0281621    
    400000   9000           100            100            0.3192539     -1.6566609e-14  0              0.95776171     11321.705      0              5.4668462e+11 -1.5            0              2.9969501    
    500000   9000           100            100            0.00011918664 -4.3475385e-21  0              0.00035755991  152.71694      0              7.3741546e+09 -1.5            0              3.0022483    
    600000   9000           100            100           -9.3420583e-05 -3.4195384e-19  0             -0.00028026175  96.751663      0              4.6717915e+09 -1.5            0              2.9999993    
    700000   9000           100            100            0.036237063   -1.8793232e-15  0              0.10871119     164.48365      0              7.9423269e+09 -1.5            0              2.9992852    
    800000   9000           100            100            0.031048438   -1.6004249e-15  0              0.093145313    18.266995      0              8.8204781e+08 -1.5            0              2.9993573    
    900000   9000           100            100            0.033430746   -1.7272052e-15  0              0.10029224     2.7161638      0              1.3115383e+08 -1.5            0              2.999324     
   1000000   9000           100            100            0.033563245   -1.732577e-15   0              0.10068974     0.3112186      0              15027633      -1.5            0              2.9993225    
   1100000   9000           100            100            0.033151269   -1.7118059e-15  0              0.099453807    0.025228727    0              1218204.9     -1.5            0              2.999328     
   1200000   9000           100            100            0.033410656   -1.7250551e-15  0              0.10023197     0.0011652066   0              56263.655     -1.5            0              2.9993245    
   1300000   9000           100            100            0.033292078   -1.718964e-15   0              0.099876234    5.5937555e-06  0              270.10243     -1.5            0              2.9993261    
   1400000   9000           100            100            0.033337349   -1.721299e-15   0              0.10001205     7.6148502e-06  0              367.69386     -1.5            0              2.9993255    
   1500000   9000           100            100            0.033322533   -1.7205317e-15  0              0.099967599    4.4788778e-06  0              216.26898     -1.5            0              2.9993257    
   1600000   9000           100            100            0.033326562   -1.7207416e-15  0              0.099979686    1.0911801e-06  0              52.68918      -1.5            0              2.9993256    
   1700000   9000           100            100            0.033325783   -1.7207004e-15  0              0.099977349    1.7653434e-07  0              8.5242113     -1.5            0              2.9993256    
   1800000   9000           100            100            0.033325786   -1.720701e-15   0              0.099977359    2.0892352e-08  0              1.0088169     -1.5            0              2.9993256    
   1900000   9000           100            100            0.033325883   -1.7207058e-15  0              0.099977648    1.7666479e-09  0              0.085305104   -1.5            0              2.9993256    
   2000000   9000           100            100            0.033325819   -1.7207025e-15  0              0.099977457    8.8228812e-11  0              0.0042602535  -1.5            0              2.9993256    
   2100000   9000           100            100            0.033325849   -1.7207041e-15  0              0.099977546    7.5682654e-13  0              3.6544445e-05 -1.5            0              2.9993256    
   2200000   9000           100            100            0.033325837   -1.7207035e-15  0              0.099977512    3.7908025e-13  0              1.8304429e-05 -1.5            0              2.9993256    
   2300000   9000           100            100            0.033325841   -1.7207037e-15  0              0.099977523    2.6471991e-13  0              1.2782377e-05 -1.5            0              2.9993256    
   2400000   9000           100            100            0.03332584    -1.7207036e-15  0              0.09997752     6.8073839e-14  0              3.2870421e-06 -1.5            0              2.9993256    
   2500000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    1.1444275e-14  0              5.5260308e-07 -1.5            0              2.9993256    
   2600000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    1.4451449e-15  0              6.9780873e-08 -1.5            0              2.9993256    
   2700000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    1.1137092e-16  0              5.3777033e-09 -1.5            0              2.9993256    
   2800000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    8.9957559e-18  0              4.3437286e-10 -1.5            0              2.9993256    
   2900000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    2.21565e-17    0              1.0698581e-09 -1.5            0              2.9993256    
   3000000   9000           100            100            0.03332584    -1.7207036e-15  0              0.099977521    2.3500917e-19  0              1.1347752e-11 -1.5            0              2.9993256    
Loop time of 668.613 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3876680.732 ns/day, 0.000 hours/ns, 4486.899 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 259.71     | 269.82     | 276.18     |  38.1 | 40.36
Neigh   | 1.672      | 1.6827     | 1.6929     |   0.8 |  0.25
Comm    | 36.467     | 42.111     | 50.997     |  90.1 |  6.30
Output  | 0.43395    | 0.43423    | 0.43493    |   0.1 |  0.06
Modify  | 306.87     | 309.3      | 310.89     |   8.4 | 46.26
Other   |            | 45.26      |            |       |  6.77

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 95000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027681409    3.4837145e-20  0              0.083044227    1811593        0              8.7475344e+13 -1.5            0              3.3115513    
    200000   9000           100            100            0.01108652     9.7495002e-21  0              0.03325956     534967.84      0              2.5831682e+13 -1.5            0              3.0439908    
    300000   9000           100            100            0.003414489    2.998391e-21   0              0.010243467    83374.5        0              4.0258562e+12 -1.5            0              3.0277552    
    400000   9000           100            100            0.23395972    -1.2187311e-14  0              0.70187917     24433.362      0              1.1797996e+12 -1.5            0              2.9976045    
    500000   9000           100            100            0.00027783269 -4.2847003e-21  0              0.00083349807  804.86458      0              3.886403e+10  -1.5            0              3.0020802    
    600000   9000           100            100            0.020808447   -1.0536424e-15  0              0.062425342    1234.5601      0              5.9612487e+10 -1.5            0              2.9995302    
    700000   9000           100            100            0.037024305   -1.9191235e-15  0              0.11107291     165.56892      0              7.9947308e+09 -1.5            0              2.9993006    
    800000   9000           100            100            0.027592824   -1.4251701e-15  0              0.082778471    2.0386087      0              98437120      -1.5            0              2.9994262    
    900000   9000           100            100            0.033647121   -1.7353313e-15  0              0.10094136     2.7366503      0              1.3214305e+08 -1.5            0              2.9993455    
   1000000   9000           100            100            0.033928764   -1.7512062e-15  0              0.10178629     0.14061769     0              6789925.1     -1.5            0              2.9993416    
   1100000   9000           100            100            0.033066379   -1.706537e-15   0              0.099199136    0.0053390773   0              257804.94     -1.5            0              2.9993529    
   1200000   9000           100            100            0.033344639   -1.7207874e-15  0              0.10003392     0.0054832356   0              264765.83     -1.5            0              2.9993493    
   1300000   9000           100            100            0.033352245   -1.7212407e-15  0              0.10005674     0.00031601081  0              15259.031     -1.5            0              2.9993492    
   1400000   9000           100            100            0.033314208   -1.7192695e-15  0              0.099942625    8.3307815e-06  0              402.26362     -1.5            0              2.9993496    
   1500000   9000           100            100            0.03332714    -1.7199322e-15  0              0.099981419    1.0926248e-05  0              527.58942     -1.5            0              2.9993495    
   1600000   9000           100            100            0.033327235   -1.7199398e-15  0              0.099981704    7.0834084e-07  0              34.203244     -1.5            0              2.9993495    
   1700000   9000           100            100            0.033325562   -1.7198531e-15  0              0.099976686    1.2383709e-08  0              0.597965      -1.5            0              2.9993495    
   1800000   9000           100            100            0.033326161   -1.7198838e-15  0              0.099978483    2.1679166e-08  0              1.0468093     -1.5            0              2.9993495    
   1900000   9000           100            100            0.033326154   -1.7198835e-15  0              0.099978462    1.5744951e-09  0              0.076026734   -1.5            0              2.9993495    
   2000000   9000           100            100            0.033326081   -1.7198797e-15  0              0.099978242    1.7289374e-11  0              0.00083484197 -1.5            0              2.9993495    
   2100000   9000           100            100            0.033326108   -1.7198812e-15  0              0.099978325    4.282794e-11   0              0.002068008   -1.5            0              2.9993495    
   2200000   9000           100            100            0.033326108   -1.7198811e-15  0              0.099978323    3.4748037e-12  0              0.00016778584 -1.5            0              2.9993495    
   2300000   9000           100            100            0.033326104   -1.719881e-15   0              0.099978313    2.192819e-14   0              1.0588338e-06 -1.5            0              2.9993495    
   2400000   9000           100            100            0.033326106   -1.719881e-15   0              0.099978317    8.4025799e-14  0              4.0573051e-06 -1.5            0              2.9993495    
   2500000   9000           100            100            0.033326106   -1.719881e-15   0              0.099978317    7.6198064e-15  0              3.6793318e-07 -1.5            0              2.9993495    
   2600000   9000           100            100            0.033326105   -1.719881e-15   0              0.099978316    8.9683606e-17  0              4.3305004e-09 -1.5            0              2.9993495    
   2700000   9000           100            100            0.033326105   -1.719881e-15   0              0.099978316    8.2416947e-18  0              3.9796194e-10 -1.5            0              2.9993495    
   2800000   9000           100            100            0.033326105   -1.719881e-15   0              0.099978316    2.9907432e-17  0              1.4441229e-09 -1.5            0              2.9993495    
   2900000   9000           100            100            0.033326105   -1.719881e-15   0              0.099978316    6.2287659e-18  0              3.0076481e-10 -1.5            0              2.9993495    
   3000000   9000           100            100            0.033326105   -1.7198811e-15  0              0.099978316    2.6452384e-20  0              1.277291e-12  -1.5            0              2.9993495    
Loop time of 679.396 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3815156.077 ns/day, 0.000 hours/ns, 4415.690 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 265.77     | 279.21     | 291.69     |  65.0 | 41.10
Neigh   | 1.698      | 1.7113     | 1.7244     |   1.0 |  0.25
Comm    | 34.294     | 45.999     | 59.586     | 167.8 |  6.77
Output  | 0.43685    | 0.43708    | 0.43746    |   0.0 |  0.06
Modify  | 305.32     | 307.56     | 310.71     |  11.3 | 45.27
Other   |            | 44.47      |            |       |  6.55

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027692507    3.4406595e-20  0              0.083077522    1812670.3      0              8.752736e+13  -1.5            0              3.3112911    
    200000   9000           100            100            0.011108692    9.3683794e-21  0              0.033326075    536619.72      0              2.5911446e+13 -1.5            0              3.0435405    
    300000   9000           100            100            0.0034491479   3.1305023e-21  0              0.010347444    84826.764      0              4.0959808e+12 -1.5            0              3.0273706    
    400000   9000           100            100            0.13595765    -7.2542837e-15  0              0.40787295     34527.486      0              1.6672087e+12 -1.5            0              2.9983819    
    500000   9000           100            100            0.00042713783 -4.063092e-21   0              0.0012814135   1858.004       0              8.9716363e+10 -1.5            0              3.0017725    
    600000   9000           100            100            0.088279232   -4.5620481e-15  0              0.2648377      14.73919       0              7.1170275e+08 -1.5            0              2.998796     
    700000   9000           100            100            0.043654415   -2.2601348e-15  0              0.13096325     120.09689      0              5.7990491e+09 -1.5            0              2.9992461    
    800000   9000           100            100            0.037624799   -1.9441758e-15  0              0.1128744      12.298588      0              5.938548e+08  -1.5            0              2.999318     
    900000   9000           100            100            0.033993198   -1.755631e-15   0              0.10197959     2.604539       0              1.2576387e+08 -1.5            0              2.9993628    
   1000000   9000           100            100            0.033161759   -1.7120724e-15  0              0.099485276    0.34800002     0              16803675      -1.5            0              2.9993734    
   1100000   9000           100            100            0.033137213   -1.7105207e-15  0              0.09941164     0.025896935    0              1250470.3     -1.5            0              2.9993737    
   1200000   9000           100            100            0.03323014    -1.7152217e-15  0              0.09969042     0.00060273763  0              29104.043     -1.5            0              2.9993726    
   1300000   9000           100            100            0.033290916   -1.7183358e-15  0              0.099872749    2.7654704e-05  0              1335.3467     -1.5            0              2.9993718    
   1400000   9000           100            100            0.033316675   -1.7196634e-15  0              0.099950025    4.0458848e-05  0              1953.613      -1.5            0              2.9993715    
   1500000   9000           100            100            0.03332487    -1.720088e-15   0              0.09997461     1.062696e-05   0              513.13787     -1.5            0              2.9993714    
   1600000   9000           100            100            0.033326662   -1.7201818e-15  0              0.099979987    1.454181e-06   0              70.217194     -1.5            0              2.9993714    
   1700000   9000           100            100            0.03332673    -1.7201859e-15  0              0.099980189    1.096175e-07   0              5.2930367     -1.5            0              2.9993714    
   1800000   9000           100            100            0.033326544   -1.7201765e-15  0              0.099979632    2.6505177e-09  0              0.12798401    -1.5            0              2.9993714    
   1900000   9000           100            100            0.033326421   -1.7201702e-15  0              0.099979262    1.040135e-10   0              0.0050224398  -1.5            0              2.9993714    
   2000000   9000           100            100            0.033326368   -1.7201675e-15  0              0.099979105    1.6447429e-10  0              0.0079418748  -1.5            0              2.9993714    
   2100000   9000           100            100            0.033326352   -1.7201666e-15  0              0.099979055    4.3869635e-11  0              0.0021183077  -1.5            0              2.9993714    
   2200000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979044    6.0562415e-12  0              0.00029243423 -1.5            0              2.9993714    
   2300000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979043    4.6320946e-13  0              2.2366727e-05 -1.5            0              2.9993714    
   2400000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979044    1.1756882e-14  0              5.6769777e-07 -1.5            0              2.9993714    
   2500000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979045    3.8789031e-16  0              1.8729835e-08 -1.5            0              2.9993714    
   2600000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979045    5.0445598e-16  0              2.4358374e-08 -1.5            0              2.9993714    
   2700000   9000           100            100            0.033326348   -1.7201665e-15  0              0.099979045    1.0319148e-16  0              4.9827473e-09 -1.5            0              2.9993714    
   2800000   9000           100            100            0.033326348   -1.7201665e-15  0              0.099979045    6.5445747e-18  0              3.1601409e-10 -1.5            0              2.9993714    
   2900000   9000           100            100            0.033326348   -1.7201665e-15  0              0.099979045    7.4577889e-18  0              3.6010994e-10 -1.5            0              2.9993714    
   3000000   9000           100            100            0.033326348   -1.7201664e-15  0              0.099979045    9.9654374e-18  0              4.8119531e-10 -1.5            0              2.9993714    
Loop time of 679.703 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3813429.899 ns/day, 0.000 hours/ns, 4413.692 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 264.4      | 280.74     | 290.57     |  62.0 | 41.30
Neigh   | 1.7131     | 1.7182     | 1.7233     |   0.4 |  0.25
Comm    | 35.758     | 45.49      | 61.213     | 155.2 |  6.69
Output  | 0.43575    | 0.43596    | 0.43634    |   0.0 |  0.06
Modify  | 305.57     | 308.15     | 310.47     |  10.0 | 45.34
Other   |            | 43.17      |            |       |  6.35

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 105000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027702856    3.5055171e-20  0              0.083108568    1813675.3      0              8.7575889e+13 -1.5            0              3.3110473    
    200000   9000           100            100            0.011129403    9.2564117e-21  0              0.03338821     538164.37      0              2.5986031e+13 -1.5            0              3.0431182    
    300000   9000           100            100            0.0034815757   2.9204261e-21  0              0.010444727    86193.768      0              4.1619886e+12 -1.5            0              3.0270069    
    400000   9000           100            100            0.04962604    -2.6855458e-15  0              0.14887812     38723.032      0              1.8697966e+12 -1.5            0              2.9991887    
    500000   9000           100            100            0.00056794455 -3.8300696e-21  0              0.0017038336   3217.4943      0              1.5536128e+11 -1.5            0              3.0013566    
    600000   9000           100            100            0.016390203   -8.721693e-16   0              0.04917061     1207.7445      0              5.831766e+10  -1.5            0              2.9996157    
    700000   9000           100            100            0.051853344   -2.6783395e-15  0              0.15556003     11.089542      0              5.3547428e+08 -1.5            0              2.9991825    
    800000   9000           100            100            0.032669018   -1.6835772e-15  0              0.098007053    22.794344      0              1.1006573e+09 -1.5            0              2.9994001    
    900000   9000           100            100            0.031072956   -1.6042565e-15  0              0.093218869    0.096067144    0              4638738.6     -1.5            0              2.9994193    
   1000000   9000           100            100            0.032910817   -1.6995999e-15  0              0.098732451    0.27768421     0              13408377      -1.5            0              2.9993965    
   1100000   9000           100            100            0.033513964   -1.7304647e-15  0              0.10054189     0.027763505    0              1340600.3     -1.5            0              2.9993892    
   1200000   9000           100            100            0.033425047   -1.7257501e-15  0              0.10027514     0.00068836811  0              33238.832     -1.5            0              2.9993903    
   1300000   9000           100            100            0.0333269     -1.7206876e-15  0              0.099980701    0.00075969398  0              36682.903     -1.5            0              2.9993915    
   1400000   9000           100            100            0.033314158   -1.7200466e-15  0              0.099942475    1.174122e-05   0              566.94149     -1.5            0              2.9993916    
   1500000   9000           100            100            0.033323487   -1.7205318e-15  0              0.09997046     7.068022e-06   0              341.28949     -1.5            0              2.9993915    
   1600000   9000           100            100            0.033327392   -1.7207321e-15  0              0.099982175    1.1807555e-06  0              57.014458     -1.5            0              2.9993915    
   1700000   9000           100            100            0.033327164   -1.7207196e-15  0              0.099981493    5.0565968e-09  0              0.24416496    -1.5            0              2.9993915    
   1800000   9000           100            100            0.033326613   -1.7206911e-15  0              0.09997984     2.413574e-08   0              1.1654285     -1.5            0              2.9993915    
   1900000   9000           100            100            0.033326507   -1.7206857e-15  0              0.099979521    8.4428737e-10  0              0.040767615   -1.5            0              2.9993915    
   2000000   9000           100            100            0.033326551   -1.720688e-15   0              0.099979652    1.5871522e-10  0              0.0076637899  -1.5            0              2.9993915    
   2100000   9000           100            100            0.033326575   -1.7206893e-15  0              0.099979725    4.5911053e-11  0              0.0022168804  -1.5            0              2.9993915    
   2200000   9000           100            100            0.033326575   -1.7206893e-15  0              0.099979726    4.001756e-15   0              1.9323048e-07 -1.5            0              2.9993915    
   2300000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979717    7.1317496e-13  0              3.4436666e-05 -1.5            0              2.9993915    
   2400000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979715    4.5577071e-14  0              2.2007537e-06 -1.5            0              2.9993915    
   2500000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979716    3.2098117e-15  0              1.5499032e-07 -1.5            0              2.9993915    
   2600000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979716    1.6056946e-15  0              7.7533246e-08 -1.5            0              2.9993915    
   2700000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979716    2.2097191e-16  0              1.0669943e-08 -1.5            0              2.9993915    
   2800000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979716    7.7501945e-18  0              3.7422916e-10 -1.5            0              2.9993915    
   2900000   9000           100            100            0.033326572   -1.7206891e-15  0              0.099979716    7.9107034e-18  0              3.8197956e-10 -1.5            0              2.9993915    
   3000000   9000           100            100            0.033326572   -1.7206892e-15  0              0.099979716    2.3576148e-18  0              1.1384078e-10 -1.5            0              2.9993915    
Loop time of 668.361 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3878144.283 ns/day, 0.000 hours/ns, 4488.593 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 269.95     | 272.87     | 275.96     |  14.2 | 40.83
Neigh   | 1.7185     | 1.7303     | 1.7428     |   0.9 |  0.26
Comm    | 38.391     | 40.631     | 41.774     |  21.3 |  6.08
Output  | 0.43472    | 0.43509    | 0.43588    |   0.1 |  0.07
Modify  | 305.16     | 307.63     | 310.59     |  11.1 | 46.03
Other   |            | 45.06      |            |       |  6.74

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 110000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027712537    3.4696076e-20  0              0.08313761     1814615.7      0              8.76213e+13   -1.5            0              3.3108189    
    200000   9000           100            100            0.011148822    9.2559774e-21  0              0.033446467    539614.04      0              2.6056031e+13 -1.5            0              3.0427207    
    300000   9000           100            100            0.003512043    3.3331854e-21  0              0.010536129    87485.327      0              4.2243533e+12 -1.5            0              3.0266616    
    400000   9000           100            100           -0.0010319595  -7.3001258e-17  0             -0.0030958784   37991.651      0              1.8344808e+12 -1.5            0              2.9999607    
    500000   9000           100            100            0.00070098975 -3.8456419e-21  0              0.0021029692   4810.6146      0              2.3228736e+11 -1.5            0              3.0008568    
    600000   9000           100            100            1.3876494e-05 -9.3720547e-21  0              4.1629483e-05  2.2895201      0              1.1055273e+08 -1.5            0              3.0001151    
    700000   9000           100            100            0.047363932   -2.4368808e-15  0              0.1420918      88.698086      0              4.2829131e+09 -1.5            0              2.9992552    
    800000   9000           100            100            0.032058772   -1.6575041e-15  0              0.096176315    22.692238      0              1.0957269e+09 -1.5            0              2.9994246    
    900000   9000           100            100            0.033590783   -1.7321708e-15  0              0.10077235     2.9553094      0              1.4270131e+08 -1.5            0              2.9994072    
   1000000   9000           100            100            0.033201225   -1.7136491e-15  0              0.099603674    0.37191086     0              17958245      -1.5            0              2.9994115    
   1100000   9000           100            100            0.033381412   -1.7223863e-15  0              0.10014424     0.046745096    0              2257153.4     -1.5            0              2.9994094    
   1200000   9000           100            100            0.03330315    -1.718547e-15   0              0.099909449    0.0058455926   0              282262.74     -1.5            0              2.9994103    
   1300000   9000           100            100            0.03333661    -1.720203e-15   0              0.10000983     0.0007292503   0              35212.887     -1.5            0              2.9994099    
   1400000   9000           100            100            0.033322768   -1.7195138e-15  0              0.099968305    9.0660541e-05  0              4377.673      -1.5            0              2.9994101    
   1500000   9000           100            100            0.033328385   -1.7197947e-15  0              0.099985155    1.1236178e-05  0              542.55483     -1.5            0              2.99941      
   1600000   9000           100            100            0.033326143   -1.7196822e-15  0              0.09997843     1.3879145e-06  0              67.017426     -1.5            0              2.9994101    
   1700000   9000           100            100            0.033327027   -1.7197267e-15  0              0.09998108     1.7086079e-07  0              8.2502561     -1.5            0              2.9994101    
   1800000   9000           100            100            0.033326682   -1.7197093e-15  0              0.099980047    2.0961056e-08  0              1.0121344     -1.5            0              2.9994101    
   1900000   9000           100            100            0.033326815   -1.719716e-15   0              0.099980446    2.5620452e-09  0              0.12371199    -1.5            0              2.9994101    
   2000000   9000           100            100            0.033326764   -1.7197134e-15  0              0.099980293    3.1195939e-10  0              0.015063402   -1.5            0              2.9994101    
   2100000   9000           100            100            0.033326784   -1.7197144e-15  0              0.099980351    3.7842436e-11  0              0.0018272758  -1.5            0              2.9994101    
   2200000   9000           100            100            0.033326776   -1.7197141e-15  0              0.099980329    4.5660396e-12  0              0.00022047771 -1.5            0              2.9994101    
   2300000   9000           100            100            0.033326779   -1.7197142e-15  0              0.099980338    5.4805544e-13  0              2.6463636e-05 -1.5            0              2.9994101    
   2400000   9000           100            100            0.033326778   -1.7197141e-15  0              0.099980335    6.5655622e-14  0              3.170275e-06  -1.5            0              2.9994101    
   2500000   9000           100            100            0.033326779   -1.7197142e-15  0              0.099980336    7.9196797e-15  0              3.8241299e-07 -1.5            0              2.9994101    
   2600000   9000           100            100            0.033326778   -1.7197142e-15  0              0.099980335    1.0106638e-15  0              4.8801338e-08 -1.5            0              2.9994101    
   2700000   9000           100            100            0.033326778   -1.7197142e-15  0              0.099980335    6.2107672e-17  0              2.9989572e-09 -1.5            0              2.9994101    
   2800000   9000           100            100            0.033326778   -1.7197142e-15  0              0.099980335    1.6872934e-17  0              8.147336e-10  -1.5            0              2.9994101    
   2900000   9000           100            100            0.033326778   -1.7197142e-15  0              0.099980335    5.0485461e-19  0              2.4377622e-11 -1.5            0              2.9994101    
   3000000   9000           100            100            0.033326778   -1.7197141e-15  0              0.099980335    1.6290558e-17  0              7.8661276e-10 -1.5            0              2.9994101    
Loop time of 671.263 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3861377.101 ns/day, 0.000 hours/ns, 4469.186 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 267.11     | 273.06     | 286.16     |  46.2 | 40.68
Neigh   | 1.7484     | 1.7623     | 1.776      |   1.0 |  0.26
Comm    | 34.849     | 43.952     | 51.72      | 116.4 |  6.55
Output  | 0.43387    | 0.43414    | 0.43478    |   0.1 |  0.06
Modify  | 303.45     | 308.57     | 317.11     |  29.4 | 45.97
Other   |            | 43.48      |            |       |  6.48

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 115000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027721619    3.4798203e-20  0              0.083164857    1815498.3      0              8.7663915e+13 -1.5            0              3.3106042    
    200000   9000           100            100            0.011167056    9.3132347e-21  0              0.033501169    540976.41      0              2.6121815e+13 -1.5            0              3.0423465    
    300000   9000           100            100            0.0035407018   3.3667705e-21  0              0.010622105    88706.553      0              4.283322e+12  -1.5            0              3.0263338    
    400000   9000           100            100           -0.0015549693  -1.5665467e-21  0             -0.0046649078   35950.933      0              1.7359419e+12 -1.5            0              3.0006709    
    500000   9000           100            100            0.00082696393 -3.8646236e-21  0              0.0024808918   6581.5156      0              3.1779783e+11 -1.5            0              3.000292     
    600000   9000           100            100            0.015404376   -7.7869499e-16  0              0.046213127    1233.2037      0              5.9546995e+10 -1.5            0              2.9996629    
    700000   9000           100            100            0.025671974   -1.3155658e-15  0              0.077015922    155.5287       0              7.5099244e+09 -1.5            0              2.9995203    
    800000   9000           100            100            0.033412013   -1.7195432e-15  0              0.10023604     23.983879      0              1.1580957e+09 -1.5            0              2.9994269    
    900000   9000           100            100            0.035511097   -1.8305178e-15  0              0.10653329     0.63425695     0              30625998      -1.5            0              2.9994026    
   1000000   9000           100            100            0.033998281   -1.7533374e-15  0              0.10199484     0.15532362     0              7500021.9     -1.5            0              2.9994196    
   1100000   9000           100            100            0.033241399   -1.7141986e-15  0              0.099724198    0.045666357    0              2205064.9     -1.5            0              2.9994282    
   1200000   9000           100            100            0.033217578   -1.7128339e-15  0              0.099652734    0.00010572474  0              5105.0692     -1.5            0              2.9994285    
   1300000   9000           100            100            0.033306995   -1.7174202e-15  0              0.099920985    0.00058989494  0              28483.916     -1.5            0              2.9994275    
   1400000   9000           100            100            0.033335263   -1.7188883e-15  0              0.10000579     6.6384433e-05  0              3205.4667     -1.5            0              2.9994272    
   1500000   9000           100            100            0.033331845   -1.7187181e-15  0              0.099995535    6.3196167e-07  0              30.515167     -1.5            0              2.9994272    
   1600000   9000           100            100            0.033327288   -1.7184835e-15  0              0.099981863    1.5875416e-06  0              76.656705     -1.5            0              2.9994273    
   1700000   9000           100            100            0.033326439   -1.7184391e-15  0              0.099979318    6.434622e-08   0              3.1070487     -1.5            0              2.9994273    
   1800000   9000           100            100            0.03332678    -1.7184564e-15  0              0.09998034     7.8876529e-09  0              0.38086653    -1.5            0              2.9994273    
   1900000   9000           100            100            0.033326984   -1.7184669e-15  0              0.099980952    3.2792498e-09  0              0.15834324    -1.5            0              2.9994273    
   2000000   9000           100            100            0.033326998   -1.7184677e-15  0              0.099980994    2.3323693e-11  0              0.0011262177  -1.5            0              2.9994273    
   2100000   9000           100            100            0.033326976   -1.7184666e-15  0              0.099980928    3.5062503e-11  0              0.0016930428  -1.5            0              2.9994273    
   2200000   9000           100            100            0.033326968   -1.7184661e-15  0              0.099980904    5.2001502e-12  0              0.00025109664 -1.5            0              2.9994273    
   2300000   9000           100            100            0.033326969   -1.7184662e-15  0              0.099980906    1.2320458e-14  0              5.9491082e-07 -1.5            0              2.9994273    
   2400000   9000           100            100            0.03332697    -1.7184662e-15  0              0.099980909    1.034797e-13   0              4.9966642e-06 -1.5            0              2.9994273    
   2500000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     5.7810465e-15  0              2.7914605e-07 -1.5            0              2.9994273    
   2600000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     4.596397e-16   0              2.2194356e-08 -1.5            0              2.9994273    
   2700000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     2.8371586e-18  0              1.3699624e-10 -1.5            0              2.9994273    
   2800000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     3.1762313e-17  0              1.5336884e-09 -1.5            0              2.9994273    
   2900000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     3.2788683e-18  0              1.5832482e-10 -1.5            0              2.9994273    
   3000000   9000           100            100            0.03332697    -1.7184662e-15  0              0.09998091     9.5239393e-18  0              4.5987694e-10 -1.5            0              2.9994273    
Loop time of 655.013 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3957172.595 ns/day, 0.000 hours/ns, 4580.061 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 258.73     | 264.94     | 271.3      |  27.3 | 40.45
Neigh   | 1.6708     | 1.674      | 1.677      |   0.2 |  0.26
Comm    | 33.68      | 38.553     | 44.369     |  65.2 |  5.89
Output  | 0.43719    | 0.43739    | 0.43782    |   0.0 |  0.07
Modify  | 304.43     | 306.6      | 309.95     |  11.8 | 46.81
Other   |            | 42.8       |            |       |  6.53

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 120000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027730168    3.497677e-20   0              0.083190503    1816329.6      0              8.7704058e+13 -1.5            0              3.3104009    
    200000   9000           100            100            0.01118427     9.7054488e-21  0              0.033552811    542263.7       0              2.6183974e+13 -1.5            0              3.0419916    
    300000   9000           100            100            0.0035677924   3.433007e-21   0              0.010703377    89866.575      0              4.3393353e+12 -1.5            0              3.026021     
    400000   9000           100            100           -0.0015212473  -1.2636047e-21  0             -0.0045637419   34082.138      0              1.6457045e+12 -1.5            0              3.0013235    
    500000   9000           100            100            0.015624884   -7.4602774e-16  0              0.046874651    8313.7071      0              4.0143916e+11 -1.5            0              2.9996779    
    600000   9000           100            100            0.08764624    -4.5134366e-15  0              0.26293872     286.37944      0              1.3828238e+10 -1.5            0              2.9989406    
    700000   9000           100            100            0.015671184   -8.10857e-16    0              0.047013551    9.589422       0              4.6303887e+08 -1.5            0              2.9996629    
    800000   9000           100            100            0.036297032   -1.8754885e-15  0              0.10889109     20.029361      0              9.6714616e+08 -1.5            0              2.9994102    
    900000   9000           100            100            0.03583641    -1.8487507e-15  0              0.10750923     0.0045693975   0              220639.85     -1.5            0              2.9994157    
   1000000   9000           100            100            0.033848113   -1.7458474e-15  0              0.10154434     0.26172995     0              12638002      -1.5            0              2.9994376    
   1100000   9000           100            100            0.033219308   -1.7136299e-15  0              0.099657925    0.044459024    0              2146767.1     -1.5            0              2.9994445    
   1200000   9000           100            100            0.033217641   -1.713673e-15   0              0.099652922    0.00038915858  0              18791.075     -1.5            0              2.9994445    
   1300000   9000           100            100            0.033296794   -1.71778e-15    0              0.099890381    0.00035751597  0              17263.167     -1.5            0              2.9994436    
   1400000   9000           100            100            0.033328883   -1.7194286e-15  0              0.099986648    0.00010235384  0              4942.3007     -1.5            0              2.9994433    
   1500000   9000           100            100            0.03333171    -1.7195687e-15  0              0.099995129    2.7620403e-06  0              133.36904     -1.5            0              2.9994433    
   1600000   9000           100            100            0.033328762   -1.7194151e-15  0              0.099986285    3.835898e-07   0              18.522178     -1.5            0              2.9994433    
   1700000   9000           100            100            0.033327216   -1.7193356e-15  0              0.099981649    2.1217786e-07  0              10.245309     -1.5            0              2.9994433    
   1800000   9000           100            100            0.03332697    -1.7193231e-15  0              0.09998091     1.1326082e-08  0              0.54689596    -1.5            0              2.9994433    
   1900000   9000           100            100            0.033327068   -1.7193282e-15  0              0.099981203    2.5053381e-10  0              0.012097381   -1.5            0              2.9994433    
   2000000   9000           100            100            0.033327138   -1.7193319e-15  0              0.099981415    3.9646326e-10  0              0.019143792   -1.5            0              2.9994433    
   2100000   9000           100            100            0.033327154   -1.7193327e-15  0              0.099981463    3.5915207e-11  0              0.0017342168  -1.5            0              2.9994433    
   2200000   9000           100            100            0.033327152   -1.7193325e-15  0              0.099981455    1.5362765e-14  0              7.4181294e-07 -1.5            0              2.9994433    
   2300000   9000           100            100            0.033327149   -1.7193324e-15  0              0.099981446    6.5883112e-13  0              3.1812597e-05 -1.5            0              2.9994433    
   2400000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981443    9.6773215e-14  0              4.6728322e-06 -1.5            0              2.9994433    
   2500000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981443    5.4034957e-16  0              2.6091547e-08 -1.5            0              2.9994433    
   2600000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981444    7.6792576e-16  0              3.7080387e-08 -1.5            0              2.9994433    
   2700000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981444    3.411442e-17   0              1.6472632e-09 -1.5            0              2.9994433    
   2800000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981444    2.9046034e-18  0              1.402529e-10  -1.5            0              2.9994433    
   2900000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981444    8.7622935e-18  0              4.2309979e-10 -1.5            0              2.9994433    
   3000000   9000           100            100            0.033327148   -1.7193323e-15  0              0.099981444    2.139727e-17   0              1.0331976e-09 -1.5            0              2.9994433    
Loop time of 667.442 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3883481.240 ns/day, 0.000 hours/ns, 4494.770 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 261.85     | 272.38     | 284.03     |  59.0 | 40.81
Neigh   | 1.6484     | 1.6594     | 1.6705     |   0.8 |  0.25
Comm    | 32.236     | 43.437     | 54.447     | 158.6 |  6.51
Output  | 0.43458    | 0.43477    | 0.43512    |   0.0 |  0.07
Modify  | 302.77     | 304.84     | 307.88     |  11.0 | 45.67
Other   |            | 44.69      |            |       |  6.70

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 125000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02773823     3.4549411e-20  0              0.083214689    1817113.7      0              8.7741915e+13 -1.5            0              3.3102092    
    200000   9000           100            100            0.011200513    9.4979347e-21  0              0.033601539    543479.29      0              2.624267e+13  -1.5            0              3.0416561    
    300000   9000           100            100            0.0035933923   3.1629402e-21  0              0.010780177    90967.746      0              4.3925069e+12 -1.5            0              3.0257232    
    400000   9000           100            100           -0.0014891231  -1.0289156e-21  0             -0.0044673693   32367.708      0              1.5629208e+12 -1.5            0              3.0019246    
    500000   9000           100            100            0.07656018    -3.9552281e-15  0              0.22968054     7826.624       0              3.7791966e+11 -1.5            0              2.9990645    
    600000   9000           100            100            0.061115098   -3.1786242e-15  0              0.18334529     1139.8174      0              5.5037703e+10 -1.5            0              2.9991854    
    700000   9000           100            100            0.038669788   -2.0064098e-15  0              0.11600937     180.74767      0              8.7276582e+09 -1.5            0              2.9994004    
    800000   9000           100            100            0.026647521   -1.3761954e-15  0              0.079942564    1.9694751      0              95098902      -1.5            0              2.9995335    
    900000   9000           100            100            0.035882427   -1.8536418e-15  0              0.10764728     0.034170994    0              1649995       -1.5            0              2.9994309    
   1000000   9000           100            100            0.032420429   -1.674935e-15   0              0.097261286    2.9302685e-05  0              1414.9218     -1.5            0              2.9994681    
   1100000   9000           100            100            0.033651546   -1.7384327e-15  0              0.10095464     0.00028366659  0              13697.244     -1.5            0              2.9994547    
   1200000   9000           100            100            0.033212802   -1.7158209e-15  0              0.099638406    0.00015699728  0              7580.8366     -1.5            0              2.9994595    
   1300000   9000           100            100            0.033367564   -1.723791e-15   0              0.10010269     4.5845138e-05  0              2213.6977     -1.5            0              2.9994578    
   1400000   9000           100            100            0.033313273   -1.7209973e-15  0              0.09993982     1.036556e-05   0              500.51577     -1.5            0              2.9994584    
   1500000   9000           100            100            0.033332177   -1.7219693e-15  0              0.099996532    2.0403109e-06  0              98.519311     -1.5            0              2.9994582    
   1600000   9000           100            100            0.033325642   -1.7216335e-15  0              0.099976927    3.6737347e-07  0              17.73915      -1.5            0              2.9994583    
   1700000   9000           100            100            0.033327884   -1.7217486e-15  0              0.099983651    6.2144384e-08  0              3.0007299     -1.5            0              2.9994582    
   1800000   9000           100            100            0.033327122   -1.7217095e-15  0              0.099981365    1.0030681e-08  0              0.48434568    -1.5            0              2.9994583    
   1900000   9000           100            100            0.033327378   -1.7217227e-15  0              0.099982135    1.5602949e-09  0              0.075341057   -1.5            0              2.9994583    
   2000000   9000           100            100            0.033327293   -1.7217183e-15  0              0.099981878    2.3551957e-10  0              0.011372397   -1.5            0              2.9994583    
   2100000   9000           100            100            0.033327321   -1.7217197e-15  0              0.099981963    3.4647845e-11  0              0.0016730204  -1.5            0              2.9994583    
   2200000   9000           100            100            0.033327312   -1.7217192e-15  0              0.099981935    4.9874037e-12  0              0.00024082388 -1.5            0              2.9994583    
   2300000   9000           100            100            0.033327315   -1.7217194e-15  0              0.099981944    7.010833e-13   0              3.3852804e-05 -1.5            0              2.9994583    
   2400000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981941    9.780428e-14   0              4.7226187e-06 -1.5            0              2.9994583    
   2500000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    1.3357122e-14  0              6.4496762e-07 -1.5            0              2.9994583    
   2600000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    1.6408497e-15  0              7.9230759e-08 -1.5            0              2.9994583    
   2700000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    2.3959531e-19  0              1.15692e-11   -1.5            0              2.9994583    
   2800000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    1.222026e-17   0              5.9007262e-10 -1.5            0              2.9994583    
   2900000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    5.9985076e-18  0              2.8964646e-10 -1.5            0              2.9994583    
   3000000   9000           100            100            0.033327314   -1.7217194e-15  0              0.099981942    1.9076881e-17  0              9.2115432e-10 -1.5            0              2.9994583    
Loop time of 661.342 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3919302.020 ns/day, 0.000 hours/ns, 4536.229 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 267.7      | 273.49     | 279.01     |  24.9 | 41.35
Neigh   | 1.6479     | 1.6593     | 1.6707     |   0.8 |  0.25
Comm    | 36.133     | 40.043     | 45.561     |  61.7 |  6.05
Output  | 0.44185    | 0.44217    | 0.44296    |   0.1 |  0.07
Modify  | 301.79     | 304.18     | 305.49     |   8.5 | 45.99
Other   |            | 41.53      |            |       |  6.28

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 130000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027745854    3.4929071e-20  0              0.083237563    1817855.6      0              8.7777741e+13 -1.5            0              3.310027     
    200000   9000           100            100            0.011215905    9.9487832e-21  0              0.033647714    544632.06      0              2.6298333e+13 -1.5            0              3.0413371    
    300000   9000           100            100            0.003617688    3.6277938e-21  0              0.010853064    92017.29       0              4.4431856e+12 -1.5            0              3.0254382    
    400000   9000           100            100           -0.0014584382  -1.1894762e-21  0             -0.0043753147   30788.086      0              1.4866465e+12 -1.5            0              3.0024804    
    500000   9000           100            100            0.14965708    -7.7677658e-15  0              0.44897123     4238.6341      0              2.0466847e+11 -1.5            0              2.9985676    
    600000   9000           100            100            0.0017910838  -1.1284473e-16  0              0.0053732514   773.02527      0              3.7326624e+10 -1.5            0              2.9999176    
    700000   9000           100            100            0.050236392   -2.5837295e-15  0              0.15070918     74.747863      0              3.6093068e+09 -1.5            0              2.9993069    
    800000   9000           100            100            0.038231283   -1.9684666e-15  0              0.11469385     14.293852      0              6.9019898e+08 -1.5            0              2.999422     
    900000   9000           100            100            0.035877972   -1.8494648e-15  0              0.10763392     0.18986801     0              9168046.7     -1.5            0              2.9994457    
   1000000   9000           100            100            0.034166997   -1.7617546e-15  0              0.10250099     0.077080878    0              3721959.7     -1.5            0              2.9994634    
   1100000   9000           100            100            0.033462366   -1.7253844e-15  0              0.1003871      0.043661353    0              2108250.5     -1.5            0              2.9994708    
   1200000   9000           100            100            0.033294132   -1.7166237e-15  0              0.099882397    0.0061689116   0              297874.66     -1.5            0              2.9994726    
   1300000   9000           100            100            0.033292106   -1.716477e-15   0              0.099876318    0.00026047936  0              12577.616     -1.5            0              2.9994726    
   1400000   9000           100            100            0.033312461   -1.7175144e-15  0              0.099937382    1.5050134e-06  0              72.671712     -1.5            0              2.9994724    
   1500000   9000           100            100            0.033323807   -1.7180983e-15  0              0.09997142     7.4298984e-06  0              358.7632      -1.5            0              2.9994723    
   1600000   9000           100            100            0.033327389   -1.7182839e-15  0              0.099982166    1.7625226e-06  0              85.105907     -1.5            0              2.9994722    
   1700000   9000           100            100            0.033327892   -1.7183105e-15  0              0.099983677    1.4082471e-07  0              6.7999212     -1.5            0              2.9994722    
   1800000   9000           100            100            0.03332771    -1.7183013e-15  0              0.09998313     1.2283106e-09  0              0.059310722   -1.5            0              2.9994722    
   1900000   9000           100            100            0.033327546   -1.7182929e-15  0              0.099982639    8.2724358e-10  0              0.039944632   -1.5            0              2.9994722    
   2000000   9000           100            100            0.033327481   -1.7182895e-15  0              0.099982442    4.0507231e-10  0              0.019559492   -1.5            0              2.9994722    
   2100000   9000           100            100            0.033327466   -1.7182887e-15  0              0.099982397    5.3108546e-11  0              0.0025644216  -1.5            0              2.9994722    
   2200000   9000           100            100            0.033327466   -1.7182888e-15  0              0.099982398    1.972233e-12   0              9.5232074e-05 -1.5            0              2.9994722    
   2300000   9000           100            100            0.033327468   -1.7182889e-15  0              0.099982404    2.7518273e-14  0              1.3287589e-06 -1.5            0              2.9994722    
   2400000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982407    7.30569e-14    0              3.5276563e-06 -1.5            0              2.9994722    
   2500000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    1.5766025e-14  0              7.6128494e-07 -1.5            0              2.9994722    
   2600000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    9.5701372e-16  0              4.6210768e-08 -1.5            0              2.9994722    
   2700000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    1.7458311e-16  0              8.4299936e-09 -1.5            0              2.9994722    
   2800000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    3.6241285e-19  0              1.749962e-11  -1.5            0              2.9994722    
   2900000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    5.7006983e-18  0              2.7526632e-10 -1.5            0              2.9994722    
   3000000   9000           100            100            0.033327469   -1.7182889e-15  0              0.099982408    4.1877025e-19  0              2.0220917e-11 -1.5            0              2.9994722    
Loop time of 666.019 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3891780.058 ns/day, 0.000 hours/ns, 4504.375 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 260.15     | 272.5      | 282.06     |  52.2 | 40.92
Neigh   | 1.6501     | 1.6608     | 1.6715     |   0.8 |  0.25
Comm    | 33.722     | 42.895     | 54.966     | 137.2 |  6.44
Output  | 0.43462    | 0.43489    | 0.43552    |   0.1 |  0.07
Modify  | 302.27     | 304.76     | 307.41     |  10.6 | 45.76
Other   |            | 43.76      |            |       |  6.57

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 135000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027753079    3.4828595e-20  0              0.083259238    1818558.9      0              8.7811699e+13 -1.5            0              3.3098541    
    200000   9000           100            100            0.01123052     9.6388321e-21  0              0.033691559    545727.47      0              2.6351226e+13 -1.5            0              3.0410332    
    300000   9000           100            100            0.0036407732   3.6277496e-21  0              0.01092232     93018.549      0              4.4915328e+12 -1.5            0              3.0251655    
    400000   9000           100            100           -0.0014290951  -1.1310248e-21  0             -0.0042872852   29328.899      0              1.4161876e+12 -1.5            0              3.0029956    
    500000   9000           100            100            0.19991721    -1.0347356e-14  0              0.59975164     586.86904      0              2.8337806e+10 -1.5            0              2.9983019    
    600000   9000           100            100            4.4081858e-06 -7.317495e-21   0              1.3224557e-05  0.27920149     0              13481641      -1.5            0              3.0001936    
    700000   9000           100            100            0.01592524    -8.1737366e-16  0              0.04777572     36.989351      0              1.7860834e+09 -1.5            0              2.9996862    
    800000   9000           100            100            0.037887276   -1.9562616e-15  0              0.11366183     16.263012      0              7.8528267e+08 -1.5            0              2.999439     
    900000   9000           100            100            0.0348251     -1.7946097e-15  0              0.1044753      2.262015       0              1.0922461e+08 -1.5            0              2.9994702    
   1000000   9000           100            100            0.032456169   -1.6733467e-15  0              0.097368506    0.063593944    0              3070724       -1.5            0              2.9994944    
   1100000   9000           100            100            0.033252712   -1.7147339e-15  0              0.099758137    0.050887057    0              2457153.9     -1.5            0              2.9994861    
   1200000   9000           100            100            0.033448831   -1.7246927e-15  0              0.10034649     8.9422325e-06  0              431.7884      -1.5            0              2.9994841    
   1300000   9000           100            100            0.033321478   -1.7181057e-15  0              0.099964434    0.000851169    0              41099.905     -1.5            0              2.9994854    
   1400000   9000           100            100            0.033312947   -1.717688e-15   0              0.099938842    1.1441794e-05  0              552.48331     -1.5            0              2.9994855    
   1500000   9000           100            100            0.03333029    -1.718582e-15   0              0.099990869    1.079793e-05   0              521.39341     -1.5            0              2.9994853    
   1600000   9000           100            100            0.033329141   -1.71852e-15    0              0.099987424    7.3189506e-07  0              35.340593     -1.5            0              2.9994853    
   1700000   9000           100            100            0.033327077   -1.7184139e-15  0              0.099981231    9.5408257e-08  0              4.6069233     -1.5            0              2.9994854    
   1800000   9000           100            100            0.03332749    -1.7184355e-15  0              0.099982469    2.2200235e-08  0              1.0719699     -1.5            0              2.9994854    
   1900000   9000           100            100            0.0333277     -1.7184462e-15  0              0.099983099    4.0761617e-10  0              0.019682326   -1.5            0              2.9994853    
   2000000   9000           100            100            0.03332762    -1.7184421e-15  0              0.09998286     4.6714895e-10  0              0.022556951   -1.5            0              2.9994853    
   2100000   9000           100            100            0.033327604   -1.7184413e-15  0              0.099982811    4.5140405e-14  0              2.1796686e-06 -1.5            0              2.9994853    
   2200000   9000           100            100            0.033327616   -1.7184419e-15  0              0.099982848    7.4589235e-12  0              0.00036016472 -1.5            0              2.9994853    
   2300000   9000           100            100            0.033327616   -1.7184419e-15  0              0.099982849    1.4328097e-13  0              6.9185251e-06 -1.5            0              2.9994853    
   2400000   9000           100            100            0.033327615   -1.7184418e-15  0              0.099982844    8.9878704e-14  0              4.339921e-06  -1.5            0              2.9994853    
   2500000   9000           100            100            0.033327615   -1.7184419e-15  0              0.099982845    7.5622001e-15  0              3.6515158e-07 -1.5            0              2.9994853    
   2600000   9000           100            100            0.033327615   -1.7184419e-15  0              0.099982845    8.5803462e-16  0              4.1431421e-08 -1.5            0              2.9994853    
   2700000   9000           100            100            0.033327615   -1.7184419e-15  0              0.099982845    1.2486346e-18  0              6.0292098e-11 -1.5            0              2.9994853    
   2800000   9000           100            100            0.033327615   -1.7184419e-15  0              0.099982845    3.6005509e-19  0              1.7385771e-11 -1.5            0              2.9994853    
   2900000   9000           100            100            0.033327615   -1.7184419e-15  0              0.099982845    1.4170243e-18  0              6.8423031e-11 -1.5            0              2.9994853    
   3000000   9000           100            100            0.033327615   -1.7184418e-15  0              0.099982845    2.3603226e-18  0              1.1397153e-10 -1.5            0              2.9994853    
Loop time of 658.534 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3936017.888 ns/day, 0.000 hours/ns, 4555.576 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 260.92     | 266.8      | 273.01     |  27.6 | 40.51
Neigh   | 1.6404     | 1.6533     | 1.6657     |   1.0 |  0.25
Comm    | 34.695     | 39.439     | 45.215     |  69.9 |  5.99
Output  | 0.43292    | 0.43301    | 0.43318    |   0.0 |  0.07
Modify  | 304.54     | 306.79     | 307.99     |   7.8 | 46.59
Other   |            | 43.42      |            |       |  6.59

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 140000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027759939    3.4639874e-20  0              0.083279816    1819226.6      0              8.7843944e+13 -1.5            0              3.3096897    
    200000   9000           100            100            0.011244389    9.2041513e-21  0              0.033733166    546767.57      0              2.6401449e+13 -1.5            0              3.0407445    
    300000   9000           100            100            0.0036627299   3.2239545e-21  0              0.01098819     93974.473      0              4.537691e+12  -1.5            0              3.0249045    
    400000   9000           100            100           -0.0014010007  -1.2348616e-21  0             -0.004203002    27977.506      0              1.3509337e+12 -1.5            0              3.0034745    
    500000   9000           100            100            0.2032712     -1.0613926e-14  0              0.60981361     523.1036       0              2.5258801e+10 -1.5            0              2.9983215    
    600000   9000           100            100            0.00084301714 -2.9110582e-17  0              0.0025290514   728.15266      0              3.5159886e+10 -1.5            0              2.9999664    
    700000   9000           100            100            0.0352471     -1.8281263e-15  0              0.1057413      201.92003      0              9.7499956e+09 -1.5            0              2.9994772    
    800000   9000           100            100            0.027881743   -1.4410516e-15  0              0.083645229    12.251106      0              5.9156206e+08 -1.5            0              2.9995536    
    900000   9000           100            100            0.032046388   -1.6523577e-15  0              0.096139164    2.5763338      0              1.2440194e+08 -1.5            0              2.9995108    
   1000000   9000           100            100            0.034296986   -1.7694512e-15  0              0.10289096     0.003848314    0              185821.31     -1.5            0              2.999488     
   1100000   9000           100            100            0.033219411   -1.714084e-15   0              0.099658233    0.049159594    0              2373740.8     -1.5            0              2.9994987    
   1200000   9000           100            100            0.033235203   -1.7147096e-15  0              0.09970561     0.0030417147   0              146873.52     -1.5            0              2.9994986    
   1300000   9000           100            100            0.033367929   -1.7215821e-15  0              0.10010379     0.00015855236  0              7655.9258     -1.5            0              2.9994973    
   1400000   9000           100            100            0.033328113   -1.719545e-15   0              0.099984339    0.00011307607  0              5460.0387     -1.5            0              2.9994977    
   1500000   9000           100            100            0.03332252    -1.7192483e-15  0              0.099967559    2.0301346e-06  0              98.027932     -1.5            0              2.9994977    
   1600000   9000           100            100            0.033329198   -1.719593e-15   0              0.099987593    9.0510907e-07  0              43.704478     -1.5            0              2.9994977    
   1700000   9000           100            100            0.033328008   -1.7195326e-15  0              0.099984023    2.0540496e-07  0              9.9182702     -1.5            0              2.9994977    
   1800000   9000           100            100            0.033327494   -1.7195058e-15  0              0.099982483    6.0386497e-11  0              0.0029158478  -1.5            0              2.9994977    
   1900000   9000           100            100            0.033327793   -1.7195212e-15  0              0.099983378    3.0966997e-09  0              0.14952855    -1.5            0              2.9994977    
   2000000   9000           100            100            0.033327773   -1.7195202e-15  0              0.09998332     2.8435766e-10  0              0.013730614   -1.5            0              2.9994977    
   2100000   9000           100            100            0.033327741   -1.7195185e-15  0              0.099983222    5.2694625e-12  0              0.00025444349 -1.5            0              2.9994977    
   2200000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983257    7.8759671e-12  0              0.00038030226 -1.5            0              2.9994977    
   2300000   9000           100            100            0.033327753   -1.7195192e-15  0              0.09998326     2.5780734e-13  0              1.2448594e-05 -1.5            0              2.9994977    
   2400000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983255    4.5092451e-14  0              2.1773531e-06 -1.5            0              2.9994977    
   2500000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    1.5786881e-14  0              7.6229197e-07 -1.5            0              2.9994977    
   2600000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    1.2445675e-16  0              6.0095709e-09 -1.5            0              2.9994977    
   2700000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    3.8539575e-20  0              1.8609382e-12 -1.5            0              2.9994977    
   2800000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    6.3906459e-19  0              3.0858142e-11 -1.5            0              2.9994977    
   2900000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    6.0110027e-19  0              2.9024981e-11 -1.5            0              2.9994977    
   3000000   9000           100            100            0.033327752   -1.7195191e-15  0              0.099983256    7.2756526e-18  0              3.5131523e-10 -1.5            0              2.9994977    
Loop time of 661.235 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3919934.934 ns/day, 0.000 hours/ns, 4536.962 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 262.55     | 269.49     | 281.66     |  46.3 | 40.76
Neigh   | 1.611      | 1.6232     | 1.6358     |   1.0 |  0.25
Comm    | 33.365     | 42.097     | 50.194     | 124.1 |  6.37
Output  | 0.4376     | 0.4378     | 0.43819    |   0.0 |  0.07
Modify  | 301.02     | 305        | 311.26     |  21.8 | 46.13
Other   |            | 42.59      |            |       |  6.44

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 145000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027766463    3.4677175e-20  0              0.083299388    1819861.9      0              8.7874618e+13 -1.5            0              3.3095331    
    200000   9000           100            100            0.011257604    1.0401732e-20  0              0.033772813    547759.37      0              2.644934e+13  -1.5            0              3.0404686    
    300000   9000           100            100            0.0036836641   3.5070243e-21  0              0.011050992    94889.148      0              4.5818574e+12 -1.5            0              3.024654     
    400000   9000           100            100           -0.0013740626  -1.0705972e-21  0             -0.0041221879   26722.58       0              1.2903377e+12 -1.5            0              3.0039208    
    500000   9000           100            100            0.16016531    -8.362659e-15   0              0.48049593     3953.0128      0              1.9087684e+11 -1.5            0              2.9985988    
    600000   9000           100            100            0.046716632   -2.4002123e-15  0              0.1401499      1471.4713      0              7.1052083e+10 -1.5            0              2.9993888    
    700000   9000           100            100            0.044969075   -2.3102306e-15  0              0.13490723     151.30277      0              7.3058694e+09 -1.5            0              2.9994019    
    800000   9000           100            100            0.026494918   -1.3651033e-15  0              0.079484753    4.7484247      0              2.2928444e+08 -1.5            0              2.9995791    
    900000   9000           100            100            0.03073603    -1.5856416e-15  0              0.092208091    0.37289141     0              18005592      -1.5            0              2.999535     
   1000000   9000           100            100            0.032801108   -1.6920753e-15  0              0.098403325    0.31105485     0              15019725      -1.5            0              2.9995144    
   1100000   9000           100            100            0.033362372   -1.7207902e-15  0              0.10008712     0.054737371    0              2643071.7     -1.5            0              2.9995089    
   1200000   9000           100            100            0.033414557   -1.7233622e-15  0              0.10024367     0.003724378    0              179836.89     -1.5            0              2.9995084    
   1300000   9000           100            100            0.033372513   -1.7211561e-15  0              0.10011754     2.1808664e-05  0              1053.0623     -1.5            0              2.9995089    
   1400000   9000           100            100            0.033342084   -1.7195806e-15  0              0.10002625     2.6523454e-05  0              1280.7227     -1.5            0              2.9995092    
   1500000   9000           100            100            0.033330224   -1.7189702e-15  0              0.099990672    1.2345198e-05  0              596.10544     -1.5            0              2.9995093    
   1600000   9000           100            100            0.033327394   -1.7188258e-15  0              0.099982181    1.774735e-06   0              85.695601     -1.5            0              2.9995093    
   1700000   9000           100            100            0.033327306   -1.718822e-15   0              0.099981917    9.3442602e-08  0              4.5120088     -1.5            0              2.9995093    
   1800000   9000           100            100            0.033327617   -1.7188383e-15  0              0.099982852    8.6392369e-12  0              0.00041715783 -1.5            0              2.9995093    
   1900000   9000           100            100            0.033327805   -1.718848e-15   0              0.099983416    1.3979776e-09  0              0.067503335   -1.5            0              2.9995093    
   2000000   9000           100            100            0.033327872   -1.7188514e-15  0              0.099983615    4.6455197e-10  0              0.022431552   -1.5            0              2.9995093    
   2100000   9000           100            100            0.033327885   -1.7188521e-15  0              0.099983656    5.5213308e-11  0              0.0026660531  -1.5            0              2.9995093    
   2200000   9000           100            100            0.033327885   -1.7188521e-15  0              0.099983654    2.1240146e-12  0              0.00010256107 -1.5            0              2.9995093    
   2300000   9000           100            100            0.033327883   -1.7188519e-15  0              0.099983648    1.5855457e-14  0              7.656033e-07  -1.5            0              2.9995093    
   2400000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983644    6.6115421e-14  0              3.1924771e-06 -1.5            0              2.9995093    
   2500000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    1.666153e-14   0              8.0452567e-07 -1.5            0              2.9995093    
   2600000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    1.651154e-15   0              7.9728317e-08 -1.5            0              2.9995093    
   2700000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    2.4941189e-16  0              1.2043208e-08 -1.5            0              2.9995093    
   2800000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    3.4412115e-17  0              1.6616379e-09 -1.5            0              2.9995093    
   2900000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    4.4261066e-19  0              2.1372084e-11 -1.5            0              2.9995093    
   3000000   9000           100            100            0.033327881   -1.7188519e-15  0              0.099983643    2.1230692e-19  0              1.0251541e-11 -1.5            0              2.9995093    
Loop time of 652.092 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3974896.248 ns/day, 0.000 hours/ns, 4600.574 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 260.48     | 263.45     | 268.86     |  19.8 | 40.40
Neigh   | 1.6093     | 1.6225     | 1.6358     |   1.0 |  0.25
Comm    | 34.129     | 38.14      | 42.215     |  54.0 |  5.85
Output  | 0.43492    | 0.43519    | 0.43585    |   0.1 |  0.07
Modify  | 304.23     | 305.88     | 308.97     |  10.4 | 46.91
Other   |            | 42.56      |            |       |  6.53

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 150000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02777268     3.4830116e-20  0              0.08331804     1820467.6      0              8.7903864e+13 -1.5            0              3.3093834    
    200000   9000           100            100            0.011270227    9.1891332e-21  0              0.03381068     548707.21      0              2.6495107e+13 -1.5            0              3.0402043    
    300000   9000           100            100            0.0037036849   3.4769461e-21  0              0.011111055    95766.885      0              4.6242402e+12 -1.5            0              3.0244128    
    400000   9000           100            100           -0.0013481726  -1.1303306e-21  0             -0.0040445177   25553.192      0              1.2338722e+12 -1.5            0              3.004338     
    500000   9000           100            100            0.092731916   -4.9159245e-15  0              0.27819575     7560.0003      0              3.6504536e+11 -1.5            0              2.9990453    
    600000   9000           100            100            0.10133129    -5.2497717e-15  0              0.30399386     41.544115      0              2.0060166e+09 -1.5            0              2.9989935    
    700000   9000           100            100            0.014102283   -7.300325e-16   0              0.042306849    20.319724      0              9.8116677e+08 -1.5            0              2.9997291    
    800000   9000           100            100            0.032106042   -1.6517872e-15  0              0.096318127    26.209006      0              1.2655391e+09 -1.5            0              2.9995326    
    900000   9000           100            100            0.034678967   -1.7890575e-15  0              0.1040369      2.6481302      0              1.2786873e+08 -1.5            0              2.9995072    
   1000000   9000           100            100            0.032634485   -1.6822182e-15  0              0.097903454    0.22950077     0              11081771      -1.5            0              2.999527     
   1100000   9000           100            100            0.033630729   -1.7339903e-15  0              0.10089219     0.01653649     0              798487.93     -1.5            0              2.9995173    
   1200000   9000           100            100            0.03320648    -1.7120129e-15  0              0.099619441    0.00078716101  0              38009.188     -1.5            0              2.9995214    
   1300000   9000           100            100            0.03337387    -1.7206631e-15  0              0.10012161     9.6290454e-06  0              464.95214     -1.5            0              2.9995198    
   1400000   9000           100            100            0.033311651   -1.7174547e-15  0              0.099934954    2.0451935e-06  0              98.755076     -1.5            0              2.9995204    
   1500000   9000           100            100            0.033333513   -1.7185797e-15  0              0.10000054     1.935799e-06   0              93.472805     -1.5            0              2.9995202    
   1600000   9000           100            100            0.033326262   -1.7182074e-15  0              0.099978785    6.1586428e-07  0              29.737882     -1.5            0              2.9995203    
   1700000   9000           100            100            0.033328509   -1.7183225e-15  0              0.099985528    1.3536448e-07  0              6.5362662     -1.5            0              2.9995203    
   1800000   9000           100            100            0.033327873   -1.7182901e-15  0              0.099983619    2.4194707e-08  0              1.1682758     -1.5            0              2.9995203    
   1900000   9000           100            100            0.033328028   -1.7182979e-15  0              0.099984085    3.7384746e-09  0              0.18051756    -1.5            0              2.9995203    
   2000000   9000           100            100            0.033328002   -1.7182966e-15  0              0.099984005    5.1247923e-10  0              0.024745788   -1.5            0              2.9995203    
   2100000   9000           100            100            0.033328      -1.7182965e-15  0              0.099984001    6.2844032e-11  0              0.0030345134  -1.5            0              2.9995203    
   2200000   9000           100            100            0.033328005   -1.7182967e-15  0              0.099984014    6.8666661e-12  0              0.00033156673 -1.5            0              2.9995203    
   2300000   9000           100            100            0.033328002   -1.7182966e-15  0              0.099984006    6.5378239e-13  0              3.1568812e-05 -1.5            0              2.9995203    
   2400000   9000           100            100            0.033328003   -1.7182967e-15  0              0.09998401     5.1532948e-14  0              2.4883416e-06 -1.5            0              2.9995203    
   2500000   9000           100            100            0.033328003   -1.7182966e-15  0              0.099984008    2.9201925e-15  0              1.4100564e-07 -1.5            0              2.9995203    
   2600000   9000           100            100            0.033328003   -1.7182966e-15  0              0.099984009    4.4766264e-17  0              2.1616027e-09 -1.5            0              2.9995203    
   2700000   9000           100            100            0.033328003   -1.7182966e-15  0              0.099984009    7.5264378e-17  0              3.6342474e-09 -1.5            0              2.9995203    
   2800000   9000           100            100            0.033328003   -1.7182966e-15  0              0.099984009    3.5340689e-17  0              1.7064754e-09 -1.5            0              2.9995203    
   2900000   9000           100            100            0.033328003   -1.7182966e-15  0              0.099984009    5.0101112e-18  0              2.4192034e-10 -1.5            0              2.9995203    
   3000000   9000           100            100            0.033328003   -1.7182967e-15  0              0.099984009    3.6198271e-18  0              1.7478849e-10 -1.5            0              2.9995203    
Loop time of 654.245 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3961815.568 ns/day, 0.000 hours/ns, 4585.435 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 262.51     | 266.09     | 271.89     |  23.2 | 40.67
Neigh   | 1.6622     | 1.6775     | 1.6923     |   1.1 |  0.26
Comm    | 34.355     | 39         | 43.24      |  63.6 |  5.96
Output  | 0.43422    | 0.43452    | 0.43529    |   0.1 |  0.07
Modify  | 303.92     | 305.26     | 307.93     |   9.0 | 46.66
Other   |            | 41.78      |            |       |  6.39

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 155000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027778616    3.4996011e-20  0              0.083335849    1821046.2      0              8.7931806e+13 -1.5            0              3.3092397    
    200000   9000           100            100            0.0112823      9.8181924e-21  0              0.033846901    549614.42      0              2.6538913e+13 -1.5            0              3.0399508    
    300000   9000           100            100            0.0037228436   3.4027937e-21  0              0.011168531    96609.545      0              4.6649292e+12 -1.5            0              3.0241807    
    400000   9000           100            100           -0.0013232929  -1.0516207e-21  0             -0.0039698786   24462.532      0              1.1812081e+12 -1.5            0              3.0047284    
    500000   9000           100            100            0.029990652   -1.6173596e-15  0              0.089971955    8789.0369      0              4.2439114e+11 -1.5            0              2.9995542    
    600000   9000           100            100            0.068256767   -3.5712337e-15  0              0.2047703      1133.9563      0              5.4754693e+10 -1.5            0              2.9992406    
    700000   9000           100            100            0.056918312   -2.9362352e-15  0              0.17075493     4.6329314      0              2.2370768e+08 -1.5            0              2.9993292    
    800000   9000           100            100            0.038060926   -1.9596464e-15  0              0.11418278     18.154269      0              8.7660469e+08 -1.5            0              2.9994876    
    900000   9000           100            100            0.034945559   -1.8009535e-15  0              0.10483668     2.405455       0              1.1615081e+08 -1.5            0              2.9995157    
   1000000   9000           100            100            0.033982911   -1.7520434e-15  0              0.10194873     0.26736012     0              12909864      -1.5            0              2.9995246    
   1100000   9000           100            100            0.033591132   -1.7320869e-15  0              0.1007734      0.02810188     0              1356939.2     -1.5            0              2.9995282    
   1200000   9000           100            100            0.033431535   -1.7239383e-15  0              0.1002946      0.0028109162   0              135729.08     -1.5            0              2.9995297    
   1300000   9000           100            100            0.033368021   -1.7206893e-15  0              0.10010406     0.00026444149  0              12768.933     -1.5            0              2.9995303    
   1400000   9000           100            100            0.033343266   -1.719421e-15   0              0.1000298      2.2877314e-05  0              1104.6636     -1.5            0              2.9995305    
   1500000   9000           100            100            0.033333786   -1.7189347e-15  0              0.10000136     1.7459006e-06  0              84.303291     -1.5            0              2.9995306    
   1600000   9000           100            100            0.033330211   -1.7187511e-15  0              0.099990634    1.0746395e-07  0              5.1890498     -1.5            0              2.9995306    
   1700000   9000           100            100            0.033328882   -1.7186827e-15  0              0.099986645    4.1089536e-09  0              0.19840667    -1.5            0              2.9995306    
   1800000   9000           100            100            0.033328393   -1.7186576e-15  0              0.09998518     1.3319121e-11  0              0.00064313269 -1.5            0              2.9995306    
   1900000   9000           100            100            0.033328216   -1.7186485e-15  0              0.099984649    3.1403606e-11  0              0.0015163677  -1.5            0              2.9995306    
   2000000   9000           100            100            0.033328153   -1.7186452e-15  0              0.099984458    1.9823947e-11  0              0.00095722743 -1.5            0              2.9995306    
   2100000   9000           100            100            0.03332813    -1.718644e-15   0              0.09998439     5.9921425e-12  0              0.00028933912 -1.5            0              2.9995306    
   2200000   9000           100            100            0.033328122   -1.7186436e-15  0              0.099984367    1.3737361e-12  0              6.63328e-05   -1.5            0              2.9995306    
   2300000   9000           100            100            0.03332812    -1.7186435e-15  0              0.099984359    2.7019755e-13  0              1.3046873e-05 -1.5            0              2.9995306    
   2400000   9000           100            100            0.033328119   -1.7186434e-15  0              0.099984356    4.8187914e-14  0              2.3268219e-06 -1.5            0              2.9995306    
   2500000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984355    7.9931767e-15  0              3.859619e-07  -1.5            0              2.9995306    
   2600000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984355    1.163147e-15   0              5.6164204e-08 -1.5            0              2.9995306    
   2700000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984354    2.8883497e-16  0              1.3946807e-08 -1.5            0              2.9995306    
   2800000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984354    5.9695347e-22  0              2.8824747e-14 -1.5            0              2.9995306    
   2900000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984354    5.2616504e-19  0              2.5406627e-11 -1.5            0              2.9995306    
   3000000   9000           100            100            0.033328118   -1.7186434e-15  0              0.099984354    6.9637682e-18  0              3.3625544e-10 -1.5            0              2.9995306    
Loop time of 667.148 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3885197.719 ns/day, 0.000 hours/ns, 4496.757 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 276.4      | 279.99     | 283.01     |  14.3 | 41.97
Neigh   | 1.6567     | 1.6672     | 1.6782     |   0.8 |  0.25
Comm    | 34.991     | 37.741     | 41.137     |  41.1 |  5.66
Output  | 0.43693    | 0.43707    | 0.43737    |   0.0 |  0.07
Modify  | 302.95     | 304.56     | 306.35     |   7.0 | 45.65
Other   |            | 42.75      |            |       |  6.41

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 160000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027784287    3.5153308e-20  0              0.08335286     1821598.8      0              8.7958486e+13 -1.5            0              3.309103     
    200000   9000           100            100            0.011293825    9.3662483e-21  0              0.033881475    550480.79      0              2.6580747e+13 -1.5            0              3.0397087    
    300000   9000           100            100            0.0037411669   3.5094072e-21  0              0.011223501    97417.923      0              4.7039629e+12 -1.5            0              3.0239576    
    400000   9000           100            100           -0.0012993563  -8.221571e-22   0             -0.003898069    23443.131      0              1.1319849e+12 -1.5            0              3.0050945    
    500000   9000           100            100           -0.00079328184 -3.4359072e-21  0             -0.0023798455   7854.3477      0              3.7925834e+11 -1.5            0              3.0000421    
    600000   9000           100            100            0.0091154975  -4.9217247e-16  0              0.027346493    1282.1009      0              6.1908066e+10 -1.5            0              2.9998016    
    700000   9000           100            100            0.014517688   -7.4471956e-16  0              0.043553063    41.1956        0              1.9891881e+09 -1.5            0              2.9997367    
    800000   9000           100            100            0.041119766   -2.1190029e-15  0              0.1233593      3.7364942      0              1.8042193e+08 -1.5            0              2.9994715    
    900000   9000           100            100            0.030460528   -1.5710389e-15  0              0.091381583    0.070860576    0              3421603.6     -1.5            0              2.9995672    
   1000000   9000           100            100            0.034353259   -1.7716426e-15  0              0.10305978     0.020528785    0              991261.54     -1.5            0              2.9995311    
   1100000   9000           100            100            0.033017654   -1.7025962e-15  0              0.099052962    0.017814373    0              860192.3      -1.5            0              2.9995433    
   1200000   9000           100            100            0.033404139   -1.7226618e-15  0              0.10021242     0.0050162101   0              242214.84     -1.5            0              2.9995398    
   1300000   9000           100            100            0.033317485   -1.7181248e-15  0              0.099952454    0.0009008751   0              43500.035     -1.5            0              2.9995406    
   1400000   9000           100            100            0.033325649   -1.718574e-15   0              0.099976948    0.00011895858  0              5744.0843     -1.5            0              2.9995405    
   1500000   9000           100            100            0.033331316   -1.7188562e-15  0              0.099993949    1.1659481e-05  0              562.99459     -1.5            0              2.9995404    
   1600000   9000           100            100            0.033326502   -1.718611e-15   0              0.099979506    7.6681684e-07  0              37.026841     -1.5            0              2.9995405    
   1700000   9000           100            100            0.03332898    -1.718738e-15   0              0.099986939    2.1182812e-08  0              1.0228422     -1.5            0              2.9995405    
   1800000   9000           100            100            0.033327948   -1.7186849e-15  0              0.099983843    2.3264226e-10  0              0.011233462   -1.5            0              2.9995405    
   1900000   9000           100            100            0.033328317   -1.718704e-15   0              0.099984952    8.281265e-10   0              0.039987265   -1.5            0              2.9995405    
   2000000   9000           100            100            0.033328203   -1.7186981e-15  0              0.09998461     2.9565766e-10  0              0.01427625    -1.5            0              2.9995405    
   2100000   9000           100            100            0.033328232   -1.7186996e-15  0              0.099984695    6.0155e-11     0              0.0029046697  -1.5            0              2.9995405    
   2200000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    8.7573828e-12  0              0.00042286268 -1.5            0              2.9995405    
   2300000   9000           100            100            0.033328227   -1.7186993e-15  0              0.09998468     9.541227e-13   0              4.607117e-05  -1.5            0              2.9995405    
   2400000   9000           100            100            0.033328228   -1.7186994e-15  0              0.099984683    7.3526641e-14  0              3.5503384e-06 -1.5            0              2.9995405    
   2500000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984681    3.1919733e-15  0              1.5412897e-07 -1.5            0              2.9995405    
   2600000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    2.4386907e-17  0              1.1775565e-09 -1.5            0              2.9995405    
   2700000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    1.1947932e-16  0              5.769229e-09  -1.5            0              2.9995405    
   2800000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    1.7374777e-17  0              8.3896581e-10 -1.5            0              2.9995405    
   2900000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    8.1753041e-18  0              3.9475617e-10 -1.5            0              2.9995405    
   3000000   9000           100            100            0.033328227   -1.7186993e-15  0              0.099984682    4.8259047e-18  0              2.3302567e-10 -1.5            0              2.9995405    
Loop time of 654.527 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3960110.119 ns/day, 0.000 hours/ns, 4583.461 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 261.82     | 266.3      | 271.5      |  21.2 | 40.69
Neigh   | 1.6385     | 1.6516     | 1.6647     |   1.0 |  0.25
Comm    | 35.544     | 38.843     | 43.42      |  47.8 |  5.93
Output  | 0.43224    | 0.43241    | 0.4329     |   0.0 |  0.07
Modify  | 303.03     | 305.68     | 308.29     |  10.8 | 46.70
Other   |            | 41.62      |            |       |  6.36

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 165000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027789717    3.4934354e-20  0              0.083369151    1822128.3      0              8.7984054e+13 -1.5            0              3.3089713    
    200000   9000           100            100            0.011304896    9.8460214e-21  0              0.033914688    551313.59      0              2.662096e+13  -1.5            0              3.0394751    
    300000   9000           100            100            0.003758776    3.1371943e-21  0              0.011276328    98197.071      0              4.7415851e+12 -1.5            0              3.023742     
    400000   9000           100            100           -0.0012762761  -1.2002272e-21  0             -0.0038288283   22487.379      0              1.085835e+12  -1.5            0              3.0054388    
    500000   9000           100            100           -0.0007314757  -3.4104845e-21  0             -0.0021944271   6593.8012      0              3.1839106e+11 -1.5            0              3.0004749    
    600000   9000           100            100           -0.00015333224 -6.364194e-21   0             -0.00045999673  259.27547      0              1.2519485e+10 -1.5            0              3.0001755    
    700000   9000           100            100            0.050685014   -2.6242891e-15  0              0.15205504     106.17284      0              5.1267065e+09 -1.5            0              2.9994038    
    800000   9000           100            100            0.041855645   -2.1615683e-15  0              0.12556694     0.0010710282   0              51716.119     -1.5            0              2.9994759    
    900000   9000           100            100            0.036058501   -1.8630834e-15  0              0.1081755      0.60965717     0              29438163      -1.5            0              2.9995255    
   1000000   9000           100            100            0.033920769   -1.7526594e-15  0              0.10176231     0.31634443     0              15275140      -1.5            0              2.9995444    
   1100000   9000           100            100            0.033335094   -1.7222257e-15  0              0.10000528     0.058811308    0              2839787.6     -1.5            0              2.9995497    
   1200000   9000           100            100            0.03325634    -1.7180466e-15  0              0.09976902     0.0054547668   0              263391.17     -1.5            0              2.9995504    
   1300000   9000           100            100            0.033284179   -1.7194407e-15  0              0.099852536    0.00017695766  0              8544.6522     -1.5            0              2.9995502    
   1400000   9000           100            100            0.033311031   -1.7208157e-15  0              0.099933094    2.1669896e-06  0              104.63617     -1.5            0              2.9995499    
   1500000   9000           100            100            0.033323597   -1.7214631e-15  0              0.099970792    6.6975777e-06  0              323.40206     -1.5            0              2.9995498    
   1600000   9000           100            100            0.033327704   -1.7216758e-15  0              0.099983113    1.8647542e-06  0              90.042307     -1.5            0              2.9995498    
   1700000   9000           100            100            0.033328561   -1.7217206e-15  0              0.099985683    2.3869683e-07  0              11.525815     -1.5            0              2.9995498    
   1800000   9000           100            100            0.033328549   -1.7217202e-15  0              0.099985648    1.4039695e-08  0              0.67792661    -1.5            0              2.9995498    
   1900000   9000           100            100            0.033328433   -1.7217143e-15  0              0.099985298    7.3657291e-11  0              0.003556647   -1.5            0              2.9995498    
   2000000   9000           100            100            0.033328364   -1.7217108e-15  0              0.099985092    1.0046559e-10  0              0.0048511236  -1.5            0              2.9995498    
   2100000   9000           100            100            0.033328338   -1.7217094e-15  0              0.099985014    5.0668739e-11  0              0.0024466121  -1.5            0              2.9995498    
   2200000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    8.9355939e-12  0              0.00043146785 -1.5            0              2.9995498    
   2300000   9000           100            100            0.03332833    -1.721709e-15   0              0.09998499     7.786437e-13   0              3.7597918e-05 -1.5            0              2.9995498    
   2400000   9000           100            100            0.03332833    -1.721709e-15   0              0.099984991    2.1918376e-14  0              1.0583599e-06 -1.5            0              2.9995498    
   2500000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984992    4.9789382e-16  0              2.4041511e-08 -1.5            0              2.9995498    
   2600000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    9.3342703e-16  0              4.5071851e-08 -1.5            0              2.9995498    
   2700000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    3.0284803e-16  0              1.4623448e-08 -1.5            0              2.9995498    
   2800000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    1.3109247e-17  0              6.3299861e-10 -1.5            0              2.9995498    
   2900000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    2.2690564e-17  0              1.0956461e-09 -1.5            0              2.9995498    
   3000000   9000           100            100            0.033328331   -1.7217091e-15  0              0.099984993    1.194528e-19   0              5.7679484e-12 -1.5            0              2.9995498    
Loop time of 649.339 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3991754.045 ns/day, 0.000 hours/ns, 4620.086 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 259.37     | 262.47     | 265.55     |  16.6 | 40.42
Neigh   | 1.6307     | 1.6441     | 1.6575     |   1.0 |  0.25
Comm    | 34.904     | 38.061     | 41.349     |  46.0 |  5.86
Output  | 0.43197    | 0.43234    | 0.43324    |   0.1 |  0.07
Modify  | 303.33     | 304.06     | 304.89     |   3.9 | 46.83
Other   |            | 42.67      |            |       |  6.57

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 170000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027794921    3.5226494e-20  0              0.083384763    1822635.7      0              8.8008557e+13 -1.5            0              3.3088451    
    200000   9000           100            100            0.011315507    9.3385772e-21  0              0.03394652     552112.12      0              2.6659518e+13 -1.5            0              3.0392511    
    300000   9000           100            100            0.0037756781   3.3552498e-21  0              0.011327034    98947.023      0              4.7777976e+12 -1.5            0              3.023534     
    400000   9000           100            100           -0.0012540166  -1.0260631e-21  0             -0.0037620497   21590.372      0              1.0425218e+12 -1.5            0              3.005763     
    500000   9000           100            100           -0.00067166393 -3.6263546e-21  0             -0.0020149918   5492.876       0              2.6523132e+11 -1.5            0              3.0008557    
    600000   9000           100            100            3.2700262e-05 -6.0551805e-21  0              9.8100786e-05  12.014553      0              5.8013975e+08 -1.5            0              3.0002704    
    700000   9000           100            100            0.017644677   -9.0609633e-16  0              0.052934031    107.89635      0              5.2099287e+09 -1.5            0              2.9997123    
    800000   9000           100            100            0.041813385   -2.1607264e-15  0              0.12544016     1.140174       0              55054924      -1.5            0              2.9994865    
    900000   9000           100            100            0.031097268   -1.6062858e-15  0              0.093291804    1.613878       0              77928393      -1.5            0              2.9995787    
   1000000   9000           100            100            0.033482107   -1.7306693e-15  0              0.10044632     0.45591894     0              22014694      -1.5            0              2.9995573    
   1100000   9000           100            100            0.033533525   -1.7327082e-15  0              0.10060058     0.043151453    0              2083629.2     -1.5            0              2.9995569    
   1200000   9000           100            100            0.03319619    -1.715468e-15   0              0.099588569    0.00070577911  0              34079.547     -1.5            0              2.9995598    
   1300000   9000           100            100            0.033374149   -1.7246389e-15  0              0.10012245     0.00014738392  0              7116.6422     -1.5            0              2.9995583    
   1400000   9000           100            100            0.033320498   -1.7218557e-15  0              0.099961494    0.00010026397  0              4841.3884     -1.5            0              2.9995587    
   1500000   9000           100            100            0.033326888   -1.722195e-15   0              0.099980665    1.5171403e-05  0              732.57274     -1.5            0              2.9995587    
   1600000   9000           100            100            0.033330285   -1.7223669e-15  0              0.099990854    7.0056977e-07  0              33.828007     -1.5            0              2.9995586    
   1700000   9000           100            100            0.033327617   -1.7222299e-15  0              0.099982852    1.895424e-09   0              0.091523242   -1.5            0              2.9995587    
   1800000   9000           100            100            0.033328634   -1.7222824e-15  0              0.099985902    1.7149173e-08  0              0.82807219    -1.5            0              2.9995587    
   1900000   9000           100            100            0.033328422   -1.7222714e-15  0              0.099985267    4.3165986e-09  0              0.2084331     -1.5            0              2.9995587    
   2000000   9000           100            100            0.033328407   -1.7222707e-15  0              0.099985222    3.6033868e-10  0              0.017399465   -1.5            0              2.9995587    
   2100000   9000           100            100            0.033328443   -1.7222725e-15  0              0.099985328    3.6524045e-12  0              0.00017636154 -1.5            0              2.9995587    
   2200000   9000           100            100            0.033328425   -1.7222716e-15  0              0.099985276    1.9436915e-12  0              9.3853905e-05 -1.5            0              2.9995587    
   2300000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985291    1.0044776e-12  0              4.8502627e-05 -1.5            0              2.9995587    
   2400000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    1.3487483e-13  0              6.5126229e-06 -1.5            0              2.9995587    
   2500000   9000           100            100            0.033328429   -1.7222718e-15  0              0.099985288    4.9537296e-15  0              2.3919787e-07 -1.5            0              2.9995587    
   2600000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    2.2897169e-17  0              1.1056224e-09 -1.5            0              2.9995587    
   2700000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    2.2507775e-16  0              1.0868199e-08 -1.5            0              2.9995587    
   2800000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    3.3248204e-20  0              1.6054368e-12 -1.5            0              2.9995587    
   2900000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    7.5151911e-18  0              3.6288168e-10 -1.5            0              2.9995587    
   3000000   9000           100            100            0.03332843    -1.7222718e-15  0              0.099985289    1.7986726e-18  0              8.6851464e-11 -1.5            0              2.9995587    
Loop time of 657.688 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3941076.818 ns/day, 0.000 hours/ns, 4561.432 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 263.17     | 267.7      | 276.31     |  32.7 | 40.70
Neigh   | 1.6659     | 1.6794     | 1.6929     |   1.0 |  0.26
Comm    | 34.496     | 40.765     | 46.837     |  89.2 |  6.20
Output  | 0.43326    | 0.43348    | 0.43404    |   0.0 |  0.07
Modify  | 303.45     | 305.49     | 310.07     |  15.3 | 46.45
Other   |            | 41.62      |            |       |  6.33

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 175000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027799915    3.5260811e-20  0              0.083399746    1823122.9      0              8.8032081e+13 -1.5            0              3.3087236    
    200000   9000           100            100            0.011325682    1.0252661e-20  0              0.033977045    552878.19      0              2.6696509e+13 -1.5            0              3.0390362    
    300000   9000           100            100            0.0037919035   3.5472212e-21  0              0.011375711    99668.86       0              4.8126525e+12 -1.5            0              3.0233335    
    400000   9000           100            100           -0.0012325545  -8.1774155e-22  0             -0.0036976635   20748.071      0              1.0018501e+12 -1.5            0              3.0060684    
    500000   9000           100            100           -0.00061382073 -3.3153874e-21  0             -0.0018414622   4535.2121      0              2.1898916e+11 -1.5            0              3.0011894    
    600000   9000           100            100            0.00021397501 -5.8581286e-21  0              0.00064192504  483.34002      0              2.333876e+10  -1.5            0              3.0001249    
    700000   9000           100            100            0.048697711   -2.5209923e-15  0              0.14609313     137.76397      0              6.6521289e+09 -1.5            0              2.9994417    
    800000   9000           100            100            0.041917289   -2.163795e-15   0              0.12575187     1.363676       0              65847036      -1.5            0              2.9994955    
    900000   9000           100            100            0.035428389   -1.8293532e-15  0              0.10628517     1.9739309      0              95314059      -1.5            0              2.999549     
   1000000   9000           100            100            0.033325019   -1.7203833e-15  0              0.099975058    0.47189759     0              22786246      -1.5            0              2.9995671    
   1100000   9000           100            100            0.033053723   -1.7060375e-15  0              0.09916117     0.031202207    0              1506642.9     -1.5            0              2.9995695    
   1200000   9000           100            100            0.033187557   -1.7128177e-15  0              0.099562671    5.7625219e-06  0              278.25156     -1.5            0              2.9995683    
   1300000   9000           100            100            0.033291595   -1.7181661e-15  0              0.099874785    0.00045984271  0              22204.159     -1.5            0              2.9995674    
   1400000   9000           100            100            0.033327713   -1.7200358e-15  0              0.09998314     0.00012722253  0              6143.1207     -1.5            0              2.9995671    
   1500000   9000           100            100            0.033332844   -1.7203061e-15  0              0.099998533    9.1218221e-06  0              440.46014     -1.5            0              2.9995671    
   1600000   9000           100            100            0.033330838   -1.7202047e-15  0              0.099992513    9.7653884e-09  0              0.47153566    -1.5            0              2.9995671    
   1700000   9000           100            100            0.033329153   -1.7201181e-15  0              0.09998746     1.1334772e-07  0              5.4731557     -1.5            0              2.9995671    
   1800000   9000           100            100            0.033328549   -1.7200868e-15  0              0.099985647    3.418432e-08   0              1.6506385     -1.5            0              2.9995671    
   1900000   9000           100            100            0.033328456   -1.7200819e-15  0              0.099985367    2.6434889e-09  0              0.12764462    -1.5            0              2.9995671    
   2000000   9000           100            100            0.033328486   -1.7200834e-15  0              0.099985457    6.7268417e-12  0              0.00032481511 -1.5            0              2.9995671    
   2100000   9000           100            100            0.033328513   -1.7200848e-15  0              0.099985538    2.7715715e-11  0              0.0013382927  -1.5            0              2.9995671    
   2200000   9000           100            100            0.033328523   -1.7200854e-15  0              0.099985569    9.1493621e-12  0              0.00044178995 -1.5            0              2.9995671    
   2300000   9000           100            100            0.033328525   -1.7200854e-15  0              0.099985574    7.6126376e-13  0              3.6758703e-05 -1.5            0              2.9995671    
   2400000   9000           100            100            0.033328524   -1.7200854e-15  0              0.099985572    3.0931416e-15  0              1.4935674e-07 -1.5            0              2.9995671    
   2500000   9000           100            100            0.033328524   -1.7200854e-15  0              0.099985571    6.9670334e-15  0              3.3641311e-07 -1.5            0              2.9995671    
   2600000   9000           100            100            0.033328523   -1.7200854e-15  0              0.09998557     2.3609937e-15  0              1.1400394e-07 -1.5            0              2.9995671    
   2700000   9000           100            100            0.033328523   -1.7200854e-15  0              0.09998557     2.1613995e-16  0              1.0436625e-08 -1.5            0              2.9995671    
   2800000   9000           100            100            0.033328523   -1.7200854e-15  0              0.09998557     1.3230659e-17  0              6.3886116e-10 -1.5            0              2.9995671    
   2900000   9000           100            100            0.033328523   -1.7200854e-15  0              0.09998557     1.3862997e-20  0              6.6939449e-13 -1.5            0              2.9995671    
   3000000   9000           100            100            0.033328523   -1.7200854e-15  0              0.09998557     1.8610767e-18  0              8.9864734e-11 -1.5            0              2.9995671    
Loop time of 653.344 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3967279.694 ns/day, 0.000 hours/ns, 4591.759 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 262.83     | 266.57     | 270.97     |  20.7 | 40.80
Neigh   | 1.6413     | 1.6534     | 1.665      |   0.9 |  0.25
Comm    | 35.101     | 38.787     | 42.935     |  56.5 |  5.94
Output  | 0.43609    | 0.43641    | 0.43717    |   0.1 |  0.07
Modify  | 303.65     | 304.31     | 305.29     |   3.5 | 46.58
Other   |            | 41.59      |            |       |  6.37

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 180000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027804715    3.5243018e-20  0              0.083414144    1823591.2      0              8.8054695e+13 -1.5            0              3.3086066    
    200000   9000           100            100            0.011335489    1.0318007e-20  0              0.034006467    553616.99      0              2.6732183e+13 -1.5            0              3.0388284    
    300000   9000           100            100            0.0038075504   4.1273188e-21  0              0.011422651    100366.74      0              4.8463506e+12 -1.5            0              3.0231391    
    400000   9000           100            100           -0.0012118025  -7.9895285e-22  0             -0.0036354075   19954.319      0              9.6352267e+11 -1.5            0              3.006357     
    500000   9000           100            100           -0.00055777043 -3.4112905e-21  0             -0.0016733113   3704.01        0              1.7885339e+11 -1.5            0              3.0014816    
    600000   9000           100            100            0.013174006   -6.6987827e-16  0              0.039522017    1453.4188      0              7.0180393e+10 -1.5            0              2.9997757    
    700000   9000           100            100            0.016016948   -8.2209703e-16  0              0.048050845    91.263932      0              4.4068086e+09 -1.5            0              2.9997404    
    800000   9000           100            100            0.042255434   -2.1822794e-15  0              0.1267663      0.13930329     0              6726457.1     -1.5            0              2.9995023    
    900000   9000           100            100            0.030893286   -1.5951321e-15  0              0.092679858    1.4077443      0              67974935      -1.5            0              2.9995962    
   1000000   9000           100            100            0.033480523   -1.7298945e-15  0              0.10044157     0.46876303     0              22634889      -1.5            0              2.9995738    
   1100000   9000           100            100            0.033567478   -1.7337617e-15  0              0.10070243     0.039701998    0              1917067.4     -1.5            0              2.9995732    
   1200000   9000           100            100            0.033186869   -1.7142777e-15  0              0.099560606    0.00017958262  0              8671.4019     -1.5            0              2.9995764    
   1300000   9000           100            100            0.033369995   -1.7237276e-15  0              0.10010998     0.00035111844  0              16954.253     -1.5            0              2.9995748    
   1400000   9000           100            100            0.033325787   -1.7214262e-15  0              0.099977361    0.00012624245  0              6095.7962     -1.5            0              2.9995752    
   1500000   9000           100            100            0.03332474    -1.7213824e-15  0              0.099974219    1.0910812e-05  0              526.84404     -1.5            0              2.9995752    
   1600000   9000           100            100            0.033330942   -1.7216999e-15  0              0.099992827    5.5858884e-08  0              2.6972256     -1.5            0              2.9995751    
   1700000   9000           100            100            0.033327927   -1.7215443e-15  0              0.09998378     9.2224878e-08  0              4.4532093     -1.5            0              2.9995752    
   1800000   9000           100            100            0.033328663   -1.7215826e-15  0              0.099985988    3.4061022e-08  0              1.6446849     -1.5            0              2.9995752    
   1900000   9000           100            100            0.033328676   -1.7215831e-15  0              0.099986027    3.0001266e-09  0              0.14486538    -1.5            0              2.9995752    
   2000000   9000           100            100            0.033328575   -1.7215779e-15  0              0.099985724    1.7191837e-11  0              0.0008301323  -1.5            0              2.9995752    
   2100000   9000           100            100            0.033328624   -1.7215805e-15  0              0.099985873    2.4221391e-11  0              0.0011695643  -1.5            0              2.9995752    
   2200000   9000           100            100            0.033328612   -1.7215798e-15  0              0.099985836    9.1938904e-12  0              0.00044394006 -1.5            0              2.9995752    
   2300000   9000           100            100            0.033328612   -1.7215798e-15  0              0.099985836    8.2762736e-13  0              3.9963163e-05 -1.5            0              2.9995752    
   2400000   9000           100            100            0.033328614   -1.7215799e-15  0              0.099985841    5.0761403e-15  0              2.4510865e-07 -1.5            0              2.9995752    
   2500000   9000           100            100            0.033328613   -1.7215799e-15  0              0.099985838    6.5259935e-15  0              3.1511687e-07 -1.5            0              2.9995752    
   2600000   9000           100            100            0.033328613   -1.7215799e-15  0              0.099985839    2.4679567e-15  0              1.191688e-07  -1.5            0              2.9995752    
   2700000   9000           100            100            0.033328613   -1.7215799e-15  0              0.099985839    2.7001333e-16  0              1.3037977e-08 -1.5            0              2.9995752    
   2800000   9000           100            100            0.033328613   -1.7215799e-15  0              0.099985839    7.6083661e-19  0              3.6738077e-11 -1.5            0              2.9995752    
   2900000   9000           100            100            0.033328613   -1.7215799e-15  0              0.099985839    1.1403504e-17  0              5.5063439e-10 -1.5            0              2.9995752    
   3000000   9000           100            100            0.033328613   -1.7215798e-15  0              0.099985839    7.2133269e-19  0              3.4830574e-11 -1.5            0              2.9995752    
Loop time of 660.788 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3922591.315 ns/day, 0.000 hours/ns, 4540.036 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 260.69     | 267.68     | 278.29     |  41.2 | 40.51
Neigh   | 1.6317     | 1.6433     | 1.6554     |   0.9 |  0.25
Comm    | 34.09      | 41.603     | 49.932     | 108.1 |  6.30
Output  | 0.43293    | 0.43308    | 0.43339    |   0.0 |  0.07
Modify  | 302.35     | 306.15     | 310.76     |  17.2 | 46.33
Other   |            | 43.28      |            |       |  6.55

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 185000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027809332    3.5003904e-20  0              0.083427996    1824042        0              8.8076458e+13 -1.5            0              3.3084936    
    200000   9000           100            100            0.011344951    9.7396549e-21  0              0.034034854    554330.17      0              2.676662e+13  -1.5            0              3.0386271    
    300000   9000           100            100            0.0038226524   3.328429e-21   0              0.011467957    101041.97      0              4.8789551e+12 -1.5            0              3.0229506    
    400000   9000           100            100           -0.0011917078  -8.287725e-22   0             -0.0035751235   19204.744      0              9.2732835e+11 -1.5            0              3.0066304    
    500000   9000           100            100           -0.00050340282 -3.4278459e-21  0             -0.0015102085   2985.6754      0              1.4416758e+11 -1.5            0              3.0017364    
    600000   9000           100            100            0.066638268   -3.4114501e-15  0              0.1999148      1307.0269      0              6.3111652e+10 -1.5            0              2.9993404    
    700000   9000           100            100            0.054812971   -2.8357807e-15  0              0.16443891     72.770022      0              3.5138039e+09 -1.5            0              2.9994182    
    800000   9000           100            100            0.042153882   -2.1757552e-15  0              0.12646165     1.6717148      0              80721126      -1.5            0              2.9995122    
    900000   9000           100            100            0.036370511   -1.8788195e-15  0              0.10911153     0.35626976     0              17202992      -1.5            0              2.9995578    
   1000000   9000           100            100            0.033920288   -1.7524313e-15  0              0.10176086     0.35171962     0              16983282      -1.5            0              2.9995779    
   1100000   9000           100            100            0.033255732   -1.7179081e-15  0              0.099767196    0.060174849    0              2905628.1     -1.5            0              2.9995834    
   1200000   9000           100            100            0.033213598   -1.7156013e-15  0              0.099640794    0.0030147486   0              145571.42     -1.5            0              2.9995838    
   1300000   9000           100            100            0.033276656   -1.7188139e-15  0              0.099829969    4.9606496e-06  0              239.53202     -1.5            0              2.9995833    
   1400000   9000           100            100            0.033315742   -1.7208258e-15  0              0.099947225    6.7834593e-05  0              3275.4897     -1.5            0              2.999583     
   1500000   9000           100            100            0.033328476   -1.7214856e-15  0              0.099985427    1.6827426e-05  0              812.53618     -1.5            0              2.9995829    
   1600000   9000           100            100            0.033330243   -1.7215788e-15  0              0.099990728    1.2731528e-06  0              61.475991     -1.5            0              2.9995828    
   1700000   9000           100            100            0.03332955    -1.7215438e-15  0              0.099988649    5.5733381e-09  0              0.26911655    -1.5            0              2.9995828    
   1800000   9000           100            100            0.033328954   -1.7215132e-15  0              0.099986861    1.1033054e-08  0              0.53274668    -1.5            0              2.9995829    
   1900000   9000           100            100            0.033328725   -1.7215014e-15  0              0.099986175    4.2955683e-09  0              0.20741762    -1.5            0              2.9995829    
   2000000   9000           100            100            0.03332868    -1.721499e-15   0              0.09998604     4.595259e-10   0              0.022188861   -1.5            0              2.9995829    
   2100000   9000           100            100            0.033328685   -1.7214992e-15  0              0.099986055    9.0498431e-12  0              0.00043698454 -1.5            0              2.9995829    
   2200000   9000           100            100            0.033328694   -1.7214997e-15  0              0.099986081    1.3158644e-12  0              6.3538385e-05 -1.5            0              2.9995829    
   2300000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986093    9.9420917e-13  0              4.8006803e-05 -1.5            0              2.9995829    
   2400000   9000           100            100            0.033328699   -1.7214999e-15  0              0.099986096    1.470127e-13   0              7.0987172e-06 -1.5            0              2.9995829    
   2500000   9000           100            100            0.033328699   -1.7214999e-15  0              0.099986096    5.7516975e-15  0              2.7772889e-07 -1.5            0              2.9995829    
   2600000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986095    4.0223702e-17  0              1.9422586e-09 -1.5            0              2.9995829    
   2700000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986095    1.7592715e-16  0              8.4948924e-09 -1.5            0              2.9995829    
   2800000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986095    1.8659984e-17  0              9.0102384e-10 -1.5            0              2.9995829    
   2900000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986095    1.4142349e-17  0              6.8288343e-10 -1.5            0              2.9995829    
   3000000   9000           100            100            0.033328698   -1.7214999e-15  0              0.099986095    6.2527044e-18  0              3.0192072e-10 -1.5            0              2.9995829    
Loop time of 654.275 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3961639.917 ns/day, 0.000 hours/ns, 4585.231 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 262.49     | 267        | 269.57     |  16.4 | 40.81
Neigh   | 1.645      | 1.6577     | 1.6701     |   0.9 |  0.25
Comm    | 36.577     | 38.972     | 42.12      |  33.6 |  5.96
Output  | 0.43502    | 0.43518    | 0.4355     |   0.0 |  0.07
Modify  | 302.75     | 304.25     | 305.31     |   5.5 | 46.50
Other   |            | 41.97      |            |       |  6.41

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 190000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027813777    3.4772352e-20  0              0.08344133     1824475.8      0              8.8097408e+13 -1.5            0              3.308385     
    200000   9000           100            100            0.011354043    9.8717801e-21  0              0.034062128    555015.63      0              2.6799718e+13 -1.5            0              3.0384338    
    300000   9000           100            100            0.0038371888   3.5843179e-21  0              0.011511566    101693.43      0              4.9104116e+12 -1.5            0              3.0227685    
    400000   9000           100            100           -0.0011722767  -1.1222467e-21  0             -0.00351683     18497.426      0              8.9317451e+11 -1.5            0              3.0068892    
    500000   9000           100            100           -0.00045069752 -3.3790745e-21  0             -0.0013520926   2369.2902      0              1.1440454e+11 -1.5            0              3.0019575    
    600000   9000           100            100            0.11000402    -5.6984597e-15  0              0.33001205     58.286978      0              2.8144696e+09 -1.5            0              2.9990919    
    700000   9000           100            100            0.011533749   -5.9305218e-16  0              0.034601248    14.007581      0              6.7637595e+08 -1.5            0              2.9997984    
    800000   9000           100            100            0.040343052   -2.0785239e-15  0              0.12102915     12.388875      0              5.9821444e+08 -1.5            0              2.9995348    
    900000   9000           100            100            0.030244147   -1.5606919e-15  0              0.090732441    0.23364849     0              11282050      -1.5            0              2.9996159    
   1000000   9000           100            100            0.034413702   -1.7755123e-15  0              0.10324111     0.057667059    0              2784535.9     -1.5            0              2.9995813    
   1100000   9000           100            100            0.033097124   -1.7073143e-15  0              0.099291372    0.042885499    0              2070787.2     -1.5            0              2.9995921    
   1200000   9000           100            100            0.033324059   -1.7192237e-15  0              0.099972176    0.0080685242   0              389600.16     -1.5            0              2.9995902    
   1300000   9000           100            100            0.033361209   -1.7210582e-15  0              0.10008363     0.00065190674  0              31478.244     -1.5            0              2.9995899    
   1400000   9000           100            100            0.033310555   -1.7184666e-15  0              0.099931665    1.0775887e-05  0              520.329       -1.5            0              2.9995904    
   1500000   9000           100            100            0.033335194   -1.7197357e-15  0              0.10000558     1.8845192e-06  0              90.996686     -1.5            0              2.9995902    
   1600000   9000           100            100            0.033327398   -1.7193319e-15  0              0.099982194    1.4840143e-06  0              71.657739     -1.5            0              2.9995902    
   1700000   9000           100            100            0.033328759   -1.7194033e-15  0              0.099986276    2.8168407e-07  0              13.601516     -1.5            0              2.9995902    
   1800000   9000           100            100            0.03332897    -1.7194137e-15  0              0.09998691     2.2983225e-08  0              1.1097777     -1.5            0              2.9995902    
   1900000   9000           100            100            0.033328673   -1.7193985e-15  0              0.099986018    3.9346681e-10  0              0.018999104   -1.5            0              2.9995902    
   2000000   9000           100            100            0.033328818   -1.719406e-15   0              0.099986454    6.3285025e-11  0              0.0030558073  -1.5            0              2.9995902    
   2100000   9000           100            100            0.033328772   -1.7194036e-15  0              0.099986315    5.131644e-11   0              0.0024778872  -1.5            0              2.9995902    
   2200000   9000           100            100            0.03332878    -1.719404e-15   0              0.09998634     9.8449321e-12  0              0.00047537654 -1.5            0              2.9995902    
   2300000   9000           100            100            0.033328781   -1.7194041e-15  0              0.099986344    8.0805004e-13  0              3.9017844e-05 -1.5            0              2.9995902    
   2400000   9000           100            100            0.033328779   -1.719404e-15   0              0.099986338    1.3974151e-14  0              6.7476174e-07 -1.5            0              2.9995902    
   2500000   9000           100            100            0.03332878    -1.7194041e-15  0              0.099986341    2.2801675e-15  0              1.1010113e-07 -1.5            0              2.9995902    
   2600000   9000           100            100            0.03332878    -1.719404e-15   0              0.09998634     1.7619329e-15  0              8.5077433e-08 -1.5            0              2.9995902    
   2700000   9000           100            100            0.03332878    -1.7194041e-15  0              0.09998634     3.337977e-16   0              1.6117896e-08 -1.5            0              2.9995902    
   2800000   9000           100            100            0.03332878    -1.7194041e-15  0              0.09998634     9.7682925e-19  0              4.7167588e-11 -1.5            0              2.9995902    
   2900000   9000           100            100            0.03332878    -1.719404e-15   0              0.09998634     4.8051259e-18  0              2.3202233e-10 -1.5            0              2.9995902    
   3000000   9000           100            100            0.03332878    -1.719404e-15   0              0.09998634     1.3068306e-17  0              6.3102172e-10 -1.5            0              2.9995902    
Loop time of 659.245 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3931768.466 ns/day, 0.000 hours/ns, 4550.658 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 266.43     | 271.9      | 274.9      |  19.8 | 41.24
Neigh   | 1.6138     | 1.6264     | 1.639      |   0.9 |  0.25
Comm    | 35.473     | 38.345     | 42.301     |  41.7 |  5.82
Output  | 0.43398    | 0.43425    | 0.43498    |   0.1 |  0.07
Modify  | 301.75     | 304.2      | 305.29     |   8.2 | 46.14
Other   |            | 42.74      |            |       |  6.48

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 195000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.02781806     3.5460566e-20  0              0.08345418     1824893.9      0              8.8117597e+13 -1.5            0              3.3082803    
    200000   9000           100            100            0.011362804    1.051454e-20   0              0.034088412    555676.43      0              2.6831626e+13 -1.5            0              3.0382476    
    300000   9000           100            100            0.0038511819   3.7223361e-21  0              0.011553546    102321.94      0              4.9407601e+12 -1.5            0              3.0225927    
    400000   9000           100            100           -0.0011534961  -5.3629581e-22  0             -0.0034604882   17829.882      0              8.6094118e+11 -1.5            0              3.0071342    
    500000   9000           100            100           -0.00039960598 -3.2963292e-21  0             -0.001198818    1844.6522      0              8.9071655e+10 -1.5            0              3.0021481    
    600000   9000           100            100            0.091444129   -4.7772467e-15  0              0.27433239     719.30803      0              3.473281e+10  -1.5            0              2.9992091    
    700000   9000           100            100            0.060333774   -3.1115735e-15  0              0.18100132     2.6397813      0              1.2746559e+08 -1.5            0              2.9994018    
    800000   9000           100            100            0.035783968   -1.8431832e-15  0              0.1073519      27.906512      0              1.3475056e+09 -1.5            0              2.9995781    
    900000   9000           100            100            0.03505919    -1.8083885e-15  0              0.10517757     2.7942485      0              1.3492426e+08 -1.5            0              2.9995835    
   1000000   9000           100            100            0.034319188   -1.7711452e-15  0              0.10295756     0.14355989     0              6931993.5     -1.5            0              2.9995893    
   1100000   9000           100            100            0.033746413   -1.7418573e-15  0              0.10123924     0.00064758813  0              31269.713     -1.5            0              2.9995939    
   1200000   9000           100            100            0.033468903   -1.727587e-15   0              0.10040671     0.0010558783   0              50984.584     -1.5            0              2.9995961    
   1300000   9000           100            100            0.033364823   -1.7222136e-15  0              0.10009447     0.00057844343  0              27930.963     -1.5            0              2.9995969    
   1400000   9000           100            100            0.033333875   -1.7206085e-15  0              0.10000163     0.00012561315  0              6065.4095     -1.5            0              2.9995972    
   1500000   9000           100            100            0.033327447   -1.720272e-15   0              0.099982342    1.6632655e-05  0              803.13141     -1.5            0              2.9995973    
   1600000   9000           100            100            0.033327311   -1.7202629e-15  0              0.099981934    1.3653637e-06  0              65.928526     -1.5            0              2.9995973    
   1700000   9000           100            100            0.03332805    -1.7203004e-15  0              0.099984151    4.9899805e-08  0              2.409483      -1.5            0              2.9995972    
   1800000   9000           100            100            0.03332854    -1.7203255e-15  0              0.099985621    5.2456658e-11  0              0.0025329443  -1.5            0              2.9995972    
   1900000   9000           100            100            0.033328759   -1.7203367e-15  0              0.099986276    1.1106208e-09  0              0.053627902   -1.5            0              2.9995972    
   2000000   9000           100            100            0.033328835   -1.7203407e-15  0              0.099986506    4.1544608e-10  0              0.020060404   -1.5            0              2.9995972    
   2100000   9000           100            100            0.033328856   -1.7203418e-15  0              0.099986569    7.6627301e-11  0              0.0037000581  -1.5            0              2.9995972    
   2200000   9000           100            100            0.03332886    -1.720342e-15   0              0.09998658     8.8753902e-12  0              0.00042856083 -1.5            0              2.9995972    
   2300000   9000           100            100            0.03332886    -1.7203419e-15  0              0.099986579    6.1258087e-13  0              2.9579338e-05 -1.5            0              2.9995972    
   2400000   9000           100            100            0.033328859   -1.7203419e-15  0              0.099986577    1.3488574e-14  0              6.5131496e-07 -1.5            0              2.9995972    
   2500000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    6.062982e-16   0              2.927597e-08  -1.5            0              2.9995972    
   2600000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    1.0344342e-15  0              4.9949124e-08 -1.5            0              2.9995972    
   2700000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    2.1666183e-16  0              1.0461824e-08 -1.5            0              2.9995972    
   2800000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    4.1442167e-17  0              2.0010939e-09 -1.5            0              2.9995972    
   2900000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    3.9990979e-18  0              1.9310213e-10 -1.5            0              2.9995972    
   3000000   9000           100            100            0.033328858   -1.7203419e-15  0              0.099986575    3.7822844e-18  0              1.8263298e-10 -1.5            0              2.9995972    
Loop time of 658.322 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3937284.280 ns/day, 0.000 hours/ns, 4557.042 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 261.81     | 267.66     | 275.1      |  29.1 | 40.66
Neigh   | 1.6561     | 1.6641     | 1.6723     |   0.6 |  0.25
Comm    | 35.299     | 40.378     | 46.647     |  70.5 |  6.13
Output  | 0.43373    | 0.43414    | 0.43516    |   0.1 |  0.07
Modify  | 302.77     | 306.55     | 309.36     |  13.8 | 46.57
Other   |            | 41.64      |            |       |  6.32

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 200000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027822191    3.463038e-20   0              0.083466573    1825297.2      0              8.8137068e+13 -1.5            0              3.3081795    
    200000   9000           100            100            0.011371268    9.2870229e-21  0              0.034113803    556315.08      0              2.6862464e+13 -1.5            0              3.0380671    
    300000   9000           100            100            0.0038647528   3.6648546e-21  0              0.011594258    102932.81      0              4.9702572e+12 -1.5            0              3.0224213    
    400000   9000           100            100           -0.0011352435  -9.8367974e-22  0             -0.0034057304   17196.031      0              8.3033481e+11 -1.5            0              3.0073674    
    500000   9000           100            100           -0.000349941   -3.0712081e-21  0             -0.001049823    1401.4398      0              6.767051e+10  -1.5            0              3.0023115    
    600000   9000           100            100            0.035554184   -1.8928892e-15  0              0.10666255     1687.2965      0              8.1473508e+10 -1.5            0              2.9995835    
    700000   9000           100            100            0.012812878   -6.6666531e-16  0              0.038438634    54.189167      0              2.616601e+09  -1.5            0              2.9997898    
    800000   9000           100            100            0.029357334   -1.5117951e-15  0              0.088072001    24.472206      0              1.1816752e+09 -1.5            0              2.9996365    
    900000   9000           100            100            0.034514723   -1.7825278e-15  0              0.10354417     3.3949176      0              1.6392842e+08 -1.5            0              2.9995945    
   1000000   9000           100            100            0.033155957   -1.7106609e-15  0              0.099467871    0.49014116     0              23667163      -1.5            0              2.9996054    
   1100000   9000           100            100            0.033280097   -1.7177349e-15  0              0.099840292    0.063609655    0              3071482.6     -1.5            0              2.9996043    
   1200000   9000           100            100            0.033384423   -1.7228768e-15  0              0.10015327     0.0071975307   0              347543        -1.5            0              2.9996035    
   1300000   9000           100            100            0.03329662    -1.7184275e-15  0              0.09988986     0.0006945063   0              33535.224     -1.5            0              2.9996042    
   1400000   9000           100            100            0.033344184   -1.7208565e-15  0              0.10003255     5.4197621e-05  0              2617.0092     -1.5            0              2.9996039    
   1500000   9000           100            100            0.033322518   -1.7197457e-15  0              0.099967555    2.9366766e-06  0              141.8016      -1.5            0              2.999604     
   1600000   9000           100            100            0.033331418   -1.7202032e-15  0              0.099994255    5.8271034e-08  0              2.8136997     -1.5            0              2.999604     
   1700000   9000           100            100            0.033328036   -1.7200289e-15  0              0.099984107    2.8060983e-09  0              0.13549644    -1.5            0              2.999604     
   1800000   9000           100            100            0.033329236   -1.7200909e-15  0              0.099987707    4.5871448e-09  0              0.22149681    -1.5            0              2.999604     
   1900000   9000           100            100            0.033328839   -1.7200704e-15  0              0.099986517    1.6097076e-09  0              0.077727019   -1.5            0              2.999604     
   2000000   9000           100            100            0.03332896    -1.7200766e-15  0              0.099986879    3.6466914e-10  0              0.017608568   -1.5            0              2.999604     
   2100000   9000           100            100            0.033328927   -1.7200749e-15  0              0.099986781    6.5235617e-11  0              0.0031499945  -1.5            0              2.999604     
   2200000   9000           100            100            0.033328934   -1.7200753e-15  0              0.099986802    9.8853659e-12  0              0.00047732894 -1.5            0              2.999604     
   2300000   9000           100            100            0.033328933   -1.7200752e-15  0              0.0999868      1.300629e-12   0              6.2802718e-05 -1.5            0              2.999604     
   2400000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    1.4938287e-13  0              7.2131641e-06 -1.5            0              2.999604     
   2500000   9000           100            100            0.033328933   -1.7200752e-15  0              0.0999868      1.4938933e-14  0              7.2134762e-07 -1.5            0              2.999604     
   2600000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    9.5165773e-16  0              4.5952146e-08 -1.5            0              2.999604     
   2700000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    1.9289569e-16  0              9.3142426e-09 -1.5            0              2.999604     
   2800000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    4.0385457e-20  0              1.9500692e-12 -1.5            0              2.999604     
   2900000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    1.8455507e-17  0              8.9115039e-10 -1.5            0              2.999604     
   3000000   9000           100            100            0.033328933   -1.7200752e-15  0              0.099986799    1.616095e-17   0              7.8035444e-10 -1.5            0              2.999604     
Loop time of 665.673 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3893800.829 ns/day, 0.000 hours/ns, 4506.714 timesteps/s
99.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 263.05     | 271.18     | 279.48     |  46.1 | 40.74
Neigh   | 1.6204     | 1.6353     | 1.6498     |   1.1 |  0.25
Comm    | 34.094     | 42.756     | 51.334     | 126.0 |  6.42
Output  | 0.43442    | 0.43453    | 0.4348     |   0.0 |  0.07
Modify  | 305.08     | 306.59     | 307.98     |   6.0 | 46.06
Other   |            | 43.07      |            |       |  6.47

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 205000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027826184    3.5231225e-20  0              0.083478552    1825687.4      0              8.8155911e+13 -1.5            0              3.3080809    
    200000   9000           100            100            0.011379501    9.3117069e-21  0              0.034138504    556936.75      0              2.6892482e+13 -1.5            0              3.0378904    
    300000   9000           100            100            0.0038779382   3.361808e-21   0              0.011633815    103527.59      0              4.9989766e+12 -1.5            0              3.0222539    
    400000   9000           100            100           -0.0011174962  -6.6276088e-22  0             -0.0033524886   16593.626      0              8.012468e+11  -1.5            0              3.0075896    
    500000   9000           100            100           -0.00030163698 -3.102188e-21   0             -0.00090491094  1031.7864      0              4.9821273e+10 -1.5            0              3.0024502    
    600000   9000           100            100            0.00050635109 -4.4491653e-17  0              0.0015190533   1091.2475      0              5.2692436e+10 -1.5            0              2.9999671    
    700000   9000           100            100            0.044037725   -2.2604583e-15  0              0.13211318     199.7361       0              9.6445417e+09 -1.5            0              2.9995319    
    800000   9000           100            100            0.024650312   -1.27029e-15    0              0.073950937    2.4008576      0              1.1592882e+08 -1.5            0              2.9996815    
    900000   9000           100            100            0.030025005   -1.5483608e-15  0              0.090075016    0.022371249    0              1080227.5     -1.5            0              2.9996367    
   1000000   9000           100            100            0.032133467   -1.6571433e-15  0              0.096400401    0.001290168    0              62297.594     -1.5            0              2.9996198    
   1100000   9000           100            100            0.032899187   -1.6966366e-15  0              0.098697561    0.0001594497   0              7699.2552     -1.5            0              2.9996138    
   1200000   9000           100            100            0.033174762   -1.7108496e-15  0              0.099524287    2.2254368e-05  0              1074.5838     -1.5            0              2.9996117    
   1300000   9000           100            100            0.033273689   -1.7159519e-15  0              0.099821066    3.1399489e-06  0              151.6169      -1.5            0              2.9996109    
   1400000   9000           100            100            0.033309171   -1.717782e-15   0              0.099927513    4.4186978e-07  0              21.33631      -1.5            0              2.9996106    
   1500000   9000           100            100            0.033321894   -1.7184383e-15  0              0.099965682    6.1946568e-08  0              2.9911781     -1.5            0              2.9996105    
   1600000   9000           100            100            0.033326456   -1.7186735e-15  0              0.099979367    8.6533067e-09  0              0.41783721    -1.5            0              2.9996105    
   1700000   9000           100            100            0.033328091   -1.7187579e-15  0              0.099984273    1.2047301e-09  0              0.058172107   -1.5            0              2.9996105    
   1800000   9000           100            100            0.033328677   -1.7187881e-15  0              0.099986032    1.6716531e-10  0              0.0080718147  -1.5            0              2.9996105    
   1900000   9000           100            100            0.033328888   -1.718799e-15   0              0.099986663    2.3144647e-11  0              0.0011175722  -1.5            0              2.9996104    
   2000000   9000           100            100            0.033328963   -1.7188029e-15  0              0.099986889    3.1927102e-12  0              0.00015416455 -1.5            0              2.9996104    
   2100000   9000           100            100            0.03332899    -1.7188043e-15  0              0.09998697     4.3514994e-13  0              2.1011833e-05 -1.5            0              2.9996104    
   2200000   9000           100            100            0.033329      -1.7188048e-15  0              0.099986999    6.0158751e-14  0              2.9048508e-06 -1.5            0              2.9996104    
   2300000   9000           100            100            0.033329003   -1.7188049e-15  0              0.099987009    8.2651725e-15  0              3.990956e-07  -1.5            0              2.9996104    
   2400000   9000           100            100            0.033329004   -1.718805e-15   0              0.099987013    1.0640033e-15  0              5.1376911e-08 -1.5            0              2.9996104    
   2500000   9000           100            100            0.033329005   -1.718805e-15   0              0.099987014    1.6700549e-16  0              8.0640974e-09 -1.5            0              2.9996104    
   2600000   9000           100            100            0.033329005   -1.718805e-15   0              0.099987015    7.8689371e-17  0              3.7996281e-09 -1.5            0              2.9996104    
   2700000   9000           100            100            0.033329005   -1.718805e-15   0              0.099987015    6.7402014e-17  0              3.254602e-09  -1.5            0              2.9996104    
   2800000   9000           100            100            0.033329005   -1.718805e-15   0              0.099987015    8.3946467e-18  0              4.0534745e-10 -1.5            0              2.9996104    
   2900000   9000           100            100            0.033329005   -1.718805e-15   0              0.099987015    1.2026981e-17  0              5.8073986e-10 -1.5            0              2.9996104    
   3000000   9000           100            100            0.033329005   -1.7188051e-15  0              0.099987015    5.36724e-18    0              2.5916481e-10 -1.5            0              2.9996104    
Loop time of 661.249 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3919856.028 ns/day, 0.000 hours/ns, 4536.870 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 265.28     | 272.01     | 278.82     |  34.0 | 41.14
Neigh   | 1.664      | 1.6786     | 1.6928     |   1.1 |  0.25
Comm    | 34.927     | 40.419     | 46.59      |  84.3 |  6.11
Output  | 0.43499    | 0.43515    | 0.43547    |   0.0 |  0.07
Modify  | 302.22     | 304.11     | 305.14     |   6.4 | 45.99
Other   |            | 42.6       |            |       |  6.44

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 1500*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal (10+(5*v_ind))*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -4500 ${n1e1} -50 50 -50 50 units box
region box block -4500 4500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -4500 4500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-4500 -50 -50) to (4500 50 50)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -4500 4500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 3000 atoms
  using lattice units in orthogonal box = (-4500 -50 -50) to (4500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass


group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
3000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 210000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 3000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 5807 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.07 | 40.07 | 40.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   9000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   9000           100            100            0.027830038    3.5057801e-20  0              0.083490115    1826063.7      0              8.8174079e+13 -1.5            0              3.3079869    
    200000   9000           100            100            0.011387385    1.01044e-20    0              0.034162156    557532.04      0              2.6921227e+13 -1.5            0              3.0377223    
    300000   9000           100            100            0.0038905821   3.2957213e-21  0              0.011671746    104099.05      0              5.0265708e+12 -1.5            0              3.0220933    
    400000   9000           100            100           -0.0011003606  -7.4761446e-22  0             -0.0033010817   16024.795      0              7.7377998e+11 -1.5            0              3.0078002    
    500000   9000           100            100           -0.00025479914 -3.1547134e-21  0             -0.00076439741  729.67071      0              3.5233187e+10 -1.5            0              3.0025662    
    600000   9000           100            100           -0.0001794966  -5.2973521e-21  0             -0.00053848979  357.3134       0              1.7253385e+10 -1.5            0              3.0002196    
    700000   9000           100            100            0.033995984   -1.7649993e-15  0              0.10198795     238.9547       0              1.1538267e+10 -1.5            0              2.9996104    
    800000   9000           100            100            0.026034264   -1.3459303e-15  0              0.078102791    11.66357       0              5.6319204e+08 -1.5            0              2.9996746    
    900000   9000           100            100            0.034509627   -1.7792724e-15  0              0.10352888     3.5129488      0              1.6962772e+08 -1.5            0              2.9996078    
   1000000   9000           100            100            0.033283008   -1.7178681e-15  0              0.099849025    0.51168408     0              24707393      -1.5            0              2.999617     
   1100000   9000           100            100            0.033211431   -1.7134939e-15  0              0.099634294    0.061015027    0              2946197.3     -1.5            0              2.9996176    
   1200000   9000           100            100            0.033414019   -1.7241708e-15  0              0.10024206     0.0059640594   0              287983.09     -1.5            0              2.999616     
   1300000   9000           100            100            0.033285956   -1.7174974e-15  0              0.099857867    0.00044513856  0              21494.148     -1.5            0              2.999617     
   1400000   9000           100            100            0.033347679   -1.7206983e-15  0              0.10004304     2.0464146e-05  0              988.14036     -1.5            0              2.9996165    
   1500000   9000           100            100            0.033321877   -1.7193643e-15  0              0.099965632    1.4768144e-07  0              7.131008      -1.5            0              2.9996167    
   1600000   9000           100            100            0.033331611   -1.7198663e-15  0              0.099994832    1.0149512e-07  0              4.9008363     -1.5            0              2.9996166    
   1700000   9000           100            100            0.033328262   -1.719694e-15   0              0.099984787    7.1631466e-08  0              3.4588271     -1.5            0              2.9996167    
   1800000   9000           100            100            0.033329304   -1.7197475e-15  0              0.099987911    2.0262403e-08  0              0.9783989     -1.5            0              2.9996167    
   1900000   9000           100            100            0.033329021   -1.719733e-15   0              0.099987063    3.9786284e-09  0              0.19211373    -1.5            0              2.9996167    
   2000000   9000           100            100            0.033329081   -1.719736e-15   0              0.099987242    6.1987981e-10  0              0.029931777   -1.5            0              2.9996167    
   2100000   9000           100            100            0.033329076   -1.7197358e-15  0              0.099987228    7.9885596e-11  0              0.0038573895  -1.5            0              2.9996167    
   2200000   9000           100            100            0.033329072   -1.7197356e-15  0              0.099987215    8.540221e-12   0              0.00041237671 -1.5            0              2.9996167    
   2300000   9000           100            100            0.033329075   -1.7197358e-15  0              0.099987226    7.2297136e-13  0              3.49097e-05   -1.5            0              2.9996167    
   2400000   9000           100            100            0.033329073   -1.7197357e-15  0              0.09998722     4.1747028e-14  0              2.0158146e-06 -1.5            0              2.9996167    
   2500000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987223    1.0179988e-15  0              4.9155518e-08 -1.5            0              2.9996167    
   2600000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987222    2.0158361e-19  0              9.7337509e-12 -1.5            0              2.9996167    
   2700000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987222    2.060641e-16   0              9.9500979e-09 -1.5            0              2.9996167    
   2800000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987222    3.5036821e-17  0              1.6918027e-09 -1.5            0              2.9996167    
   2900000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987222    2.124537e-17   0              1.0258629e-09 -1.5            0              2.9996167    
   3000000   9000           100            100            0.033329074   -1.7197357e-15  0              0.099987222    6.7781717e-20  0              3.2729365e-12 -1.5            0              2.9996167    
Loop time of 663.065 on 4 procs for 3000000 steps with 6000 atoms

Performance: 3909119.086 ns/day, 0.000 hours/ns, 4524.443 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 265.67     | 272.42     | 279.97     |  35.3 | 41.08
Neigh   | 1.6224     | 1.6377     | 1.6541     |   1.2 |  0.25
Comm    | 33.1       | 40.145     | 47.48      | 105.1 |  6.05
Output  | 0.43386    | 0.43418    | 0.43489    |   0.1 |  0.07
Modify  | 304.04     | 305.89     | 309.08     |  11.0 | 46.13
Other   |            | 42.54      |            |       |  6.42

Nlocal:           1500 ave        1500 max        1500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:           2250 ave        2250 max        2250 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 9000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 7:33:30

LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  #36 37 38 39 40 41 42 43 44 45

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027667831    1.862364e-21   0              0.083003492    603222.74      0              2.9127467e+13 -1.5            0              3.31347      
    200000   3000           100            100            0.010962587    2.6973679e-21  0              0.032887761    175143.05      0              8.4570313e+12 -1.5            0              3.0485291    
    300000   3000           100            100            0.0031278277   2.0148297e-21  0              0.009383483    23890.175      0              1.153571e+12  -1.5            0              3.0322114    
    400000   3000           100            100            0.036742781   -2.4034541e-18  0              0.11022834     13159.093      0              6.354055e+11  -1.5            0              2.9993192    
    500000   3000           100            100           -0.00058042712  8.9087716e-22  0             -0.0017412814   1343.2331      0              6.485992e+10  -1.5            0              3.0010469    
    600000   3000           100            100            0.046299425   -3.1382096e-18  0              0.13889827     447.3252       0              2.1599733e+10 -1.5            0              2.9991764    
    700000   3000           100            100            0.032765678   -2.2337352e-18  0              0.098297034    64.68903       0              3.1236017e+09 -1.5            0              2.9993443    
    800000   3000           100            100            0.026943286   -1.844199e-18   0              0.080829858    0.069332024    0              3347795.3     -1.5            0              2.999423     
    900000   3000           100            100            0.03175485    -2.1748041e-18  0              0.09526455     0.64367509     0              31080766      -1.5            0              2.9993559    
   1000000   3000           100            100            0.033462093   -2.2911306e-18  0              0.10038628     0.14666304     0              7081833.3     -1.5            0              2.9993331    
   1100000   3000           100            100            0.033596579   -2.3000271e-18  0              0.10078974     0.0052616973   0              254068.53     -1.5            0              2.9993314    
   1200000   3000           100            100            0.033434947   -2.2888864e-18  0              0.10030484     0.0002724971   0              13157.91      -1.5            0              2.9993336    
   1300000   3000           100            100            0.033341494   -2.2824871e-18  0              0.10002448     0.00030158547  0              14562.483     -1.5            0              2.9993348    
   1400000   3000           100            100            0.033318854   -2.2809478e-18  0              0.099956561    3.5998426e-05  0              1738.2351     -1.5            0              2.9993351    
   1500000   3000           100            100            0.033320545   -2.2810695e-18  0              0.099961634    2.8038815e-07  0              13.53894      -1.5            0              2.9993351    
   1600000   3000           100            100            0.033324338   -2.2813306e-18  0              0.099973015    2.9648325e-07  0              14.316115     -1.5            0              2.9993351    
   1700000   3000           100            100            0.033325902   -2.2814375e-18  0              0.099977707    1.0673086e-07  0              5.153651      -1.5            0              2.999335     
   1800000   3000           100            100            0.033326137   -2.2814533e-18  0              0.099978412    6.70845e-09    0              0.32392704    -1.5            0              2.999335     
   1900000   3000           100            100            0.033326041   -2.2814466e-18  0              0.099978124    2.150291e-11   0              0.0010382986  -1.5            0              2.999335     
   2000000   3000           100            100            0.033325965   -2.2814414e-18  0              0.099977894    1.696468e-10   0              0.0081916367  -1.5            0              2.999335     
   2100000   3000           100            100            0.033325942   -2.2814398e-18  0              0.099977825    3.0535807e-11  0              0.0014744649  -1.5            0              2.999335     
   2200000   3000           100            100            0.033325941   -2.2814397e-18  0              0.099977822    7.7426689e-13  0              3.7386577e-05 -1.5            0              2.999335     
   2300000   3000           100            100            0.033325943   -2.2814397e-18  0              0.09997783     9.9889443e-14  0              4.8233037e-06 -1.5            0              2.999335     
   2400000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977834    7.0220889e-14  0              3.3907154e-06 -1.5            0              2.999335     
   2500000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    6.9938875e-15  0              3.377098e-07  -1.5            0              2.999335     
   2600000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    3.3919893e-17  0              1.6378702e-09 -1.5            0              2.999335     
   2700000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    1.0293759e-16  0              4.9704878e-09 -1.5            0              2.999335     
   2800000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    2.6340297e-18  0              1.2718787e-10 -1.5            0              2.999335     
   2900000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    5.7070224e-18  0              2.7557169e-10 -1.5            0              2.999335     
   3000000   3000           100            100            0.033325945   -2.2814398e-18  0              0.099977835    9.8644164e-19  0              4.7631737e-11 -1.5            0              2.999335     
Loop time of 436.64 on 2 procs for 3000000 steps with 2000 atoms

Performance: 5936239.055 ns/day, 0.000 hours/ns, 6870.647 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 202.89     | 204.63     | 206.37     |  12.2 | 46.86
Neigh   | 0.99262    | 0.99284    | 0.99307    |   0.0 |  0.23
Comm    | 12.135     | 13.899     | 15.663     |  47.3 |  3.18
Output  | 0.28397    | 0.28404    | 0.2841     |   0.0 |  0.07
Modify  | 196.6      | 196.64     | 196.67     |   0.3 | 45.03
Other   |            | 20.2       |            |       |  4.63

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.02766831     2.6102532e-21  0              0.083004929    603238.51      0              2.9128229e+13 -1.5            0              3.3134566    
    200000   3000           100            100            0.010963661    1.9390798e-21  0              0.032890983    175169.69      0              8.4583175e+12 -1.5            0              3.0485052    
    300000   3000           100            100            0.003129594    2.2944044e-21  0              0.0093887819   23913.459      0              1.1546954e+12 -1.5            0              3.0321919    
    400000   3000           100            100            0.03962748    -2.5559955e-18  0              0.11888244     13156.634      0              6.3528677e+11 -1.5            0              2.9992828    
    500000   3000           100            100           -0.00057396027  1.1437848e-21  0             -0.0017218808   1311.8146      0              6.3342834e+10 -1.5            0              3.0010797    
    600000   3000           100            100            0.050556815   -3.3702737e-18  0              0.15167044     425.24846      0              2.0533726e+10 -1.5            0              2.9991274    
    700000   3000           100            100            0.037240295   -2.489218e-18   0              0.11172089     61.937122      0              2.9907219e+09 -1.5            0              2.9992867    
    800000   3000           100            100            0.027734706   -1.8598161e-18  0              0.083204117    2.083007       0              1.0058095e+08 -1.5            0              2.9994128    
    900000   3000           100            100            0.031016296   -2.0814804e-18  0              0.093048889    0.059893331    0              2892034.6     -1.5            0              2.999367     
   1000000   3000           100            100            0.032795932   -2.2009545e-18  0              0.098387797    0.095007527    0              4587573.5     -1.5            0              2.999343     
   1100000   3000           100            100            0.033332662   -2.236833e-18   0              0.099997987    0.019926888    0              962198.1      -1.5            0              2.9993359    
   1200000   3000           100            100            0.033399887   -2.2412181e-18  0              0.10019966     0.001540068    0              74364.37      -1.5            0              2.999335     
   1300000   3000           100            100            0.033367005   -2.2389812e-18  0              0.10010101     1.293035e-05   0              624.3603      -1.5            0              2.9993354    
   1400000   3000           100            100            0.033339475   -2.2371272e-18  0              0.10001843     9.9288111e-06  0              479.42675     -1.5            0              2.9993358    
   1500000   3000           100            100            0.0333282     -2.2363711e-18  0              0.099984599    5.1299681e-06  0              247.7078      -1.5            0              2.9993359    
   1600000   3000           100            100            0.033325441   -2.236188e-18   0              0.099976322    7.5524665e-07  0              36.468158     -1.5            0              2.999336     
   1700000   3000           100            100            0.033325366   -2.2361837e-18  0              0.099976098    3.7521403e-08  0              1.8117743     -1.5            0              2.999336     
   1800000   3000           100            100            0.033325689   -2.2362056e-18  0              0.099977066    2.5274976e-11  0              0.0012204381  -1.5            0              2.999336     
   1900000   3000           100            100            0.033325882   -2.2362186e-18  0              0.099977646    8.1169294e-10  0              0.039193747   -1.5            0              2.999336     
   2000000   3000           100            100            0.033325949   -2.236223e-18   0              0.099977847    2.4059702e-10  0              0.011617569   -1.5            0              2.999336     
   2100000   3000           100            100            0.033325961   -2.2362239e-18  0              0.099977884    2.5371514e-11  0              0.0012250996  -1.5            0              2.999336     
   2200000   3000           100            100            0.03332596    -2.2362237e-18  0              0.099977879    6.5064632e-13  0              3.1417382e-05 -1.5            0              2.999336     
   2300000   3000           100            100            0.033325957   -2.2362234e-18  0              0.099977871    4.408311e-14   0              2.1286156e-06 -1.5            0              2.999336     
   2400000   3000           100            100            0.033325956   -2.2362233e-18  0              0.099977867    5.0678427e-14  0              2.4470799e-06 -1.5            0              2.999336     
   2500000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    1.0032832e-14  0              4.8444955e-07 -1.5            0              2.999336     
   2600000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    7.7149597e-16  0              3.7252779e-08 -1.5            0              2.999336     
   2700000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    4.052032e-18   0              1.9565812e-10 -1.5            0              2.999336     
   2800000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    1.2999402e-17  0              6.2769461e-10 -1.5            0              2.999336     
   2900000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    6.3183578e-19  0              3.0509089e-11 -1.5            0              2.999336     
   3000000   3000           100            100            0.033325955   -2.2362233e-18  0              0.099977866    1.1379239e-19  0              5.4946271e-12 -1.5            0              2.999336     
Loop time of 437.181 on 2 procs for 3000000 steps with 2000 atoms

Performance: 5928896.009 ns/day, 0.000 hours/ns, 6862.148 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 205.07     | 206.55     | 208.04     |  10.4 | 47.25
Neigh   | 0.97849    | 0.97859    | 0.97869    |   0.0 |  0.22
Comm    | 12.173     | 13.681     | 15.19      |  40.8 |  3.13
Output  | 0.28023    | 0.28028    | 0.28034    |   0.0 |  0.06
Modify  | 195.12     | 195.48     | 195.83     |   2.5 | 44.71
Other   |            | 20.21      |            |       |  4.62

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 172
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027668833    1.7260041e-21  0              0.0830065      603255.69      0              2.9129058e+13 -1.5            0              3.3134424    
    200000   3000           100            100            0.010964838    2.6712663e-21  0              0.032894513    175198.89      0              8.4597272e+12 -1.5            0              3.0484788    
    300000   3000           100            100            0.0031315519   1.4821339e-21  0              0.0093946557   23939.281      0              1.1559422e+12 -1.5            0              3.0321702    
    400000   3000           100            100            0.042918196   -2.6817755e-18  0              0.12875459     13150.045      0              6.3496863e+11 -1.5            0              2.9992425    
    500000   3000           100            100           -0.00056682623  9.6017781e-22  0             -0.0017004787   1277.6328      0              6.1692317e+10 -1.5            0              3.0011154    
    600000   3000           100            100            0.055238987   -3.6010551e-18  0              0.16571696     394.57447      0              1.9052589e+10 -1.5            0              2.9990752    
    700000   3000           100            100            0.042076726   -2.7562347e-18  0              0.12623018     50.605551      0              2.4435609e+09 -1.5            0              2.999227     
    800000   3000           100            100            0.029748453   -1.9527089e-18  0              0.089245358    5.9634078      0              2.8795162e+08 -1.5            0              2.9993859    
    900000   3000           100            100            0.03119008    -2.0492566e-18  0              0.09357024     0.21453888     0              10359315      -1.5            0              2.9993658    
   1000000   3000           100            100            0.032458281   -2.1331847e-18  0              0.097374844    9.1761879e-05  0              4430.8527     -1.5            0              2.9993486    
   1100000   3000           100            100            0.033046532   -2.1718544e-18  0              0.099139595    0.0044490923   0              214830.75     -1.5            0              2.9993407    
   1200000   3000           100            100            0.033259383   -2.1858326e-18  0              0.09977815     0.0017678744   0              85364.329     -1.5            0              2.9993379    
   1300000   3000           100            100            0.033319695   -2.1897656e-18  0              0.099959086    0.0003421306   0              16520.262     -1.5            0              2.9993371    
   1400000   3000           100            100            0.033330703   -2.1904786e-18  0              0.09999211     4.1697596e-05  0              2013.4277     -1.5            0              2.9993369    
   1500000   3000           100            100            0.033329875   -2.1904189e-18  0              0.099989626    3.0598589e-06  0              147.74963     -1.5            0              2.999337     
   1600000   3000           100            100            0.03332788    -2.1902866e-18  0              0.099983641    7.9753059e-08  0              3.8509898     -1.5            0              2.999337     
   1700000   3000           100            100            0.033326693   -2.1902083e-18  0              0.09998008     2.2982886e-09  0              0.11097613    -1.5            0              2.999337     
   1800000   3000           100            100            0.033326186   -2.1901749e-18  0              0.099978557    4.6972498e-09  0              0.22681338    -1.5            0              2.999337     
   1900000   3000           100            100            0.033326013   -2.1901636e-18  0              0.099978039    1.4596248e-09  0              0.070480057   -1.5            0              2.999337     
   2000000   3000           100            100            0.033325968   -2.1901607e-18  0              0.099977903    2.4847051e-10  0              0.011997752   -1.5            0              2.999337     
   2100000   3000           100            100            0.033325961   -2.1901603e-18  0              0.099977884    2.6925626e-11  0              0.0013001421  -1.5            0              2.999337     
   2200000   3000           100            100            0.033325963   -2.1901603e-18  0              0.099977889    1.6527821e-12  0              7.9806933e-05 -1.5            0              2.999337     
   2300000   3000           100            100            0.033325965   -2.1901603e-18  0              0.099977895    2.2176639e-14  0              1.0708305e-06 -1.5            0              2.999337     
   2400000   3000           100            100            0.033325966   -2.1901604e-18  0              0.099977899    5.3619775e-15  0              2.589107e-07  -1.5            0              2.999337     
   2500000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      4.658791e-15   0              2.2495635e-07 -1.5            0              2.999337     
   2600000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      1.1256548e-15  0              5.4353841e-08 -1.5            0              2.999337     
   2700000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      1.7809078e-16  0              8.5993663e-09 -1.5            0              2.999337     
   2800000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      2.038969e-17   0              9.8454516e-10 -1.5            0              2.999337     
   2900000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      7.9426294e-18  0              3.8352115e-10 -1.5            0              2.999337     
   3000000   3000           100            100            0.033325967   -2.1901605e-18  0              0.0999779      6.5183425e-18  0              3.1474743e-10 -1.5            0              2.999337     
Loop time of 425.348 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6093831.942 ns/day, 0.000 hours/ns, 7053.046 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 196.39     | 196.6      | 196.82     |   1.5 | 46.22
Neigh   | 0.9953     | 0.99539    | 0.99548    |   0.0 |  0.23
Comm    | 12.343     | 12.547     | 12.751     |   5.8 |  2.95
Output  | 0.27735    | 0.2774     | 0.27744    |   0.0 |  0.07
Modify  | 194.78     | 194.78     | 194.79     |   0.0 | 45.79
Other   |            | 20.14      |            |       |  4.74

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027669406    2.5381575e-21  0              0.083008217    603274.53      0              2.9129968e+13 -1.5            0              3.3134263    
    200000   3000           100            100            0.010966135    1.1117781e-21  0              0.032898404    175231.06      0              8.4612809e+12 -1.5            0              3.0484496    
    300000   3000           100            100            0.0031336768   2.3248327e-21  0              0.0094010304   23967.316      0              1.1572959e+12 -1.5            0              3.0321467    
    400000   3000           100            100            0.04659533    -2.8928102e-18  0              0.13978599     13138.241      0              6.3439863e+11 -1.5            0              2.9991989    
    500000   3000           100            100           -0.00055908359  1.376565e-21   0             -0.0016772508   1241.1002      0              5.9928286e+10 -1.5            0              3.0011536    
    600000   3000           100            100            0.060260657   -3.8535161e-18  0              0.18078197     354.64153      0              1.712437e+10  -1.5            0              2.9990211    
    700000   3000           100            100            0.046752127   -3.0010407e-18  0              0.14025638     32.01224       0              1.5457565e+09 -1.5            0              2.9991717    
    800000   3000           100            100            0.032879809   -2.1128229e-18  0              0.098639428    8.5700911      0              4.1381903e+08 -1.5            0              2.9993447    
    900000   3000           100            100            0.03245129    -2.0873935e-18  0              0.097353869    0.98455634     0              47540702      -1.5            0              2.99935      
   1000000   3000           100            100            0.032821473   -2.1118086e-18  0              0.09846442     0.099657648    0              4812111.1     -1.5            0              2.9993449    
   1100000   3000           100            100            0.033086725   -2.1291508e-18  0              0.099260174    0.0085106286   0              410947.8      -1.5            0              2.9993413    
   1200000   3000           100            100            0.03322357    -2.1380098e-18  0              0.099670711    0.00055061603  0              26587.277     -1.5            0              2.9993395    
   1300000   3000           100            100            0.033285224   -2.1420013e-18  0              0.099855671    1.91984e-05    0              927.02201     -1.5            0              2.9993387    
   1400000   3000           100            100            0.033310713   -2.1436439e-18  0              0.099932139    5.8240967e-11  0              0.0028122478  -1.5            0              2.9993383    
   1500000   3000           100            100            0.033320578   -2.1442797e-18  0              0.099961733    3.4265145e-07  0              16.545412     -1.5            0              2.9993382    
   1600000   3000           100            100            0.03332418    -2.1445114e-18  0              0.09997254     1.7052221e-07  0              8.2339071     -1.5            0              2.9993382    
   1700000   3000           100            100            0.033325422   -2.1445912e-18  0              0.099976265    4.6029031e-08  0              2.2225772     -1.5            0              2.9993381    
   1800000   3000           100            100            0.033325823   -2.1446169e-18  0              0.099977469    9.4217249e-09  0              0.45494137    -1.5            0              2.9993381    
   1900000   3000           100            100            0.033325943   -2.1446245e-18  0              0.099977828    1.6196232e-09  0              0.078205808   -1.5            0              2.9993381    
   2000000   3000           100            100            0.033325974   -2.1446265e-18  0              0.099977922    2.4375647e-10  0              0.011770128   -1.5            0              2.9993381    
   2100000   3000           100            100            0.03332598    -2.1446269e-18  0              0.099977941    3.2665568e-11  0              0.0015773034  -1.5            0              2.9993381    
   2200000   3000           100            100            0.033325981   -2.1446269e-18  0              0.099977942    3.898482e-12   0              0.00018824374 -1.5            0              2.9993381    
   2300000   3000           100            100            0.03332598    -2.1446268e-18  0              0.09997794     4.0951552e-13  0              1.9774039e-05 -1.5            0              2.9993381    
   2400000   3000           100            100            0.03332598    -2.1446267e-18  0              0.099977939    3.6941623e-14  0              1.7837787e-06 -1.5            0              2.9993381    
   2500000   3000           100            100            0.033325979   -2.1446267e-18  0              0.099977938    2.5323877e-15  0              1.2227994e-07 -1.5            0              2.9993381    
   2600000   3000           100            100            0.033325979   -2.1446266e-18  0              0.099977938    1.4061695e-16  0              6.7898893e-09 -1.5            0              2.9993381    
   2700000   3000           100            100            0.033325979   -2.1446266e-18  0              0.099977938    1.3102631e-18  0              6.3267918e-11 -1.5            0              2.9993381    
   2800000   3000           100            100            0.033325979   -2.1446266e-18  0              0.099977938    1.8933517e-17  0              9.1423179e-10 -1.5            0              2.9993381    
   2900000   3000           100            100            0.033325979   -2.1446266e-18  0              0.099977938    5.2795924e-18  0              2.5493262e-10 -1.5            0              2.9993381    
   3000000   3000           100            100            0.033325979   -2.1446266e-18  0              0.099977938    2.6476041e-18  0              1.2784332e-10 -1.5            0              2.9993381    
Loop time of 427.878 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6057807.628 ns/day, 0.000 hours/ns, 7011.351 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.04     | 198.57     | 199.1      |   3.7 | 46.41
Neigh   | 1.0049     | 1.005      | 1.0051     |   0.0 |  0.23
Comm    | 12.465     | 13.004     | 13.543     |  14.9 |  3.04
Output  | 0.27852    | 0.27857    | 0.27862    |   0.0 |  0.07
Modify  | 194.58     | 194.65     | 194.72     |   0.5 | 45.49
Other   |            | 20.37      |            |       |  4.76

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027670023    1.0832583e-21  0              0.083010069    603294.79      0              2.9130946e+13 -1.5            0              3.3134094    
    200000   3000           100            100            0.010967516    3.5315237e-21  0              0.032902547    175265.32      0              8.4629351e+12 -1.5            0              3.0484188    
    300000   3000           100            100            0.0031359659   2.1804009e-21  0              0.0094078977   23997.531      0              1.1587549e+12 -1.5            0              3.0321213    
    400000   3000           100            100            0.050711204   -3.0763943e-18  0              0.15213361     13119.739      0              6.3350526e+11 -1.5            0              2.9991516    
    500000   3000           100            100           -0.00055067404  1.0100602e-21  0             -0.0016520221   1202.0842      0              5.8044343e+10 -1.5            0              3.0011944    
    600000   3000           100            100            0.065529053   -4.0992542e-18  0              0.19658716     305.33761      0              1.474366e+10  -1.5            0              2.9989662    
    700000   3000           100            100            0.050496887   -3.1747566e-18  0              0.15149066     12.048551      0              5.817814e+08  -1.5            0              2.9991291    
    800000   3000           100            100            0.036502904   -2.2957597e-18  0              0.10950871     6.6879354      0              3.2293646e+08 -1.5            0              2.9992986    
    900000   3000           100            100            0.03434013    -2.1617777e-18  0              0.10302039     0.94221332     0              45496109      -1.5            0              2.9993262    
   1000000   3000           100            100            0.03369695    -2.1218644e-18  0              0.10109085     0.124307       0              6002340.3     -1.5            0              2.9993345    
   1100000   3000           100            100            0.033463779   -2.1073979e-18  0              0.10039134     0.016295012    0              786827.81     -1.5            0              2.9993376    
   1200000   3000           100            100            0.033377188   -2.1020518e-18  0              0.10013156     0.0021350861   0              103095.67     -1.5            0              2.9993387    
   1300000   3000           100            100            0.033344999   -2.1000509e-18  0              0.100035       0.00027974084  0              13507.684     -1.5            0              2.9993391    
   1400000   3000           100            100            0.033333044   -2.0993091e-18  0              0.099999133    3.6646839e-05  0              1769.5447     -1.5            0              2.9993393    
   1500000   3000           100            100            0.033328607   -2.0990348e-18  0              0.099985822    4.7998497e-06  0              231.76756     -1.5            0              2.9993393    
   1600000   3000           100            100            0.033326962   -2.0989326e-18  0              0.099980885    6.2851345e-07  0              30.348665     -1.5            0              2.9993393    
   1700000   3000           100            100            0.033326352   -2.0988948e-18  0              0.099979055    8.2280141e-08  0              3.9730136     -1.5            0              2.9993393    
   1800000   3000           100            100            0.033326126   -2.0988808e-18  0              0.099978377    1.0768764e-08  0              0.51998508    -1.5            0              2.9993393    
   1900000   3000           100            100            0.033326042   -2.0988756e-18  0              0.099978126    1.4090625e-09  0              0.068038585   -1.5            0              2.9993393    
   2000000   3000           100            100            0.033326011   -2.0988737e-18  0              0.099978033    1.8431262e-10  0              0.0088997966  -1.5            0              2.9993393    
   2100000   3000           100            100            0.033325999   -2.098873e-18   0              0.099977998    2.4110594e-11  0              0.0011642143  -1.5            0              2.9993393    
   2200000   3000           100            100            0.033325995   -2.0988727e-18  0              0.099977986    3.1526918e-12  0              0.0001522322  -1.5            0              2.9993393    
   2300000   3000           100            100            0.033325994   -2.0988726e-18  0              0.099977981    4.1165796e-13  0              1.987749e-05  -1.5            0              2.9993393    
   2400000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977979    5.3842469e-14  0              2.5998601e-06 -1.5            0              2.9993393    
   2500000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    7.020463e-15   0              3.3899303e-07 -1.5            0              2.9993393    
   2600000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    8.6045296e-16  0              4.1548194e-08 -1.5            0              2.9993393    
   2700000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    1.3064986e-16  0              6.3086144e-09 -1.5            0              2.9993393    
   2800000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    9.477332e-18   0              4.5762645e-10 -1.5            0              2.9993393    
   2900000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    3.4806195e-18  0              1.6806666e-10 -1.5            0              2.9993393    
   3000000   3000           100            100            0.033325993   -2.0988724e-18  0              0.099977978    1.3239807e-18  0              6.3930291e-11 -1.5            0              2.9993393    
Loop time of 429.688 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6032285.364 ns/day, 0.000 hours/ns, 6981.812 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.81     | 200.15     | 201.48     |   9.4 | 46.58
Neigh   | 1.0037     | 1.0037     | 1.0038     |   0.0 |  0.23
Comm    | 12.358     | 13.675     | 14.993     |  35.6 |  3.18
Output  | 0.2813     | 0.28135    | 0.28141    |   0.0 |  0.07
Modify  | 194.44     | 194.45     | 194.46     |   0.1 | 45.25
Other   |            | 20.13      |            |       |  4.68

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027670687    1.6881595e-21  0              0.083012061    603316.59      0              2.9131999e+13 -1.5            0              3.3133912    
    200000   3000           100            100            0.010969004    1.1689867e-21  0              0.032907012    175302.24      0              8.464718e+12  -1.5            0              3.0483855    
    300000   3000           100            100            0.0031384243   2.207435e-21   0              0.0094152728   24029.995      0              1.1603225e+12 -1.5            0              3.032094     
    400000   3000           100            100            0.055259432   -3.3498776e-18  0              0.1657783      13093.219      0              6.3222466e+11 -1.5            0              2.9991011    
    500000   3000           100            100           -0.0005416497   9.6256481e-22  0             -0.0016249491   1160.9802      0              5.605958e+10  -1.5            0              3.0012375    
    600000   3000           100            100            0.070870144   -4.3376128e-18  0              0.21261043     248.02199      0              1.1976094e+10 -1.5            0              2.9989123    
    700000   3000           100            100            0.052372102   -3.2218925e-18  0              0.15711631     0.45489529     0              21965266      -1.5            0              2.9991088    
    800000   3000           100            100            0.03936026    -2.4210369e-18  0              0.11808078     1.7148923      0              82806009      -1.5            0              2.9992635    
    900000   3000           100            100            0.035666775   -2.195018e-18   0              0.10700033     0.076704255    0              3703774       -1.5            0              2.9993102    
   1000000   3000           100            100            0.034202688   -2.1052953e-18  0              0.10260806     5.1232096e-06  0              247.38146     -1.5            0              2.9993291    
   1100000   3000           100            100            0.033631499   -2.0701782e-18  0              0.1008945      0.0015458925   0              74645.614     -1.5            0              2.9993366    
   1200000   3000           100            100            0.033423949   -2.0573903e-18  0              0.10027185     0.00074351056  0              35901.464     -1.5            0              2.9993393    
   1300000   3000           100            100            0.033354144   -2.0530838e-18  0              0.10006243     0.0001927578   0              9307.5841     -1.5            0              2.9993403    
   1400000   3000           100            100            0.033332739   -2.0517596e-18  0              0.099998218    3.7315315e-05  0              1801.823      -1.5            0              2.9993406    
   1500000   3000           100            100            0.033326995   -2.0514026e-18  0              0.099980985    5.9432027e-06  0              286.97599     -1.5            0              2.9993406    
   1600000   3000           100            100            0.033325807   -2.051328e-18   0              0.099977422    8.0593979e-07  0              38.915948     -1.5            0              2.9993406    
   1700000   3000           100            100            0.033325737   -2.0513232e-18  0              0.09997721     9.3426038e-08  0              4.511209      -1.5            0              2.9993407    
   1800000   3000           100            100            0.033325844   -2.0513296e-18  0              0.099977533    9.0450849e-09  0              0.43675478    -1.5            0              2.9993406    
   1900000   3000           100            100            0.033325929   -2.0513347e-18  0              0.099977787    6.8163224e-10  0              0.032913581   -1.5            0              2.9993406    
   2000000   3000           100            100            0.033325974   -2.0513374e-18  0              0.099977922    3.2302871e-11  0              0.0015597901  -1.5            0              2.9993406    
   2100000   3000           100            100            0.033325994   -2.0513387e-18  0              0.099977983    2.7348228e-13  0              1.3205481e-05 -1.5            0              2.9993406    
   2200000   3000           100            100            0.033326003   -2.0513392e-18  0              0.099978008    1.4937592e-13  0              7.2128287e-06 -1.5            0              2.9993406    
   2300000   3000           100            100            0.033326006   -2.0513393e-18  0              0.099978017    1.1539336e-13  0              5.5719323e-06 -1.5            0              2.9993406    
   2400000   3000           100            100            0.033326007   -2.0513393e-18  0              0.09997802     3.4827629e-14  0              1.6817015e-06 -1.5            0              2.9993406    
   2500000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978021    7.2400379e-15  0              3.4959552e-07 -1.5            0              2.9993406    
   2600000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978021    1.2652671e-15  0              6.1095219e-08 -1.5            0              2.9993406    
   2700000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978022    1.7778806e-16  0              8.5847492e-09 -1.5            0              2.9993406    
   2800000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978022    1.4875731e-18  0              7.1829583e-11 -1.5            0              2.9993406    
   2900000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978022    1.0569995e-18  0              5.1038725e-11 -1.5            0              2.9993406    
   3000000   3000           100            100            0.033326007   -2.0513393e-18  0              0.099978022    2.048136e-19   0              9.8897156e-12 -1.5            0              2.9993406    
Loop time of 433.509 on 2 procs for 3000000 steps with 2000 atoms

Performance: 5979114.448 ns/day, 0.000 hours/ns, 6920.271 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 199.45     | 199.9      | 200.34     |   3.2 | 46.11
Neigh   | 1.0465     | 1.0473     | 1.0481     |   0.1 |  0.24
Comm    | 12.269     | 12.743     | 13.217     |  13.3 |  2.94
Output  | 0.2835     | 0.28356    | 0.28361    |   0.0 |  0.07
Modify  | 198.72     | 199.2      | 199.67     |   3.3 | 45.95
Other   |            | 20.34      |            |       |  4.69

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027671399    1.2283584e-21  0              0.083014196    603339.99      0              2.9133129e+13 -1.5            0              3.3133715    
    200000   3000           100            100            0.010970616    8.1518302e-22  0              0.032911848    175342.25      0              8.4666496e+12 -1.5            0              3.0483493    
    300000   3000           100            100            0.0031410948   1.8408095e-21  0              0.0094232843   24065.28       0              1.1620263e+12 -1.5            0              3.0320643    
    400000   3000           100            100            0.060358186   -3.4656836e-18  0              0.18107456     13056.231      0              6.3043866e+11 -1.5            0              2.9990464    
    500000   3000           100            100           -0.00053191676  1.1482385e-21  0             -0.0015957503   1117.5309      0              5.396157e+10  -1.5            0              3.0012831    
    600000   3000           100            100            0.076087466   -4.554243e-18   0              0.2282624      185.28104      0              8.9465583e+09 -1.5            0              2.9988614    
    700000   3000           100            100            0.051528831   -3.1004929e-18  0              0.15458649     5.8608182      0              2.8299794e+08 -1.5            0              2.9991197    
    800000   3000           100            100            0.03993526    -2.4019523e-18  0              0.11980578     0.34785427     0              16796638      -1.5            0              2.9992576    
    900000   3000           100            100            0.035201406   -2.1174477e-18  0              0.10560422     0.45383985     0              21914302      -1.5            0              2.9993174    
   1000000   3000           100            100            0.033614823   -2.0218425e-18  0              0.10084447     0.13465798     0              6502152.1     -1.5            0              2.9993382    
   1100000   3000           100            100            0.033255117   -2.0000241e-18  0              0.09976535     0.019085181    0              921555.11     -1.5            0              2.9993429    
   1200000   3000           100            100            0.03324396    -1.9992545e-18  0              0.09973188     0.001332342    0              64334.026     -1.5            0              2.9993431    
   1300000   3000           100            100            0.033284884   -2.0016777e-18  0              0.099854653    1.7382909e-05  0              839.35844     -1.5            0              2.9993426    
   1400000   3000           100            100            0.033311575   -2.0032739e-18  0              0.099934726    5.141677e-06   0              248.27318     -1.5            0              2.9993422    
   1500000   3000           100            100            0.033322581   -2.0039357e-18  0              0.099967742    3.7901685e-06  0              183.01367     -1.5            0              2.9993421    
   1600000   3000           100            100            0.033325818   -2.0041316e-18  0              0.099977453    8.0543406e-07  0              38.891528     -1.5            0              2.999342     
   1700000   3000           100            100            0.033326352   -2.0041645e-18  0              0.099979057    8.6662479e-08  0              4.184621      -1.5            0              2.999342     
   1800000   3000           100            100            0.033326252   -2.0041588e-18  0              0.099978757    3.8816005e-09  0              0.1874286     -1.5            0              2.999342     
   1900000   3000           100            100            0.03332612    -2.0041509e-18  0              0.099978361    4.0939613e-13  0              1.9768274e-05 -1.5            0              2.999342     
   2000000   3000           100            100            0.033326052   -2.0041468e-18  0              0.099978157    7.4647686e-11  0              0.0036044696  -1.5            0              2.999342     
   2100000   3000           100            100            0.033326028   -2.0041453e-18  0              0.099978084    2.7354443e-11  0              0.0013208482  -1.5            0              2.999342     
   2200000   3000           100            100            0.033326022   -2.004145e-18   0              0.099978066    4.3018793e-12  0              0.00020772235 -1.5            0              2.999342     
   2300000   3000           100            100            0.033326022   -2.0041449e-18  0              0.099978065    3.4086732e-13  0              1.6459263e-05 -1.5            0              2.999342     
   2400000   3000           100            100            0.033326022   -2.0041449e-18  0              0.099978066    7.3546688e-15  0              3.5513064e-07 -1.5            0              2.999342     
   2500000   3000           100            100            0.033326022   -2.0041449e-18  0              0.099978067    6.5563466e-16  0              3.1658251e-08 -1.5            0              2.999342     
   2600000   3000           100            100            0.033326023   -2.0041449e-18  0              0.099978068    7.8823988e-16  0              3.8061283e-08 -1.5            0              2.999342     
   2700000   3000           100            100            0.033326023   -2.0041449e-18  0              0.099978068    1.6906148e-16  0              8.163374e-09  -1.5            0              2.999342     
   2800000   3000           100            100            0.033326023   -2.0041449e-18  0              0.099978068    9.6252737e-19  0              4.6477002e-11 -1.5            0              2.999342     
   2900000   3000           100            100            0.033326023   -2.0041449e-18  0              0.099978068    2.563608e-18   0              1.2378745e-10 -1.5            0              2.999342     
   3000000   3000           100            100            0.033326023   -2.0041449e-18  0              0.099978068    2.0045375e-18  0              9.679194e-11  -1.5            0              2.999342     
Loop time of 435.881 on 2 procs for 3000000 steps with 2000 atoms

Performance: 5946574.783 ns/day, 0.000 hours/ns, 6882.610 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 194.16     | 198.2      | 202.25     |  28.7 | 45.47
Neigh   | 1.013      | 1.013      | 1.013      |   0.0 |  0.23
Comm    | 12.17      | 16.221     | 20.271     | 100.6 |  3.72
Output  | 0.28167    | 0.28173    | 0.28179    |   0.0 |  0.06
Modify  | 199.52     | 199.82     | 200.12     |   2.1 | 45.84
Other   |            | 20.34      |            |       |  4.67

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027672158    2.4023749e-21  0              0.083016475    603364.97      0              2.9134335e+13 -1.5            0              3.3133504    
    200000   3000           100            100            0.010972319    1.8641498e-21  0              0.032916958    175384.51      0              8.4686903e+12 -1.5            0              3.0483112    
    300000   3000           100            100            0.0031439042   2.2183389e-21  0              0.0094317126   24102.421      0              1.1638196e+12 -1.5            0              3.0320331    
    400000   3000           100            100            0.065913718   -3.7990078e-18  0              0.19774116     13007.818      0              6.2810099e+11 -1.5            0              2.9989888    
    500000   3000           100            100           -0.00052157166  1.011433e-21   0             -0.001564715    1072.3467      0              5.1779785e+10 -1.5            0              3.0013306    
    600000   3000           100            100            0.080883578   -4.7346878e-18  0              0.24265073     122.06017      0              5.8938487e+09 -1.5            0              2.9988161    
    700000   3000           100            100            0.047570426   -2.7963674e-18  0              0.14271128     28.151538      0              1.359337e+09  -1.5            0              2.9991667    
    800000   3000           100            100            0.03743105    -2.1986362e-18  0              0.11229315     5.3871407      0              2.6012574e+08 -1.5            0              2.9992902    
    900000   3000           100            100            0.03304342    -1.9399405e-18  0              0.099130259    1.1308583      0              54605100      -1.5            0              2.999347     
   1000000   3000           100            100            0.032604289   -1.9133009e-18  0              0.097812866    0.049020535    0              2367026.2     -1.5            0              2.999353     
   1100000   3000           100            100            0.033018381   -1.9373119e-18  0              0.099055142    0.0013425741   0              64828.097     -1.5            0              2.9993476    
   1200000   3000           100            100            0.033277016   -1.9524676e-18  0              0.099831047    0.002175511    0              105047.64     -1.5            0              2.9993442    
   1300000   3000           100            100            0.033343804   -1.9564152e-18  0              0.10003141     0.00029048816  0              14026.634     -1.5            0              2.9993433    
   1400000   3000           100            100            0.033340864   -1.9562586e-18  0              0.10002259     3.3266348e-06  0              160.63129     -1.5            0              2.9993433    
   1500000   3000           100            100            0.033330645   -1.955663e-18   0              0.099991934    1.9597047e-06  0              94.627128     -1.5            0              2.9993435    
   1600000   3000           100            100            0.033326238   -1.9554043e-18  0              0.099978715    8.0710719e-07  0              38.972318     -1.5            0              2.9993435    
   1700000   3000           100            100            0.033325523   -1.9553618e-18  0              0.099976569    5.585587e-08   0              2.6970801     -1.5            0              2.9993435    
   1800000   3000           100            100            0.033325771   -1.955376e-18   0              0.099977312    6.3932495e-11  0              0.0030870714  -1.5            0              2.9993435    
   1900000   3000           100            100            0.033325981   -1.9553883e-18  0              0.099977944    1.2274651e-09  0              0.059269895   -1.5            0              2.9993435    
   2000000   3000           100            100            0.033326048   -1.9553921e-18  0              0.099978143    2.3667887e-10  0              0.011428375   -1.5            0              2.9993435    
   2100000   3000           100            100            0.033326051   -1.9553924e-18  0              0.099978152    6.6710495e-12  0              0.00032212111 -1.5            0              2.9993435    
   2200000   3000           100            100            0.033326044   -1.955392e-18   0              0.099978131    6.8040158e-13  0              3.2854157e-05 -1.5            0              2.9993435    
   2300000   3000           100            100            0.03332604    -1.9553917e-18  0              0.099978119    5.3211991e-13  0              2.5694166e-05 -1.5            0              2.9993435    
   2400000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978117    5.4290981e-14  0              2.6215172e-06 -1.5            0              2.9993435    
   2500000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978117    1.5007545e-16  0              7.2466063e-09 -1.5            0              2.9993435    
   2600000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978117    6.6250045e-16  0              3.1989776e-08 -1.5            0              2.9993435    
   2700000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978118    1.8019776e-16  0              8.7011051e-09 -1.5            0              2.9993435    
   2800000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978118    1.1795728e-17  0              5.695735e-10  -1.5            0              2.9993435    
   2900000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978118    2.560394e-18   0              1.2363226e-10 -1.5            0              2.9993435    
   3000000   3000           100            100            0.033326039   -1.9553916e-18  0              0.099978118    5.4733762e-18  0              2.6428975e-10 -1.5            0              2.9993435    
Loop time of 429.793 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6030805.484 ns/day, 0.000 hours/ns, 6980.099 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.48     | 199.57     | 200.65     |   7.7 | 46.43
Neigh   | 1.0154     | 1.0155     | 1.0155     |   0.0 |  0.24
Comm    | 12.058     | 13.14      | 14.223     |  29.9 |  3.06
Output  | 0.28136    | 0.28141    | 0.28146    |   0.0 |  0.07
Modify  | 195.54     | 195.66     | 195.79     |   0.9 | 45.53
Other   |            | 20.12      |            |       |  4.68

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027672966    1.8351615e-21  0              0.083018897    603391.52      0              2.9135617e+13 -1.5            0              3.313328     
    200000   3000           100            100            0.010974137    9.4490889e-22  0              0.032922412    175429.63      0              8.4708688e+12 -1.5            0              3.0482704    
    300000   3000           100            100            0.0031469059   1.7363622e-21  0              0.0094407177   24142.127      0              1.1657369e+12 -1.5            0              3.0319997    
    400000   3000           100            100            0.072049637   -3.9677079e-18  0              0.21614891     12944.97       0              6.2506629e+11 -1.5            0              2.9989274    
    500000   3000           100            100           -0.0005105397   9.347042e-22   0             -0.0015316191   1025.2884      0              4.9507508e+10 -1.5            0              3.0013802    
    600000   3000           100            100            0.084938281   -4.8487771e-18  0              0.25481484     64.782874      0              3.1281331e+09 -1.5            0              2.9987792    
    700000   3000           100            100            0.040887078   -2.3481778e-18  0              0.12266123     54.384681      0              2.6260416e+09 -1.5            0              2.9992479    
    800000   3000           100            100            0.032751393   -1.8779483e-18  0              0.098254178    8.6039364      0              4.154533e+08  -1.5            0              2.999352     
    900000   3000           100            100            0.031110961   -1.781524e-18   0              0.093332883    0.17092092     0              8253159.7     -1.5            0              2.9993744    
   1000000   3000           100            100            0.032706928   -1.8720755e-18  0              0.098120784    0.075614344    0              3651146       -1.5            0              2.9993533    
   1100000   3000           100            100            0.03345416    -1.9149405e-18  0              0.10036248     0.016932417    0              817605.81     -1.5            0              2.9993435    
   1200000   3000           100            100            0.03344235    -1.9143926e-18  0              0.10032705     3.1657844e-06  0              152.8644      -1.5            0              2.9993436    
   1300000   3000           100            100            0.033340023   -1.9085556e-18  0              0.10002007     0.00031302398  0              15114.808     -1.5            0              2.9993449    
   1400000   3000           100            100            0.033314389   -1.9070764e-18  0              0.099943167    2.0023557e-05  0              966.8659      -1.5            0              2.9993453    
   1500000   3000           100            100            0.033321101   -1.9074547e-18  0              0.099963303    1.3233101e-06  0              63.89791      -1.5            0              2.9993452    
   1600000   3000           100            100            0.033326282   -1.9077513e-18  0              0.099978845    8.0749275e-07  0              38.990935     -1.5            0              2.9993451    
   1700000   3000           100            100            0.033326773   -1.9077803e-18  0              0.099980318    7.5644687e-09  0              0.36526112    -1.5            0              2.9993451    
   1800000   3000           100            100            0.033326218   -1.9077488e-18  0              0.099978653    9.1757121e-09  0              0.4430623     -1.5            0              2.9993451    
   1900000   3000           100            100            0.033326005   -1.9077366e-18  0              0.099978014    1.3701304e-09  0              0.066158693   -1.5            0              2.9993451    
   2000000   3000           100            100            0.033326022   -1.9077374e-18  0              0.099978065    7.9749185e-12  0              0.00038508027 -1.5            0              2.9993451    
   2100000   3000           100            100            0.033326054   -1.9077392e-18  0              0.099978163    3.1947193e-11  0              0.0015426156  -1.5            0              2.9993451    
   2200000   3000           100            100            0.033326061   -1.9077396e-18  0              0.099978182    1.2812759e-12  0              6.1868226e-05 -1.5            0              2.9993451    
   2300000   3000           100            100            0.033326058   -1.9077394e-18  0              0.099978174    1.9881199e-13  0              9.5999193e-06 -1.5            0              2.9993451    
   2400000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     7.2530398e-14  0              3.5022334e-06 -1.5            0              2.9993451    
   2500000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     1.4367659e-16  0              6.9376284e-09 -1.5            0              2.9993451    
   2600000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     1.0835395e-15  0              5.2320244e-08 -1.5            0              2.9993451    
   2700000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     1.1444239e-16  0              5.5260134e-09 -1.5            0              2.9993451    
   2800000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     2.150703e-17   0              1.0384975e-09 -1.5            0              2.9993451    
   2900000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     2.6389495e-18  0              1.2742543e-10 -1.5            0              2.9993451    
   3000000   3000           100            100            0.033326057   -1.9077393e-18  0              0.09997817     3.7145899e-18  0              1.7936425e-10 -1.5            0              2.9993451    
Loop time of 396.553 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6536324.013 ns/day, 0.000 hours/ns, 7565.190 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.15     | 168.18     | 168.21     |   0.2 | 42.41
Neigh   | 0.99254    | 0.99259    | 0.99264    |   0.0 |  0.25
Comm    | 12.275     | 12.351     | 12.428     |   2.2 |  3.11
Output  | 0.28322    | 0.28324    | 0.28327    |   0.0 |  0.07
Modify  | 194.56     | 194.56     | 194.56     |   0.0 | 49.06
Other   |            | 20.19      |            |       |  5.09

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027673821    2.1685957e-21  0              0.083021462    603419.62      0              2.9136974e+13 -1.5            0              3.3133044    
    200000   3000           100            100            0.010976069    2.3136197e-21  0              0.032928208    175477.58      0              8.4731845e+12 -1.5            0              3.048227     
    300000   3000           100            100            0.0031501024   1.8406066e-21  0              0.0094503073   24184.437      0              1.1677799e+12 -1.5            0              3.031964     
    400000   3000           100            100            0.078785834   -4.3571902e-18  0              0.2363575      12865.273      0              6.21218e+11   -1.5            0              2.9988623    
    500000   3000           100            100           -0.00049881691  1.5954423e-21  0             -0.0014964507   976.54842      0              4.7154028e+10 -1.5            0              3.0014317    
    600000   3000           100            100            0.087872369   -4.8896712e-18  0              0.26361711     21.526461      0              1.0394358e+09 -1.5            0              2.9987539    
    700000   3000           100            100            0.032733308   -1.8337141e-18  0              0.098199925    65.312434      0              3.1537037e+09 -1.5            0              2.9993528    
    800000   3000           100            100            0.028352388   -1.583183e-18   0              0.085057165    3.6846052      0              1.779164e+08  -1.5            0              2.9994131    
    900000   3000           100            100            0.031533886   -1.7577542e-18  0              0.094601658    0.50694072     0              24478353      -1.5            0              2.9993706    
   1000000   3000           100            100            0.033890462   -1.8894386e-18  0              0.10167139     0.090404256    0              4365298       -1.5            0              2.9993395    
   1100000   3000           100            100            0.033577876   -1.872419e-18   0              0.10073363     0.0076457684   0              369186.79     -1.5            0              2.9993435    
   1200000   3000           100            100            0.033256533   -1.854478e-18   0              0.099769598    0.0017254371   0              83315.185     -1.5            0              2.9993477    
   1300000   3000           100            100            0.033291345   -1.8563678e-18  0              0.099874036    0.00011491632  0              5548.8977     -1.5            0              2.9993472    
   1400000   3000           100            100            0.033334576   -1.8587809e-18  0              0.10000373     3.268232e-05   0              1578.1123     -1.5            0              2.9993467    
   1500000   3000           100            100            0.033330845   -1.8585802e-18  0              0.099992534    1.6992195e-06  0              82.049226     -1.5            0              2.9993467    
   1600000   3000           100            100            0.033325047   -1.8582569e-18  0              0.09997514     6.1321295e-07  0              29.609859     -1.5            0              2.9993468    
   1700000   3000           100            100            0.033325423   -1.858277e-18   0              0.099976269    2.4557388e-08  0              1.1857884     -1.5            0              2.9993468    
   1800000   3000           100            100            0.033326198   -1.8583202e-18  0              0.099978595    1.1411977e-08  0              0.55104353    -1.5            0              2.9993468    
   1900000   3000           100            100            0.033326164   -1.8583184e-18  0              0.099978492    3.453316e-10   0              0.016674827   -1.5            0              2.9993468    
   2000000   3000           100            100            0.033326061   -1.8583127e-18  0              0.099978182    2.1078606e-10  0              0.010178104   -1.5            0              2.9993468    
   2100000   3000           100            100            0.033326063   -1.8583127e-18  0              0.09997819     4.6958552e-12  0              0.00022674604 -1.5            0              2.9993468    
   2200000   3000           100            100            0.033326077   -1.8583135e-18  0              0.099978231    3.8690174e-12  0              0.00018682101 -1.5            0              2.9993468    
   2300000   3000           100            100            0.033326077   -1.8583135e-18  0              0.099978231    6.1093489e-14  0              2.949986e-06  -1.5            0              2.9993468    
   2400000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978225    7.0641754e-14  0              3.4110375e-06 -1.5            0              2.9993468    
   2500000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978225    7.4754661e-16  0              3.609635e-08  -1.5            0              2.9993468    
   2600000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978226    1.2406832e-15  0              5.9908151e-08 -1.5            0              2.9993468    
   2700000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978226    1.4461516e-17  0              6.9829487e-10 -1.5            0              2.9993468    
   2800000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978226    6.3017624e-19  0              3.0428955e-11 -1.5            0              2.9993468    
   2900000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978226    2.8800886e-18  0              1.3906917e-10 -1.5            0              2.9993468    
   3000000   3000           100            100            0.033326075   -1.8583133e-18  0              0.099978226    1.8543147e-18  0              8.9538219e-11 -1.5            0              2.9993468    
Loop time of 396.378 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6539212.317 ns/day, 0.000 hours/ns, 7568.533 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.61     | 167.8      | 167.99     |   1.4 | 42.33
Neigh   | 1.0435     | 1.0437     | 1.0439     |   0.0 |  0.26
Comm    | 12.19      | 12.447     | 12.704     |   7.3 |  3.14
Output  | 0.2797     | 0.27973    | 0.27976    |   0.0 |  0.07
Modify  | 194.59     | 194.62     | 194.65     |   0.2 | 49.10
Other   |            | 20.19      |            |       |  5.09

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027674724    1.5441968e-21  0              0.083024171    603449.3       0              2.9138407e+13 -1.5            0              3.3132795    
    200000   3000           100            100            0.010978094    1.1914051e-21  0              0.032934281    175527.82      0              8.4756104e+12 -1.5            0              3.0481817    
    300000   3000           100            100            0.0031534511   1.2627839e-21  0              0.0094603532   24228.789      0              1.1699215e+12 -1.5            0              3.0319267    
    400000   3000           100            100            0.086090649   -4.5765309e-18  0              0.25827195     12766.939      0              6.1646978e+11 -1.5            0              2.9987942    
    500000   3000           100            100           -0.00048644864  1.2098657e-21  0             -0.0014593459   926.52815      0              4.4738728e+10 -1.5            0              3.0014846    
    600000   3000           100            100            0.089288634   -4.8419307e-18  0              0.2678659      0.78940775     0              38117675      -1.5            0              2.9987433    
    700000   3000           100            100            0.024893252   -1.3574022e-18  0              0.074679756    50.877239      0              2.4566798e+09 -1.5            0              2.999462     
    800000   3000           100            100            0.026852534   -1.4558329e-18  0              0.080557601    0.093485455    0              4514078.1     -1.5            0              2.999436     
    900000   3000           100            100            0.034171717   -1.8519872e-18  0              0.10251515     1.0143239      0              48978069      -1.5            0              2.9993378    
   1000000   3000           100            100            0.034006736   -1.8443574e-18  0              0.10202021     0.0615686      0              2972927.4     -1.5            0              2.9993396    
   1100000   3000           100            100            0.033051144   -1.792414e-18   0              0.099153433    0.0054174048   0              261587.09     -1.5            0              2.9993521    
   1200000   3000           100            100            0.033302581   -1.8059121e-18  0              0.099907744    0.0025569713   0              123466.99     -1.5            0              2.9993489    
   1300000   3000           100            100            0.033368204   -1.8095149e-18  0              0.10010461     6.2723154e-06  0              302.86766     -1.5            0              2.999348     
   1400000   3000           100            100            0.033318995   -1.8068516e-18  0              0.099956984    3.7051036e-05  0              1789.0619     -1.5            0              2.9993486    
   1500000   3000           100            100            0.033322243   -1.8070206e-18  0              0.099966728    3.2658836e-06  0              157.69783     -1.5            0              2.9993486    
   1600000   3000           100            100            0.033327969   -1.8073327e-18  0              0.099983906    1.3516469e-07  0              6.5266191     -1.5            0              2.9993485    
   1700000   3000           100            100            0.033326151   -1.807235e-18   0              0.099978452    1.0781756e-07  0              5.2061242     -1.5            0              2.9993485    
   1800000   3000           100            100            0.033325833   -1.8072173e-18  0              0.0999775      9.5713803e-10  0              0.04621677    -1.5            0              2.9993485    
   1900000   3000           100            100            0.033326151   -1.8072345e-18  0              0.099978453    1.2935607e-09  0              0.062461418   -1.5            0              2.9993485    
   2000000   3000           100            100            0.033326116   -1.8072327e-18  0              0.099978348    1.6422457e-10  0              0.0079298166  -1.5            0              2.9993485    
   2100000   3000           100            100            0.033326082   -1.8072309e-18  0              0.099978247    2.74206e-12    0              0.00013240426 -1.5            0              2.9993485    
   2200000   3000           100            100            0.033326095   -1.8072315e-18  0              0.099978285    4.4032913e-12  0              0.00021261918 -1.5            0              2.9993485    
   2300000   3000           100            100            0.033326096   -1.8072316e-18  0              0.099978289    8.4160585e-14  0              4.0638134e-06 -1.5            0              2.9993485    
   2400000   3000           100            100            0.033326094   -1.8072314e-18  0              0.099978283    4.3493086e-14  0              2.1001254e-06 -1.5            0              2.9993485    
   2500000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978284    7.8051665e-15  0              3.7688356e-07 -1.5            0              2.9993485    
   2600000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978285    2.5257372e-17  0              1.2195881e-09 -1.5            0              2.9993485    
   2700000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978285    1.7650602e-16  0              8.5228441e-09 -1.5            0              2.9993485    
   2800000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978285    2.1846489e-17  0              1.0548888e-09 -1.5            0              2.9993485    
   2900000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978285    4.2833296e-19  0              2.0682666e-11 -1.5            0              2.9993485    
   3000000   3000           100            100            0.033326095   -1.8072314e-18  0              0.099978285    5.0570503e-18  0              2.4418686e-10 -1.5            0              2.9993485    
Loop time of 397.222 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6525312.164 ns/day, 0.000 hours/ns, 7552.445 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.52     | 168.76     | 169        |   1.9 | 42.49
Neigh   | 1.0081     | 1.0083     | 1.0085     |   0.0 |  0.25
Comm    | 12.233     | 12.515     | 12.797     |   8.0 |  3.15
Output  | 0.28072    | 0.28075    | 0.28079    |   0.0 |  0.07
Modify  | 194.05     | 194.07     | 194.09     |   0.1 | 48.86
Other   |            | 20.59      |            |       |  5.18

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027675676    3.4830778e-21  0              0.083027027    603480.58      0              2.9139918e+13 -1.5            0              3.3132532    
    200000   3000           100            100            0.010980238    1.8148298e-21  0              0.032940713    175581.05      0              8.4781804e+12 -1.5            0              3.0481336    
    300000   3000           100            100            0.0031569876   2.0932812e-21  0              0.0094709627   24275.662      0              1.1721848e+12 -1.5            0              3.0318872    
    400000   3000           100            100            0.094041383   -4.8865267e-18  0              0.28212415     12646.518      0              6.1065512e+11 -1.5            0              2.9987228    
    500000   3000           100            100           -0.00047338452  1.0875228e-21  0             -0.0014201535   875.24716      0              4.2262553e+10 -1.5            0              3.001539     
    600000   3000           100            100            0.088819405   -4.6791147e-18  0              0.26645821     9.6479706      0              4.6586597e+08 -1.5            0              2.9987506    
    700000   3000           100            100            0.019049631   -1.0100629e-18  0              0.057148894    21.193511      0              1.0233588e+09 -1.5            0              2.9995514    
    800000   3000           100            100            0.0295931     -1.5587262e-18  0              0.0887793      5.8823136      0              2.8403587e+08 -1.5            0              2.9994004    
    900000   3000           100            100            0.035772332   -1.8868596e-18  0              0.107317       0.003371639    0              162804.38     -1.5            0              2.999319     
   1000000   3000           100            100            0.032707731   -1.7255675e-18  0              0.098123192    0.078251793    0              3778499       -1.5            0              2.9993584    
   1100000   3000           100            100            0.033303223   -1.7565272e-18  0              0.099909668    0.020083573    0              969763.85     -1.5            0              2.9993507    
   1200000   3000           100            100            0.033418785   -1.7627906e-18  0              0.10025636     0.0009903141   0              47818.724     -1.5            0              2.9993492    
   1300000   3000           100            100            0.033284246   -1.755677e-18   0              0.099852739    1.2440761e-05  0              600.71984     -1.5            0              2.9993509    
   1400000   3000           100            100            0.033334127   -1.7582948e-18  0              0.10000238     3.4490354e-05  0              1665.4157     -1.5            0              2.9993503    
   1500000   3000           100            100            0.033327779   -1.7579683e-18  0              0.099983338    5.6493781e-06  0              272.78825     -1.5            0              2.9993504    
   1600000   3000           100            100            0.033324249   -1.75778e-18    0              0.099972748    1.395397e-07   0              6.7378729     -1.5            0              2.9993504    
   1700000   3000           100            100            0.033326799   -1.7579147e-18  0              0.099980397    1.7888887e-08  0              0.86379036    -1.5            0              2.9993504    
   1800000   3000           100            100            0.033326032   -1.7578745e-18  0              0.099978095    1.3045698e-08  0              0.62993007    -1.5            0              2.9993504    
   1900000   3000           100            100            0.033326066   -1.7578761e-18  0              0.099978197    1.413998e-09   0              0.068276905   -1.5            0              2.9993504    
   2000000   3000           100            100            0.033326151   -1.7578807e-18  0              0.099978452    9.5437111e-12  0              0.00046083165 -1.5            0              2.9993504    
   2100000   3000           100            100            0.033326105   -1.7578783e-18  0              0.099978315    1.2119524e-11  0              0.00058520844 -1.5            0              2.9993504    
   2200000   3000           100            100            0.033326116   -1.7578788e-18  0              0.099978348    4.3937288e-12  0              0.00021215744 -1.5            0              2.9993504    
   2300000   3000           100            100            0.033326117   -1.7578788e-18  0              0.09997835     3.0752198e-13  0              1.4849136e-05 -1.5            0              2.9993504    
   2400000   3000           100            100            0.033326115   -1.7578786e-18  0              0.099978345    6.6569496e-17  0              3.2144027e-09 -1.5            0              2.9993504    
   2500000   3000           100            100            0.033326116   -1.7578787e-18  0              0.099978347    6.1082566e-15  0              2.9494585e-07 -1.5            0              2.9993504    
   2600000   3000           100            100            0.033326116   -1.7578787e-18  0              0.099978347    1.3385927e-15  0              6.4635853e-08 -1.5            0              2.9993504    
   2700000   3000           100            100            0.033326115   -1.7578786e-18  0              0.099978346    7.7740332e-17  0              3.7538024e-09 -1.5            0              2.9993504    
   2800000   3000           100            100            0.033326116   -1.7578787e-18  0              0.099978347    7.4322341e-18  0              3.5887599e-10 -1.5            0              2.9993504    
   2900000   3000           100            100            0.033326116   -1.7578787e-18  0              0.099978347    6.4710523e-18  0              3.1246396e-10 -1.5            0              2.9993504    
   3000000   3000           100            100            0.033326116   -1.7578787e-18  0              0.099978347    4.7936734e-18  0              2.3146933e-10 -1.5            0              2.9993504    
Loop time of 394.504 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6570275.087 ns/day, 0.000 hours/ns, 7604.485 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.01     | 167.22     | 167.43     |   1.6 | 42.39
Neigh   | 0.9984     | 0.99872    | 0.99905    |   0.0 |  0.25
Comm    | 11.881     | 12.096     | 12.31      |   6.2 |  3.07
Output  | 0.27841    | 0.27844    | 0.27846    |   0.0 |  0.07
Modify  | 193.88     | 193.92     | 193.96     |   0.3 | 49.15
Other   |            | 20         |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027676676    3.0658291e-21  0              0.083030027    603513.43      0              2.9141504e+13 -1.5            0              3.3132258    
    200000   3000           100            100            0.010982482    3.7563862e-21  0              0.032947446    175636.76      0              8.4808705e+12 -1.5            0              3.0480833    
    300000   3000           100            100            0.0031607094   1.8838149e-21  0              0.0094821283   24325.028      0              1.1745685e+12 -1.5            0              3.0318456    
    400000   3000           100            100            0.1026767     -5.1459802e-18  0              0.30803009     12500.735      0              6.0361573e+11 -1.5            0              2.9986478    
    500000   3000           100            100           -0.00045961104  7.5592486e-22  0             -0.0013788331   822.89689      0              3.9734746e+10 -1.5            0              3.0015946    
    600000   3000           100            100            0.086165862   -4.4192768e-18  0              0.25849759     51.795722      0              2.50103e+09   -1.5            0              2.9987787    
    700000   3000           100            100            0.016340537   -8.3762705e-19  0              0.049021611    0.87763434     0              42377821      -1.5            0              2.999597     
    800000   3000           100            100            0.035449878   -1.8110012e-18  0              0.10634963     7.8718039      0              3.8010124e+08 -1.5            0              2.9993257    
    900000   3000           100            100            0.033741655   -1.7275276e-18  0              0.10122496     1.1194636      0              54054891      -1.5            0              2.9993467    
   1000000   3000           100            100            0.03280765    -1.6783875e-18  0              0.098422949    0.099838269    0              4820832.7     -1.5            0              2.9993592    
   1100000   3000           100            100            0.033607402   -1.7196603e-18  0              0.10082221     0.0048156398   0              232530.01     -1.5            0              2.9993487    
   1200000   3000           100            100            0.033209187   -1.6992359e-18  0              0.09962756     1.5454496e-05  0              746.24231     -1.5            0              2.9993539    
   1300000   3000           100            100            0.033366211   -1.7072606e-18  0              0.10009863     4.3276808e-05  0              2089.6822     -1.5            0              2.9993518    
   1400000   3000           100            100            0.033315157   -1.704661e-18   0              0.099945471    2.3670388e-05  0              1142.9583     -1.5            0              2.9993525    
   1500000   3000           100            100            0.033328086   -1.705316e-18   0              0.099984257    5.4905008e-06  0              265.11664     -1.5            0              2.9993523    
   1600000   3000           100            100            0.033326304   -1.7052279e-18  0              0.099978911    8.1672761e-07  0              39.436853     -1.5            0              2.9993523    
   1700000   3000           100            100            0.033325769   -1.7051996e-18  0              0.099977308    8.2243452e-08  0              3.971242      -1.5            0              2.9993524    
   1800000   3000           100            100            0.033326358   -1.7052301e-18  0              0.099979074    4.8723687e-09  0              0.23526925    -1.5            0              2.9993523    
   1900000   3000           100            100            0.03332604    -1.7052137e-18  0              0.09997812     6.6317464e-11  0              0.003202233   -1.5            0              2.9993523    
   2000000   3000           100            100            0.033326172   -1.7052205e-18  0              0.099978517    1.4906081e-11  0              0.00071976131 -1.5            0              2.9993523    
   2100000   3000           100            100            0.033326127   -1.7052182e-18  0              0.099978381    1.3167204e-11  0              0.00063579717 -1.5            0              2.9993523    
   2200000   3000           100            100            0.033326139   -1.7052188e-18  0              0.099978418    3.5562908e-12  0              0.00017172056 -1.5            0              2.9993523    
   2300000   3000           100            100            0.033326137   -1.7052186e-18  0              0.099978411    5.872404e-13   0              2.8355737e-05 -1.5            0              2.9993523    
   2400000   3000           100            100            0.033326137   -1.7052185e-18  0              0.099978411    6.5704624e-14  0              3.1726411e-06 -1.5            0              2.9993523    
   2500000   3000           100            100            0.033326137   -1.7052186e-18  0              0.099978412    4.5623319e-15  0              2.2029868e-07 -1.5            0              2.9993523    
   2600000   3000           100            100            0.033326137   -1.7052186e-18  0              0.099978411    1.514055e-16   0              7.3108295e-09 -1.5            0              2.9993523    
   2700000   3000           100            100            0.033326137   -1.7052185e-18  0              0.099978412    7.8180399e-19  0              3.7750517e-11 -1.5            0              2.9993523    
   2800000   3000           100            100            0.033326137   -1.7052186e-18  0              0.099978411    2.4170293e-18  0              1.1670969e-10 -1.5            0              2.9993523    
   2900000   3000           100            100            0.033326137   -1.7052185e-18  0              0.099978412    3.8591573e-18  0              1.8634489e-10 -1.5            0              2.9993523    
   3000000   3000           100            100            0.033326137   -1.7052186e-18  0              0.099978412    2.5207743e-18  0              1.2171917e-10 -1.5            0              2.9993523    
Loop time of 394.601 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6568661.281 ns/day, 0.000 hours/ns, 7602.617 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.91     | 167.45     | 167.99     |   4.2 | 42.44
Neigh   | 0.99313    | 0.99349    | 0.99386    |   0.0 |  0.25
Comm    | 11.838     | 12.363     | 12.888     |  14.9 |  3.13
Output  | 0.27979    | 0.27982    | 0.27985    |   0.0 |  0.07
Modify  | 193.46     | 193.5      | 193.54     |   0.3 | 49.04
Other   |            | 20.01      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027677726    3.9644047e-21  0              0.083033177    603547.93      0              2.9143169e+13 -1.5            0              3.3131969    
    200000   3000           100            100            0.010984844    2.6964775e-21  0              0.032954532    175695.4       0              8.4837022e+12 -1.5            0              3.0480303    
    300000   3000           100            100            0.0031646182   1.3810909e-21  0              0.0094938546   24376.912      0              1.1770739e+12 -1.5            0              3.0318019    
    400000   3000           100            100            0.11200789    -5.4971655e-18  0              0.33602367     12326.575      0              5.9520619e+11 -1.5            0              2.9985698    
    500000   3000           100            100           -0.0004451365   1.5225734e-21  0             -0.0013354095   769.76402      0              3.716915e+10  -1.5            0              3.0016513    
    600000   3000           100            100            0.081167188   -4.0396233e-18  0              0.24350156     125.26967      0              6.0488242e+09 -1.5            0              2.9988294    
    700000   3000           100            100            0.01744822    -8.6298811e-19  0              0.05234466     9.7536387      0              4.7096831e+08 -1.5            0              2.9995815    
    800000   3000           100            100            0.039943109   -1.9802696e-18  0              0.11982933     0.60276464     0              29105347      -1.5            0              2.9992717    
    900000   3000           100            100            0.031043669   -1.5400605e-18  0              0.093131007    0.13359872     0              6451004       -1.5            0              2.9993841    
   1000000   3000           100            100            0.034160236   -1.6941099e-18  0              0.10248071     0.019384244    0              935995.75     -1.5            0              2.9993437    
   1100000   3000           100            100            0.033023978   -1.6379664e-18  0              0.099071935    0.0025855448   0              124846.71     -1.5            0              2.9993583    
   1200000   3000           100            100            0.033436172   -1.6583292e-18  0              0.10030852     0.00034606681  0              16710.328     -1.5            0              2.999353     
   1300000   3000           100            100            0.03328617    -1.6509199e-18  0              0.09985851     4.6098051e-05  0              2225.9099     -1.5            0              2.9993549    
   1400000   3000           100            100            0.033340705   -1.6536143e-18  0              0.10002211     6.1481766e-06  0              296.87344     -1.5            0              2.9993542    
   1500000   3000           100            100            0.033320871   -1.6526344e-18  0              0.099962612    8.1953977e-07  0              39.572642     -1.5            0              2.9993545    
   1600000   3000           100            100            0.033328083   -1.6529911e-18  0              0.09998425     1.0925996e-07  0              5.2757727     -1.5            0              2.9993544    
   1700000   3000           100            100            0.03332546    -1.6528615e-18  0              0.099976381    1.4565075e-08  0              0.70329533    -1.5            0              2.9993544    
   1800000   3000           100            100            0.033326414   -1.6529087e-18  0              0.099979243    1.9415633e-09  0              0.093751144   -1.5            0              2.9993544    
   1900000   3000           100            100            0.033326067   -1.6528915e-18  0              0.099978202    2.5878851e-10  0              0.012495971   -1.5            0              2.9993544    
   2000000   3000           100            100            0.033326194   -1.6528977e-18  0              0.099978581    3.4493495e-11  0              0.0016655674  -1.5            0              2.9993544    
   2100000   3000           100            100            0.033326148   -1.6528955e-18  0              0.099978443    4.5957464e-12  0              0.00022191214 -1.5            0              2.9993544    
   2200000   3000           100            100            0.033326164   -1.6528963e-18  0              0.099978493    6.1205139e-13  0              2.9553771e-05 -1.5            0              2.9993544    
   2300000   3000           100            100            0.033326158   -1.6528959e-18  0              0.099978475    8.2061645e-14  0              3.9624631e-06 -1.5            0              2.9993544    
   2400000   3000           100            100            0.03332616    -1.6528959e-18  0              0.099978481    1.1127089e-14  0              5.3728732e-07 -1.5            0              2.9993544    
   2500000   3000           100            100            0.03332616    -1.6528959e-18  0              0.099978479    1.4975261e-15  0              7.2310177e-08 -1.5            0              2.9993544    
   2600000   3000           100            100            0.03332616    -1.6528959e-18  0              0.09997848     1.5468178e-16  0              7.4690295e-09 -1.5            0              2.9993544    
   2700000   3000           100            100            0.03332616    -1.6528959e-18  0              0.09997848     1.4795021e-17  0              7.143986e-10  -1.5            0              2.9993544    
   2800000   3000           100            100            0.03332616    -1.6528959e-18  0              0.09997848     2.2499486e-18  0              1.0864196e-10 -1.5            0              2.9993544    
   2900000   3000           100            100            0.03332616    -1.6528959e-18  0              0.09997848     7.9229819e-18  0              3.8257244e-10 -1.5            0              2.9993544    
   3000000   3000           100            100            0.03332616    -1.6528959e-18  0              0.09997848     3.1944388e-19  0              1.5424802e-11 -1.5            0              2.9993544    
Loop time of 396.267 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6541049.519 ns/day, 0.000 hours/ns, 7570.659 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.34     | 168.55     | 168.75     |   1.6 | 42.53
Neigh   | 0.99854    | 0.99863    | 0.99873    |   0.0 |  0.25
Comm    | 12.401     | 12.582     | 12.762     |   5.1 |  3.18
Output  | 0.27988    | 0.27992    | 0.27996    |   0.0 |  0.07
Modify  | 193.56     | 193.64     | 193.71     |   0.6 | 48.87
Other   |            | 20.22      |            |       |  5.10

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027678826    1.5145388e-21  0              0.083036478    603584.11      0              2.9144916e+13 -1.5            0              3.3131665    
    200000   3000           100            100            0.010987316    2.0314493e-21  0              0.032961947    175756.77      0              8.4866653e+12 -1.5            0              3.047975     
    300000   3000           100            100            0.0031686969   1.745897e-21   0              0.0095060908   24431.096      0              1.1796902e+12 -1.5            0              3.0317563    
    400000   3000           100            100            0.12202696    -5.7956733e-18  0              0.36608089     12121.347      0              5.8529649e+11 -1.5            0              2.9984889    
    500000   3000           100            100           -0.00042996854  1.0773317e-21  0             -0.0012899056   716.13798      0              3.457974e+10  -1.5            0              3.0017086    
    600000   3000           100            100            0.073857941   -3.5648021e-18  0              0.22157382     221.15201      0              1.0678639e+10 -1.5            0              2.9989037    
    700000   3000           100            100            0.022922381   -1.0963967e-18  0              0.068767142    43.004221      0              2.0765199e+09 -1.5            0              2.9995002    
    800000   3000           100            100            0.038182009   -1.8371639e-18  0              0.11454603     4.3000872      0              2.0763582e+08 -1.5            0              2.999295     
    900000   3000           100            100            0.032265945   -1.5500645e-18  0              0.096797836    0.93651698     0              45221053      -1.5            0              2.9993705    
   1000000   3000           100            100            0.033325004   -1.6022451e-18  0              0.099975012    0.15339532     0              7406911.2     -1.5            0              2.9993565    
   1100000   3000           100            100            0.033466722   -1.6085493e-18  0              0.10040017     0.016555275    0              799395        -1.5            0              2.9993547    
   1200000   3000           100            100            0.033233697   -1.5975147e-18  0              0.099701091    0.0010450013   0              50459.373     -1.5            0              2.9993577    
   1300000   3000           100            100            0.033368105   -1.6039325e-18  0              0.10010432     1.7129493e-05  0              827.12189     -1.5            0              2.999356     
   1400000   3000           100            100            0.033310994   -1.6011938e-18  0              0.099932981    2.4727645e-06  0              119.40095     -1.5            0              2.9993567    
   1500000   3000           100            100            0.033330577   -1.6021367e-18  0              0.099991732    2.4876316e-06  0              120.11883     -1.5            0              2.9993565    
   1600000   3000           100            100            0.033325319   -1.6018824e-18  0              0.099975957    6.7923495e-07  0              32.797825     -1.5            0              2.9993565    
   1700000   3000           100            100            0.033326168   -1.6019242e-18  0              0.099978504    1.0932559e-07  0              5.2789414     -1.5            0              2.9993565    
   1800000   3000           100            100            0.033326308   -1.6019306e-18  0              0.099978925    1.1515605e-08  0              0.55604737    -1.5            0              2.9993565    
   1900000   3000           100            100            0.033326104   -1.6019209e-18  0              0.099978312    7.0042344e-10  0              0.033820941   -1.5            0              2.9993565    
   2000000   3000           100            100            0.033326219   -1.6019264e-18  0              0.099978658    9.7113367e-12  0              0.00046892569 -1.5            0              2.9993565    
   2100000   3000           100            100            0.033326171   -1.601924e-18   0              0.099978513    2.1429102e-12  0              0.00010347346 -1.5            0              2.9993565    
   2200000   3000           100            100            0.033326187   -1.6019247e-18  0              0.099978562    1.8765473e-12  0              9.0611754e-05 -1.5            0              2.9993565    
   2300000   3000           100            100            0.033326183   -1.6019246e-18  0              0.099978549    4.9542518e-13  0              2.3922309e-05 -1.5            0              2.9993565    
   2400000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    7.7754188e-14  0              3.7544715e-06 -1.5            0              2.9993565    
   2500000   3000           100            100            0.033326184   -1.6019246e-18  0              0.099978551    7.945198e-15   0              3.8364518e-07 -1.5            0              2.9993565    
   2600000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    4.0133846e-16  0              1.9379198e-08 -1.5            0              2.9993565    
   2700000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    6.0665781e-19  0              2.9293335e-11 -1.5            0              2.9993565    
   2800000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    1.7144946e-17  0              8.2786808e-10 -1.5            0              2.9993565    
   2900000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    5.2382248e-18  0              2.5293513e-10 -1.5            0              2.9993565    
   3000000   3000           100            100            0.033326184   -1.6019245e-18  0              0.099978551    2.4388498e-18  0              1.1776333e-10 -1.5            0              2.9993565    
Loop time of 395.574 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6552497.976 ns/day, 0.000 hours/ns, 7583.910 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.03     | 168.24     | 168.45     |   1.6 | 42.53
Neigh   | 1.0129     | 1.0132     | 1.0135     |   0.0 |  0.26
Comm    | 12.181     | 12.39      | 12.6       |   6.0 |  3.13
Output  | 0.27663    | 0.27666    | 0.27669    |   0.0 |  0.07
Modify  | 193.63     | 193.66     | 193.69     |   0.2 | 48.96
Other   |            | 20         |            |       |  5.05

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027679977    2.2563159e-21  0              0.083039932    603621.98      0              2.9146745e+13 -1.5            0              3.3131344    
    200000   3000           100            100            0.010989913    2.002815e-21   0              0.032969738    175821.27      0              8.4897797e+12 -1.5            0              3.0479166    
    300000   3000           100            100            0.0031729921   1.2808351e-21  0              0.0095189764   24488.205      0              1.1824478e+12 -1.5            0              3.0317081    
    400000   3000           100            100            0.13283937    -6.1795802e-18  0              0.39851812     11879.659      0              5.7362622e+11 -1.5            0              2.9984047    
    500000   3000           100            100           -0.00041404565  1.4740245e-21  0             -0.0012421369   662.0828       0              3.1969609e+10 -1.5            0              3.0017666    
    600000   3000           100            100            0.064495552   -3.0168175e-18  0              0.19348665     324.08132      0              1.5648727e+10 -1.5            0              2.9990011    
    700000   3000           100            100            0.032653817   -1.511782e-18   0              0.097961452    65.93288       0              3.1836628e+09 -1.5            0              2.9993692    
    800000   3000           100            100            0.031423082   -1.4645084e-18  0              0.094269247    8.0760127      0              3.8996175e+08 -1.5            0              2.9993828    
    900000   3000           100            100            0.035531355   -1.6523013e-18  0              0.10659406     0.24150563     0              11661443      -1.5            0              2.9993309    
   1000000   3000           100            100            0.032523458   -1.5128635e-18  0              0.097570374    0.028534717    0              1377839.4     -1.5            0              2.9993691    
   1100000   3000           100            100            0.03338842    -1.5533211e-18  0              0.10016526     0.019576681    0              945287.88     -1.5            0              2.9993579    
   1200000   3000           100            100            0.033405507   -1.5539536e-18  0              0.10021652     0.0014942793   0              72153.402     -1.5            0              2.9993578    
   1300000   3000           100            100            0.033283351   -1.5483136e-18  0              0.099850052    2.7895298e-06  0              134.69641     -1.5            0              2.9993593    
   1400000   3000           100            100            0.033334397   -1.5506909e-18  0              0.10000319     3.4165316e-05  0              1649.7208     -1.5            0              2.9993587    
   1500000   3000           100            100            0.033328313   -1.5504014e-18  0              0.099984939    5.4158076e-06  0              261.50997     -1.5            0              2.9993587    
   1600000   3000           100            100            0.033324207   -1.5502132e-18  0              0.09997262     5.7965715e-08  0              2.7989569     -1.5            0              2.9993588    
   1700000   3000           100            100            0.033326803   -1.5503338e-18  0              0.099980408    4.1266558e-08  0              1.9926144     -1.5            0              2.9993588    
   1800000   3000           100            100            0.033326214   -1.5503062e-18  0              0.099978643    1.4506529e-08  0              0.70046836    -1.5            0              2.9993588    
   1900000   3000           100            100            0.033326127   -1.5503023e-18  0              0.099978381    6.5613944e-10  0              0.031682625   -1.5            0              2.9993588    
   2000000   3000           100            100            0.033326243   -1.5503076e-18  0              0.099978729    2.2831892e-11  0              0.0011024703  -1.5            0              2.9993588    
   2100000   3000           100            100            0.033326204   -1.5503058e-18  0              0.099978612    2.9968637e-11  0              0.0014470782  -1.5            0              2.9993588    
   2200000   3000           100            100            0.033326206   -1.5503059e-18  0              0.099978617    3.0784131e-12  0              0.00014864555 -1.5            0              2.9993588    
   2300000   3000           100            100            0.03332621    -1.550306e-18   0              0.099978631    1.567496e-15   0              7.5688771e-08 -1.5            0              2.9993588    
   2400000   3000           100            100            0.033326208   -1.5503059e-18  0              0.099978624    4.6550087e-14  0              2.2477371e-06 -1.5            0              2.9993588    
   2500000   3000           100            100            0.033326208   -1.5503059e-18  0              0.099978625    9.755427e-15   0              4.7105466e-07 -1.5            0              2.9993588    
   2600000   3000           100            100            0.033326209   -1.5503059e-18  0              0.099978626    1.6140184e-16  0              7.7935171e-09 -1.5            0              2.9993588    
   2700000   3000           100            100            0.033326208   -1.5503059e-18  0              0.099978625    7.0436669e-17  0              3.4011347e-09 -1.5            0              2.9993588    
   2800000   3000           100            100            0.033326208   -1.5503059e-18  0              0.099978625    4.8793419e-18  0              2.3560596e-10 -1.5            0              2.9993588    
   2900000   3000           100            100            0.033326208   -1.5503059e-18  0              0.099978625    4.3284083e-19  0              2.0900334e-11 -1.5            0              2.9993588    
   3000000   3000           100            100            0.033326208   -1.5503058e-18  0              0.099978625    7.3755103e-18  0              3.56137e-10   -1.5            0              2.9993588    
Loop time of 395.615 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6551826.728 ns/day, 0.000 hours/ns, 7583.133 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.04     | 167.44     | 167.84     |   3.1 | 42.32
Neigh   | 1.0181     | 1.0187     | 1.0192     |   0.1 |  0.26
Comm    | 11.846     | 12.229     | 12.612     |  10.9 |  3.09
Output  | 0.27851    | 0.27854    | 0.27858    |   0.0 |  0.07
Modify  | 194.68     | 194.7      | 194.71     |   0.1 | 49.21
Other   |            | 19.95      |            |       |  5.04

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027681178    3.3206503e-21  0              0.083043534    603661.42      0              2.914865e+13  -1.5            0              3.3131015    
    200000   3000           100            100            0.010992612    1.7470156e-21  0              0.032977835    175888.3       0              8.4930163e+12 -1.5            0              3.047856     
    300000   3000           100            100            0.0031774609   1.9165266e-21  0              0.0095323827   24547.672      0              1.1853192e+12 -1.5            0              3.0316579    
    400000   3000           100            100            0.14438447    -6.5007365e-18  0              0.43315341     11599.652      0              5.6010567e+11 -1.5            0              2.998318     
    500000   3000           100            100           -0.00039739981  1.5483584e-21  0             -0.0011921994   608.00406      0              2.935834e+10  -1.5            0              3.0018249    
    600000   3000           100            100            0.053604446   -2.4297234e-18  0              0.16081334     414.37901      0              2.0008879e+10 -1.5            0              2.9991192    
    700000   3000           100            100            0.044225385   -1.9798051e-18  0              0.13267616     45.018571      0              2.1737857e+09 -1.5            0              2.9992298    
    800000   3000           100            100            0.026821843   -1.2056956e-18  0              0.08046553     0.28947187     0              13977560      -1.5            0              2.9994471    
    900000   3000           100            100            0.034309994   -1.541985e-18   0              0.10292998     0.97569541     0              47112840      -1.5            0              2.9993484    
   1000000   3000           100            100            0.034080705   -1.5306592e-18  0              0.10224211     0.045899989    0              2216346.2     -1.5            0              2.9993515    
   1100000   3000           100            100            0.033111926   -1.4873166e-18  0              0.099335779    0.011496739    0              555136.37     -1.5            0              2.9993639    
   1200000   3000           100            100            0.033248857   -1.493578e-18   0              0.099746571    0.0015609454   0              75372.467     -1.5            0              2.9993621    
   1300000   3000           100            100            0.033362653   -1.4986573e-18  0              0.10008796     0.00010198219  0              4924.3548     -1.5            0              2.9993606    
   1400000   3000           100            100            0.033332694   -1.4973007e-18  0              0.099998081    3.9461527e-05  0              1905.4559     -1.5            0              2.999361     
   1500000   3000           100            100            0.033320742   -1.4967692e-18  0              0.099962225    4.6813727e-07  0              22.604674     -1.5            0              2.9993612    
   1600000   3000           100            100            0.03332595    -1.4970043e-18  0              0.099977849    8.1505451e-07  0              39.356065     -1.5            0              2.9993611    
   1700000   3000           100            100            0.033326991   -1.4970503e-18  0              0.099980973    1.032539e-11   0              0.00049857614 -1.5            0              2.9993611    
   1800000   3000           100            100            0.033326193   -1.4970144e-18  0              0.09997858     1.4208363e-08  0              0.68607099    -1.5            0              2.9993611    
   1900000   3000           100            100            0.033326138   -1.4970121e-18  0              0.099978415    1.6409801e-10  0              0.0079237054  -1.5            0              2.9993611    
   2000000   3000           100            100            0.03332625    -1.4970171e-18  0              0.099978749    2.0885714e-10  0              0.010084964   -1.5            0              2.9993611    
   2100000   3000           100            100            0.033326245   -1.4970169e-18  0              0.099978736    1.0215693e-11  0              0.00049327928 -1.5            0              2.9993611    
   2200000   3000           100            100            0.033326231   -1.4970163e-18  0              0.099978693    2.5035959e-12  0              0.00012088968 -1.5            0              2.9993611    
   2300000   3000           100            100            0.033326233   -1.4970163e-18  0              0.099978699    3.4553271e-13  0              1.6684538e-05 -1.5            0              2.9993611    
   2400000   3000           100            100            0.033326235   -1.4970163e-18  0              0.099978705    2.2298149e-14  0              1.0766978e-06 -1.5            0              2.9993611    
   2500000   3000           100            100            0.033326234   -1.4970163e-18  0              0.099978703    8.6661277e-15  0              4.1845629e-07 -1.5            0              2.9993611    
   2600000   3000           100            100            0.033326234   -1.4970163e-18  0              0.099978703    1.2666795e-16  0              6.1163419e-09 -1.5            0              2.9993611    
   2700000   3000           100            100            0.033326234   -1.4970163e-18  0              0.099978703    1.7478998e-16  0              8.4399826e-09 -1.5            0              2.9993611    
   2800000   3000           100            100            0.033326234   -1.4970163e-18  0              0.099978703    1.6085313e-17  0              7.7670218e-10 -1.5            0              2.9993611    
   2900000   3000           100            100            0.033326234   -1.4970162e-18  0              0.099978703    3.7038946e-19  0              1.7884781e-11 -1.5            0              2.9993611    
   3000000   3000           100            100            0.033326234   -1.4970163e-18  0              0.099978703    5.4559343e-19  0              2.6344754e-11 -1.5            0              2.9993611    
Loop time of 396.418 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6538546.788 ns/day, 0.000 hours/ns, 7567.762 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.36     | 168.62     | 168.88     |   2.0 | 42.54
Neigh   | 1.0204     | 1.0205     | 1.0207     |   0.0 |  0.26
Comm    | 12.258     | 12.538     | 12.817     |   7.9 |  3.16
Output  | 0.2781     | 0.27813    | 0.27816    |   0.0 |  0.07
Modify  | 193.64     | 193.65     | 193.66     |   0.1 | 48.85
Other   |            | 20.31      |            |       |  5.12

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.02768243     3.2340494e-21  0              0.083047291    603702.6       0              2.9150638e+13 -1.5            0              3.3130669    
    200000   3000           100            100            0.01099543     3.2890637e-21  0              0.03298629     175958.31      0              8.496397e+12  -1.5            0              3.0477927    
    300000   3000           100            100            0.0031821348   2.9058347e-21  0              0.0095464045   24609.927      0              1.1883253e+12 -1.5            0              3.0316053    
    400000   3000           100            100            0.15671884    -6.7421128e-18  0              0.47015652     11276.634      0              5.4450828e+11 -1.5            0              2.9982286    
    500000   3000           100            100           -0.00037998958  1.5591294e-21  0             -0.0011399687   554.07539      0              2.6754318e+10 -1.5            0              3.0018833    
    600000   3000           100            100            0.041913075   -1.8313589e-18  0              0.12573923     472.89179      0              2.2834252e+10 -1.5            0              2.9992542    
    700000   3000           100            100            0.052199986   -2.2562893e-18  0              0.15659996     5.0905404      0              2.4580398e+08 -1.5            0              2.9991419    
    800000   3000           100            100            0.029544341   -1.2770324e-18  0              0.088633024    5.9636728      0              2.8796441e+08 -1.5            0              2.9994132    
    900000   3000           100            100            0.030978646   -1.3413545e-18  0              0.092935937    0.097986501    0              4731417.5     -1.5            0              2.9993937    
   1000000   3000           100            100            0.033256874   -1.4398659e-18  0              0.099770621    0.1535212      0              7412989.1     -1.5            0              2.9993643    
   1100000   3000           100            100            0.033620692   -1.4553057e-18  0              0.10086208     0.0038476499   0              185789.24     -1.5            0              2.9993598    
   1200000   3000           100            100            0.033414173   -1.4463059e-18  0              0.10024252     0.0012402196   0              59885.768     -1.5            0              2.9993624    
   1300000   3000           100            100            0.033310984   -1.4418595e-18  0              0.099932953    0.00031284903  0              15106.36      -1.5            0              2.9993637    
   1400000   3000           100            100            0.033310507   -1.4418525e-18  0              0.099931522    1.0958309e-08  0              0.52913752    -1.5            0              2.9993637    
   1500000   3000           100            100            0.033324038   -1.4424395e-18  0              0.099972114    5.3539372e-06  0              258.52246     -1.5            0              2.9993635    
   1600000   3000           100            100            0.033327748   -1.4425988e-18  0              0.099983245    4.0624888e-07  0              19.616304     -1.5            0              2.9993635    
   1700000   3000           100            100            0.033326956   -1.442564e-18   0              0.099980869    1.8123525e-08  0              0.87512016    -1.5            0              2.9993635    
   1800000   3000           100            100            0.033326252   -1.4425335e-18  0              0.099978755    1.4561247e-08  0              0.7031105     -1.5            0              2.9993635    
   1900000   3000           100            100            0.033326167   -1.4425299e-18  0              0.0999785      2.1582338e-10  0              0.010421339   -1.5            0              2.9993635    
   2000000   3000           100            100            0.033326237   -1.442533e-18   0              0.099978711    1.4448005e-10  0              0.0069764247  -1.5            0              2.9993635    
   2100000   3000           100            100            0.033326267   -1.4425343e-18  0              0.099978802    2.6884416e-11  0              0.0012981522  -1.5            0              2.9993635    
   2200000   3000           100            100            0.033326266   -1.4425343e-18  0              0.099978798    3.802262e-14   0              1.8359762e-06 -1.5            0              2.9993635    
   2300000   3000           100            100            0.033326262   -1.442534e-18   0              0.099978785    5.4614444e-13  0              2.637136e-05  -1.5            0              2.9993635    
   2400000   3000           100            100            0.033326261   -1.4425339e-18  0              0.099978782    3.0208719e-14  0              1.4586709e-06 -1.5            0              2.9993635    
   2500000   3000           100            100            0.033326261   -1.442534e-18   0              0.099978783    2.6777272e-15  0              1.2929786e-07 -1.5            0              2.9993635    
   2600000   3000           100            100            0.033326261   -1.442534e-18   0              0.099978784    1.3556799e-15  0              6.5460932e-08 -1.5            0              2.9993635    
   2700000   3000           100            100            0.033326261   -1.442534e-18   0              0.099978784    1.4195405e-17  0              6.8544528e-10 -1.5            0              2.9993635    
   2800000   3000           100            100            0.033326261   -1.4425339e-18  0              0.099978784    2.053511e-18   0              9.9156697e-11 -1.5            0              2.9993635    
   2900000   3000           100            100            0.033326261   -1.4425339e-18  0              0.099978784    2.1421538e-20  0              1.0343694e-12 -1.5            0              2.9993635    
   3000000   3000           100            100            0.033326261   -1.4425339e-18  0              0.099978784    4.3818128e-18  0              2.1158206e-10 -1.5            0              2.9993635    
Loop time of 395.149 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6559547.663 ns/day, 0.000 hours/ns, 7592.069 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.28     | 167.58     | 167.88     |   2.3 | 42.41
Neigh   | 1.0141     | 1.0146     | 1.015      |   0.0 |  0.26
Comm    | 12.252     | 12.569     | 12.886     |   8.9 |  3.18
Output  | 0.2806     | 0.28063    | 0.28066    |   0.0 |  0.07
Modify  | 193.72     | 193.74     | 193.75     |   0.1 | 49.03
Other   |            | 19.97      |            |       |  5.05

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027683736    8.8070734e-22  0              0.083051207    603745.53      0              2.9152711e+13 -1.5            0              3.3130306    
    200000   3000           100            100            0.010998383    2.3889067e-21  0              0.032995148    176031.67      0              8.4999393e+12 -1.5            0              3.0477262    
    300000   3000           100            100            0.0031870176   1.5319509e-21  0              0.0095610528   24675.027      0              1.1914688e+12 -1.5            0              3.0315503    
    400000   3000           100            100            0.16983947    -7.0646523e-18  0              0.5095184      10907.275      0              5.2667326e+11 -1.5            0              2.9981369    
    500000   3000           100            100           -0.00036181639  1.3406288e-21  0             -0.0010854492   500.6274       0              2.4173505e+10 -1.5            0              3.0019414    
    600000   3000           100            100            0.030305423   -1.2842581e-18  0              0.090916268    486.04781      0              2.3469509e+10 -1.5            0              2.9994003    
    700000   3000           100            100            0.051015178   -2.12374e-18    0              0.15304553     12.322176      0              5.949938e+08  -1.5            0              2.9991573    
    800000   3000           100            100            0.037363474   -1.5515379e-18  0              0.11209042     5.8269315      0              2.8136167e+08 -1.5            0              2.9993163    
    900000   3000           100            100            0.033076396   -1.3744558e-18  0              0.099229187    1.1555548      0              55797608      -1.5            0              2.9993694    
   1000000   3000           100            100            0.032711562   -1.3599058e-18  0              0.098134685    0.081921347    0              3955688.7     -1.5            0              2.9993739    
   1100000   3000           100            100            0.033003511   -1.3722332e-18  0              0.099010533    0.00058871225  0              28426.808     -1.5            0              2.9993701    
   1200000   3000           100            100            0.033219932   -1.3812629e-18  0              0.099659795    0.00056623217  0              27341.325     -1.5            0              2.9993674    
   1300000   3000           100            100            0.033307203   -1.3848868e-18  0              0.099921608    0.00029087582  0              14045.353     -1.5            0              2.9993663    
   1400000   3000           100            100            0.033329277   -1.3857973e-18  0              0.099987832    4.5795665e-05  0              2211.3088     -1.5            0              2.999366     
   1500000   3000           100            100            0.033330554   -1.3858468e-18  0              0.099991663    2.8128075e-06  0              135.82041     -1.5            0              2.999366     
   1600000   3000           100            100            0.033328374   -1.3857551e-18  0              0.099985122    6.2880357e-09  0              0.30362674    -1.5            0              2.999366     
   1700000   3000           100            100            0.033326937   -1.385695e-18   0              0.099980811    3.0960644e-08  0              1.4949787     -1.5            0              2.999366     
   1800000   3000           100            100            0.03332639    -1.3856724e-18  0              0.099979169    1.2730762e-08  0              0.61472294    -1.5            0              2.999366     
   1900000   3000           100            100            0.033326262   -1.3856672e-18  0              0.099978786    1.7909856e-09  0              0.086480283   -1.5            0              2.999366     
   2000000   3000           100            100            0.03332626    -1.3856672e-18  0              0.09997878     9.3541035e-11  0              0.0045167618  -1.5            0              2.999366     
   2100000   3000           100            100            0.033326276   -1.3856678e-18  0              0.099978828    4.8781838e-16  0              2.3555004e-08 -1.5            0              2.999366     
   2200000   3000           100            100            0.033326285   -1.3856682e-18  0              0.099978856    1.6064421e-12  0              7.7569337e-05 -1.5            0              2.999366     
   2300000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978866    5.4884356e-13  0              2.6501691e-05 -1.5            0              2.999366     
   2400000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    6.8950343e-14  0              3.3293653e-06 -1.5            0              2.999366     
   2500000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    2.9902816e-15  0              1.4439e-07    -1.5            0              2.999366     
   2600000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    4.1500296e-18  0              2.0039008e-10 -1.5            0              2.999366     
   2700000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    5.4082023e-17  0              2.6114273e-09 -1.5            0              2.999366     
   2800000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    2.0509354e-20  0              9.9032328e-13 -1.5            0              2.999366     
   2900000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    3.7677817e-20  0              1.8193269e-12 -1.5            0              2.999366     
   3000000   3000           100            100            0.033326289   -1.3856683e-18  0              0.099978868    6.5878244e-18  0              3.1810246e-10 -1.5            0              2.999366     
Loop time of 396.652 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6534687.253 ns/day, 0.000 hours/ns, 7563.295 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.55     | 167.86     | 168.17     |   2.4 | 42.32
Neigh   | 0.99741    | 0.99746    | 0.9975     |   0.0 |  0.25
Comm    | 12.188     | 12.51      | 12.833     |   9.1 |  3.15
Output  | 0.27784    | 0.27787    | 0.2779     |   0.0 |  0.07
Modify  | 194.73     | 194.74     | 194.75     |   0.1 | 49.10
Other   |            | 20.27      |            |       |  5.11

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027685092    2.3681874e-21  0              0.083055275    603790.08      0              2.9154862e+13 -1.5            0              3.3129933    
    200000   3000           100            100            0.011001424    7.9192533e-22  0              0.033004273    176107.23      0              8.503588e+12  -1.5            0              3.047658     
    300000   3000           100            100            0.0031920545   8.4681581e-22  0              0.0095761636   24742.246      0              1.1947145e+12 -1.5            0              3.0314935    
    400000   3000           100            100            0.18365722    -7.3052317e-18  0              0.55097165     10491.084      0              5.0657691e+11 -1.5            0              2.9980438    
    500000   3000           100            100           -0.00034290396  1.2517722e-21  0             -0.0010287119   448.05874      0              2.1635153e+10 -1.5            0              3.0019989    
    600000   3000           100            100            0.019697134   -8.0554071e-19  0              0.059091403    450.32808      0              2.1744731e+10 -1.5            0              2.9995502    
    700000   3000           100            100            0.04037201    -1.6172798e-18  0              0.12111603     57.407343      0              2.7719951e+09 -1.5            0              2.999281     
    800000   3000           100            100            0.039852738   -1.5917985e-18  0              0.11955821     1.0675853      0              51549873      -1.5            0              2.9992885    
    900000   3000           100            100            0.035788726   -1.4290238e-18  0              0.10736618     0.038483062    0              1858209.3     -1.5            0              2.9993379    
   1000000   3000           100            100            0.034229151   -1.3666981e-18  0              0.10268745     0.0013929844   0              67262.23      -1.5            0              2.9993573    
   1100000   3000           100            100            0.033655751   -1.3437969e-18  0              0.10096725     7.4626458e-06  0              360.34446     -1.5            0              2.9993645    
   1200000   3000           100            100            0.033445986   -1.3354244e-18  0              0.10033796     8.2703457e-06  0              399.34539     -1.5            0              2.9993671    
   1300000   3000           100            100            0.033369568   -1.3323746e-18  0              0.10010871     5.9764679e-06  0              288.58224     -1.5            0              2.9993681    
   1400000   3000           100            100            0.033341866   -1.331269e-18   0              0.1000256      1.9413953e-06  0              93.743031     -1.5            0              2.9993685    
   1500000   3000           100            100            0.033331876   -1.3308708e-18  0              0.099995627    4.7274036e-07  0              22.82694      -1.5            0              2.9993686    
   1600000   3000           100            100            0.033328293   -1.3307281e-18  0              0.099984879    9.8926955e-08  0              4.7768286     -1.5            0              2.9993686    
   1700000   3000           100            100            0.033327016   -1.3306772e-18  0              0.099981047    1.8834031e-08  0              0.90942797    -1.5            0              2.9993686    
   1800000   3000           100            100            0.033326563   -1.3306592e-18  0              0.099979689    3.3590094e-09  0              0.16219454    -1.5            0              2.9993686    
   1900000   3000           100            100            0.033326404   -1.3306529e-18  0              0.099979211    5.7086627e-10  0              0.027565089   -1.5            0              2.9993686    
   2000000   3000           100            100            0.033326348   -1.3306507e-18  0              0.099979043    9.3448088e-11  0              0.0045122737  -1.5            0              2.9993686    
   2100000   3000           100            100            0.033326328   -1.3306499e-18  0              0.099978985    1.4830158e-11  0              0.00071609525 -1.5            0              2.9993686    
   2200000   3000           100            100            0.033326322   -1.3306497e-18  0              0.099978965    2.2980017e-12  0              0.00011096228 -1.5            0              2.9993686    
   2300000   3000           100            100            0.033326319   -1.3306495e-18  0              0.099978958    3.4827373e-13  0              1.6816892e-05 -1.5            0              2.9993686    
   2400000   3000           100            100            0.033326319   -1.3306494e-18  0              0.099978956    5.2146742e-14  0              2.5179795e-06 -1.5            0              2.9993686    
   2500000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    7.6582864e-15  0              3.6979124e-07 -1.5            0              2.9993686    
   2600000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    1.0574536e-15  0              5.1060649e-08 -1.5            0              2.9993686    
   2700000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    1.2786315e-16  0              6.174054e-09  -1.5            0              2.9993686    
   2800000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    4.0940175e-18  0              1.9768546e-10 -1.5            0              2.9993686    
   2900000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    6.4634415e-19  0              3.1209646e-11 -1.5            0              2.9993686    
   3000000   3000           100            100            0.033326318   -1.3306494e-18  0              0.099978955    3.7332565e-18  0              1.8026559e-10 -1.5            0              2.9993686    
Loop time of 396.198 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6542180.363 ns/day, 0.000 hours/ns, 7571.968 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.6      | 167.95     | 168.3      |   2.7 | 42.39
Neigh   | 1.0032     | 1.0047     | 1.0062     |   0.1 |  0.25
Comm    | 12.023     | 12.419     | 12.815     |  11.2 |  3.13
Output  | 0.27889    | 0.27892    | 0.27895    |   0.0 |  0.07
Modify  | 194.49     | 194.52     | 194.56     |   0.3 | 49.10
Other   |            | 20.03      |            |       |  5.05

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027686501    1.5201207e-21  0              0.083059504    603836.44      0              2.9157101e+13 -1.5            0              3.3129543    
    200000   3000           100            100            0.011004593    2.1038906e-21  0              0.03301378     176185.98      0              8.5073903e+12 -1.5            0              3.0475868    
    300000   3000           100            100            0.0031972968   2.6607228e-21  0              0.0095918903   24812.278      0              1.1980961e+12 -1.5            0              3.0314344    
    400000   3000           100            100            0.19822186    -7.6203262e-18  0              0.59466557     10023.558      0              4.8400175e+11 -1.5            0              2.997949     
    500000   3000           100            100           -0.00032320601  1.4584259e-21  0             -0.00096961803  396.58303      0              1.9149575e+10 -1.5            0              3.0020556    
    600000   3000           100            100            0.010880255   -4.3083179e-19  0              0.032640766    373.6142       0              1.8040492e+10 -1.5            0              2.9996962    
    700000   3000           100            100            0.026662421   -1.0258988e-18  0              0.079987264    58.100064      0              2.8054442e+09 -1.5            0              2.9994565    
    800000   3000           100            100            0.032404389   -1.2422381e-18  0              0.097213168    8.7077773      0              4.204674e+08  -1.5            0              2.9993824    
    900000   3000           100            100            0.032031751   -1.2265933e-18  0              0.096095253    0.85861818     0              41459599      -1.5            0              2.9993876    
   1000000   3000           100            100            0.032540034   -1.2455185e-18  0              0.097620101    0.038648137    0              1866180.2     -1.5            0              2.9993812    
   1100000   3000           100            100            0.03299643    -1.2628427e-18  0              0.098989291    1.9850987e-07  0              9.585331      -1.5            0              2.9993755    
   1200000   3000           100            100            0.033222211   -1.2714614e-18  0              0.099666632    0.00066958584  0              32331.904     -1.5            0              2.9993727    
   1300000   3000           100            100            0.03330437    -1.2746134e-18  0              0.09991311     0.00026869462  0              12974.301     -1.5            0              2.9993716    
   1400000   3000           100            100            0.033326278   -1.275459e-18   0              0.099978834    4.7804733e-05  0              2308.3195     -1.5            0              2.9993714    
   1500000   3000           100            100            0.033329215   -1.2755752e-18  0              0.099987644    4.8004973e-06  0              231.79883     -1.5            0              2.9993713    
   1600000   3000           100            100            0.033328166   -1.2755366e-18  0              0.099984498    2.177221e-07   0              10.513021     -1.5            0              2.9993713    
   1700000   3000           100            100            0.033327115   -1.2754969e-18  0              0.099981346    1.7814807e-11  0              0.00086021329 -1.5            0              2.9993714    
   1800000   3000           100            100            0.033326592   -1.275477e-18   0              0.099979775    3.4960207e-09  0              0.16881033    -1.5            0              2.9993714    
   1900000   3000           100            100            0.0333264     -1.2754696e-18  0              0.099979201    1.4333561e-09  0              0.069211638   -1.5            0              2.9993714    
   2000000   3000           100            100            0.033326349   -1.2754676e-18  0              0.099979047    2.5771398e-10  0              0.012444086   -1.5            0              2.9993714    
   2100000   3000           100            100            0.033326342   -1.2754674e-18  0              0.099979026    2.6172433e-11  0              0.0012637731  -1.5            0              2.9993714    
   2200000   3000           100            100            0.033326344   -1.2754673e-18  0              0.099979033    1.2132868e-12  0              5.858528e-05  -1.5            0              2.9993714    
   2300000   3000           100            100            0.033326347   -1.2754675e-18  0              0.09997904     2.80405e-16    0              1.3539754e-08 -1.5            0              2.9993714    
   2400000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979044    1.8300651e-14  0              8.8367294e-07 -1.5            0              2.9993714    
   2500000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    7.7139742e-15  0              3.7248021e-07 -1.5            0              2.9993714    
   2600000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    1.3887375e-15  0              6.7057163e-08 -1.5            0              2.9993714    
   2700000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    1.3512725e-16  0              6.5248115e-09 -1.5            0              2.9993714    
   2800000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    1.8106391e-18  0              8.7429283e-11 -1.5            0              2.9993714    
   2900000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    5.1853074e-18  0              2.5037994e-10 -1.5            0              2.9993714    
   3000000   3000           100            100            0.033326348   -1.2754675e-18  0              0.099979045    1.8768623e-18  0              9.0626964e-11 -1.5            0              2.9993714    
Loop time of 394.516 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6570079.921 ns/day, 0.000 hours/ns, 7604.259 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.05     | 167.12     | 167.18     |   0.5 | 42.36
Neigh   | 1.0225     | 1.0228     | 1.0232     |   0.0 |  0.26
Comm    | 12.202     | 12.311     | 12.419     |   3.1 |  3.12
Output  | 0.27888    | 0.27891    | 0.27894    |   0.0 |  0.07
Modify  | 193.74     | 193.77     | 193.81     |   0.3 | 49.12
Other   |            | 20.01      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027687965    3.3483369e-21  0              0.083063895    603884.57      0              2.9159425e+13 -1.5            0              3.3129137    
    200000   3000           100            100            0.011007901    2.1730156e-21  0              0.033023702    176268.19      0              8.5113601e+12 -1.5            0              3.0475123    
    300000   3000           100            100            0.0032027709   1.6919337e-21  0              0.0096083128   24885.486      0              1.2016311e+12 -1.5            0              3.0313723    
    400000   3000           100            100            0.21354418    -7.8264685e-18  0              0.64063253     9501.2368      0              4.5878072e+11 -1.5            0              2.9978529    
    500000   3000           100            100           -0.00030268126  1.5303537e-21  0             -0.00090804378  346.46476      0              1.6729544e+10 -1.5            0              3.0021111    
    600000   3000           100            100            0.0044276746  -1.7719515e-19  0              0.013283024    272.95125      0              1.3179839e+10 -1.5            0              2.9998305    
    700000   3000           100            100            0.017474006   -6.4116746e-19  0              0.052422017    13.213284      0              6.3802222e+08 -1.5            0              2.9995921    
    800000   3000           100            100            0.026630753   -9.740531e-19   0              0.079892259    0.046346966    0              2237929.1     -1.5            0              2.999461     
    900000   3000           100            100            0.031922524   -1.1667552e-18  0              0.095767572    0.79896082     0              38578958      -1.5            0              2.9993921    
   1000000   3000           100            100            0.033792831   -1.2354615e-18  0              0.10137849     0.11560078     0              5581948       -1.5            0              2.9993684    
   1100000   3000           100            100            0.033656165   -1.2307091e-18  0              0.1009685      0.00023599894  0              11395.544     -1.5            0              2.99937      
   1200000   3000           100            100            0.033363896   -1.2200426e-18  0              0.10009169     0.0024631639   0              118937.37     -1.5            0              2.9993737    
   1300000   3000           100            100            0.033294074   -1.2174629e-18  0              0.099882223    0.00016719785  0              8073.3858     -1.5            0              2.9993746    
   1400000   3000           100            100            0.033311667   -1.218094e-18   0              0.099935002    7.1455266e-06  0              345.03191     -1.5            0              2.9993744    
   1500000   3000           100            100            0.033326222   -1.2186261e-18  0              0.099978667    6.3427728e-06  0              306.2698      -1.5            0              2.9993742    
   1600000   3000           100            100            0.033328281   -1.218703e-18   0              0.099984842    1.641965e-07   0              7.9284614     -1.5            0              2.9993741    
   1700000   3000           100            100            0.033326974   -1.2186557e-18  0              0.099980921    4.4679368e-08  0              2.1574068     -1.5            0              2.9993742    
   1800000   3000           100            100            0.033326307   -1.2186313e-18  0              0.099978921    1.3778941e-08  0              0.66533573    -1.5            0              2.9993742    
   1900000   3000           100            100            0.033326279   -1.2186302e-18  0              0.099978837    5.4657904e-11  0              0.0026392346  -1.5            0              2.9993742    
   2000000   3000           100            100            0.033326359   -1.2186331e-18  0              0.099979077    1.7731203e-10  0              0.0085617635  -1.5            0              2.9993742    
   2100000   3000           100            100            0.033326387   -1.2186342e-18  0              0.09997916     2.4941536e-11  0              0.0012043375  -1.5            0              2.9993742    
   2200000   3000           100            100            0.033326385   -1.2186341e-18  0              0.099979154    6.7071861e-14  0              3.2386601e-06 -1.5            0              2.9993742    
   2300000   3000           100            100            0.03332638    -1.2186339e-18  0              0.099979141    5.4669577e-13  0              2.6397982e-05 -1.5            0              2.9993742    
   2400000   3000           100            100            0.033326379   -1.2186338e-18  0              0.099979138    3.5540312e-14  0              1.7161145e-06 -1.5            0              2.9993742    
   2500000   3000           100            100            0.033326379   -1.2186338e-18  0              0.099979138    1.6570786e-15  0              8.0014393e-08 -1.5            0              2.9993742    
   2600000   3000           100            100            0.03332638    -1.2186338e-18  0              0.099979139    1.392982e-15   0              6.7262115e-08 -1.5            0              2.9993742    
   2700000   3000           100            100            0.03332638    -1.2186338e-18  0              0.099979139    1.2450603e-17  0              6.0119508e-10 -1.5            0              2.9993742    
   2800000   3000           100            100            0.03332638    -1.2186338e-18  0              0.099979139    2.2292033e-17  0              1.0764025e-09 -1.5            0              2.9993742    
   2900000   3000           100            100            0.03332638    -1.2186338e-18  0              0.099979139    7.0289643e-19  0              3.3940353e-11 -1.5            0              2.9993742    
   3000000   3000           100            100            0.03332638    -1.2186338e-18  0              0.099979139    9.9159337e-19  0              4.7880495e-11 -1.5            0              2.9993742    
Loop time of 395.035 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6561439.440 ns/day, 0.000 hours/ns, 7594.259 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.61     | 167.81     | 168.01     |   1.5 | 42.48
Neigh   | 1.0089     | 1.0092     | 1.0095     |   0.0 |  0.26
Comm    | 12.038     | 12.223     | 12.408     |   5.3 |  3.09
Output  | 0.2778     | 0.27783    | 0.27786    |   0.0 |  0.07
Modify  | 193.56     | 193.59     | 193.62     |   0.2 | 49.01
Other   |            | 20.13      |            |       |  5.10

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027689482    2.7645078e-21  0              0.083068445    603934.41      0              2.9161831e+13 -1.5            0              3.312872     
    200000   3000           100            100            0.011011309    2.9943409e-21  0              0.033033928    176352.92      0              8.5154513e+12 -1.5            0              3.0474357    
    300000   3000           100            100            0.003208433    2.1594953e-21  0              0.009625299    24961.291      0              1.2052914e+12 -1.5            0              3.0313082    
    400000   3000           100            100            0.22950946    -7.9163354e-18  0              0.68852837     8925.5128      0              4.3098107e+11 -1.5            0              2.9977562    
    500000   3000           100            100           -0.00028134868  1.9322695e-21  0             -0.00084404605  298.13666      0              1.4395952e+10 -1.5            0              3.0021652    
    600000   3000           100            100            0.00064593764 -3.2234689e-20  0              0.0019378129   169.66695      0              8.19261e+09   -1.5            0              2.9999456    
    700000   3000           100            100            0.016466764   -5.7298851e-19  0              0.049400292    5.5039822      0              2.657676e+08  -1.5            0              2.9996113    
    800000   3000           100            100            0.031829118   -1.1083392e-18  0              0.095487353    8.4685096      0              4.0891402e+08 -1.5            0              2.9993965    
    900000   3000           100            100            0.035852307   -1.250414e-18   0              0.10755692     0.0067772138   0              327247.4      -1.5            0              2.999346     
   1000000   3000           100            100            0.033199044   -1.1582722e-18  0              0.099597132    0.1533872      0              7406518.7     -1.5            0              2.9993786    
   1100000   3000           100            100            0.033014881   -1.1515556e-18  0              0.099044642    0.002460923    0              118829.16     -1.5            0              2.999381     
   1200000   3000           100            100            0.033392411   -1.1647109e-18  0              0.10017723     0.0019358882   0              93477.114     -1.5            0              2.9993763    
   1300000   3000           100            100            0.033357184   -1.1635251e-18  0              0.10007155     0.00018466624  0              8916.8718     -1.5            0              2.9993767    
   1400000   3000           100            100            0.033312762   -1.1619718e-18  0              0.099938285    1.3386782e-05  0              646.39978     -1.5            0              2.9993773    
   1500000   3000           100            100            0.033324514   -1.1623773e-18  0              0.099973541    5.6790371e-06  0              274.22038     -1.5            0              2.9993771    
   1600000   3000           100            100            0.033328523   -1.1625186e-18  0              0.099985568    1.0926411e-08  0              0.52759729    -1.5            0              2.9993771    
   1700000   3000           100            100            0.033326327   -1.1624424e-18  0              0.099978981    1.1041225e-07  0              5.3314126     -1.5            0              2.9993771    
   1800000   3000           100            100            0.033326146   -1.1624358e-18  0              0.099978438    1.5326589e-09  0              0.074006611   -1.5            0              2.9993771    
   1900000   3000           100            100            0.033326466   -1.1624469e-18  0              0.099979397    1.4260957e-09  0              0.06886106    -1.5            0              2.9993771    
   2000000   3000           100            100            0.033326439   -1.1624461e-18  0              0.099979316    1.2561255e-10  0              0.0060653803  -1.5            0              2.9993771    
   2100000   3000           100            100            0.033326401   -1.1624447e-18  0              0.099979202    1.0325739e-11  0              0.000498593   -1.5            0              2.9993771    
   2200000   3000           100            100            0.03332641    -1.162445e-18   0              0.099979231    3.9920865e-12  0              0.00019276357 -1.5            0              2.9993771    
   2300000   3000           100            100            0.033326414   -1.1624451e-18  0              0.099979241    1.1636138e-14  0              5.6186746e-07 -1.5            0              2.9993771    
   2400000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979236    7.9063882e-14  0              3.8177119e-06 -1.5            0              2.9993771    
   2500000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979235    8.9485959e-16  0              4.3209567e-08 -1.5            0              2.9993771    
   2600000   3000           100            100            0.033326412   -1.1624451e-18  0              0.099979236    1.0163834e-15  0              4.9077519e-08 -1.5            0              2.9993771    
   2700000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979236    1.1854968e-16  0              5.7243397e-09 -1.5            0              2.9993771    
   2800000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979236    6.8421315e-23  0              3.3038204e-15 -1.5            0              2.9993771    
   2900000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979236    2.9017132e-19  0              1.4011335e-11 -1.5            0              2.9993771    
   3000000   3000           100            100            0.033326412   -1.162445e-18   0              0.099979236    3.095733e-18   0              1.4948187e-10 -1.5            0              2.9993771    
Loop time of 395.053 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6561143.916 ns/day, 0.000 hours/ns, 7593.917 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.96     | 167.96     | 167.97     |   0.0 | 42.52
Neigh   | 1.0115     | 1.0115     | 1.0115     |   0.0 |  0.26
Comm    | 12.243     | 12.268     | 12.293     |   0.7 |  3.11
Output  | 0.30317    | 0.3032     | 0.30323    |   0.0 |  0.08
Modify  | 193.44     | 193.49     | 193.54     |   0.4 | 48.98
Other   |            | 20.02      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027691054    3.8605157e-21  0              0.083073162    603986.11      0              2.9164328e+13 -1.5            0              3.3128284    
    200000   3000           100            100            0.011014844    1.1567161e-21  0              0.033044533    176440.8       0              8.5196947e+12 -1.5            0              3.0473562    
    300000   3000           100            100            0.0032142826   1.6301844e-21  0              0.0096428478   25039.693      0              1.2090772e+12 -1.5            0              3.0312418    
    400000   3000           100            100            0.24600608    -8.0704338e-18  0              0.73801824     8298.6986      0              4.0071445e+11 -1.5            0              2.99766      
    500000   3000           100            100           -0.00025922085  1.7028679e-21  0             -0.00077766256  252.01292      0              1.2168802e+10 -1.5            0              3.0022173    
    600000   3000           100            100           -0.00015077047  5.8560366e-22  0             -0.0004523114   83.521318      0              4.0329455e+09 -1.5            0              3.0000356    
    700000   3000           100            100            0.024789427   -8.1570561e-19  0              0.074368282    52.56218       0              2.5380396e+09 -1.5            0              2.9994928    
    800000   3000           100            100            0.040139076   -1.3281874e-18  0              0.12041723     0.66481207     0              32101396      -1.5            0              2.9992984    
    900000   3000           100            100            0.03203429    -1.0611357e-18  0              0.09610287     0.873448       0              42175678      -1.5            0              2.999396     
   1000000   3000           100            100            0.033182728   -1.098277e-18   0              0.099548184    0.15267806     0              7372277.3     -1.5            0              2.999382     
   1100000   3000           100            100            0.033573141   -1.1115143e-18  0              0.10071942     0.0093731514   0              452595.93     -1.5            0              2.999377     
   1200000   3000           100            100            0.03320521    -1.0992782e-18  0              0.099615631    1.0214586e-05  0              493.22581     -1.5            0              2.9993816    
   1300000   3000           100            100            0.033362693   -1.1044826e-18  0              0.10008808     0.00012087128  0              5836.4413     -1.5            0              2.9993796    
   1400000   3000           100            100            0.033321911   -1.1031441e-18  0              0.099965734    4.4488539e-05  0              2148.1923     -1.5            0              2.9993802    
   1500000   3000           100            100            0.033324221   -1.1032151e-18  0              0.099972663    5.4493916e-06  0              263.13162     -1.5            0              2.9993801    
   1600000   3000           100            100            0.03332831    -1.1033524e-18  0              0.09998493     1.9637667e-07  0              9.4823264     -1.5            0              2.9993801    
   1700000   3000           100            100            0.033325681   -1.1032652e-18  0              0.099977042    3.2902955e-09  0              0.15887659    -1.5            0              2.9993801    
   1800000   3000           100            100            0.033326633   -1.1032966e-18  0              0.0999799      8.3336962e-09  0              0.40240436    -1.5            0              2.9993801    
   1900000   3000           100            100            0.03332644    -1.1032903e-18  0              0.09997932     1.9605785e-09  0              0.094669319   -1.5            0              2.9993801    
   2000000   3000           100            100            0.033326424   -1.1032897e-18  0              0.099979271    1.7083903e-10  0              0.0082492054  -1.5            0              2.9993801    
   2100000   3000           100            100            0.033326459   -1.1032909e-18  0              0.099979376    2.4430795e-12  0              0.00011796757 -1.5            0              2.9993801    
   2200000   3000           100            100            0.033326441   -1.1032903e-18  0              0.099979323    7.1121796e-13  0              3.434217e-05  -1.5            0              2.9993801    
   2300000   3000           100            100            0.033326446   -1.1032905e-18  0              0.099979339    4.7150799e-13  0              2.2767433e-05 -1.5            0              2.9993801    
   2400000   3000           100            100            0.033326446   -1.1032904e-18  0              0.099979337    7.7565591e-14  0              3.7453648e-06 -1.5            0              2.9993801    
   2500000   3000           100            100            0.033326445   -1.1032904e-18  0              0.099979336    4.6001796e-15  0              2.2212621e-07 -1.5            0              2.9993801    
   2600000   3000           100            100            0.033326446   -1.1032904e-18  0              0.099979337    3.4876225e-18  0              1.6840481e-10 -1.5            0              2.9993801    
   2700000   3000           100            100            0.033326445   -1.1032904e-18  0              0.099979336    1.5503765e-17  0              7.4862132e-10 -1.5            0              2.9993801    
   2800000   3000           100            100            0.033326446   -1.1032904e-18  0              0.099979337    1.185613e-17   0              5.7249009e-10 -1.5            0              2.9993801    
   2900000   3000           100            100            0.033326446   -1.1032904e-18  0              0.099979337    4.8349115e-19  0              2.3346057e-11 -1.5            0              2.9993801    
   3000000   3000           100            100            0.033326446   -1.1032904e-18  0              0.099979337    7.5597151e-18  0              3.6503159e-10 -1.5            0              2.9993801    
Loop time of 395.341 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6556365.873 ns/day, 0.000 hours/ns, 7588.386 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.07     | 167.3      | 167.54     |   1.8 | 42.32
Neigh   | 1.0665     | 1.0665     | 1.0665     |   0.0 |  0.27
Comm    | 11.875     | 12.133     | 12.392     |   7.4 |  3.07
Output  | 0.28031    | 0.28035    | 0.28038    |   0.0 |  0.07
Modify  | 194.47     | 194.51     | 194.55     |   0.3 | 49.20
Other   |            | 20.05      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027692683    3.5887613e-21  0              0.083078048    604039.7       0              2.9166915e+13 -1.5            0              3.3127831    
    200000   3000           100            100            0.011018522    2.4802317e-21  0              0.033055567    176532.26      0              8.5241112e+12 -1.5            0              3.0472732    
    300000   3000           100            100            0.0032203791   2.7021454e-21  0              0.0096611374   25121.504      0              1.2130275e+12 -1.5            0              3.0311724    
    400000   3000           100            100            0.26305759    -8.2707417e-18  0              0.78917278     7618.2897      0              3.6785994e+11 -1.5            0              2.9975641    
    500000   3000           100            100           -0.00023621698  1.3098934e-21  0             -0.00070865093  208.33677      0              1.0059837e+10 -1.5            0              3.0022672    
    600000   3000           100            100           -8.5027673e-05  3.9436296e-22  0             -0.00025508302  26.094886      0              1.2600287e+09 -1.5            0              3.0000968    
    700000   3000           100            100            0.040645618   -1.2689429e-18  0              0.12193685     58.100739      0              2.8054768e+09 -1.5            0              2.9992974    
    800000   3000           100            100            0.035086053   -1.1018043e-18  0              0.10525816     8.3714031      0              4.042251e+08  -1.5            0              2.9993611    
    900000   3000           100            100            0.032452047   -1.0168182e-18  0              0.097356142    1.0411985      0              50275750      -1.5            0              2.9993943    
   1000000   3000           100            100            0.033623768   -1.0543688e-18  0              0.1008713      0.1404726      0              6782919       -1.5            0              2.9993795    
   1100000   3000           100            100            0.033225436   -1.0415903e-18  0              0.099676307    0.018880232    0              911658.82     -1.5            0              2.9993845    
   1200000   3000           100            100            0.033359898   -1.0459175e-18  0              0.10007969     0.0025450605   0              122891.87     -1.5            0              2.9993828    
   1300000   3000           100            100            0.033315481   -1.0444811e-18  0              0.099946442    0.00034214077  0              16520.753     -1.5            0              2.9993833    
   1400000   3000           100            100            0.033330046   -1.0449536e-18  0              0.099990138    4.5939028e-05  0              2218.2312     -1.5            0              2.9993832    
   1500000   3000           100            100            0.033325341   -1.0448009e-18  0              0.099976023    6.1575045e-06  0              297.32386     -1.5            0              2.9993832    
   1600000   3000           100            100            0.033326836   -1.0448499e-18  0              0.099980509    8.2405422e-07  0              39.790629     -1.5            0              2.9993832    
   1700000   3000           100            100            0.033326372   -1.0448346e-18  0              0.099979115    1.1010747e-07  0              5.3166955     -1.5            0              2.9993832    
   1800000   3000           100            100            0.033326512   -1.0448393e-18  0              0.099979535    1.46894e-08    0              0.70929856    -1.5            0              2.9993832    
   1900000   3000           100            100            0.033326471   -1.0448379e-18  0              0.099979414    1.9565919e-09  0              0.09447682    -1.5            0              2.9993832    
   2000000   3000           100            100            0.033326482   -1.0448383e-18  0              0.099979447    2.6023128e-10  0              0.012565637   -1.5            0              2.9993832    
   2100000   3000           100            100            0.03332648    -1.0448382e-18  0              0.099979439    3.455786e-11   0              0.0016686754  -1.5            0              2.9993832    
   2200000   3000           100            100            0.03332648    -1.0448382e-18  0              0.09997944     4.5836495e-12  0              0.00022132803 -1.5            0              2.9993832    
   2300000   3000           100            100            0.03332648    -1.0448382e-18  0              0.09997944     6.0703839e-13  0              2.9311711e-05 -1.5            0              2.9993832    
   2400000   3000           100            100            0.03332648    -1.0448382e-18  0              0.09997944     7.9991867e-14  0              3.862521e-06  -1.5            0              2.9993832    
   2500000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     1.0513063e-14  0              5.0763818e-07 -1.5            0              2.9993832    
   2600000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     1.3701751e-15  0              6.6160852e-08 -1.5            0              2.9993832    
   2700000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     1.5898074e-16  0              7.6766111e-09 -1.5            0              2.9993832    
   2800000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     1.327691e-17   0              6.4109448e-10 -1.5            0              2.9993832    
   2900000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     1.167282e-18   0              5.6363871e-11 -1.5            0              2.9993832    
   3000000   3000           100            100            0.03332648    -1.0448381e-18  0              0.09997944     9.6771082e-19  0              4.6727292e-11 -1.5            0              2.9993832    
Loop time of 395.05 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6561197.199 ns/day, 0.000 hours/ns, 7593.978 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.49     | 167.87     | 168.25     |   2.9 | 42.49
Neigh   | 1.0363     | 1.0369     | 1.0374     |   0.1 |  0.26
Comm    | 12.007     | 12.421     | 12.835     |  11.7 |  3.14
Output  | 0.28103    | 0.28106    | 0.28108    |   0.0 |  0.07
Modify  | 193.35     | 193.41     | 193.47     |   0.4 | 48.96
Other   |            | 20.03      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027694367    2.0679457e-21  0              0.083083101    604095.1       0              2.916959e+13  -1.5            0              3.3127365    
    200000   3000           100            100            0.011022318    2.2625734e-21  0              0.033066953    176626.65      0              8.5286686e+12 -1.5            0              3.0471878    
    300000   3000           100            100            0.0032266587   1.9288032e-21  0              0.0096799762   25205.873      0              1.2171014e+12 -1.5            0              3.0311009    
    400000   3000           100            100            0.28043632    -8.3374185e-18  0              0.84130896     6893.0053      0              3.3283856e+11 -1.5            0              2.9974699    
    500000   3000           100            100           -0.00021238046  1.6843619e-21  0             -0.00063714138  167.61991      0              8.0937657e+09 -1.5            0              3.0023145    
    600000   3000           100            100           -1.6606977e-05  8.041184e-22   0             -4.9820932e-05  0.92133988     0              44488205      -1.5            0              3.000126     
    700000   3000           100            100            0.052941126   -1.562686e-18   0              0.15882338     4.0829054      0              1.9714889e+08 -1.5            0              2.999165     
    800000   3000           100            100            0.026675401   -7.8888814e-19  0              0.080026202    0.44419907     0              21448783      -1.5            0              2.9994709    
    900000   3000           100            100            0.035646067   -1.0536606e-18  0              0.1069382      0.21046417     0              10162561      -1.5            0              2.9993582    
   1000000   3000           100            100            0.032972081   -9.742155e-19   0              0.098916244    0.13402237     0              6471460.6     -1.5            0              2.9993909    
   1100000   3000           100            100            0.033205716   -9.8142227e-19  0              0.099617149    0.01823893     0              880692.67     -1.5            0              2.9993879    
   1200000   3000           100            100            0.03343708    -9.8816169e-19  0              0.10031124     0.0005233763   0              25271.968     -1.5            0              2.9993851    
   1300000   3000           100            100            0.033284083   -9.8365253e-19  0              0.099852248    3.3817492e-05  0              1632.9256     -1.5            0              2.9993869    
   1400000   3000           100            100            0.033334294   -9.8514318e-19  0              0.10000288     3.7234984e-05  0              1797.9441     -1.5            0              2.9993863    
   1500000   3000           100            100            0.033328028   -9.8495316e-19  0              0.099984084    6.0177495e-06  0              290.57558     -1.5            0              2.9993864    
   1600000   3000           100            100            0.033324687   -9.8485634e-19  0              0.09997406     2.378064e-07   0              11.48282      -1.5            0              2.9993864    
   1700000   3000           100            100            0.033327282   -9.8493282e-19  0              0.099981845    4.5321051e-09  0              0.21883913    -1.5            0              2.9993864    
   1800000   3000           100            100            0.033326353   -9.8490525e-19  0              0.09997906     1.0031818e-08  0              0.4844006     -1.5            0              2.9993864    
   1900000   3000           100            100            0.0333265     -9.8490975e-19  0              0.0999795      1.9354744e-09  0              0.093457132   -1.5            0              2.9993864    
   2000000   3000           100            100            0.033326546   -9.8491104e-19  0              0.099979637    9.9473444e-11  0              0.0048032166  -1.5            0              2.9993864    
   2100000   3000           100            100            0.033326502   -9.8490978e-19  0              0.099979506    3.120095e-13   0              1.5065822e-05 -1.5            0              2.9993864    
   2200000   3000           100            100            0.033326519   -9.8491025e-19  0              0.099979557    2.6097927e-12  0              0.00012601755 -1.5            0              2.9993864    
   2300000   3000           100            100            0.033326516   -9.8491016e-19  0              0.099979548    6.0730283e-13  0              2.932448e-05  -1.5            0              2.9993864    
   2400000   3000           100            100            0.033326515   -9.8491011e-19  0              0.099979546    3.8720817e-14  0              1.8696897e-06 -1.5            0              2.9993864    
   2500000   3000           100            100            0.033326516   -9.849101e-19   0              0.099979548    2.1846408e-18  0              1.0548849e-10 -1.5            0              2.9993864    
   2600000   3000           100            100            0.033326516   -9.8491008e-19  0              0.099979547    6.3683743e-16  0              3.07506e-08   -1.5            0              2.9993864    
   2700000   3000           100            100            0.033326516   -9.8491009e-19  0              0.099979547    1.8284365e-16  0              8.8288653e-09 -1.5            0              2.9993864    
   2800000   3000           100            100            0.033326516   -9.8491002e-19  0              0.099979547    6.6649409e-18  0              3.2182614e-10 -1.5            0              2.9993864    
   2900000   3000           100            100            0.033326516   -9.8491008e-19  0              0.099979547    6.1991881e-19  0              2.9933661e-11 -1.5            0              2.9993864    
   3000000   3000           100            100            0.033326516   -9.8491009e-19  0              0.099979547    8.8686727e-19  0              4.2823646e-11 -1.5            0              2.9993864    
Loop time of 393.445 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6587963.829 ns/day, 0.000 hours/ns, 7624.958 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.42     | 167.43     | 167.44     |   0.1 | 42.55
Neigh   | 1.0018     | 1.0025     | 1.0031     |   0.1 |  0.25
Comm    | 11.863     | 11.869     | 11.874     |   0.1 |  3.02
Output  | 0.27907    | 0.2791     | 0.27913    |   0.0 |  0.07
Modify  | 193        | 193.03     | 193.06     |   0.2 | 49.06
Other   |            | 19.83      |            |       |  5.04

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027696108    8.7696384e-22  0              0.083088324    604152.35      0              2.9172355e+13 -1.5            0              3.3126883    
    200000   3000           100            100            0.011026241    2.0754332e-21  0              0.033078723    176724.24      0              8.5333809e+12 -1.5            0              3.0470994    
    300000   3000           100            100            0.0032331637   1.6939638e-21  0              0.0096994911   25293.379      0              1.2213268e+12 -1.5            0              3.0310266    
    400000   3000           100            100            0.29805247    -8.2468326e-18  0              0.89415741     6126.9878      0              2.9585032e+11 -1.5            0              2.9973781    
    500000   3000           100            100           -0.00018766571  1.4826565e-21  0             -0.00056299713  130.22139      0              6.287925e+09  -1.5            0              3.0023587    
    600000   3000           100            100            5.4581414e-05  8.8721298e-22  0              0.00016374424  10.942558      0              5.2837696e+08 -1.5            0              3.0001202    
    700000   3000           100            100            0.048116749   -1.3383723e-18  0              0.14435025     30.762131      0              1.4853932e+09 -1.5            0              2.9992194    
    800000   3000           100            100            0.032368195   -8.9711273e-19  0              0.097104585    8.8285518      0              4.2629917e+08 -1.5            0              2.9994021    
    900000   3000           100            100            0.03088247    -8.5764806e-19  0              0.09264741     0.082880742    0              4002014.4     -1.5            0              2.9994199    
   1000000   3000           100            100            0.033625692   -9.3385053e-19  0              0.10087708     0.14140034     0              6827716.3     -1.5            0              2.999386     
   1100000   3000           100            100            0.03364032    -9.340057e-19   0              0.10092096     0.0029985701   0              144790.22     -1.5            0              2.9993859    
   1200000   3000           100            100            0.033274537   -9.2386502e-19  0              0.099823612    0.0022709746   0              109657.23     -1.5            0              2.9993904    
   1300000   3000           100            100            0.033286994   -9.2424098e-19  0              0.099860982    8.1869067e-05  0              3953.1642     -1.5            0              2.9993902    
   1400000   3000           100            100            0.033334932   -9.2556981e-19  0              0.1000048      3.5669416e-05  0              1722.3484     -1.5            0              2.9993896    
   1500000   3000           100            100            0.033331477   -9.2546982e-19  0              0.099994431    2.0282334e-06  0              97.936131     -1.5            0              2.9993897    
   1600000   3000           100            100            0.033325257   -9.2529784e-19  0              0.09997577     5.4373227e-07  0              26.254885     -1.5            0              2.9993897    
   1700000   3000           100            100            0.033325949   -9.2531764e-19  0              0.099977847    4.6863205e-08  0              2.2628564     -1.5            0              2.9993897    
   1800000   3000           100            100            0.033326747   -9.2533969e-19  0              0.099980241    8.0121153e-09  0              0.38687638    -1.5            0              2.9993897    
   1900000   3000           100            100            0.033326625   -9.2533624e-19  0              0.099979876    1.0274958e-09  0              0.049614094   -1.5            0              2.9993897    
   2000000   3000           100            100            0.033326524   -9.2533345e-19  0              0.099979572    1.1335725e-10  0              0.005473616   -1.5            0              2.9993897    
   2100000   3000           100            100            0.033326544   -9.2533401e-19  0              0.099979632    2.1608911e-11  0              0.001043417   -1.5            0              2.9993897    
   2200000   3000           100            100            0.033326557   -9.2533436e-19  0              0.09997967     1.5230339e-12  0              7.3541856e-05 -1.5            0              2.9993897    
   2300000   3000           100            100            0.033326554   -9.2533422e-19  0              0.099979661    4.3972848e-13  0              2.1232915e-05 -1.5            0              2.9993897    
   2400000   3000           100            100            0.033326552   -9.2533419e-19  0              0.099979656    1.8880971e-14  0              9.1169453e-07 -1.5            0              2.9993897    
   2500000   3000           100            100            0.033326552   -9.2533417e-19  0              0.099979657    8.7174055e-15  0              4.2093231e-07 -1.5            0              2.9993897    
   2600000   3000           100            100            0.033326553   -9.2533418e-19  0              0.099979658    2.1121052e-16  0              1.01986e-08   -1.5            0              2.9993897    
   2700000   3000           100            100            0.033326553   -9.2533417e-19  0              0.099979658    1.3384283e-16  0              6.462791e-09  -1.5            0              2.9993897    
   2800000   3000           100            100            0.033326553   -9.2533417e-19  0              0.099979658    1.7658166e-17  0              8.5264966e-10 -1.5            0              2.9993897    
   2900000   3000           100            100            0.033326553   -9.253341e-19   0              0.099979658    2.2183265e-18  0              1.0711505e-10 -1.5            0              2.9993897    
   3000000   3000           100            100            0.033326553   -9.2533417e-19  0              0.099979658    1.812548e-19   0              8.7521458e-12 -1.5            0              2.9993897    
Loop time of 392.705 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6600368.928 ns/day, 0.000 hours/ns, 7639.316 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.21     | 166.56     | 166.92     |   2.7 | 42.41
Neigh   | 1.0288     | 1.0289     | 1.029      |   0.0 |  0.26
Comm    | 11.698     | 12.072     | 12.445     |  10.8 |  3.07
Output  | 0.27598    | 0.276      | 0.27603    |   0.0 |  0.07
Modify  | 192.8      | 192.86     | 192.92     |   0.4 | 49.11
Other   |            | 19.91      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027697907    1.6458152e-21  0              0.083093721    604211.52      0              2.9175212e+13 -1.5            0              3.3126385    
    200000   3000           100            100            0.011030295    1.728034e-21   0              0.033090886    176825.11      0              8.5382517e+12 -1.5            0              3.047008     
    300000   3000           100            100            0.0032398899   1.7248392e-21  0              0.0097196697   25383.979      0              1.2257015e+12 -1.5            0              3.0309497    
    400000   3000           100            100            0.31572294    -8.1864746e-18  0              0.94716881     5329.7002      0              2.5735215e+11 -1.5            0              2.9972896    
    500000   3000           100            100           -0.00016203848  1.2596682e-21  0             -0.00048611544  96.556469      0              4.6623663e+09 -1.5            0              3.0023995    
    600000   3000           100            100            0.00012863646  6.0962169e-22  0              0.00038590939  59.245709      0              2.8607633e+09 -1.5            0              3.0000761    
    700000   3000           100            100            0.030239061   -7.878357e-19   0              0.090717184    66.290429      0              3.2009276e+09 -1.5            0              2.9994295    
    800000   3000           100            100            0.040512492   -1.0503873e-18  0              0.12153748     0.031099736    0              1501695       -1.5            0              2.9993087    
    900000   3000           100            100            0.034972402   -9.0636935e-19  0              0.1049172      0.71326113     0              34440827      -1.5            0              2.9993735    
   1000000   3000           100            100            0.033187773   -8.6031311e-19  0              0.099563319    0.15493298     0              7481159.2     -1.5            0              2.9993949    
   1100000   3000           100            100            0.033044607   -8.5678913e-19  0              0.099133821    0.0064304341   0              310502.65     -1.5            0              2.9993966    
   1200000   3000           100            100            0.033206627   -8.6102425e-19  0              0.099619881    0.00016460106  0              7947.9962     -1.5            0              2.9993946    
   1300000   3000           100            100            0.033305162   -8.6358569e-19  0              0.099915487    0.00028621893  0              13820.488     -1.5            0              2.9993934    
   1400000   3000           100            100            0.033331989   -8.6427403e-19  0              0.099995968    4.3434281e-05  0              2097.286      -1.5            0              2.9993931    
   1500000   3000           100            100            0.033332075   -8.6427405e-19  0              0.099996224    9.7630823e-07  0              47.14243      -1.5            0              2.9993931    
   1600000   3000           100            100            0.033328563   -8.6418238e-19  0              0.099985688    1.5123149e-07  0              7.3024275     -1.5            0              2.9993931    
   1700000   3000           100            100            0.03332683    -8.6413756e-19  0              0.099980491    1.033353e-07   0              4.9896917     -1.5            0              2.9993931    
   1800000   3000           100            100            0.033326447   -8.6412774e-19  0              0.099979341    1.1237193e-08  0              0.54260382    -1.5            0              2.9993932    
   1900000   3000           100            100            0.033326488   -8.6412886e-19  0              0.099979465    8.7631546e-11  0              0.0042314137  -1.5            0              2.9993932    
   2000000   3000           100            100            0.03332656    -8.6413072e-19  0              0.099979679    8.9413592e-11  0              0.0043174624  -1.5            0              2.9993932    
   2100000   3000           100            100            0.033326589   -8.6413145e-19  0              0.099979767    3.4507679e-11  0              0.0016662523  -1.5            0              2.9993932    
   2200000   3000           100            100            0.033326594   -8.6413161e-19  0              0.099979782    2.6428182e-12  0              0.00012761223 -1.5            0              2.9993932    
   2300000   3000           100            100            0.033326592   -8.6413156e-19  0              0.099979777    2.9607756e-16  0              1.4296526e-08 -1.5            0              2.9993932    
   2400000   3000           100            100            0.033326591   -8.6413149e-19  0              0.099979773    4.2435261e-14  0              2.0490469e-06 -1.5            0              2.9993932    
   2500000   3000           100            100            0.033326591   -8.6413145e-19  0              0.099979772    1.0707557e-14  0              5.1702962e-07 -1.5            0              2.9993932    
   2600000   3000           100            100            0.03332659    -8.6413145e-19  0              0.099979771    5.4786729e-16  0              2.6454551e-08 -1.5            0              2.9993932    
   2700000   3000           100            100            0.033326591   -8.641314e-19   0              0.099979772    1.2196273e-18  0              5.8891436e-11 -1.5            0              2.9993932    
   2800000   3000           100            100            0.033326591   -8.6413145e-19  0              0.099979772    1.0218643e-18  0              4.9342172e-11 -1.5            0              2.9993932    
   2900000   3000           100            100            0.033326591   -8.6413145e-19  0              0.099979772    7.4236141e-18  0              3.5845976e-10 -1.5            0              2.9993932    
   3000000   3000           100            100            0.033326591   -8.6413146e-19  0              0.099979772    1.4663463e-18  0              7.0804617e-11 -1.5            0              2.9993932    
Loop time of 396.31 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6540334.558 ns/day, 0.000 hours/ns, 7569.832 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.44     | 168.62     | 168.8      |   1.4 | 42.55
Neigh   | 1.0329     | 1.0332     | 1.0334     |   0.0 |  0.26
Comm    | 12.223     | 12.427     | 12.631     |   5.8 |  3.14
Output  | 0.27554    | 0.27557    | 0.2756     |   0.0 |  0.07
Modify  | 193.72     | 193.79     | 193.85     |   0.5 | 48.90
Other   |            | 20.17      |            |       |  5.09

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027699765    3.2743074e-21  0              0.083099295    604272.63      0              2.9178163e+13 -1.5            0              3.312587     
    200000   3000           100            100            0.011034482    2.33683e-21    0              0.033103445    176929.28      0              8.5432817e+12 -1.5            0              3.0469135    
    300000   3000           100            100            0.0032468388   1.9933078e-21  0              0.0097405163   25477.703      0              1.2302271e+12 -1.5            0              3.03087      
    400000   3000           100            100            0.33321651    -8.1550288e-18  0              0.99964952     4514.4482      0              2.1798655e+11 -1.5            0              2.9972055    
    500000   3000           100            100           -0.00013550917  1.3590693e-21  0             -0.00040652751  67.119732      0              3.2409716e+09 -1.5            0              3.0024364    
    600000   3000           100            100            0.00027278437 -5.0310938e-22  0              0.0008183531   148.95828      0              7.1926624e+09 -1.5            0              2.9999904    
    700000   3000           100            100            0.016961788   -4.1015003e-19  0              0.050885364    12.742056      0              6.1526829e+08 -1.5            0              2.9996145    
    800000   3000           100            100            0.031089332   -7.5038061e-19  0              0.093267996    8.1617526      0              3.9410182e+08 -1.5            0              2.9994234    
    900000   3000           100            100            0.032822382   -7.9121351e-19  0              0.098467145    1.1565633      0              55846304      -1.5            0              2.9994026    
   1000000   3000           100            100            0.03317031    -7.9925412e-19  0              0.099510931    0.15489562     0              7479355.1     -1.5            0              2.9993985    
   1100000   3000           100            100            0.033274668   -8.0165584e-19  0              0.099824004    0.020617098    0              995525.87     -1.5            0              2.9993973    
   1200000   3000           100            100            0.033309179   -8.0244037e-19  0              0.099927538    0.002740867    0              132346.66     -1.5            0              2.9993969    
   1300000   3000           100            100            0.033320782   -8.0270303e-19  0              0.099962347    0.0003642078   0              17586.291     -1.5            0              2.9993967    
   1400000   3000           100            100            0.033324682   -8.0279177e-19  0              0.099974046    4.8381457e-05  0              2336.1674     -1.5            0              2.9993967    
   1500000   3000           100            100            0.033325986   -8.0282095e-19  0              0.099977959    6.4253177e-06  0              310.2556      -1.5            0              2.9993967    
   1600000   3000           100            100            0.033326419   -8.0283086e-19  0              0.099979258    8.5310343e-07  0              41.193312     -1.5            0              2.9993967    
   1700000   3000           100            100            0.033326562   -8.0283408e-19  0              0.099979685    1.132405e-07   0              5.4679785     -1.5            0              2.9993967    
   1800000   3000           100            100            0.033326608   -8.0283505e-19  0              0.099979824    1.502821e-08   0              0.7256585     -1.5            0              2.9993967    
   1900000   3000           100            100            0.033326623   -8.0283539e-19  0              0.099979869    1.993889e-09   0              0.096277764   -1.5            0              2.9993967    
   2000000   3000           100            100            0.033326628   -8.0283548e-19  0              0.099979883    2.6445843e-10  0              0.012769751   -1.5            0              2.9993967    
   2100000   3000           100            100            0.033326629   -8.0283551e-19  0              0.099979887    3.506609e-11   0              0.001693216   -1.5            0              2.9993967    
   2200000   3000           100            100            0.03332663    -8.0283552e-19  0              0.099979889    4.6461376e-12  0              0.00022434536 -1.5            0              2.9993967    
   2300000   3000           100            100            0.03332663    -8.0283551e-19  0              0.099979889    6.1526715e-13  0              2.9709049e-05 -1.5            0              2.9993967    
   2400000   3000           100            100            0.03332663    -8.0283548e-19  0              0.099979889    8.1595301e-14  0              3.9399451e-06 -1.5            0              2.9993967    
   2500000   3000           100            100            0.03332663    -8.0283547e-19  0              0.099979889    1.0810178e-14  0              5.2198482e-07 -1.5            0              2.9993967    
   2600000   3000           100            100            0.03332663    -8.0283546e-19  0              0.099979889    1.4246606e-15  0              6.8791764e-08 -1.5            0              2.9993967    
   2700000   3000           100            100            0.03332663    -8.0283546e-19  0              0.099979889    1.8043608e-16  0              8.7126124e-09 -1.5            0              2.9993967    
   2800000   3000           100            100            0.03332663    -8.0283546e-19  0              0.099979889    1.9244365e-17  0              9.2924151e-10 -1.5            0              2.9993967    
   2900000   3000           100            100            0.03332663    -8.0283546e-19  0              0.099979889    5.3808013e-19  0              2.5981964e-11 -1.5            0              2.9993967    
   3000000   3000           100            100            0.03332663    -8.0283547e-19  0              0.099979889    1.72546e-18    0              8.3316286e-11 -1.5            0              2.9993967    
Loop time of 396.183 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6542426.410 ns/day, 0.000 hours/ns, 7572.253 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.19     | 168.48     | 168.77     |   2.2 | 42.53
Neigh   | 1.023      | 1.023      | 1.023      |   0.0 |  0.26
Comm    | 12.342     | 12.659     | 12.976     |   8.9 |  3.20
Output  | 0.27684    | 0.27687    | 0.2769     |   0.0 |  0.07
Modify  | 193.36     | 193.4      | 193.45     |   0.3 | 48.82
Other   |            | 20.34      |            |       |  5.13

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027701682    2.4889288e-21  0              0.083105045    604335.66      0              2.9181206e+13 -1.5            0              3.3125341    
    200000   3000           100            100            0.011038792    1.3841141e-21  0              0.033116376    177036.55      0              8.5484613e+12 -1.5            0              3.0468164    
    300000   3000           100            100            0.0032539963   2.1209679e-21  0              0.0097619889   25574.373      0              1.234895e+12  -1.5            0              3.0307879    
    400000   3000           100            100            0.35025763    -7.7421425e-18  0              1.0507729      3698.4336      0              1.7858412e+11 -1.5            0              2.9971273    
    500000   3000           100            100           -0.00010806482  1.8228233e-21  0             -0.00032419446  42.384699      0              2.0466054e+09 -1.5            0              3.0024688    
    600000   3000           100            100            0.0040327322  -8.4814767e-20  0              0.012098197    276.48241      0              1.3350346e+10 -1.5            0              2.9998603    
    700000   3000           100            100            0.01752266    -3.8739012e-19  0              0.052567981    16.841278      0              8.1320506e+08 -1.5            0              2.9996104    
    800000   3000           100            100            0.027561976   -6.1162092e-19  0              0.082685928    2.8262924      0              1.3647154e+08 -1.5            0              2.999472     
    900000   3000           100            100            0.032734674   -7.2678181e-19  0              0.098204021    1.139939       0              55043574      -1.5            0              2.9994076    
   1000000   3000           100            100            0.033861866   -7.5211025e-19  0              0.1015856      0.10883523     0              5255264       -1.5            0              2.999394     
   1100000   3000           100            100            0.033667215   -7.4792143e-19  0              0.10100164     0.00034596419  0              16705.373     -1.5            0              2.9993962    
   1200000   3000           100            100            0.033420691   -7.4248128e-19  0              0.10026207     0.0012029264   0              58085.009     -1.5            0              2.9993992    
   1300000   3000           100            100            0.03332716    -7.4039809e-19  0              0.09998148     0.00037133259  0              17930.322     -1.5            0              2.9994003    
   1400000   3000           100            100            0.033314454   -7.4010865e-19  0              0.099943363    2.2518228e-05  0              1087.3246     -1.5            0              2.9994004    
   1500000   3000           100            100            0.033320684   -7.4024493e-19  0              0.099962052    6.4108541e-08  0              3.095572      -1.5            0              2.9994004    
   1600000   3000           100            100            0.033325387   -7.4034954e-19  0              0.099976162    5.6468986e-07  0              27.266853     -1.5            0              2.9994003    
   1700000   3000           100            100            0.033326841   -7.4038197e-19  0              0.099980524    1.0932882e-07  0              5.2790975     -1.5            0              2.9994003    
   1800000   3000           100            100            0.033326923   -7.4038391e-19  0              0.099980769    3.6827482e-09  0              0.17782673    -1.5            0              2.9994003    
   1900000   3000           100            100            0.03332677    -7.4038058e-19  0              0.09998031     2.0727424e-10  0              0.010008531   -1.5            0              2.9994003    
   2000000   3000           100            100            0.033326685   -7.4037869e-19  0              0.099980055    2.2555878e-10  0              0.010891426   -1.5            0              2.9994003    
   2100000   3000           100            100            0.033326664   -7.4037822e-19  0              0.099979992    2.8848689e-11  0              0.0013929999  -1.5            0              2.9994003    
   2200000   3000           100            100            0.033326665   -7.4037815e-19  0              0.099979995    3.7656753e-13  0              1.8183098e-05 -1.5            0              2.9994003    
   2300000   3000           100            100            0.033326668   -7.4037829e-19  0              0.099980005    1.7117408e-13  0              8.2653837e-06 -1.5            0              2.9994003    
   2400000   3000           100            100            0.03332667    -7.403783e-19   0              0.09998001     7.9437249e-14  0              3.8357405e-06 -1.5            0              2.9994003    
   2500000   3000           100            100            0.03332667    -7.4037829e-19  0              0.09998001     6.6271387e-15  0              3.2000081e-07 -1.5            0              2.9994003    
   2600000   3000           100            100            0.03332667    -7.4037829e-19  0              0.09998001     2.390504e-18   0              1.1542889e-10 -1.5            0              2.9994003    
   2700000   3000           100            100            0.03332667    -7.4037829e-19  0              0.09998001     1.6504653e-16  0              7.9695061e-09 -1.5            0              2.9994003    
   2800000   3000           100            100            0.03332667    -7.4037829e-19  0              0.09998001     2.0085351e-17  0              9.6984973e-10 -1.5            0              2.9994003    
   2900000   3000           100            100            0.03332667    -7.4037828e-19  0              0.09998001     4.8138222e-19  0              2.3244225e-11 -1.5            0              2.9994003    
   3000000   3000           100            100            0.03332667    -7.4037829e-19  0              0.09998001     6.6893557e-18  0              3.2300505e-10 -1.5            0              2.9994003    
Loop time of 396.844 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6531538.938 ns/day, 0.000 hours/ns, 7559.652 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.76     | 168.74     | 169.73     |   7.6 | 42.52
Neigh   | 1.0054     | 1.0059     | 1.0064     |   0.0 |  0.25
Comm    | 12.019     | 13.018     | 14.016     |  27.7 |  3.28
Output  | 0.27455    | 0.27457    | 0.2746     |   0.0 |  0.07
Modify  | 193.62     | 193.62     | 193.62     |   0.0 | 48.79
Other   |            | 20.19      |            |       |  5.09

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027703659    1.9062837e-21  0              0.083110978    604400.68      0              2.9184346e+13 -1.5            0              3.3124794    
    200000   3000           100            100            0.01104325     1.8272439e-21  0              0.033129749    177147.51      0              8.5538191e+12 -1.5            0              3.0467159    
    300000   3000           100            100            0.0032613929   1.5339024e-21  0              0.0097841787   25674.413      0              1.2397255e+12 -1.5            0              3.0307028    
    400000   3000           100            100            0.36658172    -7.5490373e-18  0              1.0997452      2899.8772      0              1.4002469e+11 -1.5            0              2.9970561    
    500000   3000           100            100           -7.9660794e-05  1.0434344e-21  0             -0.00023898238  22.822854      0              1.102034e+09  -1.5            0              3.0024963    
    600000   3000           100            100            0.013039657   -2.5629467e-19  0              0.03911897     411.55938      0              1.987273e+10  -1.5            0              2.9996869    
    700000   3000           100            100            0.033149487   -6.7079882e-19  0              0.09944846     68.656764      0              3.3151894e+09 -1.5            0              2.9994078    
    800000   3000           100            100            0.039330394   -7.9917252e-19  0              0.11799118     2.9415137      0              1.4203517e+08 -1.5            0              2.9993348    
    900000   3000           100            100            0.034637712   -7.0506785e-19  0              0.10391314     0.90085796     0              43499207      -1.5            0              2.9993883    
   1000000   3000           100            100            0.032453204   -6.603604e-19   0              0.097359613    0.023348616    0              1127421.1     -1.5            0              2.9994145    
   1100000   3000           100            100            0.03324669    -6.7635583e-19  0              0.09974007     0.020053844    0              968328.35     -1.5            0              2.999405     
   1200000   3000           100            100            0.033451809   -6.8057763e-19  0              0.10035543     1.7710488e-05  0              855.1761      -1.5            0              2.9994025    
   1300000   3000           100            100            0.033322969   -6.77971e-19    0              0.099968908    0.00037051077  0              17890.639     -1.5            0              2.9994041    
   1400000   3000           100            100            0.033310571   -6.777103e-19   0              0.099931712    2.7032166e-06  0              130.52865     -1.5            0              2.9994042    
   1500000   3000           100            100            0.033329053   -6.7808553e-19  0              0.099987158    5.5811432e-06  0              269.49343     -1.5            0              2.999404     
   1600000   3000           100            100            0.033328582   -6.7807735e-19  0              0.099985747    2.3824031e-07  0              11.503772     -1.5            0              2.999404     
   1700000   3000           100            100            0.033326187   -6.7802863e-19  0              0.099978562    6.6148246e-08  0              3.1940621     -1.5            0              2.999404     
   1800000   3000           100            100            0.033326523   -6.780353e-19   0              0.09997957     8.8537538e-09  0              0.42751608    -1.5            0              2.999404     
   1900000   3000           100            100            0.033326802   -6.7804101e-19  0              0.099980407    5.4361031e-10  0              0.026248996   -1.5            0              2.999404     
   2000000   3000           100            100            0.033326726   -6.7803948e-19  0              0.099980178    2.2906524e-10  0              0.011060741   -1.5            0              2.999404     
   2100000   3000           100            100            0.033326698   -6.780389e-19   0              0.099980093    1.8427064e-12  0              8.8977695e-05 -1.5            0              2.999404     
   2200000   3000           100            100            0.033326711   -6.7803916e-19  0              0.099980133    4.6742305e-12  0              0.00022570186 -1.5            0              2.999404     
   2300000   3000           100            100            0.033326713   -6.780392e-19   0              0.09998014     4.5835898e-15  0              2.2132515e-07 -1.5            0              2.999404     
   2400000   3000           100            100            0.033326711   -6.7803913e-19  0              0.099980134    7.742161e-14   0              3.7384125e-06 -1.5            0              2.999404     
   2500000   3000           100            100            0.033326711   -6.7803912e-19  0              0.099980134    1.6185195e-15  0              7.8152516e-08 -1.5            0              2.999404     
   2600000   3000           100            100            0.033326711   -6.7803912e-19  0              0.099980134    1.0101995e-15  0              4.8778921e-08 -1.5            0              2.999404     
   2700000   3000           100            100            0.033326711   -6.7803912e-19  0              0.099980134    1.5390084e-16  0              7.4313206e-09 -1.5            0              2.999404     
   2800000   3000           100            100            0.033326711   -6.7803912e-19  0              0.099980134    5.4302007e-18  0              2.6220496e-10 -1.5            0              2.999404     
   2900000   3000           100            100            0.033326711   -6.7803912e-19  0              0.099980134    4.9943164e-18  0              2.4115767e-10 -1.5            0              2.999404     
   3000000   3000           100            100            0.033326711   -6.7803913e-19  0              0.099980134    3.368963e-19   0              1.6267517e-11 -1.5            0              2.999404     
Loop time of 393.039 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6594772.537 ns/day, 0.000 hours/ns, 7632.839 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.46     | 166.62     | 166.78     |   1.2 | 42.39
Neigh   | 1.011      | 1.0113     | 1.0116     |   0.0 |  0.26
Comm    | 11.841     | 11.991     | 12.142     |   4.3 |  3.05
Output  | 0.27507    | 0.2751     | 0.27513    |   0.0 |  0.07
Modify  | 193.1      | 193.12     | 193.15     |   0.2 | 49.14
Other   |            | 20.02      |            |       |  5.09

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.0277057      1.0396522e-21  0              0.083117099    604467.81      0              2.9187587e+13 -1.5            0              3.3124228    
    200000   3000           100            100            0.01104785     3.1329153e-21  0              0.033143551    177262.06      0              8.5593505e+12 -1.5            0              3.0466119    
    300000   3000           100            100            0.0032690314   1.932271e-21   0              0.0098070941   25777.876      0              1.2447214e+12 -1.5            0              3.0306147    
    400000   3000           100            100            0.3818569     -7.1576756e-18  0              1.1455707      2141.948       0              1.03427e+11   -1.5            0              2.9969933    
    500000   3000           100            100           -5.027695e-05   1.4494694e-21  0             -0.00015083085  8.9584565      0              4.325718e+08  -1.5            0              3.0025184    
    600000   3000           100            100            0.027839351   -5.0393835e-19  0              0.083518052    497.68983      0              2.4031661e+10 -1.5            0              2.9994797    
    700000   3000           100            100            0.052156036   -9.5866833e-19  0              0.15646811     12.275424      0              5.927363e+08  -1.5            0              2.9992024    
    800000   3000           100            100            0.034169285   -6.3055845e-19  0              0.10250785     9.0228033      0              4.3567888e+08 -1.5            0              2.9993973    
    900000   3000           100            100            0.031564554   -5.8123173e-19  0              0.094693663    0.65077831     0              31423755      -1.5            0              2.9994291    
   1000000   3000           100            100            0.034230668   -6.3063982e-19  0              0.102692       0.016134727    0              779088.24     -1.5            0              2.9993972    
   1100000   3000           100            100            0.032985827   -6.0770625e-19  0              0.098957481    0.00063194434  0              30514.33      -1.5            0              2.9994119    
   1200000   3000           100            100            0.033426139   -6.1578229e-19  0              0.10027842     0.0010794591   0              52123.216     -1.5            0              2.9994067    
   1300000   3000           100            100            0.033308233   -6.1363167e-19  0              0.099924698    0.00031424616  0              15173.823     -1.5            0              2.9994081    
   1400000   3000           100            100            0.033325463   -6.1393906e-19  0              0.099976388    4.9268263e-05  0              2378.9881     -1.5            0              2.9994079    
   1500000   3000           100            100            0.033330035   -6.1402685e-19  0              0.099990106    4.6364968e-06  0              223.87984     -1.5            0              2.9994078    
   1600000   3000           100            100            0.03332482    -6.1393013e-19  0              0.099974461    2.0345132e-07  0              9.8239361     -1.5            0              2.9994079    
   1700000   3000           100            100            0.03332756    -6.1398072e-19  0              0.099982679    1.602471e-11   0              0.00077377588 -1.5            0              2.9994079    
   1800000   3000           100            100            0.033326494   -6.1396112e-19  0              0.099979481    3.2720296e-09  0              0.1579946     -1.5            0              2.9994079    
   1900000   3000           100            100            0.033326814   -6.1396698e-19  0              0.099980443    1.3854509e-09  0              0.066898466   -1.5            0              2.9994079    
   2000000   3000           100            100            0.03332675    -6.1396584e-19  0              0.09998025     2.6552196e-10  0              0.012821105   -1.5            0              2.9994079    
   2100000   3000           100            100            0.033326749   -6.1396581e-19  0              0.099980246    3.0468381e-11  0              0.0014712091  -1.5            0              2.9994079    
   2200000   3000           100            100            0.033326758   -6.1396598e-19  0              0.099980274    1.9092363e-12  0              9.2190186e-05 -1.5            0              2.9994079    
   2300000   3000           100            100            0.033326752   -6.1396585e-19  0              0.099980257    2.4062677e-14  0              1.1619006e-06 -1.5            0              2.9994079    
   2400000   3000           100            100            0.033326755   -6.1396589e-19  0              0.099980264    7.0533924e-15  0              3.4058308e-07 -1.5            0              2.9994079    
   2500000   3000           100            100            0.033326754   -6.1396586e-19  0              0.099980262    5.434453e-15   0              2.6241028e-07 -1.5            0              2.9994079    
   2600000   3000           100            100            0.033326754   -6.1396586e-19  0              0.099980262    1.3224183e-15  0              6.3854845e-08 -1.5            0              2.9994079    
   2700000   3000           100            100            0.033326754   -6.1396586e-19  0              0.099980262    1.8347046e-16  0              8.8591317e-09 -1.5            0              2.9994079    
   2800000   3000           100            100            0.033326754   -6.1396586e-19  0              0.099980262    1.905727e-17   0              9.2020736e-10 -1.5            0              2.9994079    
   2900000   3000           100            100            0.033326754   -6.1396584e-19  0              0.099980262    6.3469922e-18  0              3.0647354e-10 -1.5            0              2.9994079    
   3000000   3000           100            100            0.033326754   -6.1396587e-19  0              0.099980262    1.3977644e-18  0              6.749304e-11  -1.5            0              2.9994079    
Loop time of 395.579 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6552421.722 ns/day, 0.000 hours/ns, 7583.821 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.13     | 168.49     | 168.85     |   2.8 | 42.59
Neigh   | 1.0043     | 1.0049     | 1.0054     |   0.1 |  0.25
Comm    | 11.903     | 12.291     | 12.679     |  11.1 |  3.11
Output  | 0.27866    | 0.27869    | 0.27872    |   0.0 |  0.07
Modify  | 193.37     | 193.44     | 193.52     |   0.5 | 48.90
Other   |            | 20.07      |            |       |  5.07

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027707803    2.5727743e-21  0              0.083123409    604537.05      0              2.9190931e+13 -1.5            0              3.3123642    
    200000   3000           100            100            0.011052604    1.0565523e-21  0              0.033157811    177380.45      0              8.5650669e+12 -1.5            0              3.0465043    
    300000   3000           100            100            0.0032769269   1.6384328e-21  0              0.0098307807   25884.982      0              1.2498931e+12 -1.5            0              3.0305233    
    400000   3000           100            100            0.39570785    -6.5584989e-18  0              1.1871236      1451.4035      0              7.0083079e+10 -1.5            0              2.9969406    
    500000   3000           100            100           -1.9872471e-05  1.2943389e-21  0             -5.9617412e-05  1.3359713      0              64509274      -1.5            0              3.0025346    
    600000   3000           100            100            0.047588852   -7.7359922e-19  0              0.14276656     472.84234      0              2.2831864e+10 -1.5            0              2.9992581    
    700000   3000           100            100            0.047948352   -7.9038481e-19  0              0.14384506     34.210598      0              1.6519073e+09 -1.5            0              2.9992493    
    800000   3000           100            100            0.026756149   -4.3977663e-19  0              0.080268448    1.1721755      0              56600161      -1.5            0              2.9994922    
    900000   3000           100            100            0.035280998   -5.8066725e-19  0              0.10584299     0.54835199     0              26477955      -1.5            0              2.9993889    
   1000000   3000           100            100            0.032962016   -5.4217647e-19  0              0.098886047    0.13750184     0              6639472       -1.5            0              2.9994162    
   1100000   3000           100            100            0.03330137    -5.4794068e-19  0              0.09990411     0.021293133    0              1028169.2     -1.5            0              2.9994121    
   1200000   3000           100            100            0.033391327   -5.4935621e-19  0              0.10017398     0.0021093179   0              101851.41     -1.5            0              2.9994111    
   1300000   3000           100            100            0.03328805    -5.4767726e-19  0              0.099864151    0.00011180714  0              5398.7665     -1.5            0              2.9994123    
   1400000   3000           100            100            0.033343489   -5.4858472e-19  0              0.10003047     6.472993e-07   0              31.255767     -1.5            0              2.9994116    
   1500000   3000           100            100            0.03332106    -5.4821587e-19  0              0.099963179    7.6967448e-07  0              37.164826     -1.5            0              2.9994119    
   1600000   3000           100            100            0.033328324   -5.4833598e-19  0              0.099984973    4.599211e-07   0              22.207944     -1.5            0              2.9994118    
   1700000   3000           100            100            0.033326564   -5.4830664e-19  0              0.099979691    1.0598213e-07  0              5.1174977     -1.5            0              2.9994118    
   1800000   3000           100            100            0.033326748   -5.4830984e-19  0              0.099980244    1.4937081e-08  0              0.72125816    -1.5            0              2.9994118    
   1900000   3000           100            100            0.033326861   -5.4831162e-19  0              0.099980584    1.3308313e-09  0              0.064261079   -1.5            0              2.9994118    
   2000000   3000           100            100            0.033326763   -5.4831003e-19  0              0.099980289    5.7302121e-11  0              0.0027669144  -1.5            0              2.9994118    
   2100000   3000           100            100            0.033326812   -5.4831084e-19  0              0.099980436    9.4618504e-15  0              4.5687889e-07 -1.5            0              2.9994118    
   2200000   3000           100            100            0.033326793   -5.4831052e-19  0              0.09998038     8.8416721e-13  0              4.269327e-05  -1.5            0              2.9994118    
   2300000   3000           100            100            0.033326799   -5.4831061e-19  0              0.099980397    3.908812e-13   0              1.8874254e-05 -1.5            0              2.9994118    
   2400000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980393    8.0090468e-14  0              3.8672821e-06 -1.5            0              2.9994118    
   2500000   3000           100            100            0.033326798   -5.4831055e-19  0              0.099980393    1.0227597e-14  0              4.9385403e-07 -1.5            0              2.9994118    
   2600000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980394    8.0094684e-16  0              3.8674856e-08 -1.5            0              2.9994118    
   2700000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980394    2.8294346e-19  0              1.3662327e-11 -1.5            0              2.9994118    
   2800000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980394    7.7994838e-19  0              3.7660916e-11 -1.5            0              2.9994118    
   2900000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980394    8.7153968e-19  0              4.2083532e-11 -1.5            0              2.9994118    
   3000000   3000           100            100            0.033326798   -5.4831056e-19  0              0.099980394    5.1599957e-18  0              2.4915773e-10 -1.5            0              2.9994118    
Loop time of 395.092 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6560492.776 ns/day, 0.000 hours/ns, 7593.163 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.54     | 167.91     | 168.29     |   2.9 | 42.50
Neigh   | 0.99186    | 0.99293    | 0.994      |   0.1 |  0.25
Comm    | 11.943     | 12.356     | 12.768     |  11.7 |  3.13
Output  | 0.27804    | 0.27807    | 0.2781     |   0.0 |  0.07
Modify  | 193.32     | 193.36     | 193.4      |   0.3 | 48.94
Other   |            | 20.19      |            |       |  5.11

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027709968    1.7136955e-21  0              0.083129904    604608.23      0              2.9194367e+13 -1.5            0              3.3123045    
    200000   3000           100            100            0.011057468    1.6693373e-21  0              0.033172405    177501.61      0              8.5709174e+12 -1.5            0              3.0463947    
    300000   3000           100            100            0.0032850058   1.2724549e-21  0              0.0098550173   25994.74       0              1.255193e+12  -1.5            0              3.0304298    
    400000   3000           100            100            0.40765442    -5.9850566e-18  0              1.2229633      861.81004      0              4.1613723e+10 -1.5            0              2.9968999    
    500000   3000           100            100            1.1496341e-05  1.7621738e-21  0              3.4489022e-05  0.53320043     0              25746341      -1.5            0              3.0025442    
    600000   3000           100            100            0.069111201   -1.0008674e-18  0              0.2073336      319.35436      0              1.5420479e+10 -1.5            0              2.9990528    
    700000   3000           100            100            0.025481111   -3.7183324e-19  0              0.076443334    58.139501      0              2.8073484e+09 -1.5            0              2.99951      
    800000   3000           100            100            0.039365255   -5.704784e-19   0              0.11809577     3.096531       0              1.495204e+08  -1.5            0              2.9993476    
    900000   3000           100            100            0.031388889   -4.5529911e-19  0              0.094166667    0.55134317     0              26622388      -1.5            0              2.9994389    
   1000000   3000           100            100            0.032770967   -4.756265e-19   0              0.0983129      0.10824942     0              5226977.3     -1.5            0              2.9994223    
   1100000   3000           100            100            0.033634713   -4.8805283e-19  0              0.10090414     0.0048330851   0              233372.38     -1.5            0              2.9994123    
   1200000   3000           100            100            0.033374168   -4.8424034e-19  0              0.1001225      0.0024613491   0              118849.74     -1.5            0              2.9994153    
   1300000   3000           100            100            0.033282078   -4.8291946e-19  0              0.099846233    2.5162019e-05  0              1214.9838     -1.5            0              2.9994164    
   1400000   3000           100            100            0.03332434    -4.8353492e-19  0              0.099973021    4.8958599e-05  0              2364.0355     -1.5            0              2.9994159    
   1500000   3000           100            100            0.033332988   -4.8365824e-19  0              0.099998963    5.6120775e-09  0              0.27098714    -1.5            0              2.9994158    
   1600000   3000           100            100            0.033326656   -4.8356639e-19  0              0.099979969    8.7167814e-07  0              42.090218     -1.5            0              2.9994159    
   1700000   3000           100            100            0.033326044   -4.8355785e-19  0              0.099978133    4.7323086e-09  0              0.22850624    -1.5            0              2.9994159    
   1800000   3000           100            100            0.033326935   -4.8357076e-19  0              0.099980805    1.3908639e-08  0              0.6715984     -1.5            0              2.9994159    
   1900000   3000           100            100            0.033326941   -4.8357079e-19  0              0.099980823    3.6329019e-10  0              0.017541983   -1.5            0              2.9994159    
   2000000   3000           100            100            0.033326822   -4.835691e-19   0              0.099980467    1.966229e-10   0              0.009494216   -1.5            0              2.9994159    
   2100000   3000           100            100            0.033326832   -4.8356923e-19  0              0.099980495    1.3748253e-11  0              0.00066385394 -1.5            0              2.9994159    
   2200000   3000           100            100            0.033326847   -4.8356943e-19  0              0.09998054     2.3871091e-12  0              0.00011526495 -1.5            0              2.9994159    
   2300000   3000           100            100            0.033326844   -4.8356939e-19  0              0.099980532    3.8660582e-13  0              1.8667812e-05 -1.5            0              2.9994159    
   2400000   3000           100            100            0.033326842   -4.8356936e-19  0              0.099980527    2.3002661e-14  0              1.1107162e-06 -1.5            0              2.9994159    
   2500000   3000           100            100            0.033326843   -4.8356935e-19  0              0.099980528    9.0956293e-15  0              4.3919539e-07 -1.5            0              2.9994159    
   2600000   3000           100            100            0.033326843   -4.8356934e-19  0              0.099980529    1.4348031e-16  0              6.9281509e-09 -1.5            0              2.9994159    
   2700000   3000           100            100            0.033326843   -4.8356934e-19  0              0.099980529    1.3448614e-16  0              6.4938544e-09 -1.5            0              2.9994159    
   2800000   3000           100            100            0.033326843   -4.8356934e-19  0              0.099980529    3.882331e-19   0              1.8746387e-11 -1.5            0              2.9994159    
   2900000   3000           100            100            0.033326843   -4.8356933e-19  0              0.099980529    6.4608257e-18  0              3.1197015e-10 -1.5            0              2.9994159    
   3000000   3000           100            100            0.033326843   -4.8356934e-19  0              0.099980529    7.3238381e-18  0              3.5364193e-10 -1.5            0              2.9994159    
Loop time of 395.588 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6552267.545 ns/day, 0.000 hours/ns, 7583.643 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.56     | 167.83     | 168.11     |   2.1 | 42.43
Neigh   | 0.99765    | 0.99766    | 0.99768    |   0.0 |  0.25
Comm    | 12.081     | 12.394     | 12.707     |   8.9 |  3.13
Output  | 0.27921    | 0.27924    | 0.27926    |   0.0 |  0.07
Modify  | 193.78     | 193.82     | 193.86     |   0.3 | 48.99
Other   |            | 20.27      |            |       |  5.12

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027712201    5.3247808e-22  0              0.083136602    604681.73      0              2.9197917e+13 -1.5            0              3.3122423    
    200000   3000           100            100            0.011062512    1.1461283e-21  0              0.033187536    177627.28      0              8.5769857e+12 -1.5            0              3.0462804    
    300000   3000           100            100            0.0032933893   1.5086104e-21  0              0.0098801678   26108.819      0              1.2607014e+12 -1.5            0              3.0303324    
    400000   3000           100            100            0.41732533    -5.1954587e-18  0              1.251976       400.57372      0              1.9342271e+10 -1.5            0              2.9968725    
    500000   3000           100            100            4.3958078e-05  1.7708551e-21  0              0.00013187423  7.1397355      0              3.4475227e+08 -1.5            0              3.0025466    
    600000   3000           100            100            0.087001538   -1.0920401e-18  0              0.26100461     112.30952      0              5.423025e+09  -1.5            0              2.9989018    
    700000   3000           100            100            0.014885227   -1.8689055e-19  0              0.044655682    0.00034959057  0              16880.478     -1.5            0              2.9996611    
    800000   3000           100            100            0.032646019   -4.1010094e-19  0              0.097938057    9.185086       0              4.4351493e+08 -1.5            0              2.9994274    
    900000   3000           100            100            0.035029807   -4.3934523e-19  0              0.10508942     0.72445581     0              34981378      -1.5            0              2.9994003    
   1000000   3000           100            100            0.034277169   -4.2973705e-19  0              0.10283151     0.0062997602   0              304192.87     -1.5            0              2.999409     
   1100000   3000           100            100            0.033642828   -4.21773e-19    0              0.10092848     0.0042898977   0              207143.81     -1.5            0              2.9994164    
   1200000   3000           100            100            0.033383189   -4.1853304e-19  0              0.10014957     0.0023153414   0              111799.55     -1.5            0              2.9994194    
   1300000   3000           100            100            0.033317518   -4.1771843e-19  0              0.099952555    0.00036312387  0              17533.952     -1.5            0              2.9994201    
   1400000   3000           100            100            0.033314025   -4.1767821e-19  0              0.099942076    2.1238502e-05  0              1025.5313     -1.5            0              2.9994202    
   1500000   3000           100            100            0.033320715   -4.1776311e-19  0              0.099962145    1.7161023e-08  0              0.8286444     -1.5            0              2.9994201    
   1600000   3000           100            100            0.033325035   -4.1781748e-19  0              0.099975105    2.8656227e-07  0              13.837067     -1.5            0              2.99942      
   1700000   3000           100            100            0.033326639   -4.178375e-19   0              0.099979916    1.0624399e-07  0              5.1301421     -1.5            0              2.99942      
   1800000   3000           100            100            0.033326991   -4.1784169e-19  0              0.099980972    1.3676441e-08  0              0.66038637    -1.5            0              2.99942      
   1900000   3000           100            100            0.033326981   -4.1784164e-19  0              0.099980942    5.8625415e-10  0              0.028308115   -1.5            0              2.99942      
   2000000   3000           100            100            0.033326929   -4.1784101e-19  0              0.099980786    2.3761221e-12  0              0.00011473443 -1.5            0              2.99942      
   2100000   3000           100            100            0.0333269     -4.1784067e-19  0              0.099980699    1.6803763e-11  0              0.00081139357 -1.5            0              2.99942      
   2200000   3000           100            100            0.03332689    -4.1784055e-19  0              0.09998067     4.6584768e-12  0              0.00022494117 -1.5            0              2.99942      
   2300000   3000           100            100            0.033326888   -4.1784052e-19  0              0.099980665    4.9119416e-13  0              2.3718008e-05 -1.5            0              2.99942      
   2400000   3000           100            100            0.033326889   -4.1784052e-19  0              0.099980666    1.3836344e-14  0              6.6810752e-07 -1.5            0              2.99942      
   2500000   3000           100            100            0.033326889   -4.178405e-19   0              0.099980667    6.7780831e-16  0              3.2728938e-08 -1.5            0              2.99942      
   2600000   3000           100            100            0.033326889   -4.178405e-19   0              0.099980667    9.307075e-16   0              4.4940534e-08 -1.5            0              2.99942      
   2700000   3000           100            100            0.033326889   -4.178405e-19   0              0.099980668    1.5907464e-16  0              7.6811449e-09 -1.5            0              2.99942      
   2800000   3000           100            100            0.033326889   -4.178405e-19   0              0.099980668    1.6196366e-17  0              7.8206457e-10 -1.5            0              2.99942      
   2900000   3000           100            100            0.033326889   -4.178405e-19   0              0.099980668    2.0531697e-18  0              9.9140218e-11 -1.5            0              2.99942      
   3000000   3000           100            100            0.033326889   -4.1784049e-19  0              0.099980668    2.5913721e-19  0              1.2512809e-11 -1.5            0              2.99942      
Loop time of 395.385 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6555629.407 ns/day, 0.000 hours/ns, 7587.534 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.89     | 168.14     | 168.39     |   1.9 | 42.53
Neigh   | 0.97092    | 0.97127    | 0.97163    |   0.0 |  0.25
Comm    | 12.028     | 12.304     | 12.579     |   7.9 |  3.11
Output  | 0.3223     | 0.32231    | 0.32233    |   0.0 |  0.08
Modify  | 193.54     | 193.58     | 193.62     |   0.3 | 48.96
Other   |            | 20.07      |            |       |  5.08

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3 #*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 3                                                               
Lattice spacing in x,y,z = 3 3 3

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -1500 ${n1e1} -50 50 -50 50 units box
region box block -1500 1500 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -1500 1500 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-1500 -50 -50) to (1500 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1000 atoms
  using lattice units in orthogonal box = (-1500 -50 -50) to (1500 50 50)
  create_atoms CPU = 0.001 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  1000 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1000 settings made for mass


group substrate region substrate           # Define gorup
1000 atoms in group substrate
group slider1 region slider1
1000 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1000 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 1936 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.97 | 30.97 | 30.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   3000           100            100            0              0              0              0              0              0              0             -1.5            0              6            
    100000   3000           100            100            0.027714497    1.3120863e-21  0              0.083143491    604757.25      0              2.9201563e+13 -1.5            0              3.3121789    
    200000   3000           100            100            0.011067682    1.8741231e-21  0              0.033203045    177756.1       0              8.5832058e+12 -1.5            0              3.0461636    
    300000   3000           100            100            0.0033019942   1.5817473e-21  0              0.0099059826   26226.101      0              1.2663646e+12 -1.5            0              3.0302322    
    400000   3000           100            100            0.42419591    -4.4304464e-18  0              1.2725877      103.07206      0              4.9769808e+09 -1.5            0              2.9968607    
    500000   3000           100            100            7.7471598e-05  1.5856943e-21  0              0.00023241479  21.774739      0              1.0514242e+09 -1.5            0              3.0025413    
    600000   3000           100            100            0.095061716   -1.0014042e-18  0              0.28518515     0.72136941     0              34832347      -1.5            0              2.9988421    
    700000   3000           100            100            0.02628047    -2.742095e-19   0              0.07884141     60.726089      0              2.9322455e+09 -1.5            0              2.9995103    
    800000   3000           100            100            0.028310326   -2.9693294e-19  0              0.084930979    4.7574985      0              2.2972258e+08 -1.5            0              2.9994841    
    900000   3000           100            100            0.03214427    -3.3733454e-19  0              0.09643281     0.98585728     0              47603520      -1.5            0              2.9994382    
   1000000   3000           100            100            0.033269428   -3.4927675e-19  0              0.099808283    0.16279958     0              7861009       -1.5            0              2.999425     
   1100000   3000           100            100            0.033449239   -3.5122352e-19  0              0.10034772     0.019129985    0              923718.51     -1.5            0              2.9994229    
   1200000   3000           100            100            0.033416202   -3.5089912e-19  0              0.10024861     0.0015053433   0              72687.643     -1.5            0              2.9994233    
   1300000   3000           100            100            0.033370271   -3.5042287e-19  0              0.10011081     5.7133539e-05  0              2758.7741     -1.5            0              2.9994238    
   1400000   3000           100            100            0.033344021   -3.5014942e-19  0              0.10003206     9.5793062e-09  0              0.46255042    -1.5            0              2.9994241    
   1500000   3000           100            100            0.033332594   -3.5003025e-19  0              0.099997782    1.1386898e-06  0              54.983256     -1.5            0              2.9994242    
   1600000   3000           100            100            0.033328448   -3.4998695e-19  0              0.099985343    4.8879015e-07  0              23.601927     -1.5            0              2.9994243    
   1700000   3000           100            100            0.033327195   -3.4997376e-19  0              0.099981585    1.0570294e-07  0              5.1040169     -1.5            0              2.9994243    
   1800000   3000           100            100            0.033326909   -3.4997071e-19  0              0.099980727    1.5449443e-08  0              0.74599829    -1.5            0              2.9994243    
   1900000   3000           100            100            0.033326884   -3.4997042e-19  0              0.099980652    1.5883289e-09  0              0.076694717   -1.5            0              2.9994243    
   2000000   3000           100            100            0.033326905   -3.4997062e-19  0              0.099980715    1.0242993e-10  0              0.0049459749  -1.5            0              2.9994243    
   2100000   3000           100            100            0.033326923   -3.499708e-19   0              0.099980768    2.1630481e-12  0              0.00010444585 -1.5            0              2.9994243    
   2200000   3000           100            100            0.033326931   -3.4997089e-19  0              0.099980794    1.2947464e-13  0              6.251867e-06  -1.5            0              2.9994243    
   2300000   3000           100            100            0.033326935   -3.4997093e-19  0              0.099980805    1.8945743e-13  0              9.1482212e-06 -1.5            0              2.9994243    
   2400000   3000           100            100            0.033326936   -3.4997094e-19  0              0.099980809    5.9233885e-14  0              2.8601923e-06 -1.5            0              2.9994243    
   2500000   3000           100            100            0.033326937   -3.4997088e-19  0              0.09998081     1.0899055e-14  0              5.2627634e-07 -1.5            0              2.9994243    
   2600000   3000           100            100            0.033326937   -3.4997089e-19  0              0.09998081     1.3899455e-15  0              6.7115495e-08 -1.5            0              2.9994243    
   2700000   3000           100            100            0.033326937   -3.4997092e-19  0              0.09998081     4.223418e-17   0              2.0393374e-09 -1.5            0              2.9994243    
   2800000   3000           100            100            0.033326937   -3.4997092e-19  0              0.09998081     6.5333203e-21  0              3.1547066e-13 -1.5            0              2.9994243    
   2900000   3000           100            100            0.033326937   -3.4997092e-19  0              0.09998081     3.3350792e-18  0              1.6103904e-10 -1.5            0              2.9994243    
   3000000   3000           100            100            0.033326937   -3.4997093e-19  0              0.09998081     2.1343122e-18  0              1.030583e-10  -1.5            0              2.9994243    
Loop time of 396.55 on 2 procs for 3000000 steps with 2000 atoms

Performance: 6536376.411 ns/day, 0.000 hours/ns, 7565.250 timesteps/s
100.0% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.51     | 168.85     | 169.19     |   2.6 | 42.58
Neigh   | 0.99192    | 0.99204    | 0.99216    |   0.0 |  0.25
Comm    | 11.857     | 12.205     | 12.553     |  10.0 |  3.08
Output  | 0.2795     | 0.27953    | 0.27956    |   0.0 |  0.07
Modify  | 193.97     | 194.02     | 194.06     |   0.3 | 48.93
Other   |            | 20.21      |            |       |  5.10

Nlocal:           1000 ave        1000 max        1000 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              6 ave           6 max           6 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:           1500 ave        1500 max        1500 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 3000
Ave neighs/atom = 1.5
Neighbor list builds = 174
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 4:02:10

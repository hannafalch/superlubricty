LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35  #36 37 38 39 40 41 42 43 44 45

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.1 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.6944256e-15  1.4083277e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019573611    1.4083277e-14  0              0.058720834    16874.909      0              8.1482897e+11  0              0              3.3273508    
    200000   120            100            100            0.0068111099   1.4083277e-14  0              0.02043333     3998.9609      0              1.9309551e+11  0              0              3.07603      
    300000   120            100            100            0.0002141941   1.4083277e-14  0              0.0006425823   8.5449962      0              4.1260729e+08  0              0              3.0436223    
    400000   120            100            100            3.0398129e-05  1.4083277e-14  0              9.1194388e-05  0.188378       0              9096099.7      0              0              3.0052305    
    500000   120            100            100            0.0098011404   1.4083277e-14  0              0.029403421    9.9319421      0              4.7957794e+08  0              0              2.996612     
    600000   120            100            100            0.023052283    1.4083277e-14  0              0.069156849    4.6546476      0              2.2475627e+08  0              0              2.9939369    
    700000   120            100            100            0.022915852    1.4083277e-14  0              0.068747555    0.48995969     0              23658400       0              0              2.9939424    
    800000   120            100            100            0.023448932    1.4083277e-14  0              0.070346795    0.039944466    0              1928775.3      0              0              2.9938423    
    900000   120            100            100            0.023811657    1.4083277e-14  0              0.071434972    0.0020550506   0              99231.04       0              0              2.9937769    
   1000000   120            100            100            0.023993212    1.4083277e-14  0              0.071979635    2.1848276e-05  0              1054.975       0              0              2.9937448    
   1100000   120            100            100            0.024071277    1.4083277e-14  0              0.07221383     8.217519e-06   0              396.79458      0              0              2.9937311    
   1200000   120            100            100            0.024101355    1.4083277e-14  0              0.072304065    6.9691541e-06  0              336.51551      0              0              2.9937259    
   1300000   120            100            100            0.024111845    1.4083277e-14  0              0.072335536    2.1324374e-06  0              102.96777      0              0              2.9937241    
   1400000   120            100            100            0.024115119    1.4083277e-14  0              0.072345356    4.4235067e-07  0              21.359531      0              0              2.9937235    
   1500000   120            100            100            0.024115991    1.4083277e-14  0              0.072347972    7.1834169e-08  0              3.4686149      0              0              2.9937233    
   1600000   120            100            100            0.024116158    1.4083277e-14  0              0.072348475    9.5329272e-09  0              0.46031094     0              0              2.9937233    
   1700000   120            100            100            0.024116158    1.4083277e-14  0              0.072348473    1.0295154e-09  0              0.049711613    0              0              2.9937233    
   1800000   120            100            100            0.024116134    1.4083277e-14  0              0.072348403    8.5577553e-11  0              0.0041322337   0              0              2.9937233    
   1900000   120            100            100            0.024116118    1.4083277e-14  0              0.072348355    4.5563173e-12  0              0.00022000826  0              0              2.9937233    
   2000000   120            100            100            0.02411611     1.4083277e-14  0              0.072348331    5.8824474e-14  0              2.8404233e-06  0              0              2.9937233    
   2100000   120            100            100            0.024116107    1.4083277e-14  0              0.07234832     1.41694e-14    0              6.8418961e-07  0              0              2.9937233    
   2200000   120            100            100            0.024116105    1.4083277e-14  0              0.072348316    1.3501088e-14  0              6.5191921e-07  0              0              2.9937233    
   2300000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    4.2495052e-15  0              2.051934e-07   0              0              2.9937233    
   2400000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    8.9420301e-16  0              4.3177863e-08  0              0              2.9937233    
   2500000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    1.4706957e-16  0              7.101463e-09   0              0              2.9937233    
   2600000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    1.9818378e-17  0              9.5695857e-10  0              0              2.9937233    
   2700000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    2.5245996e-18  0              1.2190388e-10  0              0              2.9937233    
   2800000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    1.5978106e-19  0              7.7152556e-12  0              0              2.9937233    
   2900000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    3.3432996e-20  0              1.6143597e-12  0              0              2.9937233    
   3000000   120            100            100            0.024116105    1.4083277e-14  0              0.072348314    1.0851157e-20  0              5.2396354e-13  0              0              2.9937233    
Loop time of 26.6861 on 2 procs for 3000000 steps with 58 atoms

Performance: 97129148.782 ns/day, 0.000 hours/ns, 112417.996 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.5601     | 2.7771     | 2.9941     |  13.0 | 10.41
Neigh   | 0.040535   | 0.040569   | 0.040603   |   0.0 |  0.15
Comm    | 8.4811     | 8.6783     | 8.8756     |   6.7 | 32.52
Output  | 0.12066    | 0.12069    | 0.12073    |   0.0 |  0.45
Modify  | 11.854     | 11.945     | 12.037     |   2.7 | 44.76
Other   |            | 3.124      |            |       | 11.71

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.11 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.7044046e-15  1.4113214e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019574202    1.4113214e-14  0              0.058722606    16875.66       0              8.1486524e+11  0              0              3.3273333    
    200000   120            100            100            0.006812441    1.4113214e-14  0              0.020437323    4000.1809      0              1.9315442e+11  0              0              3.0759987    
    300000   120            100            100            0.0002160489   1.4113214e-14  0              0.00064814671  8.6899925      0              4.1960864e+08  0              0              3.0436306    
    400000   120            100            100            3.5074027e-05  1.4113214e-14  0              0.00010522208  0.24948503     0              12046739       0              0              3.0052376    
    500000   120            100            100            0.010008085    1.4113214e-14  0              0.030024255    10.799418      0              5.2146524e+08  0              0              2.9965705    
    600000   120            100            100            0.023476469    1.4113214e-14  0              0.070429406    4.7420431      0              2.2897629e+08  0              0              2.9938711    
    700000   120            100            100            0.023193937    1.4113214e-14  0              0.06958181     0.55445798     0              26772792       0              0              2.9939026    
    800000   120            100            100            0.023576088    1.4113214e-14  0              0.070728265    0.056283953    0              2717750.7      0              0              2.9938292    
    900000   120            100            100            0.023856315    1.4113214e-14  0              0.071568945    0.0046871808   0              226327.19      0              0              2.9937782    
   1000000   120            100            100            0.024003958    1.4113214e-14  0              0.072011874    0.00027833097  0              13439.606      0              0              2.9937519    
   1100000   120            100            100            0.02407135     1.4113214e-14  0              0.07221405     6.8785904e-06  0              332.14251      0              0              2.99374      
   1200000   120            100            100            0.024099412    1.4113214e-14  0              0.072298236    1.5122111e-07  0              7.3019261      0              0              2.9937351    
   1300000   120            100            100            0.024110293    1.4113214e-14  0              0.07233088     3.9962902e-07  0              19.296655      0              0              2.9937332    
   1400000   120            100            100            0.024114252    1.4113214e-14  0              0.072342755    1.5838261e-07  0              7.6477292      0              0              2.9937325    
   1500000   120            100            100            0.024115601    1.4113214e-14  0              0.072346802    3.9251859e-08  0              1.8953318      0              0              2.9937323    
   1600000   120            100            100            0.024116026    1.4113214e-14  0              0.072348079    7.632026e-09   0              0.36852322     0              0              2.9937322    
   1700000   120            100            100            0.024116147    1.4113214e-14  0              0.072348442    1.2573491e-09  0              0.06071289     0              0              2.9937322    
   1800000   120            100            100            0.024116176    1.4113214e-14  0              0.072348527    1.8096848e-10  0              0.0087383204   0              0              2.9937322    
   1900000   120            100            100            0.02411618     1.4113214e-14  0              0.072348539    2.2946414e-11  0              0.0011080002   0              0              2.9937322    
   2000000   120            100            100            0.024116179    1.4113214e-14  0              0.072348536    2.5406455e-12  0              0.00012267868  0              0              2.9937322    
   2100000   120            100            100            0.024116178    1.4113214e-14  0              0.072348533    2.3807965e-13  0              1.1496014e-05  0              0              2.9937322    
   2200000   120            100            100            0.024116177    1.4113214e-14  0              0.07234853     1.7449407e-14  0              8.4256942e-07  0              0              2.9937322    
   2300000   120            100            100            0.024116176    1.4113214e-14  0              0.072348529    7.8575011e-16  0              3.7941061e-08  0              0              2.9937322    
   2400000   120            100            100            0.024116176    1.4113214e-14  0              0.072348529    4.3867988e-18  0              2.1182281e-10  0              0              2.9937322    
   2500000   120            100            100            0.024116176    1.4113214e-14  0              0.072348529    4.8270004e-18  0              2.3307857e-10  0              0              2.9937322    
   2600000   120            100            100            0.024116176    1.4113214e-14  0              0.072348528    3.291603e-18   0              1.5893973e-10  0              0              2.9937322    
   2700000   120            100            100            0.024116176    1.4113214e-14  0              0.072348528    5.2839556e-19  0              2.551433e-11   0              0              2.9937322    
   2800000   120            100            100            0.024116176    1.4113214e-14  0              0.072348528    2.1578129e-19  0              1.0419306e-11  0              0              2.9937322    
   2900000   120            100            100            0.024116176    1.4113214e-14  0              0.072348528    2.0319309e-19  0              9.811467e-12   0              0              2.9937322    
   3000000   120            100            100            0.024116176    1.4113214e-14  0              0.072348528    1.9586245e-20  0              9.4574968e-13  0              0              2.9937322    
Loop time of 26.6927 on 2 procs for 3000000 steps with 58 atoms

Performance: 97105161.722 ns/day, 0.000 hours/ns, 112390.233 timesteps/s
99.6% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4279     | 2.5869     | 2.7459     |   9.9 |  9.69
Neigh   | 0.041097   | 0.041111   | 0.041124   |   0.0 |  0.15
Comm    | 8.8856     | 9.0117     | 9.1378     |   4.2 | 33.76
Output  | 0.22785    | 0.2279     | 0.22796    |   0.0 |  0.85
Modify  | 11.644     | 11.656     | 11.669     |   0.4 | 43.67
Other   |            | 3.169      |            |       | 11.87

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.12 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.7153828e-15  1.4146149e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.01957485     1.4146149e-14  0              0.05872455     16876.485      0              8.1490507e+11  0              0              3.3273139    
    200000   120            100            100            0.0068139079   1.4146149e-14  0              0.020441724    4001.5256      0              1.9321935e+11  0              0              3.075964     
    300000   120            100            100            0.00021809594  1.4146149e-14  0              0.00065428781  8.8513698      0              4.2740097e+08  0              0              3.0436396    
    400000   120            100            100            4.0226632e-05  1.4146149e-14  0              0.0001206799   0.32665844     0              15773167       0              0              3.0052451    
    500000   120            100            100            0.010248001    1.4146149e-14  0              0.030744003    11.779818      0              5.6880526e+08  0              0              2.9965225    
    600000   120            100            100            0.023952386    1.4146149e-14  0              0.071857159    4.7942963      0              2.3149941e+08  0              0              2.9937977    
    700000   120            100            100            0.023518984    1.4146149e-14  0              0.070556951    0.60891198     0              29402180       0              0              2.9938555    
    800000   120            100            100            0.023738381    1.4146149e-14  0              0.071215142    0.072239386    0              3488181.4      0              0              2.9938109    
    900000   120            100            100            0.023924116    1.4146149e-14  0              0.071772349    0.0079164881   0              382258.88      0              0              2.9937764    
   1000000   120            100            100            0.024028266    1.4146149e-14  0              0.072084797    0.00078404072  0              37858.521      0              0              2.9937575    
   1100000   120            100            100            0.024078575    1.4146149e-14  0              0.072235726    6.7510765e-05  0              3259.8532      0              0              2.9937486    
   1200000   120            100            100            0.024100898    1.4146149e-14  0              0.072302693    4.645162e-06   0              224.29825      0              0              2.9937446    
   1300000   120            100            100            0.024110242    1.4146149e-14  0              0.072330726    2.0021947e-07  0              9.6678814      0              0              2.993743     
   1400000   120            100            100            0.024113982    1.4146149e-14  0              0.072341947    1.0296505e-09  0              0.049718136    0              0              2.9937423    
   1500000   120            100            100            0.024115424    1.4146149e-14  0              0.072346273    1.3939478e-09  0              0.067308751    0              0              2.9937421    
   1600000   120            100            100            0.024115961    1.4146149e-14  0              0.072347884    9.8322371e-10  0              0.047476354    0              0              2.993742     
   1700000   120            100            100            0.024116155    1.4146149e-14  0              0.072348464    3.1100842e-10  0              0.015017484    0              0              2.993742     
   1800000   120            100            100            0.024116222    1.4146149e-14  0              0.072348666    7.2535072e-11  0              0.003502459    0              0              2.9937419    
   1900000   120            100            100            0.024116244    1.4146149e-14  0              0.072348733    1.4256759e-11  0              0.00068840788  0              0              2.9937419    
   2000000   120            100            100            0.024116252    1.4146149e-14  0              0.072348755    2.4944607e-12  0              0.00012044858  0              0              2.9937419    
   2100000   120            100            100            0.024116254    1.4146149e-14  0              0.072348761    3.9930198e-13  0              1.9280864e-05  0              0              2.9937419    
   2200000   120            100            100            0.024116254    1.4146149e-14  0              0.072348763    5.9261897e-14  0              2.8615449e-06  0              0              2.9937419    
   2300000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    8.214171e-15   0              3.9663292e-07  0              0              2.9937419    
   2400000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    1.0645911e-15  0              5.1405296e-08  0              0              2.9937419    
   2500000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    1.2661095e-16  0              6.1135897e-09  0              0              2.9937419    
   2600000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    1.3933508e-17  0              6.7279925e-10  0              0              2.9937419    
   2700000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    1.8653821e-18  0              9.0072626e-11  0              0              2.9937419    
   2800000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    9.279766e-20   0              4.4808669e-12  0              0              2.9937419    
   2900000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    3.82255e-21    0              1.8457726e-13  0              0              2.9937419    
   3000000   120            100            100            0.024116255    1.4146149e-14  0              0.072348764    2.0504292e-19  0              9.9007887e-12  0              0              2.9937419    
Loop time of 26.458 on 2 procs for 3000000 steps with 58 atoms

Performance: 97966580.145 ns/day, 0.000 hours/ns, 113387.246 timesteps/s
99.6% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4011     | 2.5418     | 2.6824     |   8.8 |  9.61
Neigh   | 0.040425   | 0.040465   | 0.040504   |   0.0 |  0.15
Comm    | 8.89       | 9.0674     | 9.2449     |   5.9 | 34.27
Output  | 0.18598    | 0.18602    | 0.18605    |   0.0 |  0.70
Modify  | 11.45      | 11.489     | 11.528     |   1.1 | 43.42
Other   |            | 3.133      |            |       | 11.84

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.13 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.727374e-15   1.4182122e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019575556    1.4182122e-14  0              0.058726668    16877.384      0              8.1494847e+11  0              0              3.3272927    
    200000   120            100            100            0.0068155105   1.4182122e-14  0              0.020446531    4002.9951      0              1.9329031e+11  0              0              3.0759259    
    300000   120            100            100            0.00022033481  1.4182122e-14  0              0.00066100443  9.0294948      0              4.3600199e+08  0              0              3.0436493    
    400000   120            100            100            4.5857255e-05  1.4182122e-14  0              0.00013757176  0.42274498     0              20412842       0              0              3.0052528    
    500000   120            100            100            0.010524684    1.4182122e-14  0              0.031574052    12.877928      0              6.2182905e+08  0              0              2.9964672    
    600000   120            100            100            0.024480634    1.4182122e-14  0              0.073441902    4.7964804      0              2.3160487e+08  0              0              2.9937168    
    700000   120            100            100            0.023890146    1.4182122e-14  0              0.071670437    0.64374393     0              31084090       0              0              2.9938016    
    800000   120            100            100            0.023934786    1.4182122e-14  0              0.071804357    0.084193809    0              4065417.7      0              0              2.9937875    
    900000   120            100            100            0.024014748    1.4182122e-14  0              0.072044245    0.010757913    0              519461.14      0              0              2.9937714    
   1000000   120            100            100            0.024066494    1.4182122e-14  0              0.072199481    0.0013396007   0              64684.524      0              0              2.9937616    
   1100000   120            100            100            0.024093606    1.4182122e-14  0              0.072280817    0.00016216461  0              7830.3484      0              0              2.9937566    
   1200000   120            100            100            0.024106453    1.4182122e-14  0              0.07231936     1.9021223e-05  0              918.46679      0              0              2.9937543    
   1300000   120            100            100            0.024112184    1.4182122e-14  0              0.072336553    2.151439e-06   0              103.88529      0              0              2.9937533    
   1400000   120            100            100            0.024114638    1.4182122e-14  0              0.072343915    2.3297611e-07  0              11.249583      0              0              2.9937528    
   1500000   120            100            100            0.024115657    1.4182122e-14  0              0.072346972    2.3889669e-08  0              1.1535466      0              0              2.9937526    
   1600000   120            100            100            0.024116071    1.4182122e-14  0              0.072348213    2.2788757e-09  0              0.11003875     0              0              2.9937526    
   1700000   120            100            100            0.024116236    1.4182122e-14  0              0.072348707    1.960475e-10   0              0.0094664319   0              0              2.9937525    
   1800000   120            100            100            0.0241163      1.4182122e-14  0              0.0723489      1.4299922e-11  0              0.00069049206  0              0              2.9937525    
   1900000   120            100            100            0.024116325    1.4182122e-14  0              0.072348974    7.5904618e-13  0              3.6651624e-05  0              0              2.9937525    
   2000000   120            100            100            0.024116334    1.4182122e-14  0              0.072349003    1.5756183e-14  0              7.6080968e-07  0              0              2.9937525    
   2100000   120            100            100            0.024116338    1.4182122e-14  0              0.072349013    6.8062693e-16  0              3.2865039e-08  0              0              2.9937525    
   2200000   120            100            100            0.024116339    1.4182122e-14  0              0.072349017    1.3012181e-15  0              6.2831163e-08  0              0              2.9937525    
   2300000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    5.1842063e-16  0              2.5032677e-08  0              0              2.9937525    
   2400000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    1.397538e-16   0              6.748211e-09   0              0              2.9937525    
   2500000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    2.9297621e-17  0              1.4146773e-09  0              0              2.9937525    
   2600000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    5.3577377e-18  0              2.5870598e-10  0              0              2.9937525    
   2700000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    4.8283387e-19  0              2.3314319e-11  0              0              2.9937525    
   2800000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    1.361385e-19   0              6.573641e-12   0              0              2.9937525    
   2900000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    2.140485e-19   0              1.0335636e-11  0              0              2.9937525    
   3000000   120            100            100            0.02411634     1.4182122e-14  0              0.072349019    1.6816973e-20  0              8.1203145e-13  0              0              2.9937525    
Loop time of 26.0247 on 2 procs for 3000000 steps with 58 atoms

Performance: 99597705.761 ns/day, 0.000 hours/ns, 115275.122 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4012     | 2.603      | 2.8047     |  12.5 | 10.00
Neigh   | 0.041328   | 0.041376   | 0.041424   |   0.0 |  0.16
Comm    | 8.5731     | 8.7747     | 8.9763     |   6.8 | 33.72
Output  | 0.15211    | 0.15214    | 0.15217    |   0.0 |  0.58
Modify  | 11.233     | 11.324     | 11.415     |   2.7 | 43.51
Other   |            | 3.13       |            |       | 12.03

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.14 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.740393e-15   1.4221179e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.01957632     1.4221179e-14  0              0.058728961    16878.357      0              8.1499548e+11  0              0              3.3272697    
    200000   120            100            100            0.0068172505   1.4221179e-14  0              0.020451751    4004.591       0              1.9336737e+11  0              0              3.0758845    
    300000   120            100            100            0.00022276831  1.4221179e-14  0              0.00066830492  9.2250263      0              4.454435e+08   0              0              3.0436597    
    400000   120            100            100            5.1971536e-05  1.4221179e-14  0              0.00015591461  0.54093563     0              26119846       0              0              3.0052606    
    500000   120            100            100            0.010842432    1.4221179e-14  0              0.032527296    14.097542      0              6.8071986e+08  0              0              2.9964041    
    600000   120            100            100            0.025060521    1.4221179e-14  0              0.075181564    4.7324173      0              2.2851149e+08  0              0              2.9936287    
    700000   120            100            100            0.024302806    1.4221179e-14  0              0.072908419    0.64859264     0              31318217       0              0              2.9937417    
    800000   120            100            100            0.024159523    1.4221179e-14  0              0.072478568    0.088011047    0              4249738.5      0              0              2.9937602    
    900000   120            100            100            0.024123599    1.4221179e-14  0              0.072370796    0.011923613    0              575748.59      0              0              2.9937641    
   1000000   120            100            100            0.024115774    1.4221179e-14  0              0.072347323    0.0016132369   0              77897.437      0              0              2.9937646    
   1100000   120            100            100            0.024114956    1.4221179e-14  0              0.072344867    0.00021795363  0              10524.201      0              0              2.9937644    
   1200000   120            100            100            0.024115432    1.4221179e-14  0              0.072346295    2.9402645e-05  0              1419.7485      0              0              2.9937642    
   1300000   120            100            100            0.024115896    1.4221179e-14  0              0.072347687    3.960579e-06   0              191.24219      0              0              2.9937641    
   1400000   120            100            100            0.024116173    1.4221179e-14  0              0.072348518    5.3269364e-07  0              25.72187       0              0              2.993764     
   1500000   120            100            100            0.024116314    1.4221179e-14  0              0.072348942    7.1538421e-08  0              3.4543343      0              0              2.993764     
   1600000   120            100            100            0.02411638     1.4221179e-14  0              0.072349141    9.5926689e-09  0              0.46319565     0              0              2.993764     
   1700000   120            100            100            0.02411641     1.4221179e-14  0              0.07234923     1.2843161e-09  0              0.062015029    0              0              2.993764     
   1800000   120            100            100            0.024116423    1.4221179e-14  0              0.072349268    1.7168525e-10  0              0.0082900664   0              0              2.993764     
   1900000   120            100            100            0.024116428    1.4221179e-14  0              0.072349285    2.2914411e-11  0              0.0011064549   0              0              2.993764     
   2000000   120            100            100            0.02411643     1.4221179e-14  0              0.072349291    3.0533403e-12  0              0.00014743488  0              0              2.993764     
   2100000   120            100            100            0.024116431    1.4221179e-14  0              0.072349294    4.0623506e-13  0              1.9615637e-05  0              0              2.993764     
   2200000   120            100            100            0.024116432    1.4221179e-14  0              0.072349295    5.3948916e-14  0              2.6050001e-06  0              0              2.993764     
   2300000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    7.1548044e-15  0              3.454799e-07   0              0              2.993764     
   2400000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    9.476064e-16   0              4.5756522e-08  0              0              2.993764     
   2500000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    1.2281945e-16  0              5.9305117e-09  0              0              2.993764     
   2600000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    1.623161e-17   0              7.8376637e-10  0              0              2.993764     
   2700000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    2.4893682e-18  0              1.2020268e-10  0              0              2.993764     
   2800000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    2.6681572e-19  0              1.2883576e-11  0              0              2.993764     
   2900000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    1.012225e-20   0              4.8876721e-13  0              0              2.993764     
   3000000   120            100            100            0.024116432    1.4221179e-14  0              0.072349296    1.8662247e-19  0              9.0113309e-12  0              0              2.993764     
Loop time of 25.9615 on 2 procs for 3000000 steps with 58 atoms

Performance: 99840272.164 ns/day, 0.000 hours/ns, 115555.871 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.401      | 2.5724     | 2.7439     |  10.7 |  9.91
Neigh   | 0.041317   | 0.041367   | 0.041417   |   0.0 |  0.16
Comm    | 8.5228     | 8.6877     | 8.8527     |   5.6 | 33.46
Output  | 0.11766    | 0.11769    | 0.11772    |   0.0 |  0.45
Modify  | 11.33      | 11.414     | 11.498     |   2.5 | 43.97
Other   |            | 3.128      |            |       | 12.05

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.15 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.7544566e-15  1.426337e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019577143    1.426337e-14   0              0.058731429    16879.406      0              8.1504609e+11  0              0              3.3272447    
    200000   120            100            100            0.0068191277   1.426337e-14   0              0.020457383    4006.3131      0              1.9345052e+11  0              0              3.0758396    
    300000   120            100            100            0.00022539573  1.426337e-14   0              0.00067618718  9.4383833      0              4.5574575e+08  0              0              3.0436707    
    400000   120            100            100            5.8570842e-05  1.426337e-14   0              0.00017571253  0.68461998     0              33057849       0              0              3.0052685    
    500000   120            100            100            0.011205929    1.426337e-14   0              0.033617787    15.440399      0              7.4556161e+08  0              0              2.9963322    
    600000   120            100            100            0.025689412    1.426337e-14   0              0.077068237    4.585751       0              2.214295e+08   0              0              2.9935341    
    700000   120            100            100            0.024747268    1.426337e-14   0              0.074241803    0.61436818     0              29665641       0              0              2.9936776    
    800000   120            100            100            0.024400608    1.426337e-14   0              0.073201823    0.080444227    0              3884363.8      0              0              2.9937309    
    900000   120            100            100            0.024240511    1.426337e-14   0              0.072721532    0.010436083    0              503921.09      0              0              2.9937562    
   1000000   120            100            100            0.024169057    1.426337e-14   0              0.072507171    0.0013432605   0              64861.24       0              0              2.9937677    
   1100000   120            100            100            0.024138311    1.426337e-14   0              0.072414933    0.00017146996  0              8279.6708      0              0              2.9937727    
   1200000   120            100            100            0.024125416    1.426337e-14   0              0.072376248    2.1694036e-05  0              1047.5273      0              0              2.9937748    
   1300000   120            100            100            0.024120109    1.426337e-14   0              0.072360326    2.7183621e-06  0              131.25998      0              0              2.9937757    
   1400000   120            100            100            0.024117956    1.426337e-14   0              0.072353868    3.3708115e-07  0              16.276442      0              0              2.993776     
   1500000   120            100            100            0.024117094    1.426337e-14   0              0.072351281    4.1323576e-08  0              1.9953676      0              0              2.9937762    
   1600000   120            100            100            0.024116751    1.426337e-14   0              0.072350254    5.0023824e-09  0              0.24154714     0              0              2.9937762    
   1700000   120            100            100            0.024116617    1.426337e-14   0              0.07234985     5.9706538e-10  0              0.02883015     0              0              2.9937763    
   1800000   120            100            100            0.024116564    1.426337e-14   0              0.072349693    7.0130063e-11  0              0.0033863298   0              0              2.9937763    
   1900000   120            100            100            0.024116544    1.426337e-14   0              0.072349631    8.0869699e-12  0              0.00039049083  0              0              2.9937763    
   2000000   120            100            100            0.024116536    1.426337e-14   0              0.072349608    9.1244584e-13  0              4.4058744e-05  0              0              2.9937763    
   2100000   120            100            100            0.024116533    1.426337e-14   0              0.072349599    1.0029553e-13  0              4.8429122e-06  0              0              2.9937763    
   2200000   120            100            100            0.024116532    1.426337e-14   0              0.072349595    1.0673593e-14  0              5.1538962e-07  0              0              2.9937763    
   2300000   120            100            100            0.024116531    1.426337e-14   0              0.072349594    1.0836631e-15  0              5.2326212e-08  0              0              2.9937763    
   2400000   120            100            100            0.024116531    1.426337e-14   0              0.072349594    1.049599e-16   0              5.0681379e-09  0              0              2.9937763    
   2500000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    8.9027373e-18  0              4.2988132e-10  0              0              2.9937763    
   2600000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    7.3841349e-19  0              3.5655345e-11  0              0              2.9937763    
   2700000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    1.4966196e-20  0              7.2266404e-13  0              0              2.9937763    
   2800000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    2.2064188e-21  0              1.0654007e-13  0              0              2.9937763    
   2900000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    1.8237297e-20  0              8.806138e-13   0              0              2.9937763    
   3000000   120            100            100            0.024116531    1.426337e-14   0              0.072349593    5.2329743e-20  0              2.526816e-12   0              0              2.9937763    
Loop time of 26.3865 on 2 procs for 3000000 steps with 58 atoms

Performance: 98232058.743 ns/day, 0.000 hours/ns, 113694.512 timesteps/s
99.5% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4225     | 2.5548     | 2.6872     |   8.3 |  9.68
Neigh   | 0.040801   | 0.040827   | 0.040852   |   0.0 |  0.15
Comm    | 8.8971     | 9.0327     | 9.1682     |   4.5 | 34.23
Output  | 0.24618    | 0.24621    | 0.24624    |   0.0 |  0.93
Modify  | 11.369     | 11.397     | 11.425     |   0.8 | 43.19
Other   |            | 3.115      |            |       | 11.81

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.16 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.7695826e-15  1.4308748e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019578025    1.4308748e-14  0              0.058734074    16880.53       0              8.1510036e+11  0              0              3.3272179    
    200000   120            100            100            0.0068211452   1.4308748e-14  0              0.020463436    4008.1644      0              1.9353991e+11  0              0              3.0757913    
    300000   120            100            100            0.00022822076  1.4308748e-14  0              0.00068466228  9.6703835      0              4.6694821e+08  0              0              3.0436824    
    400000   120            100            100            6.5661874e-05  1.4308748e-14  0              0.00019698562  0.85758054     0              41409495       0              0              3.0052762    
    500000   120            100            100            0.011620425    1.4308748e-14  0              0.034861274    16.906085      0              8.1633433e+08  0              0              2.9962509    
    600000   120            100            100            0.026362184    1.4308748e-14  0              0.079086551    4.3416421      0              2.0964236e+08  0              0              2.9934341    
    700000   120            100            100            0.025207515    1.4308748e-14  0              0.075622546    0.53632655     0              25897290       0              0              2.9936121    
    800000   120            100            100            0.024638864    1.4308748e-14  0              0.073916591    0.061146955    0              2952567.6      0              0              2.993703     
    900000   120            100            100            0.024349377    1.4308748e-14  0              0.073048131    0.0064913141   0              313442.33      0              0              2.9937505    
   1000000   120            100            100            0.024215144    1.4308748e-14  0              0.072645432    0.00063163683  0              30499.482      0              0              2.9937728    
   1100000   120            100            100            0.024156762    1.4308748e-14  0              0.072470286    5.4400912e-05  0              2626.8254      0              0              2.9937826    
   1200000   120            100            100            0.024132483    1.4308748e-14  0              0.07239745     3.8527751e-06  0              186.03672      0              0              2.9937867    
   1300000   120            100            100            0.02412273     1.4308748e-14  0              0.07236819     1.8426814e-07  0              8.8976491      0              0              2.9937884    
   1400000   120            100            100            0.024118923    1.4308748e-14  0              0.072356769    2.1650627e-09  0              0.10454313     0              0              2.993789     
   1500000   120            100            100            0.024117475    1.4308748e-14  0              0.072352425    5.882584e-10   0              0.028404893    0              0              2.9937893    
   1600000   120            100            100            0.024116937    1.4308748e-14  0              0.072350811    5.727755e-10   0              0.027657279    0              0              2.9937894    
   1700000   120            100            100            0.024116742    1.4308748e-14  0              0.072350225    1.9938698e-10  0              0.0096276838   0              0              2.9937894    
   1800000   120            100            100            0.024116673    1.4308748e-14  0              0.072350018    4.9406141e-11  0              0.0023856457   0              0              2.9937894    
   1900000   120            100            100            0.024116649    1.4308748e-14  0              0.072349947    1.0241362e-11  0              0.00049451872  0              0              2.9937894    
   2000000   120            100            100            0.024116641    1.4308748e-14  0              0.072349923    1.8929556e-12  0              9.140405e-05   0              0              2.9937894    
   2100000   120            100            100            0.024116638    1.4308748e-14  0              0.072349915    3.2197564e-13  0              1.5547051e-05  0              0              2.9937894    
   2200000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    5.1259449e-14  0              2.4751353e-06  0              0              2.9937894    
   2300000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    7.7184703e-15  0              3.7269731e-07  0              0              2.9937894    
   2400000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    1.1041242e-15  0              5.3314208e-08  0              0              2.9937894    
   2500000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    1.5060515e-16  0              7.2721837e-09  0              0              2.9937894    
   2600000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    1.93291e-17    0              9.3333309e-10  0              0              2.9937894    
   2700000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    1.9286245e-18  0              9.3126375e-11  0              0              2.9937894    
   2800000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    2.6694826e-19  0              1.2889976e-11  0              0              2.9937894    
   2900000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    2.0177521e-19  0              9.7430028e-12  0              0              2.9937894    
   3000000   120            100            100            0.024116637    1.4308748e-14  0              0.072349912    6.2719444e-21  0              3.0284975e-13  0              0              2.9937894    
Loop time of 26.4691 on 2 procs for 3000000 steps with 58 atoms

Performance: 97925375.594 ns/day, 0.000 hours/ns, 113339.555 timesteps/s
99.5% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3973     | 2.5744     | 2.7516     |  11.0 |  9.73
Neigh   | 0.040539   | 0.04058    | 0.040621   |   0.0 |  0.15
Comm    | 8.882      | 9.0591     | 9.2362     |   5.9 | 34.23
Output  | 0.26512    | 0.26514    | 0.26516    |   0.0 |  1.00
Modify  | 11.376     | 11.407     | 11.438     |   0.9 | 43.10
Other   |            | 3.123      |            |       | 11.80

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.17 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.7857907e-15  1.4357372e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019578965    1.4357372e-14  0              0.058736896    16881.729      0              8.1515827e+11  0              0              3.3271892    
    200000   120            100            100            0.0068233007   1.4357372e-14  0              0.020469902    4010.1427      0              1.9363544e+11  0              0              3.0757395    
    300000   120            100            100            0.00023124089  1.4357372e-14  0              0.00069372266  9.9213748      0              4.7906768e+08  0              0              3.0436947    
    400000   120            100            100            7.324458e-05   1.4357372e-14  0              0.00021973374  1.0637205      0              51363258       0              0              3.0052837    
    500000   120            100            100            0.01209152     1.4357372e-14  0              0.036274559    18.490507      0              8.9284042e+08  0              0              2.9961593    
    600000   120            100            100            0.027070297    1.4357372e-14  0              0.081210891    3.9892975      0              1.926289e+08   0              0              2.9933303    
    700000   120            100            100            0.025660112    1.4357372e-14  0              0.076980336    0.41780884     0              20174493       0              0              2.9935492    
    800000   120            100            100            0.024847902    1.4357372e-14  0              0.074543706    0.034546416    0              1668122.8      0              0              2.9936809    
    900000   120            100            100            0.024429331    1.4357372e-14  0              0.073287993    0.0020037359   0              96753.236      0              0              2.9937505    
   1000000   120            100            100            0.024240491    1.4357372e-14  0              0.072721472    4.5584044e-05  0              2201.0903      0              0              2.9937823    
   1100000   120            100            100            0.024162612    1.4357372e-14  0              0.072487837    1.5464156e-06  0              74.670875      0              0              2.9937956    
   1200000   120            100            100            0.02413268     1.4357372e-14  0              0.072398039    3.2364275e-06  0              156.2755       0              0              2.9938007    
   1300000   120            100            100            0.024121893    1.4357372e-14  0              0.072365678    1.2393562e-06  0              59.844074      0              0              2.9938026    
   1400000   120            100            100            0.024118258    1.4357372e-14  0              0.072354774    3.0208482e-07  0              14.586595      0              0              2.9938032    
   1500000   120            100            100            0.024117128    1.4357372e-14  0              0.072351385    5.802855e-08   0              2.801991       0              0              2.9938034    
   1600000   120            100            100            0.024116816    1.4357372e-14  0              0.072350447    9.4536227e-09  0              0.45648161     0              0              2.9938035    
   1700000   120            100            100            0.024116746    1.4357372e-14  0              0.072350237    1.3444258e-09  0              0.064917511    0              0              2.9938035    
   1800000   120            100            100            0.024116738    1.4357372e-14  0              0.072350214    1.6803989e-10  0              0.0081140448   0              0              2.9938035    
   1900000   120            100            100            0.024116742    1.4357372e-14  0              0.072350227    1.8257131e-11  0              0.0008815715   0              0              2.9938035    
   2000000   120            100            100            0.024116746    1.4357372e-14  0              0.072350238    1.6632235e-12  0              8.031111e-05   0              0              2.9938035    
   2100000   120            100            100            0.024116748    1.4357372e-14  0              0.072350245    1.1593249e-13  0              5.5979649e-06  0              0              2.9938035    
   2200000   120            100            100            0.024116749    1.4357372e-14  0              0.072350248    4.6260413e-15  0              2.2337498e-07  0              0              2.9938035    
   2300000   120            100            100            0.02411675     1.4357372e-14  0              0.07235025     6.0975523e-18  0              2.9442898e-10  0              0              2.9938035    
   2400000   120            100            100            0.02411675     1.4357372e-14  0              0.07235025     5.4581875e-17  0              2.6355634e-09  0              0              2.9938035    
   2500000   120            100            100            0.02411675     1.4357372e-14  0              0.07235025     2.9606112e-17  0              1.4295732e-09  0              0              2.9938035    
   2600000   120            100            100            0.02411675     1.4357372e-14  0              0.072350251    8.6444862e-18  0              4.174113e-10   0              0              2.9938035    
   2700000   120            100            100            0.02411675     1.4357372e-14  0              0.072350251    2.2746822e-18  0              1.0983626e-10  0              0              2.9938035    
   2800000   120            100            100            0.02411675     1.4357372e-14  0              0.072350251    3.1794877e-19  0              1.5352608e-11  0              0              2.9938035    
   2900000   120            100            100            0.02411675     1.4357372e-14  0              0.072350251    7.8451912e-20  0              3.788162e-12   0              0              2.9938035    
   3000000   120            100            100            0.02411675     1.4357372e-14  0              0.072350251    1.0544241e-19  0              5.0914367e-12  0              0              2.9938035    
Loop time of 26.292 on 2 procs for 3000000 steps with 58 atoms

Performance: 98584975.284 ns/day, 0.000 hours/ns, 114102.981 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3919     | 2.5671     | 2.7423     |  10.9 |  9.76
Neigh   | 0.041896   | 0.041929   | 0.041961   |   0.0 |  0.16
Comm    | 8.8601     | 9.0345     | 9.2089     |   5.8 | 34.36
Output  | 0.12706    | 0.1271     | 0.12713    |   0.0 |  0.48
Modify  | 11.347     | 11.385     | 11.424     |   1.1 | 43.30
Other   |            | 3.136      |            |       | 11.93

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.18 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.8031018e-15  1.4409305e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019579966    1.4409305e-14  0              0.058739898    16883.005      0              8.1521988e+11  0              0              3.3271586    
    200000   120            100            100            0.0068255975   1.4409305e-14  0              0.020476793    4012.2511      0              1.9373725e+11  0              0              3.0756842    
    300000   120            100            100            0.00023446021  1.4409305e-14  0              0.00070338063  10.192294      0              4.9214938e+08  0              0              3.0437077    
    400000   120            100            100            8.1326483e-05  1.4409305e-14  0              0.00024397945  1.3074208      0              63130669       0              0              3.0052909    
    500000   120            100            100            0.012625434    1.4409305e-14  0              0.037876302    20.18589       0              9.747044e+08   0              0              2.9960566    
    600000   120            100            100            0.027801108    1.4409305e-14  0              0.083403324    3.5251946      0              1.7021903e+08  0              0              2.9932249    
    700000   120            100            100            0.026073782    1.4409305e-14  0              0.078221345    0.27362201     0              13212227       0              0              2.9934941    
    800000   120            100            100            0.024995874    1.4409305e-14  0              0.074987623    0.010186214    0              491855.84      0              0              2.9936701    
    900000   120            100            100            0.024458312    1.4409305e-14  0              0.073374937    2.1066612e-06  0              101.72313      0              0              2.9937601    
   1000000   120            100            100            0.024233266    1.4409305e-14  0              0.072699799    0.00021439006  0              10352.129      0              0              2.9937983    
   1100000   120            100            100            0.024150883    1.4409305e-14  0              0.072452648    9.7772161e-05  0              4721.0677      0              0              2.9938124    
   1200000   120            100            100            0.024124555    1.4409305e-14  0              0.072373664    2.3331479e-05  0              1126.5936      0              0              2.993817     
   1300000   120            100            100            0.024117562    1.4409305e-14  0              0.072352685    3.9577908e-06  0              191.10756      0              0              2.9938182    
   1400000   120            100            100            0.024116307    1.4409305e-14  0              0.07234892     5.1381467e-07  0              24.810272      0              0              2.9938185    
   1500000   120            100            100            0.024116388    1.4409305e-14  0              0.072349165    5.0431892e-08  0              2.4351756      0              0              2.9938184    
   1600000   120            100            100            0.024116615    1.4409305e-14  0              0.072349844    3.3290175e-09  0              0.16074634     0              0              2.9938184    
   1700000   120            100            100            0.024116759    1.4409305e-14  0              0.072350278    8.7539387e-11  0              0.0042269637   0              0              2.9938184    
   1800000   120            100            100            0.024116828    1.4409305e-14  0              0.072350485    1.8570473e-12  0              8.9670166e-05  0              0              2.9938184    
   1900000   120            100            100            0.024116856    1.4409305e-14  0              0.072350569    4.8615653e-12  0              0.00023474759  0              0              2.9938184    
   2000000   120            100            100            0.024116866    1.4409305e-14  0              0.072350599    1.7808832e-12  0              8.5992474e-05  0              0              2.9938184    
   2100000   120            100            100            0.024116869    1.4409305e-14  0              0.072350608    3.8543185e-13  0              1.8611125e-05  0              0              2.9938184    
   2200000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    6.1071399e-14  0              2.9489193e-06  0              0              2.9938184    
   2300000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    7.4285481e-15  0              3.58698e-07    0              0              2.9938184    
   2400000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    6.6843363e-16  0              3.2276268e-08  0              0              2.9938184    
   2500000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    3.6514313e-17  0              1.7631455e-09  0              0              2.9938184    
   2600000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    5.3501945e-19  0              2.5834175e-11  0              0              2.9938184    
   2700000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    4.3678241e-19  0              2.109066e-11   0              0              2.9938184    
   2800000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    9.1425843e-20  0              4.4146268e-12  0              0              2.9938184    
   2900000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    1.2869206e-20  0              6.2140791e-13  0              0              2.9938184    
   3000000   120            100            100            0.02411687     1.4409305e-14  0              0.072350611    2.0404134e-19  0              9.8524259e-12  0              0              2.9938184    
Loop time of 25.752 on 2 procs for 3000000 steps with 58 atoms

Performance: 100652382.053 ns/day, 0.000 hours/ns, 116495.813 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3856     | 2.5503     | 2.715      |  10.3 |  9.90
Neigh   | 0.041022   | 0.041051   | 0.04108    |   0.0 |  0.16
Comm    | 8.4502     | 8.5771     | 8.704      |   4.3 | 33.31
Output  | 0.14408    | 0.14411    | 0.14413    |   0.0 |  0.56
Modify  | 11.293     | 11.365     | 11.438     |   2.2 | 44.13
Other   |            | 3.074      |            |       | 11.94

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.19 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.8215389e-15  1.4464617e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019581026    1.4464617e-14  0              0.058743079    16884.358      0              8.152852e+11   0              0              3.3271261    
    200000   120            100            100            0.0068280363   1.4464617e-14  0              0.020484109    4014.4905      0              1.9384538e+11  0              0              3.0756253    
    300000   120            100            100            0.00023788002  1.4464617e-14  0              0.00071364007  10.48389       0              5.0622952e+08  0              0              3.0437213    
    400000   120            100            100            8.9912751e-05  1.4464617e-14  0              0.00026973825  1.5933086      0              76935171       0              0              3.0052975    
    500000   120            100            100            0.013228808    1.4464617e-14  0              0.039686425    21.979181      0              1.061296e+09   0              0              2.9959421    
    600000   120            100            100            0.028536535    1.4464617e-14  0              0.085609605    2.9573759      0              1.428011e+08   0              0              2.9931209    
    700000   120            100            100            0.0264099      1.4464617e-14  0              0.079229701    0.13138077     0              6343907.2      0              0              2.993453     
    800000   120            100            100            0.025049614    1.4464617e-14  0              0.075148842    2.1532637e-06  0              103.9734       0              0              2.993676     
    900000   120            100            100            0.024419267    1.4464617e-14  0              0.073257801    0.002522699    0              121812.11      0              0              2.9937821    
   1000000   120            100            100            0.024189205    1.4464617e-14  0              0.072567615    0.0010706607   0              51698.372      0              0              2.9938214    
   1100000   120            100            100            0.024123462    1.4464617e-14  0              0.072370385    0.00021467672  0              10365.971      0              0              2.9938329    
   1200000   120            100            100            0.024111464    1.4464617e-14  0              0.072334393    2.6787304e-05  0              1293.4631      0              0              2.993835     
   1300000   120            100            100            0.024112496    1.4464617e-14  0              0.072337487    1.9863289e-06  0              95.912714      0              0              2.9938349    
   1400000   120            100            100            0.024114796    1.4464617e-14  0              0.072344387    4.9854575e-08  0              2.407299       0              0              2.9938345    
   1500000   120            100            100            0.024116164    1.4464617e-14  0              0.072348491    1.970481e-09   0              0.095147475    0              0              2.9938343    
   1600000   120            100            100            0.024116749    1.4464617e-14  0              0.072350246    3.5174114e-09  0              0.16984321     0              0              2.9938342    
   1700000   120            100            100            0.024116947    1.4464617e-14  0              0.072350842    1.0798981e-09  0              0.052144414    0              0              2.9938341    
   1800000   120            100            100            0.024116998    1.4464617e-14  0              0.072350994    1.8254866e-10  0              0.0088146214   0              0              2.9938341    
   1900000   120            100            100            0.024117005    1.4464617e-14  0              0.072351014    1.9428595e-11  0              0.00093813731  0              0              2.9938341    
   2000000   120            100            100            0.024117002    1.4464617e-14  0              0.072351006    1.124418e-12   0              5.4294123e-05  0              0              2.9938341    
   2100000   120            100            100            0.024116999    1.4464617e-14  0              0.072350998    9.7041248e-15  0              4.6857746e-07  0              0              2.9938341    
   2200000   120            100            100            0.024116998    1.4464617e-14  0              0.072350994    6.2372484e-15  0              3.011744e-07   0              0              2.9938341    
   2300000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    4.2296635e-15  0              2.0423531e-07  0              0              2.9938341    
   2400000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.0199813e-15  0              4.9251249e-08  0              0              2.9938341    
   2500000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.4648326e-16  0              7.0731526e-09  0              0              2.9938341    
   2600000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.2312677e-17  0              5.9453509e-10  0              0              2.9938341    
   2700000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.5717389e-19  0              7.5893649e-12  0              0              2.9938341    
   2800000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    4.1495068e-23  0              2.0036483e-15  0              0              2.9938341    
   2900000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.679359e-23   0              8.1090234e-16  0              0              2.9938341    
   3000000   120            100            100            0.024116997    1.4464617e-14  0              0.072350992    1.5615008e-19  0              7.5399285e-12  0              0              2.9938341    
Loop time of 25.714 on 2 procs for 3000000 steps with 58 atoms

Performance: 100801061.356 ns/day, 0.000 hours/ns, 116667.895 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.383      | 2.5759     | 2.7687     |  12.0 | 10.02
Neigh   | 0.040678   | 0.040709   | 0.040741   |   0.0 |  0.16
Comm    | 8.4474     | 8.617      | 8.7866     |   5.8 | 33.51
Output  | 0.1728     | 0.17283    | 0.17287    |   0.0 |  0.67
Modify  | 11.136     | 11.224     | 11.313     |   2.6 | 43.65
Other   |            | 3.083      |            |       | 11.99

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.2 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.8411264e-15  1.4523379e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019582147    1.4523379e-14  0              0.058746442    16885.788      0              8.1535427e+11  0              0              3.3270916    
    200000   120            100            100            0.0068306177   1.4523379e-14  0              0.020491853    4016.8613      0              1.9395986e+11  0              0              3.0755629    
    300000   120            100            100            0.00024150047  1.4523379e-14  0              0.00072450142  10.796857      0              5.2134159e+08  0              0              3.0437354    
    400000   120            100            100            9.9006592e-05  1.4523379e-14  0              0.00029701978  1.9262398      0              93011225       0              0              3.0053034    
    500000   120            100            100            0.013908652    1.4523379e-14  0              0.041725955    23.850971      0              1.151678e+09   0              0              2.9958148    
    600000   120            100            100            0.02925199     1.4523379e-14  0              0.087755969    2.3101653      0              1.1154961e+08  0              0              2.9930224    
    700000   120            100            100            0.026624858    1.4523379e-14  0              0.079874574    0.028436645    0              1373103.8      0              0              2.9934329    
    800000   120            100            100            0.024981673    1.4523379e-14  0              0.07494502     0.012088772    0              583723.53      0              0              2.9937032    
    900000   120            100            100            0.024308214    1.4523379e-14  0              0.072924642    0.008152553    0              393657.61      0              0              2.9938172    
   1000000   120            100            100            0.02411725     1.4523379e-14  0              0.07235175     0.0016254978   0              78489.47       0              0              2.9938503    
   1100000   120            100            100            0.024091356    1.4523379e-14  0              0.072274069    0.00015419905  0              7445.7205      0              0              2.993855     
   1200000   120            100            100            0.024101365    1.4523379e-14  0              0.072304096    4.5351916e-06  0              218.98817      0              0              2.9938534    
   1300000   120            100            100            0.024110988    1.4523379e-14  0              0.072332965    1.4420352e-07  0              6.963072       0              0              2.9938518    
   1400000   120            100            100            0.024115513    1.4523379e-14  0              0.072346538    2.7056069e-07  0              13.064407      0              0              2.9938511    
   1500000   120            100            100            0.024116974    1.4523379e-14  0              0.072350922    7.0927715e-08  0              3.4248455      0              0              2.9938508    
   1600000   120            100            100            0.024117254    1.4523379e-14  0              0.072351763    8.5156023e-09  0              0.41118796     0              0              2.9938508    
   1700000   120            100            100            0.024117228    1.4523379e-14  0              0.072351683    4.1309493e-10  0              0.019946876    0              0              2.9938508    
   1800000   120            100            100            0.024117174    1.4523379e-14  0              0.072351521    5.3725435e-15  0              2.594209e-07   0              0              2.9938508    
   1900000   120            100            100            0.024117144    1.4523379e-14  0              0.072351432    7.8131788e-12  0              0.00037727044  0              0              2.9938508    
   2000000   120            100            100            0.024117133    1.4523379e-14  0              0.0723514      2.8811769e-12  0              0.00013912172  0              0              2.9938508    
   2100000   120            100            100            0.024117131    1.4523379e-14  0              0.072351393    4.3367334e-13  0              2.0940534e-05  0              0              2.9938508    
   2200000   120            100            100            0.024117131    1.4523379e-14  0              0.072351392    2.9777634e-14  0              1.4378554e-06  0              0              2.9938508    
   2300000   120            100            100            0.024117131    1.4523379e-14  0              0.072351393    2.6490671e-16  0              1.2791397e-08  0              0              2.9938508    
   2400000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    1.803692e-16   0              8.7093833e-09  0              0              2.9938508    
   2500000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    1.0531988e-16  0              5.0855202e-09  0              0              2.9938508    
   2600000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    2.0559734e-17  0              9.9275595e-10  0              0              2.9938508    
   2700000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    1.3362817e-18  0              6.452426e-11   0              0              2.9938508    
   2800000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    5.1088464e-20  0              2.4668791e-12  0              0              2.9938508    
   2900000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    3.6178798e-20  0              1.7469447e-12  0              0              2.9938508    
   3000000   120            100            100            0.024117131    1.4523379e-14  0              0.072351394    2.9469629e-20  0              1.4229829e-12  0              0              2.9938508    
Loop time of 25.6617 on 2 procs for 3000000 steps with 58 atoms

Performance: 101006729.203 ns/day, 0.000 hours/ns, 116905.937 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3834     | 2.5543     | 2.7251     |  10.7 |  9.95
Neigh   | 0.040804   | 0.04084    | 0.040876   |   0.0 |  0.16
Comm    | 8.4728     | 8.6217     | 8.7706     |   5.1 | 33.60
Output  | 0.087516   | 0.087551   | 0.087585   |   0.0 |  0.34
Modify  | 11.183     | 11.271     | 11.359     |   2.6 | 43.92
Other   |            | 3.086      |            |       | 12.03

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.21 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.8618907e-15  1.4585672e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.01958333     1.4585672e-14  0              0.058749989    16887.297      0              8.1542711e+11  0              0              3.3270552    
    200000   120            100            100            0.0068333424   1.4585672e-14  0              0.020500027    4019.3643      0              1.9408072e+11  0              0              3.0754969    
    300000   120            100            100            0.00024532411  1.4585672e-14  0              0.00073597233  11.13214       0              5.3753118e+08  0              0              3.0437502    
    400000   120            100            100            0.0001086153   1.4585672e-14  0              0.0003258459   2.3115183      0              1.1161495e+08  0              0              3.0053085    
    500000   120            100            100            0.01467241     1.4585672e-14  0              0.044017231    25.77474       0              1.24457e+09    0              0              2.9956742    
    600000   120            100            100            0.02991742     1.4585672e-14  0              0.089752261    1.6263018      0              78528296       0              0              2.9929338    
    700000   120            100            100            0.026674906    1.4585672e-14  0              0.080024719    0.0024278018   0              117229.86      0              0              2.9934409    
    800000   120            100            100            0.024779473    1.4585672e-14  0              0.074338419    0.04337691     0              2094515.8      0              0              2.9937539    
    900000   120            100            100            0.024141567    1.4585672e-14  0              0.072424701    0.01195081     0              577061.85      0              0              2.9938629    
   1000000   120            100            100            0.024041336    1.4585672e-14  0              0.072124008    0.0010562229   0              51001.223      0              0              2.9938808    
   1100000   120            100            100            0.024071844    1.4585672e-14  0              0.072215533    1.040479e-05   0              502.41005      0              0              2.993876     
   1200000   120            100            100            0.024102365    1.4585672e-14  0              0.072307094    6.8189822e-06  0              329.26424      0              0              2.9938709    
   1300000   120            100            100            0.024115159    1.4585672e-14  0              0.072345476    3.5490077e-06  0              171.36888      0              0              2.9938687    
   1400000   120            100            100            0.024118119    1.4585672e-14  0              0.072354356    4.7701617e-07  0              23.033404      0              0              2.9938682    
   1500000   120            100            100            0.024118027    1.4585672e-14  0              0.072354082    1.6340178e-08  0              0.78900873     0              0              2.9938682    
   1600000   120            100            100            0.024117576    1.4585672e-14  0              0.072352729    5.1167653e-10  0              0.024707028    0              0              2.9938683    
   1700000   120            100            100            0.024117339    1.4585672e-14  0              0.072352016    8.9008836e-10  0              0.042979181    0              0              2.9938683    
   1800000   120            100            100            0.024117268    1.4585672e-14  0              0.072351804    1.8152531e-10  0              0.0087652077   0              0              2.9938683    
   1900000   120            100            100            0.024117261    1.4585672e-14  0              0.072351783    1.1761392e-11  0              0.00056791554  0              0              2.9938683    
   2000000   120            100            100            0.024117267    1.4585672e-14  0              0.0723518      6.0016601e-15  0              2.8979869e-07  0              0              2.9938683    
   2100000   120            100            100            0.024117271    1.4585672e-14  0              0.072351812    1.7742371e-13  0              8.5671558e-06  0              0              2.9938683    
   2200000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    5.948323e-14   0              2.8722323e-06  0              0              2.9938683    
   2300000   120            100            100            0.024117273    1.4585672e-14  0              0.072351818    6.1056994e-15  0              2.9482237e-07  0              0              2.9938683    
   2400000   120            100            100            0.024117273    1.4585672e-14  0              0.072351818    1.0666295e-16  0              5.1503719e-09  0              0              2.9938683    
   2500000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    2.1897949e-17  0              1.0573736e-09  0              0              2.9938683    
   2600000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    1.6579564e-17  0              8.0056781e-10  0              0              2.9938683    
   2700000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    2.2512119e-18  0              1.0870297e-10  0              0              2.9938683    
   2800000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    1.0776363e-19  0              5.2035199e-12  0              0              2.9938683    
   2900000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    3.2982441e-20  0              1.592604e-12   0              0              2.9938683    
   3000000   120            100            100            0.024117272    1.4585672e-14  0              0.072351817    5.4773946e-20  0              2.6448378e-12  0              0              2.9938683    
Loop time of 25.8909 on 2 procs for 3000000 steps with 58 atoms

Performance: 100112363.144 ns/day, 0.000 hours/ns, 115870.791 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3294     | 2.5772     | 2.8249     |  15.4 |  9.95
Neigh   | 0.040822   | 0.040833   | 0.040843   |   0.0 |  0.16
Comm    | 8.7565     | 8.9853     | 9.2141     |   7.6 | 34.70
Output  | 0.089111   | 0.089134   | 0.089158   |   0.0 |  0.34
Modify  | 11.09      | 11.156     | 11.222     |   2.0 | 43.09
Other   |            | 3.042      |            |       | 11.75

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.22 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.8838602e-15  1.465158e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019584573    1.465158e-14   0              0.05875372     16888.884      0              8.1550376e+11  0              0              3.3270168    
    200000   120            100            100            0.0068362109   1.465158e-14   0              0.020508633    4022           0              1.9420799e+11  0              0              3.0754274    
    300000   120            100            100            0.00024935092  1.465158e-14   0              0.00074805275  11.490502      0              5.5483521e+08  0              0              3.0437655    
    400000   120            100            100            0.00011874203  1.465158e-14   0              0.00035622608  2.7545955      0              1.3300956e+08  0              0              3.0053125    
    500000   120            100            100            0.015527653    1.465158e-14   0              0.046582959    27.715213      0              1.3382685e+09  0              0              2.9955196    
    600000   120            100            100            0.030496244    1.465158e-14   0              0.091488733    0.96909202     0              46793985       0              0              2.9928608    
    700000   120            100            100            0.026522635    1.465158e-14   0              0.079567905    0.076350246    0              3686680.1      0              0              2.993483     
    800000   120            100            100            0.024454658    1.465158e-14   0              0.073363975    0.076822171    0              3709467.7      0              0              2.9938265    
    900000   120            100            100            0.023958932    1.465158e-14   0              0.071876797    0.0095988491   0              463494.07      0              0              2.9939124    
   1000000   120            100            100            0.023994646    1.465158e-14   0              0.071983938    0.00010222873  0              4936.2595      0              0              2.9939074    
   1100000   120            100            100            0.024079254    1.465158e-14   0              0.072237763    6.9908545e-05  0              3375.6334      0              0              2.9938933    
   1200000   120            100            100            0.024115533    1.465158e-14   0              0.072346598    2.9423096e-05  0              1420.736       0              0              2.9938871    
   1300000   120            100            100            0.024121671    1.465158e-14   0              0.072365013    2.2462818e-06  0              108.46491      0              0              2.993886     
   1400000   120            100            100            0.024119737    1.465158e-14   0              0.072359211    5.2987954e-11  0              0.0025585987   0              0              2.9938863    
   1500000   120            100            100            0.024117969    1.465158e-14   0              0.072353906    4.2577736e-08  0              2.0559265      0              0              2.9938866    
   1600000   120            100            100            0.024117373    1.465158e-14   0              0.072352119    9.8157903e-09  0              0.47396939     0              0              2.9938867    
   1700000   120            100            100            0.024117323    1.465158e-14   0              0.07235197     4.0481928e-10  0              0.019547274    0              0              2.9938867    
   1800000   120            100            100            0.02411738     1.465158e-14   0              0.07235214     1.3326357e-11  0              0.00064348209  0              0              2.9938867    
   1900000   120            100            100            0.024117414    1.465158e-14   0              0.072352242    2.0186994e-11  0              0.00097475767  0              0              2.9938867    
   2000000   120            100            100            0.024117423    1.465158e-14   0              0.072352269    2.8381753e-12  0              0.00013704533  0              0              2.9938867    
   2100000   120            100            100            0.024117423    1.465158e-14   0              0.072352268    4.3650343e-14  0              2.1077188e-06  0              0              2.9938867    
   2200000   120            100            100            0.024117421    1.465158e-14   0              0.072352264    1.6024418e-14  0              7.7376179e-07  0              0              2.9938867    
   2300000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    8.0426304e-15  0              3.8834984e-07  0              0              2.9938867    
   2400000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    6.9160835e-16  0              3.3395292e-08  0              0              2.9938867    
   2500000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    4.8141101e-19  0              2.3245615e-11  0              0              2.9938867    
   2600000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    1.0809532e-17  0              5.2195359e-10  0              0              2.9938867    
   2700000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    2.5723907e-18  0              1.2421154e-10  0              0              2.9938867    
   2800000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    1.1418799e-19  0              5.5137294e-12  0              0              2.9938867    
   2900000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    2.4503637e-20  0              1.1831929e-12  0              0              2.9938867    
   3000000   120            100            100            0.024117421    1.465158e-14   0              0.072352262    3.9326067e-20  0              1.8989151e-12  0              0              2.9938867    
Loop time of 26.113 on 2 procs for 3000000 steps with 58 atoms

Performance: 99260857.430 ns/day, 0.000 hours/ns, 114885.252 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3872     | 2.5119     | 2.6367     |   7.9 |  9.62
Neigh   | 0.040901   | 0.040951   | 0.041002   |   0.0 |  0.16
Comm    | 8.8247     | 8.9745     | 9.1242     |   5.0 | 34.37
Output  | 0.089288   | 0.089322   | 0.089356   |   0.0 |  0.34
Modify  | 11.432     | 11.45      | 11.468     |   0.5 | 43.85
Other   |            | 3.046      |            |       | 11.67

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.23 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.9070651e-15  1.4721195e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019585879    1.4721195e-14  0              0.058757637    16890.551      0              8.1558425e+11  0              0              3.3269765    
    200000   120            100            100            0.0068392239   1.4721195e-14  0              0.020517672    4024.7692      0              1.943417e+11   0              0              3.0753542    
    300000   120            100            100            0.00025358293  1.4721195e-14  0              0.0007607488   11.872934      0              5.7330147e+08  0              0              3.0437813    
    400000   120            100            100            0.00012939434  1.4721195e-14  0              0.00038818301  3.2614177      0              1.5748219e+08  0              0              3.0053152    
    500000   120            100            100            0.016482127    1.4721195e-14  0              0.049446382    29.627833      0              1.430622e+09   0              0              2.9953504    
    600000   120            100            100            0.03094581     1.4721195e-14  0              0.092837431    0.42047981     0              20303465       0              0              2.9928096    
    700000   120            100            100            0.026145713    1.4721195e-14  0              0.078437139    0.24187614     0              11679333       0              0              2.9935628    
    800000   120            100            100            0.02404977     1.4721195e-14  0              0.072149309    0.088864645    0              4290955.7      0              0              2.9939139    
    900000   120            100            100            0.023817295    1.4721195e-14  0              0.071451884    0.0030065543   0              145175.75      0              0              2.9939561    
   1000000   120            100            100            0.024005088    1.4721195e-14  0              0.072015263    0.0003322474   0              16043.038      0              0              2.9939252    
   1100000   120            100            100            0.024112918    1.4721195e-14  0              0.072338755    0.00021832747  0              10542.252      0              0              2.993907     
   1200000   120            100            100            0.024130933    1.4721195e-14  0              0.072392799    1.2128551e-05  0              585.64433      0              0              2.9939038    
   1300000   120            100            100            0.024123584    1.4721195e-14  0              0.072370751    3.5676123e-07  0              17.226723      0              0              2.993905     
   1400000   120            100            100            0.024118188    1.4721195e-14  0              0.072354563    5.0660808e-07  0              24.462291      0              0              2.9939059    
   1500000   120            100            100            0.024117009    1.4721195e-14  0              0.072351028    4.2348161e-08  0              2.0448411      0              0              2.9939061    
   1600000   120            100            100            0.024117265    1.4721195e-14  0              0.072351795    1.8094017e-10  0              0.008736953    0              0              2.993906     
   1700000   120            100            100            0.024117528    1.4721195e-14  0              0.072352583    1.1065238e-09  0              0.053430076    0              0              2.993906     
   1800000   120            100            100            0.024117599    1.4721195e-14  0              0.072352796    1.3397414e-10  0              0.0064691317   0              0              2.993906     
   1900000   120            100            100            0.024117592    1.4721195e-14  0              0.072352775    2.5418926e-14  0              1.227389e-06   0              0              2.993906     
   2000000   120            100            100            0.024117579    1.4721195e-14  0              0.072352738    2.2566012e-12  0              0.0001089632   0              0              2.993906     
   2100000   120            100            100            0.024117575    1.4721195e-14  0              0.072352726    3.924401e-13   0              1.8949528e-05  0              0              2.993906     
   2200000   120            100            100            0.024117575    1.4721195e-14  0              0.072352726    2.4017568e-15  0              1.1597224e-07  0              0              2.993906     
   2300000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    4.2317305e-15  0              2.0433512e-07  0              0              2.993906     
   2400000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    1.0764255e-15  0              5.1976735e-08  0              0              2.993906     
   2500000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    1.8465664e-17  0              8.9164084e-10  0              0              2.993906     
   2600000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    7.5501292e-18  0              3.6456872e-10  0              0              2.993906     
   2700000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    2.6108705e-18  0              1.2606959e-10  0              0              2.993906     
   2800000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    6.9442814e-20  0              3.353145e-12   0              0              2.993906     
   2900000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    6.9272206e-21  0              3.3449069e-13  0              0              2.993906     
   3000000   120            100            100            0.024117576    1.4721195e-14  0              0.072352728    9.2908289e-20  0              4.4862088e-12  0              0              2.993906     
Loop time of 26.0469 on 2 procs for 3000000 steps with 58 atoms

Performance: 99512861.267 ns/day, 0.000 hours/ns, 115176.923 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3903     | 2.5293     | 2.6682     |   8.7 |  9.71
Neigh   | 0.040326   | 0.040352   | 0.040378   |   0.0 |  0.15
Comm    | 8.8181     | 8.9577     | 9.0972     |   4.7 | 34.39
Output  | 0.12594    | 0.12598    | 0.12602    |   0.0 |  0.48
Modify  | 11.329     | 11.344     | 11.36      |   0.5 | 43.55
Other   |            | 3.049      |            |       | 11.71

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.24 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.9315379e-15  1.4794614e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019587248    1.4794614e-14  0              0.058761743    16892.298      0              8.1566863e+11  0              0              3.3269341    
    200000   120            100            100            0.0068423847   1.4794614e-14  0              0.020527154    4027.6749      0              1.9448201e+11  0              0              3.0752774    
    300000   120            100            100            0.00025802404  1.4794614e-14  0              0.00077407213  12.280644      0              5.9298833e+08  0              0              3.0437977    
    400000   120            100            100            0.00014058066  1.4794614e-14  0              0.00042174199  3.8383227      0              1.8533887e+08  0              0              3.0053165    
    500000   120            100            100            0.017543425    1.4794614e-14  0              0.052630274    31.457632      0              1.5189765e+09  0              0              2.9951662    
    600000   120            100            100            0.031218758    1.4794614e-14  0              0.093656274    0.073735956    0              3560445.4      0              0              2.9927871    
    700000   120            100            100            0.025546483    1.4794614e-14  0              0.076639448    0.44955046     0              21707183       0              0              2.9936805    
    800000   120            100            100            0.023638408    1.4794614e-14  0              0.070915225    0.066878644    0              3229330.4      0              0              2.9940039    
    900000   120            100            100            0.023774361    1.4794614e-14  0              0.071323082    9.5222031e-05  0              4597.9311      0              0              2.9939842    
   1000000   120            100            100            0.024076305    1.4794614e-14  0              0.072228914    0.0014510282   0              70064.959      0              0              2.9939336    
   1100000   120            100            100            0.024151547    1.4794614e-14  0              0.07245464     0.00010828156  0              5228.5292      0              0              2.9939206    
   1200000   120            100            100            0.024133742    1.4794614e-14  0              0.072401227    3.8196329e-06  0              184.4364       0              0              2.9939235    
   1300000   120            100            100            0.024118088    1.4794614e-14  0              0.072354263    4.0372178e-06  0              194.9428       0              0              2.9939261    
   1400000   120            100            100            0.024115681    1.4794614e-14  0              0.072347042    1.2518673e-07  0              6.044819       0              0              2.9939265    
   1500000   120            100            100            0.024117058    1.4794614e-14  0              0.072351174    2.6577976e-08  0              1.2833553      0              0              2.9939263    
   1600000   120            100            100            0.024117808    1.4794614e-14  0              0.072353423    9.6129925e-09  0              0.46417701     0              0              2.9939262    
   1700000   120            100            100            0.024117852    1.4794614e-14  0              0.072353556    6.5743942e-11  0              0.0031745397   0              0              2.9939262    
   1800000   120            100            100            0.024117764    1.4794614e-14  0              0.072353292    1.1605606e-10  0              0.005603932    0              0              2.9939262    
   1900000   120            100            100            0.024117731    1.4794614e-14  0              0.072353193    1.9467462e-11  0              0.00094001406  0              0              2.9939262    
   2000000   120            100            100            0.024117733    1.4794614e-14  0              0.072353199    1.0020683e-14  0              4.838629e-07   0              0              2.9939262    
   2100000   120            100            100            0.024117738    1.4794614e-14  0              0.072353214    3.9422585e-13  0              1.9035755e-05  0              0              2.9939262    
   2200000   120            100            100            0.024117739    1.4794614e-14  0              0.072353217    3.2261759e-14  0              1.5578049e-06  0              0              2.9939262    
   2300000   120            100            100            0.024117739    1.4794614e-14  0              0.072353217    8.8507775e-16  0              4.2737237e-08  0              0              2.9939262    
   2400000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    1.1175199e-15  0              5.3961038e-08  0              0              2.9939262    
   2500000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    3.7736134e-17  0              1.8221429e-09  0              0              2.9939262    
   2600000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    7.359027e-18   0              3.5534108e-10  0              0              2.9939262    
   2700000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    2.421407e-18   0              1.1692108e-10  0              0              2.9939262    
   2800000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    2.4769986e-20  0              1.196054e-12   0              0              2.9939262    
   2900000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    2.1789876e-21  0              1.0521551e-13  0              0              2.9939262    
   3000000   120            100            100            0.024117739    1.4794614e-14  0              0.072353216    2.1197898e-19  0              1.0235706e-11  0              0              2.9939262    
Loop time of 25.8444 on 2 procs for 3000000 steps with 58 atoms

Performance: 100292608.388 ns/day, 0.000 hours/ns, 116079.408 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4855     | 2.6466     | 2.8077     |   9.9 | 10.24
Neigh   | 0.039884   | 0.039905   | 0.039926   |   0.0 |  0.15
Comm    | 8.4485     | 8.599      | 8.7494     |   5.1 | 33.27
Output  | 0.11987    | 0.11991    | 0.11995    |   0.0 |  0.46
Modify  | 11.208     | 11.324     | 11.439     |   3.4 | 43.81
Other   |            | 3.115      |            |       | 12.05

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.25 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.9573134e-15  1.487194e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.01958868     1.487194e-14   0              0.058766039    16894.127      0              8.1575693e+11  0              0              3.3268897    
    200000   120            100            100            0.0068456908   1.487194e-14   0              0.020537072    4030.7149      0              1.946288e+11   0              0              3.075197     
    300000   120            100            100            0.00026267148  1.487194e-14   0              0.00078801444  12.714277      0              6.1392694e+08  0              0              3.0438145    
    400000   120            100            100            0.00015230259  1.487194e-14   0              0.00045690778  4.4916165      0              2.1688409e+08  0              0              3.0053161    
    500000   120            100            100            0.018718452    1.487194e-14   0              0.056155357    33.138484      0              1.6001388e+09  0              0              2.994967     
    600000   120            100            100            0.031265778    1.487194e-14   0              0.093797335    0.018968768    0              915933.93      0              0              2.9928004    
    700000   120            100            100            0.024760682    1.487194e-14   0              0.074282046    0.61639249     0              29763387       0              0              2.9938309    
    800000   120            100            100            0.023315777    1.487194e-14   0              0.069947331    0.025048747    0              1209514.3      0              0              2.9940805    
    900000   120            100            100            0.02386312     1.487194e-14   0              0.07158936     0.0054155622   0              261498.12      0              0              2.9939909    
   1000000   120            100            100            0.024175367    1.487194e-14   0              0.0725261      0.0013212477   0              63798.323      0              0              2.9939381    
   1100000   120            100            100            0.024163961    1.487194e-14   0              0.072491883    7.1255905e-06  0              344.06926      0              0              2.9939395    
   1200000   120            100            100            0.024119374    1.487194e-14   0              0.072358122    2.9743162e-05  0              1436.1909      0              0              2.9939469    
   1300000   120            100            100            0.024111972    1.487194e-14   0              0.072335917    5.3911646e-07  0              26.032004      0              0              2.9939482    
   1400000   120            100            100            0.024116518    1.487194e-14   0              0.072349553    3.4871816e-07  0              16.838352      0              0              2.9939475    
   1500000   120            100            100            0.024118432    1.487194e-14   0              0.072355297    4.7514095e-08  0              2.2942856      0              0              2.9939472    
   1600000   120            100            100            0.024118202    1.487194e-14   0              0.072354605    1.3053352e-09  0              0.063029967    0              0              2.9939472    
   1700000   120            100            100            0.024117896    1.487194e-14   0              0.072353689    1.350879e-09   0              0.065229113    0              0              2.9939472    
   1800000   120            100            100            0.024117866    1.487194e-14   0              0.072353599    6.2167932e-12  0              0.0003001867   0              0              2.9939472    
   1900000   120            100            100            0.024117902    1.487194e-14   0              0.072353705    2.0007238e-11  0              0.00096607792  0              0              2.9939472    
   2000000   120            100            100            0.024117913    1.487194e-14   0              0.072353738    1.5273294e-12  0              7.374927e-05   0              0              2.9939472    
   2100000   120            100            100            0.02411791     1.487194e-14   0              0.07235373     1.2753286e-13  0              6.1581053e-06  0              0              2.9939472    
   2200000   120            100            100            0.024117908    1.487194e-14   0              0.072353724    5.7111884e-14  0              2.7577285e-06  0              0              2.9939472    
   2300000   120            100            100            0.024117908    1.487194e-14   0              0.072353724    1.0205126e-19  0              4.9276903e-12  0              0              2.9939472    
   2400000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    1.0480535e-15  0              5.0606753e-08  0              0              2.9939472    
   2500000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    4.0503486e-17  0              1.9557684e-09  0              0              2.9939472    
   2600000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    1.0151896e-17  0              4.9019871e-10  0              0              2.9939472    
   2700000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    1.7068613e-18  0              8.2418224e-11  0              0              2.9939472    
   2800000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    4.9531241e-21  0              2.3916864e-13  0              0              2.9939472    
   2900000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    9.091988e-20   0              4.3901956e-12  0              0              2.9939472    
   3000000   120            100            100            0.024117908    1.487194e-14   0              0.072353725    4.0373232e-20  0              1.9494789e-12  0              0              2.9939472    
Loop time of 26.0533 on 2 procs for 3000000 steps with 58 atoms

Performance: 99488292.253 ns/day, 0.000 hours/ns, 115148.486 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3935     | 2.6303     | 2.867      |  14.6 | 10.10
Neigh   | 0.040783   | 0.040784   | 0.040785   |   0.0 |  0.16
Comm    | 8.762      | 8.9909     | 9.2197     |   7.6 | 34.51
Output  | 0.11212    | 0.11216    | 0.11219    |   0.0 |  0.43
Modify  | 11.161     | 11.205     | 11.249     |   1.3 | 43.01
Other   |            | 3.074      |            |       | 11.80

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.26 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            4.9844287e-15  1.4953286e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019590176    1.4953286e-14  0              0.058770528    16896.038      0              8.1584919e+11  0              0              3.3268433    
    200000   120            100            100            0.006849148    1.4953286e-14  0              0.020547444    4033.8948      0              1.9478234e+11  0              0              3.0751127    
    300000   120            100            100            0.00026753276  1.4953286e-14  0              0.00080259829  13.175484      0              6.3619699e+08  0              0              3.0438319    
    400000   120            100            100            0.00016456922  1.4953286e-14  0              0.00049370766  5.2283207      0              2.524569e+08   0              0              3.0053138    
    500000   120            100            100            0.020013403    1.4953286e-14  0              0.06004021     34.593878      0              1.6704146e+09  0              0              2.9947528    
    600000   120            100            100            0.031040799    1.4953286e-14  0              0.093122397    0.32013573     0              15458209       0              0              2.9928565    
    700000   120            100            100            0.023861936    1.4953286e-14  0              0.071585808    0.65744705     0              31745765       0              0              2.9940025    
    800000   120            100            100            0.023177973    1.4953286e-14  0              0.069533918    0.00017991666  0              8687.5318      0              0              2.994127     
    900000   120            100            100            0.024065949    1.4953286e-14  0              0.072197848    0.011822411    0              570861.92      0              0              2.9939792    
   1000000   120            100            100            0.024241591    1.4953286e-14  0              0.072724772    0.00012082523  0              5834.2178      0              0              2.9939487    
   1100000   120            100            100            0.024135407    1.4953286e-14  0              0.072406221    0.00019039555  0              9193.5197      0              0              2.9939662    
   1200000   120            100            100            0.024102832    1.4953286e-14  0              0.072308497    6.9786948e-06  0              336.9762       0              0              2.9939717    
   1300000   120            100            100            0.024114463    1.4953286e-14  0              0.072343389    2.708849e-06   0              130.80062      0              0              2.9939698    
   1400000   120            100            100            0.024119846    1.4953286e-14  0              0.072359539    2.4534977e-07  0              11.847063      0              0              2.9939689    
   1500000   120            100            100            0.024118723    1.4953286e-14  0              0.072356169    3.2852999e-08  0              1.5863537      0              0              2.9939691    
   1600000   120            100            100            0.0241179      1.4953286e-14  0              0.072353701    6.7577114e-09  0              0.3263057      0              0              2.9939692    
   1700000   120            100            100            0.024117984    1.4953286e-14  0              0.072353951    3.1133684e-10  0              0.015033342    0              0              2.9939692    
   1800000   120            100            100            0.024118102    1.4953286e-14  0              0.072354306    1.588029e-10   0              0.0076680236   0              0              2.9939692    
   1900000   120            100            100            0.0241181      1.4953286e-14  0              0.072354301    1.775829e-12   0              8.5748425e-05  0              0              2.9939692    
   2000000   120            100            100            0.024118084    1.4953286e-14  0              0.072354253    3.3009799e-12  0              0.0001593925   0              0              2.9939692    
   2100000   120            100            100            0.024118083    1.4953286e-14  0              0.07235425     7.952843e-16   0              3.8401433e-08  0              0              2.9939692    
   2200000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    6.1604472e-14  0              2.9746595e-06  0              0              2.9939692    
   2300000   120            100            100            0.024118086    1.4953286e-14  0              0.072354257    2.8810437e-16  0              1.3911529e-08  0              0              2.9939692    
   2400000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    1.034804e-15   0              4.9966982e-08  0              0              2.9939692    
   2500000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    2.421699e-17   0              1.1693518e-09  0              0              2.9939692    
   2600000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    1.586913e-17   0              7.6626351e-10  0              0              2.9939692    
   2700000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    5.2090592e-19  0              2.5152683e-11  0              0              2.9939692    
   2800000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    1.677671e-19   0              8.1008729e-12  0              0              2.9939692    
   2900000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    1.4186381e-19  0              6.8500959e-12  0              0              2.9939692    
   3000000   120            100            100            0.024118085    1.4953286e-14  0              0.072354256    9.3559881e-21  0              4.5176718e-13  0              0              2.9939692    
Loop time of 25.6819 on 2 procs for 3000000 steps with 58 atoms

Performance: 100927225.177 ns/day, 0.000 hours/ns, 116813.918 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3735     | 2.5584     | 2.7433     |  11.6 |  9.96
Neigh   | 0.039961   | 0.040025   | 0.040088   |   0.0 |  0.16
Comm    | 8.4225     | 8.5955     | 8.7685     |   5.9 | 33.47
Output  | 0.12606    | 0.12608    | 0.1261     |   0.0 |  0.49
Modify  | 11.181     | 11.273     | 11.365     |   2.7 | 43.89
Other   |            | 3.089      |            |       | 12.03

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.27 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.0129235e-15  1.503877e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019591737    1.503877e-14   0              0.058775211    16898.032      0              8.1594547e+11  0              0              3.3267948    
    200000   120            100            100            0.0068527548   1.503877e-14   0              0.020558264    4037.2131      0              1.9494257e+11  0              0              3.0750248    
    300000   120            100            100            0.00027260622  1.503877e-14   0              0.00081781867  13.665107      0              6.5983912e+08  0              0              3.0438496    
    400000   120            100            100            0.00017738258  1.503877e-14   0              0.00053214773  6.0553641      0              2.9239186e+08  0              0              3.0053094    
    500000   120            100            100            0.021432803    1.503877e-14   0              0.06429841     35.737408      0              1.7256315e+09  0              0              2.9945241    
    600000   120            100            100            0.030506589    1.503877e-14   0              0.091519768    0.98896577     0              47753618       0              0              2.9929609    
    700000   120            100            100            0.022958505    1.503877e-14   0              0.068875514    0.53388037     0              25779172       0              0              2.9941778    
    800000   120            100            100            0.023292159    1.503877e-14   0              0.069876478    0.020171346    0              974002.12      0              0              2.9941319    
    900000   120            100            100            0.024303643    1.503877e-14   0              0.07291093     0.008849401    0              427305.91      0              0              2.9939624    
   1000000   120            100            100            0.024222836    1.503877e-14   0              0.072668507    0.00053496237  0              25831.418      0              0              2.9939744    
   1100000   120            100            100            0.024088845    1.503877e-14   0              0.072266535    0.00013844137  0              6684.8382      0              0              2.9939968    
   1200000   120            100            100            0.024105336    1.503877e-14   0              0.072316007    1.3054759e-05  0              630.36759      0              0              2.9939943    
   1300000   120            100            100            0.024122784    1.503877e-14   0              0.072368352    2.083902e-06   0              100.62417      0              0              2.9939914    
   1400000   120            100            100            0.024119834    1.503877e-14   0              0.072359502    3.0081405e-07  0              14.525234      0              0              2.9939918    
   1500000   120            100            100            0.024117594    1.503877e-14   0              0.072352783    2.9839657e-08  0              1.4408502      0              0              2.9939922    
   1600000   120            100            100            0.024118086    1.503877e-14   0              0.072354257    6.6159734e-09  0              0.31946168     0              0              2.9939921    
   1700000   120            100            100            0.024118369    1.503877e-14   0              0.072355106    4.0095987e-10  0              0.019360917    0              0              2.9939921    
   1800000   120            100            100            0.02411829     1.503877e-14   0              0.072354871    1.4000342e-10  0              0.0067602643   0              0              2.9939921    
   1900000   120            100            100            0.024118255    1.503877e-14   0              0.072354766    4.9376218e-12  0              0.00023842009  0              0              2.9939921    
   2000000   120            100            100            0.024118267    1.503877e-14   0              0.072354802    2.8655066e-12  0              0.00013836506  0              0              2.9939921    
   2100000   120            100            100            0.024118272    1.503877e-14   0              0.072354815    5.3322661e-14  0              2.5747604e-06  0              0              2.9939921    
   2200000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    5.6915208e-14  0              2.7482317e-06  0              0              2.9939921    
   2300000   120            100            100            0.024118269    1.503877e-14   0              0.072354808    4.5621009e-16  0              2.2028753e-08  0              0              2.9939921    
   2400000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    1.1009619e-15  0              5.3161512e-08  0              0              2.9939921    
   2500000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    2.5373643e-18  0              1.2252024e-10  0              0              2.9939921    
   2600000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    2.0663383e-17  0              9.9776082e-10  0              0              2.9939921    
   2700000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    9.3926503e-20  0              4.5353747e-12  0              0              2.9939921    
   2800000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    3.7721161e-19  0              1.8214199e-11  0              0              2.9939921    
   2900000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    1.0313579e-20  0              4.9800583e-13  0              0              2.9939921    
   3000000   120            100            100            0.02411827     1.503877e-14   0              0.072354809    1.2400885e-19  0              5.9879435e-12  0              0              2.9939921    
Loop time of 26.1261 on 2 procs for 3000000 steps with 58 atoms

Performance: 99211185.122 ns/day, 0.000 hours/ns, 114827.761 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.525      | 2.6482     | 2.7715     |   7.6 | 10.14
Neigh   | 0.039912   | 0.039928   | 0.039944   |   0.0 |  0.15
Comm    | 8.7567     | 8.8974     | 9.0381     |   4.7 | 34.06
Output  | 0.1259     | 0.12592    | 0.12594    |   0.0 |  0.48
Modify  | 11.338     | 11.345     | 11.352     |   0.2 | 43.42
Other   |            | 3.07       |            |       | 11.75

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.28 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.04284e-15    1.512852e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019593364    1.512852e-14   0              0.058780091    16900.109      0              8.160458e+11   0              0              3.3267442    
    200000   120            100            100            0.0068565136   1.512852e-14   0              0.020569541    4040.6723      0              1.951096e+11   0              0              3.074933     
    300000   120            100            100            0.00027789518  1.512852e-14   0              0.00083368554  14.18451       0              6.8491921e+08  0              0              3.0438678    
    400000   120            100            100            0.00019075089  1.512852e-14   0              0.00057225267  6.9803682      0              3.37057e+08    0              0              3.0053026    
    500000   120            100            100            0.022979221    1.512852e-14   0              0.068937664    36.475472      0              1.76127e+09    0              0              2.9942815    
    600000   120            100            100            0.029641199    1.512852e-14   0              0.088923596    1.9612881      0              94703585       0              0              2.9931176    
    700000   120            100            100            0.022183585    1.512852e-14   0              0.066550755    0.29277921     0              14137260       0              0              2.9943343    
    800000   120            100            100            0.02366347     1.512852e-14   0              0.07099041     0.068469984    0              3306170.5      0              0              2.9940946    
    900000   120            100            100            0.024456441    1.512852e-14   0              0.073369322    0.00090215836  0              43561.999      0              0              2.9939604    
   1000000   120            100            100            0.024122258    1.512852e-14   0              0.072366775    0.0016464591   0              79501.619      0              0              2.9940148    
   1100000   120            100            100            0.024072139    1.512852e-14   0              0.072216417    8.1766995e-06  0              394.82356      0              0              2.9940236    
   1200000   120            100            100            0.024125838    1.512852e-14   0              0.072377513    2.5032484e-05  0              1208.7291      0              0              2.9940147    
   1300000   120            100            100            0.024123473    1.512852e-14   0              0.072370419    1.5383773e-06  0              74.282733      0              0              2.994015     
   1400000   120            100            100            0.024116608    1.512852e-14   0              0.072349824    2.1669196e-07  0              10.463279      0              0              2.9940162    
   1500000   120            100            100            0.024118099    1.512852e-14   0              0.072354297    6.1122872e-08  0              2.9514047      0              0              2.9940159    
   1600000   120            100            100            0.024118774    1.512852e-14   0              0.072356321    4.3385667e-10  0              0.020949386    0              0              2.9940158    
   1700000   120            100            100            0.024118457    1.512852e-14   0              0.072355371    1.3696292e-09  0              0.066134493    0              0              2.9940159    
   1800000   120            100            100            0.02411842     1.512852e-14   0              0.072355259    1.2201577e-11  0              0.00058917048  0              0              2.9940159    
   1900000   120            100            100            0.024118469    1.512852e-14   0              0.072355407    1.9469324e-11  0              0.000940104    0              0              2.9940159    
   2000000   120            100            100            0.024118466    1.512852e-14   0              0.072355397    1.5009786e-12  0              7.2476883e-05  0              0              2.9940159    
   2100000   120            100            100            0.024118459    1.512852e-14   0              0.072355378    1.5069346e-13  0              7.276448e-06   0              0              2.9940159    
   2200000   120            100            100            0.024118461    1.512852e-14   0              0.072355383    5.3820356e-14  0              2.5987924e-06  0              0              2.9940159    
   2300000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    1.6793247e-16  0              8.1088582e-09  0              0              2.9940159    
   2400000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    1.1287692e-15  0              5.4504225e-08  0              0              2.9940159    
   2500000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    1.4001619e-17  0              6.7608806e-10  0              0              2.9940159    
   2600000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    1.5252832e-17  0              7.3650465e-10  0              0              2.9940159    
   2700000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    1.8224984e-18  0              8.8001927e-11  0              0              2.9940159    
   2800000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    8.1207086e-20  0              3.9211995e-12  0              0              2.9940159    
   2900000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    5.853172e-20   0              2.8262873e-12  0              0              2.9940159    
   3000000   120            100            100            0.024118461    1.512852e-14   0              0.072355384    5.3177372e-20  0              2.567745e-12   0              0              2.9940159    
Loop time of 26.0039 on 2 procs for 3000000 steps with 58 atoms

Performance: 99677413.402 ns/day, 0.000 hours/ns, 115367.377 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3556     | 2.585      | 2.8144     |  14.3 |  9.94
Neigh   | 0.04169    | 0.041704   | 0.041718   |   0.0 |  0.16
Comm    | 8.452      | 8.6854     | 8.9187     |   7.9 | 33.40
Output  | 0.11156    | 0.11159    | 0.11162    |   0.0 |  0.43
Modify  | 11.308     | 11.422     | 11.537     |   3.4 | 43.93
Other   |            | 3.158      |            |       | 12.14

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.29 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.0742235e-15  1.5222671e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019595056    1.5222671e-14  0              0.058785169    16902.272      0              8.1615023e+11  0              0              3.3266915    
    200000   120            100            100            0.0068604262   1.5222671e-14  0              0.020581279    4044.2739      0              1.9528351e+11  0              0              3.0748374    
    300000   120            100            100            0.00028340256  1.5222671e-14  0              0.00085020769  14.735079      0              7.1150423e+08  0              0              3.0438864    
    400000   120            100            100            0.00020468284  1.5222671e-14  0              0.00061404853  8.0113545      0              3.8683964e+08  0              0              3.0052931    
    500000   120            100            100            0.024652305    1.5222671e-14  0              0.073956914    36.71087       0              1.7726365e+09  0              0              2.9940265    
    600000   120            100            100            0.028445394    1.5222671e-14  0              0.085336181    3.0839586      0              1.4891332e+08  0              0              2.9933275    
    700000   120            100            100            0.02167808     1.5222671e-14  0              0.065034241    0.066065777    0              3190079.9      0              0              2.9944471    
    800000   120            100            100            0.024208066    1.5222671e-14  0              0.072624198    0.089639585    0              4328374.7      0              0              2.9940293    
    900000   120            100            100            0.024423866    1.5222671e-14  0              0.073271597    0.002874213    0              138785.46      0              0              2.9939897    
   1000000   120            100            100            0.024014755    1.5222671e-14  0              0.072044265    0.00059741939  0              28847.244      0              0              2.9940574    
   1100000   120            100            100            0.02410855     1.5222671e-14  0              0.072325649    0.00021244422  0              10258.171      0              0              2.9940424    
   1200000   120            100            100            0.024135754    1.5222671e-14  0              0.072407262    1.1269963e-06  0              54.418616      0              0              2.9940377    
   1300000   120            100            100            0.024114902    1.5222671e-14  0              0.072344705    2.7362223e-06  0              132.12238      0              0              2.9940412    
   1400000   120            100            100            0.024117474    1.5222671e-14  0              0.072352423    4.0918645e-07  0              19.758149      0              0              2.9940408    
   1500000   120            100            100            0.024119524    1.5222671e-14  0              0.072358573    1.0260754e-09  0              0.04954551     0              0              2.9940404    
   1600000   120            100            100            0.024118562    1.5222671e-14  0              0.072355685    9.2484936e-09  0              0.44657666     0              0              2.9940406    
   1700000   120            100            100            0.024118573    1.5222671e-14  0              0.072355718    6.0039777e-10  0              0.02899106     0              0              2.9940406    
   1800000   120            100            100            0.0241187      1.5222671e-14  0              0.072356099    3.2108186e-11  0              0.0015503894   0              0              2.9940406    
   1900000   120            100            100            0.02411866     1.5222671e-14  0              0.07235598     2.5149595e-11  0              0.0012143839   0              0              2.9940406    
   2000000   120            100            100            0.024118655    1.5222671e-14  0              0.072355965    5.4317896e-13  0              2.6228168e-05  0              0              2.9940406    
   2100000   120            100            100            0.024118662    1.5222671e-14  0              0.072355985    2.0948049e-13  0              1.0115063e-05  0              0              2.9940406    
   2200000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    5.6147551e-14  0              2.7111643e-06  0              0              2.9940406    
   2300000   120            100            100            0.02411866     1.5222671e-14  0              0.07235598     8.3741223e-17  0              4.043564e-09   0              0              2.9940406    
   2400000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    8.5882642e-16  0              4.1469654e-08  0              0              2.9940406    
   2500000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    1.0094515e-16  0              4.8742802e-09  0              0              2.9940406    
   2600000   120            100            100            0.02411866     1.5222671e-14  0              0.07235598     9.0691537e-19  0              4.3791697e-11  0              0              2.9940406    
   2700000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    2.4447097e-18  0              1.1804628e-10  0              0              2.9940406    
   2800000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    8.336545e-20   0              4.0254192e-12  0              0              2.9940406    
   2900000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    5.8573725e-20  0              2.8283156e-12  0              0              2.9940406    
   3000000   120            100            100            0.02411866     1.5222671e-14  0              0.072355981    9.3332268e-20  0              4.5066812e-12  0              0              2.9940406    
Loop time of 26.151 on 2 procs for 3000000 steps with 58 atoms

Performance: 99116697.524 ns/day, 0.000 hours/ns, 114718.400 timesteps/s
99.6% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4872     | 2.6677     | 2.8483     |  11.1 | 10.20
Neigh   | 0.041982   | 0.042135   | 0.042287   |   0.1 |  0.16
Comm    | 8.4545     | 8.6276     | 8.8007     |   5.9 | 32.99
Output  | 0.20281    | 0.20285    | 0.20288    |   0.0 |  0.78
Modify  | 11.228     | 11.412     | 11.596     |   5.5 | 43.64
Other   |            | 3.199      |            |       | 12.23

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.1071223e-15  1.5321367e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019596817    1.5321367e-14  0              0.05879045     16904.521      0              8.1625884e+11  0              0              3.3266366    
    200000   120            100            100            0.0068644951   1.5321367e-14  0              0.020593485    4048.0205      0              1.9546442e+11  0              0              3.0747379    
    300000   120            100            100            0.00028913082  1.5321367e-14  0              0.00086739247  15.318213      0              7.3966167e+08  0              0              3.0439053    
    400000   120            100            100            0.00021918616  1.5321367e-14  0              0.00065755847  9.1566424      0              4.4214149e+08  0              0              3.0052806    
    500000   120            100            100            0.026447746    1.5321367e-14  0              0.079343237    36.348635      0              1.7551455e+09  0              0              2.9937609    
    600000   120            100            100            0.026950843    1.5321367e-14  0              0.08085253     4.1236887      0              1.9911817e+08  0              0              2.9935874    
    700000   120            100            100            0.021567303    1.5321367e-14  0              0.064701908    0.0072040936   0              347859.9       0              0              2.994494     
    800000   120            100            100            0.024749916    1.5321367e-14  0              0.074249748    0.052302057    0              2525479.2      0              0              2.9939656    
    900000   120            100            100            0.024200885    1.5321367e-14  0              0.072602656    0.011513379    0              555939.88      0              0              2.9940515    
   1000000   120            100            100            0.02399857     1.5321367e-14  0              0.07199571     0.00021177251  0              10225.737      0              0              2.9940861    
   1100000   120            100            100            0.024158699    1.5321367e-14  0              0.072476098    6.9654087e-05  0              3363.3466      0              0              2.9940598    
   1200000   120            100            100            0.024118274    1.5321367e-14  0              0.072354821    3.0318713e-05  0              1463.9822      0              0              2.9940662    
   1300000   120            100            100            0.024113727    1.5321367e-14  0              0.072341182    1.450024e-06   0              70.016468      0              0              2.9940671    
   1400000   120            100            100            0.024121124    1.5321367e-14  0              0.072363373    5.5143479e-08  0              2.6626813      0              0              2.9940658    
   1500000   120            100            100            0.024118605    1.5321367e-14  0              0.072355816    6.8888986e-08  0              3.3264026      0              0              2.9940662    
   1600000   120            100            100            0.024118672    1.5321367e-14  0              0.072356015    6.3120623e-09  0              0.3047869      0              0              2.9940662    
   1700000   120            100            100            0.024118984    1.5321367e-14  0              0.072356953    3.4229877e-12  0              0.00016528383  0              0              2.9940662    
   1800000   120            100            100            0.024118843    1.5321367e-14  0              0.072356529    1.3306126e-10  0              0.0064250522   0              0              2.9940662    
   1900000   120            100            100            0.024118861    1.5321367e-14  0              0.072356582    2.1510465e-11  0              0.0010386634   0              0              2.9940662    
   2000000   120            100            100            0.024118872    1.5321367e-14  0              0.072356617    1.6353178e-13  0              7.8963644e-06  0              0              2.9940662    
   2100000   120            100            100            0.024118865    1.5321367e-14  0              0.072356595    2.0817413e-13  0              1.0051984e-05  0              0              2.9940662    
   2200000   120            100            100            0.024118866    1.5321367e-14  0              0.072356599    6.1545281e-14  0              2.9718013e-06  0              0              2.9940662    
   2300000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      1.8789269e-15  0              9.0726657e-08  0              0              2.9940662    
   2400000   120            100            100            0.024118866    1.5321367e-14  0              0.072356599    2.3238663e-16  0              1.1221119e-08  0              0              2.9940662    
   2500000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      1.515586e-16   0              7.3182224e-09  0              0              2.9940662    
   2600000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      1.0279046e-17  0              4.9633837e-10  0              0              2.9940662    
   2700000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      7.0864489e-22  0              3.4217925e-14  0              0              2.9940662    
   2800000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      2.7581993e-19  0              1.3318357e-11  0              0              2.9940662    
   2900000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      5.0199401e-21  0              2.4239494e-13  0              0              2.9940662    
   3000000   120            100            100            0.024118867    1.5321367e-14  0              0.0723566      1.8807468e-19  0              9.0814532e-12  0              0              2.9940662    
Loop time of 26.0613 on 2 procs for 3000000 steps with 58 atoms

Performance: 99457874.257 ns/day, 0.000 hours/ns, 115113.280 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3945     | 2.5521     | 2.7097     |   9.9 |  9.79
Neigh   | 0.040391   | 0.040471   | 0.040552   |   0.0 |  0.16
Comm    | 8.8061     | 8.9671     | 9.128      |   5.4 | 34.41
Output  | 0.16081    | 0.16084    | 0.16086    |   0.0 |  0.62
Modify  | 11.268     | 11.302     | 11.337     |   1.0 | 43.37
Other   |            | 3.038      |            |       | 11.66

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.31 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.1415879e-15  1.5424764e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019598645    1.5424764e-14  0              0.058795935    16906.858      0              8.1637166e+11  0              0              3.3265796    
    200000   120            100            100            0.0068687202   1.5424764e-14  0              0.020606161    4051.9122      0              1.9565234e+11  0              0              3.0746345    
    300000   120            100            100            0.0002950819   1.5424764e-14  0              0.00088524571  15.935314      0              7.6945926e+08  0              0              3.0439246    
    400000   120            100            100            0.00023426957  1.5424764e-14  0              0.0007028087   10.424998      0              5.0338585e+08  0              0              3.005265     
    500000   120            100            100            0.02835623     1.5424764e-14  0              0.08506869     35.3042        0              1.7047135e+09  0              0              2.993487     
    600000   120            100            100            0.025224694    1.5424764e-14  0              0.075674083    4.8104362      0              2.3227875e+08  0              0              2.9938888    
    700000   120            100            100            0.021931606    1.5424764e-14  0              0.065794818    0.18224448     0              8799933.7      0              0              2.9944611    
    800000   120            100            100            0.025064072    1.5424764e-14  0              0.075192217    0.0039185269   0              189211.64      0              0              2.9939399    
    900000   120            100            100            0.023914368    1.5424764e-14  0              0.071743105    0.008265794    0              399125.61      0              0              2.9941252    
   1000000   120            100            100            0.024101264    1.5424764e-14  0              0.072303793    0.0016239273   0              78413.64       0              0              2.9940961    
   1100000   120            100            100            0.024156262    1.5424764e-14  0              0.072468787    8.624153e-05   0              4164.2948      0              0              2.9940866    
   1200000   120            100            100            0.024101555    1.5424764e-14  0              0.072304665    2.2741447e-07  0              10.981031      0              0              2.9940956    
   1300000   120            100            100            0.024123443    1.5424764e-14  0              0.07237033     2.2866086e-06  0              110.41215      0              0              2.994092     
   1400000   120            100            100            0.024119114    1.5424764e-14  0              0.072357341    5.5645137e-07  0              26.869045      0              0              2.9940927    
   1500000   120            100            100            0.024118472    1.5424764e-14  0              0.072355417    3.810534e-08   0              1.8399705      0              0              2.9940928    
   1600000   120            100            100            0.024119402    1.5424764e-14  0              0.072358206    1.3579661e-11  0              0.00065571323  0              0              2.9940927    
   1700000   120            100            100            0.02411899     1.5424764e-14  0              0.072356971    5.9735488e-10  0              0.028844129    0              0              2.9940928    
   1800000   120            100            100            0.024119085    1.5424764e-14  0              0.072357255    1.8493103e-10  0              0.0089296578   0              0              2.9940927    
   1900000   120            100            100            0.02411909     1.5424764e-14  0              0.07235727     1.5853257e-11  0              0.00076549706  0              0              2.9940927    
   2000000   120            100            100            0.024119075    1.5424764e-14  0              0.072357224    8.6376834e-14  0              4.1708282e-06  0              0              2.9940927    
   2100000   120            100            100            0.024119082    1.5424764e-14  0              0.072357247    1.454133e-13   0              7.0214879e-06  0              0              2.9940927    
   2200000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    5.9603162e-14  0              2.8780234e-06  0              0              2.9940927    
   2300000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    6.2704488e-15  0              3.0277753e-07  0              0              2.9940927    
   2400000   120            100            100            0.024119081    1.5424764e-14  0              0.072357242    9.0582132e-17  0              4.373887e-09   0              0              2.9940927    
   2500000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    3.1634786e-17  0              1.5275306e-09  0              0              2.9940927    
   2600000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    1.8734335e-17  0              9.0461401e-10  0              0              2.9940927    
   2700000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    2.6234136e-18  0              1.2667525e-10  0              0              2.9940927    
   2800000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    2.3410798e-20  0              1.1304237e-12  0              0              2.9940927    
   2900000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    2.5076338e-20  0              1.2108466e-12  0              0              2.9940927    
   3000000   120            100            100            0.02411908     1.5424764e-14  0              0.072357241    1.5959464e-19  0              7.7062542e-12  0              0              2.9940927    
Loop time of 26.0063 on 2 procs for 3000000 steps with 58 atoms

Performance: 99668343.656 ns/day, 0.000 hours/ns, 115356.879 timesteps/s
99.6% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4053     | 2.5158     | 2.6264     |   7.0 |  9.67
Neigh   | 0.040526   | 0.040527   | 0.040529   |   0.0 |  0.16
Comm    | 8.8044     | 8.9341     | 9.0638     |   4.3 | 34.35
Output  | 0.21718    | 0.21722    | 0.21726    |   0.0 |  0.84
Modify  | 11.172     | 11.226     | 11.28      |   1.6 | 43.17
Other   |            | 3.073      |            |       | 11.81

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.32 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.1776753e-15  1.5533026e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019600542    1.5533026e-14  0              0.058801627    16909.283      0              8.1648875e+11  0              0              3.3265204    
    200000   120            100            100            0.0068731062   1.5533026e-14  0              0.020619319    4055.9534      0              1.9584747e+11  0              0              3.074527     
    300000   120            100            100            0.00030126042  1.5533026e-14  0              0.00090378126  16.588124      0              8.0098114e+08  0              0              3.0439441    
    400000   120            100            100            0.00024994407  1.5533026e-14  0              0.0007498322   11.825778      0              5.710245e+08   0              0              3.0052457    
    500000   120            100            100            0.030362228    1.5533026e-14  0              0.091086683    33.513959      0              1.6182691e+09  0              0              2.9932081    
    600000   120            100            100            0.023366868    1.5533026e-14  0              0.070100604    4.9129173      0              2.372272e+08   0              0              2.994218     
    700000   120            100            100            0.022773228    1.5533026e-14  0              0.068319683    0.48505371     0              23421508       0              0              2.9943496    
    800000   120            100            100            0.024974125    1.5533026e-14  0              0.074922375    0.019044346    0              919583.31      0              0              2.9939804    
    900000   120            100            100            0.023766167    1.5533026e-14  0              0.0712985      6.2141015e-05  0              3000.5672      0              0              2.9941777    
   1000000   120            100            100            0.024226608    1.5533026e-14  0              0.072679823    0.00055488296  0              26793.312      0              0              2.994103     
   1100000   120            100            100            0.024099612    1.5533026e-14  0              0.072298835    0.00018909952  0              9130.9393      0              0              2.9941233    
   1200000   120            100            100            0.024117176    1.5533026e-14  0              0.072351528    2.9952584e-05  0              1446.3031      0              0              2.9941206    
   1300000   120            100            100            0.024123303    1.5533026e-14  0              0.072369909    2.5120065e-06  0              121.29581      0              0              2.9941196    
   1400000   120            100            100            0.02411707     1.5533026e-14  0              0.07235121     6.6195986e-08  0              3.1963673      0              0              2.9941206    
   1500000   120            100            100            0.024120166    1.5533026e-14  0              0.072360497    2.7538938e-09  0              0.13297567     0              0              2.9941201    
   1600000   120            100            100            0.02411906     1.5533026e-14  0              0.07235718     4.6047837e-09  0              0.22234853     0              0              2.9941203    
   1700000   120            100            100            0.024119337    1.5533026e-14  0              0.072358011    1.2691162e-09  0              0.061281081    0              0              2.9941202    
   1800000   120            100            100            0.024119312    1.5533026e-14  0              0.072357937    1.7549912e-10  0              0.0084742244   0              0              2.9941202    
   1900000   120            100            100            0.02411929     1.5533026e-14  0              0.072357871    1.2392854e-11  0              0.00059840655  0              0              2.9941202    
   2000000   120            100            100            0.024119308    1.5533026e-14  0              0.072357923    1.7961444e-13  0              8.6729385e-06  0              0              2.9941202    
   2100000   120            100            100            0.0241193      1.5533026e-14  0              0.072357899    4.3898216e-14  0              2.1196877e-06  0              0              2.9941202    
   2200000   120            100            100            0.024119302    1.5533026e-14  0              0.072357907    3.5831894e-14  0              1.7301939e-06  0              0              2.9941202    
   2300000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    8.2509166e-15  0              3.9840724e-07  0              0              2.9941202    
   2400000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    9.9450796e-16  0              4.802123e-08   0              0              2.9941202    
   2500000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    5.7728176e-17  0              2.787487e-09   0              0              2.9941202    
   2600000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    4.2381856e-19  0              2.0464681e-11  0              0              2.9941202    
   2700000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    1.385387e-19   0              6.6895379e-12  0              0              2.9941202    
   2800000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    2.1865178e-19  0              1.0557912e-11  0              0              2.9941202    
   2900000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    1.9610492e-19  0              9.4692049e-12  0              0              2.9941202    
   3000000   120            100            100            0.024119302    1.5533026e-14  0              0.072357905    1.6257345e-21  0              7.8500902e-14  0              0              2.9941202    
Loop time of 26.0021 on 2 procs for 3000000 steps with 58 atoms

Performance: 99684117.373 ns/day, 0.000 hours/ns, 115375.136 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4007     | 2.5367     | 2.6727     |   8.5 |  9.76
Neigh   | 0.041506   | 0.04152    | 0.041535   |   0.0 |  0.16
Comm    | 8.8004     | 8.9534     | 9.1063     |   5.1 | 34.43
Output  | 0.14398    | 0.14401    | 0.14405    |   0.0 |  0.55
Modify  | 11.27      | 11.294     | 11.317     |   0.7 | 43.43
Other   |            | 3.033      |            |       | 11.66

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.33 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.2154431e-15  1.5646329e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.01960251     1.5646329e-14  0              0.05880753     16911.798      0              8.1661018e+11  0              0              3.3264589    
    200000   120            100            100            0.0068776526   1.5646329e-14  0              0.020632958    4060.1436      0              1.960498e+11   0              0              3.0744156    
    300000   120            100            100            0.00030766732  1.5646329e-14  0              0.00092300196  17.278065      0              8.3429595e+08  0              0              3.0439639    
    400000   120            100            100            0.00026621708  1.5646329e-14  0              0.00079865123  13.368423      0              6.4551329e+08  0              0              3.0052226    
    500000   120            100            100            0.032442434    1.5646329e-14  0              0.097327301    30.948527      0              1.4943936e+09  0              0              2.9929284    
    600000   120            100            100            0.02150705     1.5646329e-14  0              0.06452115     4.3261342      0              2.0889354e+08  0              0              2.9945554    
    700000   120            100            100            0.023981189    1.5646329e-14  0              0.071943567    0.67058647     0              32380221       0              0              2.9941805    
    800000   120            100            100            0.024469215    1.5646329e-14  0              0.073407644    0.0785546      0              3793120.5      0              0              2.994089     
    900000   120            100            100            0.023890707    1.5646329e-14  0              0.07167212     0.0070808448   0              341908.65      0              0              2.9941867    
   1000000   120            100            100            0.024231245    1.5646329e-14  0              0.072693735    0.00043703878  0              21103.039      0              0              2.9941303    
   1100000   120            100            100            0.024072613    1.5646329e-14  0              0.07221784     1.0079654e-05  0              486.71042      0              0              2.9941563    
   1200000   120            100            100            0.024137149    1.5646329e-14  0              0.072411446    3.7564532e-07  0              18.138568      0              0              2.9941458    
   1300000   120            100            100            0.024113595    1.5646329e-14  0              0.072340784    7.3462252e-07  0              35.472292      0              0              2.9941496    
   1400000   120            100            100            0.024121287    1.5646329e-14  0              0.072363861    2.6509124e-07  0              12.800307      0              0              2.9941484    
   1500000   120            100            100            0.024119109    1.5646329e-14  0              0.072357328    5.9097688e-08  0              2.8536159      0              0              2.9941487    
   1600000   120            100            100            0.024119587    1.5646329e-14  0              0.072358761    9.9751275e-09  0              0.48166321     0              0              2.9941486    
   1700000   120            100            100            0.024119548    1.5646329e-14  0              0.072358645    1.3513249e-09  0              0.065250642    0              0              2.9941486    
   1800000   120            100            100            0.024119511    1.5646329e-14  0              0.072358532    1.4696188e-10  0              0.007096263    0              0              2.9941486    
   1900000   120            100            100            0.024119542    1.5646329e-14  0              0.072358627    1.2113063e-11  0              0.00058489646  0              0              2.9941486    
   2000000   120            100            100            0.024119525    1.5646329e-14  0              0.072358576    6.1915536e-13  0              2.9896796e-05  0              0              2.9941486    
   2100000   120            100            100            0.024119533    1.5646329e-14  0              0.072358599    6.0651702e-15  0              2.9286536e-07  0              0              2.9941486    
   2200000   120            100            100            0.02411953     1.5646329e-14  0              0.07235859     2.7269574e-15  0              1.3167502e-07  0              0              2.9941486    
   2300000   120            100            100            0.024119531    1.5646329e-14  0              0.072358593    2.195799e-15   0              1.0602727e-07  0              0              2.9941486    
   2400000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    6.5618992e-16  0              3.1685063e-08  0              0              2.9941486    
   2500000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    1.3360599e-16  0              6.4513552e-09  0              0              2.9941486    
   2600000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    2.0969681e-17  0              1.0125508e-09  0              0              2.9941486    
   2700000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    2.7812004e-18  0              1.3429422e-10  0              0              2.9941486    
   2800000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    2.3060828e-19  0              1.1135249e-11  0              0              2.9941486    
   2900000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    5.3672214e-21  0              2.5916391e-13  0              0              2.9941486    
   3000000   120            100            100            0.024119531    1.5646329e-14  0              0.072358592    1.1520613e-19  0              5.5628918e-12  0              0              2.9941486    
Loop time of 25.8514 on 2 procs for 3000000 steps with 58 atoms

Performance: 100265479.038 ns/day, 0.000 hours/ns, 116048.008 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3934     | 2.5391     | 2.6849     |   9.1 |  9.82
Neigh   | 0.039878   | 0.039908   | 0.039937   |   0.0 |  0.15
Comm    | 8.8033     | 8.9419     | 9.0805     |   4.6 | 34.59
Output  | 0.11443    | 0.11445    | 0.11448    |   0.0 |  0.44
Modify  | 11.148     | 11.176     | 11.204     |   0.8 | 43.23
Other   |            | 3.04       |            |       | 11.76

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.34 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.254954e-15   1.5764862e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019604548    1.5764862e-14  0              0.058813645    16914.404      0              8.1673601e+11  0              0              3.3263952    
    200000   120            100            100            0.0068823624   1.5764862e-14  0              0.020647087    4064.486       0              1.9625948e+11  0              0              3.0743       
    300000   120            100            100            0.00031430636  1.5764862e-14  0              0.00094291908  18.006919      0              8.6948966e+08  0              0              3.0439839    
    400000   120            100            100            0.00028309991  1.5764862e-14  0              0.00084929972  15.063131      0              7.273447e+08   0              0              3.0051953    
    500000   120            100            100            0.034564621    1.5764862e-14  0              0.10369386     27.627566      0              1.3340363e+09  0              0              2.9926526    
    600000   120            100            100            0.019796089    1.5764862e-14  0              0.059388268    3.1473449      0              1.5197402e+08  0              0              2.994876     
    700000   120            100            100            0.025306943    1.5764862e-14  0              0.075920829    0.54571431     0              26350591       0              0              2.9939966    
    800000   120            100            100            0.023764565    1.5764862e-14  0              0.071293696    0.079756528    0              3851157.3      0              0              2.9942322    
    900000   120            100            100            0.024216071    1.5764862e-14  0              0.072648212    0.011533836    0              556927.67      0              0              2.9941637    
   1000000   120            100            100            0.024096293    1.5764862e-14  0              0.07228888     0.0016258301   0              78505.517      0              0              2.9941813    
   1100000   120            100            100            0.0241238      1.5764862e-14  0              0.0723714      0.00022520772  0              10874.475      0              0              2.9941775    
   1200000   120            100            100            0.024119971    1.5764862e-14  0              0.072359913    3.062134e-05   0              1478.5949      0              0              2.9941779    
   1300000   120            100            100            0.02411907     1.5764862e-14  0              0.07235721     4.0885289e-06  0              197.42043      0              0              2.9941781    
   1400000   120            100            100            0.02412025     1.5764862e-14  0              0.072360751    5.3592625e-07  0              25.877961      0              0              2.9941779    
   1500000   120            100            100            0.024119508    1.5764862e-14  0              0.072358524    6.8922346e-08  0              3.3280134      0              0              2.9941781    
   1600000   120            100            100            0.024119892    1.5764862e-14  0              0.072359676    8.6878078e-09  0              0.41950315     0              0              2.994178     
   1700000   120            100            100            0.024119711    1.5764862e-14  0              0.072359133    1.0717726e-09  0              0.051752064    0              0              2.994178     
   1800000   120            100            100            0.024119792    1.5764862e-14  0              0.072359375    1.2913086e-10  0              0.0062352673   0              0              2.994178     
   1900000   120            100            100            0.024119757    1.5764862e-14  0              0.072359271    1.5150026e-11  0              0.00073154055  0              0              2.994178     
   2000000   120            100            100            0.024119771    1.5764862e-14  0              0.072359314    1.7238644e-12  0              8.3239241e-05  0              0              2.994178     
   2100000   120            100            100            0.024119766    1.5764862e-14  0              0.072359297    1.8908549e-13  0              9.1302614e-06  0              0              2.994178     
   2200000   120            100            100            0.024119768    1.5764862e-14  0              0.072359304    1.9819863e-14  0              9.5703025e-07  0              0              2.994178     
   2300000   120            100            100            0.024119767    1.5764862e-14  0              0.072359301    1.9623842e-15  0              9.475651e-08   0              0              2.994178     
   2400000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    1.8024849e-16  0              8.7035547e-09  0              0              2.994178     
   2500000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    1.4532252e-17  0              7.0171045e-10  0              0              2.994178     
   2600000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    1.2645797e-18  0              6.1062027e-11  0              0              2.994178     
   2700000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    2.9342705e-19  0              1.4168542e-11  0              0              2.994178     
   2800000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    3.1008406e-23  0              1.4972849e-15  0              0              2.994178     
   2900000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    5.9705557e-21  0              2.8829677e-13  0              0              2.994178     
   3000000   120            100            100            0.024119767    1.5764862e-14  0              0.072359302    2.0126491e-19  0              9.718362e-12   0              0              2.994178     
Loop time of 25.8767 on 2 procs for 3000000 steps with 58 atoms

Performance: 100167164.256 ns/day, 0.000 hours/ns, 115934.218 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4188     | 2.6091     | 2.7994     |  11.8 | 10.08
Neigh   | 0.039364   | 0.039413   | 0.039463   |   0.0 |  0.15
Comm    | 8.4642     | 8.642      | 8.8197     |   6.0 | 33.40
Output  | 0.10513    | 0.10515    | 0.10518    |   0.0 |  0.41
Modify  | 11.257     | 11.371     | 11.485     |   3.4 | 43.94
Other   |            | 3.11       |            |       | 12.02

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.35 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.296275e-15   1.5888825e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019606659    1.5888825e-14  0              0.058819978    16917.102      0              8.1686633e+11  0              0              3.3263291    
    200000   120            100            100            0.0068872394   1.5888825e-14  0              0.020661718    4068.984       0              1.9647668e+11  0              0              3.0741802    
    300000   120            100            100            0.0003211824   1.5888825e-14  0              0.0009635472   18.776662      0              9.0665782e+08  0              0              3.0440042    
    400000   120            100            100            0.00030060488  1.5888825e-14  0              0.00090181463  16.92066       0              8.170381e+08   0              0              3.0051634    
    500000   120            100            100            0.036708516    1.9378923e-05  0              0.11010617     23.635453      0              1.1412714e+09  0              0              2.9923868    
    600000   120            100            100            0.01839486     1.5888825e-14  0              0.05518458     1.7028413      0              82224112       0              0              2.9951505    
    700000   120            100            100            0.026381494    1.5888825e-14  0              0.079144482    0.19980207     0              9647726.7      0              0              2.9938562    
    800000   120            100            100            0.023234167    1.5888825e-14  0              0.0697025      0.016037994    0              774417.34      0              0              2.9943497    
    900000   120            100            100            0.024464862    1.5888825e-14  0              0.073394585    0.0010327602   0              49868.296      0              0              2.9941535    
   1000000   120            100            100            0.023989493    1.5888825e-14  0              0.071968479    3.7310346e-05  0              1801.5831      0              0              2.9942292    
   1100000   120            100            100            0.024168529    1.5888825e-14  0              0.072505588    1.1740905e-08  0              0.56692627     0              0              2.9942006    
   1200000   120            100            100            0.02410236     1.5888825e-14  0              0.072307079    5.6012587e-07  0              27.046474      0              0              2.9942112    
   1300000   120            100            100            0.024126304    1.5888825e-14  0              0.072378911    3.1330765e-07  0              15.128505      0              0              2.9942073    
   1400000   120            100            100            0.024117818    1.5888825e-14  0              0.072353455    9.3841009e-08  0              4.5312465      0              0              2.9942087    
   1500000   120            100            100            0.024120757    1.5888825e-14  0              0.072362272    2.1711642e-08  0              1.0483775      0              0              2.9942082    
   1600000   120            100            100            0.024119765    1.5888825e-14  0              0.072359296    4.3365364e-09  0              0.20939582     0              0              2.9942084    
   1700000   120            100            100            0.02412009     1.5888825e-14  0              0.07236027     7.8499013e-10  0              0.037904364    0              0              2.9942083    
   1800000   120            100            100            0.024119988    1.5888825e-14  0              0.072359963    1.3207969e-10  0              0.0063776554   0              0              2.9942083    
   1900000   120            100            100            0.024120018    1.5888825e-14  0              0.072360055    2.0959413e-11  0              0.001012055    0              0              2.9942083    
   2000000   120            100            100            0.02412001     1.5888825e-14  0              0.07236003     3.164162e-12   0              0.00015278606  0              0              2.9942083    
   2100000   120            100            100            0.024120012    1.5888825e-14  0              0.072360036    4.5685232e-13  0              2.2059764e-05  0              0              2.9942083    
   2200000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    6.3270168e-14  0              3.05509e-06    0              0              2.9942083    
   2300000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    8.4072783e-15  0              4.0595738e-07  0              0              2.9942083    
   2400000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    1.0694766e-15  0              5.1641197e-08  0              0              2.9942083    
   2500000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    1.3155322e-16  0              6.3522344e-09  0              0              2.9942083    
   2600000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    1.58695e-17    0              7.6628134e-10  0              0              2.9942083    
   2700000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    1.4041944e-18  0              6.7803522e-11  0              0              2.9942083    
   2800000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    1.6594229e-19  0              8.0127591e-12  0              0              2.9942083    
   2900000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    8.7704748e-20  0              4.2349484e-12  0              0              2.9942083    
   3000000   120            100            100            0.024120012    1.5888825e-14  0              0.072360035    8.9545909e-20  0              4.3238515e-12  0              0              2.9942083    
Loop time of 25.9202 on 2 procs for 3000000 steps with 58 atoms

Performance: 99999062.783 ns/day, 0.000 hours/ns, 115739.656 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3683     | 2.5985     | 2.8287     |  14.3 | 10.02
Neigh   | 0.041032   | 0.041056   | 0.041079   |   0.0 |  0.16
Comm    | 8.5319     | 8.776      | 9.0201     |   8.2 | 33.86
Output  | 0.089891   | 0.089914   | 0.089937   |   0.0 |  0.35
Modify  | 11.203     | 11.298     | 11.393     |   2.8 | 43.59
Other   |            | 3.117      |            |       | 12.03

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.36 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.3394776e-15  1.6018433e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019608844    1.6018433e-14  0              0.058826532    16919.896      0              8.1700121e+11  0              0              3.3262606    
    200000   120            100            100            0.0068922854   1.6018433e-14  0              0.020676856    4073.6396      0              1.9670148e+11  0              0              3.0740562    
    300000   120            100            100            0.00032829823  1.6018433e-14  0              0.00098489469  19.589121      0              9.4588856e+08  0              0              3.0440245    
    400000   120            100            100            0.00031874374  1.6018433e-14  0              0.0009562312   18.952172      0              9.1513257e+08  0              0              3.0051265    
    500000   120            100            100            0.039476357    0.00065352498  0              0.11777555     19.06712       0              9.2068299e+08  0              0              2.9921377    
    600000   120            100            100            0.0174569      1.6018433e-14  0              0.0523707      0.48428622     0              23384449       0              0              2.995349     
    700000   120            100            100            0.026811448    1.6018433e-14  0              0.080434345    1.5234965e-05  0              735.64195      0              0              2.9938182    
    800000   120            100            100            0.023217737    1.6018433e-14  0              0.069653212    0.012342959    0              595997.31      0              0              2.9943857    
    900000   120            100            100            0.024377016    1.6018433e-14  0              0.073131049    0.0059852606   0              289006.81      0              0              2.9941979    
   1000000   120            100            100            0.024068142    1.6018433e-14  0              0.072204425    0.001407995    0              67987.041      0              0              2.9942483    
   1100000   120            100            100            0.024120938    1.6018433e-14  0              0.072362814    0.00022751364  0              10985.819      0              0              2.9942393    
   1200000   120            100            100            0.024126843    1.6018433e-14  0              0.072380528    2.688181e-05   0              1298.0264      0              0              2.9942386    
   1300000   120            100            100            0.024115693    1.6018433e-14  0              0.07234708     2.2102432e-06  0              106.72474      0              0              2.9942403    
   1400000   120            100            100            0.024122483    1.6018433e-14  0              0.072367449    9.6126496e-08  0              4.6416045      0              0              2.9942393    
   1500000   120            100            100            0.024119372    1.6018433e-14  0              0.072358116    9.5607841e-11  0              0.0046165605   0              0              2.9942398    
   1600000   120            100            100            0.02412057     1.6018433e-14  0              0.07236171     1.2462483e-09  0              0.060176869    0              0              2.9942396    
   1700000   120            100            100            0.024120176    1.6018433e-14  0              0.072360527    6.4234894e-10  0              0.031016731    0              0              2.9942396    
   1800000   120            100            100            0.024120282    1.6018433e-14  0              0.072360846    1.5546296e-10  0              0.0075067497   0              0              2.9942396    
   1900000   120            100            100            0.024120263    1.6018433e-14  0              0.072360789    2.5548298e-11  0              0.0012336359   0              0              2.9942396    
   2000000   120            100            100            0.024120261    1.6018433e-14  0              0.072360784    3.069709e-12   0              0.00014822526  0              0              2.9942396    
   2100000   120            100            100            0.024120265    1.6018433e-14  0              0.072360795    2.5826669e-13  0              1.2470774e-05  0              0              2.9942396    
   2200000   120            100            100            0.024120263    1.6018433e-14  0              0.072360788    1.1825473e-14  0              5.7100975e-07  0              0              2.9942396    
   2300000   120            100            100            0.024120264    1.6018433e-14  0              0.072360792    2.648862e-17   0              1.2790407e-09  0              0              2.9942396    
   2400000   120            100            100            0.024120263    1.6018433e-14  0              0.07236079     1.2709304e-16  0              6.136868e-09   0              0              2.9942396    
   2500000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    7.1265991e-17  0              3.4411797e-09  0              0              2.9942396    
   2600000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    1.725399e-17   0              8.3313344e-10  0              0              2.9942396    
   2700000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    2.8301731e-18  0              1.3665893e-10  0              0              2.9942396    
   2800000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    3.380692e-19   0              1.6324152e-11  0              0              2.9942396    
   2900000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    3.3461192e-20  0              1.6157212e-12  0              0              2.9942396    
   3000000   120            100            100            0.024120264    1.6018433e-14  0              0.072360791    1.7431203e-19  0              8.4169039e-12  0              0              2.9942396    
Loop time of 25.8251 on 2 procs for 3000000 steps with 58 atoms

Performance: 100367485.407 ns/day, 0.000 hours/ns, 116166.071 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3965     | 2.5664     | 2.7363     |  10.6 |  9.94
Neigh   | 0.040094   | 0.040131   | 0.040167   |   0.0 |  0.16
Comm    | 8.452      | 8.629      | 8.806      |   6.0 | 33.41
Output  | 0.10929    | 0.10932    | 0.10936    |   0.0 |  0.42
Modify  | 11.207     | 11.341     | 11.474     |   4.0 | 43.91
Other   |            | 3.14       |            |       | 12.16

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.37 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.3846383e-15  1.6153915e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019611103    1.6153915e-14  0              0.058833309    16922.784      0              8.1714069e+11  0              0              3.3261898    
    200000   120            100            100            0.0068975009   1.6153915e-14  0              0.020692503    4078.4533      0              1.9693391e+11  0              0              3.0739279    
    300000   120            100            100            0.00033565572  1.6153915e-14  0              0.0010069672   20.446079      0              9.8726799e+08  0              0              3.044045     
    400000   120            100            100            0.00033752591  1.6153915e-14  0              0.0010125777   21.169018      0              1.0221761e+09  0              0              3.0050842    
    500000   120            100            100            0.042469904    0.0016076951   0              0.12580202     14.089698      0              6.8034109e+08  0              0              2.991914     
    600000   120            100            100            0.017121859    1.6153915e-14  0              0.051365576    0.00010385094  0              5014.5903      0              0              2.9954431    
    700000   120            100            100            0.0263455      1.6153915e-14  0              0.079036499    0.21092576     0              10184850       0              0              2.9939194    
    800000   120            100            100            0.023791664    1.6153915e-14  0              0.071374993    0.081135162    0              3917726.6      0              0              2.9943273    
    900000   120            100            100            0.024010275    1.6153915e-14  0              0.072030825    0.011384849    0              549733.6       0              0              2.9942882    
   1000000   120            100            100            0.024229152    1.6153915e-14  0              0.072687455    0.00057986149  0              27999.436      0              0              2.9942549    
   1100000   120            100            100            0.024071642    1.6153915e-14  0              0.072214926    1.036724e-07   0              5.0059691      0              0              2.9942796    
   1200000   120            100            100            0.024134521    1.6153915e-14  0              0.072403562    1.1876293e-05  0              573.46368      0              0              2.9942696    
   1300000   120            100            100            0.024118925    1.6153915e-14  0              0.072356775    3.9155186e-06  0              189.06638      0              0              2.9942721    
   1400000   120            100            100            0.024119567    1.6153915e-14  0              0.072358701    4.8297097e-07  0              23.32094       0              0              2.994272     
   1500000   120            100            100            0.024121301    1.6153915e-14  0              0.072363902    1.962183e-08   0              0.94746792     0              0              2.9942717    
   1600000   120            100            100            0.024120197    1.6153915e-14  0              0.07236059     1.4013592e-10  0              0.0067666621   0              0              2.9942719    
   1700000   120            100            100            0.02412061     1.6153915e-14  0              0.07236183     6.7097372e-10  0              0.03239892     0              0              2.9942719    
   1800000   120            100            100            0.024120517    1.6153915e-14  0              0.07236155     1.8495416e-10  0              0.0089307743   0              0              2.9942719    
   1900000   120            100            100            0.024120516    1.6153915e-14  0              0.072361547    2.003456e-11   0              0.0009673972   0              0              2.9942719    
   2000000   120            100            100            0.024120529    1.6153915e-14  0              0.072361587    6.186104e-13   0              2.9870482e-05  0              0              2.9942719    
   2100000   120            100            100            0.024120521    1.6153915e-14  0              0.072361564    2.077559e-14   0              1.0031789e-06  0              0              2.9942719    
   2200000   120            100            100            0.024120524    1.6153915e-14  0              0.072361572    3.6494346e-14  0              1.7621814e-06  0              0              2.9942719    
   2300000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     8.5805119e-15  0              4.1432221e-07  0              0              2.9942719    
   2400000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     8.0933711e-16  0              3.9079992e-08  0              0              2.9942719    
   2500000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     1.7576137e-17  0              8.4868876e-10  0              0              2.9942719    
   2600000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     2.370348e-18   0              1.1445562e-10  0              0              2.9942719    
   2700000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     2.3369326e-18  0              1.1284211e-10  0              0              2.9942719    
   2800000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     3.880124e-19   0              1.873573e-11   0              0              2.9942719    
   2900000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     6.4215428e-20  0              3.1007332e-12  0              0              2.9942719    
   3000000   120            100            100            0.024120523    1.6153915e-14  0              0.07236157     1.9204641e-19  0              9.273234e-12   0              0              2.9942719    
Loop time of 26.1212 on 2 procs for 3000000 steps with 58 atoms

Performance: 99229814.305 ns/day, 0.000 hours/ns, 114849.322 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3328     | 2.6151     | 2.8973     |  17.5 | 10.01
Neigh   | 0.039734   | 0.039768   | 0.039802   |   0.0 |  0.15
Comm    | 8.7517     | 9.0261     | 9.3004     |   9.1 | 34.55
Output  | 0.088866   | 0.088897   | 0.088928   |   0.0 |  0.34
Modify  | 11.237     | 11.282     | 11.328     |   1.4 | 43.19
Other   |            | 3.069      |            |       | 11.75

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.38 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.4318389e-15  1.6295517e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019613438    1.6295517e-14  0              0.058840314    16925.771      0              8.1728491e+11  0              0              3.3261166    
    200000   120            100            100            0.006902892    1.6295517e-14  0              0.020708676    4083.4309      0              1.9717427e+11  0              0              3.0737951    
    300000   120            100            100            0.00034326137  1.6295517e-14  0              0.0010297841   21.349935      0              1.030912e+09   0              0              3.0440655    
    400000   120            100            100            0.00035696733  1.6295517e-14  0              0.001070902    23.583783      0              1.1387765e+09  0              0              3.0050362    
    500000   120            100            100            0.045316675    0.0026219228   0              0.1333281      9.1007973      0              4.3944493e+08  0              0              2.9917256    
    600000   120            100            100            0.017507793    1.6295517e-14  0              0.052523379    0.56203791     0              27138799       0              0              2.9954109    
    700000   120            100            100            0.025046474    1.6295517e-14  0              0.075139423    0.59742546     0              28847537       0              0              2.9941517    
    800000   120            100            100            0.024629189    1.6295517e-14  0              0.073887567    0.068888675    0              3326387.6      0              0              2.9942282    
    900000   120            100            100            0.023760621    1.6295517e-14  0              0.071281863    0.00019198179  0              9270.1135      0              0              2.9943618    
   1000000   120            100            100            0.024213757    1.6295517e-14  0              0.072641271    0.00085478515  0              41274.516      0              0              2.9942901    
   1100000   120            100            100            0.024127874    1.6295517e-14  0              0.072383621    0.00022493791  0              10861.447      0              0              2.9943041    
   1200000   120            100            100            0.024105028    1.6295517e-14  0              0.072315083    7.7064174e-06  0              372.11532      0              0              2.9943076    
   1300000   120            100            100            0.024126906    1.6295517e-14  0              0.072380719    6.1393576e-07  0              29.64476       0              0              2.9943041    
   1400000   120            100            100            0.02412018     1.6295517e-14  0              0.072360539    5.2902023e-07  0              25.544494      0              0              2.9943052    
   1500000   120            100            100            0.024120238    1.6295517e-14  0              0.072360714    4.8577619e-08  0              2.3456394      0              0              2.9943052    
   1600000   120            100            100            0.024121122    1.6295517e-14  0              0.072363366    2.4171311e-13  0              1.1671461e-05  0              0              2.994305     
   1700000   120            100            100            0.024120717    1.6295517e-14  0              0.072362152    8.7646737e-10  0              0.042321472    0              0              2.9943051    
   1800000   120            100            100            0.024120779    1.6295517e-14  0              0.072362338    1.7831428e-10  0              0.0086101583   0              0              2.9943051    
   1900000   120            100            100            0.024120806    1.6295517e-14  0              0.072362419    3.9473701e-12  0              0.00019060438  0              0              2.9943051    
   2000000   120            100            100            0.024120786    1.6295517e-14  0              0.072362357    8.3787129e-13  0              4.0457806e-05  0              0              2.9943051    
   2100000   120            100            100            0.024120791    1.6295517e-14  0              0.072362374    4.61894e-13    0              2.2303208e-05  0              0              2.9943051    
   2200000   120            100            100            0.024120792    1.6295517e-14  0              0.072362375    3.2842531e-14  0              1.5858483e-06  0              0              2.9943051    
   2300000   120            100            100            0.024120791    1.6295517e-14  0              0.072362372    1.1133911e-16  0              5.3761673e-09  0              0              2.9943051    
   2400000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    8.5745578e-16  0              4.1403471e-08  0              0              2.9943051    
   2500000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    1.3919715e-16  0              6.7213323e-09  0              0              2.9943051    
   2600000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    1.7123317e-18  0              8.268237e-11   0              0              2.9943051    
   2700000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    1.3729428e-18  0              6.6294495e-11  0              0              2.9943051    
   2800000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    3.8977155e-19  0              1.8820673e-11  0              0              2.9943051    
   2900000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    9.5515446e-20  0              4.6120991e-12  0              0              2.9943051    
   3000000   120            100            100            0.024120791    1.6295517e-14  0              0.072362373    1.0449515e-19  0              5.0456968e-12  0              0              2.9943051    
Loop time of 25.7379 on 2 procs for 3000000 steps with 58 atoms

Performance: 100707489.574 ns/day, 0.000 hours/ns, 116559.594 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3674     | 2.5671     | 2.7668     |  12.5 |  9.97
Neigh   | 0.04041    | 0.040461   | 0.040513   |   0.0 |  0.16
Comm    | 8.4448     | 8.6327     | 8.8206     |   6.4 | 33.54
Output  | 0.10757    | 0.1076     | 0.10764    |   0.0 |  0.42
Modify  | 11.134     | 11.245     | 11.355     |   3.3 | 43.69
Other   |            | 3.145      |            |       | 12.22

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.39 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.4811668e-15  1.64435e-14    0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019615851    1.64435e-14    0              0.058847552    16928.857      0              8.1743392e+11  0              0              3.3260408    
    200000   120            100            100            0.0069084599   1.64435e-14    0              0.02072538     4088.5739      0              1.974226e+11   0              0              3.0736579    
    300000   120            100            100            0.00035111922  1.64435e-14    0              0.0010533577   22.302893      0              1.0769269e+09  0              0              3.044086     
    400000   120            100            100            0.00037708291  1.64435e-14    0              0.0011312487   26.209494      0              1.2655627e+09  0              0              3.0049819    
    500000   120            100            100            0.047709476    0.0035068514   0              0.13962158     4.6651479      0              2.252633e+08   0              0              2.9915836    
    600000   120            100            100            0.018694686    1.64435e-14    0              0.056084057    2.0659351      0              99756611       0              0              2.9952422    
    700000   120            100            100            0.023350585    1.64435e-14    0              0.070051754    0.63254741     0              30543451       0              0              2.9944518    
    800000   120            100            100            0.025111094    1.64435e-14    0              0.075333283    0.0013340003   0              64414.102      0              0              2.9941857    
    900000   120            100            100            0.023949628    1.64435e-14    0              0.071848885    0.0096550513   0              466207.87      0              0              2.9943673    
   1000000   120            100            100            0.024034196    1.64435e-14    0              0.072102589    0.0010037127   0              48465.692      0              0              2.9943526    
   1100000   120            100            100            0.024167843    1.64435e-14    0              0.072503529    2.2031254e-05  0              1063.8104      0              0              2.9943319    
   1200000   120            100            100            0.024120109    1.64435e-14    0              0.072360327    3.0961877e-05  0              1495.0382      0              0              2.9943395    
   1300000   120            100            100            0.024114998    1.64435e-14    0              0.072344994    7.6924982e-07  0              37.144321      0              0              2.9943403    
   1400000   120            100            100            0.024122845    1.64435e-14    0              0.072368536    2.6485573e-07  0              12.788935      0              0              2.994339     
   1500000   120            100            100            0.024121405    1.64435e-14    0              0.072364214    6.6846446e-08  0              3.2277756      0              0              2.9943393    
   1600000   120            100            100            0.024120734    1.64435e-14    0              0.072362203    3.8235753e-13  0              1.8462677e-05  0              0              2.9943394    
   1700000   120            100            100            0.024121111    1.64435e-14    0              0.072363334    1.2123957e-09  0              0.05854225     0              0              2.9943393    
   1800000   120            100            100            0.0241211      1.64435e-14    0              0.072363299    9.1125852e-11  0              0.0044001413   0              0              2.9943393    
   1900000   120            100            100            0.024121052    1.64435e-14    0              0.072363155    4.4848786e-12  0              0.00021655873  0              0              2.9943393    
   2000000   120            100            100            0.024121066    1.64435e-14    0              0.072363199    3.4867128e-12  0              0.00016836088  0              0              2.9943393    
   2100000   120            100            100            0.024121069    1.64435e-14    0              0.072363207    4.8778468e-14  0              2.3553377e-06  0              0              2.9943393    
   2200000   120            100            100            0.024121066    1.64435e-14    0              0.072363199    3.7118014e-14  0              1.7922961e-06  0              0              2.9943393    
   2300000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      6.761396e-15   0              3.2648361e-07  0              0              2.9943393    
   2400000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      1.500439e-17   0              7.2450828e-10  0              0              2.9943393    
   2500000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      1.4735963e-16  0              7.115469e-09   0              0              2.9943393    
   2600000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      8.3179571e-18  0              4.0164438e-10  0              0              2.9943393    
   2700000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      1.0163519e-18  0              4.9075994e-11  0              0              2.9943393    
   2800000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      3.8303353e-19  0              1.8495318e-11  0              0              2.9943393    
   2900000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      2.3895085e-21  0              1.1538081e-13  0              0              2.9943393    
   3000000   120            100            100            0.024121067    1.64435e-14    0              0.0723632      9.0506946e-20  0              4.3702565e-12  0              0              2.9943393    
Loop time of 25.9352 on 2 procs for 3000000 steps with 58 atoms

Performance: 99941295.761 ns/day, 0.000 hours/ns, 115672.796 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3526     | 2.5144     | 2.6761     |  10.2 |  9.69
Neigh   | 0.040216   | 0.040233   | 0.04025    |   0.0 |  0.16
Comm    | 8.7817     | 8.9853     | 9.1889     |   6.8 | 34.65
Output  | 0.089259   | 0.089289   | 0.089318   |   0.0 |  0.34
Modify  | 11.171     | 11.218     | 11.266     |   1.4 | 43.26
Other   |            | 3.088      |            |       | 11.91

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.4 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.5327159e-15  1.6598148e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019618342    1.6598148e-14  0              0.058855027    16932.044      0              8.1758782e+11  0              0              3.3259625    
    200000   120            100            100            0.0069142075   1.6598148e-14  0              0.020742622    4093.8848      0              1.9767904e+11  0              0              3.0735161    
    300000   120            100            100            0.00035923187  1.6598148e-14  0              0.0010776956   23.307061      0              1.1254146e+09  0              0              3.0441065    
    400000   120            100            100            0.00039788419  1.6598148e-14  0              0.0011936526   29.059267      0              1.403168e+09   0              0              3.004921     
    500000   120            100            100            0.049357224    0.0040932198   0              0.14397845     1.4347053      0              69276784       0              0              2.9914994    
    600000   120            100            100            0.020693022    1.6598148e-14  0              0.062079066    3.886526       0              1.8766643e+08  0              0              2.9949449    
    700000   120            100            100            0.021933213    1.6598148e-14  0              0.065799639    0.23638376     0              11414126       0              0              2.994715     
    800000   120            100            100            0.024780039    1.6598148e-14  0              0.074340118    0.051603282    0              2491737.8      0              0              2.99427      
    900000   120            100            100            0.02437293     1.6598148e-14  0              0.073118791    0.0068046432   0              328571.87      0              0              2.9943363    
   1000000   120            100            100            0.024015424    1.6598148e-14  0              0.072046273    0.00063292368  0              30561.619      0              0              2.9943913    
   1100000   120            100            100            0.024094294    1.6598148e-14  0              0.072282883    0.00016413898  0              7925.6838      0              0              2.9943786    
   1200000   120            100            100            0.024137475    1.6598148e-14  0              0.072412424    6.5550409e-06  0              316.51946      0              0              2.994372     
   1300000   120            100            100            0.024123947    1.6598148e-14  0              0.07237184     3.6213049e-06  0              174.85985      0              0              2.9943741    
   1400000   120            100            100            0.024118997    1.6598148e-14  0              0.072356991    4.8760353e-08  0              2.354463       0              0              2.9943749    
   1500000   120            100            100            0.024121154    1.6598148e-14  0              0.072363463    7.4033784e-08  0              3.5748265      0              0              2.9943746    
   1600000   120            100            100            0.024121682    1.6598148e-14  0              0.072365045    1.4208824e-10  0              0.0068609325   0              0              2.9943745    
   1700000   120            100            100            0.024121355    1.6598148e-14  0              0.072364065    1.4143118e-09  0              0.068292055    0              0              2.9943745    
   1800000   120            100            100            0.024121305    1.6598148e-14  0              0.072363916    7.5623713e-13  0              3.6515985e-05  0              0              2.9943745    
   1900000   120            100            100            0.024121353    1.6598148e-14  0              0.072364058    2.5318999e-11  0              0.0012225639   0              0              2.9943745    
   2000000   120            100            100            0.024121356    1.6598148e-14  0              0.072364069    2.0245723e-13  0              9.7759353e-06  0              0              2.9943745    
   2100000   120            100            100            0.02412135     1.6598148e-14  0              0.072364049    4.24129e-13    0              2.0479672e-05  0              0              2.9943745    
   2200000   120            100            100            0.02412135     1.6598148e-14  0              0.072364049    1.0791882e-14  0              5.2110138e-07  0              0              2.9943745    
   2300000   120            100            100            0.024121351    1.6598148e-14  0              0.072364052    6.6059825e-15  0              3.1897925e-07  0              0              2.9943745    
   2400000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    3.74692e-16    0              1.8092536e-08  0              0              2.9943745    
   2500000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    9.6293165e-17  0              4.6496523e-09  0              0              2.9943745    
   2600000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    1.0884752e-17  0              5.255857e-10   0              0              2.9943745    
   2700000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    1.4712996e-18  0              7.1043791e-11  0              0              2.9943745    
   2800000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    2.3904401e-19  0              1.154258e-11   0              0              2.9943745    
   2900000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    2.2884501e-20  0              1.1050107e-12  0              0              2.9943745    
   3000000   120            100            100            0.02412135     1.6598148e-14  0              0.072364051    2.355944e-21   0              1.1376011e-13  0              0              2.9943745    
Loop time of 26.2409 on 2 procs for 3000000 steps with 58 atoms

Performance: 98777132.930 ns/day, 0.000 hours/ns, 114325.385 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3877     | 2.5405     | 2.6934     |   9.6 |  9.68
Neigh   | 0.040408   | 0.040423   | 0.040438   |   0.0 |  0.15
Comm    | 8.8039     | 8.9507     | 9.0975     |   4.9 | 34.11
Output  | 0.10159    | 0.10164    | 0.10168    |   0.0 |  0.39
Modify  | 11.413     | 11.508     | 11.603     |   2.8 | 43.86
Other   |            | 3.099      |            |       | 11.81

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.41 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.5865865e-15  1.675976e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019620915    1.675976e-14   0              0.058862744    16935.335      0              8.1774672e+11  0              0              3.3258816    
    200000   120            100            100            0.0069201387   1.675976e-14   0              0.020760416    4099.3677      0              1.979438e+11   0              0              3.0733697    
    300000   120            100            100            0.00036760553  1.675976e-14   0              0.0011028166   24.365078      0              1.1765024e+09  0              0              3.0441268    
    400000   120            100            100            0.00041938885  1.675976e-14   0              0.0012581665   32.147588      0              1.552292e+09   0              0              3.0048529    
    500000   120            100            100            0.050003076    0.0042403429   0              0.14576889     0.024561237    0              1185974.2      0              0              2.9914839    
    600000   120            100            100            0.023388751    1.675976e-14   0              0.070166252    5.03005        0              2.4288311e+08  0              0              2.9945499    
    700000   120            100            100            0.021441924    1.675976e-14   0              0.064325773    0.0026518673   0              128049.18      0              0              2.9948338    
    800000   120            100            100            0.023847243    1.675976e-14   0              0.071541729    0.086804937    0              4191499.7      0              0              2.9944501    
    900000   120            100            100            0.024448377    1.675976e-14   0              0.073345132    0.002608948    0              125976.76      0              0              2.9943598    
   1000000   120            100            100            0.024208021    1.675976e-14   0              0.072624062    0.0010328922   0              49874.667      0              0              2.9943978    
   1100000   120            100            100            0.024090703    1.675976e-14   0              0.072272109    0.0001396777   0              6744.5363      0              0              2.9944157    
   1200000   120            100            100            0.024105213    1.675976e-14   0              0.07231564     6.4354513e-06  0              310.74491      0              0              2.9944133    
   1300000   120            100            100            0.024123312    1.675976e-14   0              0.072369936    3.9527369e-06  0              190.86352      0              0              2.9944105    
   1400000   120            100            100            0.024124121    1.675976e-14   0              0.072372364    1.5059881e-09  0              0.072718774    0              0              2.9944104    
   1500000   120            100            100            0.024121796    1.675976e-14   0              0.072365388    7.561721e-08   0              3.6512845      0              0              2.9944107    
   1600000   120            100            100            0.02412133     1.675976e-14   0              0.072363991    1.359162e-09   0              0.065629069    0              0              2.9944108    
   1700000   120            100            100            0.024121574    1.675976e-14   0              0.072364721    9.9637531e-10  0              0.048111398    0              0              2.9944108    
   1800000   120            100            100            0.024121674    1.675976e-14   0              0.072365022    9.6503815e-11  0              0.0046598239   0              0              2.9944107    
   1900000   120            100            100            0.024121656    1.675976e-14   0              0.072364969    7.6555324e-12  0              0.00036965826  0              0              2.9944108    
   2000000   120            100            100            0.02412164     1.675976e-14   0              0.07236492     3.0735066e-12  0              0.00014840863  0              0              2.9944108    
   2100000   120            100            100            0.02412164     1.675976e-14   0              0.07236492     1.1204103e-14  0              5.4100605e-07  0              0              2.9944108    
   2200000   120            100            100            0.024121642    1.675976e-14   0              0.072364926    6.4247847e-14  0              3.1022986e-06  0              0              2.9944108    
   2300000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    5.9995134e-16  0              2.8969503e-08  0              0              2.9944108    
   2400000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    9.3115497e-16  0              4.4962141e-08  0              0              2.9944108    
   2500000   120            100            100            0.024121642    1.675976e-14   0              0.072364926    6.6729199e-17  0              3.2221142e-09  0              0              2.9944108    
   2600000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    8.3863994e-18  0              4.0494922e-10  0              0              2.9944108    
   2700000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    2.5610276e-18  0              1.2366286e-10  0              0              2.9944108    
   2800000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    2.076135e-20   0              1.0024913e-12  0              0              2.9944108    
   2900000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    1.3359414e-19  0              6.4507828e-12  0              0              2.9944108    
   3000000   120            100            100            0.024121642    1.675976e-14   0              0.072364927    2.5830526e-20  0              1.2472637e-12  0              0              2.9944108    
Loop time of 25.8311 on 2 procs for 3000000 steps with 58 atoms

Performance: 100344019.428 ns/day, 0.000 hours/ns, 116138.911 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.409      | 2.647      | 2.885      |  14.6 | 10.25
Neigh   | 0.039709   | 0.039729   | 0.039749   |   0.0 |  0.15
Comm    | 8.4481     | 8.6753     | 8.9024     |   7.7 | 33.58
Output  | 0.088961   | 0.088985   | 0.089009   |   0.0 |  0.34
Modify  | 11.153     | 11.263     | 11.373     |   3.3 | 43.60
Other   |            | 3.117      |            |       | 12.07

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.42 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.6428865e-15  1.692866e-14   0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019623569    1.692866e-14   0              0.058870706    16938.731      0              8.1791072e+11  0              0              3.325798     
    200000   120            100            100            0.0069262564   1.692866e-14   0              0.020778769    4105.0254      0              1.9821699e+11  0              0              3.0732185    
    300000   120            100            100            0.00037624453  1.692866e-14   0              0.0011287336   25.479449      0              1.2303114e+09  0              0              3.0441471    
    400000   120            100            100            0.00044161283  1.692866e-14   0              0.0013248385   35.489322      0              1.7136523e+09  0              0              3.0047771    
    500000   120            100            100            0.04950947     0.0040048118   0              0.1445236      0.85676516     0              41370123       0              0              2.9915465    
    600000   120            100            100            0.026471314    1.692866e-14   0              0.079413941    4.642197       0              2.2415508e+08  0              0              2.9941157    
    700000   120            100            100            0.022217067    1.692866e-14   0              0.0666512      0.34258025     0              16541974       0              0              2.9947512    
    800000   120            100            100            0.023153329    1.692866e-14   0              0.069459988    0.0066159079   0              319458.51      0              0              2.9945969    
    900000   120            100            100            0.024026301    1.692866e-14   0              0.072078903    0.011891365    0              574191.44      0              0              2.9944615    
   1000000   120            100            100            0.024218727    1.692866e-14   0              0.07265618     0.00083096722  0              40124.433      0              0              2.9944328    
   1100000   120            100            100            0.024170236    1.692866e-14   0              0.072510709    1.7792393e-05  0              859.13099      0              0              2.9944406    
   1200000   120            100            100            0.024126518    1.692866e-14   0              0.072379553    2.9624628e-05  0              1430.4673      0              0              2.9944473    
   1300000   120            100            100            0.024117083    1.692866e-14   0              0.07235125     2.020804e-06   0              97.577392      0              0              2.9944488    
   1400000   120            100            100            0.024119544    1.692866e-14   0              0.072358633    4.6731526e-08  0              2.2564982      0              0              2.9944484    
   1500000   120            100            100            0.024121722    1.692866e-14   0              0.072365166    7.371387e-08   0              3.559379       0              0              2.994448     
   1600000   120            100            100            0.024122186    1.692866e-14   0              0.072366558    4.9177983e-09  0              0.23746288     0              0              2.994448     
   1700000   120            100            100            0.024122061    1.692866e-14   0              0.072366184    1.2257917e-10  0              0.0059189095   0              0              2.994448     
   1800000   120            100            100            0.024121953    1.692866e-14   0              0.072365858    1.8339949e-10  0              0.0088557052   0              0              2.994448     
   1900000   120            100            100            0.02412193     1.692866e-14   0              0.07236579     1.1964219e-11  0              0.00057770929  0              0              2.994448     
   2000000   120            100            100            0.024121936    1.692866e-14   0              0.072365809    3.2090803e-13  0              1.54955e-05    0              0              2.994448     
   2100000   120            100            100            0.024121942    1.692866e-14   0              0.072365825    4.5616381e-13  0              2.2026518e-05  0              0              2.994448     
   2200000   120            100            100            0.024121943    1.692866e-14   0              0.072365828    2.9087316e-14  0              1.4045224e-06  0              0              2.994448     
   2300000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    8.3820627e-16  0              4.0473981e-08  0              0              2.994448     
   2400000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    1.1327785e-15  0              5.4697818e-08  0              0              2.994448     
   2500000   120            100            100            0.024121942    1.692866e-14   0              0.072365826    7.3770659e-17  0              3.5621211e-09  0              0              2.994448     
   2600000   120            100            100            0.024121942    1.692866e-14   0              0.072365826    1.9190616e-18  0              9.2664617e-11  0              0              2.994448     
   2700000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    2.5955925e-18  0              1.2533187e-10  0              0              2.994448     
   2800000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    9.359935e-20   0              4.5195776e-12  0              0              2.994448     
   2900000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    1.6380558e-20  0              7.909585e-13   0              0              2.994448     
   3000000   120            100            100            0.024121942    1.692866e-14   0              0.072365827    9.7265131e-20  0              4.6965851e-12  0              0              2.994448     
Loop time of 25.7965 on 2 procs for 3000000 steps with 58 atoms

Performance: 100478893.384 ns/day, 0.000 hours/ns, 116295.015 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3635     | 2.6097     | 2.8558     |  15.2 | 10.12
Neigh   | 0.039926   | 0.039941   | 0.039956   |   0.0 |  0.15
Comm    | 8.4731     | 8.6853     | 8.8975     |   7.2 | 33.67
Output  | 0.10019    | 0.10022    | 0.10024    |   0.0 |  0.39
Modify  | 11.08      | 11.217     | 11.353     |   4.1 | 43.48
Other   |            | 3.145      |            |       | 12.19

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.43 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.7017315e-15  1.7105194e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019626307    1.7105194e-14  0              0.058878921    16942.236      0              8.1807993e+11  0              0              3.3257117    
    200000   120            100            100            0.0069325667   1.7105194e-14  0              0.0207977      4110.8638      0              1.984989e+11   0              0              3.0730624    
    300000   120            100            100            0.00038515685  1.7105194e-14  0              0.0011554705   26.653256      0              1.2869904e+09  0              0              3.0441671    
    400000   120            100            100            0.00046456446  1.7105194e-14  0              0.0013936934   39.098707      0              1.8879367e+09  0              0              3.0046931    
    500000   120            100            100            0.047880269    0.0035893304   0              0.14005148     4.0080753      0              1.9353561e+08  0              0              2.9916938    
    600000   120            100            100            0.029389341    1.7105194e-14  0              0.088168022    2.7437276      0              1.3248478e+08  0              0              2.9937262    
    700000   120            100            100            0.024050683    1.7105194e-14  0              0.072152049    0.69345511     0              33484466       0              0              2.9945062    
    800000   120            100            100            0.02343222     1.7105194e-14  0              0.070296661    0.048952929    0              2363761.8      0              0              2.9945945    
    900000   120            100            100            0.0237523      1.7105194e-14  0              0.071256899    8.3317639e-05  0              4023.1106      0              0              2.9945429    
   1000000   120            100            100            0.024012101    1.7105194e-14  0              0.072036302    0.00062337839  0              30100.712      0              0              2.9945028    
   1100000   120            100            100            0.024111836    1.7105194e-14  0              0.072335509    0.00022389995  0              10811.327      0              0              2.9944877    
   1200000   120            100            100            0.02413144     1.7105194e-14  0              0.072394321    2.3466433e-05  0              1133.1101      0              0              2.9944848    
   1300000   120            100            100            0.02412871     1.7105194e-14  0              0.07238613     4.0631726e-07  0              19.619606      0              0              2.9944853    
   1400000   120            100            100            0.024124557    1.7105194e-14  0              0.072373671    9.3131503e-08  0              4.496987       0              0              2.9944859    
   1500000   120            100            100            0.024122644    1.7105194e-14  0              0.072367932    6.4509855e-08  0              3.11495        0              0              2.9944862    
   1600000   120            100            100            0.024122155    1.7105194e-14  0              0.072366464    9.6631561e-09  0              0.46659923     0              0              2.9944863    
   1700000   120            100            100            0.024122145    1.7105194e-14  0              0.072366434    3.8645596e-10  0              0.018660575    0              0              2.9944863    
   1800000   120            100            100            0.024122205    1.7105194e-14  0              0.072366616    6.2379592e-12  0              0.00030120873  0              0              2.9944863    
   1900000   120            100            100            0.02412224     1.7105194e-14  0              0.07236672     1.6265569e-11  0              0.00078540609  0              0              2.9944863    
   2000000   120            100            100            0.024122251    1.7105194e-14  0              0.072366752    3.5294961e-12  0              0.00017042673  0              0              2.9944863    
   2100000   120            100            100            0.024122252    1.7105194e-14  0              0.072366756    2.3704613e-13  0              1.1446109e-05  0              0              2.9944863    
   2200000   120            100            100            0.024122251    1.7105194e-14  0              0.072366754    1.7949795e-16  0              8.6673136e-09  0              0              2.9944863    
   2300000   120            100            100            0.024122251    1.7105194e-14  0              0.072366752    3.426299e-15   0              1.6544372e-07  0              0              2.9944863    
   2400000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.1524768e-15  0              5.5648982e-08  0              0              2.9944863    
   2500000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.1646023e-16  0              5.6234475e-09  0              0              2.9944863    
   2600000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.887308e-18   0              9.1131349e-11  0              0              2.9944863    
   2700000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.8871244e-19  0              9.1122483e-12  0              0              2.9944863    
   2800000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    2.9091072e-19  0              1.4047037e-11  0              0              2.9944863    
   2900000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.0928704e-19  0              5.2770799e-12  0              0              2.9944863    
   3000000   120            100            100            0.02412225     1.7105194e-14  0              0.072366751    1.4201673e-20  0              6.8574796e-13  0              0              2.9944863    
Loop time of 25.656 on 2 procs for 3000000 steps with 58 atoms

Performance: 101028928.256 ns/day, 0.000 hours/ns, 116931.630 timesteps/s
99.7% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.382      | 2.5426     | 2.7032     |  10.1 |  9.91
Neigh   | 0.039554   | 0.039651   | 0.039747   |   0.0 |  0.15
Comm    | 8.4547     | 8.6116     | 8.7684     |   5.3 | 33.57
Output  | 0.15773    | 0.15775    | 0.15778    |   0.0 |  0.61
Modify  | 11.105     | 11.219     | 11.332     |   3.4 | 43.73
Other   |            | 3.086      |            |       | 12.03

Nlocal:             29 ave          30 max          28 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:              3 ave           4 max           2 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:             20 ave          21 max          19 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.44 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.7632457e-15  1.7289737e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019629131    1.7289737e-14  0              0.058887393    16945.85       0              8.1825444e+11  0              0              3.3256227    
    200000   120            100            100            0.0069390691   1.7289737e-14  0              0.020817207    4116.8827      0              1.9878953e+11  0              0              3.0729014    
    300000   120            100            100            0.00039434317  1.7289737e-14  0              0.0011830295   27.888725      0              1.3466467e+09  0              0              3.0441868    
    400000   120            100            100            0.0004882465   1.7289737e-14  0              0.0014647395   42.989441      0              2.0758063e+09  0              0              3.0046004    
    500000   120            100            100            0.044928485    0.002189627    0              0.13259583     9.1239671      0              4.4056372e+08  0              0              2.9919292    
    600000   120            100            100            0.031413566    1.7289737e-14  0              0.094240698    0.61418376     0              29656736       0              0              2.9934779    
    700000   120            100            100            0.026055694    1.7289737e-14  0              0.078167082    0.36936505     0              17835316       0              0              2.9942429    
    800000   120            100            100            0.02449019     1.7289737e-14  0              0.073470569    0.08271107     0              3993821.6      0              0              2.9944731    
    900000   120            100            100            0.024114528    1.7289737e-14  0              0.072343583    0.012750588    0              615680.25      0              0              2.994528     
   1000000   120            100            100            0.024067392    1.7289737e-14  0              0.072202177    0.0014358708   0              69333.064      0              0              2.9945343    
   1100000   120            100            100            0.024086102    1.7289737e-14  0              0.072258306    0.00010998269  0              5310.6705      0              0              2.9945312    
   1200000   120            100            100            0.024105234    1.7289737e-14  0              0.072315702    4.009523e-06   0              193.60552      0              0              2.9945282    
   1300000   120            100            100            0.024115716    1.7289737e-14  0              0.072347148    3.3472503e-09  0              0.16162674     0              0              2.9945266    
   1400000   120            100            100            0.024120255    1.7289737e-14  0              0.072360764    9.6301816e-08  0              4.65007        0              0              2.9945259    
   1500000   120            100            100            0.024121922    1.7289737e-14  0              0.072365766    4.1276668e-08  0              1.9931026      0              0              2.9945257    
   1600000   120            100            100            0.024122441    1.7289737e-14  0              0.072367324    9.2431564e-09  0              0.44631894     0              0              2.9945256    
   1700000   120            100            100            0.024122569    1.7289737e-14  0              0.072367707    1.434482e-09   0              0.069266       0              0              2.9945256    
   1800000   120            100            100            0.024122585    1.7289737e-14  0              0.072367756    1.6233742e-10  0              0.0078386932   0              0              2.9945256    
   1900000   120            100            100            0.024122579    1.7289737e-14  0              0.072367738    1.2514458e-11  0              0.00060427837  0              0              2.9945256    
   2000000   120            100            100            0.024122573    1.7289737e-14  0              0.072367719    4.6395641e-13  0              2.2402795e-05  0              0              2.9945256    
   2100000   120            100            100            0.024122569    1.7289737e-14  0              0.072367708    2.4433603e-16  0              1.1798112e-08  0              0              2.9945256    
   2200000   120            100            100            0.024122568    1.7289737e-14  0              0.072367703    1.0572148e-14  0              5.1049117e-07  0              0              2.9945256    
   2300000   120            100            100            0.024122567    1.7289737e-14  0              0.072367702    4.5914238e-15  0              2.2170342e-07  0              0              2.9945256    
   2400000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    1.0328216e-15  0              4.9871257e-08  0              0              2.9945256    
   2500000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    1.6159798e-16  0              7.8029882e-09  0              0              2.9945256    
   2600000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    1.7585728e-17  0              8.4915188e-10  0              0              2.9945256    
   2700000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    1.526632e-18   0              7.3715594e-11  0              0              2.9945256    
   2800000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    1.4971575e-20  0              7.229238e-13   0              0              2.9945256    
   2900000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    3.1089852e-22  0              1.5012177e-14  0              0              2.9945256    
   3000000   120            100            100            0.024122567    1.7289737e-14  0              0.072367701    6.5439609e-21  0              3.1598445e-13  0              0              2.9945256    
Loop time of 26.2043 on 2 procs for 3000000 steps with 58 atoms

Performance: 98915057.532 ns/day, 0.000 hours/ns, 114485.020 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.379      | 2.5161     | 2.6532     |   8.6 |  9.60
Neigh   | 0.04065    | 0.040651   | 0.040652   |   0.0 |  0.16
Comm    | 8.7825     | 8.9423     | 9.102      |   5.3 | 34.13
Output  | 0.097131   | 0.097163   | 0.097195   |   0.0 |  0.37
Modify  | 11.511     | 11.514     | 11.516     |   0.1 | 43.94
Other   |            | 3.094      |            |       | 11.81

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

variable lat1 equal 3*(2^(1/2))
variable lat2 equal 3
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at upper chain

variable n2e1 equal 10*v_lat1              # Half length of top chain. 1500 is number of particles
variable n1e1 equal v_n2e1*(v_lat1/v_lat2)              # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable x_shift equal -0.25*v_d1

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2 (picograms)

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m


variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.1+(0.01*v_ind)                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider



################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 ${n1e1} -50 50 -50 50 units box
region box block -60.0000000000001 60.0000000000001 -50 50 -50 50 units box
region substrate block ${n1e2} ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 ${n1e1} -0.1 0.1 0 0.1 units box
region substrate block -60.0000000000001 60.0000000000001 -0.1 0.1 0 0.1 units box

create_box 2 box
Created orthogonal box = (-60 -50 -50) to (60 50 50)
  2 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -42.4264068711929 42.4264068711929 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 29 atoms
  using lattice units in orthogonal box = (-60 -50 -50) to (60 50 50)
  create_atoms CPU = 0.000 seconds


set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}                    # Set mass and diameter for each particles type
set type 2 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  29 settings made for mass


group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
29 atoms in group slider1
#displace_atoms slider1 move ${x_shift} 0.0 0.0
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.45 tangential mindlin NULL 0.1 0.01 damping viscoelastic

comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction


thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3]

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

#fix nve_slider1 slider1 nve                   # Integrate motion for slider1 group
#fix lan_slider slider1 langevin 0 0 ${lgv} 6987532
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 29 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz
dump_modify D1 format 5 %.12g
dump_modify D1 format 7 %.12g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 78 65 65
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 13.49 | 13.49 | 13.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   120            100            100            5.8275628e-15  1.7482688e-14  0              0              0              0              0              0              0              6            
    100000   120            100            100            0.019632043    1.7482688e-14  0              0.058896128    16949.577      0              8.1843443e+11  0              0              3.3255307    
    200000   120            100            100            0.0069457728   1.7482688e-14  0              0.020837318    4123.0906      0              1.9908929e+11  0              0              3.0727353    
    300000   120            100            100            0.00040381452  1.7482688e-14  0              0.0012114435   29.189573      0              1.40946e+09    0              0              3.0442062    
    400000   120            100            100            0.00051268282  1.7482688e-14  0              0.0015380485   47.179141      0              2.2781118e+09  0              0              3.0044985    
    500000   120            100            100            0.041164506    0.00043284877  0              0.12306067     15.475529      0              7.4725793e+08  0              0              2.9922517    
    600000   120            100            100            0.031834211    1.7482688e-14  0              0.095502633    0.098881441    0              4774630.9      0              0              2.9934575    
    700000   120            100            100            0.026936841    1.7482688e-14  0              0.080810523    0.00018146578  0              8762.3331      0              0              2.9941505    
    800000   120            100            100            0.025150131    1.7482688e-14  0              0.075450393    0.00013839107  0              6682.4095      0              0              2.9944127    
    900000   120            100            100            0.024498822    1.7482688e-14  0              0.073496465    8.937425e-05   0              4315.5627      0              0              2.9945096    
   1000000   120            100            100            0.024260453    1.7482688e-14  0              0.072781358    2.8182801e-05  0              1360.8466      0              0              2.9945453    
   1100000   120            100            100            0.024173164    1.7482688e-14  0              0.072519491    6.8689996e-06  0              331.67941      0              0              2.9945584    
   1200000   120            100            100            0.024141232    1.7482688e-14  0              0.072423696    1.4592774e-06  0              70.463284      0              0              2.9945632    
   1300000   120            100            100            0.02412957     1.7482688e-14  0              0.072388709    2.8435935e-07  0              13.730695      0              0              2.9945649    
   1400000   120            100            100            0.024125319    1.7482688e-14  0              0.072375956    5.2203212e-08  0              2.5207063      0              0              2.9945656    
   1500000   120            100            100            0.024123772    1.7482688e-14  0              0.072371316    9.1727523e-09  0              0.44291938     0              0              2.9945658    
   1600000   120            100            100            0.02412321     1.7482688e-14  0              0.072369631    1.5584024e-09  0              0.075249676    0              0              2.9945659    
   1700000   120            100            100            0.024123007    1.7482688e-14  0              0.072369021    2.5776841e-10  0              0.012446714    0              0              2.9945659    
   1800000   120            100            100            0.024122933    1.7482688e-14  0              0.0723688      4.1713315e-11  0              0.0020141867   0              0              2.9945659    
   1900000   120            100            100            0.024122907    1.7482688e-14  0              0.072368721    6.6277581e-12  0              0.00032003072  0              0              2.9945659    
   2000000   120            100            100            0.024122897    1.7482688e-14  0              0.072368692    1.0370214e-12  0              5.0074054e-05  0              0              2.9945659    
   2100000   120            100            100            0.024122894    1.7482688e-14  0              0.072368682    1.6003864e-13  0              7.7276931e-06  0              0              2.9945659    
   2200000   120            100            100            0.024122893    1.7482688e-14  0              0.072368678    2.4410395e-14  0              1.1786906e-06  0              0              2.9945659    
   2300000   120            100            100            0.024122892    1.7482688e-14  0              0.072368677    3.6805388e-15  0              1.7772005e-07  0              0              2.9945659    
   2400000   120            100            100            0.024122892    1.7482688e-14  0              0.072368677    5.4934346e-16  0              2.6525829e-08  0              0              2.9945659    
   2500000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    8.180912e-17   0              3.9502696e-09  0              0              2.9945659    
   2600000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    1.219932e-17   0              5.8906148e-10  0              0              2.9945659    
   2700000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    1.3539135e-18  0              6.5375636e-11  0              0              2.9945659    
   2800000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    2.2164887e-19  0              1.0702631e-11  0              0              2.9945659    
   2900000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    7.2753494e-20  0              3.5130058e-12  0              0              2.9945659    
   3000000   120            100            100            0.024122892    1.7482688e-14  0              0.072368676    1.8648857e-19  0              9.0048658e-12  0              0              2.9945659    
Loop time of 25.9829 on 2 procs for 3000000 steps with 58 atoms

Performance: 99757967.554 ns/day, 0.000 hours/ns, 115460.611 timesteps/s
99.8% CPU use with 2 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.3671     | 2.5904     | 2.8137     |  13.9 |  9.97
Neigh   | 0.041084   | 0.041127   | 0.041171   |   0.0 |  0.16
Comm    | 8.7899     | 8.997      | 9.2041     |   6.9 | 34.63
Output  | 0.089445   | 0.089481   | 0.089517   |   0.0 |  0.34
Modify  | 11.177     | 11.224     | 11.27      |   1.4 | 43.20
Other   |            | 3.041      |            |       | 11.70

Nlocal:             29 ave          29 max          29 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Nghost:              3 ave           3 max           3 min
Histogram: 2 0 0 0 0 0 0 0 0 0
Neighs:             20 ave          20 max          20 min
Histogram: 2 0 0 0 0 0 0 0 0 0

Total # of neighbors = 40
Ave neighs/atom = 0.68965517
Neighbor list builds = 164
Dangerous builds = 0

undump D1


clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 0:15:37

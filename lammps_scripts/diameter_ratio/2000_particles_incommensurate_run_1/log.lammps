LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.003 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 8212 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 156 | 156 | 156 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0031888582   3.8079792e-35  0              0.0095665747   1167141.5      0              5.6357084e+10  1.1971759e-13  0              3.3271665    
    200000   12727.922      200            200            0.0011220306   5.0773177e-35  0              0.0033660917   281386.72      0              1.3587158e+10  1.1971759e-13  0              3.07527      
    300000   12727.922      200            200            6.733108e-05   1.2693254e-35  0              0.00020199324  2111.4018      0              1.0195204e+08  1.1971759e-13  0              3.0452685    
    400000   12727.922      200            200            0.00018472321  2.5756287e-07  0              0.00055391206  14110.103      0              6.8132637e+08  1.1971759e-13  0              2.999902     
    500000   12727.922      200            200            0.0015983401   0.00017793983  0              0.0046170804   1885.0597      0              91022785       1.1971759e-13  0              2.9970525    
    600000   12727.922      200            200            0.0046584564   0.00069504722  0              0.013280322    383.02405      0              18494861       1.1971759e-13  0              2.9949111    
    700000   12727.922      200            200            0.0042633721   0.00056960023  0              0.012220516    52.104481      0              2515938.9      1.1971759e-13  0              2.9950966    
    800000   12727.922      200            200            0.003964344    0.00054607393  0              0.011346958    4.2289332      0              204200.05      1.1971759e-13  0              2.9952822    
    900000   12727.922      200            200            0.0041957661   0.00060054376  0              0.011986755    0.20065338     0              9688.8335      1.1971759e-13  0              2.9951492    
   1000000   12727.922      200            200            0.0040905131   0.00058718396  0              0.011684355    0.00053927383  0              26.039603      1.1971759e-13  0              2.995211     
   1100000   12727.922      200            200            0.0041303955   0.00058848375  0              0.011802703    0.0019532767   0              94.316743      1.1971759e-13  0              2.9951869    
   1200000   12727.922      200            200            0.0041171595   0.00058822405  0              0.011763254    0.0010860456   0              52.441257      1.1971759e-13  0              2.9951949    
   1300000   12727.922      200            200            0.0041207638   0.00058830068  0              0.011773991    0.00026679892  0              12.882765      1.1971759e-13  0              2.9951927    
   1400000   12727.922      200            200            0.0041201071   0.00058828747  0              0.011772034    4.366948e-05   0              2.1086429      1.1971759e-13  0              2.9951931    
   1500000   12727.922      200            200            0.0041200668   0.00058828637  0              0.011771914    5.1567016e-06  0              0.24899866     1.1971759e-13  0              2.9951931    
   1600000   12727.922      200            200            0.0041201822   0.0005882889   0              0.011772258    4.1814138e-07  0              0.020190551    1.1971759e-13  0              2.9951931    
   1700000   12727.922      200            200            0.0041201097   0.00058828734  0              0.011772042    1.739103e-08   0              0.00083975059  1.1971759e-13  0              2.9951931    
   1800000   12727.922      200            200            0.0041201432   0.00058828805  0              0.011772142    5.0485958e-12  0              2.4377862e-07  1.1971759e-13  0              2.9951931    
   1900000   12727.922      200            200            0.0041201303   0.00058828778  0              0.011772103    2.6225189e-10  0              1.2663205e-05  1.1971759e-13  0              2.9951931    
   2000000   12727.922      200            200            0.0041201345   0.00058828787  0              0.011772116    1.2639576e-10  0              6.1031987e-06  1.1971759e-13  0              2.9951931    
   2100000   12727.922      200            200            0.0041201334   0.00058828784  0              0.011772112    2.9388185e-11  0              1.4190503e-06  1.1971759e-13  0              2.9951931    
   2200000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    4.6323229e-12  0              2.2367829e-07  1.1971759e-13  0              2.9951931    
   2300000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    5.2747959e-13  0              2.5470102e-08  1.1971759e-13  0              2.9951931    
   2400000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    4.0825487e-14  0              1.9713166e-09  1.1971759e-13  0              2.9951931    
   2500000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    1.6409519e-15  0              7.9235694e-11  1.1971759e-13  0              2.9951931    
   2600000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    1.5511347e-18  0              7.4898744e-14  1.1971759e-13  0              2.9951931    
   2700000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    1.0112008e-17  0              4.8827268e-13  1.1971759e-13  0              2.9951931    
   2800000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    1.3207123e-19  0              6.377247e-15   1.1971759e-13  0              2.9951931    
   2900000   12727.922      200            200            0.0041201336   0.00058828785  0              0.011772113    7.4560401e-18  0              3.6002549e-13  1.1971759e-13  0              2.9951931    
   3000000   12727.922      200            200            0.0041201336   0.00058828784  0              0.011772113    1.0145196e-18  0              4.898752e-14   1.1971759e-13  0              2.9951931    
Loop time of 559.959 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4628912.413 ns/day, 0.000 hours/ns, 5357.538 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.168     | 80.527     | 137.38     | 632.1 | 14.38
Neigh   | 6.8499     | 6.9076     | 6.9628     |   1.6 |  1.23
Comm    | 22.776     | 28.649     | 33.905     |  76.5 |  5.12
Output  | 0.3973     | 0.39801    | 0.39873    |   0.1 |  0.07
Modify  | 327.96     | 337.97     | 347.41     |  51.1 | 60.36
Other   |            | 105.5      |            |       | 18.84

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.01                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.4138228207373
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.11
  ghost atom cutoff = 3.11
  binsize = 1.555, bins = 8186 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 153.4 | 153.4 | 153.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0031982024  -2.5386442e-35  0              0.0095946071   1171708        0              5.6577584e+10  1.1971759e-13  0              3.3274044    
    200000   12727.922      200            200            0.0011355651   2.030925e-34   0              0.0034066952   286334.15      0              1.3826051e+10  1.1971759e-13  0              3.0771287    
    300000   12727.922      200            200            7.7665757e-05  2.5386615e-35  0              0.00023299727  2767.273       0              1.3362171e+08  1.1971759e-13  0              3.0499323    
    400000   12727.922      200            200            0.00036002445 -1.6187892e-05  0              0.0010962612   15822.509      0              7.6401235e+08  1.1971759e-13  0              3.0039973    
    500000   12727.922      200            200            0.0020489856   0.00022830517  0              0.0059186517   2328.8028      0              1.1244955e+08  1.1971759e-13  0              3.0016585    
    600000   12727.922      200            200            0.0050011217   0.00062692335  0              0.014376442    313.06063      0              15116577       1.1971759e-13  0              2.9997116    
    700000   12727.922      200            200            0.0040922141   0.00052058458  0              0.011756058    55.643534      0              2686827.1      1.1971759e-13  0              3.0001981    
    800000   12727.922      200            200            0.0040299715   0.00054936454  0              0.01154055     6.3033104      0              304364.3       1.1971759e-13  0              3.0002506    
    900000   12727.922      200            200            0.0041813353   0.00059104133  0              0.011952965    0.54401994     0              26268.776      1.1971759e-13  0              3.0001639    
   1000000   12727.922      200            200            0.0040973121   0.00057819844  0              0.011713738    0.027880345    0              1346.2421      1.1971759e-13  0              3.0002131    
   1100000   12727.922      200            200            0.0041343766   0.00057929188  0              0.011823838    0.00026068206  0              12.587404      1.1971759e-13  0              3.0001906    
   1200000   12727.922      200            200            0.0041197439   0.00057899609  0              0.011780236    0.00012858799  0              6.2090538      1.1971759e-13  0              3.0001995    
   1300000   12727.922      200            200            0.0041248417   0.00057910785  0              0.011795417    9.9354393e-05  0              4.7974681      1.1971759e-13  0              3.0001964    
   1400000   12727.922      200            200            0.0041233018   0.00057907539  0              0.01179083     2.8422485e-05  0              1.3724201      1.1971759e-13  0              3.0001973    
   1500000   12727.922      200            200            0.0041236762   0.00057908326  0              0.011791945    5.41867e-06    0              0.26164818     1.1971759e-13  0              3.0001971    
   1600000   12727.922      200            200            0.0041236256   0.00057908226  0              0.011791794    7.8292896e-07  0              0.037804838    1.1971759e-13  0              3.0001971    
   1700000   12727.922      200            200            0.0041236101   0.00057908189  0              0.011791748    8.7541966e-08  0              0.0042270883   1.1971759e-13  0              3.0001971    
   1800000   12727.922      200            200            0.0041236275   0.00057908228  0              0.0117918      7.1636692e-09  0              0.00034590795  1.1971759e-13  0              3.0001971    
   1900000   12727.922      200            200            0.0041236176   0.00057908206  0              0.011791771    3.4109836e-10  0              1.6470419e-05  1.1971759e-13  0              3.0001971    
   2000000   12727.922      200            200            0.0041236221   0.00057908216  0              0.011791784    1.7798593e-12  0              8.5943035e-08  1.1971759e-13  0              3.0001971    
   2100000   12727.922      200            200            0.0041236204   0.00057908212  0              0.011791779    2.4446179e-12  0              1.1804185e-07  1.1971759e-13  0              3.0001971    
   2200000   12727.922      200            200            0.004123621    0.00057908213  0              0.011791781    1.573576e-12   0              7.5982351e-08  1.1971759e-13  0              3.0001971    
   2300000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     4.2513121e-13  0              2.0528065e-08  1.1971759e-13  0              3.0001971    
   2400000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     7.8525597e-14  0              3.79172e-09    1.1971759e-13  0              3.0001971    
   2500000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     1.1108949e-14  0              5.3641137e-10  1.1971759e-13  0              3.0001971    
   2600000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     1.1553889e-15  0              5.5789595e-11  1.1971759e-13  0              3.0001971    
   2700000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     1.1709366e-16  0              5.6540335e-12  1.1971759e-13  0              3.0001971    
   2800000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     2.0959312e-17  0              1.0120502e-12  1.1971759e-13  0              3.0001971    
   2900000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     1.1499264e-18  0              5.552583e-14   1.1971759e-13  0              3.0001971    
   3000000   12727.922      200            200            0.0041236208   0.00057908213  0              0.01179178     1.3560805e-17  0              6.5480276e-13  1.1971759e-13  0              3.0001971    
Loop time of 557.784 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4646963.827 ns/day, 0.000 hours/ns, 5378.430 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.687     | 80.166     | 136.25     | 624.5 | 14.37
Neigh   | 6.9133     | 6.9739     | 7.0368     |   1.7 |  1.25
Comm    | 23.153     | 29.176     | 34.351     |  77.1 |  5.23
Output  | 0.39892    | 0.39961    | 0.40034    |   0.1 |  0.07
Modify  | 324.51     | 335.12     | 345.22     |  55.0 | 60.08
Other   |            | 105.9      |            |       | 18.99

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         690.75 ave        1382 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2763
Ave neighs/atom = 0.5524895
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.02                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.7279587335909
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.12
  ghost atom cutoff = 3.12
  binsize = 1.56, bins = 8159 129 129
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 153 | 153 | 153 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032075486  -1.2693212e-35  0              0.0096226458   1176281.2      0              5.6798412e+10  1.1971759e-13  0              3.3276309    
    200000   12727.922      200            200            0.001149145    1.2693271e-35  0              0.003447435    291320.34      0              1.4066817e+10  1.1971759e-13  0              3.0789572    
    300000   12727.922      200            200            8.8131878e-05  2.5386691e-35  0              0.00026439563  3510.8132      0              1.695246e+08   1.1971759e-13  0              3.0545505    
    400000   12727.922      200            200            0.00086503141  6.2730124e-06  0              0.0025888212   17468.991      0              8.4351504e+08  1.1971759e-13  0              3.0080414    
    500000   12727.922      200            200            0.0026136038   0.00031343056  0              0.007527381    2708.3534      0              1.3077669e+08  1.1971759e-13  0              3.0062266    
    600000   12727.922      200            200            0.0053201782   0.00058825683  0              0.015372278    220.97995      0              10670331       1.1971759e-13  0              3.0045378    
    700000   12727.922      200            200            0.0039387956   0.00051360493  0              0.011302782    51.282067      0              2476227.5      1.1971759e-13  0              3.0052991    
    800000   12727.922      200            200            0.0041041606   0.00055182065  0              0.011760661    7.3753271      0              356128.15      1.1971759e-13  0              3.0052137    
    900000   12727.922      200            200            0.0041596446   0.00058100664  0              0.011897927    0.86267418     0              41655.449      1.1971759e-13  0              3.0051828    
   1000000   12727.922      200            200            0.0041084361   0.00056923501  0              0.011756073    0.079932503    0              3859.6545      1.1971759e-13  0              3.0052126    
   1100000   12727.922      200            200            0.0041361413   0.00056999193  0              0.011838432    0.0053298147   0              257.35768      1.1971759e-13  0              3.0051956    
   1200000   12727.922      200            200            0.0041232558   0.00056972317  0              0.011800044    0.00016827192  0              8.1252487      1.1971759e-13  0              3.0052034    
   1300000   12727.922      200            200            0.0041285434   0.00056984057  0              0.01181579     5.4890747e-07  0              0.026504777    1.1971759e-13  0              3.0052002    
   1400000   12727.922      200            200            0.0041265819   0.0005697985   0              0.011809947    5.1065864e-06  0              0.24657878     1.1971759e-13  0              3.0052014    
   1500000   12727.922      200            200            0.0041272417   0.00056981273  0              0.011811912    2.186669e-06   0              0.10558642     1.1971759e-13  0              3.005201     
   1600000   12727.922      200            200            0.0041270444   0.00056980852  0              0.011811325    5.3175089e-07  0              0.025676348    1.1971759e-13  0              3.0052011    
   1700000   12727.922      200            200            0.0041270936   0.00056980956  0              0.011811471    9.6514552e-08  0              0.0046603423   1.1971759e-13  0              3.0052011    
   1800000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    1.4167418e-08  0              0.0006840939   1.1971759e-13  0              3.0052011    
   1900000   12727.922      200            200            0.0041270846   0.00056980937  0              0.011811444    1.71416e-09    0              8.2770651e-05  1.1971759e-13  0              3.0052011    
   2000000   12727.922      200            200            0.0041270865   0.00056980942  0              0.01181145     1.6715517e-10  0              8.071325e-06   1.1971759e-13  0              3.0052011    
   2100000   12727.922      200            200            0.0041270853   0.00056980939  0              0.011811447    1.2027903e-11  0              5.8078439e-07  1.1971759e-13  0              3.0052011    
   2200000   12727.922      200            200            0.0041270859   0.0005698094   0              0.011811448    4.7052235e-13  0              2.271984e-08   1.1971759e-13  0              3.0052011    
   2300000   12727.922      200            200            0.0041270856   0.0005698094   0              0.011811448    1.7427727e-16  0              8.4152255e-12  1.1971759e-13  0              3.0052011    
   2400000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    7.0523358e-15  0              3.4053206e-10  1.1971759e-13  0              3.0052011    
   2500000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    3.7190647e-15  0              1.7958032e-10  1.1971759e-13  0              3.0052011    
   2600000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    9.3780819e-16  0              4.5283401e-11  1.1971759e-13  0              3.0052011    
   2700000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    1.5189408e-16  0              7.3344213e-12  1.1971759e-13  0              3.0052011    
   2800000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    1.2300466e-17  0              5.9394547e-13  1.1971759e-13  0              3.0052011    
   2900000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    1.0534182e-17  0              5.0865794e-13  1.1971759e-13  0              3.0052011    
   3000000   12727.922      200            200            0.0041270857   0.0005698094   0              0.011811448    2.6422699e-19  0              1.2758576e-14  1.1971759e-13  0              3.0052011    
Loop time of 562.085 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4611400.223 ns/day, 0.000 hours/ns, 5337.269 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.093     | 79.757     | 137.1      | 633.5 | 14.19
Neigh   | 6.8823     | 6.9424     | 7.0042     |   1.7 |  1.24
Comm    | 22.785     | 29.108     | 34.117     |  87.7 |  5.18
Output  | 0.39965    | 0.40033    | 0.40103    |   0.1 |  0.07
Modify  | 328.62     | 338.92     | 350.12     |  51.6 | 60.30
Other   |            | 107        |            |       | 19.03

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         694.75 ave        1390 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2779
Ave neighs/atom = 0.55568886
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.03                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.0441819206036
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.13
  ghost atom cutoff = 3.13
  binsize = 1.565, bins = 8133 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 150.5 | 150.5 | 150.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032168969   1.2693265e-34  0              0.0096506908   1180861.3      0              5.7019566e+10  1.1971759e-13  0              3.3278462    
    200000   12727.922      200            200            0.00116277     5.0138343e-34  0              0.0034883101   296345.2       0              1.4309449e+10  1.1971759e-13  0              3.0807552    
    300000   12727.922      200            200            9.8728631e-05  5.0773724e-35  0              0.00029618589  4341.7224      0              2.0964624e+08  1.1971759e-13  0              3.0591231    
    400000   12727.922      200            200            0.0017314657   3.7680099e-05  0              0.0051567169   18850.153      0              9.1020641e+08  1.1971759e-13  0              3.012041     
    500000   12727.922      200            200            0.0032925077   0.00041961419  0              0.009457909    2974.482       0              1.4362709e+08  1.1971759e-13  0              3.0107668    
    600000   12727.922      200            200            0.0055932672   0.00058156174  0              0.01619824     125.73418      0              6071253.7      1.1971759e-13  0              3.0093992    
    700000   12727.922      200            200            0.0037871985   0.00046783071  0              0.010893765    40.406204      0              1951071        1.1971759e-13  0              3.0103929    
    800000   12727.922      200            200            0.0041817144   0.00055740636  0              0.011987737    7.0250188      0              339213.02      1.1971759e-13  0              3.0101758    
    900000   12727.922      200            200            0.0041328503   0.00056689877  0              0.011831652    0.99437299     0              48014.713      1.1971759e-13  0              3.0102041    
   1000000   12727.922      200            200            0.0041215115   0.00055688308  0              0.011807651    0.12350866     0              5963.7913      1.1971759e-13  0              3.0102101    
   1100000   12727.922      200            200            0.0041349006   0.00055717695  0              0.011847525    0.01319244     0              637.0157       1.1971759e-13  0              3.0102017    
   1200000   12727.922      200            200            0.004126549    0.00055700641  0              0.011822641    0.0011586817   0              55.948594      1.1971759e-13  0              3.0102068    
   1300000   12727.922      200            200            0.0041306667   0.00055709312  0              0.011834907    7.5111627e-05  0              3.6268717      1.1971759e-13  0              3.0102043    
   1400000   12727.922      200            200            0.0041288755   0.00055705643  0              0.01182957     2.4338033e-06  0              0.11751965     1.1971759e-13  0              3.0102054    
   1500000   12727.922      200            200            0.00412959     0.00055707114  0              0.011831699    3.6011571e-09  0              0.00017388699  1.1971759e-13  0              3.010205     
   1600000   12727.922      200            200            0.004129325    0.00055706573  0              0.011830909    6.3500392e-08  0              0.0030662067   1.1971759e-13  0              3.0102051    
   1700000   12727.922      200            200            0.0041294166   0.0005570676   0              0.011831182    2.8985921e-08  0              0.0013996264   1.1971759e-13  0              3.0102051    
   1800000   12727.922      200            200            0.0041293874   0.000557067    0              0.011831095    7.5040916e-09  0              0.00036234573  1.1971759e-13  0              3.0102051    
   1900000   12727.922      200            200            0.0041293958   0.00055706717  0              0.01183112     1.4768987e-09  0              7.1314151e-05  1.1971759e-13  0              3.0102051    
   2000000   12727.922      200            200            0.0041293938   0.00055706713  0              0.011831114    2.420945e-10   0              1.1689877e-05  1.1971759e-13  0              3.0102051    
   2100000   12727.922      200            200            0.004129394    0.00055706714  0              0.011831115    3.4204572e-11  0              1.6516164e-06  1.1971759e-13  0              3.0102051    
   2200000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    4.1956893e-12  0              2.0259482e-07  1.1971759e-13  0              3.0102051    
   2300000   12727.922      200            200            0.004129394    0.00055706714  0              0.011831115    4.4053435e-13  0              2.1271827e-08  1.1971759e-13  0              3.0102051    
   2400000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    3.8030699e-14  0              1.8363664e-09  1.1971759e-13  0              3.0102051    
   2500000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    2.4050678e-15  0              1.1613212e-10  1.1971759e-13  0              3.0102051    
   2600000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    6.4267445e-17  0              3.1032449e-12  1.1971759e-13  0              3.0102051    
   2700000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    3.8000442e-18  0              1.8349054e-13  1.1971759e-13  0              3.0102051    
   2800000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    3.1837416e-18  0              1.5373149e-13  1.1971759e-13  0              3.0102051    
   2900000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    1.0126198e-17  0              4.8895785e-13  1.1971759e-13  0              3.0102051    
   3000000   12727.922      200            200            0.0041293941   0.00055706714  0              0.011831115    2.7970622e-18  0              1.3506012e-13  1.1971759e-13  0              3.0102051    
Loop time of 559.761 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4630548.562 ns/day, 0.000 hours/ns, 5359.431 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.755     | 78.854     | 136.28     | 618.6 | 14.09
Neigh   | 6.7148     | 6.7745     | 6.8347     |   1.7 |  1.21
Comm    | 22.892     | 29.81      | 36.317     | 100.6 |  5.33
Output  | 0.40054    | 0.40123    | 0.40194    |   0.1 |  0.07
Modify  | 327.12     | 337.72     | 348.11     |  54.1 | 60.33
Other   |            | 106.2      |            |       | 18.97

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         651.25 ave        1303 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2605
Ave neighs/atom = 0.52089582
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.04                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.3624992932791
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.14
  ghost atom cutoff = 3.14
  binsize = 1.57, bins = 8107 128 128
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 150 | 150 | 150 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032262473  -1.2693236e-35  0              0.009678742    1185448.1      0              5.7241046e+10  1.1971759e-13  0              3.32805      
    200000   12727.922      200            200            0.0011764399  -3.0463697e-34  0              0.0035293196   301408.63      0              1.4553944e+10  1.1971759e-13  0              3.0825228    
    300000   12727.922      200            200            0.00010945516  7.615968e-35   0              0.00032836549  5259.6989      0              2.5397204e+08  1.1971759e-13  0              3.06365      
    400000   12727.922      200            200            0.0030327368   0.00020826767  0              0.0088899428   19727.835      0              9.5258657e+08  1.1971759e-13  0              3.016008     
    500000   12727.922      200            200            0.0040418953   0.0004332296   0              0.011692456    3082.1637      0              1.4882665e+08  1.1971759e-13  0              3.0152914    
    600000   12727.922      200            200            0.0057914234   0.00058362841  0              0.016790642    47.95508       0              2315579.2      1.1971759e-13  0              3.0143038    
    700000   12727.922      200            200            0.0036677195   0.00044693655  0              0.010556222    26.138194      0              1262119.9      1.1971759e-13  0              3.015473     
    800000   12727.922      200            200            0.004258602    0.00057466959  0              0.012201136    5.3830654      0              259928.96      1.1971759e-13  0              3.0151409    
    900000   12727.922      200            200            0.0041052591   0.00055027857  0              0.011765499    0.87370607     0              42188.139      1.1971759e-13  0              3.0152255    
   1000000   12727.922      200            200            0.0041359875   0.00054472658  0              0.011863236    0.1309102      0              6321.1851      1.1971759e-13  0              3.0152069    
   1100000   12727.922      200            200            0.0041326478   0.00054467597  0              0.011853267    0.017764455    0              857.78196      1.1971759e-13  0              3.0152085    
   1200000   12727.922      200            200            0.0041306472   0.00054463223  0              0.011847309    0.0021860046   0              105.55434      1.1971759e-13  0              3.0152098    
   1300000   12727.922      200            200            0.0041325336   0.00054467086  0              0.01185293     0.000241776    0              11.674498      1.1971759e-13  0              3.0152086    
   1400000   12727.922      200            200            0.0041314538   0.00054464931  0              0.011849712    2.34587e-05    0              1.1327367      1.1971759e-13  0              3.0152093    
   1500000   12727.922      200            200            0.004131973    0.00054465964  0              0.011851259    1.8951569e-06  0              0.091510346    1.1971759e-13  0              3.015209     
   1600000   12727.922      200            200            0.0041317466   0.00054465517  0              0.011850585    1.1176166e-07  0              0.0053965706   1.1971759e-13  0              3.0152091    
   1700000   12727.922      200            200            0.0041318389   0.00054465699  0              0.01185086     2.9447316e-09  0              0.00014219055  1.1971759e-13  0              3.015209     
   1800000   12727.922      200            200            0.0041318033   0.00054465629  0              0.011850754    3.6969755e-11  0              1.7851372e-06  1.1971759e-13  0              3.0152091    
   1900000   12727.922      200            200            0.0041318163   0.00054465655  0              0.011850792    1.3543941e-10  0              6.5398842e-06  1.1971759e-13  0              3.0152091    
   2000000   12727.922      200            200            0.0041318118   0.00054465646  0              0.011850779    5.638313e-11   0              2.7225396e-06  1.1971759e-13  0              3.0152091    
   2100000   12727.922      200            200            0.0041318133   0.00054465649  0              0.011850783    1.450644e-11   0              7.0046407e-07  1.1971759e-13  0              3.0152091    
   2200000   12727.922      200            200            0.0041318128   0.00054465648  0              0.011850782    2.9438644e-12  0              1.4214868e-07  1.1971759e-13  0              3.0152091    
   2300000   12727.922      200            200            0.004131813    0.00054465648  0              0.011850782    5.1331907e-13  0              2.4786341e-08  1.1971759e-13  0              3.0152091    
   2400000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    7.9301829e-14  0              3.8292015e-09  1.1971759e-13  0              3.0152091    
   2500000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    1.112358e-14   0              5.3711789e-10  1.1971759e-13  0              3.0152091    
   2600000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    1.3794318e-15  0              6.6607826e-11  1.1971759e-13  0              3.0152091    
   2700000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    1.8065576e-16  0              8.7232203e-12  1.1971759e-13  0              3.0152091    
   2800000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    2.6498117e-17  0              1.2794992e-12  1.1971759e-13  0              3.0152091    
   2900000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    2.1377349e-20  0              1.0322357e-15  1.1971759e-13  0              3.0152091    
   3000000   12727.922      200            200            0.0041318129   0.00054465648  0              0.011850782    1.3970358e-17  0              6.7457858e-13  1.1971759e-13  0              3.0152091    
Loop time of 565.135 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4586517.740 ns/day, 0.000 hours/ns, 5308.470 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.306     | 80.609     | 141.7      | 632.5 | 14.26
Neigh   | 6.5047     | 6.5604     | 6.617      |   1.6 |  1.16
Comm    | 22.078     | 30.143     | 41.596     | 131.8 |  5.33
Output  | 0.3996     | 0.40029    | 0.40105    |   0.1 |  0.07
Modify  | 331.76     | 340.46     | 350.04     |  44.2 | 60.24
Other   |            | 107        |            |       | 18.93

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         657.75 ave        1316 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2631
Ave neighs/atom = 0.52609478
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.05                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 32.6829177631213
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.15
  ghost atom cutoff = 3.15
  binsize = 1.575, bins = 8082 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.5 | 147.5 | 147.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032355997  -2.5386435e-35  0              0.0097067992   1190041.7      0              5.7462853e+10  1.1971759e-13  0              3.3282425    
    200000   12727.922      200            200            0.001190154   -5.0772787e-35  0              0.0035704621   306510.49      0              1.4800294e+10  1.1971759e-13  0              3.0842599    
    300000   12727.922      200            200            0.00012031058 -2.0309175e-34  0              0.00036093174  6264.437       0              3.0248724e+08  1.1971759e-13  0              3.0681311    
    400000   12727.922      200            200            0.0047279634   0.00035111471  0              0.013832775    19851.469      0              9.5855638e+08  1.1971759e-13  0              3.0199598    
    500000   12727.922      200            200            0.0048834865   0.00047388061  0              0.014176579    3000.0373      0              1.4486106e+08  1.1971759e-13  0              3.0198144    
    600000   12727.922      200            200            0.0058961745   0.00058677301  0              0.01710175     5.0187886      0              242339.34      1.1971759e-13  0              3.0192574    
    700000   12727.922      200            200            0.0036044033   0.00050170758  0              0.010311502    12.408009      0              599138.35      1.1971759e-13  0              3.0205344    
    800000   12727.922      200            200            0.0043174225   0.00057157907  0              0.012380688    3.0868689      0              149053.85      1.1971759e-13  0              3.0201129    
    900000   12727.922      200            200            0.004081519    0.00053390913  0              0.011710648    0.56339816     0              27204.481      1.1971759e-13  0              3.0202446    
   1000000   12727.922      200            200            0.0041498271   0.0005325947   0              0.011916887    0.097408287    0              4703.4976      1.1971759e-13  0              3.0202039    
   1100000   12727.922      200            200            0.0041302504   0.00053227136  0              0.01185848     0.015527239    0              749.75478      1.1971759e-13  0              3.0202153    
   1200000   12727.922      200            200            0.0041350657   0.00053236118  0              0.011872836    0.0023093144   0              111.50853      1.1971759e-13  0              3.0202126    
   1300000   12727.922      200            200            0.0041342263   0.00053234694  0              0.011870332    0.00032194803  0              15.545718      1.1971759e-13  0              3.020213     
   1400000   12727.922      200            200            0.0041341863   0.00053234559  0              0.011870213    4.2195181e-05  0              2.0374543      1.1971759e-13  0              3.0202131    
   1500000   12727.922      200            200            0.004134328    0.00053234849  0              0.011870636    5.1906427e-06  0              0.25063756     1.1971759e-13  0              3.020213     
   1600000   12727.922      200            200            0.0041342312   0.00053234658  0              0.011870347    5.9576467e-07  0              0.028767344    1.1971759e-13  0              3.020213     
   1700000   12727.922      200            200            0.004134282    0.00053234757  0              0.011870499    6.3039082e-08  0              0.0030439317   1.1971759e-13  0              3.020213     
   1800000   12727.922      200            200            0.0041342583   0.00053234711  0              0.011870428    6.0125301e-09  0              0.00029032356  1.1971759e-13  0              3.020213     
   1900000   12727.922      200            200            0.0041342686   0.00053234731  0              0.011870459    4.9465583e-10  0              2.388516e-05   1.1971759e-13  0              3.020213     
   2000000   12727.922      200            200            0.0041342644   0.00053234723  0              0.011870446    3.1783907e-11  0              1.5347311e-06  1.1971759e-13  0              3.020213     
   2100000   12727.922      200            200            0.004134266    0.00053234726  0              0.011870451    1.1706847e-12  0              5.6528173e-08  1.1971759e-13  0              3.020213     
   2200000   12727.922      200            200            0.0041342654   0.00053234725  0              0.011870449    5.4846722e-16  0              2.6483519e-11  1.1971759e-13  0              3.020213     
   2300000   12727.922      200            200            0.0041342656   0.00053234725  0              0.01187045     1.6651528e-14  0              8.0404268e-10  1.1971759e-13  0              3.020213     
   2400000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    9.3458634e-15  0              4.5127829e-10  1.1971759e-13  0              3.020213     
   2500000   12727.922      200            200            0.0041342656   0.00053234725  0              0.01187045     2.7530263e-15  0              1.3293379e-10  1.1971759e-13  0              3.020213     
   2600000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    5.957132e-16   0              2.8764859e-11  1.1971759e-13  0              3.020213     
   2700000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    7.7395196e-17  0              3.737137e-12   1.1971759e-13  0              3.020213     
   2800000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    6.9516557e-19  0              3.3567057e-14  1.1971759e-13  0              3.020213     
   2900000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    9.1259522e-18  0              4.4065957e-13  1.1971759e-13  0              3.020213     
   3000000   12727.922      200            200            0.0041342656   0.00053234725  0              0.011870449    1.1882307e-19  0              5.737541e-15   1.1971759e-13  0              3.020213     
Loop time of 556.774 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4655389.322 ns/day, 0.000 hours/ns, 5388.182 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.986     | 78.699     | 133.83     | 617.3 | 14.13
Neigh   | 6.3391     | 6.4013     | 6.4637     |   1.8 |  1.15
Comm    | 21.765     | 28.147     | 32.946     |  78.1 |  5.06
Output  | 0.40203    | 0.4027     | 0.40341    |   0.1 |  0.07
Modify  | 324.66     | 336.93     | 349.77     |  64.1 | 60.51
Other   |            | 106.2      |            |       | 19.07

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         662.75 ave        1326 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2651
Ave neighs/atom = 0.53009398
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.06                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.005444241634
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.16
  ghost atom cutoff = 3.16
  binsize = 1.58, bins = 8056 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.1 | 147.1 | 147.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032449541   4.2223309e-41  0              0.0097348622   1194642        0              5.7684985e+10  1.1971759e-13  0              3.3284236    
    200000   12727.922      200            200            0.0012039123   4.3157065e-34  0              0.0036117369   311650.71      0              1.5048497e+10  1.1971759e-13  0              3.0859664    
    300000   12727.922      200            200            0.0001312941  -2.0309181e-34  0              0.0003938823   7355.6435      0              3.551777e+08   1.1971759e-13  0              3.0725664    
    400000   12727.922      200            200            0.0067807109   0.00046038352  0              0.019881749    19009.082      0              9.1788055e+08  1.1971759e-13  0              3.0239195    
    500000   12727.922      200            200            0.0057628421   0.00046698295  0              0.016821543    2719.9483      0              1.3133657e+08  1.1971759e-13  0              3.0243515    
    600000   12727.922      200            200            0.0058952488   0.00057994552  0              0.017105801    6.5974909      0              318569.22      1.1971759e-13  0              3.0242628    
    700000   12727.922      200            200            0.0035709085   0.00053886347  0              0.010173862    2.8867423      0              139390.45      1.1971759e-13  0              3.0255732    
    800000   12727.922      200            200            0.0043574164   0.00056286421  0              0.012509385    1.0350843      0              49980.516      1.1971759e-13  0              3.0250951    
    900000   12727.922      200            200            0.0040627983   0.00051173161  0              0.011676663    0.22054272     0              10649.219      1.1971759e-13  0              3.0252596    
   1000000   12727.922      200            200            0.0041607671   0.00051938341  0              0.011962918    0.044317489    0              2139.9329      1.1971759e-13  0              3.0252025    
   1100000   12727.922      200            200            0.0041283602   0.00051899084  0              0.01186609     0.0082037153   0              396.12805      1.1971759e-13  0              3.0252217    
   1200000   12727.922      200            200            0.0041389973   0.00051919479  0              0.011897797    0.0014160098   0              68.374043      1.1971759e-13  0              3.0252154    
   1300000   12727.922      200            200            0.0041356324   0.00051913481  0              0.011887762    0.00023015967  0              11.113587      1.1971759e-13  0              3.0252174    
   1400000   12727.922      200            200            0.0041366496   0.00051915323  0              0.011890796    3.5649168e-05  0              1.7213707      1.1971759e-13  0              3.0252168    
   1500000   12727.922      200            200            0.0041363625   0.00051914812  0              0.011889939    5.2937994e-06  0              0.25561863     1.1971759e-13  0              3.025217     
   1600000   12727.922      200            200            0.0041364345   0.00051914938  0              0.011890154    7.5683568e-07  0              0.036544886    1.1971759e-13  0              3.0252169    
   1700000   12727.922      200            200            0.0041364208   0.00051914915  0              0.011890113    1.0441099e-07  0              0.0050416331   1.1971759e-13  0              3.0252169    
   1800000   12727.922      200            200            0.0041364211   0.00051914915  0              0.011890114    1.3912831e-08  0              0.00067180082  1.1971759e-13  0              3.0252169    
   1900000   12727.922      200            200            0.0041364227   0.00051914918  0              0.011890119    1.7901354e-09  0              8.6439234e-05  1.1971759e-13  0              3.0252169    
   2000000   12727.922      200            200            0.0041364215   0.00051914916  0              0.011890115    2.2207561e-10  0              1.0723237e-05  1.1971759e-13  0              3.0252169    
   2100000   12727.922      200            200            0.0041364221   0.00051914917  0              0.011890117    2.6483935e-11  0              1.2788144e-06  1.1971759e-13  0              3.0252169    
   2200000   12727.922      200            200            0.0041364218   0.00051914916  0              0.011890116    3.0210091e-12  0              1.4587372e-07  1.1971759e-13  0              3.0252169    
   2300000   12727.922      200            200            0.004136422    0.00051914917  0              0.011890117    3.2659487e-13  0              1.5770097e-08  1.1971759e-13  0              3.0252169    
   2400000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    3.2931783e-14  0              1.5901579e-09  1.1971759e-13  0              3.0252169    
   2500000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    2.9606528e-15  0              1.4295933e-10  1.1971759e-13  0              3.0252169    
   2600000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    2.4503131e-16  0              1.1831685e-11  1.1971759e-13  0              3.0252169    
   2700000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    3.9832044e-17  0              1.9233469e-12  1.1971759e-13  0              3.0252169    
   2800000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    1.5355453e-17  0              7.4145986e-13  1.1971759e-13  0              3.0252169    
   2900000   12727.922      200            200            0.0041364219   0.00051914917  0              0.011890117    1.5526938e-17  0              7.4974028e-13  1.1971759e-13  0              3.0252169    
   3000000   12727.922      200            200            0.0041364219   0.00051914916  0              0.011890117    7.7192539e-20  0              3.7273514e-15  1.1971759e-13  0              3.0252169    
Loop time of 552.983 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4687304.408 ns/day, 0.000 hours/ns, 5425.121 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.498     | 78.336     | 134.37     | 616.5 | 14.17
Neigh   | 6.24       | 6.2951     | 6.351      |   1.6 |  1.14
Comm    | 21.71      | 28.52      | 33.625     |  95.3 |  5.16
Output  | 0.39779    | 0.39846    | 0.39918    |   0.1 |  0.07
Modify  | 323.19     | 334.05     | 344.9      |  55.1 | 60.41
Other   |            | 105.4      |            |       | 19.06

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         668.25 ave        1337 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2673
Ave neighs/atom = 0.5344931
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.07                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.3300856403214
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.17
  ghost atom cutoff = 3.17
  binsize = 1.585, bins = 8031 127 127
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 146.7 | 146.7 | 146.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032543103   2.7931831e-41  0              0.009762931    1199249        0              5.7907443e+10  1.1971759e-13  0              3.3285933    
    200000   12727.922      200            200            0.0012177143  -4.5695679e-34  0              0.0036531428   316829.17      0              1.5298547e+10  1.1971759e-13  0              3.0876423    
    300000   12727.922      200            200            0.00014240487 -5.0772773e-35  0              0.00042721462  8533.0194      0              4.1202897e+08  1.1971759e-13  0              3.0769559    
    400000   12727.922      200            200            0.0088308423  -0.00030910131  0              0.026801628    17097.081      0              8.2555687e+08  1.1971759e-13  0              3.0279155    
    500000   12727.922      200            200            0.0066393886   0.00041830529  0              0.019499861    2264.4462      0              1.09342e+08    1.1971759e-13  0              3.0289195    
    600000   12727.922      200            200            0.0057925179   0.00057491918  0              0.016802635    52.09891       0              2515669.9      1.1971759e-13  0              3.0293198    
    700000   12727.922      200            200            0.0035624121   0.00053586054  0              0.010151376    0.054521693    0              2632.6574      1.1971759e-13  0              3.0305871    
    800000   12727.922      200            200            0.0043750105   0.00054958581  0              0.012575446    0.031170946    0              1505.1334      1.1971759e-13  0              3.0300896    
    900000   12727.922      200            200            0.0040541521   0.0004921144   0              0.011670342    0.016582768    0              800.72254      1.1971759e-13  0              3.0302689    
   1000000   12727.922      200            200            0.0041670731   0.00050435051  0              0.011996869    0.0054700092   0              264.12717      1.1971759e-13  0              3.0302035    
   1100000   12727.922      200            200            0.0041275875   0.00050419728  0              0.011878565    0.0014361333   0              69.345735      1.1971759e-13  0              3.0302271    
   1200000   12727.922      200            200            0.0041417844   0.00050445559  0              0.011920898    0.00032222776  0              15.559226      1.1971759e-13  0              3.0302186    
   1300000   12727.922      200            200            0.0041367456   0.00050437212  0              0.011905865    6.4196028e-05  0              3.0997964      1.1971759e-13  0              3.0302216    
   1400000   12727.922      200            200            0.0041385184   0.00050440243  0              0.011911153    1.1832323e-05  0              0.57134053     1.1971759e-13  0              3.0302206    
   1500000   12727.922      200            200            0.0041379008   0.00050439201  0              0.01190931     2.0601111e-06  0              0.099475393    1.1971759e-13  0              3.030221     
   1600000   12727.922      200            200            0.0041381136   0.00050439561  0              0.011909945    3.4338704e-07  0              0.016580931    1.1971759e-13  0              3.0302208    
   1700000   12727.922      200            200            0.0041380412   0.00050439439  0              0.011909729    5.5261641e-08  0              0.0026683869   1.1971759e-13  0              3.0302209    
   1800000   12727.922      200            200            0.0041380655   0.0005043948   0              0.011909802    8.637127e-09   0              0.00041705595  1.1971759e-13  0              3.0302209    
   1900000   12727.922      200            200            0.0041380575   0.00050439467  0              0.011909778    1.3164391e-09  0              6.3566133e-05  1.1971759e-13  0              3.0302209    
   2000000   12727.922      200            200            0.0041380601   0.00050439471  0              0.011909786    1.9626211e-10  0              9.476795e-06   1.1971759e-13  0              3.0302209    
   2100000   12727.922      200            200            0.0041380593   0.0005043947   0              0.011909783    2.8683276e-11  0              1.3850127e-06  1.1971759e-13  0              3.0302209    
   2200000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    4.1168532e-12  0              1.9878811e-07  1.1971759e-13  0              3.0302209    
   2300000   12727.922      200            200            0.0041380594   0.0005043947   0              0.011909784    5.8063329e-13  0              2.8036703e-08  1.1971759e-13  0              3.0302209    
   2400000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    8.044839e-14   0              3.8845648e-09  1.1971759e-13  0              3.0302209    
   2500000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    1.0973758e-14  0              5.298835e-10   1.1971759e-13  0              3.0302209    
   2600000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    1.4714186e-15  0              7.1049539e-11  1.1971759e-13  0              3.0302209    
   2700000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    1.9398179e-16  0              9.3666863e-12  1.1971759e-13  0              3.0302209    
   2800000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    1.5092043e-17  0              7.2874075e-13  1.1971759e-13  0              3.0302209    
   2900000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    5.0315618e-19  0              2.4295611e-14  1.1971759e-13  0              3.0302209    
   3000000   12727.922      200            200            0.0041380595   0.0005043947   0              0.011909784    7.0863565e-18  0              3.4217479e-13  1.1971759e-13  0              3.0302209    
Loop time of 560.854 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4621521.522 ns/day, 0.000 hours/ns, 5348.983 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.234     | 79.763     | 136.84     | 629.9 | 14.22
Neigh   | 6.3075     | 6.3646     | 6.4219     |   1.6 |  1.13
Comm    | 22.094     | 28.111     | 34.606     |  86.7 |  5.01
Output  | 0.39784    | 0.3985     | 0.3992     |   0.1 |  0.07
Modify  | 329.17     | 339.76     | 349.81     |  54.2 | 60.58
Other   |            | 106.5      |            |       | 18.98

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         673.25 ave        1347 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2693
Ave neighs/atom = 0.5384923
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.08                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.6568488706868
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.18
  ghost atom cutoff = 3.18
  binsize = 1.59, bins = 8005 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 144.3 | 144.3 | 144.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032636684   1.8063355e-40  0              0.0097910053   1203862.8      0              5.8130226e+10  1.1971759e-13  0              3.3287515    
    200000   12727.922      200            200            0.0012315596   1.0154649e-34  0              0.0036946788   322045.77      0              1.5550438e+10  1.1971759e-13  0              3.0892876    
    300000   12727.922      200            200            0.00015364202  6.6345193e-42  0              0.00046092606  9796.2624      0              4.7302645e+08  1.1971759e-13  0              3.0812994    
    400000   12727.922      200            200            0.011113405   -0.00086714396  0              0.034207358    14185.136      0              6.8494944e+08  1.1971759e-13  0              3.0319804    
    500000   12727.922      200            200            0.0074109232   0.00017659409  0              0.022056175    1689.534       0              81581551       1.1971759e-13  0              3.0335353    
    600000   12727.922      200            200            0.0055842876   0.00053462039  0              0.016218242    130.81529      0              6316602        1.1971759e-13  0              3.0344253    
    700000   12727.922      200            200            0.0035892521   0.00052149635  0              0.01024626     4.6045734      0              222338.37      1.1971759e-13  0              3.0355755    
    800000   12727.922      200            200            0.0043699625   0.00053608548  0              0.012573802    0.4622886      0              22322.262      1.1971759e-13  0              3.0350972    
    900000   12727.922      200            200            0.0040579486   0.0004789094   0              0.011694936    0.05182353     0              2502.3728      1.1971759e-13  0              3.035272     
   1000000   12727.922      200            200            0.0041688817   0.00049037858  0              0.012016267    0.0055837254   0              269.61811      1.1971759e-13  0              3.0352074    
   1100000   12727.922      200            200            0.0041293282   0.00049050864  0              0.011897476    0.00052459654  0              25.33089       1.1971759e-13  0              3.0352312    
   1200000   12727.922      200            200            0.0041439988   0.00049074348  0              0.011941253    4.1607573e-05  0              2.0090808      1.1971759e-13  0              3.0352224    
   1300000   12727.922      200            200            0.0041385922   0.00049067292  0              0.011925104    2.4990132e-06  0              0.1206684      1.1971759e-13  0              3.0352256    
   1400000   12727.922      200            200            0.0041405845   0.00049070426  0              0.011931049    8.357506e-08   0              0.0040355406   1.1971759e-13  0              3.0352244    
   1500000   12727.922      200            200            0.0041398523   0.00049069291  0              0.011928864    4.06246e-13    0              1.9616166e-08  1.1971759e-13  0              3.0352249    
   1600000   12727.922      200            200            0.0041401209   0.00049069709  0              0.011929666    1.5440197e-09  0              7.4555185e-05  1.1971759e-13  0              3.0352247    
   1700000   12727.922      200            200            0.0041400226   0.00049069557  0              0.011929372    8.2295223e-10  0              3.9737418e-05  1.1971759e-13  0              3.0352248    
   1800000   12727.922      200            200            0.0041400585   0.00049069612  0              0.011929479    2.4738855e-10  0              1.1945508e-05  1.1971759e-13  0              3.0352248    
   1900000   12727.922      200            200            0.0041400454   0.00049069592  0              0.01192944     5.8726961e-11  0              2.8357148e-06  1.1971759e-13  0              3.0352248    
   2000000   12727.922      200            200            0.0041400502   0.00049069599  0              0.011929454    1.2241905e-11  0              5.911178e-07   1.1971759e-13  0              3.0352248    
   2100000   12727.922      200            200            0.0041400484   0.00049069597  0              0.011929449    2.3518035e-12  0              1.1356017e-07  1.1971759e-13  0              3.0352248    
   2200000   12727.922      200            200            0.0041400491   0.00049069598  0              0.011929451    4.2563428e-13  0              2.0552356e-08  1.1971759e-13  0              3.0352248    
   2300000   12727.922      200            200            0.0041400488   0.00049069597  0              0.01192945     7.4504128e-14  0              3.5975377e-09  1.1971759e-13  0              3.0352248    
   2400000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    1.2406272e-14  0              5.9905448e-10  1.1971759e-13  0              3.0352248    
   2500000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    2.0145646e-15  0              9.7276116e-11  1.1971759e-13  0              3.0352248    
   2600000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    3.2477848e-16  0              1.5682391e-11  1.1971759e-13  0              3.0352248    
   2700000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    2.3031411e-17  0              1.1121044e-12  1.1971759e-13  0              3.0352248    
   2800000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    1.4741611e-18  0              7.1181962e-14  1.1971759e-13  0              3.0352248    
   2900000   12727.922      200            200            0.0041400489   0.00049069597  0              0.011929451    4.6857059e-18  0              2.2625597e-13  1.1971759e-13  0              3.0352248    
   3000000   12727.922      200            200            0.0041400489   0.00049069598  0              0.011929451    4.8520756e-19  0              2.3428937e-14  1.1971759e-13  0              3.0352248    
Loop time of 558.359 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4642172.405 ns/day, 0.000 hours/ns, 5372.885 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.087     | 80.108     | 135.58     | 614.8 | 14.35
Neigh   | 6.2085     | 6.2648     | 6.3217     |   1.6 |  1.12
Comm    | 21.862     | 28.609     | 33.785     |  80.2 |  5.12
Output  | 0.40018    | 0.40084    | 0.40153    |   0.1 |  0.07
Modify  | 325.25     | 337.3      | 348.8      |  62.6 | 60.41
Other   |            | 105.7      |            |       | 18.93

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         678.25 ave        1357 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2713
Ave neighs/atom = 0.5424915
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.09                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 33.9857408442343
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.19
  ghost atom cutoff = 3.19
  binsize = 1.595, bins = 7980 126 126
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 143.8 | 143.8 | 143.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032730283   4.7599698e-36  0              0.009819085    1208483.3      0              5.8353333e+10  1.1971759e-13  0              3.3288983    
    200000   12727.922      200            200            0.0012454479   3.1733131e-35  0              0.0037363438   327300.4       0              1.5804165e+10  1.1971759e-13  0              3.0909022    
    300000   12727.922      200            200            0.00016500472 -9.519936e-36   0              0.00049501416  11145.078      0              5.3815594e+08  1.1971759e-13  0              3.0855969    
    400000   12727.922      200            200            0.013368755   -0.0014677003   0              0.041573966    10559.153      0              5.0986372e+08  1.1971759e-13  0              3.0361493    
    500000   12727.922      200            200            0.0080546835  -0.00015300189  0              0.024317052    1079.7719      0              52138319       1.1971759e-13  0              3.0382152    
    600000   12727.922      200            200            0.0053266063   0.00057916143  0              0.015400657    224.75157      0              10852449       1.1971759e-13  0              3.0395733    
    700000   12727.922      200            200            0.0036529975   0.00050411388  0              0.010454879    15.289247      0              738263.02      1.1971759e-13  0              3.0405397    
    800000   12727.922      200            200            0.0043437825   0.00052460663  0              0.012506741    2.1464278      0              103643.31      1.1971759e-13  0              3.0401176    
    900000   12727.922      200            200            0.0040728409   0.00046871652  0              0.011749806    0.30656493     0              14802.923      1.1971759e-13  0              3.040269     
   1000000   12727.922      200            200            0.0041667137   0.00047902796  0              0.012021113    0.044357635    0              2141.8714      1.1971759e-13  0              3.0402141    
   1100000   12727.922      200            200            0.0041341921   0.0004794602   0              0.011923116    0.0062523654   0              301.90435      1.1971759e-13  0              3.0402339    
   1200000   12727.922      200            200            0.0041460188   0.000479543    0              0.011958513    0.00088349636  0              42.660878      1.1971759e-13  0              3.0402267    
   1300000   12727.922      200            200            0.0041417607   0.00047955186  0              0.01194573     0.00012491752  0              6.0318202      1.1971759e-13  0              3.0402293    
   1400000   12727.922      200            200            0.0041432989   0.00047955872  0              0.011950338    1.764538e-05   0              0.85203226     1.1971759e-13  0              3.0402284    
   1500000   12727.922      200            200            0.0041427434   0.00047955192  0              0.011948678    2.4871182e-06  0              0.12009404     1.1971759e-13  0              3.0402287    
   1600000   12727.922      200            200            0.0041429433   0.00047955434  0              0.011949276    3.4989666e-07  0              0.016895258    1.1971759e-13  0              3.0402286    
   1700000   12727.922      200            200            0.0041428714   0.00047955347  0              0.011949061    4.9130328e-08  0              0.0023723277   1.1971759e-13  0              3.0402287    
   1800000   12727.922      200            200            0.0041428973   0.00047955378  0              0.011949138    6.8862233e-09  0              0.00033251108  1.1971759e-13  0              3.0402286    
   1900000   12727.922      200            200            0.004142888    0.00047955367  0              0.01194911     9.6348434e-10  0              4.6523211e-05  1.1971759e-13  0              3.0402286    
   2000000   12727.922      200            200            0.0041428913   0.00047955371  0              0.01194912     1.3460756e-10  0              6.4997172e-06  1.1971759e-13  0              3.0402286    
   2100000   12727.922      200            200            0.0041428901   0.00047955369  0              0.011949117    1.8767834e-11  0              9.0623152e-07  1.1971759e-13  0              3.0402286    
   2200000   12727.922      200            200            0.0041428906   0.0004795537   0              0.011949118    2.6132229e-12  0              1.2618318e-07  1.1971759e-13  0              3.0402286    
   2300000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949117    3.6306621e-13  0              1.7531168e-08  1.1971759e-13  0              3.0402286    
   2400000   12727.922      200            200            0.0041428905   0.0004795537   0              0.011949118    5.016944e-14   0              2.4225027e-09  1.1971759e-13  0              3.0402286    
   2500000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    6.8576306e-15  0              3.3113044e-10  1.1971759e-13  0              3.0402286    
   2600000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    9.6164527e-16  0              4.6434409e-11  1.1971759e-13  0              3.0402286    
   2700000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    1.6662897e-16  0              8.0459166e-12  1.1971759e-13  0              3.0402286    
   2800000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    2.4224916e-17  0              1.1697345e-12  1.1971759e-13  0              3.0402286    
   2900000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    1.4867453e-18  0              7.178961e-14   1.1971759e-13  0              3.0402286    
   3000000   12727.922      200            200            0.0041428904   0.0004795537   0              0.011949118    9.2470854e-18  0              4.4650866e-13  1.1971759e-13  0              3.0402286    
Loop time of 554.91 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4671026.093 ns/day, 0.000 hours/ns, 5406.280 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.034     | 78.617     | 134.91     | 623.9 | 14.17
Neigh   | 6.3833     | 6.4444     | 6.5059     |   1.8 |  1.16
Comm    | 22.124     | 27.936     | 32.175     |  75.5 |  5.03
Output  | 0.40192    | 0.40258    | 0.40329    |   0.1 |  0.07
Modify  | 323.08     | 334.97     | 347.54     |  61.0 | 60.36
Other   |            | 106.5      |            |       | 19.20

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         682.75 ave        1366 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2731
Ave neighs/atom = 0.54609078
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.1                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.3167684724676
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.2
  ghost atom cutoff = 3.2
  binsize = 1.6, bins = 7955 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 147.4 | 147.5 | 147.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.00328239     7.9332823e-37  0              0.0098471699   1213110.5      0              5.8576765e+10  1.1971759e-13  0              3.3290337    
    200000   12727.922      200            200            0.0012593789   1.1404279e-40  0              0.0037781368   332592.96      0              1.6059724e+10  1.1971759e-13  0              3.092486     
    300000   12727.922      200            200            0.00017649212 -5.0772767e-35  0              0.00052947636  12579.169      0              6.0740307e+08  1.1971759e-13  0              3.0898483    
    400000   12727.922      200            200            0.01531289    -0.0023463511   0              0.04828502     6713.7703      0              3.2418394e+08  1.1971759e-13  0              3.0404572    
    500000   12727.922      200            200            0.0086003012  -0.0003091705   0              0.026110074    535.25222      0              25845414       1.1971759e-13  0              3.0429736    
    600000   12727.922      200            200            0.0049833942   0.00053589103  0              0.014414291    313.22743      0              15124631       1.1971759e-13  0              3.0447555    
    700000   12727.922      200            200            0.0037555138   0.00049888502  0              0.010767656    29.230793      0              1411450.4      1.1971759e-13  0              3.0454823    
    800000   12727.922      200            200            0.0043005714   0.00051811765  0              0.012383597    4.4102765      0              212956.47      1.1971759e-13  0              3.0451491    
    900000   12727.922      200            200            0.0040974371   0.00046180619  0              0.011830505    0.6520102      0              31483.239      1.1971759e-13  0              3.0452608    
   1000000   12727.922      200            200            0.004161849    0.00047165758  0              0.012013889    0.096712367    0              4669.8941      1.1971759e-13  0              3.0452233    
   1100000   12727.922      200            200            0.0041421573   0.00047217075  0              0.011954301    0.014046951    0              678.27697      1.1971759e-13  0              3.0452355    
   1200000   12727.922      200            200            0.0041484534   0.00047209485  0              0.011973265    0.0020232942   0              97.697637      1.1971759e-13  0              3.0452316    
   1300000   12727.922      200            200            0.004146525    0.00047212078  0              0.011967454    0.000287427    0              13.878821      1.1971759e-13  0              3.0452328    
   1400000   12727.922      200            200            0.0041470939   0.00047212722  0              0.011969154    4.0325402e-05  0              1.9471693      1.1971759e-13  0              3.0452324    
   1500000   12727.922      200            200            0.0041469394   0.00047212542  0              0.011968693    5.5882336e-06  0              0.2698358      1.1971759e-13  0              3.0452325    
   1600000   12727.922      200            200            0.0041469759   0.00047212586  0              0.011968802    7.6527077e-07  0              0.036952187    1.1971759e-13  0              3.0452325    
   1700000   12727.922      200            200            0.00414697     0.00047212578  0              0.011968784    1.0358284e-07  0              0.0050016447   1.1971759e-13  0              3.0452325    
   1800000   12727.922      200            200            0.0041469694   0.00047212578  0              0.011968782    1.3859483e-08  0              0.00066922482  1.1971759e-13  0              3.0452325    
   1900000   12727.922      200            200            0.0041469706   0.00047212579  0              0.011968786    1.8329897e-09  0              8.8508513e-05  1.1971759e-13  0              3.0452325    
   2000000   12727.922      200            200            0.0041469698   0.00047212578  0              0.011968784    2.3958179e-10  0              1.1568547e-05  1.1971759e-13  0              3.0452325    
   2100000   12727.922      200            200            0.0041469702   0.00047212579  0              0.011968785    3.094004e-11   0              1.4939838e-06  1.1971759e-13  0              3.0452325    
   2200000   12727.922      200            200            0.00414697     0.00047212578  0              0.011968784    3.9462379e-12  0              1.905497e-07   1.1971759e-13  0              3.0452325    
   2300000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968785    4.9734457e-13  0              2.4014989e-08  1.1971759e-13  0              3.0452325    
   2400000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968784    6.1511337e-14  0              2.9701623e-09  1.1971759e-13  0              3.0452325    
   2500000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968785    7.4512705e-15  0              3.5979519e-10  1.1971759e-13  0              3.0452325    
   2600000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968784    9.190211e-16   0              4.437624e-11   1.1971759e-13  0              3.0452325    
   2700000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968785    6.2316356e-17  0              3.0090338e-12  1.1971759e-13  0              3.0452325    
   2800000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968785    2.0806305e-19  0              1.004662e-14   1.1971759e-13  0              3.0452325    
   2900000   12727.922      200            200            0.0041469701   0.00047212579  0              0.011968784    3.2889111e-18  0              1.5880975e-13  1.1971759e-13  0              3.0452325    
   3000000   12727.922      200            200            0.0041469701   0.00047212578  0              0.011968784    7.1873726e-18  0              3.470525e-13   1.1971759e-13  0              3.0452325    
Loop time of 565.576 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4582942.376 ns/day, 0.000 hours/ns, 5304.331 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.98      | 80.699     | 139.62     | 633.9 | 14.27
Neigh   | 6.5404     | 6.5994     | 6.6603     |   1.7 |  1.17
Comm    | 22.445     | 28.196     | 32.008     |  72.3 |  4.99
Output  | 0.40091    | 0.40156    | 0.40226    |   0.1 |  0.07
Modify  | 327.46     | 339.58     | 354.18     |  64.2 | 60.04
Other   |            | 110.1      |            |       | 19.47

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.11                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.6499386668908
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.21
  ghost atom cutoff = 3.21
  binsize = 1.605, bins = 7931 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 141 | 141.1 | 141.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0032917534   7.9332822e-35  0              0.0098752601   1217744.5      0              5.8800521e+10  1.1971759e-13  0              3.3291575    
    200000   12727.922      200            200            0.0012733522  -1.2693205e-35  0              0.0038200566   337923.34      0              1.6317109e+10  1.1971759e-13  0              3.094039     
    300000   12727.922      200            200            0.00018810341  7.345481e-40   0              0.00056431022  14098.244      0              6.8075373e+08  1.1971759e-13  0              3.0940536    
    400000   12727.922      200            200            0.017079303   -0.0024580584   0              0.053695967    3278.39        0              1.5830172e+08  1.1971759e-13  0              3.0449362    
    500000   12727.922      200            200            0.008968182   -0.00038105412  0              0.0272856      152.07159      0              7342992.7      1.1971759e-13  0              3.0478218    
    600000   12727.922      200            200            0.0046310441   0.00056282589  0              0.013330306    377.82972      0              18244045       1.1971759e-13  0              3.049962     
    700000   12727.922      200            200            0.0038843168   0.00048447696  0              0.011168473    42.637309      0              2058803.1      1.1971759e-13  0              3.0504075    
    800000   12727.922      200            200            0.004244019    0.00051253166  0              0.012219525    6.3629322      0              307243.22      1.1971759e-13  0              3.0501887    
    900000   12727.922      200            200            0.0041288823   0.00045734991  0              0.011929297    0.91490362     0              44177.421      1.1971759e-13  0              3.0502489    
   1000000   12727.922      200            200            0.0041553159   0.00046682858  0              0.011999119    0.12902785     0              6230.293       1.1971759e-13  0              3.0502339    
   1100000   12727.922      200            200            0.0041518804   0.00046707995  0              0.011988561    0.017618185    0              850.71908      1.1971759e-13  0              3.0502365    
   1200000   12727.922      200            200            0.0041512877   0.00046697845  0              0.011986885    0.0023305264   0              112.53278      1.1971759e-13  0              3.0502366    
   1300000   12727.922      200            200            0.0041521976   0.00046702006  0              0.011989573    0.00029826774  0              14.402282      1.1971759e-13  0              3.0502362    
   1400000   12727.922      200            200            0.00415162     0.00046701425  0              0.011987846    3.6860966e-05  0              1.7798841      1.1971759e-13  0              3.0502365    
   1500000   12727.922      200            200            0.0041519194   0.0004670173   0              0.011988741    4.3862708e-06  0              0.21179732     1.1971759e-13  0              3.0502363    
   1600000   12727.922      200            200            0.0041517794   0.00046701586  0              0.011988322    5.0003597e-07  0              0.024144947    1.1971759e-13  0              3.0502364    
   1700000   12727.922      200            200            0.0041518409   0.0004670165   0              0.011988506    5.4194352e-08  0              0.0026168513   1.1971759e-13  0              3.0502364    
   1800000   12727.922      200            200            0.004151815    0.00046701623  0              0.011988429    5.5158343e-09  0              0.0002663399   1.1971759e-13  0              3.0502364    
   1900000   12727.922      200            200            0.0041518256   0.00046701634  0              0.01198846     5.1652271e-10  0              2.4941033e-05  1.1971759e-13  0              3.0502364    
   2000000   12727.922      200            200            0.0041518214   0.0004670163   0              0.011988448    4.2865702e-11  0              2.0698313e-06  1.1971759e-13  0              3.0502364    
   2100000   12727.922      200            200            0.004151823    0.00046701631  0              0.011988453    2.9169348e-12  0              1.4084834e-07  1.1971759e-13  0              3.0502364    
   2200000   12727.922      200            200            0.0041518224   0.00046701631  0              0.011988451    1.3135888e-13  0              6.3428501e-09  1.1971759e-13  0              3.0502364    
   2300000   12727.922      200            200            0.0041518226   0.00046701631  0              0.011988452    1.2173075e-15  0              5.8779421e-11  1.1971759e-13  0              3.0502364    
   2400000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    5.8698954e-16  0              2.8343624e-11  1.1971759e-13  0              3.0502364    
   2500000   12727.922      200            200            0.0041518226   0.00046701631  0              0.011988451    4.9130492e-16  0              2.3723356e-11  1.1971759e-13  0              3.0502364    
   2600000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    1.7127618e-16  0              8.2703138e-12  1.1971759e-13  0              3.0502364    
   2700000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    7.1349534e-17  0              3.4452136e-12  1.1971759e-13  0              3.0502364    
   2800000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    2.6203082e-17  0              1.265253e-12   1.1971759e-13  0              3.0502364    
   2900000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    1.160886e-17   0              5.6055032e-13  1.1971759e-13  0              3.0502364    
   3000000   12727.922      200            200            0.0041518225   0.00046701631  0              0.011988451    2.1409945e-20  0              1.0338096e-15  1.1971759e-13  0              3.0502364    
Loop time of 558.718 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4639188.797 ns/day, 0.000 hours/ns, 5369.431 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.92      | 79.001     | 135.28     | 626.7 | 14.14
Neigh   | 6.2473     | 6.3116     | 6.3768     |   1.9 |  1.13
Comm    | 21.871     | 27.559     | 32.477     |  79.9 |  4.93
Output  | 0.40186    | 0.40254    | 0.40325    |   0.1 |  0.07
Modify  | 325.88     | 337.46     | 350.93     |  59.5 | 60.40
Other   |            | 108        |            |       | 19.33

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         691.75 ave        1384 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2767
Ave neighs/atom = 0.55328934
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.12                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 34.9852583390075
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.22
  ghost atom cutoff = 3.22
  binsize = 1.61, bins = 7906 125 125
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 140.6 | 140.6 | 140.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033011184  -5.0772853e-35  0              0.0099033552   1222385.1      0              5.9024601e+10  1.1971759e-13  0              3.3292698    
    200000   12727.922      200            200            0.0012873674   5.0773216e-35  0              0.0038621023   343291.43      0              1.6576315e+10  1.1971759e-13  0              3.0955612    
    300000   12727.922      200            200            0.00019983767  4.0153301e-40  0              0.00059951302  15701.998      0              7.5819327e+08  1.1971759e-13  0              3.0982127    
    400000   12727.922      200            200            0.018257288   -0.0024647565   0              0.057236621    883.5886       0              42665331       1.1971759e-13  0              3.0496123    
    500000   12727.922      200            200            0.0091045303  -0.00042618792  0              0.027739779    0.88964714     0              42957.876      1.1971759e-13  0              3.0527675    
    600000   12727.922      200            200            0.0042547009   0.00054440383  0              0.012219699    406.28831      0              19618208       1.1971759e-13  0              3.055182     
    700000   12727.922      200            200            0.0040327462   0.00046365514  0              0.011634584    51.787305      0              2500623.6      1.1971759e-13  0              3.0553209    
    800000   12727.922      200            200            0.0041737155   0.00048752839  0              0.012033618    7.2494462      0              350049.81      1.1971759e-13  0              3.0552329    
    900000   12727.922      200            200            0.0041636717   0.00045488052  0              0.012036135    0.96376538     0              46536.781      1.1971759e-13  0              3.0552355    
   1000000   12727.922      200            200            0.004148071    0.00046163351  0              0.011982579    0.12075203     0              5830.6834      1.1971759e-13  0              3.055245     
   1100000   12727.922      200            200            0.0041614519   0.00046158604  0              0.01202277     0.014162703    0              683.86623      1.1971759e-13  0              3.0552374    
   1200000   12727.922      200            200            0.0041541595   0.00046153619  0              0.012000942    0.0015311406   0              73.933302      1.1971759e-13  0              3.0552416    
   1300000   12727.922      200            200            0.0041576359   0.00046158151  0              0.012011326    0.00015011384  0              7.2484602      1.1971759e-13  0              3.0552396    
   1400000   12727.922      200            200            0.0041561113   0.00046156667  0              0.012006767    1.2834563e-05  0              0.61973511     1.1971759e-13  0              3.0552405    
   1500000   12727.922      200            200            0.0041567448   0.00046157281  0              0.012008662    8.8201571e-07  0              0.042589382    1.1971759e-13  0              3.0552401    
   1600000   12727.922      200            200            0.0041564926   0.00046157035  0              0.012007907    3.856019e-08   0              0.0018619336   1.1971759e-13  0              3.0552402    
   1700000   12727.922      200            200            0.0041565895   0.0004615713   0              0.012008197    2.4133809e-10  0              1.1653353e-05  1.1971759e-13  0              3.0552402    
   1800000   12727.922      200            200            0.0041565534   0.00046157094  0              0.012008089    2.2995487e-10  0              1.1103698e-05  1.1971759e-13  0              3.0552402    
   1900000   12727.922      200            200            0.0041565664   0.00046157107  0              0.012008128    1.696642e-10   0              8.1924769e-06  1.1971759e-13  0              3.0552402    
   2000000   12727.922      200            200            0.0041565619   0.00046157103  0              0.012008115    5.4174646e-11  0              2.6158998e-06  1.1971759e-13  0              3.0552402    
   2100000   12727.922      200            200            0.0041565634   0.00046157104  0              0.012008119    1.2677267e-11  0              6.1213984e-07  1.1971759e-13  0              3.0552402    
   2200000   12727.922      200            200            0.0041565629   0.00046157104  0              0.012008118    2.496865e-12   0              1.2056467e-07  1.1971759e-13  0              3.0552402    
   2300000   12727.922      200            200            0.0041565631   0.00046157104  0              0.012008118    4.3735802e-13  0              2.1118454e-08  1.1971759e-13  0              3.0552402    
   2400000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    6.9953983e-14  0              3.3778275e-09  1.1971759e-13  0              3.0552402    
   2500000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    1.0415091e-14  0              5.0290746e-10  1.1971759e-13  0              3.0552402    
   2600000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    1.4578008e-15  0              7.0391984e-11  1.1971759e-13  0              3.0552402    
   2700000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    1.6228089e-16  0              7.8359633e-12  1.1971759e-13  0              3.0552402    
   2800000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    1.7542129e-18  0              8.4704661e-14  1.1971759e-13  0              3.0552402    
   2900000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    2.597424e-18   0              1.2542031e-13  1.1971759e-13  0              3.0552402    
   3000000   12727.922      200            200            0.004156563    0.00046157104  0              0.012008118    3.7525135e-18  0              1.8119545e-13  1.1971759e-13  0              3.0552402    
Loop time of 549.94 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4713245.273 ns/day, 0.000 hours/ns, 5455.145 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.507     | 77.692     | 132.55     | 619.6 | 14.13
Neigh   | 6.2535     | 6.3167     | 6.3825     |   1.9 |  1.15
Comm    | 21.419     | 27.622     | 33.569     |  86.9 |  5.02
Output  | 0.40177    | 0.4024     | 0.40305    |   0.1 |  0.07
Modify  | 321.88     | 332.88     | 343.67     |  56.8 | 60.53
Other   |            | 105        |            |       | 19.10

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         696.25 ave        1393 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2785
Ave neighs/atom = 0.55688862
Neighbor list builds = 167
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.13                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.3227344003217
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.23
  ghost atom cutoff = 3.23
  binsize = 1.615, bins = 7882 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 138.3 | 138.3 | 138.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003310485    1.2693271e-35  0              0.0099314551   1227032.4      0              5.9249005e+10  1.1971759e-13  0              3.3293706    
    200000   12727.922      200            200            0.0013014243   1.0154657e-34  0              0.003904273    348697.15      0              1.6837338e+10  1.1971759e-13  0              3.0970524    
    300000   12727.922      200            200            0.0002116942  -7.6159416e-35  0              0.00063508259  17390.154      0              8.397083e+08   1.1971759e-13  0              3.1023255    
    400000   12727.922      200            200            0.018677755   -0.0024699642   0              0.058503228    0.44077353     0              21283.376      1.1971759e-13  0              3.0545028    
    500000   12727.922      200            200            0.0090024637  -0.00042169737  0              0.027429089    109.86534      0              5305004.2      1.1971759e-13  0              3.0578135    
    600000   12727.922      200            200            0.0038891971   0.00052229899  0              0.011145292    394.51224      0              19049584       1.1971759e-13  0              3.0604043    
    700000   12727.922      200            200            0.004204192    0.00047561842  0              0.012136958    54.04659       0              2609716.4      1.1971759e-13  0              3.0602288    
    800000   12727.922      200            200            0.0041008191   0.00045575482  0              0.011846702    6.740361       0              325467.91      1.1971759e-13  0              3.0602777    
    900000   12727.922      200            200            0.0041966343   0.00045013861  0              0.012139764    0.77421951     0              37384.289      1.1971759e-13  0              3.0602227    
   1000000   12727.922      200            200            0.0041416561   0.00045466381  0              0.011970304    0.077384605    0              3736.6256      1.1971759e-13  0              3.0602551    
   1100000   12727.922      200            200            0.0041694133   0.0004543427   0              0.012053897    0.0064990358   0              313.81518      1.1971759e-13  0              3.0602389    
   1200000   12727.922      200            200            0.0041570738   0.00045437536  0              0.012016846    0.00040554919  0              19.582519      1.1971759e-13  0              3.0602462    
   1300000   12727.922      200            200            0.0041621703   0.00045441783  0              0.012032093    1.2688296e-05  0              0.61267242     1.1971759e-13  0              3.0602432    
   1400000   12727.922      200            200            0.0041601927   0.00045440088  0              0.012026177    2.5939484e-08  0              0.0012525248   1.1971759e-13  0              3.0602443    
   1500000   12727.922      200            200            0.0041609205   0.00045440708  0              0.012028355    3.5210568e-07  0              0.017001923    1.1971759e-13  0              3.0602439    
   1600000   12727.922      200            200            0.0041606662   0.0004544049   0              0.012027594    1.6175205e-07  0              0.0078104274   1.1971759e-13  0              3.0602441    
   1700000   12727.922      200            200            0.0041607501   0.00045440562  0              0.012027845    4.3083775e-08  0              0.0020803613   1.1971759e-13  0              3.060244     
   1800000   12727.922      200            200            0.0041607243   0.0004544054   0              0.012027768    8.8808963e-09  0              0.0004288267   1.1971759e-13  0              3.060244     
   1900000   12727.922      200            200            0.0041607315   0.00045440546  0              0.012027789    1.5549335e-09  0              7.5082175e-05  1.1971759e-13  0              3.060244     
   2000000   12727.922      200            200            0.0041607298   0.00045440545  0              0.012027784    2.4050436e-10  0              1.1613095e-05  1.1971759e-13  0              3.060244     
   2100000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    3.34173e-11    0              1.6136018e-06  1.1971759e-13  0              3.060244     
   2200000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    4.1869817e-12  0              2.0217436e-07  1.1971759e-13  0              3.060244     
   2300000   12727.922      200            200            0.00416073     0.00045440545  0              0.012027785    4.6919269e-13  0              2.2655636e-08  1.1971759e-13  0              3.060244     
   2400000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    4.5705434e-14  0              2.2069518e-09  1.1971759e-13  0              3.060244     
   2500000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    3.6293393e-15  0              1.752478e-10   1.1971759e-13  0              3.060244     
   2600000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    2.2614404e-16  0              1.0919687e-11  1.1971759e-13  0              3.060244     
   2700000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    1.8192312e-19  0              8.7844166e-15  1.1971759e-13  0              3.060244     
   2800000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    1.5692005e-17  0              7.5771075e-13  1.1971759e-13  0              3.060244     
   2900000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    9.4325936e-18  0              4.5546619e-13  1.1971759e-13  0              3.060244     
   3000000   12727.922      200            200            0.0041607301   0.00045440545  0              0.012027785    3.7642224e-18  0              1.8176083e-13  1.1971759e-13  0              3.060244     
Loop time of 542.411 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4778668.294 ns/day, 0.000 hours/ns, 5530.866 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.537     | 75.236     | 128.3      | 602.9 | 13.87
Neigh   | 6.108      | 6.162      | 6.2186     |   1.6 |  1.14
Comm    | 21.288     | 27.104     | 31.717     |  79.7 |  5.00
Output  | 0.41848    | 0.41913    | 0.4198     |   0.1 |  0.08
Modify  | 315.27     | 328.87     | 342.27     |  69.6 | 60.63
Other   |            | 104.6      |            |       | 19.29

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         652.75 ave        1306 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2611
Ave neighs/atom = 0.52209558
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.14                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 35.6623737623371
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.24
  ghost atom cutoff = 3.24
  binsize = 1.62, bins = 7857 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 137.9 | 138 | 138 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033198532   2.4346978e-44  0              0.0099595597   1231686.5      0              5.9473731e+10  1.1971759e-13  0              3.3294598    
    200000   12727.922      200            200            0.0013155224  -1.2693249e-35  0              0.0039465673   354140.36      0              1.7100171e+10  1.1971759e-13  0              3.0985127    
    300000   12727.922      200            200            0.00022367202  1.269328e-35   0              0.00067101605  19162.402      0              9.2528382e+08  1.1971759e-13  0              3.1063919    
    400000   12727.922      200            200            0.01829227    -0.0024574222   0              0.057334232    807.74599      0              39003163       1.1971759e-13  0              3.0596143    
    500000   12727.922      200            200            0.0086359919  -0.00046916214  0              0.026377138    457.4245       0              22087392       1.1971759e-13  0              3.0629578    
    600000   12727.922      200            200            0.0035881685   0.00060465053  0              0.010159855    346.51679      0              16732056       1.1971759e-13  0              3.0656183    
    700000   12727.922      200            200            0.0043884254   0.00052353162  0              0.012641745    48.659363      0              2349586.5      1.1971759e-13  0              3.065138     
    800000   12727.922      200            200            0.0040353572   0.00042721854  0              0.011678853    5.0460445      0              243655.43      1.1971759e-13  0              3.065319     
    900000   12727.922      200            200            0.0042249215   0.00044557785  0              0.012229187    0.44140171     0              21313.709      1.1971759e-13  0              3.0652128    
   1000000   12727.922      200            200            0.0041388447   0.00044896725  0              0.011967567    0.026635545    0              1286.1351      1.1971759e-13  0              3.0652634    
   1100000   12727.922      200            200            0.0041760222   0.00044846114  0              0.012079606    0.00066669568  0              32.192348      1.1971759e-13  0              3.0652415    
   1200000   12727.922      200            200            0.0041613484   0.00044853582  0              0.012035509    1.4169813e-05  0              0.68420956     1.1971759e-13  0              3.0652502    
   1300000   12727.922      200            200            0.0041667137   0.0004485786   0              0.012051563    3.7505116e-05  0              1.8109878      1.1971759e-13  0              3.065247     
   1400000   12727.922      200            200            0.0041649063   0.00044856382  0              0.012046155    1.4554632e-05  0              0.70279111     1.1971759e-13  0              3.0652481    
   1500000   12727.922      200            200            0.0041654608   0.00044856835  0              0.012047814    3.4945038e-06  0              0.16873708     1.1971759e-13  0              3.0652478    
   1600000   12727.922      200            200            0.0041653123   0.00044856712  0              0.01204737     6.5053753e-07  0              0.031412129    1.1971759e-13  0              3.0652478    
   1700000   12727.922      200            200            0.0041653426   0.00044856738  0              0.01204746     1.0113614e-07  0              0.0048835023   1.1971759e-13  0              3.0652478    
   1800000   12727.922      200            200            0.0041653411   0.00044856736  0              0.012047456    1.3469825e-08  0              0.00065040964  1.1971759e-13  0              3.0652478    
   1900000   12727.922      200            200            0.0041653381   0.00044856734  0              0.012047447    1.534872e-09   0              7.4113475e-05  1.1971759e-13  0              3.0652478    
   2000000   12727.922      200            200            0.0041653404   0.00044856736  0              0.012047454    1.4531754e-10  0              7.0168639e-06  1.1971759e-13  0              3.0652478    
   2100000   12727.922      200            200            0.0041653392   0.00044856735  0              0.01204745     1.0522897e-11  0              5.0811306e-07  1.1971759e-13  0              3.0652478    
   2200000   12727.922      200            200            0.0041653398   0.00044856735  0              0.012047452    4.4986306e-13  0              2.1722277e-08  1.1971759e-13  0              3.0652478    
   2300000   12727.922      200            200            0.0041653395   0.00044856735  0              0.012047451    1.3322952e-15  0              6.4331766e-11  1.1971759e-13  0              3.0652478    
   2400000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    4.2578488e-15  0              2.0559628e-10  1.1971759e-13  0              3.0652478    
   2500000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    2.5676758e-15  0              1.2398388e-10  1.1971759e-13  0              3.0652478    
   2600000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    7.2828842e-16  0              3.5166442e-11  1.1971759e-13  0              3.0652478    
   2700000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    1.7398977e-16  0              8.4013431e-12  1.1971759e-13  0              3.0652478    
   2800000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    1.257181e-17   0              6.0704769e-13  1.1971759e-13  0              3.0652478    
   2900000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    5.2109597e-18  0              2.5161859e-13  1.1971759e-13  0              3.0652478    
   3000000   12727.922      200            200            0.0041653396   0.00044856735  0              0.012047451    6.8832146e-19  0              3.323658e-14   1.1971759e-13  0              3.0652478    
Loop time of 544.437 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4760880.675 ns/day, 0.000 hours/ns, 5510.279 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.496     | 76.017     | 130.71     | 605.7 | 13.96
Neigh   | 5.8521     | 5.9094     | 5.9705     |   1.8 |  1.09
Comm    | 20.914     | 27.104     | 31.239     |  79.9 |  4.98
Output  | 0.41851    | 0.41915    | 0.41979    |   0.1 |  0.08
Modify  | 316.85     | 330.06     | 343.01     |  67.9 | 60.62
Other   |            | 104.9      |            |       | 19.27

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         658.75 ave        1318 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2635
Ave neighs/atom = 0.52689462
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.15                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.0041833365577
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.25
  ghost atom cutoff = 3.25
  binsize = 1.625, bins = 7833 124 124
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 137.6 | 137.6 | 137.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003329223   -7.9332816e-37  0              0.0099876689   1236347.2      0              5.969878e+10   1.1971759e-13  0              3.3295375    
    200000   12727.922      200            200            0.0013296614   1.126595e-41   0              0.0039889843   359620.99      0              1.736481e+10   1.1971759e-13  0              3.0999419    
    300000   12727.922      200            200            0.00023577039  5.0773158e-35  0              0.00070731116  21018.463      0              1.0149064e+09  1.1971759e-13  0              3.1104119    
    400000   12727.922      200            200            0.017014418   -0.0027982125   0              0.053841465    3136.7889      0              1.5146431e+08  1.1971759e-13  0              3.0649419    
    500000   12727.922      200            200            0.0080547434  -0.00050758096  0              0.024671811    977.26425      0              47188593       1.1971759e-13  0              3.068194     
    600000   12727.922      200            200            0.0032444501   0.00043080895  0              0.0093025412   272.78286      0              13171708       1.1971759e-13  0              3.0708141    
    700000   12727.922      200            200            0.0045468355   0.00052843311  0              0.013112073    37.054601      0              1789234.1      1.1971759e-13  0              3.0700556    
    800000   12727.922      200            200            0.0039803457   0.00039329609  0              0.011547741    2.8209211      0              136212.19      1.1971759e-13  0              3.0703533    
    900000   12727.922      200            200            0.0042454346   0.00044110824  0              0.012295195    0.13200924     0              6374.2538      1.1971759e-13  0              3.0702074    
   1000000   12727.922      200            200            0.0041404883   0.00044346821  0              0.011977997    0.00047975311  0              23.165561      1.1971759e-13  0              3.0702691    
   1100000   12727.922      200            200            0.0041805198   0.0004428566   0              0.012098703    0.0011529129   0              55.670038      1.1971759e-13  0              3.0702454    
   1200000   12727.922      200            200            0.0041666907   0.00044292631  0              0.012057146    0.0007062268   0              34.101165      1.1971759e-13  0              3.0702536    
   1300000   12727.922      200            200            0.0041709241   0.00044295915  0              0.012069813    0.00019395638  0              9.3654596      1.1971759e-13  0              3.0702511    
   1400000   12727.922      200            200            0.0041698445   0.00044295058  0              0.012066583    3.7394017e-05  0              1.8056233      1.1971759e-13  0              3.0702517    
   1500000   12727.922      200            200            0.0041700267   0.00044295206  0              0.012067128    5.6750981e-06  0              0.27403018     1.1971759e-13  0              3.0702516    
   1600000   12727.922      200            200            0.004170045    0.00044295218  0              0.012067183    6.9788744e-07  0              0.033698487    1.1971759e-13  0              3.0702516    
   1700000   12727.922      200            200            0.0041700078   0.0004429519   0              0.012067072    6.8128311e-08  0              0.0032896723   1.1971759e-13  0              3.0702516    
   1800000   12727.922      200            200            0.0041700312   0.00044295208  0              0.012067142    4.8053691e-09  0              0.00023203408  1.1971759e-13  0              3.0702516    
   1900000   12727.922      200            200            0.0041700199   0.00044295199  0              0.012067108    1.7303151e-10  0              8.3550724e-06  1.1971759e-13  0              3.0702516    
   2000000   12727.922      200            200            0.0041700246   0.00044295203  0              0.012067122    2.6181964e-14  0              1.2642333e-09  1.1971759e-13  0              3.0702516    
   2100000   12727.922      200            200            0.0041700229   0.00044295201  0              0.012067117    3.5294353e-12  0              1.704238e-07   1.1971759e-13  0              3.0702516    
   2200000   12727.922      200            200            0.0041700235   0.00044295202  0              0.012067118    1.6534732e-12  0              7.9840304e-08  1.1971759e-13  0              3.0702516    
   2300000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    4.1284533e-13  0              1.9934823e-08  1.1971759e-13  0              3.0702516    
   2400000   12727.922      200            200            0.0041700234   0.00044295202  0              0.012067118    7.4651425e-14  0              3.6046501e-09  1.1971759e-13  0              3.0702516    
   2500000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    1.0820209e-14  0              5.2246919e-10  1.1971759e-13  0              3.0702516    
   2600000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    1.2495414e-15  0              6.0335883e-11  1.1971759e-13  0              3.0702516    
   2700000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    6.1903667e-17  0              2.9891065e-12  1.1971759e-13  0              3.0702516    
   2800000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    1.7889299e-18  0              8.6381025e-14  1.1971759e-13  0              3.0702516    
   2900000   12727.922      200            200            0.0041700233   0.00044295202  0              0.012067118    2.9521768e-18  0              1.4255005e-13  1.1971759e-13  0              3.0702516    
   3000000   12727.922      200            200            0.0041700233   0.00044295201  0              0.012067118    5.5550139e-18  0              2.6823174e-13  1.1971759e-13  0              3.0702516    
Loop time of 543.264 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4771158.374 ns/day, 0.000 hours/ns, 5522.174 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.498     | 75.322     | 128.71     | 601.8 | 13.86
Neigh   | 5.8018     | 5.8593     | 5.9206     |   1.8 |  1.08
Comm    | 20.359     | 27.295     | 32.33      |  98.6 |  5.02
Output  | 0.39834    | 0.399      | 0.39966    |   0.1 |  0.07
Modify  | 316.99     | 329.93     | 342.12     |  65.3 | 60.73
Other   |            | 104.5      |            |       | 19.23

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         664.25 ave        1329 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2657
Ave neighs/atom = 0.53129374
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.16                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.3481700344871
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.26
  ghost atom cutoff = 3.26
  binsize = 1.63, bins = 7809 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 135.3 | 135.3 | 135.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033385942   6.3466284e-36  0              0.010015782    1241014.6      0              5.9924151e+10  1.1971759e-13  0              3.3296036    
    200000   12727.922      200            200            0.001343841   -3.8079728e-35  0              0.004031523    365138.91      0              1.7631251e+10  1.1971759e-13  0              3.10134      
    300000   12727.922      200            200            0.00024798848 -5.5850255e-34  0              0.00074396543  22958.048      0              1.108562e+09   1.1971759e-13  0              3.1143855    
    400000   12727.922      200            200            0.015095642   -0.0031092868   0              0.048396214    6517.0375      0              3.1468442e+08  1.1971759e-13  0              3.0704694    
    500000   12727.922      200            200            0.0075046207   5.9738023e-05  0              0.022454124    1574.13        0              76009104       1.1971759e-13  0              3.0735109    
    600000   12727.922      200            200            0.0029893376   0.00036843514  0              0.0085995776   187.58159      0              9057643.7      1.1971759e-13  0              3.075983     
    700000   12727.922      200            200            0.0046792307   0.00052592606  0              0.013511766    22.515641      0              1087199.7      1.1971759e-13  0              3.0749878    
    800000   12727.922      200            200            0.0039491346   0.0003801833   0              0.01146722     0.90738143     0              43814.202      1.1971759e-13  0              3.0753775    
    900000   12727.922      200            200            0.0042555971   0.00043514946  0              0.012331642    0.00025757698  0              12.437471      1.1971759e-13  0              3.0752077    
   1000000   12727.922      200            200            0.0041462475   0.00043570879  0              0.012003034    0.014974094    0              723.04541      1.1971759e-13  0              3.0752719    
   1100000   12727.922      200            200            0.0041821127   0.00043497706  0              0.012111361    0.0074815241   0              361.25602      1.1971759e-13  0              3.0752505    
   1200000   12727.922      200            200            0.0041720964   0.00043505117  0              0.012081238    0.0018236224   0              88.056197      1.1971759e-13  0              3.0752565    
   1300000   12727.922      200            200            0.0041741139   0.00043506546  0              0.012087276    0.00030960266  0              14.949605      1.1971759e-13  0              3.0752553    
   1400000   12727.922      200            200            0.0041740859   0.00043506509  0              0.012087193    3.9661979e-05  0              1.915135       1.1971759e-13  0              3.0752553    
   1500000   12727.922      200            200            0.0041738342   0.00043506342  0              0.012086439    3.7787038e-06  0              0.18246008     1.1971759e-13  0              3.0752555    
   1600000   12727.922      200            200            0.0041740101   0.00043506461  0              0.012086966    2.3389968e-07  0              0.011294178    1.1971759e-13  0              3.0752554    
   1700000   12727.922      200            200            0.0041739236   0.00043506402  0              0.012086707    4.8563945e-09  0              0.00023449791  1.1971759e-13  0              3.0752554    
   1800000   12727.922      200            200            0.0041739592   0.00043506426  0              0.012086813    2.9898872e-10  0              1.4437095e-05  1.1971759e-13  0              3.0752554    
   1900000   12727.922      200            200            0.0041739465   0.00043506418  0              0.012086775    4.4876375e-10  0              2.1669195e-05  1.1971759e-13  0              3.0752554    
   2000000   12727.922      200            200            0.0041739504   0.0004350642   0              0.012086787    1.4796841e-10  0              7.1448648e-06  1.1971759e-13  0              3.0752554    
   2100000   12727.922      200            200            0.0041739494   0.0004350642   0              0.012086784    2.9965768e-11  0              1.4469397e-06  1.1971759e-13  0              3.0752554    
   2200000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    4.4525988e-12  0              2.1500006e-07  1.1971759e-13  0              3.0752554    
   2300000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    5.005893e-13   0              2.4171666e-08  1.1971759e-13  0              3.0752554    
   2400000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086784    4.0382806e-14  0              1.9499412e-09  1.1971759e-13  0              3.0752554    
   2500000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    1.7389076e-15  0              8.3965623e-11  1.1971759e-13  0              3.0752554    
   2600000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    5.5666091e-18  0              2.6879163e-13  1.1971759e-13  0              3.0752554    
   2700000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    4.8133535e-17  0              2.3241961e-12  1.1971759e-13  0              3.0752554    
   2800000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    2.5896009e-17  0              1.2504256e-12  1.1971759e-13  0              3.0752554    
   2900000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    1.5307189e-17  0              7.3912938e-13  1.1971759e-13  0              3.0752554    
   3000000   12727.922      200            200            0.0041739496   0.0004350642   0              0.012086785    9.3358011e-20  0              4.5079243e-15  1.1971759e-13  0              3.0752554    
Loop time of 545.774 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4749214.260 ns/day, 0.000 hours/ns, 5496.776 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.716     | 75.893     | 130.49     | 607.2 | 13.91
Neigh   | 5.6901     | 5.7465     | 5.8061     |   1.8 |  1.05
Comm    | 20.376     | 27.189     | 33.009     | 103.2 |  4.98
Output  | 0.4288     | 0.42944    | 0.4301     |   0.1 |  0.08
Modify  | 319.94     | 331.84     | 343.05     |  60.4 | 60.80
Other   |            | 104.7      |            |       | 19.18

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         669.75 ave        1340 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2679
Ave neighs/atom = 0.53569286
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.17                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 36.6943407676294
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.27
  ghost atom cutoff = 3.27
  binsize = 1.635, bins = 7785 123 123
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 134.9 | 134.9 | 134.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033479668   6.3466307e-36  0              0.0100439      1245688.6      0              6.0149845e+10  1.1971759e-13  0              3.3296581    
    200000   12727.922      200            200            0.0013580608   6.346629e-36   0              0.0040741824   370694.04      0              1.7899488e+10  1.1971759e-13  0              3.1027071    
    300000   12727.922      200            200            0.0002603254   1.0154612e-34  0              0.00078097621  24980.857      0              1.2062362e+09  1.1971759e-13  0              3.1183125    
    400000   12727.922      200            200            0.013137025   -0.0021484501   0              0.041559527    10306.01       0              4.9764034e+08  1.1971759e-13  0              3.0761713    
    500000   12727.922      200            200            0.0068099499   0.00053399492  0              0.019895855    2145.4371      0              1.0359548e+08  1.1971759e-13  0              3.0788947    
    600000   12727.922      200            200            0.0028332586   0.00043319875  0              0.0080665771   106.15921      0              5126048.2      1.1971759e-13  0              3.0811181    
    700000   12727.922      200            200            0.004762574    0.00048010901  0              0.013807613    9.2750117      0              447857.12      1.1971759e-13  0              3.0799401    
    800000   12727.922      200            200            0.0039379274   0.00036750099  0              0.011446281    0.018570068    0              896.68214      1.1971759e-13  0              3.0803898    
    900000   12727.922      200            200            0.0042532351   0.00042340018  0              0.012336305    0.11039552     0              5330.6046      1.1971759e-13  0              3.0802142    
   1000000   12727.922      200            200            0.0041553693   0.00042436277  0              0.012041745    0.060559188    0              2924.1865      1.1971759e-13  0              3.080272     
   1100000   12727.922      200            200            0.0041808314   0.00042344176  0              0.012119052    0.014708004    0              710.19686      1.1971759e-13  0              3.0802566    
   1200000   12727.922      200            200            0.0041767368   0.00042352991  0              0.012106681    0.0023336263   0              112.68246      1.1971759e-13  0              3.0802592    
   1300000   12727.922      200            200            0.0041760427   0.00042352646  0              0.012104602    0.00026022089  0              12.565135      1.1971759e-13  0              3.0802595    
   1400000   12727.922      200            200            0.0041770642   0.00042353191  0              0.012107661    1.8812449e-05  0              0.90838582     1.1971759e-13  0              3.0802589    
   1500000   12727.922      200            200            0.0041764721   0.00042352871  0              0.012105888    5.534745e-07   0              0.026725303    1.1971759e-13  0              3.0802593    
   1600000   12727.922      200            200            0.0041767322   0.00042353012  0              0.012106667    6.9316429e-09  0              0.00033470423  1.1971759e-13  0              3.0802591    
   1700000   12727.922      200            200            0.0041766372   0.00042352961  0              0.012106382    2.4266271e-08  0              0.0011717314   1.1971759e-13  0              3.0802592    
   1800000   12727.922      200            200            0.004176666    0.00042352976  0              0.012106468    8.713952e-09   0              0.00042076556  1.1971759e-13  0              3.0802592    
   1900000   12727.922      200            200            0.0041766595   0.00042352973  0              0.012106449    1.7404276e-09  0              8.4039019e-05  1.1971759e-13  0              3.0802592    
   2000000   12727.922      200            200            0.00417666     0.00042352973  0              0.01210645     2.3892971e-10  0              1.153706e-05   1.1971759e-13  0              3.0802592    
   2100000   12727.922      200            200            0.0041766605   0.00042352973  0              0.012106452    2.2737678e-11  0              1.0979211e-06  1.1971759e-13  0              3.0802592    
   2200000   12727.922      200            200            0.0041766601   0.00042352973  0              0.012106451    1.2628986e-12  0              6.0980851e-08  1.1971759e-13  0              3.0802592    
   2300000   12727.922      200            200            0.0041766603   0.00042352973  0              0.012106451    1.3127684e-14  0              6.3388887e-10  1.1971759e-13  0              3.0802592    
   2400000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    5.6443582e-15  0              2.7254586e-10  1.1971759e-13  0              3.0802592    
   2500000   12727.922      200            200            0.0041766603   0.00042352973  0              0.012106451    4.3521038e-15  0              2.1014752e-10  1.1971759e-13  0              3.0802592    
   2600000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    1.1581181e-15  0              5.5921379e-11  1.1971759e-13  0              3.0802592    
   2700000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    1.8771955e-16  0              9.0643051e-12  1.1971759e-13  0              3.0802592    
   2800000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    1.7078094e-18  0              8.2464002e-14  1.1971759e-13  0              3.0802592    
   2900000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    3.2440602e-18  0              1.5664406e-13  1.1971759e-13  0              3.0802592    
   3000000   12727.922      200            200            0.0041766602   0.00042352973  0              0.012106451    1.5388137e-18  0              7.4303806e-14  1.1971759e-13  0              3.0802592    
Loop time of 549.12 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4720282.978 ns/day, 0.000 hours/ns, 5463.290 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.674     | 76.226     | 131.83     | 609.9 | 13.88
Neigh   | 5.9722     | 6.0371     | 6.1059     |   2.0 |  1.10
Comm    | 20.464     | 26.84      | 31.867     |  86.8 |  4.89
Output  | 0.43566    | 0.43629    | 0.43694    |   0.1 |  0.08
Modify  | 319.63     | 332.84     | 347.98     |  68.2 | 60.61
Other   |            | 106.7      |            |       | 19.44

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         674.25 ave        1349 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2697
Ave neighs/atom = 0.53929214
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.18                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.0427024474883
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.28
  ghost atom cutoff = 3.28
  binsize = 1.64, bins = 7761 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 132.6 | 132.6 | 132.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033573407   2.8905764e-42  0              0.010072022    1250369.3      0              6.0375861e+10  1.1971759e-13  0              3.329701     
    200000   12727.922      200            200            0.0013723204   2.5386615e-35  0              0.0041169613   376286.25      0              1.8169516e+10  1.1971759e-13  0              3.1040429    
    300000   12727.922      200            200            0.00027278032  1.269326e-35   0              0.00081834097  27086.6        0              1.307915e+09   1.1971759e-13  0              3.1221929    
    400000   12727.922      200            200            0.011047212   -0.00084922722  0              0.033990862    13854.733      0              6.6899548e+08  1.1971759e-13  0              3.0820153    
    500000   12727.922      200            200            0.0060108869   0.00085531548  0              0.017177345    2602.1788      0              1.256499e+08   1.1971759e-13  0              3.0843287    
    600000   12727.922      200            200            0.0027027937   0.00039684277  0              0.0077115384   42.200689      0              2037720.2      1.1971759e-13  0              3.086214     
    700000   12727.922      200            200            0.0048052376   0.00044074946  0              0.013974963    1.2457663      0              60153.598      1.1971759e-13  0              3.0849162    
    800000   12727.922      200            200            0.003948527    0.00035705907  0              0.011488522    0.47725325     0              23044.852      1.1971759e-13  0              3.0853894    
    900000   12727.922      200            200            0.004240971    0.00041171441  0              0.012311199    0.40517036     0              19564.227      1.1971759e-13  0              3.0852265    
   1000000   12727.922      200            200            0.004167876    0.00041262634  0              0.012091002    0.10846052     0              5237.1703      1.1971759e-13  0              3.08527      
   1100000   12727.922      200            200            0.0041786592   0.00041175154  0              0.012124226    0.017297332    0              835.22627      1.1971759e-13  0              3.0852632    
   1200000   12727.922      200            200            0.0041812973   0.00041183232  0              0.01213206     0.0017776932   0              85.838441      1.1971759e-13  0              3.0852618    
   1300000   12727.922      200            200            0.0041780953   0.00041182065  0              0.012122465    0.00010061676  0              4.8584231      1.1971759e-13  0              3.0852636    
   1400000   12727.922      200            200            0.0041798485   0.00041182708  0              0.012127718    8.6063766e-07  0              0.041557113    1.1971759e-13  0              3.0852626    
   1500000   12727.922      200            200            0.0041791269   0.00041182442  0              0.012125556    5.4428096e-07  0              0.02628138     1.1971759e-13  0              3.085263     
   1600000   12727.922      200            200            0.0041793654   0.0004118253   0              0.012126271    3.7113075e-07  0              0.017920575    1.1971759e-13  0              3.0852629    
   1700000   12727.922      200            200            0.0041793056   0.00041182508  0              0.012126092    9.06616e-08    0              0.0043777242   1.1971759e-13  0              3.0852629    
   1800000   12727.922      200            200            0.0041793129   0.00041182511  0              0.012126114    1.3450615e-08  0              0.00064948208  1.1971759e-13  0              3.0852629    
   1900000   12727.922      200            200            0.0041793162   0.00041182512  0              0.012126123    1.2779906e-09  0              6.1709594e-05  1.1971759e-13  0              3.0852629    
   2000000   12727.922      200            200            0.004179313    0.00041182511  0              0.012126114    6.2534702e-11  0              3.0195769e-06  1.1971759e-13  0              3.0852629    
   2100000   12727.922      200            200            0.0041793147   0.00041182511  0              0.012126119    1.5464576e-13  0              7.4672902e-09  1.1971759e-13  0              3.0852629    
   2200000   12727.922      200            200            0.004179314    0.00041182511  0              0.012126117    6.4600993e-13  0              3.1193508e-08  1.1971759e-13  0              3.0852629    
   2300000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126118    3.3651391e-13  0              1.6249053e-08  1.1971759e-13  0              3.0852629    
   2400000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    7.4855051e-14  0              3.6144825e-09  1.1971759e-13  0              3.0852629    
   2500000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    1.0352905e-14  0              4.9990475e-10  1.1971759e-13  0              3.0852629    
   2600000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    8.5356255e-16  0              4.1215481e-11  1.1971759e-13  0              3.0852629    
   2700000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    4.3305254e-18  0              2.0910557e-13  1.1971759e-13  0              3.0852629    
   2800000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    1.5174203e-17  0              7.3270797e-13  1.1971759e-13  0              3.0852629    
   2900000   12727.922      200            200            0.0041793142   0.00041182511  0              0.012126117    1.563326e-18   0              7.5487419e-14  1.1971759e-13  0              3.0852629    
   3000000   12727.922      200            200            0.0041793142   0.00041182512  0              0.012126117    1.0361755e-17  0              5.0033208e-13  1.1971759e-13  0              3.0852629    
Loop time of 543.684 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4767476.020 ns/day, 0.000 hours/ns, 5517.912 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.471     | 75.808     | 130.44     | 608.8 | 13.94
Neigh   | 5.5889     | 5.645      | 5.7045     |   1.8 |  1.04
Comm    | 19.854     | 25.964     | 30.048     |  83.3 |  4.78
Output  | 0.44811    | 0.44875    | 0.44941    |   0.1 |  0.08
Modify  | 316.68     | 329.93     | 344.38     |  68.9 | 60.68
Other   |            | 105.9      |            |       | 19.48

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         679.25 ave        1359 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2717
Ave neighs/atom = 0.54329134
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.19                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.3932619855676
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.29
  ghost atom cutoff = 3.29
  binsize = 1.645, bins = 7738 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 132.2 | 132.2 | 132.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033667161   1.2693258e-34  0              0.010100148    1255056.7      0              6.0602198e+10  1.1971759e-13  0              3.3297322    
    200000   12727.922      200            200            0.0013866196   1.0154651e-34  0              0.0041598587   381915.45      0              1.844133e+10   1.1971759e-13  0              3.1053475    
    300000   12727.922      200            200            0.00028535246  2.5386527e-34  0              0.00085605737  29274.998      0              1.4135849e+09  1.1971759e-13  0              3.1260265    
    400000   12727.922      200            200            0.0086983544  -0.00024318632  0              0.026338249    16650.905      0              8.0401259e+08  1.1971759e-13  0              3.0879655    
    500000   12727.922      200            200            0.0050805617   0.00077681193  0              0.014464873    2883.7993      0              1.3924835e+08  1.1971759e-13  0              3.0897958    
    600000   12727.922      200            200            0.0026426574   0.00038982775  0              0.0075381443   5.9395442      0              286799.33      1.1971759e-13  0              3.0912669    
    700000   12727.922      200            200            0.0048088156   0.00042648344  0              0.013999963    0.80106137     0              38680.387      1.1971759e-13  0              3.0899182    
    800000   12727.922      200            200            0.0039799924   0.00034800716  0              0.01159197     2.1015659      0              101477.09      1.1971759e-13  0              3.0903768    
    900000   12727.922      200            200            0.0042214213   0.00040199983  0              0.012262264    0.7358338      0              35530.781      1.1971759e-13  0              3.0902433    
   1000000   12727.922      200            200            0.0041828114   0.0004024436   0              0.012145991    0.12882547     0              6220.5207      1.1971759e-13  0              3.0902669    
   1100000   12727.922      200            200            0.0041772352   0.00040190644  0              0.012129799    0.013329267    0              643.62261      1.1971759e-13  0              3.0902697    
   1200000   12727.922      200            200            0.0041859843   0.00040195601  0              0.012155997    0.00067034147  0              32.36839       1.1971759e-13  0              3.0902647    
   1300000   12727.922      200            200            0.0041811068   0.00040194258  0              0.012141378    1.2090932e-06  0              0.058382781    1.1971759e-13  0              3.0902675    
   1400000   12727.922      200            200            0.0041830624   0.00040194801  0              0.012147239    7.6787873e-06  0              0.37078116     1.1971759e-13  0              3.0902664    
   1500000   12727.922      200            200            0.0041824627   0.00040194634  0              0.012145442    3.707111e-06   0              0.17900312     1.1971759e-13  0              3.0902667    
   1600000   12727.922      200            200            0.0041825848   0.00040194669  0              0.012145808    7.4493028e-07  0              0.035970017    1.1971759e-13  0              3.0902666    
   1700000   12727.922      200            200            0.004182587    0.00040194669  0              0.012145814    8.7109243e-08  0              0.0042061936   1.1971759e-13  0              3.0902666    
   1800000   12727.922      200            200            0.0041825692   0.00040194664  0              0.012145761    5.3933112e-09  0              0.0002604237   1.1971759e-13  0              3.0902667    
   1900000   12727.922      200            200            0.0041825803   0.00040194667  0              0.012145794    5.5937247e-11  0              2.7010095e-06  1.1971759e-13  0              3.0902666    
   2000000   12727.922      200            200            0.0041825756   0.00040194666  0              0.01214578     2.5653258e-11  0              1.238704e-06   1.1971759e-13  0              3.0902667    
   2100000   12727.922      200            200            0.0041825771   0.00040194666  0              0.012145785    1.8092596e-11  0              8.7362669e-07  1.1971759e-13  0              3.0902666    
   2200000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    4.1956249e-12  0              2.0259171e-07  1.1971759e-13  0              3.0902666    
   2300000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    5.5193432e-13  0              2.6650933e-08  1.1971759e-13  0              3.0902666    
   2400000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    4.1236374e-14  0              1.9911569e-09  1.1971759e-13  0              3.0902666    
   2500000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    9.9590868e-16  0              4.8088866e-11  1.1971759e-13  0              3.0902666    
   2600000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    4.5689192e-17  0              2.2061675e-12  1.1971759e-13  0              3.0902666    
   2700000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    1.1557925e-16  0              5.5809082e-12  1.1971759e-13  0              3.0902666    
   2800000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    1.549505e-17   0              7.4820052e-13  1.1971759e-13  0              3.0902666    
   2900000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    4.231753e-18   0              2.0433621e-13  1.1971759e-13  0              3.0902666    
   3000000   12727.922      200            200            0.0041825768   0.00040194666  0              0.012145784    4.4364846e-18  0              2.1422196e-13  1.1971759e-13  0              3.0902666    
Loop time of 542.293 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4779703.333 ns/day, 0.000 hours/ns, 5532.064 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.207     | 75.62      | 129.62     | 609.1 | 13.94
Neigh   | 5.6301     | 5.6869     | 5.7459     |   1.8 |  1.05
Comm    | 20.13      | 26.136     | 30.442     |  80.5 |  4.82
Output  | 0.41157    | 0.41221    | 0.41286    |   0.1 |  0.08
Modify  | 316.17     | 329.44     | 342.94     |  68.7 | 60.75
Other   |            | 105        |            |       | 19.36

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         684.25 ave        1369 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2737
Ave neighs/atom = 0.54729054
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.2                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 37.7460262933712
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.3
  ghost atom cutoff = 3.3
  binsize = 1.65, bins = 7714 122 122
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 131.8 | 131.9 | 131.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033760926  -8.1236803e-34  0              0.010128278    1259750.8      0              6.0828856e+10  1.1971759e-13  0              3.3297517    
    200000   12727.922      200            200            0.0014009579   1.3180429e-40  0              0.0042028737   387581.56      0              1.8714926e+10  1.1971759e-13  0              3.1066207    
    300000   12727.922      200            200            0.00029804099  1.5231949e-34  0              0.00089412296  31545.765      0              1.5232321e+09  1.1971759e-13  0              3.1298134    
    400000   12727.922      200            200            0.0067558453   0.0011012606   0              0.019166275    18401.086      0              8.8852261e+08  1.1971759e-13  0              3.0939854    
    500000   12727.922      200            200            0.0041393253   0.00051802053  0              0.011899956    2964.5529      0              1.4314765e+08  1.1971759e-13  0              3.0952783    
    600000   12727.922      200            200            0.0026434624   0.00038316115  0              0.007547226    2.9245889      0              141217.93      1.1971759e-13  0              3.096275     
    700000   12727.922      200            200            0.0047663818   0.00041741308  0              0.013881732    8.0237587      0              387438.59      1.1971759e-13  0              3.0949462    
    800000   12727.922      200            200            0.0040300133   0.00034085569  0              0.011749184    4.2748846      0              206418.88      1.1971759e-13  0              3.0953536    
    900000   12727.922      200            200            0.0041976748   0.00039451853  0              0.012198506    0.93756342     0              45271.582      1.1971759e-13  0              3.0952632    
   1000000   12727.922      200            200            0.0041978326   0.00039250694  0              0.012200991    0.1091904      0              5272.4135      1.1971759e-13  0              3.0952638    
   1100000   12727.922      200            200            0.004177006    0.00039244974  0              0.012138568    0.0058588728   0              282.904        1.1971759e-13  0              3.0952755    
   1200000   12727.922      200            200            0.0041899853   0.00039247746  0              0.012177478    1.2275118e-05  0              0.59272154     1.1971759e-13  0              3.095268     
   1300000   12727.922      200            200            0.00418467     0.00039246632  0              0.012161544    6.550743e-05   0              3.1631193      1.1971759e-13  0              3.0952711    
   1400000   12727.922      200            200            0.0041862488   0.00039246969  0              0.012166277    3.0576411e-05  0              1.4764255      1.1971759e-13  0              3.0952702    
   1500000   12727.922      200            200            0.0041859757   0.00039246911  0              0.012165458    5.6130994e-06  0              0.27103648     1.1971759e-13  0              3.0952704    
   1600000   12727.922      200            200            0.0041859344   0.00039246902  0              0.012165334    5.4503548e-07  0              0.026317813    1.1971759e-13  0              3.0952704    
   1700000   12727.922      200            200            0.0041859969   0.00039246915  0              0.012165521    2.0529424e-08  0              0.00099129239  1.1971759e-13  0              3.0952704    
   1800000   12727.922      200            200            0.0041859634   0.00039246908  0              0.012165421    9.190944e-11   0              4.4379779e-06  1.1971759e-13  0              3.0952704    
   1900000   12727.922      200            200            0.0041859759   0.00039246911  0              0.012165459    6.3677129e-10  0              3.0747407e-05  1.1971759e-13  0              3.0952704    
   2000000   12727.922      200            200            0.0041859726   0.0003924691   0              0.012165449    2.0982943e-10  0              1.0131912e-05  1.1971759e-13  0              3.0952704    
   2100000   12727.922      200            200            0.004185973    0.0003924691   0              0.01216545     3.2090058e-11  0              1.5495141e-06  1.1971759e-13  0              3.0952704    
   2200000   12727.922      200            200            0.0041859732   0.0003924691   0              0.01216545     2.5465228e-12  0              1.2296247e-07  1.1971759e-13  0              3.0952704    
   2300000   12727.922      200            200            0.004185973    0.0003924691   0              0.01216545     5.6050623e-14  0              2.706484e-09   1.1971759e-13  0              3.0952704    
   2400000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     4.5938406e-15  0              2.2182012e-10  1.1971759e-13  0              3.0952704    
   2500000   12727.922      200            200            0.004185973    0.0003924691   0              0.01216545     5.431948e-15   0              2.6228933e-10  1.1971759e-13  0              3.0952704    
   2600000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     1.3662272e-15  0              6.597022e-11   1.1971759e-13  0              3.0952704    
   2700000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     1.3528071e-16  0              6.5322212e-12  1.1971759e-13  0              3.0952704    
   2800000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     1.039543e-18   0              5.019581e-14   1.1971759e-13  0              3.0952704    
   2900000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     9.6707499e-19  0              4.669659e-14   1.1971759e-13  0              3.0952704    
   3000000   12727.922      200            200            0.0041859731   0.0003924691   0              0.01216545     4.0067322e-18  0              1.9347076e-13  1.1971759e-13  0              3.0952704    
Loop time of 540.891 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4792097.030 ns/day, 0.000 hours/ns, 5546.409 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.555     | 76.338     | 131.47     | 611.1 | 14.11
Neigh   | 5.5983     | 5.6559     | 5.7157     |   1.8 |  1.05
Comm    | 20.115     | 25.935     | 29.975     |  80.5 |  4.79
Output  | 0.41919    | 0.41982    | 0.42046    |   0.1 |  0.08
Modify  | 316.02     | 328.28     | 340.09     |  63.9 | 60.69
Other   |            | 104.3      |            |       | 19.28

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         688.75 ave        1378 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2755
Ave neighs/atom = 0.55088982
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.21                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.1010022824028
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.31
  ghost atom cutoff = 3.31
  binsize = 1.655, bins = 7691 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.6 | 129.7 | 129.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033854704   1.2693283e-35  0              0.010156411    1264451.5      0              6.1055835e+10  1.1971759e-13  0              3.3297596    
    200000   12727.922      200            200            0.001415335   -1.269325e-35   0              0.004246005    393284.45      0              1.8990298e+10  1.1971759e-13  0              3.1078626    
    300000   12727.922      200            200            0.00031084505  2.969484e-41   0              0.00093253514  33898.607      0              1.6368424e+09  1.1971759e-13  0              3.1335535    
    400000   12727.922      200            200            0.0046246671   0.0009755381   0              0.012898463    19041.905      0              9.1946546e+08  1.1971759e-13  0              3.1000404    
    500000   12727.922      200            200            0.003395579    0.00060281731  0              0.0095839198   2851.644       0              1.3769568e+08  1.1971759e-13  0              3.1007598    
    600000   12727.922      200            200            0.0027034779   0.00037135467  0              0.007739079    33.432136      0              1614318.2      1.1971759e-13  0              3.1012382    
    700000   12727.922      200            200            0.0046801129   0.00040768975  0              0.013632649    20.686896      0              998896.2       1.1971759e-13  0              3.0999982    
    800000   12727.922      200            200            0.0040963664   0.00034140903  0              0.01194769     6.1743478      0              298137.16      1.1971759e-13  0              3.1003223    
    900000   12727.922      200            200            0.00417227     0.00038607966  0              0.01213073     0.91145367     0              44010.836      1.1971759e-13  0              3.1002838    
   1000000   12727.922      200            200            0.0042107374   0.00038191878  0              0.012250294    0.061926102    0              2990.1898      1.1971759e-13  0              3.1002617    
   1100000   12727.922      200            200            0.004178343    0.00038236366  0              0.012152665    0.00051538054  0              24.885882      1.1971759e-13  0              3.1002803    
   1200000   12727.922      200            200            0.0041928242   0.00038238399  0              0.012196089    0.00038432015  0              18.557445      1.1971759e-13  0              3.1002719    
   1300000   12727.922      200            200            0.0041883966   0.00038237822  0              0.012182812    0.00022370686  0              10.802004      1.1971759e-13  0              3.1002745    
   1400000   12727.922      200            200            0.0041891407   0.00038237921  0              0.012185043    4.1644593e-05  0              2.0108683      1.1971759e-13  0              3.1002741    
   1500000   12727.922      200            200            0.0041892833   0.00038237942  0              0.01218547     3.6530506e-06  0              0.17639274     1.1971759e-13  0              3.100274     
   1600000   12727.922      200            200            0.0041890967   0.00038237916  0              0.012184911    8.6647186e-08  0              0.0041838825   1.1971759e-13  0              3.1002741    
   1700000   12727.922      200            200            0.0041891909   0.00038237929  0              0.012185193    6.0629398e-09  0              0.00029275766  1.1971759e-13  0              3.1002741    
   1800000   12727.922      200            200            0.0041891588   0.00038237924  0              0.012185097    7.5389771e-09  0              0.00036403022  1.1971759e-13  0              3.1002741    
   1900000   12727.922      200            200            0.0041891656   0.00038237925  0              0.012185118    1.788078e-09   0              8.6339886e-05  1.1971759e-13  0              3.1002741    
   2000000   12727.922      200            200            0.0041891658   0.00038237925  0              0.012185118    1.9671166e-10  0              9.4985023e-06  1.1971759e-13  0              3.1002741    
   2100000   12727.922      200            200            0.0041891648   0.00038237925  0              0.012185115    8.0725215e-12  0              3.8979318e-07  1.1971759e-13  0              3.1002741    
   2200000   12727.922      200            200            0.0041891654   0.00038237925  0              0.012185117    2.5067794e-14  0              1.210434e-09   1.1971759e-13  0              3.1002741    
   2300000   12727.922      200            200            0.0041891651   0.00038237925  0              0.012185116    2.2825636e-13  0              1.1021683e-08  1.1971759e-13  0              3.1002741    
   2400000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    7.2326846e-14  0              3.4924046e-09  1.1971759e-13  0              3.1002741    
   2500000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    9.8173716e-15  0              4.7404574e-10  1.1971759e-13  0              3.1002741    
   2600000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    5.2972977e-16  0              2.5578755e-11  1.1971759e-13  0              3.1002741    
   2700000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    7.1964628e-18  0              3.4749143e-13  1.1971759e-13  0              3.1002741    
   2800000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    2.5930649e-17  0              1.2520982e-12  1.1971759e-13  0              3.1002741    
   2900000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    1.0055694e-17  0              4.8555348e-13  1.1971759e-13  0              3.1002741    
   3000000   12727.922      200            200            0.0041891652   0.00038237925  0              0.012185116    3.8697161e-18  0              1.8685474e-13  1.1971759e-13  0              3.1002741    
Loop time of 553.675 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4681448.614 ns/day, 0.000 hours/ns, 5418.343 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.48      | 77.848     | 135.12     | 622.1 | 14.06
Neigh   | 5.7323     | 5.7937     | 5.8585     |   1.9 |  1.05
Comm    | 20.119     | 26.506     | 31.46      |  87.6 |  4.79
Output  | 0.43229    | 0.43293    | 0.4336     |   0.1 |  0.08
Modify  | 325.26     | 337.13     | 348.38     |  60.7 | 60.89
Other   |            | 106        |            |       | 19.14

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         693.75 ave        1388 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2775
Ave neighs/atom = 0.55488902
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.22                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.4581968641666
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.32
  ghost atom cutoff = 3.32
  binsize = 1.66, bins = 7668 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129.3 | 129.3 | 129.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0033948494  -2.5386444e-35  0              0.010184548    1269158.8      0              6.1283135e+10  1.1971759e-13  0              3.3297558    
    200000   12727.922      200            200            0.0015800485  -1.7198266e-05  0              0.0047573437   399000.37      0              1.92663e+10    1.1971759e-13  0              3.1090731    
    300000   12727.922      200            200            0.00032376379  1.2693284e-35  0              0.00097129137  36333.235      0              1.7544019e+09  1.1971759e-13  0              3.1372466    
    400000   12727.922      200            200            0.0027758825   0.00052935225  0              0.0077982952   18694.802      0              9.027051e+08   1.1971759e-13  0              3.1061004    
    500000   12727.922      200            200            0.0026873672   0.00048032623  0              0.0075817755   2577.5533      0              1.2446082e+08  1.1971759e-13  0              3.1062254    
    600000   12727.922      200            200            0.0028287091   0.00037255703  0              0.0081135704   92.459569      0              4464541.7      1.1971759e-13  0              3.1061581    
    700000   12727.922      200            200            0.0045714534   0.00043805046  0              0.01327631     34.974482      0              1688792.6      1.1971759e-13  0              3.1050705    
    800000   12727.922      200            200            0.0041743522   0.00035199876  0              0.012171058    7.0769315      0              341719.7       1.1971759e-13  0              3.1052865    
    900000   12727.922      200            200            0.0041498797   0.00037954526  0              0.012070094    0.67211574     0              32454.064      1.1971759e-13  0              3.1053031    
   1000000   12727.922      200            200            0.0042218542   0.00037643704  0              0.012289125    0.016283131    0              786.2541       1.1971759e-13  0              3.1052616    
   1100000   12727.922      200            200            0.0041834683   0.00037725106  0              0.012173154    0.0012499148   0              60.353915      1.1971759e-13  0              3.1052839    
   1200000   12727.922      200            200            0.0041964534   0.00037726238  0              0.012212098    0.0014407056   0              69.566517      1.1971759e-13  0              3.1052763    
   1300000   12727.922      200            200            0.0041939949   0.00037726066  0              0.012204724    0.00030965312  0              14.952041      1.1971759e-13  0              3.1052778    
   1400000   12727.922      200            200            0.0041936982   0.00037726039  0              0.012203834    2.7709263e-05  0              1.3379812      1.1971759e-13  0              3.1052779    
   1500000   12727.922      200            200            0.0041942031   0.0003772608   0              0.012205349    5.4206083e-07  0              0.026174178    1.1971759e-13  0              3.1052777    
   1600000   12727.922      200            200            0.0041939457   0.00037726059  0              0.012204577    7.4760529e-08  0              0.0036099184   1.1971759e-13  0              3.1052778    
   1700000   12727.922      200            200            0.0041940295   0.00037726066  0              0.012204828    6.7525401e-08  0              0.00326056     1.1971759e-13  0              3.1052778    
   1800000   12727.922      200            200            0.0041940147   0.00037726065  0              0.012204783    1.3521102e-08  0              0.00065288565  1.1971759e-13  0              3.1052778    
   1900000   12727.922      200            200            0.0041940121   0.00037726065  0              0.012204776    1.1267513e-09  0              5.4406789e-05  1.1971759e-13  0              3.1052778    
   2000000   12727.922      200            200            0.0041940156   0.00037726065  0              0.012204786    1.7210113e-11  0              8.3101479e-07  1.1971759e-13  0              3.1052778    
   2100000   12727.922      200            200            0.0041940139   0.00037726065  0              0.012204781    4.2645468e-12  0              2.059197e-07   1.1971759e-13  0              3.1052778    
   2200000   12727.922      200            200            0.0041940145   0.00037726065  0              0.012204783    3.1435119e-12  0              1.5178894e-07  1.1971759e-13  0              3.1052778    
   2300000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    5.8773697e-13  0              2.8379715e-08  1.1971759e-13  0              3.1052778    
   2400000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    4.5686653e-14  0              2.206045e-09   1.1971759e-13  0              3.1052778    
   2500000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    6.1349702e-16  0              2.9623575e-11  1.1971759e-13  0              3.1052778    
   2600000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    2.14143e-16    0              1.0340199e-11  1.1971759e-13  0              3.1052778    
   2700000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    1.7511461e-16  0              8.4556576e-12  1.1971759e-13  0              3.1052778    
   2800000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    2.8322662e-18  0              1.3676e-13     1.1971759e-13  0              3.1052778    
   2900000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    4.4969245e-18  0              2.1714039e-13  1.1971759e-13  0              3.1052778    
   3000000   12727.922      200            200            0.0041940144   0.00037726065  0              0.012204782    1.1093367e-18  0              5.3565897e-14  1.1971759e-13  0              3.1052778    
Loop time of 551.704 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4698167.259 ns/day, 0.000 hours/ns, 5437.694 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.682     | 77.228     | 132.77     | 616.5 | 14.00
Neigh   | 5.6723     | 5.7301     | 5.7897     |   1.8 |  1.04
Comm    | 20.123     | 26.196     | 30.412     |  82.5 |  4.75
Output  | 0.39098    | 0.39162    | 0.39226    |   0.1 |  0.07
Modify  | 324.64     | 336.94     | 349.51     |  63.4 | 61.07
Other   |            | 105.2      |            |       | 19.07

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         697.75 ave        1396 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2791
Ave neighs/atom = 0.55808838
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.23                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 38.8176169501661
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.33
  ghost atom cutoff = 3.33
  binsize = 1.665, bins = 7645 121 121
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 129 | 129 | 129 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034042295   8.7498006e-42  0              0.010212688    1273872.7      0              6.1510755e+10  1.1971759e-13  0              3.3297402    
    200000   12727.922      200            200            0.0056262279   0.00020508179  0              0.016673602    401596.09      0              1.9391638e+10  1.1971759e-13  0              3.1102569    
    300000   12727.922      200            200            0.00033679643 -1.0154548e-34  0              0.0010103893   38849.371      0              1.8758971e+09  1.1971759e-13  0              3.1408928    
    400000   12727.922      200            200            0.0014284366   0.00030024346  0              0.0039850664   17594.903      0              8.4959491e+08  1.1971759e-13  0              3.1121408    
    500000   12727.922      200            200            0.0021166685   0.00042876005  0              0.0059212454   2189.9209      0              1.0574344e+08  1.1971759e-13  0              3.1116619    
    600000   12727.922      200            200            0.0030216705   0.00039699812  0              0.0086680135   170.28828      0              8222611.6      1.1971759e-13  0              3.1110384    
    700000   12727.922      200            200            0.0044226441   0.00042289769  0              0.012845035    46.679443      0              2253983.2      1.1971759e-13  0              3.1101578    
    800000   12727.922      200            200            0.0042530972   0.00035958477  0              0.012399707    6.6331625      0              320291.68      1.1971759e-13  0              3.1102499    
    900000   12727.922      200            200            0.0041330124   0.00037236354  0              0.012026674    0.33838326     0              16339.316      1.1971759e-13  0              3.1103192    
   1000000   12727.922      200            200            0.0042284804   0.0003710185   0              0.012314423    0.00018509942  0              8.9377886      1.1971759e-13  0              3.1102641    
   1100000   12727.922      200            200            0.0041905935   0.00037194025  0              0.01219984     0.0074368697   0              359.09982      1.1971759e-13  0              3.1102863    
   1200000   12727.922      200            200            0.0041994423   0.00037194126  0              0.012226386    0.0022359578   0              107.9664       1.1971759e-13  0              3.110281     
   1300000   12727.922      200            200            0.0041995305   0.00037194144  0              0.01222665     0.00023494138  0              11.344478      1.1971759e-13  0              3.110281     
   1400000   12727.922      200            200            0.0041982922   0.00037194136  0              0.012222935    5.6331767e-06  0              0.27200594     1.1971759e-13  0              3.1102817    
   1500000   12727.922      200            200            0.0041989852   0.00037194139  0              0.012225014    5.0052813e-07  0              0.024168712    1.1971759e-13  0              3.1102813    
   1600000   12727.922      200            200            0.0041987571   0.00037194139  0              0.01222433     5.2038911e-07  0              0.025127728    1.1971759e-13  0              3.1102815    
   1700000   12727.922      200            200            0.0041987939   0.00037194138  0              0.01222444     9.9575198e-08  0              0.00480813     1.1971759e-13  0              3.1102814    
   1800000   12727.922      200            200            0.0041988036   0.00037194139  0              0.012224469    6.8424497e-09  0              0.00033039741  1.1971759e-13  0              3.1102814    
   1900000   12727.922      200            200            0.0041987931   0.00037194138  0              0.012224438    2.2119725e-11  0              1.0680824e-06  1.1971759e-13  0              3.1102814    
   2000000   12727.922      200            200            0.0041987978   0.00037194138  0              0.012224452    7.111029e-11   0              3.4336614e-06  1.1971759e-13  0              3.1102814    
   2100000   12727.922      200            200            0.0041987965   0.00037194138  0              0.012224448    2.9494325e-11  0              1.4241754e-06  1.1971759e-13  0              3.1102814    
   2200000   12727.922      200            200            0.0041987966   0.00037194138  0              0.012224448    3.8331971e-12  0              1.8509137e-07  1.1971759e-13  0              3.1102814    
   2300000   12727.922      200            200            0.0041987967   0.00037194138  0              0.012224449    1.4864111e-13  0              7.1773472e-09  1.1971759e-13  0              3.1102814    
   2400000   12727.922      200            200            0.0041987966   0.00037194138  0              0.012224449    1.7920426e-15  0              8.6531323e-11  1.1971759e-13  0              3.1102814    
   2500000   12727.922      200            200            0.0041987967   0.00037194138  0              0.012224449    5.8764294e-15  0              2.8375175e-10  1.1971759e-13  0              3.1102814    
   2600000   12727.922      200            200            0.0041987967   0.00037194139  0              0.012224449    1.416553e-15   0              6.8400274e-11  1.1971759e-13  0              3.1102814    
   2700000   12727.922      200            200            0.0041987967   0.00037194139  0              0.012224449    7.3422755e-17  0              3.5453221e-12  1.1971759e-13  0              3.1102814    
   2800000   12727.922      200            200            0.0041987967   0.00037194139  0              0.012224449    9.4847606e-18  0              4.5798515e-13  1.1971759e-13  0              3.1102814    
   2900000   12727.922      200            200            0.0041987967   0.00037194138  0              0.012224449    9.390214e-20   0              4.5341983e-15  1.1971759e-13  0              3.1102814    
   3000000   12727.922      200            200            0.0041987967   0.00037194139  0              0.012224449    1.0601727e-17  0              5.1191945e-13  1.1971759e-13  0              3.1102814    
Loop time of 541.739 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4784591.172 ns/day, 0.000 hours/ns, 5537.721 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.426     | 74.782     | 127.72     | 603.2 | 13.80
Neigh   | 5.6517     | 5.7061     | 5.7641     |   1.7 |  1.05
Comm    | 20.05      | 26.635     | 32.046     |  99.0 |  4.92
Output  | 0.38794    | 0.38858    | 0.38924    |   0.1 |  0.07
Modify  | 315.99     | 329.34     | 342.43     |  69.3 | 60.79
Other   |            | 104.9      |            |       | 19.36

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         654.25 ave        1309 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2617
Ave neighs/atom = 0.52329534
Neighbor list builds = 165
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.24                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.1792694519052
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.34
  ghost atom cutoff = 3.34
  binsize = 1.67, bins = 7622 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.7 | 126.8 | 126.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034136107  -1.2693205e-35  0              0.010240832    1278593.3      0              6.1738695e+10  1.1971759e-13  0              3.3297129    
    200000   12727.922      200            200            0.014368386   -0.0014023991   0              0.044507557    391776.84      0              1.8917501e+10  1.1971759e-13  0              3.11145      
    300000   12727.922      200            200            0.00034994213 -2.5386489e-35  0              0.0010498264   41446.73       0              2.0013143e+09  1.1971759e-13  0              3.1444919    
    400000   12727.922      200            200            0.00051295063  0.00012388416  0              0.0014149677   16014.509      0              7.7328334e+08  1.1971759e-13  0              3.1181427    
    500000   12727.922      200            200            0.0016133563   0.00024836961  0              0.0045916994   1741.3139      0              84081816       1.1971759e-13  0              3.1170587    
    600000   12727.922      200            200            0.0032483321   0.00034919784  0              0.0093957984   253.66427      0              12248540       1.1971759e-13  0              3.115884     
    700000   12727.922      200            200            0.0042466283   0.00036410549  0              0.012375779    52.474851      0              2533822.8      1.1971759e-13  0              3.1152539    
    800000   12727.922      200            200            0.0043282171   0.00037176288  0              0.012612888    5.0072146      0              241780.47      1.1971759e-13  0              3.1152166    
    900000   12727.922      200            200            0.0041260711   0.00036994831  0              0.012008265    0.073497192    0              3548.9164      1.1971759e-13  0              3.1153304    
   1000000   12727.922      200            200            0.0042317111   0.00036981357  0              0.01232532     0.023131833    0              1116.9534      1.1971759e-13  0              3.1152694    
   1100000   12727.922      200            200            0.0042006756   0.00037069743  0              0.012231329    0.014424341    0              696.49982      1.1971759e-13  0              3.1152877    
   1200000   12727.922      200            200            0.0042036407   0.00037069742  0              0.012240225    0.0020703347   0              99.969052      1.1971759e-13  0              3.1152858    
   1300000   12727.922      200            200            0.0042062204   0.00037069765  0              0.012247964    7.7980609e-05  0              3.7654045      1.1971759e-13  0              3.1152844    
   1400000   12727.922      200            200            0.0042044077   0.0003706976   0              0.012242526    1.6046003e-06  0              0.077480404    1.1971759e-13  0              3.1152854    
   1500000   12727.922      200            200            0.0042050557   0.00037069762  0              0.01224447     3.536975e-06   0              0.17078786     1.1971759e-13  0              3.115285     
   1600000   12727.922      200            200            0.0042049437   0.00037069762  0              0.012244133    7.4224727e-07  0              0.035840464    1.1971759e-13  0              3.1152851    
   1700000   12727.922      200            200            0.0042049181   0.00037069762  0              0.012244057    4.8419491e-08  0              0.0023380039   1.1971759e-13  0              3.1152851    
   1800000   12727.922      200            200            0.0042049472   0.00037069762  0              0.012244144    2.5115197e-11  0              1.212723e-06   1.1971759e-13  0              3.1152851    
   1900000   12727.922      200            200            0.0042049347   0.00037069762  0              0.012244106    7.1823379e-10  0              3.4680939e-05  1.1971759e-13  0              3.1152851    
   2000000   12727.922      200            200            0.0042049376   0.00037069762  0              0.012244115    2.3634157e-10  0              1.1412089e-05  1.1971759e-13  0              3.1152851    
   2100000   12727.922      200            200            0.0042049377   0.00037069762  0              0.012244115    2.3377748e-11  0              1.1288278e-06  1.1971759e-13  0              3.1152851    
   2200000   12727.922      200            200            0.0042049373   0.00037069762  0              0.012244114    3.4490318e-13  0              1.665414e-08   1.1971759e-13  0              3.1152851    
   2300000   12727.922      200            200            0.0042049375   0.00037069762  0              0.012244115    1.0679604e-13  0              5.1567986e-09  1.1971759e-13  0              3.1152851    
   2400000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    6.6925759e-14  0              3.2316054e-09  1.1971759e-13  0              3.1152851    
   2500000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    9.4847544e-15  0              4.5798484e-10  1.1971759e-13  0              3.1152851    
   2600000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    3.1848951e-16  0              1.5378719e-11  1.1971759e-13  0              3.1152851    
   2700000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    3.8597024e-17  0              1.8637121e-12  1.1971759e-13  0              3.1152851    
   2800000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    2.1352978e-17  0              1.0310589e-12  1.1971759e-13  0              3.1152851    
   2900000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    1.0307143e-17  0              4.9769506e-13  1.1971759e-13  0              3.1152851    
   3000000   12727.922      200            200            0.0042049374   0.00037069762  0              0.012244115    3.3286682e-18  0              1.6072947e-13  1.1971759e-13  0              3.1152851    
Loop time of 540.233 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4797927.124 ns/day, 0.000 hours/ns, 5553.156 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.457     | 75.709     | 129.67     | 605.6 | 14.01
Neigh   | 5.4953     | 5.5549     | 5.6168     |   1.9 |  1.03
Comm    | 19.888     | 26.025     | 30.261     |  81.4 |  4.82
Output  | 0.42804    | 0.42867    | 0.42932    |   0.1 |  0.08
Modify  | 314.61     | 327.91     | 340.72     |  68.2 | 60.70
Other   |            | 104.6      |            |       | 19.36

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         660.25 ave        1321 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2641
Ave neighs/atom = 0.52809438
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.25                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.5431612808879
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.35
  ghost atom cutoff = 3.35
  binsize = 1.675, bins = 7599 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.4 | 126.4 | 126.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034229929   1.157608e-42   0              0.010268979    1283320.5      0              6.1966955e+10  1.1971759e-13  0              3.3296739    
    200000   12727.922      200            200            0.028730511   -0.00069732503  0              0.086888859    360735.76      0              1.7418639e+10  1.1971759e-13  0              3.1127355    
    300000   12727.922      200            200            0.00036320011  2.5386598e-35  0              0.0010896003   44125.038      0              2.1306402e+09  1.1971759e-13  0              3.1480438    
    400000   12727.922      200            200           -1.3414907e-05 -2.9187112e-05  0             -1.1057608e-05  14207.005      0              6.8600542e+08  1.1971759e-13  0              3.1240936    
    500000   12727.922      200            200            0.0012000985   3.3738668e-05  0              0.0035665569   1281.6005      0              61883901       1.1971759e-13  0              3.1224068    
    600000   12727.922      200            200            0.0035153922   0.00026285305  0              0.010283324    327.60682      0              15818961       1.1971759e-13  0              3.1207018    
    700000   12727.922      200            200            0.0040870987   0.00035589985  0              0.011905396    50.832567      0              2454522.7      1.1971759e-13  0              3.1203519    
    800000   12727.922      200            200            0.0043954543   0.00039541007  0              0.012790953    2.8199802      0              136166.75      1.1971759e-13  0              3.1201901    
    900000   12727.922      200            200            0.0041297572   0.00036976411  0              0.012019508    0.0052614469   0              254.05644      1.1971759e-13  0              3.1203358    
   1000000   12727.922      200            200            0.0042310855   0.00036998318  0              0.012323273    0.070668475    0              3412.3278      1.1971759e-13  0              3.1202771    
   1100000   12727.922      200            200            0.0042120341   0.00037079582  0              0.012265306    0.017034372    0              822.52885      1.1971759e-13  0              3.1202886    
   1200000   12727.922      200            200            0.00420859     0.00037079352  0              0.012254977    0.0010974686   0              52.992833      1.1971759e-13  0              3.1202904    
   1300000   12727.922      200            200            0.0042130036   0.00037079597  0              0.012268215    3.9486752e-09  0              0.0001906674   1.1971759e-13  0              3.1202879    
   1400000   12727.922      200            200            0.0042111403   0.00037079508  0              0.012262626    2.0091011e-05  0              0.97012303     1.1971759e-13  0              3.120289     
   1500000   12727.922      200            200            0.0042115297   0.00037079527  0              0.012263794    5.5420988e-06  0              0.26760812     1.1971759e-13  0              3.1202887    
   1600000   12727.922      200            200            0.0042115747   0.0003707953   0              0.012263929    4.082294e-07   0              0.019711937    1.1971759e-13  0              3.1202887    
   1700000   12727.922      200            200            0.0042114987   0.00037079526  0              0.012263701    4.2585453e-10  0              2.0562991e-05  1.1971759e-13  0              3.1202888    
   1800000   12727.922      200            200            0.0042115327   0.00037079528  0              0.012263803    5.6135164e-09  0              0.00027105662  1.1971759e-13  0              3.1202887    
   1900000   12727.922      200            200            0.004211525    0.00037079527  0              0.01226378     1.7861411e-09  0              8.6246364e-05  1.1971759e-13  0              3.1202887    
   2000000   12727.922      200            200            0.0042115245   0.00037079527  0              0.012263778    1.4920029e-10  0              7.2043482e-06  1.1971759e-13  0              3.1202887    
   2100000   12727.922      200            200            0.0042115258   0.00037079527  0              0.012263782    5.8243632e-13  0              2.8123765e-08  1.1971759e-13  0              3.1202887    
   2200000   12727.922      200            200            0.0042115252   0.00037079527  0              0.01226378     1.5332223e-12  0              7.4033817e-08  1.1971759e-13  0              3.1202887    
   2300000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    5.7034803e-13  0              2.7540065e-08  1.1971759e-13  0              3.1202887    
   2400000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    5.3589596e-14  0              2.5876498e-09  1.1971759e-13  0              3.1202887    
   2500000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    4.7850552e-16  0              2.3105319e-11  1.1971759e-13  0              3.1202887    
   2600000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    4.1828617e-16  0              2.0197542e-11  1.1971759e-13  0              3.1202887    
   2700000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    1.8911852e-16  0              9.1318566e-12  1.1971759e-13  0              3.1202887    
   2800000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    3.5195843e-20  0              1.6994813e-15  1.1971759e-13  0              3.1202887    
   2900000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    4.4353438e-19  0              2.1416688e-14  1.1971759e-13  0              3.1202887    
   3000000   12727.922      200            200            0.0042115253   0.00037079527  0              0.012263781    1.449025e-17   0              6.996823e-13   1.1971759e-13  0              3.1202887    
Loop time of 543.135 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4772295.354 ns/day, 0.000 hours/ns, 5523.490 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.112     | 76.087     | 131.3      | 607.1 | 14.01
Neigh   | 5.2316     | 5.2826     | 5.3355     |   1.6 |  0.97
Comm    | 19.608     | 25.536     | 30.615     |  88.8 |  4.70
Output  | 0.51849    | 0.51913    | 0.51979    |   0.1 |  0.10
Modify  | 317.22     | 330.34     | 342.87     |  67.3 | 60.82
Other   |            | 105.4      |            |       | 19.40

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         665.25 ave        1331 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2661
Ave neighs/atom = 0.53209358
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.26                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 39.9092993486176
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.36
  ghost atom cutoff = 3.36
  binsize = 1.68, bins = 7577 120 120
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 126.1 | 126.1 | 126.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003432376    3.8079771e-35  0              0.010297128    1288054.3      0              6.2195534e+10  1.1971759e-13  0              3.329623     
    200000   12727.922      200            200            0.045764564   -0.0031533042   0              0.140447       303862.53      0              1.4672434e+10  1.1971759e-13  0              3.1142405    
    300000   12727.922      200            200            0.00037656948  6.3453617e-45  0              0.0011297085   46883.996      0              2.2638604e+09  1.1971759e-13  0              3.1515486    
    400000   12727.922      200            200           -0.00014472719 -1.5097482e-08  0             -0.00043416648  12378.534      0              5.9771511e+08  1.1971759e-13  0              3.1299863    
    500000   12727.922      200            200            0.00092728471 -2.9038104e-05  0              0.0028108922   853.64077      0              41219258       1.1971759e-13  0              3.1276996    
    600000   12727.922      200            200            0.0038353825   0.00019985403  0              0.011306293    377.84426      0              18244747       1.1971759e-13  0              3.1255004    
    700000   12727.922      200            200            0.0039354127   0.00033720717  0              0.011469031    42.364895      0              2045649.2      1.1971759e-13  0              3.1254452    
    800000   12727.922      200            200            0.0044379004   0.00039629583  0              0.012917405    0.91230837     0              44052.106      1.1971759e-13  0              3.1251734    
    900000   12727.922      200            200            0.0041445664   0.000372299    0              0.0120614      0.16484364     0              7959.7096      1.1971759e-13  0              3.1253354    
   1000000   12727.922      200            200            0.00422798     0.00037214329  0              0.012311797    0.11356553     0              5483.6729      1.1971759e-13  0              3.1252867    
   1100000   12727.922      200            200            0.0042239593   0.00037288673  0              0.012298991    0.013374932    0              645.82761      1.1971759e-13  0              3.1252895    
   1200000   12727.922      200            200            0.0042148851   0.00037287905  0              0.012271776    0.00017253969  0              8.3313241      1.1971759e-13  0              3.1252946    
   1300000   12727.922      200            200            0.0042200447   0.00037288382  0              0.01228725     7.9138214e-05  0              3.8213011      1.1971759e-13  0              3.1252916    
   1400000   12727.922      200            200            0.0042186589   0.0003728827   0              0.012283094    3.9120736e-05  0              1.8890003      1.1971759e-13  0              3.1252925    
   1500000   12727.922      200            200            0.0042186655   0.00037288269  0              0.012283114    3.8525454e-06  0              0.18602563     1.1971759e-13  0              3.1252924    
   1600000   12727.922      200            200            0.0042188483   0.00037288285  0              0.012283662    2.2769162e-08  0              0.0010994413   1.1971759e-13  0              3.1252923    
   1700000   12727.922      200            200            0.0042187551   0.00037288277  0              0.012283383    3.5121428e-08  0              0.0016958881   1.1971759e-13  0              3.1252924    
   1800000   12727.922      200            200            0.0042187776   0.00037288279  0              0.01228345     1.3194379e-08  0              0.00063710935  1.1971759e-13  0              3.1252924    
   1900000   12727.922      200            200            0.0042187788   0.00037288279  0              0.012283454    1.077024e-09   0              5.2005632e-05  1.1971759e-13  0              3.1252924    
   2000000   12727.922      200            200            0.0042187752   0.00037288279  0              0.012283443    1.3022518e-12  0              6.2881079e-08  1.1971759e-13  0              3.1252924    
   2100000   12727.922      200            200            0.0042187768   0.00037288279  0              0.012283448    1.4679412e-11  0              7.0881626e-07  1.1971759e-13  0              3.1252924    
   2200000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    4.3563891e-12  0              2.1035444e-07  1.1971759e-13  0              3.1252924    
   2300000   12727.922      200            200            0.0042187764   0.00037288279  0              0.012283446    2.9038639e-13  0              1.402172e-08   1.1971759e-13  0              3.1252924    
   2400000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    4.204444e-17   0              2.0301755e-12  1.1971759e-13  0              3.1252924    
   2500000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    5.7093213e-15  0              2.7568269e-10  1.1971759e-13  0              3.1252924    
   2600000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    1.405933e-15   0              6.7887473e-11  1.1971759e-13  0              3.1252924    
   2700000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    3.4836438e-17  0              1.6821269e-12  1.1971759e-13  0              3.1252924    
   2800000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    2.0187204e-17  0              9.7476782e-13  1.1971759e-13  0              3.1252924    
   2900000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    4.5565987e-18  0              2.2002184e-13  1.1971759e-13  0              3.1252924    
   3000000   12727.922      200            200            0.0042187765   0.00037288279  0              0.012283447    7.5942662e-18  0              3.6669994e-13  1.1971759e-13  0              3.1252924    
Loop time of 542.429 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4778505.796 ns/day, 0.000 hours/ns, 5530.678 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.367     | 76.169     | 129.72     | 611.0 | 14.04
Neigh   | 5.23       | 5.2793     | 5.3308     |   1.6 |  0.97
Comm    | 19.237     | 25.747     | 31.131     |  86.5 |  4.75
Output  | 0.41439    | 0.41501    | 0.41565    |   0.1 |  0.08
Modify  | 316.33     | 329.3      | 342.62     |  66.4 | 60.71
Other   |            | 105.5      |            |       | 19.45

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         670.75 ave        1342 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2683
Ave neighs/atom = 0.5364927
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.27                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.2776905665988
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.37
  ghost atom cutoff = 3.37
  binsize = 1.685, bins = 7554 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.9 | 123.9 | 124 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034417602   1.2270032e-41  0              0.01032528     1292794.8      0              6.2424432e+10  1.1971759e-13  0              3.3295604    
    200000   12727.922      200            200            0.063293473   -0.0094800467   0              0.19936047     224197.38      0              1.0825689e+10  1.1971759e-13  0              3.1161262    
    300000   12727.922      200            200            0.00039004945  1.0154669e-34  0              0.0011701484   49723.331      0              2.4009617e+09  1.1971759e-13  0              3.155006     
    400000   12727.922      200            200           -0.00013569325  1.0154679e-34  0             -0.00040707975  10659.04       0              5.1468689e+08  1.1971759e-13  0              3.1358183    
    500000   12727.922      200            200            0.00078109888  5.931829e-05   0              0.0022839783   491.20695      0              23718626       1.1971759e-13  0              3.132932     
    600000   12727.922      200            200            0.0042197176   0.00023167406  0              0.012427479    393.55985      0              19003597       1.1971759e-13  0              3.1302892    
    700000   12727.922      200            200            0.0037973519   0.0002954964   0              0.011096559    29.541732      0              1426464.5      1.1971759e-13  0              3.1305273    
    800000   12727.922      200            200            0.0044582379   0.00039394344  0              0.01298077     0.018886406    0              911.95693      1.1971759e-13  0              3.1301685    
    900000   12727.922      200            200            0.0041674833   0.0003712404   0              0.01213121     0.47283822     0              22831.666      1.1971759e-13  0              3.1303295    
   1000000   12727.922      200            200            0.0042222404   0.00037085172  0              0.01229587     0.12578738     0              6073.8226      1.1971759e-13  0              3.1302971    
   1100000   12727.922      200            200            0.0042337347   0.00037152681  0              0.012329677    0.0061714443   0              297.99696      1.1971759e-13  0              3.130291     
   1200000   12727.922      200            200            0.0042209331   0.00037152469  0              0.012291274    9.5974563e-05  0              4.6342682      1.1971759e-13  0              3.1302983    
   1300000   12727.922      200            200            0.0042255919   0.00037152642  0              0.012305249    0.00023306516  0              11.253882      1.1971759e-13  0              3.1302956    
   1400000   12727.922      200            200            0.0042250664   0.00037152633  0              0.012303673    3.6463655e-05  0              1.7606994      1.1971759e-13  0              3.1302959    
   1500000   12727.922      200            200            0.0042246939   0.0003715262   0              0.012302556    7.3772826e-07  0              0.035622257    1.1971759e-13  0              3.1302961    
   1600000   12727.922      200            200            0.004224944    0.00037152628  0              0.012303306    1.5769945e-07  0              0.0076147422   1.1971759e-13  0              3.130296     
   1700000   12727.922      200            200            0.0042248735   0.00037152626  0              0.012303094    9.4031302e-08  0              0.0045404351   1.1971759e-13  0              3.130296     
   1800000   12727.922      200            200            0.0042248739   0.00037152626  0              0.012303095    8.9102829e-09  0              0.00043024567  1.1971759e-13  0              3.130296     
   1900000   12727.922      200            200            0.0042248832   0.00037152626  0              0.012303123    1.8452031e-11  0              8.9098253e-07  1.1971759e-13  0              3.130296     
   2000000   12727.922      200            200            0.0042248786   0.00037152626  0              0.01230311     1.1250149e-10  0              5.4322942e-06  1.1971759e-13  0              3.130296     
   2100000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303112    3.2335376e-11  0              1.5613596e-06  1.1971759e-13  0              3.130296     
   2200000   12727.922      200            200            0.0042248797   0.00037152626  0              0.012303113    1.7279801e-12  0              8.3437973e-08  1.1971759e-13  0              3.130296     
   2300000   12727.922      200            200            0.0042248795   0.00037152626  0              0.012303112    1.6737662e-14  0              8.0820179e-10  1.1971759e-13  0              3.130296     
   2400000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    5.7602368e-14  0              2.7814122e-09  1.1971759e-13  0              3.130296     
   2500000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    9.540869e-15   0              4.6069442e-10  1.1971759e-13  0              3.130296     
   2600000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    1.9887129e-16  0              9.602783e-12   1.1971759e-13  0              3.130296     
   2700000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    7.8265703e-17  0              3.7791707e-12  1.1971759e-13  0              3.130296     
   2800000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    1.0250322e-17  0              4.9495139e-13  1.1971759e-13  0              3.130296     
   2900000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    1.175441e-17   0              5.675784e-13   1.1971759e-13  0              3.130296     
   3000000   12727.922      200            200            0.0042248796   0.00037152626  0              0.012303113    1.6010435e-19  0              7.7308659e-15  1.1971759e-13  0              3.130296     
Loop time of 543.237 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4771400.370 ns/day, 0.000 hours/ns, 5522.454 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.569     | 76.033     | 130.14     | 609.5 | 14.00
Neigh   | 5.1974     | 5.2452     | 5.2966     |   1.6 |  0.97
Comm    | 19.129     | 25.133     | 29.701     |  83.2 |  4.63
Output  | 0.42837    | 0.42901    | 0.42967    |   0.1 |  0.08
Modify  | 319.16     | 331.92     | 344.2      |  65.8 | 61.10
Other   |            | 104.5      |            |       | 19.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         675.75 ave        1352 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2703
Ave neighs/atom = 0.5404919
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.28                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 40.6483418463349
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.38
  ghost atom cutoff = 3.38
  binsize = 1.69, bins = 7532 119 119
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 123.6 | 123.6 | 123.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034511451   5.077306e-35   0              0.010353435    1297541.8      0              6.2653649e+10  1.1971759e-13  0              3.3294859    
    200000   12727.922      200            200            0.081276076   -0.011804246    0              0.25563247     134369.54      0              6.4882244e+09  1.1971759e-13  0              3.1185706    
    300000   12727.922      200            200            0.00040363918  2.613929e-40   0              0.0012109176   52642.757      0              2.5419303e+09  1.1971759e-13  0              3.1584161    
    400000   12727.922      200            200           -0.00012643181  1.0154642e-34  0             -0.00037929544  9070.3476      0              4.3797462e+08  1.1971759e-13  0              3.1415894    
    500000   12727.922      200            200            0.00069567449  0.0001376764   0              0.0019493471   218.7397       0              10562157       1.1971759e-13  0              3.1381003    
    600000   12727.922      200            200            0.004667838    0.00040828192  0              0.013595232    370.06205      0              17868972       1.1971759e-13  0              3.1350789    
    700000   12727.922      200            200            0.003699506    0.00028663665  0              0.010811881    15.930401      0              769222.06      1.1971759e-13  0              3.1355929    
    800000   12727.922      200            200            0.004455983    0.00039166673  0              0.012976282    0.47880747     0              23119.899      1.1971759e-13  0              3.1351762    
    900000   12727.922      200            200            0.0041971724   0.00036874174  0              0.012222775    0.77843964     0              37588.064      1.1971759e-13  0              3.1353194    
   1000000   12727.922      200            200            0.0042167642   0.00036917112  0              0.012281121    0.10016066     0              4836.3998      1.1971759e-13  0              3.1353073    
   1100000   12727.922      200            200            0.0042416379   0.00036966189  0              0.012355252    0.00070378637  0              33.983325      1.1971759e-13  0              3.1352935    
   1200000   12727.922      200            200            0.0042277209   0.00036966656  0              0.012313496    0.00092281254  0              44.559315      1.1971759e-13  0              3.1353014    
   1300000   12727.922      200            200            0.0042307789   0.00036966641  0              0.01232267     0.00030535838  0              14.744664      1.1971759e-13  0              3.1352996    
   1400000   12727.922      200            200            0.0042312469   0.00036966642  0              0.012324074    1.5388411e-05  0              0.74305131     1.1971759e-13  0              3.1352994    
   1500000   12727.922      200            200            0.004230622    0.00036966648  0              0.012322199    3.0266007e-07  0              0.014614372    1.1971759e-13  0              3.1352997    
   1600000   12727.922      200            200            0.0042308453   0.00036966645  0              0.012322869    6.0639048e-07  0              0.029280426    1.1971759e-13  0              3.1352996    
   1700000   12727.922      200            200            0.0042308269   0.00036966646  0              0.012322814    7.9939709e-08  0              0.0038600024   1.1971759e-13  0              3.1352996    
   1800000   12727.922      200            200            0.0042308054   0.00036966646  0              0.01232275     6.2053044e-10  0              2.9963194e-05  1.1971759e-13  0              3.1352996    
   1900000   12727.922      200            200            0.0042308177   0.00036966646  0              0.012322787    7.05407e-10    0              3.4061579e-05  1.1971759e-13  0              3.1352996    
   2000000   12727.922      200            200            0.004230815    0.00036966646  0              0.012322778    2.4051054e-10  0              1.1613393e-05  1.1971759e-13  0              3.1352996    
   2100000   12727.922      200            200            0.0042308146   0.00036966646  0              0.012322777    1.2497241e-11  0              6.0344706e-07  1.1971759e-13  0              3.1352996    
   2200000   12727.922      200            200            0.0042308151   0.00036966646  0              0.012322779    2.1468969e-13  0              1.0366597e-08  1.1971759e-13  0              3.1352996    
   2300000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    4.7144217e-13  0              2.2764255e-08  1.1971759e-13  0              3.1352996    
   2400000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    6.3252011e-14  0              3.0542133e-09  1.1971759e-13  0              3.1352996    
   2500000   12727.922      200            200            0.004230815    0.00036966646  0              0.012322778    4.9865028e-16  0              2.4078038e-11  1.1971759e-13  0              3.1352996    
   2600000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    5.9745205e-16  0              2.8848821e-11  1.1971759e-13  0              3.1352996    
   2700000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    1.6186007e-16  0              7.8156434e-12  1.1971759e-13  0              3.1352996    
   2800000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    3.7105826e-18  0              1.7917076e-13  1.1971759e-13  0              3.1352996    
   2900000   12727.922      200            200            0.0042308149   0.00036966646  0              0.012322778    1.1152491e-17  0              5.385139e-13   1.1971759e-13  0              3.1352996    
   3000000   12727.922      200            200            0.0042308149   0.00036966645  0              0.012322778    2.3468914e-18  0              1.1332299e-13  1.1971759e-13  0              3.1352996    
Loop time of 540.539 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4795212.070 ns/day, 0.000 hours/ns, 5550.014 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.687     | 75.675     | 128.85     | 602.8 | 14.00
Neigh   | 5.1184     | 5.1673     | 5.2173     |   1.6 |  0.96
Comm    | 18.899     | 25.836     | 31.201     | 100.4 |  4.78
Output  | 0.42917    | 0.4298     | 0.43046    |   0.1 |  0.08
Modify  | 316.69     | 328.93     | 341.57     |  64.3 | 60.85
Other   |            | 104.5      |            |       | 19.33

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         680.75 ave        1362 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2723
Ave neighs/atom = 0.5444911
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.29                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.0212600993298
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.39
  ghost atom cutoff = 3.39
  binsize = 1.695, bins = 7510 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.5 | 121.5 | 121.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003460531   -1.269322e-35   0              0.010381593    1302295.4      0              6.2883184e+10  1.1971759e-13  0              3.3293996    
    200000   12727.922      200            200            0.095508394   -0.013853801    0              0.30037898     54727.9        0              2.6426144e+09  1.1971759e-13  0              3.1217448    
    300000   12727.922      200            200            0.00041733787 -2.5386326e-35  0              0.0012520136   55641.997      0              2.6867529e+09  1.1971759e-13  0              3.1617787    
    400000   12727.922      200            200           -0.00011697209  3.3599131e-41  0             -0.00035091627  7611.8763      0              3.6755026e+08  1.1971759e-13  0              3.1472995    
    500000   12727.922      200            200            0.00064817052  0.00016783935  0              0.0017766722   52.195376      0              2520327.9      1.1971759e-13  0              3.1432022    
    600000   12727.922      200            200            0.00509692     0.00054445605  0              0.014746304    310.51602      0              14993708       1.1971759e-13  0              3.1398806    
    700000   12727.922      200            200            0.003645681    0.00030490838  0              0.010632134    5.2010201      0              251138.64      1.1971759e-13  0              3.1406379    
    800000   12727.922      200            200            0.00443346     0.0003939286   0              0.012906451    2.1028045      0              101536.9       1.1971759e-13  0              3.1401961    
    900000   12727.922      200            200            0.0042315919   0.00036757074  0              0.012327205    0.93266687     0              45035.145      1.1971759e-13  0              3.1403069    
   1000000   12727.922      200            200            0.0042142338   0.00036976173  0              0.01227294     0.05236975     0              2528.7478      1.1971759e-13  0              3.1403162    
   1100000   12727.922      200            200            0.00424807     0.00036961337  0              0.012374597    0.00092239629  0              44.539216      1.1971759e-13  0              3.1402971    
   1200000   12727.922      200            200            0.0042358216   0.00036962131  0              0.012337844    0.0019292993   0              93.158957      1.1971759e-13  0              3.1403041    
   1300000   12727.922      200            200            0.004236581    0.00036962092  0              0.012340122    0.00022396652  0              10.814542      1.1971759e-13  0              3.1403036    
   1400000   12727.922      200            200            0.0042378963   0.00036962054  0              0.012344068    3.4714943e-07  0              0.016762603    1.1971759e-13  0              3.1403029    
   1500000   12727.922      200            200            0.0042372242   0.00036962078  0              0.012342052    3.0775031e-06  0              0.14860161     1.1971759e-13  0              3.1403033    
   1600000   12727.922      200            200            0.0042373389   0.00036962073  0              0.012342396    7.049481e-07   0              0.034039421    1.1971759e-13  0              3.1403032    
   1700000   12727.922      200            200            0.0042373795   0.00036962072  0              0.012342518    1.6487144e-08  0              0.00079610516  1.1971759e-13  0              3.1403032    
   1800000   12727.922      200            200            0.0042373465   0.00036962073  0              0.012342419    3.2585307e-09  0              0.00015734279  1.1971759e-13  0              3.1403032    
   1900000   12727.922      200            200            0.0042373553   0.00036962073  0              0.012342445    1.7629985e-09  0              8.512889e-05   1.1971759e-13  0              3.1403032    
   2000000   12727.922      200            200            0.0042373559   0.00036962073  0              0.012342447    1.1101478e-10  0              5.3605062e-06  1.1971759e-13  0              3.1403032    
   2100000   12727.922      200            200            0.0042373545   0.00036962073  0              0.012342443    1.1480738e-12  0              5.5436376e-08  1.1971759e-13  0              3.1403032    
   2200000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    3.5321225e-12  0              1.7055355e-07  1.1971759e-13  0              3.1403032    
   2300000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    4.5002218e-13  0              2.1729961e-08  1.1971759e-13  0              3.1403032    
   2400000   12727.922      200            200            0.0042373549   0.00036962073  0              0.012342444    1.4163194e-15  0              6.8388996e-11  1.1971759e-13  0              3.1403032    
   2500000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    5.2401155e-15  0              2.5302643e-10  1.1971759e-13  0              3.1403032    
   2600000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    1.3700411e-15  0              6.6154381e-11  1.1971759e-13  0              3.1403032    
   2700000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    8.219457e-18   0              3.9688816e-13  1.1971759e-13  0              3.1403032    
   2800000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    2.5587466e-17  0              1.2355272e-12  1.1971759e-13  0              3.1403032    
   2900000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    2.2354561e-18  0              1.0794218e-13  1.1971759e-13  0              3.1403032    
   3000000   12727.922      200            200            0.004237355    0.00036962073  0              0.012342444    1.4430102e-17  0              6.9677799e-13  1.1971759e-13  0              3.1403032    
Loop time of 545.063 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4755412.938 ns/day, 0.000 hours/ns, 5503.950 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.9       | 76.665     | 131.29     | 612.2 | 14.07
Neigh   | 5.3317     | 5.3872     | 5.4449     |   1.8 |  0.99
Comm    | 19.284     | 25.981     | 31.251     | 100.9 |  4.77
Output  | 0.3905     | 0.39114    | 0.39181    |   0.1 |  0.07
Modify  | 319.69     | 331.62     | 342.54     |  59.9 | 60.84
Other   |            | 105        |            |       | 19.27

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         685.75 ave        1372 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2743
Ave neighs/atom = 0.5484903
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.3                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.3964522370874
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.4
  ghost atom cutoff = 3.4
  binsize = 1.7, bins = 7488 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 121.2 | 121.2 | 121.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034699176   3.3481263e-42  0              0.010409753    1307055.6      0              6.3113038e+10  1.1971759e-13  0              3.3293014    
    200000   12727.922      200            200            0.10391941    -0.013798295    0              0.32555652     6969.2885      0              3.36522e+08    1.1971759e-13  0              3.1257854    
    300000   12727.922      200            200            0.00043114473  8.1236879e-34  0              0.0012934342   58720.782      0              2.8354164e+09  1.1971759e-13  0              3.1650938    
    400000   12727.922      200            200           -0.00010731553  7.633151e-40   0             -0.00032194659  6283.0441      0              3.0338571e+08  1.1971759e-13  0              3.1529486    
    500000   12727.922      200            200            0.00063487313  0.00015746543  0              0.0017471539   0.17904647     0              8645.5134      1.1971759e-13  0              3.1482364    
    600000   12727.922      200            200            0.0054288604   0.00047830496  0              0.015808276    226.19962      0              10922370       1.1971759e-13  0              3.1447051    
    700000   12727.922      200            200            0.0036301423   0.00032239249  0              0.010568034    0.1771619      0              8554.5143      1.1971759e-13  0              3.1456594    
    800000   12727.922      200            200            0.0043956651   0.00040625622  0              0.012780739    4.2516739      0              205298.11      1.1971759e-13  0              3.1452264    
    900000   12727.922      200            200            0.0042678162   0.00036953757  0              0.012433911    0.86052911     0              41551.871      1.1971759e-13  0              3.145294     
   1000000   12727.922      200            200            0.004216427    0.00037363959  0              0.012275641    0.01118964     0              540.30767      1.1971759e-13  0              3.1453231    
   1100000   12727.922      200            200            0.0042536502   0.00037315583  0              0.012387795    0.0066018447   0              318.77946      1.1971759e-13  0              3.1453018    
   1200000   12727.922      200            200            0.0042454653   0.0003731559   0              0.01236324     0.0022475229   0              108.52484      1.1971759e-13  0              3.1453066    
   1300000   12727.922      200            200            0.0042437847   0.00037315516  0              0.012358199    7.1504278e-05  0              3.4526857      1.1971759e-13  0              3.1453075    
   1400000   12727.922      200            200            0.0042455704   0.00037315581  0              0.012363555    8.4803467e-06  0              0.40948559     1.1971759e-13  0              3.1453065    
   1500000   12727.922      200            200            0.0042450668   0.00037315566  0              0.012362045    5.405551e-06   0              0.26101471     1.1971759e-13  0              3.1453068    
   1600000   12727.922      200            200            0.0042450327   0.00037315565  0              0.012361942    3.1202198e-07  0              0.015066425    1.1971759e-13  0              3.1453068    
   1700000   12727.922      200            200            0.0042451142   0.00037315567  0              0.012362187    7.0650745e-09  0              0.00034114716  1.1971759e-13  0              3.1453068    
   1800000   12727.922      200            200            0.0042450855   0.00037315567  0              0.012362101    1.1955396e-08  0              0.00057728329  1.1971759e-13  0              3.1453068    
   1900000   12727.922      200            200            0.0042450863   0.00037315567  0              0.012362103    1.1137639e-09  0              5.3779673e-05  1.1971759e-13  0              3.1453068    
   2000000   12727.922      200            200            0.0042450898   0.00037315567  0              0.012362114    1.105423e-12   0              5.3376921e-08  1.1971759e-13  0              3.1453068    
   2100000   12727.922      200            200            0.0042450883   0.00037315567  0              0.012362109    2.4115243e-11  0              1.1644388e-06  1.1971759e-13  0              3.1453068    
   2200000   12727.922      200            200            0.0042450884   0.00037315567  0              0.01236211     3.4769124e-12  0              1.6788766e-07  1.1971759e-13  0              3.1453068    
   2300000   12727.922      200            200            0.0042450886   0.00037315567  0              0.01236211     1.0430613e-14  0              5.0365696e-10  1.1971759e-13  0              3.1453068    
   2400000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     4.2875693e-14  0              2.0703138e-09  1.1971759e-13  0              3.1453068    
   2500000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     9.7927907e-15  0              4.7285882e-10  1.1971759e-13  0              3.1453068    
   2600000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     1.369259e-16   0              6.6116618e-12  1.1971759e-13  0              3.1453068    
   2700000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     1.1368797e-16  0              5.489585e-12   1.1971759e-13  0              3.1453068    
   2800000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     3.6847071e-18  0              1.7792132e-13  1.1971759e-13  0              3.1453068    
   2900000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     1.3789306e-17  0              6.6583625e-13  1.1971759e-13  0              3.1453068    
   3000000   12727.922      200            200            0.0042450885   0.00037315567  0              0.01236211     8.6711007e-18  0              4.1869642e-13  1.1971759e-13  0              3.1453068    
Loop time of 542.35 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4779203.924 ns/day, 0.000 hours/ns, 5531.486 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.742     | 76.613     | 131.34     | 611.7 | 14.13
Neigh   | 5.0757     | 5.1178     | 5.161      |   1.3 |  0.94
Comm    | 19.215     | 25.29      | 29.56      |  84.4 |  4.66
Output  | 0.50201    | 0.50263    | 0.50329    |   0.1 |  0.09
Modify  | 318.45     | 330.54     | 342.62     |  60.8 | 60.95
Other   |            | 104.3      |            |       | 19.23

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         690.25 ave        1381 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2761
Ave neighs/atom = 0.55208958
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.31                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 41.7739251711113
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.41
  ghost atom cutoff = 3.41
  binsize = 1.705, bins = 7466 118 118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 120.9 | 120.9 | 120.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034793049  -1.2693242e-35  0              0.010437915    1311822.4      0              6.334321e+10   1.1971759e-13  0              3.3291913    
    200000   12727.922      200            200            0.10416419    -0.013758971    0              0.32625154     5412.9587      0              2.613724e+08   1.1971759e-13  0              3.1307709    
    300000   12727.922      200            200            0.00044505886  6.7608222e-40  0              0.0013351766   61878.812      0              2.9879064e+09  1.1971759e-13  0              3.1683614    
    400000   12727.922      200            200           -9.7463673e-05 -2.538637e-35   0             -0.00029239102  5083.2853      0              2.4545365e+08  1.1971759e-13  0              3.1585366    
    500000   12727.922      200            200            0.00067024417  0.0001562786   0              0.0018544539   64.861409      0              3131925.3      1.1971759e-13  0              3.1532024    
    600000   12727.922      200            200            0.0057134801   0.00043482586  0              0.016705614    134.69797      0              6504082.9      1.1971759e-13  0              3.1495624    
    700000   12727.922      200            200            0.0036487432   0.00032229446  0              0.010623935    2.1389973      0              103284.53      1.1971759e-13  0              3.1506564    
    800000   12727.922      200            200            0.0043445743   0.00041933482  0              0.012614388    6.0917735      0              294149.94      1.1971759e-13  0              3.1502645    
    900000   12727.922      200            200            0.0043017688   0.00037340486  0              0.012531902    0.59737672     0              28845.184      1.1971759e-13  0              3.1502827    
   1000000   12727.922      200            200            0.0042230058   0.00037718796  0              0.012291829    0.001110688    0              53.631151      1.1971759e-13  0              3.1503274    
   1100000   12727.922      200            200            0.0042576039   0.00037670965  0              0.012396102    0.013568669    0              655.18246      1.1971759e-13  0              3.1503075    
   1200000   12727.922      200            200            0.0042550288   0.0003767076   0              0.012388379    0.0016096301   0              77.723279      1.1971759e-13  0              3.1503091    
   1300000   12727.922      200            200            0.004251342    0.00037670345  0              0.012377323    7.8925742e-08  0              0.0038110416   1.1971759e-13  0              3.1503112    
   1400000   12727.922      200            200            0.0042530997   0.00037670551  0              0.012382594    3.0191037e-05  0              1.4578171      1.1971759e-13  0              3.1503102    
   1500000   12727.922      200            200            0.0042529219   0.00037670532  0              0.01238206     4.2674251e-06  0              0.20605868     1.1971759e-13  0              3.1503103    
   1600000   12727.922      200            200            0.0042527539   0.00037670512  0              0.012381557    2.8097125e-09  0              0.00013567096  1.1971759e-13  0              3.1503104    
   1700000   12727.922      200            200            0.0042528421   0.00037670522  0              0.012381821    6.6103453e-08  0              0.0031918992   1.1971759e-13  0              3.1503103    
   1800000   12727.922      200            200            0.0042528309   0.00037670521  0              0.012381788    1.1140043e-08  0              0.00053791282  1.1971759e-13  0              3.1503103    
   1900000   12727.922      200            200            0.0042528234   0.0003767052   0              0.012381765    3.4585933e-11  0              1.6700309e-06  1.1971759e-13  0              3.1503103    
   2000000   12727.922      200            200            0.0042528278   0.00037670521  0              0.012381778    1.421247e-10   0              6.8626931e-06  1.1971759e-13  0              3.1503103    
   2100000   12727.922      200            200            0.0042528271   0.00037670521  0              0.012381776    2.8659906e-11  0              1.3838843e-06  1.1971759e-13  0              3.1503103    
   2200000   12727.922      200            200            0.0042528268   0.00037670521  0              0.012381775    2.0146931e-13  0              9.7282319e-09  1.1971759e-13  0              3.1503103    
   2300000   12727.922      200            200            0.004252827    0.00037670521  0              0.012381776    2.9891116e-13  0              1.443335e-08   1.1971759e-13  0              3.1503103    
   2400000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    7.2514149e-14  0              3.5014487e-09  1.1971759e-13  0              3.1503103    
   2500000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    8.3009553e-16  0              4.0082342e-11  1.1971759e-13  0              3.1503103    
   2600000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    6.7058977e-16  0              3.238038e-11   1.1971759e-13  0              3.1503103    
   2700000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    1.3350336e-16  0              6.4463993e-12  1.1971759e-13  0              3.1503103    
   2800000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    1.0708111e-17  0              5.1705637e-13  1.1971759e-13  0              3.1503103    
   2900000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    1.6554275e-18  0              7.9934671e-14  1.1971759e-13  0              3.1503103    
   3000000   12727.922      200            200            0.0042528269   0.00037670521  0              0.012381776    2.6545645e-18  0              1.2817942e-13  1.1971759e-13  0              3.1503103    
Loop time of 541.36 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4787938.017 ns/day, 0.000 hours/ns, 5541.595 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.391     | 76.353     | 131.57     | 613.8 | 14.10
Neigh   | 5.1335     | 5.1774     | 5.2221     |   1.4 |  0.96
Comm    | 19.161     | 24.954     | 28.869     |  82.0 |  4.61
Output  | 0.47111    | 0.47174    | 0.4724     |   0.1 |  0.09
Modify  | 316.78     | 329.55     | 341.9      |  66.5 | 60.87
Other   |            | 104.9      |            |       | 19.37

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         694.75 ave        1390 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2779
Ave neighs/atom = 0.55568886
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.32                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.1536858129059
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.42
  ghost atom cutoff = 3.42
  binsize = 1.71, bins = 7444 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.8 | 118.8 | 118.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034886929  -1.7770545e-34  0              0.010466079    1316595.8      0              6.3573699e+10  1.1971759e-13  0              3.3290693    
    200000   12727.922      200            200            0.09599722    -0.014098065    0              0.30208973     50449.155      0              2.4360092e+09  1.1971759e-13  0              3.1367056    
    300000   12727.922      200            200            0.00045907947  6.3466327e-36  0              0.0013772384   65115.816      0              3.1442097e+09  1.1971759e-13  0              3.1715812    
    400000   12727.922      200            200           -8.7417979e-05 -2.2847841e-34  0             -0.00026225394  4012.0245      0              1.9372631e+08  1.1971759e-13  0              3.1640635    
    500000   12727.922      200            200            0.00075130439  0.00014736939  0              0.0021065438   242.32693      0              11701100       1.1971759e-13  0              3.1581007    
    600000   12727.922      200            200            0.0059470982   0.00047253791  0              0.017368757    56.215442      0              2714442.5      1.1971759e-13  0              3.154461     
    700000   12727.922      200            200            0.0037063456   0.00032084852  0              0.010798188    10.521704      0              508055.45      1.1971759e-13  0              3.1556294    
    800000   12727.922      200            200            0.0042818992   0.00041931422  0              0.012426383    6.9213743      0              334208.39      1.1971759e-13  0              3.155307     
    900000   12727.922      200            200            0.0043288895   0.00037548606  0              0.012611182    0.27158594     0              13113.913      1.1971759e-13  0              3.1552749    
   1000000   12727.922      200            200            0.0042335542   0.00037864642  0              0.012322016    0.027818345    0              1343.2483      1.1971759e-13  0              3.155329     
   1100000   12727.922      200            200            0.0042599801   0.00037824655  0              0.012401694    0.016772379    0              809.87817      1.1971759e-13  0              3.1553137    
   1200000   12727.922      200            200            0.0042634243   0.00037825162  0              0.012412021    0.00056599092  0              27.329676      1.1971759e-13  0              3.1553119    
   1300000   12727.922      200            200            0.0042586254   0.00037824445  0              0.012397632    7.9299573e-05  0              3.8290926      1.1971759e-13  0              3.1553146    
   1400000   12727.922      200            200            0.0042598753   0.00037824646  0              0.012401379    4.0588018e-05  0              1.9598501      1.1971759e-13  0              3.1553139    
   1500000   12727.922      200            200            0.0042600738   0.00037824677  0              0.012401975    1.1592909e-06  0              0.055978009    1.1971759e-13  0              3.1553138    
   1600000   12727.922      200            200            0.0042598352   0.0003782464   0              0.012401259    2.2224773e-07  0              0.010731547    1.1971759e-13  0              3.1553139    
   1700000   12727.922      200            200            0.0042598937   0.00037824649  0              0.012401434    9.7809722e-08  0              0.0047228814   1.1971759e-13  0              3.1553139    
   1800000   12727.922      200            200            0.0042599049   0.00037824651  0              0.012401468    2.3285232e-09  0              0.00011243605  1.1971759e-13  0              3.1553139    
   1900000   12727.922      200            200            0.004259893    0.00037824649  0              0.012401433    6.1418397e-10  0              2.9656746e-05  1.1971759e-13  0              3.1553139    
   2000000   12727.922      200            200            0.0042598957   0.00037824649  0              0.012401441    2.3469466e-10  0              1.1332565e-05  1.1971759e-13  0              3.1553139    
   2100000   12727.922      200            200            0.0042598963   0.00037824649  0              0.012401443    4.5670246e-12  0              2.2052527e-07  1.1971759e-13  0              3.1553139    
   2200000   12727.922      200            200            0.0042598958   0.00037824649  0              0.012401441    1.6766559e-12  0              8.0959711e-08  1.1971759e-13  0              3.1553139    
   2300000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    5.613212e-13   0              2.7104192e-08  1.1971759e-13  0              3.1553139    
   2400000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    8.5889017e-15  0              4.1472732e-10  1.1971759e-13  0              3.1553139    
   2500000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    4.5160167e-15  0              2.1806229e-10  1.1971759e-13  0              3.1553139    
   2600000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    1.3053815e-15  0              6.3032199e-11  1.1971759e-13  0              3.1553139    
   2700000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    6.6742915e-20  0              3.2227765e-15  1.1971759e-13  0              3.1553139    
   2800000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    2.1420121e-17  0              1.034301e-12   1.1971759e-13  0              3.1553139    
   2900000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    4.4722978e-18  0              2.1595126e-13  1.1971759e-13  0              3.1553139    
   3000000   12727.922      200            200            0.0042598959   0.00037824649  0              0.012401441    1.3391966e-17  0              6.4665011e-13  1.1971759e-13  0              3.1553139    
Loop time of 543.056 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4772992.555 ns/day, 0.000 hours/ns, 5524.297 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.334     | 77.062     | 132.84     | 618.9 | 14.19
Neigh   | 5.1179     | 5.159      | 5.2016     |   1.3 |  0.95
Comm    | 19.087     | 25.094     | 29.248     |  85.3 |  4.62
Output  | 0.50453    | 0.50517    | 0.50583    |   0.1 |  0.09
Modify  | 318.68     | 330.19     | 341.27     |  59.2 | 60.80
Other   |            | 105        |            |       | 19.34

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         699.25 ave        1399 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2797
Ave neighs/atom = 0.55928814
Neighbor list builds = 163
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.33                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.5357410739745
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.43
  ghost atom cutoff = 3.43
  binsize = 1.715, bins = 7422 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.5 | 118.5 | 118.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0034980816   1.2693255e-35  0              0.010494245    1321375.7      0              6.3804506e+10  1.1971759e-13  0              3.3289354    
    200000   12727.922      200            200            0.081637912   -0.012592893    0              0.25750663     128211.5       0              6.1908742e+09  1.1971759e-13  0              3.1435187    
    300000   12727.922      200            200            0.00047320578  1.1785199e-40  0              0.0014196173   68431.524      0              3.3043134e+09  1.1971759e-13  0              3.1747533    
    400000   12727.922      200            200           -7.7179877e-05  2.8893841e-40  0             -0.00023153963  3068.6885      0              1.4817599e+08  1.1971759e-13  0              3.1695291    
    500000   12727.922      200            200            0.00086973267  8.5088026e-05  0              0.00252411     522.23646      0              25216930       1.1971759e-13  0              3.1629327    
    600000   12727.922      200            200            0.0060706118   0.00046850785  0              0.017743328    8.6907982      0              419647.54      1.1971759e-13  0              3.1594069    
    700000   12727.922      200            200            0.0038008203   0.00031957619  0              0.011082885    23.061003      0              1113533.3      1.1971759e-13  0              3.1605805    
    800000   12727.922      200            200            0.0042113044   0.00039661995  0              0.012237293    6.4352251      0              310733.99      1.1971759e-13  0              3.16035      
    900000   12727.922      200            200            0.0043473526   0.0003779809   0              0.012664077    0.041727104    0              2014.8525      1.1971759e-13  0              3.1602721    
   1000000   12727.922      200            200            0.004248419    0.00038069333  0              0.012364564    0.075043459    0              3623.5801      1.1971759e-13  0              3.1603283    
   1100000   12727.922      200            200            0.0042625161   0.00038030573  0              0.012407242    0.01392871     0              672.56758      1.1971759e-13  0              3.1603199    
   1200000   12727.922      200            200            0.0042711986   0.00038032132  0              0.012433274    4.6882294e-06  0              0.22637782     1.1971759e-13  0              3.1603151    
   1300000   12727.922      200            200            0.0042664214   0.00038031338  0              0.012418951    0.00022909212  0              11.062038      1.1971759e-13  0              3.1603178    
   1400000   12727.922      200            200            0.004266833    0.00038031412  0              0.012420185    2.7958551e-05  0              1.3500184      1.1971759e-13  0              3.1603176    
   1500000   12727.922      200            200            0.0042673386   0.00038031502  0              0.012421701    8.2311004e-08  0              0.0039745038   1.1971759e-13  0              3.1603173    
   1600000   12727.922      200            200            0.0042671164   0.00038031463  0              0.012421035    6.4762044e-07  0              0.031271273    1.1971759e-13  0              3.1603174    
   1700000   12727.922      200            200            0.0042671218   0.00038031464  0              0.012421051    5.1596596e-08  0              0.002491415    1.1971759e-13  0              3.1603174    
   1800000   12727.922      200            200            0.0042671499   0.00038031469  0              0.012421135    1.0938664e-09  0              5.2818894e-05  1.1971759e-13  0              3.1603174    
   1900000   12727.922      200            200            0.0042671399   0.00038031467  0              0.012421105    1.7157024e-09  0              8.2845129e-05  1.1971759e-13  0              3.1603174    
   2000000   12727.922      200            200            0.0042671394   0.00038031467  0              0.012421104    8.5258945e-11  0              4.1168493e-06  1.1971759e-13  0              3.1603174    
   2100000   12727.922      200            200            0.0042671409   0.00038031467  0              0.012421108    6.3218826e-12  0              3.0526109e-07  1.1971759e-13  0              3.1603174    
   2200000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    4.2874779e-12  0              2.0702696e-07  1.1971759e-13  0              3.1603174    
   2300000   12727.922      200            200            0.0042671404   0.00038031467  0              0.012421107    1.200382e-13   0              5.7962152e-09  1.1971759e-13  0              3.1603174    
   2400000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    2.6866387e-14  0              1.2972817e-09  1.1971759e-13  0              3.1603174    
   2500000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    1.015112e-14   0              4.9016127e-10  1.1971759e-13  0              3.1603174    
   2600000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    1.295149e-16   0              6.253811e-12   1.1971759e-13  0              3.1603174    
   2700000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    1.3486712e-16  0              6.5122507e-12  1.1971759e-13  0              3.1603174    
   2800000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    5.4264647e-19  0              2.6202456e-14  1.1971759e-13  0              3.1603174    
   2900000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    1.5556197e-17  0              7.5115306e-13  1.1971759e-13  0              3.1603174    
   3000000   12727.922      200            200            0.0042671405   0.00038031467  0              0.012421107    2.097381e-18   0              1.0127502e-13  1.1971759e-13  0              3.1603174    
Loop time of 539.812 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4801675.630 ns/day, 0.000 hours/ns, 5557.495 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.382     | 75.172     | 128.19     | 601.1 | 13.93
Neigh   | 5.0779     | 5.1183     | 5.1593     |   1.3 |  0.95
Comm    | 18.894     | 25.802     | 30.99      | 100.2 |  4.78
Output  | 0.43847    | 0.4391     | 0.43975    |   0.1 |  0.08
Modify  | 316.16     | 329.06     | 341.05     |  66.0 | 60.96
Other   |            | 104.2      |            |       | 19.31

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         654.75 ave        1310 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2619
Ave neighs/atom = 0.52369526
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.34                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 42.920097865821
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.44
  ghost atom cutoff = 3.44
  binsize = 1.72, bins = 7400 117 117
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 118.2 | 118.2 | 118.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035074708   3.4890084e-42  0              0.010522412    1326162.3      0              6.4035629e+10  1.1971759e-13  0              3.3287896    
    200000   12727.922      200            200            0.062782478   -0.012084924    0              0.20043236     216793.68      0              1.0468191e+10  1.1971759e-13  0              3.1510769    
    300000   12727.922      200            200            0.00048743693  2.538656e-35   0              0.0014623108   71825.649      0              3.4682035e+09  1.1971759e-13  0              3.1778775    
    400000   12727.922      200            200           -6.6750876e-05  5.077311e-35   0             -0.00020025263  2252.7146      0              1.0877552e+08  1.1971759e-13  0              3.1749334    
    500000   12727.922      200            200            0.0010766898   9.0517657e-05  0              0.0031395516   886.92117      0              42826249       1.1971759e-13  0              3.167701     
    600000   12727.922      200            200            0.006086682    0.00046226802  0              0.017797778    3.1415863      0              151695.96      1.1971759e-13  0              3.1644037    
    700000   12727.922      200            200            0.0039354217   0.0003425861   0              0.011463679    36.357224      0              1755560.2      1.1971759e-13  0              3.1655132    
    800000   12727.922      200            200            0.0041496057   0.00038153492  0              0.012067282    4.8302734      0              233236.62      1.1971759e-13  0              3.1653897    
    900000   12727.922      200            200            0.0043560696   0.00038193222  0              0.012686276    0.018921029    0              913.62877      1.1971759e-13  0              3.165275     
   1000000   12727.922      200            200            0.0042668959   0.00038475383  0              0.012415934    0.1144445      0              5526.1154      1.1971759e-13  0              3.1653259    
   1100000   12727.922      200            200            0.0042665915   0.00038436515  0              0.012415409    0.0071145595   0              343.53662      1.1971759e-13  0              3.1653256    
   1200000   12727.922      200            200            0.0042787294   0.00038439917  0              0.012451789    0.0003944779   0              19.047926      1.1971759e-13  0              3.1653189    
   1300000   12727.922      200            200            0.0042750762   0.00038438994  0              0.012440839    0.00030104387  0              14.536331      1.1971759e-13  0              3.1653209    
   1400000   12727.922      200            200            0.0042745538   0.00038438857  0              0.012439273    6.7246865e-06  0              0.32471105     1.1971759e-13  0              3.1653212    
   1500000   12727.922      200            200            0.0042752027   0.00038439029  0              0.012441218    2.3830545e-06  0              0.11506917     1.1971759e-13  0              3.1653209    
   1600000   12727.922      200            200            0.0042750762   0.00038438995  0              0.012440839    6.6619428e-07  0              0.032168138    1.1971759e-13  0              3.1653209    
   1700000   12727.922      200            200            0.0042750274   0.00038438983  0              0.012440692    1.6116949e-09  0              7.7822978e-05  1.1971759e-13  0              3.165321     
   1800000   12727.922      200            200            0.0042750592   0.00038438991  0              0.012440788    9.4926284e-09  0              0.00045836505  1.1971759e-13  0              3.1653209    
   1900000   12727.922      200            200            0.0042750561   0.0003843899   0              0.012440778    1.2199217e-09  0              5.8905655e-05  1.1971759e-13  0              3.1653209    
   2000000   12727.922      200            200            0.0042750528   0.00038438989  0              0.012440768    6.2210296e-12  0              3.0039126e-07  1.1971759e-13  0              3.1653209    
   2100000   12727.922      200            200            0.0042750542   0.0003843899   0              0.012440773    2.9657698e-11  0              1.4320641e-06  1.1971759e-13  0              3.1653209    
   2200000   12727.922      200            200            0.0042750542   0.0003843899   0              0.012440773    1.7315712e-12  0              8.3611377e-08  1.1971759e-13  0              3.1653209    
   2300000   12727.922      200            200            0.004275054    0.0003843899   0              0.012440772    1.1025613e-13  0              5.3238739e-09  1.1971759e-13  0              3.1653209    
   2400000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    7.6990811e-14  0              3.7176107e-09  1.1971759e-13  0              3.1653209    
   2500000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    1.5987285e-15  0              7.7196878e-11  1.1971759e-13  0              3.1653209    
   2600000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    6.4831077e-16  0              3.1304607e-11  1.1971759e-13  0              3.1653209    
   2700000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    1.140904e-16   0              5.5090172e-12  1.1971759e-13  0              3.1653209    
   2800000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    1.5268081e-17  0              7.3724098e-13  1.1971759e-13  0              3.1653209    
   2900000   12727.922      200            200            0.0042750541   0.0003843899   0              0.012440772    2.1867521e-18  0              1.0559043e-13  1.1971759e-13  0              3.1653209    
   3000000   12727.922      200            200            0.0042750541   0.00038438989  0              0.012440772    2.7986361e-19  0              1.3513612e-14  1.1971759e-13  0              3.1653209    
Loop time of 538.408 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4814189.897 ns/day, 0.000 hours/ns, 5571.979 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.502     | 75.748     | 129.44     | 606.7 | 14.07
Neigh   | 4.9504     | 4.9901     | 5.0307     |   1.3 |  0.93
Comm    | 18.611     | 24.794     | 29.466     |  86.4 |  4.61
Output  | 0.4335     | 0.43415    | 0.43482    |   0.1 |  0.08
Modify  | 315.19     | 327.85     | 340.52     |  65.8 | 60.89
Other   |            | 104.6      |            |       | 19.43

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         661.25 ave        1323 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2645
Ave neighs/atom = 0.52889422
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.35                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.3067630999496
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.45
  ghost atom cutoff = 3.45
  binsize = 1.725, bins = 7379 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 116.2 | 116.2 | 116.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035168606   1.7770557e-34  0              0.010550582    1330955.3      0              6.4267069e+10  1.1971759e-13  0              3.3286317    
    200000   12727.922      200            200            0.045726859   -0.0027741399   0              0.13995472     295184.79      0              1.4253417e+10  1.1971759e-13  0              3.1592084    
    300000   12727.922      200            200            0.00050177216  2.4174917e-40  0              0.0015053165   75297.932      0              3.6358676e+09  1.1971759e-13  0              3.1809538    
    400000   12727.922      200            200           -5.6132367e-05 -1.0154518e-34  0             -0.0001683971   1563.5335      0              75497439       1.1971759e-13  0              3.1802765    
    500000   12727.922      200            200            0.0013394091   2.5916336e-05  0              0.0039923111   1310.2959      0              63269500       1.1971759e-13  0              3.1724092    
    600000   12727.922      200            200            0.0059971503   0.00046392565  0              0.017527525    40.676968      0              1964145.2      1.1971759e-13  0              3.1694517    
    700000   12727.922      200            200            0.004091451    0.00035474974  0              0.011919603    46.74147       0              2256978.3      1.1971759e-13  0              3.1704327    
    800000   12727.922      200            200            0.0041007479   0.00036812071  0              0.011934123    2.7190294      0              131292.2       1.1971759e-13  0              3.1704226    
    900000   12727.922      200            200            0.0043546451   0.00038652074  0              0.012677415    0.21262832     0              10267.061      1.1971759e-13  0              3.1702836    
   1000000   12727.922      200            200            0.0042868402   0.0003892936   0              0.012471227    0.12252946     0              5916.5093      1.1971759e-13  0              3.1703227    
   1100000   12727.922      200            200            0.0042724315   0.00038894699  0              0.012428348    0.0012216633   0              58.989748      1.1971759e-13  0              3.1703304    
   1200000   12727.922      200            200            0.004285612    0.00038900398  0              0.012467832    0.0013955045   0              67.383917      1.1971759e-13  0              3.170323     
   1300000   12727.922      200            200            0.0042839019   0.00038899712  0              0.012462709    0.00022497516  0              10.863245      1.1971759e-13  0              3.170324     
   1400000   12727.922      200            200            0.0042826035   0.00038899194  0              0.012458818    7.7216951e-07  0              0.037285302    1.1971759e-13  0              3.1703248    
   1500000   12727.922      200            200            0.0042831913   0.00038899433  0              0.012460579    5.0914445e-06  0              0.24584763     1.1971759e-13  0              3.1703244    
   1600000   12727.922      200            200            0.0042832035   0.00038899437  0              0.012460616    2.5439855e-07  0              0.012283995    1.1971759e-13  0              3.1703244    
   1700000   12727.922      200            200            0.0042831212   0.00038899404  0              0.01246037     2.6854283e-08  0              0.0012966972   1.1971759e-13  0              3.1703245    
   1800000   12727.922      200            200            0.0042831423   0.00038899413  0              0.012460433    1.2752766e-08  0              0.00061578542  1.1971759e-13  0              3.1703245    
   1900000   12727.922      200            200            0.0042831475   0.00038899415  0              0.012460448    8.3617903e-11  0              4.0376093e-06  1.1971759e-13  0              3.1703245    
   2000000   12727.922      200            200            0.0042831432   0.00038899413  0              0.012460436    1.5981359e-10  0              7.7168261e-06  1.1971759e-13  0              3.1703245    
   2100000   12727.922      200            200            0.0042831437   0.00038899413  0              0.012460437    2.2228925e-11  0              1.0733553e-06  1.1971759e-13  0              3.1703245    
   2200000   12727.922      200            200            0.0042831441   0.00038899413  0              0.012460438    1.5806152e-13  0              7.6322249e-09  1.1971759e-13  0              3.1703245    
   2300000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    5.517289e-13   0              2.6641014e-08  1.1971759e-13  0              3.1703245    
   2400000   12727.922      200            200            0.0042831439   0.00038899413  0              0.012460438    2.2612019e-14  0              1.0918535e-09  1.1971759e-13  0              3.1703245    
   2500000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    3.4840756e-15  0              1.6823354e-10  1.1971759e-13  0              3.1703245    
   2600000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    1.2758719e-15  0              6.1607288e-11  1.1971759e-13  0              3.1703245    
   2700000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    7.5469939e-18  0              3.6441732e-13  1.1971759e-13  0              3.1703245    
   2800000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    1.1446953e-17  0              5.5273239e-13  1.1971759e-13  0              3.1703245    
   2900000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    6.1032527e-18  0              2.9470423e-13  1.1971759e-13  0              3.1703245    
   3000000   12727.922      200            200            0.004283144    0.00038899413  0              0.012460438    1.3610224e-17  0              6.5718903e-13  1.1971759e-13  0              3.1703245    
Loop time of 540.297 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4797364.225 ns/day, 0.000 hours/ns, 5552.505 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.417     | 75.178     | 128.76     | 604.4 | 13.91
Neigh   | 4.6895     | 4.7325     | 4.7764     |   1.4 |  0.88
Comm    | 17.946     | 24.809     | 29.948     | 106.0 |  4.59
Output  | 0.39663    | 0.39728    | 0.39794    |   0.1 |  0.07
Modify  | 318.64     | 330.99     | 342.85     |  62.6 | 61.26
Other   |            | 104.2      |            |       | 19.28

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         666.75 ave        1334 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2667
Ave neighs/atom = 0.53329334
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.36                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 43.6957436878637
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.46
  ghost atom cutoff = 3.46
  binsize = 1.73, bins = 7358 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.9 | 115.9 | 115.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035262508   4.8488841e-42  0              0.010578753    1335755        0              6.4498826e+10  1.1971759e-13  0              3.3284619    
    200000   12727.922      200            200            0.028652988    0.001453037    0              0.084505927    350117.35      0              1.6905914e+10  1.1971759e-13  0              3.1677303    
    300000   12727.922      200            200            0.00051621057  7.615961e-35   0              0.0015486317   78848.072      0              3.8072912e+09  1.1971759e-13  0              3.1839821    
    400000   12727.922      200            200           -4.5325898e-05  2.5386662e-35  0             -0.00013597769  1000.5899      0              48314906       1.1971759e-13  0              3.1855581    
    500000   12727.922      200            200            0.0017547021   0.00013800141  0              0.0051261049   1757.0641      0              84842338       1.1971759e-13  0              3.1770625    
    600000   12727.922      200            200            0.005804004    0.00045615474  0              0.016955857    112.17774      0              5416661.6      1.1971759e-13  0              3.1745481    
    700000   12727.922      200            200            0.0042598305   0.00035636807  0              0.012423123    51.263895      0              2475350        1.1971759e-13  0              3.1753446    
    800000   12727.922      200            200            0.0040660973   0.0003465675   0              0.011851725    0.89208074     0              43075.387      1.1971759e-13  0              3.175446     
    900000   12727.922      200            200            0.0043445099   0.00039236392  0              0.012641166    0.5266049      0              25427.866      1.1971759e-13  0              3.1752974    
   1000000   12727.922      200            200            0.0043065575   0.00039475048  0              0.012524922    0.094564993    0              4566.2051      1.1971759e-13  0              3.1753198    
   1100000   12727.922      200            200            0.0042805694   0.00039440087  0              0.012447307    0.00043374561  0              20.944023      1.1971759e-13  0              3.1753341    
   1200000   12727.922      200            200            0.0042922312   0.00039447267  0              0.012482221    0.0021572114   0              104.16402      1.1971759e-13  0              3.1753275    
   1300000   12727.922      200            200            0.0042928195   0.0003944757   0              0.012483983    7.6223186e-05  0              3.6805449      1.1971759e-13  0              3.1753272    
   1400000   12727.922      200            200            0.0042911072   0.00039446594  0              0.012478856    1.656258e-05   0              0.79974773     1.1971759e-13  0              3.1753282    
   1500000   12727.922      200            200            0.0042914533   0.00039446797  0              0.012479892    4.7627595e-06  0              0.22997661     1.1971759e-13  0              3.175328     
   1600000   12727.922      200            200            0.0042915973   0.00039446878  0              0.012480323    2.3356944e-11  0              1.1278232e-06  1.1971759e-13  0              3.1753279    
   1700000   12727.922      200            200            0.0042915151   0.00039446831  0              0.012480077    8.6582406e-08  0              0.0041807545   1.1971759e-13  0              3.175328     
   1800000   12727.922      200            200            0.0042915162   0.00039446832  0              0.01248008     5.239271e-09   0              0.00025298565  1.1971759e-13  0              3.175328     
   1900000   12727.922      200            200            0.0042915269   0.00039446838  0              0.012480112    4.6425987e-10  0              2.2417447e-05  1.1971759e-13  0              3.1753279    
   2000000   12727.922      200            200            0.0042915241   0.00039446836  0              0.012480104    2.2701327e-10  0              1.0961658e-05  1.1971759e-13  0              3.175328     
   2100000   12727.922      200            200            0.0042915234   0.00039446836  0              0.012480102    7.17232e-13    0              3.4632567e-08  1.1971759e-13  0              3.175328     
   2200000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    3.2880298e-12  0              1.5876719e-07  1.1971759e-13  0              3.175328     
   2300000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    3.1718179e-13  0              1.5315573e-08  1.1971759e-13  0              3.175328     
   2400000   12727.922      200            200            0.0042915238   0.00039446836  0              0.012480103    1.0856876e-14  0              5.2423967e-10  1.1971759e-13  0              3.175328     
   2500000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    1.0291018e-14  0              4.9691644e-10  1.1971759e-13  0              3.175328     
   2600000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    1.2023251e-16  0              5.8055975e-12  1.1971759e-13  0              3.175328     
   2700000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    1.5574537e-16  0              7.5203866e-12  1.1971759e-13  0              3.175328     
   2800000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    1.0144654e-19  0              4.8984905e-15  1.1971759e-13  0              3.175328     
   2900000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    1.2666727e-17  0              6.116309e-13   1.1971759e-13  0              3.175328     
   3000000   12727.922      200            200            0.0042915239   0.00039446836  0              0.012480103    6.5536664e-18  0              3.164531e-13   1.1971759e-13  0              3.175328     
Loop time of 539.278 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4806428.105 ns/day, 0.000 hours/ns, 5562.995 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.452     | 75.817     | 130.06     | 608.8 | 14.06
Neigh   | 4.7255     | 4.766      | 4.8073     |   1.3 |  0.88
Comm    | 18.645     | 24.436     | 28.487     |  78.3 |  4.53
Output  | 0.44107    | 0.44169    | 0.44234    |   0.1 |  0.08
Modify  | 314.97     | 328.54     | 341.36     |  69.4 | 60.92
Other   |            | 105.3      |            |       | 19.52

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         672.25 ave        1345 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2689
Ave neighs/atom = 0.53769246
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.37                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.0870465410674
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.47
  ghost atom cutoff = 3.47
  binsize = 1.735, bins = 7336 116 116
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 115.6 | 115.6 | 115.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035356415  -1.2693249e-33  0              0.010606925    1340561.1      0              6.4730899e+10  1.1971759e-13  0              3.3282801    
    200000   12727.922      200            200            0.01316397    -0.00091594529  0              0.040407856    378319.77      0              1.8267708e+10  1.1971759e-13  0              3.1764745    
    300000   12727.922      200            200            0.00053075145 -7.1082188e-34  0              0.0015922544   82475.826      0              3.9824625e+09  1.1971759e-13  0              3.1869623    
    400000   12727.922      200            200           -3.4332814e-05  1.6987071e-40  0             -0.00010299844  563.31922      0              27200669       1.1971759e-13  0              3.1907783    
    500000   12727.922      200            200            0.0022394095   0.00013896914  0              0.0065792593   2183.1647      0              1.0541721e+08  1.1971759e-13  0              3.1816682    
    600000   12727.922      200            200            0.0055249188   0.00044351665  0              0.01613124     200.76075      0              9694018.1      1.1971759e-13  0              3.1796873    
    700000   12727.922      200            200            0.0044340834   0.00036138956  0              0.012940861    48.545582      0              2344092.4      1.1971759e-13  0              3.1802556    
    800000   12727.922      200            200            0.004058086    0.00034516591  0              0.011829092    0.02321444     0              1120.9422      1.1971759e-13  0              3.180458     
    900000   12727.922      200            200            0.0043270835   0.00039654563  0              0.012584705    0.80683995     0              38959.413      1.1971759e-13  0              3.1803149    
   1000000   12727.922      200            200            0.0043234871   0.0003987339   0              0.012571727    0.047277917    0              2282.8814      1.1971759e-13  0              3.1803182    
   1100000   12727.922      200            200            0.0042902583   0.00039836214  0              0.012472413    0.0052608654   0              254.02836      1.1971759e-13  0              3.1803366    
   1200000   12727.922      200            200            0.0042981863   0.00039842193  0              0.012496137    0.0020394218   0              98.47638       1.1971759e-13  0              3.1803321    
   1300000   12727.922      200            200            0.0043008944   0.00039844058  0              0.012504243    4.3046255e-08  0              0.0020785496   1.1971759e-13  0              3.1803306    
   1400000   12727.922      200            200            0.0042992331   0.00039842894  0              0.01249927     3.6223161e-05  0              1.7490868      1.1971759e-13  0              3.1803315    
   1500000   12727.922      200            200            0.0042992355   0.00039842902  0              0.012499278    1.8328446e-06  0              0.088501507    1.1971759e-13  0              3.1803315    
   1600000   12727.922      200            200            0.0042994581   0.00039843058  0              0.012499944    2.6000363e-07  0              0.012554645    1.1971759e-13  0              3.1803314    
   1700000   12727.922      200            200            0.0042994087   0.00039843022  0              0.012499796    8.6513234e-08  0              0.0041774145   1.1971759e-13  0              3.1803314    
   1800000   12727.922      200            200            0.0042993897   0.00039843009  0              0.012499739    1.3455182e-11  0              6.4970257e-07  1.1971759e-13  0              3.1803314    
   1900000   12727.922      200            200            0.0042994005   0.00039843017  0              0.012499771    1.6243937e-09  0              7.8436158e-05  1.1971759e-13  0              3.1803314    
   2000000   12727.922      200            200            0.0042994007   0.00039843017  0              0.012499772    7.0340554e-11  0              3.3964936e-06  1.1971759e-13  0              3.1803314    
   2100000   12727.922      200            200            0.0042993992   0.00039843016  0              0.012499767    1.2706379e-11  0              6.1354559e-07  1.1971759e-13  0              3.1803314    
   2200000   12727.922      200            200            0.0042993995   0.00039843016  0              0.012499768    3.6525086e-12  0              1.7636657e-07  1.1971759e-13  0              3.1803314    
   2300000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    3.4083925e-15  0              1.6457908e-10  1.1971759e-13  0              3.1803314    
   2400000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    7.266086e-14   0              3.5085329e-09  1.1971759e-13  0              3.1803314    
   2500000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    2.6203252e-15  0              1.2652613e-10  1.1971759e-13  0              3.1803314    
   2600000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    6.4542328e-16  0              3.116518e-11   1.1971759e-13  0              3.1803314    
   2700000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    9.0637113e-17  0              4.3765418e-12  1.1971759e-13  0              3.1803314    
   2800000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    2.2261464e-17  0              1.0749264e-12  1.1971759e-13  0              3.1803314    
   2900000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    4.3988948e-18  0              2.1240689e-13  1.1971759e-13  0              3.1803314    
   3000000   12727.922      200            200            0.0042993996   0.00039843016  0              0.012499769    1.0169973e-18  0              4.910716e-14   1.1971759e-13  0              3.1803314    
Loop time of 540.9 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4792010.630 ns/day, 0.000 hours/ns, 5546.309 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.424     | 75.738     | 129.38     | 606.5 | 14.00
Neigh   | 4.7604     | 4.8048     | 4.8498     |   1.4 |  0.89
Comm    | 18.175     | 25.339     | 30.551     | 100.9 |  4.68
Output  | 0.45409    | 0.45474    | 0.45542    |   0.1 |  0.08
Modify  | 316.77     | 329.21     | 342.58     |  64.3 | 60.86
Other   |            | 105.4      |            |       | 19.48

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         676.75 ave        1354 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2707
Ave neighs/atom = 0.54129174
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.38                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.4806785710646
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.48
  ghost atom cutoff = 3.48
  binsize = 1.74, bins = 7315 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 113.6 | 113.6 | 113.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035450326   1.8094803e-40  0              0.010635098    1345373.8      0              6.4963288e+10  1.1971759e-13  0              3.3280862    
    200000   12727.922      200            200            0.0041696492   0.0010778177   0              0.01143113     384619.96      0              1.8571921e+10  1.1971759e-13  0              3.1853066    
    300000   12727.922      200            200            0.00054765923  3.8357723e-07  0              0.0016425941   86180.866      0              4.1613656e+09  1.1971759e-13  0              3.1898944    
    400000   12727.922      200            200           -2.3154636e-05 -2.0309169e-34  0             -6.9463907e-05  251.16872      0              12128038       1.1971759e-13  0              3.195937     
    500000   12727.922      200            200            0.0028521017   0.00017550802  0              0.0083807971   2538.0835      0              1.2255497e+08  1.1971759e-13  0              3.1862353    
    600000   12727.922      200            200            0.0051893327   0.00044800487  0              0.015119993    286.22475      0              13820769       1.1971759e-13  0              3.1848614    
    700000   12727.922      200            200            0.0046094756   0.00039192114  0              0.013436506    39.245598      0              1895029.5      1.1971759e-13  0              3.1851724    
    800000   12727.922      200            200            0.0040724017   0.00034723921  0              0.011869966    0.42527256     0              20534.89       1.1971759e-13  0              3.1854578    
    900000   12727.922      200            200            0.0043058703   0.00039989392  0              0.012517717    0.91718424     0              44287.545      1.1971759e-13  0              3.1853344    
   1000000   12727.922      200            200            0.0043362775   0.00040143021  0              0.012607402    0.0088095304   0              425.3807       1.1971759e-13  0              3.1853186    
   1100000   12727.922      200            200            0.0043012756   0.00040118068  0              0.012502646    0.012217019    0              589.91615      1.1971759e-13  0              3.1853381    
   1200000   12727.922      200            200            0.0043040216   0.00040120515  0              0.01251086     0.0011454612   0              55.310223      1.1971759e-13  0              3.1853365    
   1300000   12727.922      200            200            0.0043081915   0.00040123876  0              0.012523336    6.9530124e-05  0              3.3573608      1.1971759e-13  0              3.1853342    
   1400000   12727.922      200            200            0.0043070215   0.00040122926  0              0.012519835    3.7797277e-05  0              1.8250953      1.1971759e-13  0              3.1853348    
   1500000   12727.922      200            200            0.0043066865   0.00040122662  0              0.012518833    3.8662438e-09  0              0.00018668708  1.1971759e-13  0              3.185335     
   1600000   12727.922      200            200            0.004306908    0.00040122841  0              0.012519496    6.6191374e-07  0              0.031961446    1.1971759e-13  0              3.1853349    
   1700000   12727.922      200            200            0.0043069104   0.00040122842  0              0.012519503    2.7140415e-08  0              0.0013105135   1.1971759e-13  0              3.1853349    
   1800000   12727.922      200            200            0.0043068802   0.00040122818  0              0.012519412    6.0181905e-09  0              0.00029059688  1.1971759e-13  0              3.1853349    
   1900000   12727.922      200            200            0.0043068857   0.00040122823  0              0.012519429    1.3715474e-09  0              6.6227115e-05  1.1971759e-13  0              3.1853349    
   2000000   12727.922      200            200            0.0043068887   0.00040122825  0              0.012519438    1.0875194e-11  0              5.2512418e-07  1.1971759e-13  0              3.1853349    
   2100000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    3.1426475e-11  0              1.517472e-06   1.1971759e-13  0              3.1853349    
   2200000   12727.922      200            200            0.0043068872   0.00040122824  0              0.012519433    4.0342318e-13  0              1.9479862e-08  1.1971759e-13  0              3.1853349    
   2300000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    3.975138e-13   0              1.9194519e-08  1.1971759e-13  0              3.1853349    
   2400000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    4.3450583e-14  0              2.0980732e-09  1.1971759e-13  0              3.1853349    
   2500000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    1.963301e-15   0              9.480078e-11   1.1971759e-13  0              3.1853349    
   2600000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    1.3130304e-15  0              6.3401537e-11  1.1971759e-13  0              3.1853349    
   2700000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    1.2445868e-17  0              6.0096641e-13  1.1971759e-13  0              3.1853349    
   2800000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    6.9445785e-18  0              3.3532884e-13  1.1971759e-13  0              3.1853349    
   2900000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    6.9744312e-18  0              3.3677032e-13  1.1971759e-13  0              3.1853349    
   3000000   12727.922      200            200            0.0043068874   0.00040122824  0              0.012519434    8.9725145e-18  0              4.3325062e-13  1.1971759e-13  0              3.1853349    
Loop time of 540.192 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4798294.597 ns/day, 0.000 hours/ns, 5553.582 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.316     | 75.711     | 129.85     | 607.5 | 14.02
Neigh   | 4.6329     | 4.6781     | 4.7245     |   1.5 |  0.87
Comm    | 18.005     | 24.222     | 28.522     |  88.3 |  4.48
Output  | 0.44962    | 0.45025    | 0.4509     |   0.1 |  0.08
Modify  | 318.29     | 330.83     | 343.5      |  66.2 | 61.24
Other   |            | 104.3      |            |       | 19.31

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         682.25 ave        1365 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2729
Ave neighs/atom = 0.54569086
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.39                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 44.8766466893589
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.49
  ghost atom cutoff = 3.49
  binsize = 1.745, bins = 7294 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 113.3 | 113.3 | 113.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003554424    1.2136611e-40  0              0.010663272    1350193.1      0              6.5195993e+10  1.1971759e-13  0              3.3278803    
    200000   12727.922      200            200           -0.00026443081  2.1432983e-05  0             -0.00081472541  378271.07      0              1.8265356e+10  1.1971759e-13  0              3.1941384    
    300000   12727.922      200            200            0.0014889583  -5.9846365e-05  0              0.0045267214   89625.567      0              4.3276979e+09  1.1971759e-13  0              3.1927792    
    400000   12727.922      200            200           -1.1792812e-05  4.9650995e-40  0             -3.5378436e-05  63.583856      0              3070236.8      1.1971759e-13  0              3.2010341    
    500000   12727.922      200            200            0.0035971982   0.00025120413  0              0.01054039     2769.6367      0              1.3373584e+08  1.1971759e-13  0              3.1907752    
    600000   12727.922      200            200            0.004823171    0.00047087617  0              0.013998637    350.07248      0              16903747       1.1971759e-13  0              3.1900606    
    700000   12727.922      200            200            0.0047578867   0.00040199288  0              0.013871667    25.96339       0              1253679.2      1.1971759e-13  0              3.1901014    
    800000   12727.922      200            200            0.0041076797   0.00035049474  0              0.011972545    1.9400309      0              93677.149      1.1971759e-13  0              3.1904458    
    900000   12727.922      200            200            0.004285254    0.00040464894  0              0.012451113    0.80514038     0              38877.348      1.1971759e-13  0              3.190354     
   1000000   12727.922      200            200            0.0043444969   0.00040406634  0              0.012629424    0.0019367525   0              93.518848      1.1971759e-13  0              3.1903216    
   1100000   12727.922      200            200            0.0043132934   0.00040384292  0              0.012536037    0.016328429    0              788.44139      1.1971759e-13  0              3.190339     
   1200000   12727.922      200            200            0.004310435    0.00040382013  0              0.012527485    0.00022674189  0              10.948554      1.1971759e-13  0              3.1903405    
   1300000   12727.922      200            200            0.0043150908   0.00040385922  0              0.012541413    0.00021578704  0              10.419584      1.1971759e-13  0              3.1903379    
   1400000   12727.922      200            200            0.0043147118   0.00040385591  0              0.012540279    1.9635525e-05  0              0.94812925     1.1971759e-13  0              3.1903381    
   1500000   12727.922      200            200            0.0043141487   0.00040385129  0              0.012538595    1.5519681e-06  0              0.074938987    1.1971759e-13  0              3.1903385    
   1600000   12727.922      200            200            0.004314292    0.00040385249  0              0.012539023    6.3887488e-07  0              0.030848982    1.1971759e-13  0              3.1903384    
   1700000   12727.922      200            200            0.0043143441   0.00040385292  0              0.012539179    1.3107978e-09  0              6.3293734e-05  1.1971759e-13  0              3.1903383    
   1800000   12727.922      200            200            0.0043143163   0.00040385269  0              0.012539096    1.2828849e-08  0              0.00061945923  1.1971759e-13  0              3.1903384    
   1900000   12727.922      200            200            0.0043143138   0.00040385267  0              0.012539089    1.8804118e-10  0              9.0798354e-06  1.1971759e-13  0              3.1903384    
   2000000   12727.922      200            200            0.004314318    0.0004038527   0              0.012539101    1.6796524e-10  0              8.1104404e-06  1.1971759e-13  0              3.1903384    
   2100000   12727.922      200            200            0.0043143176   0.0004038527   0              0.0125391      1.5733443e-11  0              7.5971165e-07  1.1971759e-13  0              3.1903384    
   2200000   12727.922      200            200            0.0043143171   0.00040385269  0              0.012539099    1.1868375e-12  0              5.7308135e-08  1.1971759e-13  0              3.1903384    
   2300000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    5.0646152e-13  0              2.4455214e-08  1.1971759e-13  0              3.1903384    
   2400000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    9.7252708e-16  0              4.6959852e-11  1.1971759e-13  0              3.1903384    
   2500000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    1.0100514e-14  0              4.8771767e-10  1.1971759e-13  0              3.1903384    
   2600000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    1.1150875e-16  0              5.3843584e-12  1.1971759e-13  0              3.1903384    
   2700000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    1.7485295e-16  0              8.4430233e-12  1.1971759e-13  0              3.1903384    
   2800000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    3.6602077e-18  0              1.7673833e-13  1.1971759e-13  0              3.1903384    
   2900000   12727.922      200            200            0.0043143173   0.0004038527   0              0.012539099    7.8776857e-18  0              3.8038525e-13  1.1971759e-13  0              3.1903384    
   3000000   12727.922      200            200            0.0043143173   0.00040385269  0              0.012539099    1.5262341e-17  0              7.3696382e-13  1.1971759e-13  0              3.1903384    
Loop time of 541.178 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4789552.918 ns/day, 0.000 hours/ns, 5543.464 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.463     | 76.187     | 130.53     | 611.7 | 14.08
Neigh   | 4.6964     | 4.7419     | 4.7879     |   1.5 |  0.88
Comm    | 17.981     | 24.894     | 30.26      | 106.6 |  4.60
Output  | 0.43264    | 0.43326    | 0.43391    |   0.1 |  0.08
Modify  | 319.09     | 330.56     | 341.68     |  57.5 | 61.08
Other   |            | 104.4      |            |       | 19.28

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         686.75 ave        1374 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2747
Ave neighs/atom = 0.54929014
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.4                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.2749578074541
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.5
  ghost atom cutoff = 3.5
  binsize = 1.75, bins = 7274 115 115
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 113 | 113 | 113.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035638157   9.0931141e-41  0              0.010691447    1355018.9      0              6.5429013e+10  1.1971759e-13  0              3.3276622    
    200000   12727.922      200            200           -0.00041575705 -1.0154562e-34  0             -0.0012472711   368911.71      0              1.7813426e+10  1.1971759e-13  0              3.2029314    
    300000   12727.922      200            200            0.0042900895   0.00011374511  0              0.012756523    91231.171      0              4.4052267e+09  1.1971759e-13  0              3.1956292    
    400000   12727.922      200            200           -2.487108e-07   2.5386578e-35  0             -7.461324e-07   0.012367451    0              597.17996      1.1971759e-13  0              3.2060695    
    500000   12727.922      200            200            0.0044704821   0.00038577652  0              0.01302567     2832.4636      0              1.3676953e+08  1.1971759e-13  0              3.1953016    
    600000   12727.922      200            200            0.0044163427   0.00040666875  0              0.012842359    379.6217       0              18330573       1.1971759e-13  0              3.1952739    
    700000   12727.922      200            200            0.004879354    0.00042674632  0              0.014211316    12.548197      0              605907.51      1.1971759e-13  0              3.1950481    
    800000   12727.922      200            200            0.0041614107   0.00035458499  0              0.012129647    3.9977753      0              193038.26      1.1971759e-13  0              3.1954236    
    900000   12727.922      200            200            0.0042688314   0.0004108669   0              0.012395627    0.52604594     0              25400.876      1.1971759e-13  0              3.1953715    
   1000000   12727.922      200            200            0.0043486433   0.00040854188  0              0.012637388    0.030549219    0              1475.1125      1.1971759e-13  0              3.1953271    
   1100000   12727.922      200            200            0.0043261363   0.00040837985  0              0.012570029    0.014669586    0              708.34179      1.1971759e-13  0              3.1953398    
   1200000   12727.922      200            200            0.0043183338   0.0004083161   0              0.012546685    4.9187997e-05  0              2.3751124      1.1971759e-13  0              3.195344     
   1300000   12727.922      200            200            0.0043224132   0.00040835081  0              0.012558889    0.00029627637  0              14.306126      1.1971759e-13  0              3.1953418    
   1400000   12727.922      200            200            0.0043229081   0.00040835472  0              0.01256037     1.9400807e-06  0              0.093679554    1.1971759e-13  0              3.1953415    
   1500000   12727.922      200            200            0.0043222932   0.00040834963  0              0.01255853     4.5043041e-06  0              0.21749673     1.1971759e-13  0              3.1953419    
   1600000   12727.922      200            200            0.0043223101   0.00040834979  0              0.012558581    2.2552455e-07  0              0.010889773    1.1971759e-13  0              3.1953418    
   1700000   12727.922      200            200            0.0043223904   0.00040835046  0              0.012558821    4.8650307e-08  0              0.0023491492   1.1971759e-13  0              3.1953418    
   1800000   12727.922      200            200            0.0043223772   0.00040835034  0              0.012558781    8.7769461e-09  0              0.00042380732  1.1971759e-13  0              3.1953418    
   1900000   12727.922      200            200            0.0043223682   0.00040835027  0              0.012558754    2.8593144e-10  0              1.3806606e-05  1.1971759e-13  0              3.1953418    
   2000000   12727.922      200            200            0.0043223712   0.0004083503   0              0.012558763    2.2120545e-10  0              1.068122e-05   1.1971759e-13  0              3.1953418    
   2100000   12727.922      200            200            0.004322372    0.0004083503   0              0.012558766    6.4096819e-14  0              3.095006e-09   1.1971759e-13  0              3.1953418    
   2200000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    4.1271141e-12  0              1.9928357e-07  1.1971759e-13  0              3.1953418    
   2300000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    5.7952176e-14  0              2.7983032e-09  1.1971759e-13  0              3.1953418    
   2400000   12727.922      200            200            0.0043223716   0.0004083503   0              0.012558764    5.7781648e-14  0              2.790069e-09   1.1971759e-13  0              3.1953418    
   2500000   12727.922      200            200            0.0043223716   0.0004083503   0              0.012558764    4.323112e-15   0              2.0874761e-10  1.1971759e-13  0              3.1953418    
   2600000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    5.4997329e-16  0              2.6556242e-11  1.1971759e-13  0              3.1953418    
   2700000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    8.4945412e-17  0              4.1017099e-12  1.1971759e-13  0              3.1953418    
   2800000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    2.4628699e-17  0              1.1892317e-12  1.1971759e-13  0              3.1953418    
   2900000   12727.922      200            200            0.0043223715   0.0004083503   0              0.012558764    3.5098941e-18  0              1.6948022e-13  1.1971759e-13  0              3.1953418    
   3000000   12727.922      200            200            0.0043223715   0.00040835029  0              0.012558764    9.4674082e-20  0              4.5714726e-15  1.1971759e-13  0              3.1953418    
Loop time of 544.753 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4758121.733 ns/day, 0.000 hours/ns, 5507.085 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 23.083     | 76.873     | 132.07     | 612.1 | 14.11
Neigh   | 4.5885     | 4.6321     | 4.6766     |   1.5 |  0.85
Comm    | 18.098     | 23.919     | 27.921     |  85.3 |  4.39
Output  | 0.45485    | 0.45548    | 0.45612    |   0.1 |  0.08
Modify  | 319.64     | 332.93     | 346.46     |  68.8 | 61.12
Other   |            | 105.9      |            |       | 19.45

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         691.75 ave        1384 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2767
Ave neighs/atom = 0.55328934
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.41                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 45.6756188368544
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.51
  ghost atom cutoff = 3.51
  binsize = 1.755, bins = 7253 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 111.1 | 111.1 | 111.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035732077   2.5386562e-35  0              0.010719623    1359851.2      0              6.5662348e+10  1.1971759e-13  0              3.3274321    
    200000   12727.922      200            200           -0.0004189551   5.07734e-35    0             -0.0012568653   359659.38      0              1.7366664e+10  1.1971759e-13  0              3.2116807    
    300000   12727.922      200            200            0.0086892138  -0.00032214367  0              0.026389785    89088.666      0              4.3017729e+09  1.1971759e-13  0              3.1984776    
    400000   12727.922      200            200            1.1476132e-05  2.5386594e-35  0              3.4428397e-05  59.905625      0              2892628.2      1.1971759e-13  0              3.2110432    
    500000   12727.922      200            200            0.0054148755   0.00048189207  0              0.015762734    2698.8905      0              1.3031976e+08  1.1971759e-13  0              3.1998304    
    600000   12727.922      200            200            0.0040674979   0.00048181285  0              0.011720681    370.24181      0              17877652       1.1971759e-13  0              3.2004902    
    700000   12727.922      200            200            0.0049484085   0.00041843073  0              0.014426795    2.9611787      0              142984.72      1.1971759e-13  0              3.2000169    
    800000   12727.922      200            200            0.0042296743   0.00036008843  0              0.012328935    5.8258544      0              281309.66      1.1971759e-13  0              3.2003936    
    900000   12727.922      200            200            0.004257885    0.00041314806  0              0.012360507    0.21499304     0              10381.245      1.1971759e-13  0              3.2003853    
   1000000   12727.922      200            200            0.0043479391   0.00041074749  0              0.01263307     0.07738635     0              3736.7099      1.1971759e-13  0              3.2003349    
   1100000   12727.922      200            200            0.0043375395   0.00041067495  0              0.012601944    0.0084271437   0              406.91661      1.1971759e-13  0              3.200341     
   1200000   12727.922      200            200            0.0043263859   0.00041059088  0              0.012568567    0.00075517522  0              36.464709      1.1971759e-13  0              3.2003471    
   1300000   12727.922      200            200            0.0043289805   0.00041061181  0              0.01257633     0.00023316235  0              11.258576      1.1971759e-13  0              3.2003456    
   1400000   12727.922      200            200            0.0043302001   0.00041062116  0              0.012579979    4.2153134e-06  0              0.2035424      1.1971759e-13  0              3.2003449    
   1500000   12727.922      200            200            0.0043297209   0.00041061742  0              0.012578545    5.1553745e-06  0              0.24893458     1.1971759e-13  0              3.2003452    
   1600000   12727.922      200            200            0.0043296085   0.00041061656  0              0.012578209    1.0385613e-09  0              5.0148408e-05  1.1971759e-13  0              3.2003453    
   1700000   12727.922      200            200            0.0043296849   0.00041061716  0              0.012578438    9.5070774e-08  0              0.0045906274   1.1971759e-13  0              3.2003452    
   1800000   12727.922      200            200            0.0043296918   0.00041061721  0              0.012578458    8.2563271e-10  0              3.9866849e-05  1.1971759e-13  0              3.2003452    
   1900000   12727.922      200            200            0.0043296808   0.00041061713  0              0.012578425    1.4685076e-09  0              7.0908976e-05  1.1971759e-13  0              3.2003452    
   2000000   12727.922      200            200            0.0043296811   0.00041061713  0              0.012578426    6.3479332e-11  0              3.0651898e-06  1.1971759e-13  0              3.2003452    
   2100000   12727.922      200            200            0.0043296825   0.00041061714  0              0.01257843     1.8418713e-11  0              8.8937376e-07  1.1971759e-13  0              3.2003452    
   2200000   12727.922      200            200            0.0043296823   0.00041061714  0              0.01257843     2.3410612e-12  0              1.1304147e-07  1.1971759e-13  0              3.2003452    
   2300000   12727.922      200            200            0.0043296822   0.00041061714  0              0.012578429    1.7046546e-13  0              8.2311668e-09  1.1971759e-13  0              3.2003452    
   2400000   12727.922      200            200            0.0043296822   0.00041061714  0              0.012578429    6.2213978e-14  0              3.0040903e-09  1.1971759e-13  0              3.2003452    
   2500000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     8.5290082e-16  0              4.1183528e-11  1.1971759e-13  0              3.2003452    
   2600000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     1.3189752e-15  0              6.3688594e-11  1.1971759e-13  0              3.2003452    
   2700000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     2.0370866e-17  0              9.8363622e-13  1.1971759e-13  0              3.2003452    
   2800000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     3.258093e-18   0              1.5732165e-13  1.1971759e-13  0              3.2003452    
   2900000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     1.50929e-18    0              7.2878213e-14  1.1971759e-13  0              3.2003452    
   3000000   12727.922      200            200            0.0043296822   0.00041061714  0              0.01257843     9.8910924e-18  0              4.7760545e-13  1.1971759e-13  0              3.2003452    
Loop time of 544.178 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4763146.286 ns/day, 0.000 hours/ns, 5512.901 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.429     | 77.221     | 133.64     | 617.6 | 14.19
Neigh   | 4.6525     | 4.6989     | 4.7449     |   1.5 |  0.86
Comm    | 18.191     | 24.466     | 29.111     |  86.9 |  4.50
Output  | 0.48754    | 0.48817    | 0.4888     |   0.1 |  0.09
Modify  | 318.91     | 331.41     | 344.53     |  63.4 | 60.90
Other   |            | 105.9      |            |       | 19.46

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         696.25 ave        1393 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2785
Ave neighs/atom = 0.55688862
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.42                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.0786366890634
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.52
  ghost atom cutoff = 3.52
  binsize = 1.76, bins = 7232 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 110.8 | 110.8 | 110.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035825998   1.2693263e-35  0              0.010747799    1364690        0              6.5895998e+10  1.1971759e-13  0              3.3271899    
    200000   12727.922      200            200           -0.00042192492  8.12369e-34    0             -0.0012657748   350532.96      0              1.6925982e+10  1.1971759e-13  0              3.2203864    
    300000   12727.922      200            200            0.014356544   -0.0017735617   0              0.044843193    81624.976      0              3.941378e+09   1.1971759e-13  0              3.2013801    
    400000   12727.922      200            200            2.3380342e-05 -1.0154561e-34  0              7.0141027e-05  242.71643      0              11719908       1.1971759e-13  0              3.2159551    
    500000   12727.922      200            200            0.0063758382   0.000494045    0              0.01863347     2369.3508      0              1.1440747e+08  1.1971759e-13  0              3.2043791    
    600000   12727.922      200            200            0.0037397203   0.00052976484  0              0.010689396    325.47128      0              15715843       1.1971759e-13  0              3.2056988    
    700000   12727.922      200            200            0.0049728828   0.00041857203  0              0.014500076    0.05278326     0              2548.7147      1.1971759e-13  0              3.2050104    
    800000   12727.922      200            200            0.0043097022   0.00037527503  0              0.012553832    6.7343674      0              325178.5       1.1971759e-13  0              3.205359     
    900000   12727.922      200            200            0.0042556082   0.00041439022  0              0.012352434    0.02111063     0              1019.3568      1.1971759e-13  0              3.205394     
   1000000   12727.922      200            200            0.0043442646   0.00041262495  0              0.012620169    0.11430422     0              5519.3418      1.1971759e-13  0              3.2053443    
   1100000   12727.922      200            200            0.0043473726   0.00041264342  0              0.012629474    0.0020496272   0              98.969164      1.1971759e-13  0              3.2053429    
   1200000   12727.922      200            200            0.0043350672   0.00041255396  0              0.012592648    0.0017486933   0              84.438139      1.1971759e-13  0              3.2053497    
   1300000   12727.922      200            200            0.0043356235   0.00041255871  0              0.012594312    8.7825647e-05  0              4.2407862      1.1971759e-13  0              3.2053493    
   1400000   12727.922      200            200            0.0043372316   0.00041257097  0              0.012599124    2.3785602e-05  0              1.1485216      1.1971759e-13  0              3.2053485    
   1500000   12727.922      200            200            0.0043370303   0.00041256938  0              0.012598521    2.6984533e-06  0              0.13029865     1.1971759e-13  0              3.2053486    
   1600000   12727.922      200            200            0.0043368302   0.00041256787  0              0.012597923    2.760771e-07   0              0.013330775    1.1971759e-13  0              3.2053487    
   1700000   12727.922      200            200            0.004336873    0.0004125682   0              0.012598051    6.8629678e-08  0              0.0033138815   1.1971759e-13  0              3.2053487    
   1800000   12727.922      200            200            0.0043368965   0.00041256838  0              0.012598121    2.4910796e-09  0              0.00012028532  1.1971759e-13  0              3.2053486    
   1900000   12727.922      200            200            0.0043368889   0.00041256832  0              0.012598098    1.5294811e-09  0              7.3853171e-05  1.1971759e-13  0              3.2053487    
   2000000   12727.922      200            200            0.0043368864   0.0004125683   0              0.012598091    1.3108574e-11  0              6.3296611e-07  1.1971759e-13  0              3.2053487    
   2100000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598094    3.0656632e-11  0              1.4802991e-06  1.1971759e-13  0              3.2053487    
   2200000   12727.922      200            200            0.0043368878   0.00041256831  0              0.012598095    2.5216346e-15  0              1.2176071e-10  1.1971759e-13  0              3.2053487    
   2300000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    5.5775962e-13  0              2.6932216e-08  1.1971759e-13  0              3.2053487    
   2400000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    2.9928328e-15  0              1.4451319e-10  1.1971759e-13  0              3.2053487    
   2500000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    9.2249508e-15  0              4.4543986e-10  1.1971759e-13  0              3.2053487    
   2600000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    1.7587924e-16  0              8.4925789e-12  1.1971759e-13  0              3.2053487    
   2700000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    1.7749021e-16  0              8.570367e-12   1.1971759e-13  0              3.2053487    
   2800000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    7.2110796e-18  0              3.4819722e-13  1.1971759e-13  0              3.2053487    
   2900000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    8.3837045e-18  0              4.0481909e-13  1.1971759e-13  0              3.2053487    
   3000000   12727.922      200            200            0.0043368876   0.00041256831  0              0.012598095    3.7666198e-20  0              1.8187659e-15  1.1971759e-13  0              3.2053487    
Loop time of 546.691 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4741250.507 ns/day, 0.000 hours/ns, 5487.558 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.513     | 77.534     | 133.61     | 615.4 | 14.18
Neigh   | 4.6811     | 4.7268     | 4.7734     |   1.5 |  0.86
Comm    | 18.29      | 24.663     | 29.056     |  87.7 |  4.51
Output  | 0.49478    | 0.49541    | 0.49603    |   0.1 |  0.09
Modify  | 321.89     | 333.81     | 345.66     |  62.3 | 61.06
Other   |            | 105.5      |            |       | 19.29

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         700.75 ave        1402 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2803
Ave neighs/atom = 0.5604879
Neighbor list builds = 162
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.43                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.4840182755848
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.53
  ghost atom cutoff = 3.53
  binsize = 1.765, bins = 7212 114 114
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 110.5 | 110.5 | 110.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0035919921   5.0773048e-35  0              0.010775976    1369535.4      0              6.6129963e+10  1.1971759e-13  0              3.3269355    
    200000   12727.922      200            200           -0.00042466747  2.5386664e-35  0             -0.0012740024   341532.09      0              1.6491362e+10  1.1971759e-13  0              3.2290483    
    300000   12727.922      200            200            0.021616469   -0.0019412008   0              0.066790609    68263.666      0              3.2962081e+09  1.1971759e-13  0              3.2044123    
    400000   12727.922      200            200            3.5462531e-05 -1.1423924e-34  0              0.00010638759  547.90171      0              26456213       1.1971759e-13  0              3.2208052    
    500000   12727.922      200            200            0.007218639    0.00017855072  0              0.021477366    1879.7403      0              90765931       1.1971759e-13  0              3.2089661    
    600000   12727.922      200            200            0.0034183893   0.00046265219  0              0.0097925156   255.4236       0              12333492       1.1971759e-13  0              3.2108894    
    700000   12727.922      200            200            0.0049504753   0.00042553537  0              0.014425891    4.6582157      0              224928.56      1.1971759e-13  0              3.2100292    
    800000   12727.922      200            200            0.0043921131   0.00039143423  0              0.012784905    6.3757671      0              307862.97      1.1971759e-13  0              3.2103235    
    900000   12727.922      200            200            0.0042641842   0.00041776709  0              0.012374785    0.0361913      0              1747.5483      1.1971759e-13  0              3.2103971    
   1000000   12727.922      200            200            0.0043399311   0.00041602989  0              0.012603763    0.11908211     0              5750.0488      1.1971759e-13  0              3.2103544    
   1100000   12727.922      200            200            0.0043557507   0.00041614953  0              0.012651103    9.7002493e-05  0              4.6839032      1.1971759e-13  0              3.2103459    
   1200000   12727.922      200            200            0.0043446764   0.00041606498  0              0.012617964    0.0021928871   0              105.88667      1.1971759e-13  0              3.2103521    
   1300000   12727.922      200            200            0.004343109    0.00041605276  0              0.012613274    1.076523e-06   0              0.051981445    1.1971759e-13  0              3.2103529    
   1400000   12727.922      200            200            0.0043446745   0.00041606547  0              0.012617958    3.8882463e-05  0              1.877495       1.1971759e-13  0              3.210352     
   1500000   12727.922      200            200            0.0043448062   0.00041606646  0              0.012618352    2.0566033e-07  0              0.0099306012   1.1971759e-13  0              3.210352     
   1600000   12727.922      200            200            0.0043445893   0.00041606472  0              0.012617703    6.6329801e-07  0              0.032028287    1.1971759e-13  0              3.2103521    
   1700000   12727.922      200            200            0.0043445826   0.00041606467  0              0.012617683    1.0388965e-08  0              0.00050164593  1.1971759e-13  0              3.2103521    
   1800000   12727.922      200            200            0.004344612    0.00041606491  0              0.012617771    1.0862215e-08  0              0.00052449747  1.1971759e-13  0              3.2103521    
   1900000   12727.922      200            200            0.0043446114   0.0004160649   0              0.012617769    3.5865425e-10  0              1.731813e-05   1.1971759e-13  0              3.2103521    
   2000000   12727.922      200            200            0.0043446075   0.00041606487  0              0.012617758    1.7005119e-10  0              8.2111634e-06  1.1971759e-13  0              3.2103521    
   2100000   12727.922      200            200            0.0043446078   0.00041606488  0              0.012617758    1.0236966e-11  0              4.9430645e-07  1.1971759e-13  0              3.2103521    
   2200000   12727.922      200            200            0.0043446083   0.00041606488  0              0.01261776     2.5269512e-12  0              1.2201743e-07  1.1971759e-13  0              3.2103521    
   2300000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     2.5992622e-13  0              1.2550907e-08  1.1971759e-13  0              3.2103521    
   2400000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     3.5813705e-14  0              1.7293156e-09  1.1971759e-13  0              3.2103521    
   2500000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     5.9967666e-15  0              2.895624e-10   1.1971759e-13  0              3.2103521    
   2600000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     5.0037328e-16  0              2.4161235e-11  1.1971759e-13  0              3.2103521    
   2700000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     7.0239481e-17  0              3.3916132e-12  1.1971759e-13  0              3.2103521    
   2800000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     2.4826804e-17  0              1.1987975e-12  1.1971759e-13  0              3.2103521    
   2900000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     1.5735848e-18  0              7.5982778e-14  1.1971759e-13  0              3.2103521    
   3000000   12727.922      200            200            0.0043446082   0.00041606488  0              0.01261776     1.4466673e-18  0              6.9854386e-14  1.1971759e-13  0              3.2103521    
Loop time of 536.018 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4835656.555 ns/day, 0.000 hours/ns, 5596.825 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.201     | 74.857     | 128.02     | 601.2 | 13.97
Neigh   | 4.5865     | 4.6323     | 4.6796     |   1.5 |  0.86
Comm    | 17.813     | 24.146     | 28.466     |  87.5 |  4.50
Output  | 0.39087    | 0.3915     | 0.39214    |   0.1 |  0.07
Modify  | 313.74     | 327.53     | 341.52     |  71.1 | 61.11
Other   |            | 104.5      |            |       | 19.49

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         656.25 ave        1313 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2625
Ave neighs/atom = 0.52489502
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.44                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 46.8917705079228
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.54
  ghost atom cutoff = 3.54
  binsize = 1.77, bins = 7191 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 108.6 | 108.6 | 108.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036013844   3.407498e-41   0              0.010804153    1374387.3      0              6.6364242e+10  1.1971759e-13  0              3.326669     
    200000   12727.922      200            200           -0.00042718371 -3.0463686e-34  0             -0.0012815511   332656.46      0              1.606279e+10   1.1971759e-13  0              3.2376664    
    300000   12727.922      200            200            0.02980093    -0.00065135569  0              0.090054146    50063.861      0              2.4174047e+09  1.1971759e-13  0              3.2076645    
    400000   12727.922      200            200            4.7721251e-05  1.5228278e-40  0              0.00014316375  974.91971      0              47075384       1.1971759e-13  0              3.2255933    
    500000   12727.922      200            200            0.0079659378  -0.00020505567  0              0.024102869    1301.5637      0              62847851       1.1971759e-13  0              3.2136095    
    600000   12727.922      200            200            0.0031276739   0.00032449266  0              0.009058529    174.16011      0              8409568.6      1.1971759e-13  0              3.2160536    
    700000   12727.922      200            200            0.0048810921   0.00043087592  0              0.0142124      15.334109      0              740429.24      1.1971759e-13  0              3.2150721    
    800000   12727.922      200            200            0.0044653426   0.00039442199  0              0.013001606    4.8799126      0              235633.51      1.1971759e-13  0              3.2152909    
    900000   12727.922      200            200            0.004281937    0.00041854727  0              0.012427264    0.25139216     0              12138.828      1.1971759e-13  0              3.2153946    
   1000000   12727.922      200            200            0.0043352466   0.00041623433  0              0.012589505    0.088836104    0              4289.5775      1.1971759e-13  0              3.215364     
   1100000   12727.922      200            200            0.0043608907   0.00041631699  0              0.012666355    0.0040124368   0              193.74621      1.1971759e-13  0              3.2153501    
   1200000   12727.922      200            200            0.0043532213   0.00041638087  0              0.012643283    0.001704232    0              82.291264      1.1971759e-13  0              3.2153544    
   1300000   12727.922      200            200            0.0043499229   0.00041635549  0              0.012633413    5.774632e-05   0              2.7883631      1.1971759e-13  0              3.2153562    
   1400000   12727.922      200            200            0.0043510302   0.00041636433  0              0.012636726    3.2606658e-05  0              1.5744588      1.1971759e-13  0              3.2153556    
   1500000   12727.922      200            200            0.0043514488   0.00041636755  0              0.012637979    8.0021615e-07  0              0.038639574    1.1971759e-13  0              3.2153554    
   1600000   12727.922      200            200            0.0043512909   0.00041636631  0              0.012637506    6.1852142e-07  0              0.029866186    1.1971759e-13  0              3.2153554    
   1700000   12727.922      200            200            0.0043512381   0.0004163659   0              0.012637349    1.0563377e-08  0              0.00051006769  1.1971759e-13  0              3.2153555    
   1800000   12727.922      200            200            0.0043512605   0.00041636608  0              0.012637415    1.1635365e-08  0              0.00056183016  1.1971759e-13  0              3.2153555    
   1900000   12727.922      200            200            0.0043512671   0.00041636613  0              0.012637435    1.304858e-10   0              6.3006924e-06  1.1971759e-13  0              3.2153555    
   2000000   12727.922      200            200            0.0043512639   0.0004163661   0              0.012637426    2.1713172e-10  0              1.0484514e-05  1.1971759e-13  0              3.2153555    
   2100000   12727.922      200            200            0.0043512631   0.0004163661   0              0.012637423    1.4642888e-12  0              7.0705267e-08  1.1971759e-13  0              3.2153555    
   2200000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    4.020658e-12   0              1.9414318e-07  1.1971759e-13  0              3.2153555    
   2300000   12727.922      200            200            0.0043512637   0.0004163661   0              0.012637425    1.4170201e-14  0              6.842283e-10   1.1971759e-13  0              3.2153555    
   2400000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    7.3991478e-14  0              3.5727837e-09  1.1971759e-13  0              3.2153555    
   2500000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    7.1264565e-17  0              3.4411108e-12  1.1971759e-13  0              3.2153555    
   2600000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    1.3511449e-15  0              6.5241951e-11  1.1971759e-13  0              3.2153555    
   2700000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    2.4356697e-17  0              1.1760977e-12  1.1971759e-13  0              3.2153555    
   2800000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    1.2126107e-18  0              5.8552632e-14  1.1971759e-13  0              3.2153555    
   2900000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    8.4012292e-19  0              4.0566529e-14  1.1971759e-13  0              3.2153555    
   3000000   12727.922      200            200            0.0043512636   0.0004163661   0              0.012637425    6.2396505e-18  0              3.0129039e-13  1.1971759e-13  0              3.2153555    
Loop time of 539.019 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4808738.913 ns/day, 0.000 hours/ns, 5565.670 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.698     | 76.05      | 131.36     | 606.8 | 14.11
Neigh   | 4.378      | 4.4225     | 4.4695     |   1.5 |  0.82
Comm    | 17.774     | 24.084     | 29.24      |  92.3 |  4.47
Output  | 0.45441    | 0.45504    | 0.45567    |   0.1 |  0.08
Modify  | 316.52     | 329.24     | 341.04     |  64.6 | 61.08
Other   |            | 104.8      |            |       | 19.44

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         662.25 ave        1325 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2649
Ave neighs/atom = 0.52969406
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.45                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.3019002975809
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.55
  ghost atom cutoff = 3.55
  binsize = 1.775, bins = 7171 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 108.4 | 108.4 | 108.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036107768  -3.1733111e-36  0              0.01083233     1379245.6      0              6.6598835e+10  1.1971759e-13  0              3.3263902    
    200000   12727.922      200            200           -0.00042947459 -1.015455e-34   0             -0.0012884238   323905.75      0              1.564025e+10   1.1971759e-13  0              3.2462406    
    300000   12727.922      200            200            0.036658536   -0.0018023997   0              0.11177801     29979.251      0              1.4475907e+09  1.1971759e-13  0              3.2112326    
    400000   12727.922      200            200            6.0155031e-05  1.0154719e-34  0              0.00018046509  1523.2287      0              73551263       1.1971759e-13  0              3.2303195    
    500000   12727.922      200            200            0.0086348731  -0.00040141996  0              0.026306039    732.74281      0              35381528       1.1971759e-13  0              3.2183264    
    600000   12727.922      200            200            0.0029394632   0.00031272034  0              0.0085056692   96.76778       0              4672569.8      1.1971759e-13  0              3.221184     
    700000   12727.922      200            200            0.004773211    0.00043939741  0              0.013880236    28.827442      0              1391974        1.1971759e-13  0              3.220136     
    800000   12727.922      200            200            0.0045273707   0.00039801763  0              0.013184094    2.8121051      0              135786.49      1.1971759e-13  0              3.2202647    
    900000   12727.922      200            200            0.0043079195   0.00041782787  0              0.012505931    0.56201248     0              27137.571      1.1971759e-13  0              3.2203872    
   1000000   12727.922      200            200            0.0043325039   0.00041478793  0              0.012582724    0.041777367    0              2017.2795      1.1971759e-13  0              3.2203723    
   1100000   12727.922      200            200            0.0043635393   0.00041468682  0              0.012675931    0.010985476    0              530.4493       1.1971759e-13  0              3.2203553    
   1200000   12727.922      200            200            0.0043607557   0.0004149024   0              0.012667365    0.00067092937  0              32.396778      1.1971759e-13  0              3.220357     
   1300000   12727.922      200            200            0.0043565565   0.00041497741  0              0.012654692    0.00020749129  0              10.019012      1.1971759e-13  0              3.2203593    
   1400000   12727.922      200            200            0.0043568849   0.00041497486  0              0.01265568     1.0856054e-05  0              0.52420001     1.1971759e-13  0              3.2203591    
   1500000   12727.922      200            200            0.0043574545   0.00041497048  0              0.012657393    3.9093202e-06  0              0.18876708     1.1971759e-13  0              3.2203588    
   1600000   12727.922      200            200            0.0043574181   0.00041497129  0              0.012657283    1.733187e-07   0              0.0083689396   1.1971759e-13  0              3.2203588    
   1700000   12727.922      200            200            0.0043573408   0.000414971    0              0.012657051    7.3435083e-08  0              0.0035459174   1.1971759e-13  0              3.2203588    
   1800000   12727.922      200            200            0.0043573447   0.00041497102  0              0.012657063    2.7369767e-09  0              0.00013215881  1.1971759e-13  0              3.2203588    
   1900000   12727.922      200            200            0.0043573552   0.00041497105  0              0.012657094    1.374842e-09   0              6.6386197e-05  1.1971759e-13  0              3.2203588    
   2000000   12727.922      200            200            0.0043573548   0.00041497105  0              0.012657093    4.2703697e-11  0              2.0620087e-06  1.1971759e-13  0              3.2203588    
   2100000   12727.922      200            200            0.0043573534   0.00041497105  0              0.012657089    2.5654469e-11  0              1.2387625e-06  1.1971759e-13  0              3.2203588    
   2200000   12727.922      200            200            0.0043573534   0.00041497105  0              0.012657089    6.5684868e-13  0              3.1716872e-08  1.1971759e-13  0              3.2203588    
   2300000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     4.7859357e-13  0              2.3109571e-08  1.1971759e-13  0              3.2203588    
   2400000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     1.0059462e-14  0              4.8573543e-10  1.1971759e-13  0              3.2203588    
   2500000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     8.8667527e-15  0              4.2814375e-10  1.1971759e-13  0              3.2203588    
   2600000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     1.2098323e-16  0              5.8418471e-12  1.1971759e-13  0              3.2203588    
   2700000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     1.7863606e-16  0              8.6256962e-12  1.1971759e-13  0              3.2203588    
   2800000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     1.5557702e-17  0              7.5122576e-13  1.1971759e-13  0              3.2203588    
   2900000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     1.2741116e-17  0              6.152229e-13   1.1971759e-13  0              3.2203588    
   3000000   12727.922      200            200            0.0043573536   0.00041497105  0              0.01265709     4.0002786e-18  0              1.9315914e-13  1.1971759e-13  0              3.2203588    
Loop time of 540.018 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4799839.114 ns/day, 0.000 hours/ns, 5555.369 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.112     | 75.487     | 129.27     | 607.1 | 13.98
Neigh   | 4.2593     | 4.3019     | 4.3468     |   1.5 |  0.80
Comm    | 17.326     | 23.542     | 27.541     |  82.4 |  4.36
Output  | 0.39286    | 0.39349    | 0.39413    |   0.1 |  0.07
Modify  | 314.52     | 329.13     | 345.85     |  76.3 | 60.95
Other   |            | 107.2      |            |       | 19.85

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         667.75 ave        1336 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2671
Ave neighs/atom = 0.53409318
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.46                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 47.7144145560632
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.56
  ghost atom cutoff = 3.56
  binsize = 1.78, bins = 7151 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 108.1 | 108.1 | 108.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036201692   3.6524594e-42  0              0.010860507    1384110.5      0              6.6833742e+10  1.1971759e-13  0              3.3260993    
    200000   12727.922      200            200           -0.00043154107  3.1105106e-40  0             -0.0012946232   315279.64      0              1.5223726e+10  1.1971759e-13  0              3.2547709    
    300000   12727.922      200            200            0.042026783   -0.0027641618   0              0.12884451     12370.937      0              5.9734828e+08  1.1971759e-13  0              3.215207     
    400000   12727.922      200            200            7.2762493e-05  2.538658e-35   0              0.00021828748  2192.2924      0              1.0585796e+08  1.1971759e-13  0              3.2349835    
    500000   12727.922      200            200            0.0091262739  -0.00051655688  0              0.027895379    279.06746      0              13475169       1.1971759e-13  0              3.223131     
    600000   12727.922      200            200            0.0028350561   0.00036267081  0              0.0081424976   36.77808       0              1775881.8      1.1971759e-13  0              3.2262752    
    700000   12727.922      200            200            0.0046460331   0.00047799498  0              0.013460104    41.111268      0              1985116        1.1971759e-13  0              3.2252163    
    800000   12727.922      200            200            0.0045740164   0.00040668523  0              0.013315364    0.96120021     0              46412.918      1.1971759e-13  0              3.2252478    
    900000   12727.922      200            200            0.0043406977   0.0004184626   0              0.012603631    0.81782705     0              39489.941      1.1971759e-13  0              3.2253763    
   1000000   12727.922      200            200            0.0043341065   0.00041473525  0              0.012587584    0.0062161075   0              300.15359      1.1971759e-13  0              3.2253785    
   1100000   12727.922      200            200            0.0043653923   0.00041444875  0              0.012681728    0.015815736    0              763.68527      1.1971759e-13  0              3.2253612    
   1200000   12727.922      200            200            0.0043678348   0.00041449719  0              0.012689007    1.5435094e-05  0              0.74530546     1.1971759e-13  0              3.22536      
   1300000   12727.922      200            200            0.0043638043   0.00041466412  0              0.012676749    0.0002922835   0              14.113324      1.1971759e-13  0              3.2253622    
   1400000   12727.922      200            200            0.0043632525   0.00041464793  0              0.012675109    1.6542731e-07  0              0.0079878925   1.1971759e-13  0              3.2253625    
   1500000   12727.922      200            200            0.0043637703   0.00041464556  0              0.012676665    5.1679216e-06  0              0.24954044     1.1971759e-13  0              3.2253622    
   1600000   12727.922      200            200            0.0043638719   0.0004146452   0              0.012676971    3.2023128e-08  0              0.0015462822   1.1971759e-13  0              3.2253622    
   1700000   12727.922      200            200            0.0043638079   0.00041464544  0              0.012676778    8.7294006e-08  0              0.0042151151   1.1971759e-13  0              3.2253622    
   1800000   12727.922      200            200            0.0043637908   0.0004146455   0              0.012676727    1.6149528e-09  0              7.7980292e-05  1.1971759e-13  0              3.2253622    
   1900000   12727.922      200            200            0.0043637984   0.00041464547  0              0.01267675     1.4042379e-09  0              6.7805624e-05  1.1971759e-13  0              3.2253622    
   2000000   12727.922      200            200            0.0043638012   0.00041464546  0              0.012676758    5.5424029e-11  0              2.676228e-06   1.1971759e-13  0              3.2253622    
   2100000   12727.922      200            200            0.0043638003   0.00041464547  0              0.012676755    2.1384383e-11  0              1.0325753e-06  1.1971759e-13  0              3.2253622    
   2200000   12727.922      200            200            0.0043637999   0.00041464547  0              0.012676754    1.5683886e-12  0              7.5731874e-08  1.1971759e-13  0              3.2253622    
   2300000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676754    3.0476923e-13  0              1.4716215e-08  1.1971759e-13  0              3.2253622    
   2400000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    3.9431829e-14  0              1.9040219e-09  1.1971759e-13  0              3.2253622    
   2500000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    3.8852754e-15  0              1.8760605e-10  1.1971759e-13  0              3.2253622    
   2600000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    9.5159933e-16  0              4.5949326e-11  1.1971759e-13  0              3.2253622    
   2700000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    6.2973792e-18  0              3.040779e-13   1.1971759e-13  0              3.2253622    
   2800000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    1.2544916e-17  0              6.057491e-13   1.1971759e-13  0              3.2253622    
   2900000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    3.6681258e-18  0              1.7712067e-13  1.1971759e-13  0              3.2253622    
   3000000   12727.922      200            200            0.0043638      0.00041464547  0              0.012676755    1.301459e-17   0              6.2842799e-13  1.1971759e-13  0              3.2253622    
Loop time of 539.128 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4807768.004 ns/day, 0.000 hours/ns, 5564.546 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.373     | 75.852     | 129.76     | 607.8 | 14.07
Neigh   | 4.2928     | 4.3358     | 4.3812     |   1.5 |  0.80
Comm    | 17.489     | 24.341     | 29.407     | 102.0 |  4.51
Output  | 0.39283    | 0.39347    | 0.39414    |   0.1 |  0.07
Modify  | 317.43     | 329.54     | 341.72     |  62.6 | 61.12
Other   |            | 104.7      |            |       | 19.41

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         673.75 ave        1348 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2695
Ave neighs/atom = 0.53889222
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.47                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.1293201948733
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.57
  ghost atom cutoff = 3.57
  binsize = 1.785, bins = 7131 113 113
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 107.8 | 107.8 | 107.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036295615   3.1733148e-36  0              0.010888684    1388981.8      0              6.7068962e+10  1.1971759e-13  0              3.3257961    
    200000   12727.922      200            200           -0.00043338411 -5.0772617e-35  0             -0.0013001523   306777.73      0              1.4813199e+10  1.1971759e-13  0              3.2632571    
    300000   12727.922      200            200            0.045100851   -0.0032151746   0              0.13851773     1720.7391      0              83088332       1.1971759e-13  0              3.2196592    
    400000   12727.922      200            200            8.5542303e-05  2.0309225e-34  0              0.00025662691  2981.5811      0              1.4396988e+08  1.1971759e-13  0              3.2395855    
    500000   12727.922      200            200            0.0093763911  -0.00059491687  0              0.02872409     30.0465        0              1450838        1.1971759e-13  0              3.2280335    
    600000   12727.922      200            200            0.0027828343   0.00037516202  0              0.0079733408   4.1872341      0              202186.55      1.1971759e-13  0              3.2313235    
    700000   12727.922      200            200            0.0044815674   0.00045636843  0              0.012988334    48.621692      0              2347767.5      1.1971759e-13  0              3.2303071    
    800000   12727.922      200            200            0.0046002449   0.0004171963   0              0.013383538    0.035474173    0              1712.9209      1.1971759e-13  0              3.2302422    
    900000   12727.922      200            200            0.004376923    0.00041995228  0              0.012710817    0.89514382     0              43223.292      1.1971759e-13  0              3.2303637    
   1000000   12727.922      200            200            0.0043416135   0.00041840378  0              0.012606437    0.0034632497   0              167.22793      1.1971759e-13  0              3.230382     
   1100000   12727.922      200            200            0.0043681451   0.00041792437  0              0.012686511    0.014840795    0              716.60888      1.1971759e-13  0              3.2303673    
   1200000   12727.922      200            200            0.0043751108   0.0004176962   0              0.012707636    0.00035095556  0              16.946388      1.1971759e-13  0              3.2303635    
   1300000   12727.922      200            200            0.004372194    0.00041782613  0              0.012698756    0.00021535906  0              10.398918      1.1971759e-13  0              3.2303651    
   1400000   12727.922      200            200            0.0043709863   0.00041783478  0              0.012695124    1.4715964e-05  0              0.71058123     1.1971759e-13  0              3.2303658    
   1500000   12727.922      200            200            0.0043712738   0.00041783239  0              0.012695989    2.6403137e-06  0              0.1274913      1.1971759e-13  0              3.2303656    
   1600000   12727.922      200            200            0.0043714619   0.00041783097  0              0.012696555    4.3748626e-07  0              0.021124646    1.1971759e-13  0              3.2303655    
   1700000   12727.922      200            200            0.0043714402   0.00041783114  0              0.012696489    2.5158898e-08  0              0.0012148331   1.1971759e-13  0              3.2303655    
   1800000   12727.922      200            200            0.004371413    0.00041783135  0              0.012696408    1.0628561e-08  0              0.00051321518  1.1971759e-13  0              3.2303656    
   1900000   12727.922      200            200            0.0043714134   0.00041783134  0              0.012696409    1.4431719e-10  0              6.9685608e-06  1.1971759e-13  0              3.2303656    
   2000000   12727.922      200            200            0.0043714171   0.00041783131  0              0.01269642     2.2276472e-10  0              1.0756511e-05  1.1971759e-13  0              3.2303656    
   2100000   12727.922      200            200            0.0043714174   0.00041783131  0              0.012696421    7.2163874e-14  0              3.4845352e-09  1.1971759e-13  0              3.2303656    
   2200000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    4.113807e-12   0              1.9864102e-07  1.1971759e-13  0              3.2303656    
   2300000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    2.118125e-14   0              1.0227668e-09  1.1971759e-13  0              3.2303656    
   2400000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    6.6851917e-14  0              3.2280398e-09  1.1971759e-13  0              3.2303656    
   2500000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    1.819312e-15   0              8.7848065e-11  1.1971759e-13  0              3.2303656    
   2600000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    9.2804743e-16  0              4.4812089e-11  1.1971759e-13  0              3.2303656    
   2700000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    1.3274982e-16  0              6.4100135e-12  1.1971759e-13  0              3.2303656    
   2800000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    5.0328423e-18  0              2.4301794e-13  1.1971759e-13  0              3.2303656    
   2900000   12727.922      200            200            0.0043714169   0.00041783131  0              0.012696419    1.3486357e-17  0              6.5120791e-13  1.1971759e-13  0              3.2303656    
   3000000   12727.922      200            200            0.0043714169   0.00041783132  0              0.012696419    6.1341651e-18  0              2.9619688e-13  1.1971759e-13  0              3.2303656    
Loop time of 539.208 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4807047.143 ns/day, 0.000 hours/ns, 5563.712 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.276     | 76.044     | 131.18     | 612.3 | 14.10
Neigh   | 4.3741     | 4.4153     | 4.459      |   1.4 |  0.82
Comm    | 17.841     | 23.955     | 28.227     |  88.1 |  4.44
Output  | 0.39432    | 0.39494    | 0.39559    |   0.1 |  0.07
Modify  | 317.28     | 329.75     | 341.28     |  63.1 | 61.15
Other   |            | 104.7      |            |       | 19.41

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         678.75 ave        1358 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2715
Ave neighs/atom = 0.54289142
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.48                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.5466241255151
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.58
  ghost atom cutoff = 3.58
  binsize = 1.79, bins = 7111 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 106 | 106 | 106 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036389537  -3.8079711e-35  0              0.010916861    1393859.7      0              6.7304496e+10  1.1971759e-13  0              3.3254807    
    200000   12727.922      200            200           -0.00043500466  1.2693295e-35  0             -0.001305014    298399.77      0              1.4408657e+10  1.1971759e-13  0              3.2716992    
    300000   12727.922      200            200            0.045254197   -0.003350255    0              0.13911285     978.06958      0              47227479       1.1971759e-13  0              3.2246306    
    400000   12727.922      200            200            9.8492886e-05  7.4927894e-41  0              0.00029547866  3890.5513      0              1.878608e+08   1.1971759e-13  0              3.2441252    
    500000   12727.922      200            200            0.0093689903  -0.0006018418   0              0.028708813    36.27306       0              1751496.2      1.1971759e-13  0              3.2330395    
    600000   12727.922      200            200            0.0027903772   0.00037154593  0              0.0079995858   4.1975102      0              202682.75      1.1971759e-13  0              3.2363272    
    700000   12727.922      200            200            0.0043091977   0.00042351975  0              0.012504073    49.289948      0              2380035.2      1.1971759e-13  0              3.2354018    
    800000   12727.922      200            200            0.0046006186   0.00041848799  0              0.013383368    0.38494555     0              18587.643      1.1971759e-13  0              3.2352487    
    900000   12727.922      200            200            0.0044111091   0.00041666236  0              0.012816665    0.75626282     0              36517.225      1.1971759e-13  0              3.2353514    
   1000000   12727.922      200            200            0.004353367    0.00042065766  0              0.012639443    0.034975346    0              1688.8343      1.1971759e-13  0              3.235383     
   1100000   12727.922      200            200            0.0043710505   0.00041986832  0              0.012693283    0.0088269873   0              426.22362      1.1971759e-13  0              3.235373     
   1200000   12727.922      200            200            0.0043809763   0.00041934675  0              0.012723582    0.0013440614   0              64.899915      1.1971759e-13  0              3.2353675    
   1300000   12727.922      200            200            0.0043798285   0.00041941517  0              0.01272007     6.5574566e-05  0              3.1663611      1.1971759e-13  0              3.2353682    
   1400000   12727.922      200            200            0.0043783331   0.00041942989  0              0.012715569    3.5061753e-05  0              1.6930066      1.1971759e-13  0              3.235369     
   1500000   12727.922      200            200            0.0043783052   0.00041943007  0              0.012715486    1.2701954e-07  0              0.006133319    1.1971759e-13  0              3.235369     
   1600000   12727.922      200            200            0.0043785025   0.00041942794  0              0.01271608     7.0400529e-07  0              0.033993896    1.1971759e-13  0              3.2353689    
   1700000   12727.922      200            200            0.0043785306   0.00041942766  0              0.012716164    3.1029813e-09  0              0.00014983186  1.1971759e-13  0              3.2353689    
   1800000   12727.922      200            200            0.0043785076   0.0004194279   0              0.012716095    1.1190291e-08  0              0.00054033908  1.1971759e-13  0              3.2353689    
   1900000   12727.922      200            200            0.0043785009   0.00041942797  0              0.012716075    4.2170855e-10  0              2.0362797e-05  1.1971759e-13  0              3.2353689    
   2000000   12727.922      200            200            0.0043785032   0.00041942795  0              0.012716082    1.3616982e-10  0              6.5751531e-06  1.1971759e-13  0              3.2353689    
   2100000   12727.922      200            200            0.0043785044   0.00041942793  0              0.012716085    1.7630133e-11  0              8.51296e-07    1.1971759e-13  0              3.2353689    
   2200000   12727.922      200            200            0.0043785042   0.00041942794  0              0.012716085    1.0995189e-12  0              5.309183e-08   1.1971759e-13  0              3.2353689    
   2300000   12727.922      200            200            0.004378504    0.00041942794  0              0.012716084    4.7981117e-13  0              2.3168364e-08  1.1971759e-13  0              3.2353689    
   2400000   12727.922      200            200            0.004378504    0.00041942794  0              0.012716084    3.1921979e-15  0              1.5413981e-10  1.1971759e-13  0              3.2353689    
   2500000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    9.9688641e-15  0              4.8136077e-10  1.1971759e-13  0              3.2353689    
   2600000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    3.8679237e-17  0              1.8676819e-12  1.1971759e-13  0              3.2353689    
   2700000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    9.8964743e-17  0              4.7786533e-12  1.1971759e-13  0              3.2353689    
   2800000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    2.3007023e-17  0              1.1109268e-12  1.1971759e-13  0              3.2353689    
   2900000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    6.0589472e-21  0              2.9256487e-16  1.1971759e-13  0              3.2353689    
   3000000   12727.922      200            200            0.0043785041   0.00041942794  0              0.012716084    4.3028217e-18  0              2.0776786e-13  1.1971759e-13  0              3.2353689    
Loop time of 537.95 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4818288.937 ns/day, 0.000 hours/ns, 5576.723 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.355     | 75.716     | 130.4      | 608.1 | 14.07
Neigh   | 4.2279     | 4.2724     | 4.3184     |   1.5 |  0.79
Comm    | 17.15      | 24.328     | 30.346     | 112.4 |  4.52
Output  | 0.39263    | 0.39327    | 0.39392    |   0.1 |  0.07
Modify  | 318.18     | 329.37     | 340.39     |  57.3 | 61.23
Other   |            | 103.9      |            |       | 19.31

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         683.25 ave        1367 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2733
Ave neighs/atom = 0.5464907
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.49                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 48.9663332594927
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.59
  ghost atom cutoff = 3.59
  binsize = 1.795, bins = 7091 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 105.7 | 105.7 | 105.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036483457   1.2693266e-35  0              0.010945037    1398744        0              6.7540343e+10  1.1971759e-13  0              3.3251529    
    200000   12727.922      200            200           -0.00043640367  4.5695726e-34  0             -0.001309211    290145.38      0              1.4010082e+10  1.1971759e-13  0              3.2800972    
    300000   12727.922      200            200            0.042364676   -0.0033459468   0              0.13043997     10337.463      0              4.9915909e+08  1.1971759e-13  0              3.2301253    
    400000   12727.922      200            200            0.00011161298  9.519941e-36   0              0.00033483895  4918.6823      0              2.3750556e+08  1.1971759e-13  0              3.2486026    
    500000   12727.922      200            200            0.0090981899  -0.00055172321  0              0.027846293    295.72031      0              14279275       1.1971759e-13  0              3.238149     
    600000   12727.922      200            200            0.0028664342   0.00037776471  0              0.0082215378   36.623326      0              1768409.3      1.1971759e-13  0              3.2412863    
    700000   12727.922      200            200            0.0041545517   0.00041995373  0              0.012043701    43.065206      0              2079464.7      1.1971759e-13  0              3.240494     
    800000   12727.922      200            200            0.0045793572   0.00042119519  0              0.013316876    1.8647894      0              90044.006      1.1971759e-13  0              3.240267     
    900000   12727.922      200            200            0.0044418416   0.00041526476  0              0.01291026     0.46824516     0              22609.883      1.1971759e-13  0              3.2403413    
   1000000   12727.922      200            200            0.0043698502   0.00042499452  0              0.012684556    0.08150969     0              3935.8112      1.1971759e-13  0              3.2403818    
   1100000   12727.922      200            200            0.0043762319   0.00042414958  0              0.012704546    0.0022976147   0              110.94359      1.1971759e-13  0              3.2403779    
   1200000   12727.922      200            200            0.0043870676   0.00042342813  0              0.012737775    0.0020963542   0              101.22544      1.1971759e-13  0              3.2403718    
   1300000   12727.922      200            200            0.0043878918   0.00042341996  0              0.012740255    4.6069707e-07  0              0.022245413    1.1971759e-13  0              3.2403714    
   1400000   12727.922      200            200            0.0043865376   0.00042343542  0              0.012736178    3.6505247e-05  0              1.7627077      1.1971759e-13  0              3.2403722    
   1500000   12727.922      200            200            0.0043862166   0.00042343926  0              0.012735211    1.0624517e-06  0              0.051301988    1.1971759e-13  0              3.2403723    
   1600000   12727.922      200            200            0.0043863485   0.00042343759  0              0.012735608    4.2372809e-07  0              0.020460313    1.1971759e-13  0              3.2403723    
   1700000   12727.922      200            200            0.0043864121   0.00042343682  0              0.012735799    5.7424184e-08  0              0.0027728083   1.1971759e-13  0              3.2403722    
   1800000   12727.922      200            200            0.0043864043   0.00042343692  0              0.012735776    2.513517e-09   0              0.00012136874  1.1971759e-13  0              3.2403722    
   1900000   12727.922      200            200            0.0043863945   0.00042343704  0              0.012735746    1.5978005e-09  0              7.715207e-05   1.1971759e-13  0              3.2403722    
   2000000   12727.922      200            200            0.004386394    0.00042343705  0              0.012735745    2.6465573e-13  0              1.2779278e-08  1.1971759e-13  0              3.2403722    
   2100000   12727.922      200            200            0.0043863953   0.00042343703  0              0.012735749    2.9666851e-11  0              1.4325061e-06  1.1971759e-13  0              3.2403722    
   2200000   12727.922      200            200            0.0043863955   0.00042343703  0              0.01273575     6.0542111e-13  0              2.9233619e-08  1.1971759e-13  0              3.2403722    
   2300000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    3.7225841e-13  0              1.7975026e-08  1.1971759e-13  0              3.2403722    
   2400000   12727.922      200            200            0.0043863953   0.00042343703  0              0.012735749    3.9085501e-14  0              1.887299e-09   1.1971759e-13  0              3.2403722    
   2500000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    2.5825609e-15  0              1.2470262e-10  1.1971759e-13  0              3.2403722    
   2600000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    1.2292914e-15  0              5.9358081e-11  1.1971759e-13  0              3.2403722    
   2700000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    1.2427866e-17  0              6.0009717e-13  1.1971759e-13  0              3.2403722    
   2800000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    3.0541947e-19  0              1.4747613e-14  1.1971759e-13  0              3.2403722    
   2900000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    5.9076056e-20  0              2.8525713e-15  1.1971759e-13  0              3.2403722    
   3000000   12727.922      200            200            0.0043863954   0.00042343703  0              0.012735749    4.2235514e-18  0              2.0394018e-13  1.1971759e-13  0              3.2403722    
Loop time of 544.515 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4760198.897 ns/day, 0.000 hours/ns, 5509.489 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.284     | 76.861     | 132.67     | 615.6 | 14.12
Neigh   | 4.2135     | 4.2565     | 4.3021     |   1.5 |  0.78
Comm    | 17.53      | 23.628     | 27.838     |  86.9 |  4.34
Output  | 0.39329    | 0.39391    | 0.39455    |   0.1 |  0.07
Modify  | 321.85     | 333.95     | 346.1      |  63.3 | 61.33
Other   |            | 105.4      |            |       | 19.36

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         688.75 ave        1378 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2755
Ave neighs/atom = 0.55088982
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.5                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.3884545083096
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.6
  ghost atom cutoff = 3.6
  binsize = 1.8, bins = 7072 112 112
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 105.4 | 105.5 | 105.5 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036577375  -3.1733124e-35  0              0.010973213    1403634.8      0              6.7776502e+10  1.1971759e-13  0              3.3248129    
    200000   12727.922      200            200           -0.00043758209 -1.0154523e-34  0             -0.0013127463   282014.25      0              1.3617459e+10  1.1971759e-13  0              3.2884509    
    300000   12727.922      200            200            0.037411227   -0.0016627427   0              0.11389642     27125.905      0              1.3098129e+09  1.1971759e-13  0              3.236109     
    400000   12727.922      200            200            0.00012490115 -5.0772981e-35  0              0.00037470345  6065.4429      0              2.9287853e+08  1.1971759e-13  0              3.2530176    
    500000   12727.922      200            200            0.0085119951  -0.00067956724  0              0.026215553    753.88607      0              36402460       1.1971759e-13  0              3.2433564    
    600000   12727.922      200            200            0.0030025165   0.00036914305  0              0.0086384066   95.926924      0              4631967.8      1.1971759e-13  0              3.2462026    
    700000   12727.922      200            200            0.0040138946   0.00040165331  0              0.011640031    31.818068      0              1536380.6      1.1971759e-13  0              3.2455771    
    800000   12727.922      200            200            0.0045379875   0.00042085276  0              0.01319311     3.8952532      0              188087.83      1.1971759e-13  0              3.2452955    
    900000   12727.922      200            200            0.0044649985   0.0004128669   0              0.012982129    0.17082329     0              8248.4452      1.1971759e-13  0              3.2453351    
   1000000   12727.922      200            200            0.004388113    0.00042653828  0              0.012737801    0.11478228     0              5542.4256      1.1971759e-13  0              3.245379     
   1100000   12727.922      200            200            0.0043827182   0.00042627765  0              0.012721877    5.040437e-05   0              2.4338466      1.1971759e-13  0              3.2453816    
   1200000   12727.922      200            200            0.004392338    0.00042549972  0              0.012751514    0.0019505019   0              94.182756      1.1971759e-13  0              3.2453762    
   1300000   12727.922      200            200            0.0043948859   0.00042546609  0              0.012759191    8.4519319e-05  0              4.0811355      1.1971759e-13  0              3.2453749    
   1400000   12727.922      200            200            0.0043940397   0.00042547711  0              0.012756642    1.7765037e-05  0              0.85781007     1.1971759e-13  0              3.2453753    
   1500000   12727.922      200            200            0.0043935398   0.00042548374  0              0.012755136    4.0837436e-06  0              0.19718936     1.1971759e-13  0              3.2453756    
   1600000   12727.922      200            200            0.0043935601   0.00042548341  0              0.012755197    3.5651552e-08  0              0.0017214858   1.1971759e-13  0              3.2453756    
   1700000   12727.922      200            200            0.004393631    0.00042548245  0              0.012755411    9.398496e-08   0              0.0045381974   1.1971759e-13  0              3.2453756    
   1800000   12727.922      200            200            0.0043936415   0.00042548231  0              0.012755442    1.0147249e-09  0              4.8997433e-05  1.1971759e-13  0              3.2453756    
   1900000   12727.922      200            200            0.004393634    0.00042548241  0              0.01275542     1.2403514e-09  0              5.9892129e-05  1.1971759e-13  0              3.2453756    
   2000000   12727.922      200            200            0.0043936312   0.00042548245  0              0.012755411    1.1769116e-10  0              5.6828849e-06  1.1971759e-13  0              3.2453756    
   2100000   12727.922      200            200            0.0043936316   0.00042548244  0              0.012755412    7.3141385e-12  0              3.5317357e-07  1.1971759e-13  0              3.2453756    
   2200000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    3.8469755e-12  0              1.8575668e-07  1.1971759e-13  0              3.2453756    
   2300000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    9.7079739e-18  0              4.6876332e-13  1.1971759e-13  0              3.2453756    
   2400000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    6.8660504e-14  0              3.31537e-09    1.1971759e-13  0              3.2453756    
   2500000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    2.5175535e-15  0              1.2156365e-10  1.1971759e-13  0              3.2453756    
   2600000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    6.1044052e-16  0              2.9475988e-11  1.1971759e-13  0              3.2453756    
   2700000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    1.7501868e-16  0              8.4510257e-12  1.1971759e-13  0              3.2453756    
   2800000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    1.8593731e-17  0              8.9782474e-13  1.1971759e-13  0              3.2453756    
   2900000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    9.1343149e-18  0              4.4106337e-13  1.1971759e-13  0              3.2453756    
   3000000   12727.922      200            200            0.0043936321   0.00042548244  0              0.012755414    1.14716e-18    0              5.5392252e-14  1.1971759e-13  0              3.2453756    
Loop time of 538.872 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4810045.139 ns/day, 0.000 hours/ns, 5567.182 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.437     | 76.76      | 131.91     | 616.7 | 14.24
Neigh   | 4.2215     | 4.264      | 4.3086     |   1.5 |  0.79
Comm    | 17.177     | 23.195     | 27.796     |  90.9 |  4.30
Output  | 0.39472    | 0.39536    | 0.39602    |   0.1 |  0.07
Modify  | 318.2      | 329.76     | 340.59     |  59.0 | 61.19
Other   |            | 104.5      |            |       | 19.39

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         693.25 ave        1387 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2773
Ave neighs/atom = 0.5544891
Neighbor list builds = 155
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.51                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 49.8129947834697
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.61
  ghost atom cutoff = 3.61
  binsize = 1.805, bins = 7052 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 103.6 | 103.6 | 103.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036671291   9.6548299e-41  0              0.011001387    1408532.1      0              6.8012975e+10  1.1971759e-13  0              3.3244606    
    200000   12727.922      200            200           -0.00043854088  5.0773297e-35  0             -0.0013156226   274006.06      0              1.3230772e+10  1.1971759e-13  0              3.2967604    
    300000   12727.922      200            200            0.030148582   -0.0016542485   0              0.092099996    46883.62       0              2.2638422e+09  1.1971759e-13  0              3.2425146    
    400000   12727.922      200            200            0.00013835593 -1.0154591e-34  0              0.0004150678   7330.3022      0              3.5395406e+08  1.1971759e-13  0              3.2573702    
    500000   12727.922      200            200            0.0078335016  -0.00046158402  0              0.023962089    1317.9209      0              63637686       1.1971759e-13  0              3.2486514    
    600000   12727.922      200            200            0.00320611     0.00037190893  0              0.009246421    171.87938      0              8299440        1.1971759e-13  0              3.2510799    
    700000   12727.922      200            200            0.0038918525   0.00035599465  0              0.011319563    18.737127      0              904748.81      1.1971759e-13  0              3.2506457    
    800000   12727.922      200            200            0.0044864904   0.00043248221  0              0.013026989    5.6921762      0              274854.81      1.1971759e-13  0              3.2503317    
    900000   12727.922      200            200            0.0044794878   0.00041294297  0              0.01302552     0.0082542101   0              398.56627      1.1971759e-13  0              3.250334     
   1000000   12727.922      200            200            0.0044070851   0.00042737601  0              0.012793879    0.11468595     0              5537.7739      1.1971759e-13  0              3.2503758    
   1100000   12727.922      200            200            0.0043912573   0.00042809717  0              0.012745675    0.0036576853   0              176.61653      1.1971759e-13  0              3.2503842    
   1200000   12727.922      200            200            0.004397863    0.00042741576  0              0.012766173    0.0010462418   0              50.519274      1.1971759e-13  0              3.2503805    
   1300000   12727.922      200            200            0.0044014854   0.00042735924  0              0.012777097    0.00022909202  0              11.062034      1.1971759e-13  0              3.2503785    
   1400000   12727.922      200            200            0.0044013578   0.00042736143  0              0.012776712    1.1281305e-06  0              0.054473383    1.1971759e-13  0              3.2503786    
   1500000   12727.922      200            200            0.0044008435   0.00042736885  0              0.012775162    5.1187881e-06  0              0.24716796     1.1971759e-13  0              3.2503789    
   1600000   12727.922      200            200            0.0044007491   0.00042737019  0              0.012774877    1.2104236e-07  0              0.0058447024   1.1971759e-13  0              3.2503789    
   1700000   12727.922      200            200            0.0044007977   0.00042736946  0              0.012775024    5.2143134e-08  0              0.0025178053   1.1971759e-13  0              3.2503789    
   1800000   12727.922      200            200            0.0044008209   0.00042736912  0              0.012775094    9.2585028e-09  0              0.00044705996  1.1971759e-13  0              3.2503789    
   1900000   12727.922      200            200            0.0044008194   0.00042736915  0              0.012775089    9.6015011e-11  0              4.6362212e-06  1.1971759e-13  0              3.2503789    
   2000000   12727.922      200            200            0.004400816    0.0004273692   0              0.012775079    2.2630236e-10  0              1.0927331e-05  1.1971759e-13  0              3.2503789    
   2100000   12727.922      200            200            0.0044008154   0.00042736921  0              0.012775077    3.7867909e-12  0              1.8285058e-07  1.1971759e-13  0              3.2503789    
   2200000   12727.922      200            200            0.0044008158   0.0004273692   0              0.012775078    2.5531622e-12  0              1.2328306e-07  1.1971759e-13  0              3.2503789    
   2300000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775079    3.6925823e-13  0              1.7830158e-08  1.1971759e-13  0              3.2503789    
   2400000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775079    6.7482053e-15  0              3.2584668e-10  1.1971759e-13  0              3.2503789    
   2500000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    9.9309206e-15  0              4.7952861e-10  1.1971759e-13  0              3.2503789    
   2600000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    1.3197227e-16  0              6.3724687e-12  1.1971759e-13  0              3.2503789    
   2700000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    4.9633697e-17  0              2.3966336e-12  1.1971759e-13  0              3.2503789    
   2800000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    1.1073342e-17  0              5.3469205e-13  1.1971759e-13  0              3.2503789    
   2900000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    2.9704342e-19  0              1.4343164e-14  1.1971759e-13  0              3.2503789    
   3000000   12727.922      200            200            0.0044008159   0.0004273692   0              0.012775078    7.6350584e-18  0              3.6866965e-13  1.1971759e-13  0              3.2503789    
Loop time of 542.982 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4773642.923 ns/day, 0.000 hours/ns, 5525.050 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.364     | 76.707     | 131.9      | 616.6 | 14.13
Neigh   | 4.2467     | 4.288      | 4.3305     |   1.4 |  0.79
Comm    | 17.078     | 23.298     | 27.786     |  90.6 |  4.29
Output  | 0.40286    | 0.40348    | 0.40414    |   0.1 |  0.07
Modify  | 322.33     | 333.8      | 345.69     |  59.6 | 61.48
Other   |            | 104.5      |            |       | 19.24

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         697.75 ave        1396 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2791
Ave neighs/atom = 0.55808838
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.52                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.2399609964769
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.62
  ghost atom cutoff = 3.62
  binsize = 1.81, bins = 7033 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 103.4 | 103.4 | 103.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036765203  -3.0463785e-34  0              0.011029561    1413435.9      0              6.8249759e+10  1.1971759e-13  0              3.3240958    
    200000   12727.922      200            200           -0.00043928098  1.5231938e-34  0             -0.0013178429   266120.44      0              1.2850004e+10  1.1971759e-13  0              3.3050255    
    300000   12727.922      200            200            0.022269099   -0.0014198482   0              0.068227146    65045.321      0              3.1408058e+09  1.1971759e-13  0              3.2492529    
    400000   12727.922      200            200            0.00015197606  8.9563373e-41  0              0.00045592818  8712.7471      0              4.2070738e+08  1.1971759e-13  0              3.2616602    
    500000   12727.922      200            200            0.0071245632   9.4037908e-05  0              0.021279652    1879.8904      0              90773182       1.1971759e-13  0              3.2540194    
    600000   12727.922      200            200            0.0034631776   0.0003522108   0              0.010037322    250.87434      0              12113824       1.1971759e-13  0              3.2559237    
    700000   12727.922      200            200            0.0038173869   0.00034971562  0              0.011102445    7.4113114      0              357865.7       1.1971759e-13  0              3.2556953    
    800000   12727.922      200            200            0.0044305851   0.00045422101  0              0.012837534    6.5727193      0              317373.09      1.1971759e-13  0              3.2553724    
    900000   12727.922      200            200            0.0044834829   0.00041317447  0              0.013037274    0.058725569    0              2835.6476      1.1971759e-13  0              3.2553385    
   1000000   12727.922      200            200            0.0044244723   0.00042635884  0              0.012847058    0.08140753     0              3930.8783      1.1971759e-13  0              3.255373     
   1100000   12727.922      200            200            0.004401117    0.00042824184  0              0.012775109    0.010409239    0              502.62488      1.1971759e-13  0              3.2553858    
   1200000   12727.922      200            200            0.004403533    0.00042770959  0              0.012782889    0.00017357198  0              8.3811698      1.1971759e-13  0              3.2553843    
   1300000   12727.922      200            200            0.004407367    0.00042764089  0              0.01279446     0.00028713876  0              13.864903      1.1971759e-13  0              3.2553822    
   1400000   12727.922      200            200            0.0044079657   0.00042763176  0              0.012796265    5.7714714e-06  0              0.2786837      1.1971759e-13  0              3.2553819    
   1500000   12727.922      200            200            0.0044075978   0.00042763769  0              0.012795156    2.8351341e-06  0              0.13689848     1.1971759e-13  0              3.2553821    
   1600000   12727.922      200            200            0.0044074269   0.0004276404   0              0.01279464     5.4327538e-07  0              0.026232824    1.1971759e-13  0              3.2553822    
   1700000   12727.922      200            200            0.0044074342   0.00042764026  0              0.012794662    1.9911584e-09  0              9.6145913e-05  1.1971759e-13  0              3.2553822    
   1800000   12727.922      200            200            0.004407459    0.00042763986  0              0.012794737    1.2089085e-08  0              0.00058373867  1.1971759e-13  0              3.2553822    
   1900000   12727.922      200            200            0.0044074641   0.00042763978  0              0.012794752    4.4421719e-10  0              2.1449659e-05  1.1971759e-13  0              3.2553822    
   2000000   12727.922      200            200            0.004407462    0.00042763982  0              0.012794746    9.1672665e-11  0              4.4265449e-06  1.1971759e-13  0              3.2553822    
   2100000   12727.922      200            200            0.0044074608   0.00042763984  0              0.012794743    2.6897597e-11  0              1.2987887e-06  1.1971759e-13  0              3.2553822    
   2200000   12727.922      200            200            0.0044074608   0.00042763984  0              0.012794743    7.1802257e-17  0              3.467074e-12   1.1971759e-13  0              3.2553822    
   2300000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    4.8794435e-13  0              2.3561086e-08  1.1971759e-13  0              3.2553822    
   2400000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    2.8905951e-14  0              1.3957649e-09  1.1971759e-13  0              3.2553822    
   2500000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    2.6188974e-15  0              1.2645718e-10  1.1971759e-13  0              3.2553822    
   2600000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    1.292291e-15   0              6.2400106e-11  1.1971759e-13  0              3.2553822    
   2700000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    4.7098547e-17  0              2.2742203e-12  1.1971759e-13  0              3.2553822    
   2800000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    1.1409926e-18  0              5.5094448e-14  1.1971759e-13  0              3.2553822    
   2900000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    5.4230139e-19  0              2.6185793e-14  1.1971759e-13  0              3.2553822    
   3000000   12727.922      200            200            0.004407461    0.00042763983  0              0.012794743    5.7142503e-18  0              2.759207e-13   1.1971759e-13  0              3.2553822    
Loop time of 546.283 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4744790.572 ns/day, 0.000 hours/ns, 5491.656 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.61      | 77.225     | 132.53     | 617.3 | 14.14
Neigh   | 4.287      | 4.3317     | 4.3784     |   1.6 |  0.79
Comm    | 17.257     | 23.541     | 28.111     |  89.4 |  4.31
Output  | 0.53188    | 0.5325     | 0.53314    |   0.1 |  0.10
Modify  | 322.29     | 334.78     | 347.96     |  64.5 | 61.28
Other   |            | 105.9      |            |       | 19.38

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         702.75 ave        1406 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2811
Ave neighs/atom = 0.56208758
Neighbor list builds = 161
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.53                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 50.6693600588351
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.63
  ghost atom cutoff = 3.63
  binsize = 1.815, bins = 7013 111 111
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 103.2 | 103.2 | 103.2 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036859112   1.5927726e-42  0              0.011057733    1418346.1      0              6.8486856e+10  1.1971759e-13  0              3.3237188    
    200000   12727.922      200            200           -0.00043980335  1.0154682e-34  0             -0.0013194101   258357.14      0              1.2475142e+10  1.1971759e-13  0              3.3132461    
    300000   12727.922      200            200            0.014402527   -0.0021148366   0              0.045322417    78373.807      0              3.7843907e+09  1.1971759e-13  0              3.2562252    
    400000   12727.922      200            200            0.00016576001 -1.5231855e-34  0              0.00049728004  10212.243      0              4.9311269e+08  1.1971759e-13  0              3.2658877    
    500000   12727.922      200            200            0.0063068823   0.00054267236  0              0.018377974    2341.5764      0              1.1306634e+08  1.1971759e-13  0              3.2594431    
    600000   12727.922      200            200            0.0037442164   0.00023943783  0              0.010993211    317.95008      0              15352671       1.1971759e-13  0              3.2607413    
    700000   12727.922      200            200            0.0037790408   0.00033543467  0              0.011001688    0.87379598     0              42192.481      1.1971759e-13  0              3.2607227    
    800000   12727.922      200            200            0.0043676139   0.00045745037  0              0.012645391    6.213124       0              300009.52      1.1971759e-13  0              3.2604139    
    900000   12727.922      200            200            0.0044766005   0.00041144594  0              0.013018356    0.29609188     0              14297.217      1.1971759e-13  0              3.2603485    
   1000000   12727.922      200            200            0.0044384824   0.0004233901   0              0.012892057    0.035109084    0              1695.292       1.1971759e-13  0              3.2603717    
   1100000   12727.922      200            200            0.0044115221   0.00042627244  0              0.012808294    0.015360094    0              741.68399      1.1971759e-13  0              3.2603867    
   1200000   12727.922      200            200            0.0044094128   0.00042592118  0              0.012802317    7.9205983e-05  0              3.8245735      1.1971759e-13  0              3.2603876    
   1300000   12727.922      200            200            0.0044125869   0.00042585627  0              0.012811905    0.00020151127  0              9.7302582      1.1971759e-13  0              3.2603859    
   1400000   12727.922      200            200            0.0044137264   0.00042583561  0              0.012815344    2.596511e-05   0              1.2537622      1.1971759e-13  0              3.2603853    
   1500000   12727.922      200            200            0.0044136129   0.00042583782  0              0.012815001    2.5603078e-07  0              0.01236281     1.1971759e-13  0              3.2603854    
   1600000   12727.922      200            200            0.0044134287   0.00042584117  0              0.012814445    6.7763655e-07  0              0.032720644    1.1971759e-13  0              3.2603855    
   1700000   12727.922      200            200            0.0044133934   0.00042584179  0              0.012814338    2.5039848e-08  0              0.0012090846   1.1971759e-13  0              3.2603855    
   1800000   12727.922      200            200            0.0044134084   0.00042584151  0              0.012814384    4.4954545e-09  0              0.00021706941  1.1971759e-13  0              3.2603855    
   1900000   12727.922      200            200            0.0044134173   0.00042584135  0              0.01281441     1.573603e-09   0              7.5983658e-05  1.1971759e-13  0              3.2603855    
   2000000   12727.922      200            200            0.0044134177   0.00042584134  0              0.012814412    3.5996553e-12  0              1.7381447e-07  1.1971759e-13  0              3.2603855    
   2100000   12727.922      200            200            0.0044134166   0.00042584136  0              0.012814408    2.3084521e-11  0              1.1146689e-06  1.1971759e-13  0              3.2603855    
   2200000   12727.922      200            200            0.0044134162   0.00042584137  0              0.012814407    2.4806888e-12  0              1.1978359e-07  1.1971759e-13  0              3.2603855    
   2300000   12727.922      200            200            0.0044134163   0.00042584137  0              0.012814408    4.544857e-14   0              2.1945488e-09  1.1971759e-13  0              3.2603855    
   2400000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    7.2838154e-14  0              3.5170938e-09  1.1971759e-13  0              3.2603855    
   2500000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    2.1064621e-15  0              1.0171351e-10  1.1971759e-13  0              3.2603855    
   2600000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    4.9320034e-16  0              2.3814879e-11  1.1971759e-13  0              3.2603855    
   2700000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    1.7646838e-16  0              8.5210264e-12  1.1971759e-13  0              3.2603855    
   2800000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    2.3484551e-17  0              1.1339849e-12  1.1971759e-13  0              3.2603855    
   2900000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    1.3682947e-17  0              6.6070052e-13  1.1971759e-13  0              3.2603855    
   3000000   12727.922      200            200            0.0044134164   0.00042584137  0              0.012814408    1.1056017e-17  0              5.3385549e-13  1.1971759e-13  0              3.2603855    
Loop time of 538.181 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4816223.005 ns/day, 0.000 hours/ns, 5574.332 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.227     | 75.378     | 128.89     | 604.9 | 14.01
Neigh   | 4.1925     | 4.2339     | 4.2776     |   1.5 |  0.79
Comm    | 17.585     | 23.688     | 28.157     |  85.0 |  4.40
Output  | 0.5867     | 0.58736    | 0.58805    |   0.1 |  0.11
Modify  | 314.82     | 328.99     | 342.35     |  72.4 | 61.13
Other   |            | 105.3      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         657.25 ave        1315 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2629
Ave neighs/atom = 0.52569486
Neighbor list builds = 158
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.54                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.1011988820483
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.64
  ghost atom cutoff = 3.64
  binsize = 1.82, bins = 6994 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 101.3 | 101.3 | 101.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0036953016   7.5200947e-42  0              0.011085905    1423262.7      0              6.8724264e+10  1.1971759e-13  0              3.3233293    
    200000   12727.922      200            200           -0.00044010893  4.7599697e-36  0             -0.0013203268   250715.76      0              1.2106167e+10  1.1971759e-13  0              3.3214223    
    300000   12727.922      200            200            0.0087204908   0.000354383    0              0.025807089    85599.048      0              4.1332717e+09  1.1971759e-13  0              3.2633365    
    400000   12727.922      200            200            0.00017970655  2.2257505e-40  0              0.00053911966  11828.289      0              5.7114573e+08  1.1971759e-13  0              3.2700525    
    500000   12727.922      200            200            0.0054152025   0.00078995749  0              0.01545565     2633.4088      0              1.2715789e+08  1.1971759e-13  0              3.2649037    
    600000   12727.922      200            200            0.0041101082   0.00024534425  0              0.01208498     359.37851      0              17353102       1.1971759e-13  0              3.2655414    
    700000   12727.922      200            200            0.0037844388   0.0003295807   0              0.011023736    0.83177619     0              40163.496      1.1971759e-13  0              3.2657264    
    800000   12727.922      200            200            0.0042993804   0.00042719706  0              0.012470944    4.7612023      0              229901.42      1.1971759e-13  0              3.2654525    
    900000   12727.922      200            200            0.0044600907   0.00040655001  0              0.012973722    0.60313371     0              29123.168      1.1971759e-13  0              3.2653631    
   1000000   12727.922      200            200            0.0044476014   0.00041792346  0              0.012924881    0.0036384722   0              175.6888       1.1971759e-13  0              3.2653725    
   1100000   12727.922      200            200            0.0044213137   0.00042129366  0              0.012842648    0.014931376    0              720.98269      1.1971759e-13  0              3.2653873    
   1200000   12727.922      200            200            0.0044152124   0.00042114404  0              0.012824493    0.00083238483  0              40.192884      1.1971759e-13  0              3.2653905    
   1300000   12727.922      200            200            0.0044170411   0.00042110202  0              0.012830021    5.8900245e-05  0              2.844082       1.1971759e-13  0              3.2653895    
   1400000   12727.922      200            200            0.0044184021   0.00042107354  0              0.012834133    3.8393418e-05  0              1.8538807      1.1971759e-13  0              3.2653887    
   1500000   12727.922      200            200            0.0044185683   0.00042107033  0              0.012834635    7.1263174e-07  0              0.034410436    1.1971759e-13  0              3.2653886    
   1600000   12727.922      200            200            0.0044184358   0.00042107308  0              0.012834234    3.3239943e-07  0              0.016050379    1.1971759e-13  0              3.2653887    
   1700000   12727.922      200            200            0.0044183734   0.00042107435  0              0.012834046    8.2814417e-08  0              0.0039988118   1.1971759e-13  0              3.2653887    
   1800000   12727.922      200            200            0.0044183723   0.00042107436  0              0.012834042    9.3257123e-11  0              4.5030527e-06  1.1971759e-13  0              3.2653887    
   1900000   12727.922      200            200            0.0044183803   0.00042107419  0              0.012834067    1.275652e-09   0              6.1596671e-05  1.1971759e-13  0              3.2653887    
   2000000   12727.922      200            200            0.0044183829   0.00042107414  0              0.012834075    1.4646872e-10  0              7.0724501e-06  1.1971759e-13  0              3.2653887    
   2100000   12727.922      200            200            0.0044183826   0.00042107415  0              0.012834074    1.2863086e-12  0              6.2111238e-08  1.1971759e-13  0              3.2653887    
   2200000   12727.922      200            200            0.0044183822   0.00042107416  0              0.012834072    3.8721553e-12  0              1.8697252e-07  1.1971759e-13  0              3.2653887    
   2300000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    1.967314e-13   0              9.499455e-09   1.1971759e-13  0              3.2653887    
   2400000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    1.6355319e-14  0              7.8973981e-10  1.1971759e-13  0              3.2653887    
   2500000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    9.7828289e-15  0              4.723778e-10   1.1971759e-13  0              3.2653887    
   2600000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    1.8567348e-16  0              8.9655079e-12  1.1971759e-13  0              3.2653887    
   2700000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    2.3584144e-17  0              1.1387939e-12  1.1971759e-13  0              3.2653887    
   2800000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    3.5082962e-18  0              1.6940307e-13  1.1971759e-13  0              3.2653887    
   2900000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    6.331444e-19   0              3.0572277e-14  1.1971759e-13  0              3.2653887    
   3000000   12727.922      200            200            0.0044183821   0.00042107416  0              0.012834072    2.453019e-18   0              1.1844751e-13  1.1971759e-13  0              3.2653887    
Loop time of 535.859 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4837095.081 ns/day, 0.000 hours/ns, 5598.490 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.787     | 75.828     | 130.06     | 603.9 | 14.15
Neigh   | 3.9866     | 4.0263     | 4.0684     |   1.4 |  0.75
Comm    | 16.866     | 23.059     | 27.312     |  90.3 |  4.30
Output  | 0.40294    | 0.4036     | 0.40427    |   0.1 |  0.08
Modify  | 315.18     | 328.19     | 341.01     |  65.8 | 61.25
Other   |            | 104.3      |            |       | 19.47

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         663.75 ave        1328 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2655
Ave neighs/atom = 0.53089382
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.55                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.5354843776197
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.65
  ghost atom cutoff = 3.65
  binsize = 1.825, bins = 6975 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 101.1 | 101.1 | 101.1 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037046916   2.6394681e-41  0              0.011114075    1428185.9      0              6.8961984e+10  1.1971759e-13  0              3.3229274    
    200000   12727.922      200            200           -0.00044019866  2.5386521e-35  0             -0.001320596    243196.02      0              1.1743065e+10  1.1971759e-13  0              3.3295539    
    300000   12727.922      200            200            0.0039056879   0.00049288288  0              0.011224181    87229.941      0              4.2120217e+09  1.1971759e-13  0              3.2705054    
    400000   12727.922      200            200            0.0003309222  -1.7135179e-05  0              0.0010099018   13541.357      0              6.5386367e+08  1.1971759e-13  0              3.2741546    
    500000   12727.922      200            200            0.0043435819   0.0003504327   0              0.012680313    2723.496       0              1.3150787e+08  1.1971759e-13  0              3.2703822    
    600000   12727.922      200            200            0.0044815766   0.00017681519  0              0.013267915    365.57793      0              17652450       1.1971759e-13  0              3.2703342    
    700000   12727.922      200            200            0.0038303555   0.00032241839  0              0.011168648    7.2520574      0              350175.9       1.1971759e-13  0              3.2707063    
    800000   12727.922      200            200            0.0042461571   0.00040631439  0              0.012332157    2.7688849      0              133699.54      1.1971759e-13  0              3.2704849    
    900000   12727.922      200            200            0.0044386079   0.00040419062  0              0.012911633    0.82963287     0              40060.002      1.1971759e-13  0              3.2703809    
   1000000   12727.922      200            200            0.0044511811   0.00041010031  0              0.012943443    0.005756024    0              277.9378       1.1971759e-13  0              3.2703759    
   1100000   12727.922      200            200            0.004429566    0.00041331658  0              0.012875382    0.0094609073   0              456.83336      1.1971759e-13  0              3.2703882    
   1200000   12727.922      200            200            0.0044207441   0.00041339542  0              0.012848837    0.0017807402   0              85.985569      1.1971759e-13  0              3.2703929    
   1300000   12727.922      200            200            0.004420869    0.0004133908   0              0.012849216    7.2416564e-07  0              0.034967367    1.1971759e-13  0              3.2703928    
   1400000   12727.922      200            200            0.0044220889   0.00041336204  0              0.012852905    2.9005359e-05  0              1.400565       1.1971759e-13  0              3.2703921    
   1500000   12727.922      200            200            0.0044224743   0.00041335339  0              0.01285407     3.5688574e-06  0              0.17232735     1.1971759e-13  0              3.2703919    
   1600000   12727.922      200            200            0.0044224375   0.0004133543   0              0.012853958    1.0109867e-08  0              0.00048816929  1.1971759e-13  0              3.270392     
   1700000   12727.922      200            200            0.0044223736   0.00041335576  0              0.012853765    8.2243876e-08  0              0.0039712625   1.1971759e-13  0              3.270392     
   1800000   12727.922      200            200            0.0044223575   0.00041335612  0              0.012853716    6.5624766e-09  0              0.00031687851  1.1971759e-13  0              3.270392     
   1900000   12727.922      200            200            0.0044223608   0.00041335604  0              0.012853726    1.3943725e-10  0              6.7329257e-06  1.1971759e-13  0              3.270392     
   2000000   12727.922      200            200            0.004422364    0.00041335596  0              0.012853736    2.1810441e-10  0              1.0531481e-05  1.1971759e-13  0              3.270392     
   2100000   12727.922      200            200            0.0044223646   0.00041335595  0              0.012853738    1.076403e-11   0              5.1975648e-07  1.1971759e-13  0              3.270392     
   2200000   12727.922      200            200            0.0044223644   0.00041335596  0              0.012853737    8.1331991e-13  0              3.9272308e-08  1.1971759e-13  0              3.270392     
   2300000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    5.4433469e-13  0              2.6283974e-08  1.1971759e-13  0              3.270392     
   2400000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    1.4793941e-14  0              7.1434644e-10  1.1971759e-13  0              3.270392     
   2500000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    3.4047592e-15  0              1.6440364e-10  1.1971759e-13  0              3.270392     
   2600000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    1.2966076e-15  0              6.2608539e-11  1.1971759e-13  0              3.270392     
   2700000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    7.1691082e-17  0              3.4617058e-12  1.1971759e-13  0              3.270392     
   2800000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    4.9208073e-18  0              2.3760817e-13  1.1971759e-13  0              3.270392     
   2900000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    2.1906573e-18  0              1.05779e-13    1.1971759e-13  0              3.270392     
   3000000   12727.922      200            200            0.0044223642   0.00041335596  0              0.012853737    6.2719047e-18  0              3.0284783e-13  1.1971759e-13  0              3.270392     
Loop time of 538.892 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4809864.757 ns/day, 0.000 hours/ns, 5566.973 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.699     | 75.794     | 129.89     | 607.7 | 14.06
Neigh   | 3.9194     | 3.9589     | 4.0005     |   1.4 |  0.73
Comm    | 16.964     | 22.714     | 27.079     |  86.6 |  4.21
Output  | 0.47698    | 0.47759    | 0.47824    |   0.1 |  0.09
Modify  | 316.27     | 330.08     | 343.58     |  71.3 | 61.25
Other   |            | 105.9      |            |       | 19.65

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         669.25 ave        1339 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2677
Ave neighs/atom = 0.53529294
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.56                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 51.9722234570539
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.66
  ghost atom cutoff = 3.66
  binsize = 1.83, bins = 6956 110 110
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 100.8 | 100.9 | 100.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.003714081   -1.2693227e-35  0              0.011142243    1433115.4      0              6.9200016e+10  1.1971759e-13  0              3.3225131    
    200000   12727.922      200            200           -0.0004400735  -3.807972e-35   0             -0.0013202205   235797.57      0              1.1385821e+10  1.1971759e-13  0              3.3376408    
    300000   12727.922      200            200            0.0008025035   0.00010554126  0              0.0023019692   84891.648      0              4.0991139e+09  1.1971759e-13  0              3.2776708    
    400000   12727.922      200            200            0.0008586737  -1.9980309e-05  0              0.0025960014   15218.698      0              7.3485646e+08  1.1971759e-13  0              3.2781965    
    500000   12727.922      200            200            0.0035076581   0.00034694063  0              0.010176034    2616.8218      0              1.2635696e+08  1.1971759e-13  0              3.2758602    
    600000   12727.922      200            200            0.0049250834   0.00029127655  0              0.014483974    333.65928      0              16111213       1.1971759e-13  0              3.2751306    
    700000   12727.922      200            200            0.0039186441   0.0003257819   0              0.01143015     18.375772      0              887300.27      1.1971759e-13  0              3.2756642    
    800000   12727.922      200            200            0.0042103111   0.00038748656  0              0.012243447    0.97905675     0              47275.147      1.1971759e-13  0              3.2755083    
    900000   12727.922      200            200            0.0044147813   0.00040189226  0              0.012842452    0.86592352     0              41812.348      1.1971759e-13  0              3.2754       
   1000000   12727.922      200            200            0.004449839    0.0004016254   0              0.012947892    0.039946671    0              1928.8818      1.1971759e-13  0              3.2753818    
   1100000   12727.922      200            200            0.0044362039   0.00040459361  0              0.012904018    0.0029121635   0              140.61795      1.1971759e-13  0              3.2753898    
   1200000   12727.922      200            200            0.0044263632   0.00040480069  0              0.012874289    0.0021147448   0              102.11346      1.1971759e-13  0              3.2753951    
   1300000   12727.922      200            200            0.0044248152   0.00040483745  0              0.012869608    8.3105017e-05  0              4.0128439      1.1971759e-13  0              3.2753959    
   1400000   12727.922      200            200            0.0044255834   0.00040481778  0              0.012871932    8.5901001e-06  0              0.41478519     1.1971759e-13  0              3.2753955    
   1500000   12727.922      200            200            0.0044260646   0.000404806    0              0.012873388    5.1381545e-06  0              0.24810309     1.1971759e-13  0              3.2753952    
   1600000   12727.922      200            200            0.0044261327   0.00040480442  0              0.012873594    1.7048485e-07  0              0.0082321032   1.1971759e-13  0              3.2753952    
   1700000   12727.922      200            200            0.0044260923   0.00040480542  0              0.012873471    2.4791245e-08  0              0.0011970805   1.1971759e-13  0              3.2753952    
   1800000   12727.922      200            200            0.0044260688   0.00040480599  0              0.0128734      1.2421726e-08  0              0.00059980068  1.1971759e-13  0              3.2753952    
   1900000   12727.922      200            200            0.0044260658   0.00040480606  0              0.012873391    3.426222e-10   0              1.6544e-05     1.1971759e-13  0              3.2753953    
   2000000   12727.922      200            200            0.004426068    0.00040480601  0              0.012873398    7.0203501e-11  0              3.3898758e-06  1.1971759e-13  0              3.2753952    
   2100000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    2.9876483e-11  0              1.4426285e-06  1.1971759e-13  0              3.2753952    
   2200000   12727.922      200            200            0.0044260692   0.00040480598  0              0.012873402    6.7160429e-13  0              3.2429368e-08  1.1971759e-13  0              3.2753952    
   2300000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    1.963309e-13   0              9.4801163e-09  1.1971759e-13  0              3.2753952    
   2400000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    7.1417534e-14  0              3.4484971e-09  1.1971759e-13  0              3.2753952    
   2500000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    1.3123068e-15  0              6.3366598e-11  1.1971759e-13  0              3.2753952    
   2600000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    4.6836461e-16  0              2.2615651e-11  1.1971759e-13  0              3.2753952    
   2700000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    1.6548774e-16  0              7.9908106e-12  1.1971759e-13  0              3.2753952    
   2800000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    2.4233628e-17  0              1.1701552e-12  1.1971759e-13  0              3.2753952    
   2900000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    2.8702467e-18  0              1.3859394e-13  1.1971759e-13  0              3.2753952    
   3000000   12727.922      200            200            0.0044260691   0.00040480598  0              0.012873401    5.1082889e-18  0              2.4666099e-13  1.1971759e-13  0              3.2753952    
Loop time of 537.961 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4818196.385 ns/day, 0.000 hours/ns, 5576.616 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.264     | 75.643     | 129.73     | 607.4 | 14.06
Neigh   | 3.9201     | 3.961      | 4.0041     |   1.5 |  0.74
Comm    | 16.597     | 23.521     | 28.793     | 109.3 |  4.37
Output  | 0.41523    | 0.41589    | 0.41657    |   0.1 |  0.08
Modify  | 318.5      | 330.37     | 341.71     |  60.3 | 61.41
Other   |            | 104.1      |            |       | 19.34

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         674.25 ave        1349 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2697
Ave neighs/atom = 0.53929214
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.57                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.411423031854
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.67
  ghost atom cutoff = 3.67
  binsize = 1.835, bins = 6937 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 99.12 | 99.13 | 99.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037234699  -3.0463783e-34  0              0.01117041     1438051.5      0              6.9438358e+10  1.1971759e-13  0              3.3220863    
    200000   12727.922      200            200           -0.00043973439 -2.5386363e-35  0             -0.0013192032   228520.1       0              1.1034418e+10  1.1971759e-13  0              3.3456831    
    300000   12727.922      200            200           -0.00031660171  1.3068536e-06  0             -0.00095111199  80598.114      0              3.8917945e+09  1.1971759e-13  0              3.2847948    
    400000   12727.922      200            200            0.0018306551   1.5197011e-05  0              0.0054767682   16639.795      0              8.0347613e+08  1.1971759e-13  0              3.2821858    
    500000   12727.922      200            200            0.0028494907   0.00052869939  0              0.0080197726   2346.8893      0              1.1332289e+08  1.1971759e-13  0              3.2813215    
    600000   12727.922      200            200            0.0053588324   0.00041562964  0              0.015660867    268.93067      0              12985700       1.1971759e-13  0              3.2799418    
    700000   12727.922      200            200            0.0040438129   0.00033631249  0              0.011795126    31.157799      0              1504498.6      1.1971759e-13  0              3.2806032    
    800000   12727.922      200            200            0.004196284    0.00037437575  0              0.012214476    0.049833558    0              2406.2842      1.1971759e-13  0              3.2805208    
    900000   12727.922      200            200            0.0043922118   0.00039930333  0              0.012777332    0.69551935     0              33584.14       1.1971759e-13  0              3.2804185    
   1000000   12727.922      200            200            0.0044446442   0.00039334475  0              0.012940588    0.085407633    0              4124.0289      1.1971759e-13  0              3.2803898    
   1100000   12727.922      200            200            0.0044409442   0.00039598416  0              0.012926848    2.5095167e-07  0              0.012117558    1.1971759e-13  0              3.2803925    
   1200000   12727.922      200            200            0.0044319101   0.00039618255  0              0.012899548    0.0015527048   0              74.974558      1.1971759e-13  0              3.2803974    
   1300000   12727.922      200            200            0.0044290853   0.00039625327  0              0.012891003    0.00022350991  0              10.792494      1.1971759e-13  0              3.2803989    
   1400000   12727.922      200            200            0.0044292194   0.00039624912  0              0.012891409    1.6688281e-07  0              0.0080581738   1.1971759e-13  0              3.2803988    
   1500000   12727.922      200            200            0.0044296496   0.00039623782  0              0.012892711    3.4284431e-06  0              0.16554725     1.1971759e-13  0              3.2803986    
   1600000   12727.922      200            200            0.0044297957   0.00039623409  0              0.012893153    5.7854869e-07  0              0.027936046    1.1971759e-13  0              3.2803985    
   1700000   12727.922      200            200            0.0044297936   0.00039623417  0              0.012893147    1.7071435e-09  0              8.2431848e-05  1.1971759e-13  0              3.2803985    
   1800000   12727.922      200            200            0.0044297731   0.0003962347   0              0.012893085    7.4606408e-09  0              0.00036024764  1.1971759e-13  0              3.2803985    
   1900000   12727.922      200            200            0.0044297656   0.0003962349   0              0.012893062    1.4800053e-09  0              7.146416e-05   1.1971759e-13  0              3.2803985    
   2000000   12727.922      200            200            0.0044297655   0.0003962349   0              0.012893062    9.4027525e-12  0              4.5402527e-07  1.1971759e-13  0              3.2803985    
   2100000   12727.922      200            200            0.0044297665   0.00039623487  0              0.012893065    1.59771e-11    0              7.7147699e-07  1.1971759e-13  0              3.2803985    
   2200000   12727.922      200            200            0.0044297669   0.00039623486  0              0.012893066    3.7453526e-12  0              1.8084967e-07  1.1971759e-13  0              3.2803985    
   2300000   12727.922      200            200            0.0044297669   0.00039623486  0              0.012893066    4.0512398e-14  0              1.9561987e-09  1.1971759e-13  0              3.2803985    
   2400000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    3.3461526e-14  0              1.6157373e-09  1.1971759e-13  0              3.2803985    
   2500000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    9.4059335e-15  0              4.5417886e-10  1.1971759e-13  0              3.2803985    
   2600000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    1.9220653e-16  0              9.2809655e-12  1.1971759e-13  0              3.2803985    
   2700000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    9.15679e-18    0              4.4214862e-13  1.1971759e-13  0              3.2803985    
   2800000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    8.0469607e-19  0              3.8855893e-14  1.1971759e-13  0              3.2803985    
   2900000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    2.7929784e-18  0              1.3486293e-13  1.1971759e-13  0              3.2803985    
   3000000   12727.922      200            200            0.0044297668   0.00039623486  0              0.012893066    2.5087413e-19  0              1.2113814e-14  1.1971759e-13  0              3.2803985    
Loop time of 540.382 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4796603.176 ns/day, 0.000 hours/ns, 5551.624 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.429     | 76.44      | 131.18     | 609.6 | 14.15
Neigh   | 3.8449     | 3.8857     | 3.9274     |   1.5 |  0.72
Comm    | 16.908     | 23.777     | 28.987     | 105.6 |  4.40
Output  | 0.41077    | 0.41141    | 0.41206    |   0.1 |  0.08
Modify  | 318.69     | 330.74     | 341.95     |  61.2 | 61.20
Other   |            | 105.1      |            |       | 19.46

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         679.75 ave        1360 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2719
Ave neighs/atom = 0.54369126
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.58                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 52.8530900135247
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.68
  ghost atom cutoff = 3.68
  binsize = 1.84, bins = 6918 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 98.84 | 98.86 | 98.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037328582  -1.2693216e-35  0              0.011198575    1442993.9      0              6.9677012e+10  1.1971759e-13  0              3.321647     
    200000   12727.922      200            200           -0.00043918228  1.2693263e-34  0             -0.0013175468   221363.28      0              1.0688841e+10  1.1971759e-13  0              3.3536805    
    300000   12727.922      200            200           -0.00031988599  8.05989e-41    0             -0.00095965797  76043.64       0              3.6718752e+09  1.1971759e-13  0              3.291863     
    400000   12727.922      200            200            0.0032979246   0.0001104663   0              0.0097833076   17532.315      0              8.4657272e+08  1.1971759e-13  0              3.2861367    
    500000   12727.922      200            200            0.0021968694   0.00034594566  0              0.0062446624   1964.2893      0              94848500       1.1971759e-13  0              3.2867517    
    600000   12727.922      200            200            0.0057399688   0.00050098726  0              0.016718919    184.5926       0              8913316.2      1.1971759e-13  0              3.2847787    
    700000   12727.922      200            200            0.0042034601   0.00036685652  0              0.012243524    42.049443      0              2030417.1      1.1971759e-13  0              3.2855277    
    800000   12727.922      200            200            0.0042046191   0.00036430695  0              0.01224955     0.31593138     0              15255.195      1.1971759e-13  0              3.2855216    
    900000   12727.922      200            200            0.0043737254   0.00039438344  0              0.012726793    0.40180645     0              19401.795      1.1971759e-13  0              3.2854344    
   1000000   12727.922      200            200            0.0044361878   0.00038279422  0              0.012925769    0.11456612     0              5531.9879      1.1971759e-13  0              3.2853991    
   1100000   12727.922      200            200            0.0044427616   0.00038504684  0              0.012943238    0.0028137022   0              135.86361      1.1971759e-13  0              3.2853963    
   1200000   12727.922      200            200            0.0044361866   0.00038520404  0              0.012923356    0.00057274484  0              27.655799      1.1971759e-13  0              3.2853998    
   1300000   12727.922      200            200            0.0044327468   0.00038529443  0              0.012912946    0.00028318743  0              13.674107      1.1971759e-13  0              3.2854017    
   1400000   12727.922      200            200            0.0044322331   0.00038530798  0              0.012911391    1.3070824e-05  0              0.6311433      1.1971759e-13  0              3.285402     
   1500000   12727.922      200            200            0.0044324862   0.00038530079  0              0.012912158    6.2788708e-07  0              0.03031842     1.1971759e-13  0              3.2854018    
   1600000   12727.922      200            200            0.0044326579   0.00038529607  0              0.012912678    6.511548e-07   0              0.031441935    1.1971759e-13  0              3.2854017    
   1700000   12727.922      200            200            0.0044326936   0.00038529512  0              0.012912786    4.8856218e-08  0              0.0023590919   1.1971759e-13  0              3.2854017    
   1800000   12727.922      200            200            0.004432685    0.00038529536  0              0.01291276     3.480465e-10   0              1.680592e-05   1.1971759e-13  0              3.2854017    
   1900000   12727.922      200            200            0.0044326767   0.00038529559  0              0.012912735    1.3872929e-09  0              6.6987407e-05  1.1971759e-13  0              3.2854017    
   2000000   12727.922      200            200            0.0044326745   0.00038529565  0              0.012912728    1.5897832e-10  0              7.6764942e-06  1.1971759e-13  0              3.2854017    
   2100000   12727.922      200            200            0.0044326747   0.00038529564  0              0.012912729    1.342318e-14   0              6.4815732e-10  1.1971759e-13  0              3.2854017    
   2200000   12727.922      200            200            0.0044326751   0.00038529563  0              0.01291273     2.711152e-12   0              1.3091183e-07  1.1971759e-13  0              3.2854017    
   2300000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     4.6776978e-13  0              2.2586928e-08  1.1971759e-13  0              3.2854017    
   2400000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     3.3987945e-15  0              1.6411562e-10  1.1971759e-13  0              3.2854017    
   2500000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     4.7862755e-15  0              2.3111212e-10  1.1971759e-13  0              3.2854017    
   2600000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     1.2776915e-15  0              6.1695149e-11  1.1971759e-13  0              3.2854017    
   2700000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     9.2529648e-17  0              4.4679256e-12  1.1971759e-13  0              3.2854017    
   2800000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     1.2112557e-17  0              5.8487205e-13  1.1971759e-13  0              3.2854017    
   2900000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     5.5059109e-18  0              2.6586073e-13  1.1971759e-13  0              3.2854017    
   3000000   12727.922      200            200            0.0044326752   0.00038529563  0              0.01291273     1.2177029e-17  0              5.8798513e-13  1.1971759e-13  0              3.2854017    
Loop time of 539.43 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4805072.638 ns/day, 0.000 hours/ns, 5561.427 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.222     | 76.115     | 130.08     | 612.1 | 14.11
Neigh   | 3.8672     | 3.9064     | 3.9463     |   1.4 |  0.72
Comm    | 16.787     | 23.153     | 27.959     |  87.7 |  4.29
Output  | 0.47067    | 0.47131    | 0.47197    |   0.1 |  0.09
Modify  | 317.06     | 329.87     | 343.93     |  67.6 | 61.15
Other   |            | 105.9      |            |       | 19.64

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         684.75 ave        1370 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2739
Ave neighs/atom = 0.54769046
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.59                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.2972313135691
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.69
  ghost atom cutoff = 3.69
  binsize = 1.845, bins = 6899 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 98.62 | 98.63 | 98.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037422458   6.3466276e-36  0              0.011226737    1447942.8      0              6.9915976e+10  1.1971759e-13  0              3.3211952    
    200000   12727.922      200            200           -0.0004384181  -5.0772539e-35  0             -0.0013152543   214326.81      0              1.0349075e+10  1.1971759e-13  0              3.3616331    
    300000   12727.922      200            200           -0.00031417472  1.5231962e-34  0             -0.00094252417  71626.475      0              3.4585862e+09  1.1971759e-13  0              3.2988737    
    400000   12727.922      200            200            0.0052623966   0.0002224747   0              0.015564715    17606.81       0              8.5016982e+08  1.1971759e-13  0              3.2900705    
    500000   12727.922      200            200            0.0017180154   0.0003141306   0              0.0048399157   1525.1313      0              73643134       1.1971759e-13  0              3.292139     
    600000   12727.922      200            200            0.0060127959   0.00046070782  0              0.01757768     99.321441      0              4795876.9      1.1971759e-13  0              3.2896512    
    700000   12727.922      200            200            0.0043717233   0.00036677087  0              0.012748399    47.946154      0              2315148.2      1.1971759e-13  0              3.2904434    
    800000   12727.922      200            200            0.0042339142   0.00035436692  0              0.012347376    1.6702408      0              80649.949      1.1971759e-13  0              3.290511     
    900000   12727.922      200            200            0.0043618076   0.00038598848  0              0.012699434    0.12654047     0              6110.1864      1.1971759e-13  0              3.2904461    
   1000000   12727.922      200            200            0.0044268409   0.00037164681  0              0.012908876    0.10978224     0              5300.9916      1.1971759e-13  0              3.2904088    
   1100000   12727.922      200            200            0.0044421317   0.00037267714  0              0.012953718    0.0093231108   0              450.17966      1.1971759e-13  0              3.2904011    
   1200000   12727.922      200            200            0.0044391742   0.00037275801  0              0.012944765    8.7765062e-06  0              0.42378608     1.1971759e-13  0              3.2904027    
   1300000   12727.922      200            200            0.0044358988   0.00037285221  0              0.012934844    0.0002026546   0              9.7854653      1.1971759e-13  0              3.2904045    
   1400000   12727.922      200            200            0.0044348893   0.00037288191  0              0.012931786    3.2680894e-05  0              1.5780434      1.1971759e-13  0              3.290405     
   1500000   12727.922      200            200            0.0044348952   0.00037288148  0              0.012931804    2.9621855e-07  0              0.014303334    1.1971759e-13  0              3.290405     
   1600000   12727.922      200            200            0.0044350332   0.00037287727  0              0.012932222    2.8490761e-07  0              0.013757169    1.1971759e-13  0              3.290405     
   1700000   12727.922      200            200            0.0044350918   0.00037287553  0              0.0129324      9.1412218e-08  0              0.0044139688   1.1971759e-13  0              3.2904049    
   1800000   12727.922      200            200            0.0044350984   0.00037287534  0              0.01293242     3.3872242e-09  0              0.00016355694  1.1971759e-13  0              3.2904049    
   1900000   12727.922      200            200            0.0044350933   0.00037287549  0              0.012932404    2.4319304e-10  0              1.1742922e-05  1.1971759e-13  0              3.2904049    
   2000000   12727.922      200            200            0.0044350903   0.00037287558  0              0.012932395    2.1060774e-10  0              1.0169494e-05  1.1971759e-13  0              3.2904049    
   2100000   12727.922      200            200            0.0044350897   0.0003728756   0              0.012932393    1.7135448e-11  0              8.2740945e-07  1.1971759e-13  0              3.2904049    
   2200000   12727.922      200            200            0.0044350898   0.0003728756   0              0.012932394    2.8688094e-14  0              1.3852454e-09  1.1971759e-13  0              3.2904049    
   2300000   12727.922      200            200            0.0044350899   0.00037287559  0              0.012932394    3.9530975e-13  0              1.9088093e-08  1.1971759e-13  0              3.2904049    
   2400000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    6.1195956e-14  0              2.9549337e-09  1.1971759e-13  0              3.2904049    
   2500000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    5.1923987e-16  0              2.5072235e-11  1.1971759e-13  0              3.2904049    
   2600000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    5.001298e-16   0              2.4149478e-11  1.1971759e-13  0              3.2904049    
   2700000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    1.5595919e-16  0              7.530711e-12   1.1971759e-13  0              3.2904049    
   2800000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    2.1758338e-17  0              1.0506323e-12  1.1971759e-13  0              3.2904049    
   2900000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    1.29458e-17    0              6.2510635e-13  1.1971759e-13  0              3.2904049    
   3000000   12727.922      200            200            0.00443509     0.00037287559  0              0.012932394    1.3327852e-17  0              6.4355429e-13  1.1971759e-13  0              3.2904049    
Loop time of 541.037 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4790800.439 ns/day, 0.000 hours/ns, 5544.908 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.189     | 76.45      | 131.46     | 615.9 | 14.13
Neigh   | 3.9312     | 3.971      | 4.0119     |   1.4 |  0.73
Comm    | 16.685     | 22.757     | 27.193     |  90.5 |  4.21
Output  | 0.42487    | 0.42549    | 0.42613    |   0.1 |  0.08
Modify  | 321.01     | 332.86     | 344.31     |  61.2 | 61.52
Other   |            | 104.6      |            |       | 19.33

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         689.75 ave        1380 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2759
Ave neighs/atom = 0.55168966
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.6                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 53.7438538434912
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.7
  ghost atom cutoff = 3.7
  binsize = 1.85, bins = 6880 109 109
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 98.37 | 98.39 | 98.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037516327  -3.490644e-35   0              0.011254898    1452898.1      0              7.015525e+10   1.1971759e-13  0              3.3207308    
    200000   12727.922      200            200           -0.0004374428   4.5729442e-40  0             -0.0013123284   207410.34      0              1.0015103e+10  1.1971759e-13  0              3.3695408    
    300000   12727.922      200            200           -0.00030823892  6.3087316e-40  0             -0.00092471677  67346.407      0              3.251917e+09   1.1971759e-13  0              3.3058271    
    400000   12727.922      200            200            0.0075451101  -2.7947276e-05  0              0.022663277    16628.696      0              8.0294022e+08  1.1971759e-13  0              3.2940162    
    500000   12727.922      200            200            0.0012761035   5.4667376e-05  0              0.0037736431   1082.1757      0              52254390       1.1971759e-13  0              3.297474     
    600000   12727.922      200            200            0.0061867952   0.00039337236  0              0.018167013    32.947169      0              1590900.9      1.1971759e-13  0              3.294567     
    700000   12727.922      200            200            0.0045387857   0.00033919216  0              0.013277165    47.078585      0              2273256.4      1.1971759e-13  0              3.2953566    
    800000   12727.922      200            200            0.0042820602   0.00034506145  0              0.012501119    3.6047379      0              174059.89      1.1971759e-13  0              3.2954902    
    900000   12727.922      200            200            0.0043596108   0.000377876    0              0.012700956    0.0011803852   0              56.996578      1.1971759e-13  0              3.2954528    
   1000000   12727.922      200            200            0.0044199108   0.00036405714  0              0.012895675    0.074014774    0              3573.9085      1.1971759e-13  0              3.2954179    
   1100000   12727.922      200            200            0.004440988    0.00036301475  0              0.012959949    0.01474146     0              711.81235      1.1971759e-13  0              3.2954066    
   1200000   12727.922      200            200            0.0044420939   0.00036299511  0              0.012963287    0.00036448485  0              17.599669      1.1971759e-13  0              3.2954061    
   1300000   12727.922      200            200            0.0044397144   0.00036301802  0              0.012956125    5.7942044e-05  0              2.797814       1.1971759e-13  0              3.2954074    
   1400000   12727.922      200            200            0.0044384819   0.00036304336  0              0.012952402    3.6395151e-05  0              1.7573916      1.1971759e-13  0              3.2954081    
   1500000   12727.922      200            200            0.0044382396   0.00036304953  0              0.012951669    2.9694321e-06  0              0.14338325     1.1971759e-13  0              3.2954082    
   1600000   12727.922      200            200            0.0044382945   0.00036304819  0              0.012951835    6.5193412e-10  0              3.1479565e-05  1.1971759e-13  0              3.2954082    
   1700000   12727.922      200            200            0.0044383519   0.00036304665  0              0.012952009    5.9037902e-08  0              0.002850729    1.1971759e-13  0              3.2954082    
   1800000   12727.922      200            200            0.0044383707   0.00036304609  0              0.012952066    1.1490494e-08  0              0.00055483484  1.1971759e-13  0              3.2954081    
   1900000   12727.922      200            200            0.0044383716   0.00036304607  0              0.012952069    2.6176562e-10  0              1.2639725e-05  1.1971759e-13  0              3.2954081    
   2000000   12727.922      200            200            0.0044383694   0.00036304614  0              0.012952062    4.937406e-11   0              2.3840966e-06  1.1971759e-13  0              3.2954081    
   2100000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    2.8847195e-11  0              1.3929278e-06  1.1971759e-13  0              3.2954081    
   2200000   12727.922      200            200            0.0044383681   0.00036304618  0              0.012952058    2.2562011e-12  0              1.0894388e-07  1.1971759e-13  0              3.2954081    
   2300000   12727.922      200            200            0.0044383682   0.00036304617  0              0.012952058    1.4020626e-15  0              6.7700588e-11  1.1971759e-13  0              3.2954081    
   2400000   12727.922      200            200            0.0044383682   0.00036304617  0              0.012952059    4.8507845e-14  0              2.3422702e-09  1.1971759e-13  0              3.2954081    
   2500000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    8.970982e-15   0              4.3317661e-10  1.1971759e-13  0              3.2954081    
   2600000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    2.3887043e-16  0              1.1534198e-11  1.1971759e-13  0              3.2954081    
   2700000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    1.4509742e-18  0              7.0062354e-14  1.1971759e-13  0              3.2954081    
   2800000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    3.3461415e-22  0              1.615732e-17   1.1971759e-13  0              3.2954081    
   2900000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    6.8604002e-19  0              3.3126417e-14  1.1971759e-13  0              3.2954081    
   3000000   12727.922      200            200            0.0044383683   0.00036304617  0              0.012952059    4.7585738e-18  0              2.297745e-13   1.1971759e-13  0              3.2954081    
Loop time of 544.107 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4763765.600 ns/day, 0.000 hours/ns, 5513.618 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.692     | 77.463     | 133.8      | 619.4 | 14.24
Neigh   | 3.9005     | 3.9417     | 3.9842     |   1.5 |  0.72
Comm    | 16.917     | 22.874     | 27.451     |  92.7 |  4.20
Output  | 0.39444    | 0.39508    | 0.39573    |   0.1 |  0.07
Modify  | 321.4      | 333.37     | 344.87     |  62.2 | 61.27
Other   |            | 106.1      |            |       | 19.49

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         694.75 ave        1390 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2779
Ave neighs/atom = 0.55568886
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.61                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.1929645147953
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.71
  ghost atom cutoff = 3.71
  binsize = 1.855, bins = 6862 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.66 | 96.67 | 96.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037610188  -6.346622e-36   0              0.011283056    1457859.9      0              7.0394835e+10  1.1971759e-13  0              3.3202539    
    200000   12727.922      200            200           -0.00043625731  1.0154627e-34  0             -0.0013087719   200613.55      0              9.6869103e+09  1.1971759e-13  0              3.3774034    
    300000   12727.922      200            200           -0.00030207987  1.0154635e-34  0             -0.00090623962  63202.947      0              3.0518441e+09  1.1971759e-13  0              3.3127228    
    400000   12727.922      200            200            0.010015926   -0.00067974652  0              0.030727524    14511.574      0              7.0071199e+08  1.1971759e-13  0              3.2980093    
    500000   12727.922      200            200            0.00098580615 -4.6912925e-05  0              0.0030043314   680.04527      0              32836952       1.1971759e-13  0              3.3027494    
    600000   12727.922      200            200            0.0062644619   0.00035677749  0              0.018436608    1.3504991      0              65210.768      1.1971759e-13  0              3.2995317    
    700000   12727.922      200            200            0.0047033639   0.00031793113  0              0.01379216     39.578144      0              1911086.9      1.1971759e-13  0              3.3002738    
    800000   12727.922      200            200            0.004343865    0.00033276081  0              0.012698834    5.3960793      0              260557.36      1.1971759e-13  0              3.3004617    
    900000   12727.922      200            200            0.0043676122   0.00036929292  0              0.012733544    0.084289626    0              4070.0444      1.1971759e-13  0              3.3004538    
   1000000   12727.922      200            200            0.00441599     0.0003566267   0              0.012891343    0.028939788    0              1397.3988      1.1971759e-13  0              3.3004254    
   1100000   12727.922      200            200            0.0044395771   0.0003541868   0              0.012964544    0.0149675      0              722.72698      1.1971759e-13  0              3.3004125    
   1200000   12727.922      200            200            0.0044443969   0.00035418031  0              0.012979011    0.0013562754   0              65.489684      1.1971759e-13  0              3.30041      
   1300000   12727.922      200            200            0.004443459    0.00035413221  0              0.012976245    2.4967489e-06  0              0.12055907     1.1971759e-13  0              3.3004105    
   1400000   12727.922      200            200            0.0044423692   0.00035415154  0              0.012972956    1.7392981e-05  0              0.83984483     1.1971759e-13  0              3.3004111    
   1500000   12727.922      200            200            0.0044419605   0.0003541623   0              0.012971719    5.0727344e-06  0              0.24494419     1.1971759e-13  0              3.3004113    
   1600000   12727.922      200            200            0.0044419064   0.00035416365  0              0.012971555    2.9365131e-07  0              0.014179371    1.1971759e-13  0              3.3004114    
   1700000   12727.922      200            200            0.0044419348   0.00035416288  0              0.012971641    1.3908373e-09  0              6.7158557e-05  1.1971759e-13  0              3.3004114    
   1800000   12727.922      200            200            0.0044419559   0.00035416232  0              0.012971705    8.281025e-09   0              0.00039986106  1.1971759e-13  0              3.3004113    
   1900000   12727.922      200            200            0.0044419625   0.00035416215  0              0.012971725    1.5610435e-09  0              7.5377202e-05  1.1971759e-13  0              3.3004113    
   2000000   12727.922      200            200            0.0044419628   0.00035416214  0              0.012971726    5.0559961e-11  0              2.4413596e-06  1.1971759e-13  0              3.3004113    
   2100000   12727.922      200            200            0.0044419621   0.00035416216  0              0.012971724    3.3346592e-12  0              1.6101876e-07  1.1971759e-13  0              3.3004113    
   2200000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    3.4150614e-12  0              1.6490109e-07  1.1971759e-13  0              3.3004113    
   2300000   12727.922      200            200            0.0044419616   0.00035416217  0              0.012971723    4.340192e-13   0              2.0957234e-08  1.1971759e-13  0              3.3004113    
   2400000   12727.922      200            200            0.0044419616   0.00035416217  0              0.012971723    5.7279637e-15  0              2.7658287e-10  1.1971759e-13  0              3.3004113    
   2500000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    2.6754224e-15  0              1.2918657e-10  1.1971759e-13  0              3.3004113    
   2600000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    1.2389264e-15  0              5.9823322e-11  1.1971759e-13  0              3.3004113    
   2700000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    1.6484574e-16  0              7.9598108e-12  1.1971759e-13  0              3.3004113    
   2800000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    2.429726e-17   0              1.1732277e-12  1.1971759e-13  0              3.3004113    
   2900000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    3.4130813e-18  0              1.6480548e-13  1.1971759e-13  0              3.3004113    
   3000000   12727.922      200            200            0.0044419617   0.00035416217  0              0.012971723    3.1712507e-18  0              1.5312835e-13  1.1971759e-13  0              3.3004113    
Loop time of 544.524 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4760118.213 ns/day, 0.000 hours/ns, 5509.396 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.533     | 77.029     | 133.62     | 619.2 | 14.15
Neigh   | 3.8726     | 3.9107     | 3.9497     |   1.4 |  0.72
Comm    | 16.895     | 22.675     | 27.828     |  94.5 |  4.16
Output  | 0.46003    | 0.46065    | 0.4613     |   0.1 |  0.08
Modify  | 323.65     | 334.96     | 346.23     |  59.5 | 61.51
Other   |            | 105.5      |            |       | 19.37

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         699.25 ave        1399 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2797
Ave neighs/atom = 0.55928814
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.62                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 54.6445702389847
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.72
  ghost atom cutoff = 3.72
  binsize = 1.86, bins = 6843 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.44 | 96.45 | 96.46 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037704041   1.269326e-35   0              0.011311212    1462828        0              7.063473e+10   1.1971759e-13  0              3.3197644    
    200000   12727.922      200            200           -0.00043486259  2.030922e-34   0             -0.0013045878   193936.13      0              9.3644818e+09  1.1971759e-13  0              3.385221     
    300000   12727.922      200            200           -0.00029569895 -4.569566e-34   0             -0.00088709685  59195.656      0              2.8583464e+09  1.1971759e-13  0              3.319561     
    400000   12727.922      200            200            0.012668016   -0.0011813326   0              0.039185381    11402.445      0              5.5058328e+08  1.1971759e-13  0              3.3020904    
    500000   12727.922      200            200            0.00081001126 -5.690667e-05   0              0.0024869404   353.15014      0              17052356       1.1971759e-13  0              3.3079599    
    600000   12727.922      200            200            0.0062356359   0.00034493219  0              0.018361976    12.122705      0              585362.03      1.1971759e-13  0              3.3045475    
    700000   12727.922      200            200            0.0048634003   0.00033616418  0              0.014254037    27.541955      0              1329902.5      1.1971759e-13  0              3.3052014    
    800000   12727.922      200            200            0.0044136775   0.00031661919  0              0.012924413    6.3705209      0              307609.65      1.1971759e-13  0              3.3054284    
    900000   12727.922      200            200            0.0043849686   0.00035926476  0              0.012795641    0.33432359     0              16143.29       1.1971759e-13  0              3.3054496    
   1000000   12727.922      200            200            0.0044156894   0.00034741658  0              0.012899652    0.001738156    0              83.929334      1.1971759e-13  0              3.3054307    
   1100000   12727.922      200            200            0.0044383412   0.00034448481  0              0.012970539    0.0098028411   0              473.34411      1.1971759e-13  0              3.3054181    
   1200000   12727.922      200            200            0.004445838    0.00034454019  0              0.012992974    0.0020524442   0              99.105186      1.1971759e-13  0              3.3054142    
   1300000   12727.922      200            200            0.0044464863   0.00034445573  0              0.012995003    0.00010103733  0              4.8787309      1.1971759e-13  0              3.3054139    
   1400000   12727.922      200            200            0.0044458369   0.00034447303  0              0.012993038    8.1175585e-07  0              0.039196785    1.1971759e-13  0              3.3054142    
   1500000   12727.922      200            200            0.0044454121   0.00034448394  0              0.012991752    3.2902401e-06  0              0.15887392     1.1971759e-13  0              3.3054145    
   1600000   12727.922      200            200            0.0044452803   0.00034448725  0              0.012991354    6.6272835e-07  0              0.03200078     1.1971759e-13  0              3.3054145    
   1700000   12727.922      200            200            0.0044452694   0.0003444875   0              0.012991321    3.1017667e-08  0              0.0014977321   1.1971759e-13  0              3.3054145    
   1800000   12727.922      200            200            0.0044452815   0.00034448719  0              0.012991357    3.4265598e-10  0              1.6545631e-05  1.1971759e-13  0              3.3054145    
   1900000   12727.922      200            200            0.0044452892   0.00034448699  0              0.012991381    1.1014267e-09  0              5.3183956e-05  1.1971759e-13  0              3.3054145    
   2000000   12727.922      200            200            0.0044452915   0.00034448693  0              0.012991388    2.1382937e-10  0              1.0325055e-05  1.1971759e-13  0              3.3054145    
   2100000   12727.922      200            200            0.0044452917   0.00034448693  0              0.012991388    9.5015272e-12  0              4.5879474e-07  1.1971759e-13  0              3.3054145    
   2200000   12727.922      200            200            0.0044452915   0.00034448694  0              0.012991388    1.4015439e-13  0              6.7675541e-09  1.1971759e-13  0              3.3054145    
   2300000   12727.922      200            200            0.0044452914   0.00034448694  0              0.012991387    3.6825456e-13  0              1.7781695e-08  1.1971759e-13  0              3.3054145    
   2400000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    6.9069078e-14  0              3.3350986e-09  1.1971759e-13  0              3.3054145    
   2500000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    2.9982113e-15  0              1.4477289e-10  1.1971759e-13  0              3.3054145    
   2600000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    3.0796111e-17  0              1.487034e-12   1.1971759e-13  0              3.3054145    
   2700000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    5.1046211e-17  0              2.4648388e-12  1.1971759e-13  0              3.3054145    
   2800000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    2.0520951e-18  0              9.9088328e-14  1.1971759e-13  0              3.3054145    
   2900000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    7.8661293e-18  0              3.7982723e-13  1.1971759e-13  0              3.3054145    
   3000000   12727.922      200            200            0.0044452913   0.00034448694  0              0.012991387    5.8391484e-18  0              2.8195158e-13  1.1971759e-13  0              3.3054145    
Loop time of 538.251 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4815600.276 ns/day, 0.000 hours/ns, 5573.611 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.704     | 77.072     | 132.63     | 617.8 | 14.32
Neigh   | 3.9441     | 3.9847     | 4.026      |   1.5 |  0.74
Comm    | 17.03      | 22.807     | 27.044     |  86.4 |  4.24
Output  | 0.47773    | 0.47835    | 0.479      |   0.1 |  0.09
Modify  | 317.98     | 329.29     | 340.03     |  58.8 | 61.18
Other   |            | 104.6      |            |       | 19.44

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         704.25 ave        1409 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2817
Ave neighs/atom = 0.56328734
Neighbor list builds = 160
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.63                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.0986779275632
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.73
  ghost atom cutoff = 3.73
  binsize = 1.865, bins = 6825 108 108
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 96.25 | 96.26 | 96.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0037797885   9.9640611e-42  0              0.011339365    1467802.6      0              7.0874935e+10  1.1971759e-13  0              3.3192623    
    200000   12727.922      200            200           -0.00043325956  5.0773074e-35  0             -0.0012997787   187377.76      0              9.0478013e+09  1.1971759e-13  0              3.3929934    
    300000   12727.922      200            200           -0.00028909744 -1.1423923e-34  0             -0.00086729231  55324.049      0              2.6714004e+09  1.1971759e-13  0              3.3263413    
    400000   12727.922      200            200            0.015056878   -0.0021113969   0              0.04728203     7723.2035      0              3.7292586e+08  1.1971759e-13  0              3.3063024    
    500000   12727.922      200            200            0.00073621028  2.7383431e-05  0              0.0021812474   125.54075      0              6061913.6      1.1971759e-13  0              3.313102     
    600000   12727.922      200            200            0.0061054184   0.00036632569  0              0.01794993     62.39093       0              3012634.7      1.1971759e-13  0              3.3096137    
    700000   12727.922      200            200            0.0049860959   0.000333189    0              0.014625099    14.480291      0              699201.45      1.1971759e-13  0              3.3101453    
    800000   12727.922      200            200            0.0044906053   0.00031330126  0              0.013158515    6.1557143      0              297237.41      1.1971759e-13  0              3.3103939    
    900000   12727.922      200            200            0.0044106191   0.00034973762  0              0.01288212     0.63009385     0              30424.977      1.1971759e-13  0              3.3104411    
   1000000   12727.922      200            200            0.0044208364   0.00034012658  0              0.012922383    0.0086361693   0              417.00971      1.1971759e-13  0              3.3104334    
   1100000   12727.922      200            200            0.0044394314   0.00033760373  0              0.01298069     0.0031709759   0              153.11508      1.1971759e-13  0              3.310423     
   1200000   12727.922      200            200            0.0044481128   0.00033773475  0              0.013006604    0.0018301653   0              88.372132      1.1971759e-13  0              3.3104184    
   1300000   12727.922      200            200            0.0044501275   0.00033765165  0              0.013012731    0.00024027155  0              11.601853      1.1971759e-13  0              3.3104174    
   1400000   12727.922      200            200            0.0044500691   0.00033765363  0              0.013012554    6.8301826e-06  0              0.32980507     1.1971759e-13  0              3.3104174    
   1500000   12727.922      200            200            0.0044497657   0.00033766128  0              0.013011636    4.5152764e-07  0              0.021802654    1.1971759e-13  0              3.3104176    
   1600000   12727.922      200            200            0.0044496099   0.00033766513  0              0.013011165    5.0862332e-07  0              0.0245596      1.1971759e-13  0              3.3104177    
   1700000   12727.922      200            200            0.0044495667   0.00033766618  0              0.013011034    8.6622091e-08  0              0.0041826708   1.1971759e-13  0              3.3104177    
   1800000   12727.922      200            200            0.0044495643   0.00033766623  0              0.013011027    3.9612144e-09  0              0.00019127287  1.1971759e-13  0              3.3104177    
   1900000   12727.922      200            200            0.0044495688   0.00033766611  0              0.01301104     3.1124786e-11  0              1.5029045e-06  1.1971759e-13  0              3.3104177    
   2000000   12727.922      200            200            0.0044495715   0.00033766604  0              0.013011049    1.3128001e-10  0              6.3390419e-06  1.1971759e-13  0              3.3104177    
   2100000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    2.9474218e-11  0              1.4232045e-06  1.1971759e-13  0              3.3104177    
   2200000   12727.922      200            200            0.0044495725   0.00033766602  0              0.013011052    1.9267444e-12  0              9.3035591e-08  1.1971759e-13  0              3.3104177    
   2300000   12727.922      200            200            0.0044495725   0.00033766602  0              0.013011051    3.8435291e-16  0              1.8559027e-11  1.1971759e-13  0              3.3104177    
   2400000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    3.1618641e-14  0              1.526751e-09   1.1971759e-13  0              3.3104177    
   2500000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    9.5045343e-15  0              4.5893994e-10  1.1971759e-13  0              3.3104177    
   2600000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    8.8817452e-16  0              4.2886769e-11  1.1971759e-13  0              3.3104177    
   2700000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    5.6475738e-17  0              2.7270113e-12  1.1971759e-13  0              3.3104177    
   2800000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    1.1338945e-17  0              5.4751708e-13  1.1971759e-13  0              3.3104177    
   2900000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    3.3873977e-19  0              1.6356531e-14  1.1971759e-13  0              3.3104177    
   3000000   12727.922      200            200            0.0044495724   0.00033766602  0              0.013011051    1.0361718e-18  0              5.003303e-14   1.1971759e-13  0              3.3104177    
Loop time of 537.539 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4821973.554 ns/day, 0.000 hours/ns, 5580.988 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.578     | 75.576     | 129.71     | 604.7 | 14.06
Neigh   | 3.8513     | 3.8906     | 3.9307     |   1.4 |  0.72
Comm    | 16.935     | 23.837     | 29.118     | 105.2 |  4.43
Output  | 0.49171    | 0.49237    | 0.49303    |   0.1 |  0.09
Modify  | 317.23     | 329.21     | 341.46     |  62.3 | 61.24
Other   |            | 104.5      |            |       | 19.45

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         658.75 ave        1318 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2635
Ave neighs/atom = 0.52689462
Neighbor list builds = 157
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.64                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 55.5552944920351
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.74
  ghost atom cutoff = 3.74
  binsize = 1.87, bins = 6807 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.54 | 94.55 | 94.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0041113101  -1.1796359e-05  0              0.012345727    1472721        0              7.1112425e+10  1.1971759e-13  0              3.3187476    
    200000   12727.922      200            200           -0.00043144918  7.3304699e-40  0             -0.0012943475   180938.12      0              8.7368541e+09  1.1971759e-13  0              3.4007206    
    300000   12727.922      200            200           -0.00028227668 -5.0772469e-35  0             -0.00084683005  51587.675      0              2.4909842e+09  1.1971759e-13  0              3.3330639    
    400000   12727.922      200            200            0.017292837   -0.002284548    0              0.054163058    4127.6992      0              1.9931182e+08  1.1971759e-13  0              3.3106864    
    500000   12727.922      200            200            0.00070979204  7.1473229e-05  0              0.0020579029   11.927374      0              575930.21      1.1971759e-13  0              3.3181731    
    600000   12727.922      200            200            0.0058715394   0.00037708927  0              0.017237529    139.61031      0              6741282.4      1.1971759e-13  0              3.3147262    
    700000   12727.922      200            200            0.0050653102   0.00032157888  0              0.014874352    4.2871347      0              207010.39      1.1971759e-13  0              3.3151098    
    800000   12727.922      200            200            0.0045656658   0.00031678535  0              0.013380212    4.8260529      0              233032.82      1.1971759e-13  0              3.3153618    
    900000   12727.922      200            200            0.0044421861   0.00034170356  0              0.012984855    0.82896412     0              40027.711      1.1971759e-13  0              3.3154297    
   1000000   12727.922      200            200            0.0044314945   0.00033542701  0              0.012959057    0.045183876    0              2181.7676      1.1971759e-13  0              3.3154336    
   1100000   12727.922      200            200            0.0044434631   0.00033357675  0              0.012996813    8.550469e-06   0              0.41287155     1.1971759e-13  0              3.3154268    
   1200000   12727.922      200            200            0.0044516925   0.00033375392  0              0.013021324    0.00090986615  0              43.93418       1.1971759e-13  0              3.3154225    
   1300000   12727.922      200            200            0.0044545624   0.00033368696  0              0.01303        0.00027316014  0              13.189925      1.1971759e-13  0              3.315421     
   1400000   12727.922      200            200            0.0044550834   0.00033367488  0              0.013031575    2.7262584e-05  0              1.3164126      1.1971759e-13  0              3.3154207    
   1500000   12727.922      200            200            0.0044549903   0.0003336773   0              0.013031294    5.0418492e-07  0              0.024345285    1.1971759e-13  0              3.3154208    
   1600000   12727.922      200            200            0.0044548682   0.00033368029  0              0.013030924    9.1613607e-08  0              0.0044236932   1.1971759e-13  0              3.3154208    
   1700000   12727.922      200            200            0.0044548122   0.00033368163  0              0.013030755    7.029165e-08   0              0.0033941322   1.1971759e-13  0              3.3154209    
   1800000   12727.922      200            200            0.0044547971   0.00033368199  0              0.013030709    1.1684e-08     0              0.00056417855  1.1971759e-13  0              3.3154209    
   1900000   12727.922      200            200            0.0044547962   0.00033368201  0              0.013030707    6.2715304e-10  0              3.0282976e-05  1.1971759e-13  0              3.3154209    
   2000000   12727.922      200            200            0.0044547977   0.00033368197  0              0.013030711    2.1522342e-13  0              1.0392369e-08  1.1971759e-13  0              3.3154209    
   2100000   12727.922      200            200            0.0044547987   0.00033368195  0              0.013030714    1.3122695e-11  0              6.3364796e-07  1.1971759e-13  0              3.3154209    
   2200000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    3.8807391e-12  0              1.87387e-07    1.1971759e-13  0              3.3154209    
   2300000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    3.8305243e-13  0              1.8496231e-08  1.1971759e-13  0              3.3154209    
   2400000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    6.9445872e-15  0              3.3532926e-10  1.1971759e-13  0              3.3154209    
   2500000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    1.3159824e-15  0              6.3544082e-11  1.1971759e-13  0              3.3154209    
   2600000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    9.5289182e-16  0              4.6011736e-11  1.1971759e-13  0              3.3154209    
   2700000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    1.6225826e-16  0              7.8348706e-12  1.1971759e-13  0              3.3154209    
   2800000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    1.5140547e-17  0              7.3108283e-13  1.1971759e-13  0              3.3154209    
   2900000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    2.202037e-18   0              1.0632848e-13  1.1971759e-13  0              3.3154209    
   3000000   12727.922      200            200            0.0044547991   0.00033368194  0              0.013030715    4.4535093e-18  0              2.1504403e-13  1.1971759e-13  0              3.3154209    
Loop time of 541.904 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4783137.538 ns/day, 0.000 hours/ns, 5536.039 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.774     | 75.619     | 129.15     | 602.8 | 13.95
Neigh   | 3.661      | 3.6987     | 3.738      |   1.4 |  0.68
Comm    | 16.223     | 23.03      | 28.173     | 106.6 |  4.25
Output  | 0.41122    | 0.41184    | 0.41247    |   0.1 |  0.08
Modify  | 322.29     | 334.71     | 346.53     |  64.0 | 61.77
Other   |            | 104.4      |            |       | 19.27

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         664.75 ave        1330 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2659
Ave neighs/atom = 0.53169366
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.65                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.0144268439039
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.75
  ghost atom cutoff = 3.75
  binsize = 1.875, bins = 6789 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.34 | 94.36 | 94.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.013142376   -0.00055472661  0              0.039981856    1467846.3      0              7.0877045e+10  1.1971759e-13  0              3.3182258    
    200000   12727.922      200            200           -0.00042943237  1.7167644e-40  0             -0.0012882971   174616.89      0              8.4316247e+09  1.1971759e-13  0              3.4084025    
    300000   12727.922      200            200           -0.000275238   -1.5231871e-34  0             -0.00082571401  47986.07       0              2.3170756e+09  1.1971759e-13  0              3.3397285    
    400000   12727.922      200            200            0.018908895   -0.0022809339   0              0.05900762     1361.5424      0              65744010       1.1971759e-13  0              3.3152777    
    500000   12727.922      200            200            0.00072553705  7.5055324e-05  0              0.0021015558   18.81517       0              908517.22      1.1971759e-13  0              3.3231724    
    600000   12727.922      200            200            0.0055618555   0.00040017432  0              0.016285392    225.05369      0              10867037       1.1971759e-13  0              3.3198784    
    700000   12727.922      200            200            0.0050988484   0.00031612696  0              0.014980418    0.031487683    0              1520.4275      1.1971759e-13  0              3.3200981    
    800000   12727.922      200            200            0.0046294646   0.00031931448  0              0.013569079    2.8828109      0              139200.62      1.1971759e-13  0              3.3203355    
    900000   12727.922      200            200            0.0044769932   0.00033728415  0              0.013093696    0.83505553     0              40321.843      1.1971759e-13  0              3.3204172    
   1000000   12727.922      200            200            0.0044470491   0.00033413274  0              0.013007015    0.089071811    0              4300.959       1.1971759e-13  0              3.3204319    
   1100000   12727.922      200            200            0.0044507231   0.00033265376  0              0.013019516    0.0025680876   0              124.00376      1.1971759e-13  0              3.3204295    
   1200000   12727.922      200            200            0.0044570452   0.00033287286  0              0.013038263    0.00011259958  0              5.4370306      1.1971759e-13  0              3.3204261    
   1300000   12727.922      200            200            0.0044600949   0.00033280287  0              0.013047482    0.00016826823  0              8.1250708      1.1971759e-13  0              3.3204245    
   1400000   12727.922      200            200            0.0044610345   0.00033278112  0              0.013050322    3.7381245e-05  0              1.8050065      1.1971759e-13  0              3.320424     
   1500000   12727.922      200            200            0.0044611711   0.00033277808  0              0.013050735    3.2819131e-06  0              0.15847184     1.1971759e-13  0              3.320424     
   1600000   12727.922      200            200            0.0044611244   0.00033277924  0              0.013050594    5.3813461e-08  0              0.0025984595   1.1971759e-13  0              3.320424     
   1700000   12727.922      200            200            0.0044610789   0.00033278033  0              0.013050456    1.1751696e-08  0              0.00056744734  1.1971759e-13  0              3.320424     
   1800000   12727.922      200            200            0.0044610587   0.0003327808   0              0.013050395    8.8634212e-09  0              0.00042798289  1.1971759e-13  0              3.320424     
   1900000   12727.922      200            200            0.0044610531   0.00033278093  0              0.013050378    1.6127488e-09  0              7.7873866e-05  1.1971759e-13  0              3.320424     
   2000000   12727.922      200            200            0.0044610525   0.00033278094  0              0.013050377    1.1447008e-10  0              5.5273504e-06  1.1971759e-13  0              3.320424     
   2100000   12727.922      200            200            0.004461053    0.00033278093  0              0.013050378    6.8292e-13     0              3.2975763e-08  1.1971759e-13  0              3.320424     
   2200000   12727.922      200            200            0.0044610533   0.00033278092  0              0.013050379    9.1422978e-13  0              4.4144884e-08  1.1971759e-13  0              3.320424     
   2300000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    4.4516141e-13  0              2.1495252e-08  1.1971759e-13  0              3.320424     
   2400000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    6.7247483e-14  0              3.2471403e-09  1.1971759e-13  0              3.320424     
   2500000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    3.6824363e-15  0              1.7781167e-10  1.1971759e-13  0              3.320424     
   2600000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    3.2775565e-18  0              1.5826148e-13  1.1971759e-13  0              3.320424     
   2700000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    7.5481643e-18  0              3.6447384e-13  1.1971759e-13  0              3.320424     
   2800000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    1.0930636e-19  0              5.278013e-15   1.1971759e-13  0              3.320424     
   2900000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    1.1585595e-19  0              5.594269e-15   1.1971759e-13  0              3.320424     
   3000000   12727.922      200            200            0.0044610534   0.00033278092  0              0.013050379    1.5185809e-18  0              7.3326837e-14  1.1971759e-13  0              3.320424     
Loop time of 537.342 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4823746.988 ns/day, 0.000 hours/ns, 5583.040 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.261     | 76.027     | 131.47     | 610.1 | 14.15
Neigh   | 3.5833     | 3.6208     | 3.6594     |   1.4 |  0.67
Comm    | 16.085     | 22.381     | 27.277     |  94.4 |  4.17
Output  | 0.41843    | 0.41905    | 0.41969    |   0.1 |  0.08
Modify  | 317.32     | 329.96     | 342.17     |  65.4 | 61.41
Other   |            | 104.9      |            |       | 19.53

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         670.25 ave        1341 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2681
Ave neighs/atom = 0.53609278
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.66                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.4760818946735
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.76
  ghost atom cutoff = 3.76
  binsize = 1.88, bins = 6771 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 94.11 | 94.12 | 94.13 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.034615581   -0.0008940637   0              0.10474081     1423937.3      0              6.8756834e+10  1.1971759e-13  0              3.317742     
    200000   12727.922      200            200           -0.00042721008  3.807977e-35   0             -0.0012816302   168413.75      0              8.1320974e+09  1.1971759e-13  0              3.4160391    
    300000   12727.922      200            200           -0.00026798269  6.3466298e-36  0             -0.00080394808  44518.762      0              2.1496517e+09  1.1971759e-13  0              3.3463351    
    400000   12727.922      200            200            0.019665823   -0.0021884401   0              0.06118591     53.627482      0              2589479.2      1.1971759e-13  0              3.3201014    
    500000   12727.922      200            200            0.00079643903  7.6039983e-05  0              0.0023132771   145.24477      0              7013350.4      1.1971759e-13  0              3.3280997    
    600000   12727.922      200            200            0.0051701228   0.00033976     0              0.015170608    298.81448      0              14428682       1.1971759e-13  0              3.3250612    
    700000   12727.922      200            200            0.0050828544   0.00031379258  0              0.014934771    2.9777869      0              143786.67      1.1971759e-13  0              3.3251111    
    800000   12727.922      200            200            0.0046764589   0.00032175636  0              0.01370762     1.0664459      0              51494.854      1.1971759e-13  0              3.325318     
    900000   12727.922      200            200            0.0045100574   0.0003326697   0              0.013197503    0.64541901     0              31164.974      1.1971759e-13  0              3.3254056    
   1000000   12727.922      200            200            0.0044650841   0.00033345878  0              0.013061794    0.11375999     0              5493.063       1.1971759e-13  0              3.3254289    
   1100000   12727.922      200            200            0.0044600424   0.00033197878  0              0.013048148    0.0088771226   0              428.64448      1.1971759e-13  0              3.3254311    
   1200000   12727.922      200            200            0.0044634186   0.00033224169  0              0.013058014    0.0001264951   0              6.1079955      1.1971759e-13  0              3.3254293    
   1300000   12727.922      200            200            0.0044659833   0.00033218383  0              0.013065766    3.4855321e-05  0              1.6830387      1.1971759e-13  0              3.3254279    
   1400000   12727.922      200            200            0.0044670839   0.0003321589   0              0.013069093    2.5521103e-05  0              1.2323227      1.1971759e-13  0              3.3254273    
   1500000   12727.922      200            200            0.0044673997   0.0003321518   0              0.013070047    5.0078568e-06  0              0.24181148     1.1971759e-13  0              3.3254272    
   1600000   12727.922      200            200            0.0044674414   0.00033215091  0              0.013070173    4.41109e-07    0              0.021299575    1.1971759e-13  0              3.3254271    
   1700000   12727.922      200            200            0.0044674241   0.00033215133  0              0.013070121    9.5980436e-09  0              0.00046345518  1.1971759e-13  0              3.3254272    
   1800000   12727.922      200            200            0.004467408    0.0003321517   0              0.013070072    9.2409485e-10  0              4.4621233e-05  1.1971759e-13  0              3.3254272    
   1900000   12727.922      200            200            0.0044674008   0.00033215187  0              0.01307005     9.8524097e-10  0              4.7573761e-05  1.1971759e-13  0              3.3254272    
   2000000   12727.922      200            200            0.0044673985   0.00033215192  0              0.013070044    2.1749845e-10  0              1.0502222e-05  1.1971759e-13  0              3.3254272    
   2100000   12727.922      200            200            0.0044673982   0.00033215193  0              0.013070043    2.1469491e-11  0              1.0366849e-06  1.1971759e-13  0              3.3254272    
   2200000   12727.922      200            200            0.0044673983   0.00033215192  0              0.013070043    6.3951959e-13  0              3.0880112e-08  1.1971759e-13  0              3.3254272    
   2300000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    2.045943e-14   0              9.8791268e-10  1.1971759e-13  0              3.3254272    
   2400000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    3.739016e-14   0              1.805437e-09   1.1971759e-13  0              3.3254272    
   2500000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    9.3471289e-15  0              4.513394e-10   1.1971759e-13  0              3.3254272    
   2600000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    1.0688836e-15  0              5.1612562e-11  1.1971759e-13  0              3.3254272    
   2700000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    1.1085679e-16  0              5.3528774e-12  1.1971759e-13  0              3.3254272    
   2800000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    2.3166953e-17  0              1.1186493e-12  1.1971759e-13  0              3.3254272    
   2900000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    1.5864062e-20  0              7.6601877e-16  1.1971759e-13  0              3.3254272    
   3000000   12727.922      200            200            0.0044673984   0.00033215192  0              0.013070043    1.3994503e-20  0              6.7574445e-16  1.1971759e-13  0              3.3254272    
Loop time of 536.237 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4833684.011 ns/day, 0.000 hours/ns, 5594.542 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.285     | 76.047     | 129.8      | 611.8 | 14.18
Neigh   | 3.5604     | 3.5983     | 3.6369     |   1.4 |  0.67
Comm    | 16.113     | 22.271     | 27.654     |  94.1 |  4.15
Output  | 0.42518    | 0.42581    | 0.42647    |   0.1 |  0.08
Modify  | 316.81     | 329.03     | 340.9      |  63.4 | 61.36
Other   |            | 104.9      |            |       | 19.56

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         675.75 ave        1352 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2703
Ave neighs/atom = 0.5404919
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.67                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 56.9402665558481
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.77
  ghost atom cutoff = 3.77
  binsize = 1.885, bins = 6753 107 107
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 93.91 | 93.93 | 93.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.064962679   -0.008331009    0              0.20321904     1313709.1      0              6.3434311e+10  1.1971759e-13  0              3.3173996    
    200000   12727.922      200            200           -0.00042478323 -3.8079725e-35  0             -0.0012743497   162328.4       0              7.8382576e+09  1.1971759e-13  0              3.4236301    
    300000   12727.922      200            200           -0.0002605121   9.5616361e-40  0             -0.00078153629  41185.301      0              1.9886908e+09  1.1971759e-13  0              3.3528836    
    400000   12727.922      200            200            0.019397382   -0.0021942099   0              0.060386356    514.8893       0              24862162       1.1971759e-13  0              3.3251694    
    500000   12727.922      200            200            0.00093136203  8.3186253e-05  0              0.0027108998   382.78033      0              18483092       1.1971759e-13  0              3.3329563    
    600000   12727.922      200            200            0.0047922348   0.00039971753  0              0.013976987    344.75452      0              16646962       1.1971759e-13  0              3.3302639    
    700000   12727.922      200            200            0.005021128    0.000320325    0              0.014743059    12.175099      0              587891.98      1.1971759e-13  0              3.3301482    
    800000   12727.922      200            200            0.0047017763   0.00032200525  0              0.013783324    0.071205148    0              3438.2418      1.1971759e-13  0              3.3303113    
    900000   12727.922      200            200            0.0045373913   0.00032651634  0              0.013285658    0.35167938     0              16981.338      1.1971759e-13  0              3.3303968    
   1000000   12727.922      200            200            0.0044833735   0.0003322349   0              0.013117886    0.10454201     0              5047.9594      1.1971759e-13  0              3.3304257    
   1100000   12727.922      200            200            0.0044704699   0.00033046048  0              0.013080949    0.014290387    0              690.03163      1.1971759e-13  0              3.3304319    
   1200000   12727.922      200            200            0.0044704259   0.00033075606  0              0.013080522    0.00092320732  0              44.578377      1.1971759e-13  0              3.3304319    
   1300000   12727.922      200            200            0.0044719777   0.00033072042  0              0.013085213    7.314973e-06   0              0.35321387     1.1971759e-13  0              3.3304311    
   1400000   12727.922      200            200            0.0044729548   0.00033069823  0              0.013088166    5.8094218e-06  0              0.28051619     1.1971759e-13  0              3.3304306    
   1500000   12727.922      200            200            0.0044733497   0.00033068933  0              0.01308936     3.4253732e-06  0              0.16539901     1.1971759e-13  0              3.3304304    
   1600000   12727.922      200            200            0.0044734622   0.00033068682  0              0.0130897      6.7028639e-07  0              0.032365731    1.1971759e-13  0              3.3304303    
   1700000   12727.922      200            200            0.0044734786   0.00033068647  0              0.013089749    6.596268e-08   0              0.0031851017   1.1971759e-13  0              3.3304303    
   1800000   12727.922      200            200            0.0044734736   0.00033068659  0              0.013089734    2.3620438e-09  0              0.00011405464  1.1971759e-13  0              3.3304303    
   1900000   12727.922      200            200            0.0044734684   0.00033068671  0              0.013089718    2.0116817e-11  0              9.7136908e-07  1.1971759e-13  0              3.3304303    
   2000000   12727.922      200            200            0.0044734658   0.00033068677  0              0.013089711    8.6357568e-11  0              4.1698979e-06  1.1971759e-13  0              3.3304303    
   2100000   12727.922      200            200            0.0044734649   0.00033068679  0              0.013089708    2.6349414e-11  0              1.2723189e-06  1.1971759e-13  0              3.3304303    
   2200000   12727.922      200            200            0.0044734647   0.0003306868   0              0.013089707    3.6891565e-12  0              1.7813616e-07  1.1971759e-13  0              3.3304303    
   2300000   12727.922      200            200            0.0044734647   0.0003306868   0              0.013089707    2.4678555e-13  0              1.1916391e-08  1.1971759e-13  0              3.3304303    
   2400000   12727.922      200            200            0.0044734647   0.0003306868   0              0.013089707    2.0753539e-15  0              1.0021141e-10  1.1971759e-13  0              3.3304303    
   2500000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    1.3382371e-15  0              6.4618682e-11  1.1971759e-13  0              3.3304303    
   2600000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    7.9197981e-16  0              3.8241871e-11  1.1971759e-13  0              3.3304303    
   2700000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    1.2181714e-16  0              5.8821139e-12  1.1971759e-13  0              3.3304303    
   2800000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    4.2758488e-18  0              2.0646544e-13  1.1971759e-13  0              3.3304303    
   2900000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    9.1452513e-18  0              4.4159145e-13  1.1971759e-13  0              3.3304303    
   3000000   12727.922      200            200            0.0044734647   0.00033068679  0              0.013089707    6.5101079e-18  0              3.1434981e-13  1.1971759e-13  0              3.3304303    
Loop time of 535.403 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4841216.768 ns/day, 0.000 hours/ns, 5603.260 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.281     | 75.706     | 129.92     | 607.8 | 14.14
Neigh   | 3.5138     | 3.5481     | 3.5834     |   1.3 |  0.66
Comm    | 16.162     | 21.972     | 25.954     |  85.9 |  4.10
Output  | 0.39874    | 0.39937    | 0.40002    |   0.1 |  0.07
Modify  | 316.07     | 329.12     | 341.79     |  68.1 | 61.47
Other   |            | 104.7      |            |       | 19.55

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         680.75 ave        1362 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2723
Ave neighs/atom = 0.5444911
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.68                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.4069877389307
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.78
  ghost atom cutoff = 3.78
  binsize = 1.89, bins = 6735 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.24 | 92.25 | 92.26 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.10526829    -0.012389645    0              0.32819452     1122201.9      0              5.4187111e+10  1.1971759e-13  0              3.3173563    
    200000   12727.922      200            200           -0.00042215277 -8.6314102e-34  0             -0.0012664583   156360.51      0              7.5500893e+09  1.1971759e-13  0              3.4311757    
    300000   12727.922      200            200           -0.0002528275   3.1733139e-35  0             -0.0007584825   37985.217      0              1.8341702e+09  1.1971759e-13  0              3.3593738    
    400000   12727.922      200            200            0.018115837   -0.0023434855   0              0.056690997    2629.4368      0              1.2696609e+08  1.1971759e-13  0              3.3304784    
    500000   12727.922      200            200            0.0011259434   5.1656509e-05  0              0.0033261736   714.75715      0              34513065       1.1971759e-13  0              3.3377443    
    600000   12727.922      200            200            0.004382514    0.00036439817  0              0.012783144    353.97266      0              17092073       1.1971759e-13  0              3.3354753    
    700000   12727.922      200            200            0.0049177655   0.00032895477  0              0.014424342    24.770726      0              1196089.7      1.1971759e-13  0              3.3352065    
    800000   12727.922      200            200            0.0047040501   0.00032202163  0              0.013790129    0.27418942     0              13239.626      1.1971759e-13  0              3.3353162    
    900000   12727.922      200            200            0.0045575946   0.00032334084  0              0.013349443    0.095593356    0              4615.8611      1.1971759e-13  0              3.3353921    
   1000000   12727.922      200            200            0.0045005169   0.00033194873  0              0.013169602    0.067150523    0              3242.4584      1.1971759e-13  0              3.3354232    
   1100000   12727.922      200            200            0.004481842    0.00033012992  0              0.013115396    0.014900689    0              719.50093      1.1971759e-13  0              3.3354325    
   1200000   12727.922      200            200            0.0044785198   0.00033044956  0              0.01310511     0.0018068757   0              87.247559      1.1971759e-13  0              3.3354342    
   1300000   12727.922      200            200            0.0044787687   0.00033044274  0              0.013105863    0.00011087467  0              5.3537408      1.1971759e-13  0              3.335434     
   1400000   12727.922      200            200            0.0044793835   0.00033042852  0              0.013107722    9.2279856e-07  0              0.04455864     1.1971759e-13  0              3.3354337    
   1500000   12727.922      200            200            0.0044797395   0.00033042042  0              0.013108798    6.4872544e-07  0              0.03132463     1.1971759e-13  0              3.3354335    
   1600000   12727.922      200            200            0.0044798823   0.00033041719  0              0.01310923     4.0829519e-07  0              0.019715113    1.1971759e-13  0              3.3354334    
   1700000   12727.922      200            200            0.004479925    0.00033041624  0              0.013109359    8.7895737e-08  0              0.0042441706   1.1971759e-13  0              3.3354334    
   1800000   12727.922      200            200            0.0044799328   0.00033041607  0              0.013109382    1.0392049e-08  0              0.00050179484  1.1971759e-13  0              3.3354334    
   1900000   12727.922      200            200            0.004479932    0.00033041609  0              0.01310938     6.1240814e-10  0              2.9570997e-05  1.1971759e-13  0              3.3354334    
   2000000   12727.922      200            200            0.0044799305   0.00033041612  0              0.013109375    3.9365999e-12  0              1.9008432e-07  1.1971759e-13  0              3.3354334    
   2100000   12727.922      200            200            0.0044799296   0.00033041614  0              0.013109373    4.2705587e-12  0              2.0620999e-07  1.1971759e-13  0              3.3354334    
   2200000   12727.922      200            200            0.0044799293   0.00033041615  0              0.013109372    2.4802627e-12  0              1.1976301e-07  1.1971759e-13  0              3.3354334    
   2300000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    5.1794431e-13  0              2.5009677e-08  1.1971759e-13  0              3.3354334    
   2400000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    6.008403e-14   0              2.9012428e-09  1.1971759e-13  0              3.3354334    
   2500000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    3.4344657e-15  0              1.6583806e-10  1.1971759e-13  0              3.3354334    
   2600000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    3.467387e-17   0              1.6742771e-12  1.1971759e-13  0              3.3354334    
   2700000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    7.9489266e-19  0              3.8382522e-14  1.1971759e-13  0              3.3354334    
   2800000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    4.5861151e-18  0              2.2144709e-13  1.1971759e-13  0              3.3354334    
   2900000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    2.7349199e-18  0              1.320595e-13   1.1971759e-13  0              3.3354334    
   3000000   12727.922      200            200            0.0044799292   0.00033041615  0              0.013109371    2.1750773e-18  0              1.050267e-13   1.1971759e-13  0              3.3354334    
Loop time of 537.994 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4817895.035 ns/day, 0.000 hours/ns, 5576.267 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.665     | 76.699     | 131.49     | 610.4 | 14.26
Neigh   | 3.4854     | 3.5221     | 3.5595     |   1.4 |  0.65
Comm    | 15.777     | 21.921     | 26.127     |  90.4 |  4.07
Output  | 0.39084    | 0.39148    | 0.39214    |   0.1 |  0.07
Modify  | 318.58     | 330.86     | 342.5      |  63.4 | 61.50
Other   |            | 104.6      |            |       | 19.44

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         686.25 ave        1373 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2745
Ave neighs/atom = 0.54889022
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.69                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 57.8762523554259
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.79
  ghost atom cutoff = 3.79
  binsize = 1.895, bins = 6717 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 92.05 | 92.06 | 92.07 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.14953617    -0.018921164    0              0.46752968     856114.66      0              4.1338713e+10  1.1971759e-13  0              3.3178136    
    200000   12727.922      200            200           -0.00041931963  1.2671513e-41  0             -0.0012579589   150509.76      0              7.2675775e+09  1.1971759e-13  0              3.4386756    
    300000   12727.922      200            200           -0.00024493023 -2.5386333e-35  0             -0.0007347907   34918.057      0              1.686068e+09   1.1971759e-13  0              3.3658057    
    400000   12727.922      200            200            0.015971309   -0.0026495595   0              0.050563486    5889.868       0              2.8440065e+08  1.1971759e-13  0              3.3360103    
    500000   12727.922      200            200            0.0014197586   5.6447035e-05  0              0.0042028288   1115.1494      0              53846571       1.1971759e-13  0              3.3424677    
    600000   12727.922      200            200            0.0040245151   0.00041521017  0              0.011658335    326.07369      0              15744931       1.1971759e-13  0              3.340684     
    700000   12727.922      200            200            0.004788231    0.00035637591  0              0.014008317    36.933707      0              1783396.5      1.1971759e-13  0              3.3402818    
    800000   12727.922      200            200            0.0046836548   0.00032169845  0              0.013729266    1.5880441      0              76680.966      1.1971759e-13  0              3.3403326    
    900000   12727.922      200            200            0.0045681756   0.00032131718  0              0.01338321     0.00015565692  0              7.5161154      1.1971759e-13  0              3.3403927    
   1000000   12727.922      200            200            0.0045140158   0.00033008678  0              0.013211961    0.024029283    0              1160.2881      1.1971759e-13  0              3.3404223    
   1100000   12727.922      200            200            0.0044925947   0.00032909534  0              0.013148689    0.010316286    0              498.13653      1.1971759e-13  0              3.3404332    
   1200000   12727.922      200            200            0.0044866783   0.00032938613  0              0.013130649    0.0020237198   0              97.718187      1.1971759e-13  0              3.3404363    
   1300000   12727.922      200            200            0.0044856172   0.00032940896  0              0.013127443    0.00024066298  0              11.620754      1.1971759e-13  0              3.3404368    
   1400000   12727.922      200            200            0.0044857309   0.00032940596  0              0.013127787    1.6097669e-05  0              0.77729882     1.1971759e-13  0              3.3404368    
   1500000   12727.922      200            200            0.004485947    0.00032940095  0              0.01312844     2.6715005e-07  0              0.01289972     1.1971759e-13  0              3.3404366    
   1600000   12727.922      200            200            0.0044860718   0.00032939811  0              0.013128817    4.1521736e-08  0              0.002004936    1.1971759e-13  0              3.3404366    
   1700000   12727.922      200            200            0.0044861236   0.00032939694  0              0.013128974    4.0569952e-08  0              0.0019589778   1.1971759e-13  0              3.3404365    
   1800000   12727.922      200            200            0.0044861404   0.00032939656  0              0.013129025    1.0639362e-08  0              0.00051373674  1.1971759e-13  0              3.3404365    
   1900000   12727.922      200            200            0.0044861444   0.00032939647  0              0.013129037    1.5832152e-09  0              7.6447797e-05  1.1971759e-13  0              3.3404365    
   2000000   12727.922      200            200            0.0044861447   0.00032939647  0              0.013129038    1.4239223e-10  0              6.875611e-06   1.1971759e-13  0              3.3404365    
   2100000   12727.922      200            200            0.0044861444   0.00032939648  0              0.013129037    5.708493e-12   0              2.756427e-07   1.1971759e-13  0              3.3404365    
   2200000   12727.922      200            200            0.0044861441   0.00032939648  0              0.013129036    2.9282363e-15  0              1.4139405e-10  1.1971759e-13  0              3.3404365    
   2300000   12727.922      200            200            0.004486144    0.00032939648  0              0.013129035    1.2719834e-13  0              6.1419528e-09  1.1971759e-13  0              3.3404365    
   2400000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    4.9552732e-14  0              2.3927241e-09  1.1971759e-13  0              3.3404365    
   2500000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    9.400271e-15   0              4.5390544e-10  1.1971759e-13  0              3.3404365    
   2600000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    1.1087388e-15  0              5.353703e-11   1.1971759e-13  0              3.3404365    
   2700000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    1.306132e-16   0              6.3068441e-12  1.1971759e-13  0              3.3404365    
   2800000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    2.3378124e-17  0              1.128846e-12   1.1971759e-13  0              3.3404365    
   2900000   12727.922      200            200            0.0044861439   0.00032939649  0              0.013129035    2.2865301e-18  0              1.1040835e-13  1.1971759e-13  0              3.3404365    
   3000000   12727.922      200            200            0.0044861439   0.00032939648  0              0.013129035    2.5911348e-18  0              1.2511663e-13  1.1971759e-13  0              3.3404365    
Loop time of 538.89 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4809887.284 ns/day, 0.000 hours/ns, 5566.999 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.331     | 76.905     | 131.86     | 614.7 | 14.27
Neigh   | 3.5309     | 3.5651     | 3.6006     |   1.3 |  0.66
Comm    | 16.197     | 22.466     | 26.819     |  88.4 |  4.17
Output  | 0.394      | 0.39464    | 0.3953     |   0.1 |  0.07
Modify  | 317.53     | 330.34     | 342.51     |  64.8 | 61.30
Other   |            | 105.2      |            |       | 19.53

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         690.75 ave        1382 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2763
Ave neighs/atom = 0.5524895
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.7                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.3480673168373
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.8
  ghost atom cutoff = 3.8
  binsize = 1.9, bins = 6699 106 106
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 91.81 | 91.82 | 91.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.19274768    -0.025957555    0              0.6042006      550021.78      0              2.6558584e+10  1.1971759e-13  0              3.3189963    
    200000   12727.922      200            200           -0.00041628474  2.5386541e-35  0             -0.0012488542   144775.83      0              6.9907067e+09  1.1971759e-13  0              3.4461299    
    300000   12727.922      200            200           -0.00023682159  5.0773586e-35  0             -0.00071046477  31983.359      0              1.544362e+09   1.1971759e-13  0              3.3721792    
    400000   12727.922      200            200            0.013513666   -0.0022063836   0              0.042747381    9562.3813      0              4.6173317e+08  1.1971759e-13  0              3.3417345    
    500000   12727.922      200            200            0.0018123078   4.8088395e-05  0              0.0053888349   1547.6258      0              74729311       1.1971759e-13  0              3.347132     
    600000   12727.922      200            200            0.0037062545   0.00046314521  0              0.010655618    268.33135      0              12956761       1.1971759e-13  0              3.3458792    
    700000   12727.922      200            200            0.0046309871   0.00036090923  0              0.013532052    45.054529      0              2175522        1.1971759e-13  0              3.3453685    
    800000   12727.922      200            200            0.0046432659   0.00032060279  0              0.013609195    3.4972692      0              168870.62      1.1971759e-13  0              3.3453592    
    900000   12727.922      200            200            0.0045681267   0.00031922782  0              0.013385152    0.10995595     0              5309.3792      1.1971759e-13  0              3.3453986    
   1000000   12727.922      200            200            0.0045229905   0.00032751116  0              0.01324146     0.0007487235   0              36.153178      1.1971759e-13  0              3.3454236    
   1100000   12727.922      200            200            0.0045017017   0.00032683224  0              0.013178273    0.0038593647   0              186.35491      1.1971759e-13  0              3.3454346    
   1200000   12727.922      200            200            0.0044942911   0.00032705837  0              0.013155815    0.0013978777   0              67.498513      1.1971759e-13  0              3.3454384    
   1300000   12727.922      200            200            0.0044921808   0.00032710602  0              0.013149436    0.00026857527  0              12.968539      1.1971759e-13  0              3.3454395    
   1400000   12727.922      200            200            0.0044917821   0.00032711473  0              0.013148231    3.3870586e-05  0              1.6354894      1.1971759e-13  0              3.3454397    
   1500000   12727.922      200            200            0.0044918016   0.00032711412  0              0.013148291    2.7193385e-06  0              0.13130712     1.1971759e-13  0              3.3454397    
   1600000   12727.922      200            200            0.0044918681   0.00032711255  0              0.013148492    9.5682261e-08  0              0.004620154    1.1971759e-13  0              3.3454397    
   1700000   12727.922      200            200            0.0044919095   0.00032711159  0              0.013148617    2.8243833e-10  0              1.3637936e-05  1.1971759e-13  0              3.3454396    
   1800000   12727.922      200            200            0.0044919279   0.00032711117  0              0.013148673    2.7713079e-09  0              0.00013381654  1.1971759e-13  0              3.3454396    
   1900000   12727.922      200            200            0.0044919345   0.00032711102  0              0.013148693    1.0602525e-09  0              5.1195797e-05  1.1971759e-13  0              3.3454396    
   2000000   12727.922      200            200            0.0044919364   0.00032711097  0              0.013148698    2.093207e-10   0              1.0107347e-05  1.1971759e-13  0              3.3454396    
   2100000   12727.922      200            200            0.0044919368   0.00032711097  0              0.0131487      2.7017725e-11  0              1.3045892e-06  1.1971759e-13  0              3.3454396    
   2200000   12727.922      200            200            0.0044919368   0.00032711097  0              0.013148699    2.2368208e-12  0              1.0800807e-07  1.1971759e-13  0              3.3454396    
   2300000   12727.922      200            200            0.0044919368   0.00032711097  0              0.013148699    8.4422482e-14  0              4.0764595e-09  1.1971759e-13  0              3.3454396    
   2400000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    8.1181644e-17  0              3.919971e-12   1.1971759e-13  0              3.3454396    
   2500000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    1.9697266e-15  0              9.5111047e-11  1.1971759e-13  0              3.3454396    
   2600000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    7.2506054e-16  0              3.5010579e-11  1.1971759e-13  0              3.3454396    
   2700000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    9.0420574e-17  0              4.3660859e-12  1.1971759e-13  0              3.3454396    
   2800000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    7.6498438e-19  0              3.6938358e-14  1.1971759e-13  0              3.3454396    
   2900000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    1.1813055e-17  0              5.7041017e-13  1.1971759e-13  0              3.3454396    
   3000000   12727.922      200            200            0.0044919367   0.00032711097  0              0.013148699    1.2917158e-17  0              6.2372333e-13  1.1971759e-13  0              3.3454396    
Loop time of 536.897 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4827738.184 ns/day, 0.000 hours/ns, 5587.660 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.208     | 76.907     | 132.06     | 617.2 | 14.32
Neigh   | 3.4977     | 3.534      | 3.5706     |   1.4 |  0.66
Comm    | 15.873     | 22.128     | 26.557     |  89.4 |  4.12
Output  | 0.39305    | 0.39372    | 0.39437    |   0.1 |  0.07
Modify  | 317.92     | 329.5      | 341.23     |  60.3 | 61.37
Other   |            | 104.4      |            |       | 19.45

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         696.25 ave        1393 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2785
Ave neighs/atom = 0.55688862
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.71                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 58.8224395346687
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.81
  ghost atom cutoff = 3.81
  binsize = 1.905, bins = 6682 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 90.19 | 90.2 | 90.21 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.22762505    -0.036184809    0              0.71905994     262853.28      0              1.2692244e+10  1.1971759e-13  0              3.3211263    
    200000   12727.922      200            200           -0.00041304904  1.0154663e-34  0             -0.0012391471   139158.43      0              6.7194627e+09  1.1971759e-13  0              3.4535383    
    300000   12727.922      200            200           -0.00022850291 -4.061836e-34   0             -0.00068550872  29180.676      0              1.4090304e+09  1.1971759e-13  0              3.3784942    
    400000   12727.922      200            200            0.011062807   -0.00093529485  0              0.034123714    12908.786      0              6.2331909e+08  1.1971759e-13  0              3.3476118    
    500000   12727.922      200            200            0.0023409055   9.3580365e-05  0              0.0069291362   1965.872       0              94924922       1.1971759e-13  0              3.3517447    
    600000   12727.922      200            200            0.0034006188   0.00038696419  0              0.0098148923   193.39004      0              9338113.1      1.1971759e-13  0              3.3510514    
    700000   12727.922      200            200            0.0044524426   0.00032186968  0              0.013035458    46.824827      0              2261003.3      1.1971759e-13  0              3.3504602    
    800000   12727.922      200            200            0.0045882185   0.00032028479  0              0.013444371    5.2630663      0              254134.64      1.1971759e-13  0              3.3503935    
    900000   12727.922      200            200            0.004558733    0.00031864489  0              0.013357554    0.37008657     0              17870.156      1.1971759e-13  0              3.3504097    
   1000000   12727.922      200            200            0.0045276951   0.00032646341  0              0.013256622    0.01080828     0              521.89316      1.1971759e-13  0              3.3504274    
   1100000   12727.922      200            200            0.0045092867   0.00032554522  0              0.013202315    0.00012720601  0              6.142323       1.1971759e-13  0              3.3504369    
   1200000   12727.922      200            200            0.0045017044   0.00032572643  0              0.013179387    0.00046323014  0              22.367725      1.1971759e-13  0              3.3504408    
   1300000   12727.922      200            200            0.0044990072   0.00032578973  0              0.013171232    0.00016854809  0              8.1385838      1.1971759e-13  0              3.3504422    
   1400000   12727.922      200            200            0.004498208    0.00032580822  0              0.013168816    3.4293281e-05  0              1.6558998      1.1971759e-13  0              3.3504427    
   1500000   12727.922      200            200            0.0044980317   0.00032581221  0              0.013168283    4.8482847e-06  0              0.23410631     1.1971759e-13  0              3.3504427    
   1600000   12727.922      200            200            0.0044980202   0.00032581242  0              0.013168248    4.8589752e-07  0              0.023462252    1.1971759e-13  0              3.3504427    
   1700000   12727.922      200            200            0.0044980361   0.00032581203  0              0.013168296    3.0259125e-08  0              0.0014611048   1.1971759e-13  0              3.3504427    
   1800000   12727.922      200            200            0.0044980484   0.00032581173  0              0.013168334    5.5676272e-10  0              2.6884079e-05  1.1971759e-13  0              3.3504427    
   1900000   12727.922      200            200            0.0044980546   0.00032581159  0              0.013168352    5.5638621e-11  0              2.6865899e-06  1.1971759e-13  0              3.3504427    
   2000000   12727.922      200            200            0.004498057    0.00032581153  0              0.01316836     6.7106001e-11  0              3.2403086e-06  1.1971759e-13  0              3.3504427    
   2100000   12727.922      200            200            0.0044980579   0.00032581151  0              0.013168362    2.0399311e-11  0              9.8500974e-07  1.1971759e-13  0              3.3504427    
   2200000   12727.922      200            200            0.0044980581   0.0003258115   0              0.013168363    3.7739035e-12  0              1.822283e-07   1.1971759e-13  0              3.3504427    
   2300000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    4.9309772e-13  0              2.3809924e-08  1.1971759e-13  0              3.3504427    
   2400000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    4.4279116e-14  0              2.13808e-09    1.1971759e-13  0              3.3504427    
   2500000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    2.347994e-15   0              1.1337623e-10  1.1971759e-13  0              3.3504427    
   2600000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    3.1676459e-17  0              1.5295429e-12  1.1971759e-13  0              3.3504427    
   2700000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    6.1103579e-18  0              2.9504732e-13  1.1971759e-13  0              3.3504427    
   2800000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    9.6141189e-18  0              4.6423139e-13  1.1971759e-13  0              3.3504427    
   2900000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    6.4754311e-18  0              3.1267539e-13  1.1971759e-13  0              3.3504427    
   3000000   12727.922      200            200            0.0044980582   0.0003258115   0              0.013168363    9.0917386e-18  0              4.3900752e-13  1.1971759e-13  0              3.3504427    
Loop time of 543.102 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4772580.908 ns/day, 0.000 hours/ns, 5523.820 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.203     | 77.273     | 132.81     | 618.2 | 14.23
Neigh   | 3.4888     | 3.5248     | 3.5617     |   1.4 |  0.65
Comm    | 15.935     | 22.237     | 26.299     |  87.9 |  4.09
Output  | 0.40529    | 0.40593    | 0.40659    |   0.1 |  0.07
Modify  | 318.93     | 332.28     | 347.55     |  69.8 | 61.18
Other   |            | 107.4      |            |       | 19.77

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         700.75 ave        1402 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2803
Ave neighs/atom = 0.5604879
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.72                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.299375920424
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.82
  ghost atom cutoff = 3.82
  binsize = 1.91, bins = 6664 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.98 | 89.99 | 90 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.24989689    -0.044212609    0              0.79390326     62258.253      0              3.0062282e+09  1.1971759e-13  0              3.3243907    
    200000   12727.922      200            200           -0.00040961345 -2.5386332e-35  0             -0.0012288404   133657.22      0              6.453829e+09   1.1971759e-13  0              3.460901     
    300000   12727.922      200            200           -0.00021997544 -5.0772626e-35  0             -0.00065992631  26509.536      0              1.2800506e+09  1.1971759e-13  0              3.3847505    
    400000   12727.922      200            200            0.0084181986  -0.00028855375  0              0.02554315     15375.754      0              7.4244014e+08  1.1971759e-13  0              3.3535983    
    500000   12727.922      200            200            0.002988587    0.00010711765  0              0.0088586435   2316.0185      0              1.1183225e+08  1.1971759e-13  0              3.3563156    
    600000   12727.922      200            200            0.0031420437   0.00026577869  0              0.0091603526   116.28457      0              5614965.5      1.1971759e-13  0              3.3561925    
    700000   12727.922      200            200            0.0042943681   0.00032518684  0              0.012557917    41.854553      0              2021006.6      1.1971759e-13  0              3.3555504    
    800000   12727.922      200            200            0.0045295358   0.00033500869  0              0.013253599    6.2115538      0              299933.7       1.1971759e-13  0              3.3554325    
    900000   12727.922      200            200            0.0045420978   0.00031983562  0              0.013306458    0.65368385     0              31564.054      1.1971759e-13  0              3.3554248    
   1000000   12727.922      200            200            0.0045284297   0.00032708829  0              0.013258201    0.04785571     0              2310.781       1.1971759e-13  0              3.3554336    
   1100000   12727.922      200            200            0.0045153144   0.00032591155  0              0.013220032    0.0017152105   0              82.821374      1.1971759e-13  0              3.3554403    
   1200000   12727.922      200            200            0.0045088594   0.00032606636  0              0.013200512    9.7441197e-07  0              0.047050867    1.1971759e-13  0              3.3554437    
   1300000   12727.922      200            200            0.0045061364   0.00032613065  0              0.013192278    3.8854317e-05  0              1.8761359      1.1971759e-13  0              3.3554451    
   1400000   12727.922      200            200            0.0045051385   0.00032615396  0              0.013189262    1.7098301e-05  0              0.82561574     1.1971759e-13  0              3.3554456    
   1500000   12727.922      200            200            0.0045048209   0.00032616131  0              0.013188301    3.9770031e-06  0              0.19203525     1.1971759e-13  0              3.3554458    
   1600000   12727.922      200            200            0.0045047374   0.00032616322  0              0.013188049    6.5650029e-07  0              0.03170005     1.1971759e-13  0              3.3554458    
   1700000   12727.922      200            200            0.0045047229   0.00032616354  0              0.013188005    8.237612e-08   0              0.003977648    1.1971759e-13  0              3.3554458    
   1800000   12727.922      200            200            0.0045047241   0.0003261635   0              0.013188009    7.6961499e-09  0              0.00037161954  1.1971759e-13  0              3.3554458    
   1900000   12727.922      200            200            0.004504727    0.00032616343  0              0.013188017    4.6360899e-10  0              2.2386019e-05  1.1971759e-13  0              3.3554458    
   2000000   12727.922      200            200            0.0045047287   0.00032616339  0              0.013188023    8.7888214e-12  0              4.2438073e-07  1.1971759e-13  0              3.3554458    
   2100000   12727.922      200            200            0.0045047295   0.00032616337  0              0.013188025    7.4154752e-13  0              3.5806676e-08  1.1971759e-13  0              3.3554458    
   2200000   12727.922      200            200            0.0045047299   0.00032616336  0              0.013188026    9.7719429e-13  0              4.7185215e-08  1.1971759e-13  0              3.3554458    
   2300000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    3.1466253e-13  0              1.5193927e-08  1.1971759e-13  0              3.3554458    
   2400000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    6.2792311e-14  0              3.032016e-09   1.1971759e-13  0              3.3554458    
   2500000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    9.3673158e-15  0              4.5231416e-10  1.1971759e-13  0              3.3554458    
   2600000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    1.0903996e-15  0              5.2651493e-11  1.1971759e-13  0              3.3554458    
   2700000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    1.4995522e-16  0              7.2408009e-12  1.1971759e-13  0              3.3554458    
   2800000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    1.9852711e-17  0              9.5861636e-13  1.1971759e-13  0              3.3554458    
   2900000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    2.0218076e-20  0              9.7625853e-16  1.1971759e-13  0              3.3554458    
   3000000   12727.922      200            200            0.00450473     0.00032616336  0              0.013188027    1.6004465e-20  0              7.7279834e-16  1.1971759e-13  0              3.3554458    
Loop time of 541.09 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4790331.600 ns/day, 0.000 hours/ns, 5544.365 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.313     | 77.446     | 132.84     | 620.8 | 14.31
Neigh   | 3.6127     | 3.6507     | 3.6896     |   1.4 |  0.67
Comm    | 16.271     | 22.329     | 27.114     |  89.1 |  4.13
Output  | 0.39355    | 0.39418    | 0.39482    |   0.1 |  0.07
Modify  | 321.29     | 332.38     | 343.09     |  57.2 | 61.43
Other   |            | 104.9      |            |       | 19.39

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         705.75 ave        1412 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2823
Ave neighs/atom = 0.5644871
Neighbor list builds = 159
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.73                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 59.7788833856071
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.83
  ghost atom cutoff = 3.83
  binsize = 1.915, bins = 6647 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.79 | 89.81 | 89.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.25622604    -0.04723991     0              0.81591805     966.21195      0              46654917       1.1971759e-13  0              3.3289123    
    200000   12727.922      200            200           -0.00040597893  1.5231916e-34  0             -0.0012179368   128271.92      0              6.1937917e+09  1.1971759e-13  0              3.4682177    
    300000   12727.922      200            200           -0.00021124055 -2.5386436e-35  0             -0.00063372165  23969.504      0              1.1574015e+09  1.1971759e-13  0              3.3909481    
    400000   12727.922      200            200            0.006237964    0.00099971904  0              0.017714173    16691.088      0              8.0595289e+08  1.1971759e-13  0              3.3596502    
    500000   12727.922      200            200            0.0037472198   5.6318568e-05  0              0.011185341    2542.0809      0              1.2274799e+08  1.1971759e-13  0              3.3608575    
    600000   12727.922      200            200            0.0029798965   0.00023334202  0              0.0087063476   51.502528      0              2486872.8      1.1971759e-13  0              3.3612961    
    700000   12727.922      200            200            0.0041530155   0.00032503013  0              0.012134016    31.691365      0              1530262.6      1.1971759e-13  0              3.3606327    
    800000   12727.922      200            200            0.0044706843   0.00035419915  0              0.013057854    5.9900421      0              289237.7       1.1971759e-13  0              3.3604727    
    900000   12727.922      200            200            0.0045201585   0.00031964519  0              0.01324083     0.82399363     0              39787.703      1.1971759e-13  0              3.3604425    
   1000000   12727.922      200            200            0.0045261657   0.0003294524   0              0.013249045    0.089753448    0              4333.8728      1.1971759e-13  0              3.3604415    
   1100000   12727.922      200            200            0.004519984    0.00032813103  0              0.013231821    0.0074302451   0              358.77994      1.1971759e-13  0              3.3604447    
   1200000   12727.922      200            200            0.0045157059   0.00032823146  0              0.013218886    0.0003864356   0              18.659592      1.1971759e-13  0              3.3604469    
   1300000   12727.922      200            200            0.0045135027   0.00032828227  0              0.013212226    4.3361737e-06  0              0.20937831     1.1971759e-13  0              3.3604481    
   1400000   12727.922      200            200            0.0045125471   0.00032830407  0              0.013209337    1.4223394e-06  0              0.06867968     1.1971759e-13  0              3.3604486    
   1500000   12727.922      200            200            0.0045121792   0.0003283124   0              0.013208225    1.2272457e-06  0              0.059259304    1.1971759e-13  0              3.3604488    
   1600000   12727.922      200            200            0.004512052    0.00032831526  0              0.013207841    3.7120838e-07  0              0.017924324    1.1971759e-13  0              3.3604489    
   1700000   12727.922      200            200            0.0045120131   0.00032831613  0              0.013207723    7.5303648e-08  0              0.0036361437   1.1971759e-13  0              3.3604489    
   1800000   12727.922      200            200            0.0045120031   0.00032831635  0              0.013207693    1.1834724e-08  0              0.00057145649  1.1971759e-13  0              3.3604489    
   1900000   12727.922      200            200            0.0045120014   0.00032831638  0              0.013207688    1.4987263e-09  0              7.2368129e-05  1.1971759e-13  0              3.3604489    
   2000000   12727.922      200            200            0.0045120016   0.00032831638  0              0.013207688    1.5084065e-10  0              7.2835553e-06  1.1971759e-13  0              3.3604489    
   2100000   12727.922      200            200            0.0045120019   0.00032831637  0              0.013207689    1.1107092e-11  0              5.3632174e-07  1.1971759e-13  0              3.3604489    
   2200000   12727.922      200            200            0.0045120021   0.00032831636  0              0.01320769     4.4347097e-13  0              2.1413626e-08  1.1971759e-13  0              3.3604489    
   2300000   12727.922      200            200            0.0045120022   0.00032831636  0              0.01320769     1.9900072e-16  0              9.6090325e-12  1.1971759e-13  0              3.3604489    
   2400000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     6.1344842e-15  0              2.9621229e-10  1.1971759e-13  0              3.3604489    
   2500000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     3.2808072e-15  0              1.5841844e-10  1.1971759e-13  0              3.3604489    
   2600000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     7.8541002e-16  0              3.7924639e-11  1.1971759e-13  0              3.3604489    
   2700000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     7.6374483e-17  0              3.6878504e-12  1.1971759e-13  0              3.3604489    
   2800000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     1.2692758e-20  0              6.1288787e-16  1.1971759e-13  0              3.3604489    
   2900000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     1.1792609e-17  0              5.6942286e-13  1.1971759e-13  0              3.3604489    
   3000000   12727.922      200            200            0.0045120023   0.00032831636  0              0.01320769     1.1259101e-17  0              5.4366167e-13  1.1971759e-13  0              3.3604489    
Loop time of 534.576 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4848699.592 ns/day, 0.000 hours/ns, 5611.921 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.22      | 74.829     | 128.62     | 604.5 | 14.00
Neigh   | 3.5401     | 3.5803     | 3.6199     |   1.5 |  0.67
Comm    | 16.072     | 22.004     | 25.991     |  88.4 |  4.12
Output  | 0.39289    | 0.39352    | 0.39418    |   0.1 |  0.07
Modify  | 313.92     | 328.42     | 342.21     |  75.2 | 61.43
Other   |            | 105.4      |            |       | 19.71

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         659.75 ave        1320 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2639
Ave neighs/atom = 0.52769446
Neighbor list builds = 156
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.74                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.2609688417216
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.84
  ghost atom cutoff = 3.84
  binsize = 1.92, bins = 6630 105 105
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 89.59 | 89.6 | 89.61 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.2450006     -0.045840897    0              0.7808427      95574.613      0              4.614956e+09   1.1971759e-13  0              3.3347285    
    200000   12727.922      200            200           -0.00040214637 -1.5231848e-34  0             -0.0012064391   123002.18      0              5.9393351e+09  1.1971759e-13  0              3.4754884    
    300000   12727.922      200            200           -0.00020229952  1.0154695e-34  0             -0.00060689855  21560.115      0              1.0410608e+09  1.1971759e-13  0              3.3970869    
    400000   12727.922      200            200            0.0039109952   0.0006052673   0              0.011127718    16858.665      0              8.1404462e+08  1.1971759e-13  0              3.3657273    
    500000   12727.922      200            200            0.0046980906   0.00022548592  0              0.013868786    2595.9147      0              1.2534743e+08  1.1971759e-13  0              3.3653853    
    600000   12727.922      200            200            0.0029054606   0.00025674319  0              0.0084596385   10.617153      0              512664.32      1.1971759e-13  0              3.3663578    
    700000   12727.922      200            200            0.0040332365   0.00030725254  0              0.011792457    19.281881      0              931053.02      1.1971759e-13  0              3.3657015    
    800000   12727.922      200            200            0.0044121849   0.00035849316  0              0.012878062    4.6933202      0              226623.64      1.1971759e-13  0              3.3655105    
    900000   12727.922      200            200            0.0044982392   0.0003233733   0              0.013171344    0.80018314     0              38637.98       1.1971759e-13  0              3.3654608    
   1000000   12727.922      200            200            0.0045210051   0.00032939522  0              0.01323362     0.11182651     0              5399.7019      1.1971759e-13  0              3.3654506    
   1100000   12727.922      200            200            0.0045223953   0.00032801499  0              0.013239171    0.013203012    0              637.52621      1.1971759e-13  0              3.3654498    
   1200000   12727.922      200            200            0.0045209542   0.00032805106  0              0.013234811    0.0012889082   0              62.236765      1.1971759e-13  0              3.3654506    
   1300000   12727.922      200            200            0.0045196971   0.00032808079  0              0.01323101     9.6428411e-05  0              4.6561829      1.1971759e-13  0              3.3654513    
   1400000   12727.922      200            200            0.0045190069   0.00032809683  0              0.013228924    4.349404e-06   0              0.21001716     1.1971759e-13  0              3.3654517    
   1500000   12727.922      200            200            0.0045186904   0.00032810412  0              0.013227967    2.1970188e-08  0              0.0010608618   1.1971759e-13  0              3.3654518    
   1600000   12727.922      200            200            0.0045185605   0.00032810709  0              0.013227574    3.0888385e-08  0              0.0014914896   1.1971759e-13  0              3.3654519    
   1700000   12727.922      200            200            0.0045185117   0.0003281082   0              0.013227427    2.0587781e-08  0              0.00099411026  1.1971759e-13  0              3.3654519    
   1800000   12727.922      200            200            0.0045184948   0.00032810858  0              0.013227376    5.9753306e-09  0              0.00028852733  1.1971759e-13  0              3.3654519    
   1900000   12727.922      200            200            0.0045184894   0.0003281087   0              0.01322736     1.2315466e-09  0              5.946698e-05   1.1971759e-13  0              3.3654519    
   2000000   12727.922      200            200            0.0045184879   0.00032810874  0              0.013227355    2.0447384e-10  0              9.8733101e-06  1.1971759e-13  0              3.3654519    
   2100000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    2.8554297e-11  0              1.3787848e-06  1.1971759e-13  0              3.3654519    
   2200000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    3.3767066e-12  0              1.6304908e-07  1.1971759e-13  0              3.3654519    
   2300000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    3.3083961e-13  0              1.5975061e-08  1.1971759e-13  0              3.3654519    
   2400000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    2.4818975e-14  0              1.1984195e-09  1.1971759e-13  0              3.3654519    
   2500000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    1.176267e-15   0              5.6797725e-11  1.1971759e-13  0              3.3654519    
   2600000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    2.2463019e-17  0              1.0846588e-12  1.1971759e-13  0              3.3654519    
   2700000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    1.5267092e-17  0              7.3719322e-13  1.1971759e-13  0              3.3654519    
   2800000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    1.7256943e-17  0              8.3327602e-13  1.1971759e-13  0              3.3654519    
   2900000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    5.7998707e-18  0              2.80055e-13    1.1971759e-13  0              3.3654519    
   3000000   12727.922      200            200            0.0045184876   0.00032810874  0              0.013227354    8.5321263e-18  0              4.1198584e-13  1.1971759e-13  0              3.3654519    
Loop time of 536.032 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4835528.561 ns/day, 0.000 hours/ns, 5596.677 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.232     | 75.872     | 130.27     | 609.6 | 14.15
Neigh   | 3.3672     | 3.4036     | 3.4405     |   1.4 |  0.63
Comm    | 15.779     | 21.818     | 25.84      |  88.1 |  4.07
Output  | 0.39056    | 0.39118    | 0.3918     |   0.1 |  0.07
Modify  | 317.45     | 330.06     | 342.76     |  66.3 | 61.57
Other   |            | 104.5      |            |       | 19.49

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         665.75 ave        1332 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2663
Ave neighs/atom = 0.5324935
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.75                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 60.7456392002713
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.85
  ghost atom cutoff = 3.85
  binsize = 1.925, bins = 6612 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.99 | 88 | 88.02 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.2189446     -0.037575718    0              0.69440953     319233.63      0              1.5414649e+10  1.1971759e-13  0              3.3417839    
    200000   12727.922      200            200           -0.00039811673  1.269328e-35   0             -0.0011943502   117847.71      0              5.690444e+09   1.1971759e-13  0              3.482713     
    300000   12727.922      200            200           -0.00019315362  4.9875418e-42  0             -0.00057946086  19280.916      0              9.3100645e+08  1.1971759e-13  0              3.4031667    
    400000   12727.922      200            200            0.0021010196   0.00025439927  0              0.0060486596   16081.616      0              7.7652367e+08  1.1971759e-13  0              3.3717954    
    500000   12727.922      200            200            0.0057116898   0.00031531518  0              0.016819754    2449.6231      0              1.1828353e+08  1.1971759e-13  0              3.3699167    
    600000   12727.922      200            200            0.0028960361   0.00026540898  0              0.0084226992   0.63177377     0              30506.094      1.1971759e-13  0              3.3713749    
    700000   12727.922      200            200            0.0039399002   0.00026441813  0              0.011555282    8.1086584      0              391538.1       1.1971759e-13  0              3.370752     
    800000   12727.922      200            200            0.004359209    0.00034470719  0              0.01273292     2.8172502      0              136034.93      1.1971759e-13  0              3.3705425    
    900000   12727.922      200            200            0.0044784292   0.00032629165  0              0.013108996    0.59498393     0              28729.645      1.1971759e-13  0              3.370478     
   1000000   12727.922      200            200            0.0045148731   0.00032731875  0              0.013217301    0.10131136     0              4891.9628      1.1971759e-13  0              3.3704598    
   1100000   12727.922      200            200            0.004523534    0.00032623319  0              0.013244369    0.014986315    0              723.63552      1.1971759e-13  0              3.3704553    
   1200000   12727.922      200            200            0.004525106    0.00032619986  0              0.013249118    0.0019587748   0              94.582224      1.1971759e-13  0              3.3704546    
   1300000   12727.922      200            200            0.0045250227   0.00032620295  0              0.013248865    0.0002255667   0              10.891809      1.1971759e-13  0              3.3704547    
   1400000   12727.922      200            200            0.0045247528   0.00032620962  0              0.013248049    2.2395671e-05  0              1.0814068      1.1971759e-13  0              3.3704548    
   1500000   12727.922      200            200            0.0045245721   0.00032621394  0              0.013247502    1.8146741e-06  0              0.087624116    1.1971759e-13  0              3.3704549    
   1600000   12727.922      200            200            0.00452448     0.00032621611  0              0.013247224    1.0373146e-07  0              0.005008821    1.1971759e-13  0              3.370455     
   1700000   12727.922      200            200            0.0045244388   0.00032621708  0              0.013247099    2.3091535e-09  0              0.00011150076  1.1971759e-13  0              3.370455     
   1800000   12727.922      200            200            0.0045244218   0.00032621747  0              0.013247048    8.2563959e-11  0              3.9867181e-06  1.1971759e-13  0              3.370455     
   1900000   12727.922      200            200            0.0045244153   0.00032621763  0              0.013247028    1.6664368e-10  0              8.046627e-06   1.1971759e-13  0              3.370455     
   2000000   12727.922      200            200            0.004524413    0.00032621768  0              0.013247021    6.3281957e-11  0              3.0556592e-06  1.1971759e-13  0              3.370455     
   2100000   12727.922      200            200            0.0045244122   0.0003262177   0              0.013247019    1.5369676e-11  0              7.4214666e-07  1.1971759e-13  0              3.370455     
   2200000   12727.922      200            200            0.0045244119   0.0003262177   0              0.013247018    2.953631e-12   0              1.4262027e-07  1.1971759e-13  0              3.370455     
   2300000   12727.922      200            200            0.0045244119   0.00032621771  0              0.013247018    4.8287723e-13  0              2.3316413e-08  1.1971759e-13  0              3.370455     
   2400000   12727.922      200            200            0.0045244119   0.00032621771  0              0.013247018    6.9291239e-14  0              3.3458259e-09  1.1971759e-13  0              3.370455     
   2500000   12727.922      200            200            0.0045244118   0.00032621771  0              0.013247018    8.7639667e-15  0              4.2318059e-10  1.1971759e-13  0              3.370455     
   2600000   12727.922      200            200            0.0045244118   0.00032621771  0              0.013247018    1.0087168e-15  0              4.8707323e-11  1.1971759e-13  0              3.370455     
   2700000   12727.922      200            200            0.0045244119   0.00032621771  0              0.013247018    1.5696802e-16  0              7.5794238e-12  1.1971759e-13  0              3.370455     
   2800000   12727.922      200            200            0.0045244119   0.00032621771  0              0.013247018    1.413459e-17   0              6.8250874e-13  1.1971759e-13  0              3.370455     
   2900000   12727.922      200            200            0.0045244119   0.00032621771  0              0.013247018    2.4839024e-20  0              1.1993876e-15  1.1971759e-13  0              3.370455     
   3000000   12727.922      200            200            0.0045244119   0.0003262177   0              0.013247018    1.0895355e-19  0              5.260977e-15   1.1971759e-13  0              3.370455     
Loop time of 536.94 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4827358.351 ns/day, 0.000 hours/ns, 5587.220 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.567     | 76.101     | 131.29     | 609.9 | 14.17
Neigh   | 3.2479     | 3.283      | 3.3194     |   1.4 |  0.61
Comm    | 15.634     | 21.569     | 26.082     |  92.5 |  4.02
Output  | 0.43276    | 0.43341    | 0.43406    |   0.1 |  0.08
Modify  | 318.02     | 330.63     | 342.44     |  64.5 | 61.58
Other   |            | 104.9      |            |       | 19.54

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         671.75 ave        1344 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2687
Ave neighs/atom = 0.53729254
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.76                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.2329013727605
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.86
  ghost atom cutoff = 3.86
  binsize = 1.93, bins = 6595 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.81 | 87.82 | 87.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.18107994    -0.027689893    0              0.5709297      612655.78      0              2.9582955e+10  1.1971759e-13  0              3.3499394    
    200000   12727.922      200            200           -0.00039389093  2.5386538e-35  0             -0.0011816728   112808.2       0              5.4471041e+09  1.1971759e-13  0              3.4898915    
    300000   12727.922      200            200           -0.00018380422  6.0058869e-40  0             -0.00055141266  17131.469      0              8.2721734e+08  1.1971759e-13  0              3.4091875    
    400000   12727.922      200            200            0.00088777132  0.00013982085  0              0.0025234931   14661.581      0              7.0795528e+08  1.1971759e-13  0              3.3778282    
    500000   12727.922      200            200            0.0067451416   0.00034222985  0              0.019893195    2107.4758      0              1.0176247e+08  1.1971759e-13  0              3.374471     
    600000   12727.922      200            200            0.0029527268   0.00026172365  0              0.0085964568   23.098404      0              1115339.3      1.1971759e-13  0              3.3763469    
    700000   12727.922      200            200            0.0038976256   0.00025577029  0              0.011437107    1.2314729      0              59463.421      1.1971759e-13  0              3.3757812    
    800000   12727.922      200            200            0.0043255238   0.0003391478   0              0.012637424    1.0647932      0              51415.054      1.1971759e-13  0              3.375566     
    900000   12727.922      200            200            0.0044643713   0.00032936076  0              0.013063753    0.30703071     0              14825.414      1.1971759e-13  0              3.3754924    
   1000000   12727.922      200            200            0.0045104557   0.0003258294   0              0.013205538    0.064566035    0              3117.6628      1.1971759e-13  0              3.3754683    
   1100000   12727.922      200            200            0.0045252591   0.00032570694  0              0.01325007     0.011568855    0              558.61858      1.1971759e-13  0              3.3754608    
   1200000   12727.922      200            200            0.0045295295   0.00032561106  0              0.013262977    0.0018489118   0              89.277336      1.1971759e-13  0              3.3754586    
   1300000   12727.922      200            200            0.004530614    0.00032558703  0              0.013266255    0.00026873575  0              12.976288      1.1971759e-13  0              3.3754581    
   1400000   12727.922      200            200            0.0045308185   0.00032558271  0              0.013266873    3.579427e-05   0              1.7283772      1.1971759e-13  0              3.375458     
   1500000   12727.922      200            200            0.0045308196   0.00032558284  0              0.013266876    4.3661311e-06  0              0.21082484     1.1971759e-13  0              3.375458     
   1600000   12727.922      200            200            0.0045307929   0.00032558352  0              0.013266795    4.8332923e-07  0              0.023338239    1.1971759e-13  0              3.375458     
   1700000   12727.922      200            200            0.0045307736   0.00032558398  0              0.013266737    4.7535411e-08  0              0.0022953149   1.1971759e-13  0              3.375458     
   1800000   12727.922      200            200            0.0045307634   0.00032558422  0              0.013266706    3.9708741e-09  0              0.0001917393   1.1971759e-13  0              3.375458     
   1900000   12727.922      200            200            0.0045307586   0.00032558434  0              0.013266692    2.5340248e-10  0              1.2235899e-05  1.1971759e-13  0              3.375458     
   2000000   12727.922      200            200            0.0045307566   0.00032558438  0              0.013266685    8.7362871e-12  0              4.2184404e-07  1.1971759e-13  0              3.375458     
   2100000   12727.922      200            200            0.0045307558   0.0003255844   0              0.013266683    3.1352328e-16  0              1.5138917e-11  1.1971759e-13  0              3.375458     
   2200000   12727.922      200            200            0.0045307555   0.00032558441  0              0.013266682    1.6777507e-13  0              8.1012576e-09  1.1971759e-13  0              3.375458     
   2300000   12727.922      200            200            0.0045307554   0.00032558441  0              0.013266682    8.5250313e-14  0              4.1164325e-09  1.1971759e-13  0              3.375458     
   2400000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266682    2.3195464e-14  0              1.1200259e-09  1.1971759e-13  0              3.375458     
   2500000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    5.1263723e-15  0              2.4753417e-10  1.1971759e-13  0              3.375458     
   2600000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    8.9781938e-16  0              4.3352485e-11  1.1971759e-13  0              3.375458     
   2700000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    8.0191097e-17  0              3.8721411e-12  1.1971759e-13  0              3.375458     
   2800000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    4.9825428e-20  0              2.4058916e-15  1.1971759e-13  0              3.375458     
   2900000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    1.2329159e-17  0              5.9533096e-13  1.1971759e-13  0              3.375458     
   3000000   12727.922      200            200            0.0045307553   0.00032558441  0              0.013266681    1.2216301e-17  0              5.8988143e-13  1.1971759e-13  0              3.375458     
Loop time of 534.187 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4852232.149 ns/day, 0.000 hours/ns, 5616.009 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.408     | 75.843     | 130.25     | 609.4 | 14.20
Neigh   | 3.2706     | 3.3062     | 3.3424     |   1.4 |  0.62
Comm    | 15.327     | 21.423     | 25.659     |  91.8 |  4.01
Output  | 0.4038     | 0.40445    | 0.40511    |   0.1 |  0.08
Modify  | 316.08     | 328.68     | 340.95     |  65.9 | 61.53
Other   |            | 104.5      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         676.75 ave        1354 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2707
Ave neighs/atom = 0.54129174
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.77                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 61.7227622706926
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.87
  ghost atom cutoff = 3.87
  binsize = 1.935, bins = 6578 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.61 | 87.62 | 87.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.13544979    -0.022998622    0              0.42934799     907326.17      0              4.3811534e+10  1.1971759e-13  0              3.3589955    
    200000   12727.922      200            200           -0.00038946989 -9.9166025e-37  0             -0.0011684097   107883.32      0              5.2092993e+09  1.1971759e-13  0              3.4970237    
    300000   12727.922      200            200           -0.00017425254 -8.5298633e-33  0             -0.00052275761  15111.306      0              7.2967091e+08  1.1971759e-13  0              3.4151492    
    400000   12727.922      200            200            0.00014872495  1.3645124e-05  0              0.00043252974  12904.131      0              6.230943e+08   1.1971759e-13  0              3.3838069    
    500000   12727.922      200            200            0.0076385007   1.9428989e-05  0              0.022896073    1613.5411      0              77912124       1.1971759e-13  0              3.3790685    
    600000   12727.922      200            200            0.0030760281   0.00024805726  0              0.0089800269   73.936694      0              3570138.4      1.1971759e-13  0              3.3812752    
    700000   12727.922      200            200            0.0039005758   0.00025604906  0              0.011445678    0.49137556     0              23726.767      1.1971759e-13  0              3.3807871    
    800000   12727.922      200            200            0.0043126691   0.00033611458  0              0.012601893    0.083557894    0              4034.7117      1.1971759e-13  0              3.380579     
    900000   12727.922      200            200            0.0044587369   0.00033281262  0              0.013043398    0.072857428    0              3518.0245      1.1971759e-13  0              3.3805024    
   1000000   12727.922      200            200            0.00450954     0.00032557898  0              0.013203041    0.023059174    0              1113.445       1.1971759e-13  0              3.3804751    
   1100000   12727.922      200            200            0.004528305    0.00032610251  0              0.013258812    0.0053605255   0              258.84059      1.1971759e-13  0              3.3804657    
   1200000   12727.922      200            200            0.0045345349   0.00032596136  0              0.013277643    0.0010554373   0              50.96329       1.1971759e-13  0              3.3804625    
   1300000   12727.922      200            200            0.0045365571   0.00032591554  0              0.013283756    0.00018598403  0              8.9805032      1.1971759e-13  0              3.3804615    
   1400000   12727.922      200            200            0.0045371814   0.00032590147  0              0.013285643    3.0139405e-05  0              1.455324       1.1971759e-13  0              3.3804612    
   1500000   12727.922      200            200            0.0045373609   0.00032589746  0              0.013286185    4.5581281e-06  0              0.22009569     1.1971759e-13  0              3.3804611    
   1600000   12727.922      200            200            0.0045374068   0.00032589646  0              0.013286324    6.4842705e-07  0              0.031310222    1.1971759e-13  0              3.3804611    
   1700000   12727.922      200            200            0.0045374158   0.00032589627  0              0.013286351    8.7071961e-08  0              0.0042043934   1.1971759e-13  0              3.3804611    
   1800000   12727.922      200            200            0.0045374162   0.00032589627  0              0.013286352    1.1036899e-08  0              0.00053293236  1.1971759e-13  0              3.3804611    
   1900000   12727.922      200            200            0.0045374153   0.00032589629  0              0.01328635     1.3160342e-09  0              6.354658e-05   1.1971759e-13  0              3.3804611    
   2000000   12727.922      200            200            0.0045374145   0.00032589631  0              0.013286347    1.4645566e-10  0              7.0718197e-06  1.1971759e-13  0              3.3804611    
   2100000   12727.922      200            200            0.0045374141   0.00032589632  0              0.013286346    1.4996535e-11  0              7.24129e-07    1.1971759e-13  0              3.3804611    
   2200000   12727.922      200            200            0.0045374139   0.00032589632  0              0.013286345    1.3738481e-12  0              6.6338208e-08  1.1971759e-13  0              3.3804611    
   2300000   12727.922      200            200            0.0045374139   0.00032589633  0              0.013286345    1.0725646e-13  0              5.1790307e-09  1.1971759e-13  0              3.3804611    
   2400000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    6.4889241e-15  0              3.1332692e-10  1.1971759e-13  0              3.3804611    
   2500000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    1.6362574e-16  0              7.9009015e-12  1.1971759e-13  0              3.3804611    
   2600000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    1.5573836e-19  0              7.5200478e-15  1.1971759e-13  0              3.3804611    
   2700000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    1.757775e-17   0              8.4876666e-13  1.1971759e-13  0              3.3804611    
   2800000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    2.1184366e-17  0              1.0229172e-12  1.1971759e-13  0              3.3804611    
   2900000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    1.2068586e-17  0              5.8274883e-13  1.1971759e-13  0              3.3804611    
   3000000   12727.922      200            200            0.0045374138   0.00032589633  0              0.013286345    1.1604152e-17  0              5.6032296e-13  1.1971759e-13  0              3.3804611    
Loop time of 538.012 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4817740.592 ns/day, 0.000 hours/ns, 5576.089 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.283     | 75.925     | 130.13     | 608.9 | 14.11
Neigh   | 3.2276     | 3.2612     | 3.2959     |   1.3 |  0.61
Comm    | 15.602     | 22.21      | 27.125     | 105.8 |  4.13
Output  | 0.39386    | 0.39451    | 0.39516    |   0.1 |  0.07
Modify  | 318.06     | 330.55     | 343.59     |  64.2 | 61.44
Other   |            | 105.7      |            |       | 19.64

Nlocal:        1250.25 ave        1751 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         682.25 ave        1365 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2729
Ave neighs/atom = 0.54569086
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.78                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.2152288055716
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.88
  ghost atom cutoff = 3.88
  binsize = 1.94, bins = 6561 104 104
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 87.45 | 87.46 | 87.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.091313066   -0.015085581    0              0.28902478     1148482.4      0              5.5456104e+10  1.1971759e-13  0              3.368723     
    200000   12727.922      200            200           -0.00038485456  1.2693281e-35  0             -0.0011545637   103072.78      0              4.9770157e+09  1.1971759e-13  0              3.5041096    
    300000   12727.922      200            200           -0.00016449994 -6.3466186e-36  0             -0.00049349983  13219.996      0              6.3834629e+08  1.1971759e-13  0              3.4210516    
    400000   12727.922      200            200           -0.00013615524 -7.1241892e-06  0             -0.00040134153  11065.69       0              5.3432257e+08  1.1971759e-13  0              3.3897203    
    500000   12727.922      200            200            0.0084439691  -0.00026870262  0              0.02560061     1050.2115      0              50710953       1.1971759e-13  0              3.3837291    
    600000   12727.922      200            200            0.0032612438   0.00021318536  0              0.0095705461   143.94078      0              6950385.1      1.1971759e-13  0              3.3861632    
    700000   12727.922      200            200            0.0039468243   0.00025865243  0              0.01158182     6.0477987      0              292026.55      1.1971759e-13  0              3.3857696    
    800000   12727.922      200            200            0.0043236463   0.0003397218   0              0.012631217    0.22969261     0              11091.034      1.1971759e-13  0              3.3855807    
    900000   12727.922      200            200            0.0044631182   0.00033667781  0              0.013052677    0.0021368349   0              103.18011      1.1971759e-13  0              3.3855074    
   1000000   12727.922      200            200            0.0045139366   0.00032871321  0              0.013213096    0.00073883054  0              35.675483      1.1971759e-13  0              3.3854799    
   1100000   12727.922      200            200            0.0045340203   0.00032950271  0              0.013272558    0.00066384101  0              32.054507      1.1971759e-13  0              3.3854697    
   1200000   12727.922      200            200            0.0045411768   0.00032934641  0              0.013294184    0.00022685911  0              10.954215      1.1971759e-13  0              3.3854661    
   1300000   12727.922      200            200            0.004543733    0.0003292904   0              0.013301909    5.6005931e-05  0              2.704326       1.1971759e-13  0              3.3854648    
   1400000   12727.922      200            200            0.0045446294   0.00032927079  0              0.013304617    1.1663902e-05  0              0.56320809     1.1971759e-13  0              3.3854643    
   1500000   12727.922      200            200            0.0045449374   0.00032926406  0              0.013305548    2.180627e-06   0              0.10529467     1.1971759e-13  0              3.3854642    
   1600000   12727.922      200            200            0.0045450409   0.00032926181  0              0.013305861    3.7750715e-07  0              0.018228469    1.1971759e-13  0              3.3854641    
   1700000   12727.922      200            200            0.0045450747   0.00032926108  0              0.013305963    6.1587323e-08  0              0.0029738314   1.1971759e-13  0              3.3854641    
   1800000   12727.922      200            200            0.0045450854   0.00032926085  0              0.013305995    9.5696862e-09  0              0.0004620859   1.1971759e-13  0              3.3854641    
   1900000   12727.922      200            200            0.0045450886   0.00032926078  0              0.013306005    1.4258313e-09  0              6.8848293e-05  1.1971759e-13  0              3.3854641    
   2000000   12727.922      200            200            0.0045450895   0.00032926076  0              0.013306008    2.0454503e-10  0              9.8767474e-06  1.1971759e-13  0              3.3854641    
   2100000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    2.8320977e-11  0              1.3675186e-06  1.1971759e-13  0              3.3854641    
   2200000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    3.7896407e-12  0              1.8298819e-07  1.1971759e-13  0              3.3854641    
   2300000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    4.9009333e-13  0              2.3664853e-08  1.1971759e-13  0              3.3854641    
   2400000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    6.1271523e-14  0              2.9585826e-09  1.1971759e-13  0              3.3854641    
   2500000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    7.4089337e-15  0              3.5775089e-10  1.1971759e-13  0              3.3854641    
   2600000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    9.0963463e-16  0              4.3923001e-11  1.1971759e-13  0              3.3854641    
   2700000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    1.606889e-16   0              7.7590919e-12  1.1971759e-13  0              3.3854641    
   2800000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    9.7695316e-18  0              4.7173572e-13  1.1971759e-13  0              3.3854641    
   2900000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    4.0411679e-18  0              1.9513353e-13  1.1971759e-13  0              3.3854641    
   3000000   12727.922      200            200            0.0045450898   0.00032926076  0              0.013306009    9.5211141e-18  0              4.5974052e-13  1.1971759e-13  0              3.3854641    
Loop time of 538 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4817840.411 ns/day, 0.000 hours/ns, 5576.204 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.141     | 76.305     | 131.21     | 614.1 | 14.18
Neigh   | 3.2672     | 3.3015     | 3.3373     |   1.4 |  0.61
Comm    | 15.241     | 21.379     | 25.567     |  92.6 |  3.97
Output  | 0.394      | 0.39464    | 0.39529    |   0.1 |  0.07
Modify  | 318.33     | 331.35     | 344.15     |  66.9 | 61.59
Other   |            | 105.3      |            |       | 19.57

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         687.25 ave        1375 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2749
Ave neighs/atom = 0.54969006
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.79                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 62.7103078889014
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.89
  ghost atom cutoff = 3.89
  binsize = 1.945, bins = 6544 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.86 | 85.87 | 85.89 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.053817734   -0.0052778986   0              0.1667311      1308467.9      0              6.3181231e+10  1.1971759e-13  0              3.3788945    
    200000   12727.922      200            200           -0.00038004585  6.3123794e-40  0             -0.0011401376   98376.267      0              4.7502378e+09  1.1971759e-13  0              3.5111491    
    300000   12727.922      200            200           -0.00015454768 -5.0772939e-35  0             -0.00046364305  11457.079      0              5.5322134e+08  1.1971759e-13  0              3.4268947    
    400000   12727.922      200            200           -0.00013936052  2.7058783e-40  0             -0.00041808156  9324.7303      0              4.5025786e+08  1.1971759e-13  0              3.3955638    
    500000   12727.922      200            200            0.009113013   -0.00043020023  0              0.027769239    525.16249      0              25358217       1.1971759e-13  0              3.3884707    
    600000   12727.922      200            200            0.0035243671   0.00021436326  0              0.010358738    220.01464      0              10623720       1.1971759e-13  0              3.391016     
    700000   12727.922      200            200            0.0040349109   0.00026534075  0              0.011839392    16.343417      0              789165.12      1.1971759e-13  0              3.3907303    
    800000   12727.922      200            200            0.0043556312   0.00034224374  0              0.01272465     1.4406784      0              69565.203      1.1971759e-13  0              3.3905712    
    900000   12727.922      200            200            0.0044774205   0.0003394573   0              0.013092804    0.12657654     0              6111.9281      1.1971759e-13  0              3.3905071    
   1000000   12727.922      200            200            0.0045229647   0.00033179311  0              0.013237101    0.0102207      0              493.52103      1.1971759e-13  0              3.3904822    
   1100000   12727.922      200            200            0.0045416315   0.00033254107  0              0.013292353    0.00068296984  0              32.978169      1.1971759e-13  0              3.3904728    
   1200000   12727.922      200            200            0.0045485485   0.0003323896   0              0.013313256    3.023115e-05   0              1.4597541      1.1971759e-13  0              3.3904692    
   1300000   12727.922      200            200            0.0045511397   0.00033233271  0              0.013321086    2.5314697e-07  0              0.012223561    1.1971759e-13  0              3.3904679    
   1400000   12727.922      200            200            0.0045521015   0.0003323116   0              0.013323993    1.3768867e-07  0              0.0066484929   1.1971759e-13  0              3.3904674    
   1500000   12727.922      200            200            0.0045524555   0.00033230384  0              0.013325063    1.1444646e-07  0              0.00552621     1.1971759e-13  0              3.3904672    
   1600000   12727.922      200            200            0.0045525846   0.00033230102  0              0.013325453    3.8820801e-08  0              0.0018745175   1.1971759e-13  0              3.3904671    
   1700000   12727.922      200            200            0.0045526313   0.0003323      0              0.013325594    9.6725469e-09  0              0.00046705267  1.1971759e-13  0              3.3904671    
   1800000   12727.922      200            200            0.004552648    0.00033229963  0              0.013325644    2.0530079e-09  0              9.9132406e-05  1.1971759e-13  0              3.3904671    
   1900000   12727.922      200            200            0.004552654    0.0003322995   0              0.013325662    3.9434125e-10  0              1.9041328e-05  1.1971759e-13  0              3.3904671    
   2000000   12727.922      200            200            0.0045526561   0.00033229946  0              0.013325669    7.0674847e-11  0              3.4126354e-06  1.1971759e-13  0              3.3904671    
   2100000   12727.922      200            200            0.0045526568   0.00033229944  0              0.013325671    1.2034711e-11  0              5.8111313e-07  1.1971759e-13  0              3.3904671    
   2200000   12727.922      200            200            0.0045526571   0.00033229944  0              0.013325672    1.9666968e-12  0              9.496475e-08   1.1971759e-13  0              3.3904671    
   2300000   12727.922      200            200            0.0045526571   0.00033229944  0              0.013325672    3.111892e-13   0              1.5026213e-08  1.1971759e-13  0              3.3904671    
   2400000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    4.8700652e-14  0              2.3515802e-09  1.1971759e-13  0              3.3904671    
   2500000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    7.3092858e-15  0              3.5293925e-10  1.1971759e-13  0              3.3904671    
   2600000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    1.0450657e-15  0              5.0462484e-11  1.1971759e-13  0              3.3904671    
   2700000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    8.0414539e-17  0              3.8829303e-12  1.1971759e-13  0              3.3904671    
   2800000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    4.5780599e-19  0              2.2105813e-14  1.1971759e-13  0              3.3904671    
   2900000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    1.1339443e-17  0              5.4754111e-13  1.1971759e-13  0              3.3904671    
   3000000   12727.922      200            200            0.0045526572   0.00033229943  0              0.013325672    1.3620076e-17  0              6.5766475e-13  1.1971759e-13  0              3.3904671    
Loop time of 536.597 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4830444.840 ns/day, 0.000 hours/ns, 5590.793 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.108     | 76.269     | 131.34     | 615.8 | 14.21
Neigh   | 3.182      | 3.2158     | 3.2499     |   1.4 |  0.60
Comm    | 15.429     | 21.251     | 25.358     |  90.1 |  3.96
Output  | 0.4094     | 0.41       | 0.41064    |   0.1 |  0.08
Modify  | 318.52     | 331.01     | 342.47     |  62.5 | 61.69
Other   |            | 104.4      |            |       | 19.46

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         692.25 ave        1385 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2769
Ave neighs/atom = 0.55368926
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.8                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.2080064321856
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.9
  ghost atom cutoff = 3.9
  binsize = 1.95, bins = 6528 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.68 | 85.7 | 85.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.024479836   -0.00052094595  0              0.073960453    1387495.2      0              6.6997179e+10  1.1971759e-13  0              3.3893117    
    200000   12727.922      200            200           -0.00037504468 -6.3466228e-35  0             -0.0011251341   93793.465      0              4.5289507e+09  1.1971759e-13  0              3.5181421    
    300000   12727.922      200            200           -0.00014439708  5.0773203e-35  0             -0.00043319123  9822.1145      0              4.7427476e+08  1.1971759e-13  0              3.4326783    
    400000   12727.922      200            200           -0.00012815632 -2.5386357e-35  0             -0.00038446895  7734.3545      0              3.734643e+08   1.1971759e-13  0              3.4013365    
    500000   12727.922      200            200            0.0095421007  -0.00056795571  0              0.029194258    147.69495      0              7131660.7      1.1971759e-13  0              3.3933078    
    600000   12727.922      200            200            0.003823387    0.0001426596   0              0.011327502    287.16767      0              13866299       1.1971759e-13  0              3.3958409    
    700000   12727.922      200            200            0.0041647201   0.00028877446  0              0.012205386    28.502802      0              1376298.3      1.1971759e-13  0              3.395672     
    800000   12727.922      200            200            0.0044048886   0.0003389012   0              0.012875765    3.2597061      0              157399.54      1.1971759e-13  0              3.3955518    
    900000   12727.922      200            200            0.0045005556   0.0003403194   0              0.013161347    0.38580433     0              18629.11       1.1971759e-13  0              3.3955018    
   1000000   12727.922      200            200            0.0045359694   0.00033352898  0              0.013274379    0.04570456     0              2206.9097      1.1971759e-13  0              3.3954823    
   1100000   12727.922      200            200            0.0045508135   0.0003342887   0              0.013318152    0.0053462347   0              258.15054      1.1971759e-13  0              3.3954747    
   1200000   12727.922      200            200            0.0045563814   0.00033417144  0              0.013334973    0.00061488307  0              29.690503      1.1971759e-13  0              3.3954719    
   1300000   12727.922      200            200            0.0045585098   0.00033412656  0              0.013341403    6.9336346e-05  0              3.348004       1.1971759e-13  0              3.3954708    
   1400000   12727.922      200            200            0.0045593196   0.00033410949  0              0.013343849    7.6377463e-06  0              0.36879943     1.1971759e-13  0              3.3954703    
   1500000   12727.922      200            200            0.0045596263   0.00033410303  0              0.013344776    8.1770318e-07  0              0.03948396     1.1971759e-13  0              3.3954702    
   1600000   12727.922      200            200            0.0045597421   0.00033410059  0              0.013345126    8.4468124e-08  0              0.0040786634   1.1971759e-13  0              3.3954701    
   1700000   12727.922      200            200            0.0045597856   0.00033409968  0              0.013345257    8.3282631e-09  0              0.00040214202  1.1971759e-13  0              3.3954701    
   1800000   12727.922      200            200            0.0045598019   0.00033409934  0              0.013345306    7.7049625e-10  0              3.7204507e-05  1.1971759e-13  0              3.3954701    
   1900000   12727.922      200            200            0.004559808    0.00033409921  0              0.013345325    6.4946618e-11  0              3.1360398e-06  1.1971759e-13  0              3.3954701    
   2000000   12727.922      200            200            0.0045598102   0.00033409916  0              0.013345332    4.7110508e-12  0              2.2747978e-07  1.1971759e-13  0              3.3954701    
   2100000   12727.922      200            200            0.0045598111   0.00033409914  0              0.013345334    2.5569982e-13  0              1.2346829e-08  1.1971759e-13  0              3.3954701    
   2200000   12727.922      200            200            0.0045598114   0.00033409914  0              0.013345335    6.2984776e-15  0              3.0413094e-10  1.1971759e-13  0              3.3954701    
   2300000   12727.922      200            200            0.0045598115   0.00033409914  0              0.013345335    1.0273912e-16  0              4.9609046e-12  1.1971759e-13  0              3.3954701    
   2400000   12727.922      200            200            0.0045598115   0.00033409914  0              0.013345335    2.5792252e-16  0              1.2454156e-11  1.1971759e-13  0              3.3954701    
   2500000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    1.431508e-16   0              6.9122397e-12  1.1971759e-13  0              3.3954701    
   2600000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    2.8473101e-17  0              1.3748642e-12  1.1971759e-13  0              3.3954701    
   2700000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    1.1338094e-17  0              5.4747599e-13  1.1971759e-13  0              3.3954701    
   2800000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    2.2156831e-17  0              1.0698741e-12  1.1971759e-13  0              3.3954701    
   2900000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    8.8548683e-19  0              4.275699e-14   1.1971759e-13  0              3.3954701    
   3000000   12727.922      200            200            0.0045598116   0.00033409913  0              0.013345336    1.7576113e-18  0              8.486876e-14   1.1971759e-13  0              3.3954701    
Loop time of 537.91 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4818646.438 ns/day, 0.000 hours/ns, 5577.137 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.288     | 77.161     | 133.09     | 618.8 | 14.34
Neigh   | 3.2357     | 3.2704     | 3.3063     |   1.4 |  0.61
Comm    | 15.668     | 21.756     | 25.549     |  87.6 |  4.04
Output  | 0.3896     | 0.39029    | 0.39094    |   0.1 |  0.07
Modify  | 319.05     | 330.58     | 342.17     |  60.5 | 61.46
Other   |            | 104.7      |            |       | 19.47

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         697.75 ave        1396 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2791
Ave neighs/atom = 0.55808838
Neighbor list builds = 150
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.81                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 63.7083313469284
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.91
  ghost atom cutoff = 3.91
  binsize = 1.955, bins = 6511 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.51 | 85.52 | 85.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200            0.0062059245   0.0012343718   0              0.017383402    1405692.6      0              6.7875865e+10  1.1971759e-13  0              3.3998241    
    200000   12727.922      200            200           -0.00036985201 -5.0772735e-35  0             -0.001109556    89324.082      0              4.3131402e+09  1.1971759e-13  0              3.5250885    
    300000   12727.922      200            200           -0.00013404943  2.5386589e-35  0             -0.00040214828  8314.658       0              4.0148508e+08  1.1971759e-13  0              3.4384023    
    400000   12727.922      200            200           -0.00011672641 -2.5386449e-35  0             -0.00035017924  6294.5955      0              3.0394349e+08  1.1971759e-13  0              3.4070383    
    500000   12727.922      200            200            0.0097027484  -0.00061902581  0              0.029727271    0.49058779     0              23688.729      1.1971759e-13  0              3.39825      
    600000   12727.922      200            200            0.0041899015   0.00012373726  0              0.012445967    331.16624      0              15990832       1.1971759e-13  0              3.4006466    
    700000   12727.922      200            200            0.0043242731   0.00031367031  0              0.012659149    39.081563      0              1887108.8      1.1971759e-13  0              3.4005992    
    800000   12727.922      200            200            0.0044677765   0.00033041704  0              0.013072912    5.0028514      0              241569.79      1.1971759e-13  0              3.4005245    
    900000   12727.922      200            200            0.0045314254   0.00034179368  0              0.013252482    0.65626623     0              31688.748      1.1971759e-13  0              3.4004928    
   1000000   12727.922      200            200            0.0045520528   0.00033386641  0              0.013322292    0.086518199    0              4177.6542      1.1971759e-13  0              3.4004805    
   1100000   12727.922      200            200            0.0045611595   0.00033464474  0              0.013348834    0.011405685    0              550.73973      1.1971759e-13  0              3.4004759    
   1200000   12727.922      200            200            0.0045644866   0.00033457289  0              0.013358887    0.0015021624   0              72.534044      1.1971759e-13  0              3.4004741    
   1300000   12727.922      200            200            0.0045657455   0.00033454571  0              0.013362691    0.00019765758  0              9.544177       1.1971759e-13  0              3.4004735    
   1400000   12727.922      200            200            0.0045662212   0.00033453545  0              0.013364128    2.5985732e-05  0              1.254758       1.1971759e-13  0              3.4004732    
   1500000   12727.922      200            200            0.0045664008   0.00033453158  0              0.013364671    3.4134033e-06  0              0.16482103     1.1971759e-13  0              3.4004731    
   1600000   12727.922      200            200            0.0045664685   0.00033453012  0              0.013364875    4.4799112e-07  0              0.021631888    1.1971759e-13  0              3.4004731    
   1700000   12727.922      200            200            0.004566494    0.00033452957  0              0.013364953    5.8744999e-08  0              0.0028365858   1.1971759e-13  0              3.4004731    
   1800000   12727.922      200            200            0.0045665036   0.00033452936  0              0.013364982    7.6963623e-09  0              0.00037162979  1.1971759e-13  0              3.4004731    
   1900000   12727.922      200            200            0.0045665072   0.00033452929  0              0.013364992    1.0074251e-09  0              4.8644952e-05  1.1971759e-13  0              3.4004731    
   2000000   12727.922      200            200            0.0045665086   0.00033452926  0              0.013364997    1.3174965e-10  0              6.361719e-06   1.1971759e-13  0              3.4004731    
   2100000   12727.922      200            200            0.0045665091   0.00033452925  0              0.013364998    1.7214502e-11  0              8.3122667e-07  1.1971759e-13  0              3.4004731    
   2200000   12727.922      200            200            0.0045665093   0.00033452924  0              0.013364999    2.2459516e-12  0              1.0844897e-07  1.1971759e-13  0              3.4004731    
   2300000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    2.9313134e-13  0              1.4154263e-08  1.1971759e-13  0              3.4004731    
   2400000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    3.8550652e-14  0              1.861473e-09   1.1971759e-13  0              3.4004731    
   2500000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    4.9339995e-15  0              2.3824518e-10  1.1971759e-13  0              3.4004731    
   2600000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    7.1239068e-16  0              3.4398796e-11  1.1971759e-13  0              3.4004731    
   2700000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    1.5650012e-16  0              7.5568308e-12  1.1971759e-13  0              3.4004731    
   2800000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    6.2763669e-18  0              3.030633e-13   1.1971759e-13  0              3.4004731    
   2900000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    8.7456593e-20  0              4.2229659e-15  1.1971759e-13  0              3.4004731    
   3000000   12727.922      200            200            0.0045665094   0.00033452924  0              0.013364999    9.4377502e-19  0              4.5571518e-14  1.1971759e-13  0              3.4004731    
Loop time of 538.099 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4816954.082 ns/day, 0.000 hours/ns, 5575.178 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.148     | 77.167     | 132.68     | 620.0 | 14.34
Neigh   | 3.2569     | 3.2924     | 3.3284     |   1.4 |  0.61
Comm    | 15.703     | 21.816     | 26.205     |  89.9 |  4.05
Output  | 0.40749    | 0.40815    | 0.40883    |   0.1 |  0.08
Modify  | 318.15     | 330.18     | 342.24     |  61.7 | 61.36
Other   |            | 105.2      |            |       | 19.56

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         702.25 ave        1405 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2809
Ave neighs/atom = 0.56168766
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.82                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.2112895446332
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.92
  ghost atom cutoff = 3.92
  binsize = 1.96, bins = 6494 103 103
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 85.31 | 85.32 | 85.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -3.5379693e-05  3.9385359e-40  0             -0.00010613908  1393237.3      0              6.7274442e+10  1.1971759e-13  0              3.41034      
    200000   12727.922      200            200           -0.00036446872  1.0154646e-34  0             -0.0010934062   84967.787      0              4.1027903e+09  1.1971759e-13  0              3.5319883    
    300000   12727.922      200            200           -0.00012350598  2.0309217e-34  0             -0.00037051795  6934.2591      0              3.3483055e+08  1.1971759e-13  0              3.4440666    
    400000   12727.922      200            200           -0.00010507255  5.0773458e-35  0             -0.00031521765  5004.7867      0              2.4166324e+08  1.1971759e-13  0              3.4126692    
    500000   12727.922      200            200            0.0095645407  -0.00061390734  0              0.029307529    116.25067      0              5613328.7      1.1971759e-13  0              3.403301     
    600000   12727.922      200            200            0.0045858435   8.9740487e-05  0              0.01366779     341.60297      0              16494785       1.1971759e-13  0              3.4054435    
    700000   12727.922      200            200            0.0045023302   0.00033365165  0              0.013173339    45.007379      0              2173245.3      1.1971759e-13  0              3.4055173    
    800000   12727.922      200            200            0.0045390505   0.0003172767   0              0.013299875    6.0105582      0              290228.34      1.1971759e-13  0              3.4054923    
    900000   12727.922      200            200            0.0045667933   0.00034275124  0              0.013357629    0.80953245     0              39089.425      1.1971759e-13  0              3.4054813    
   1000000   12727.922      200            200            0.0045703911   0.00033454792  0              0.013376625    0.10910824     0              5268.4463      1.1971759e-13  0              3.4054777    
   1100000   12727.922      200            200            0.0045725894   0.000335354    0              0.013382414    0.014697651    0              709.69699      1.1971759e-13  0              3.4054765    
   1200000   12727.922      200            200            0.0045731438   0.00033534018  0              0.013384091    0.0019781903   0              95.519729      1.1971759e-13  0              3.4054762    
   1300000   12727.922      200            200            0.0045732937   0.00033533618  0              0.013384545    0.00026602987  0              12.84563       1.1971759e-13  0              3.4054761    
   1400000   12727.922      200            200            0.0045733294   0.0003353351   0              0.013384653    3.5747348e-05  0              1.7261115      1.1971759e-13  0              3.4054761    
   1500000   12727.922      200            200            0.0045733354   0.00033533485  0              0.013384671    4.7996689e-06  0              0.23175883     1.1971759e-13  0              3.4054761    
   1600000   12727.922      200            200            0.004573335    0.00033533481  0              0.01338467     6.4392215e-07  0              0.031092696    1.1971759e-13  0              3.4054761    
   1700000   12727.922      200            200            0.0045733339   0.00033533481  0              0.013384667    8.6319621e-08  0              0.0041680656   1.1971759e-13  0              3.4054761    
   1800000   12727.922      200            200            0.0045733332   0.00033533482  0              0.013384665    1.1562251e-08  0              0.00055829975  1.1971759e-13  0              3.4054761    
   1900000   12727.922      200            200            0.0045733328   0.00033533483  0              0.013384663    1.5474616e-09  0              7.4721382e-05  1.1971759e-13  0              3.4054761    
   2000000   12727.922      200            200            0.0045733326   0.00033533483  0              0.013384663    2.0693847e-10  0              9.9923183e-06  1.1971759e-13  0              3.4054761    
   2100000   12727.922      200            200            0.0045733325   0.00033533483  0              0.013384663    2.7654257e-11  0              1.3353251e-06  1.1971759e-13  0              3.4054761    
   2200000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    3.6923066e-12  0              1.7828827e-07  1.1971759e-13  0              3.4054761    
   2300000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    4.9278941e-13  0              2.3795037e-08  1.1971759e-13  0              3.4054761    
   2400000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    6.5601925e-14  0              3.1676822e-09  1.1971759e-13  0              3.4054761    
   2500000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    8.7148001e-15  0              4.2080651e-10  1.1971759e-13  0              3.4054761    
   2600000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    1.1642457e-15  0              5.6217257e-11  1.1971759e-13  0              3.4054761    
   2700000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    7.7895049e-17  0              3.7612731e-12  1.1971759e-13  0              3.4054761    
   2800000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    1.3278771e-18  0              6.4118431e-14  1.1971759e-13  0              3.4054761    
   2900000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    4.5095138e-18  0              2.1774828e-13  1.1971759e-13  0              3.4054761    
   3000000   12727.922      200            200            0.0045733324   0.00033533483  0              0.013384662    1.5821073e-18  0              7.6394298e-14  1.1971759e-13  0              3.4054761    
Loop time of 540.374 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4796678.413 ns/day, 0.000 hours/ns, 5551.711 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.167     | 77.331     | 132.42     | 619.1 | 14.31
Neigh   | 3.2918     | 3.3268     | 3.3627     |   1.4 |  0.62
Comm    | 15.661     | 21.99      | 26.701     |  90.5 |  4.07
Output  | 0.39139    | 0.39203    | 0.39268    |   0.1 |  0.07
Modify  | 320.19     | 332.05     | 344.31     |  61.4 | 61.45
Other   |            | 105.3      |            |       | 19.48

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         706.75 ave        1414 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2827
Ave neighs/atom = 0.56528694
Neighbor list builds = 154
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.83                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 64.7168879368044
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.93
  ghost atom cutoff = 3.93
  binsize = 1.965, bins = 6478 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.8 | 83.81 | 83.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -5.1849409e-05 -1.2693236e-35  0             -0.00015554823  1376386.8      0              6.6460792e+10  1.1971759e-13  0              3.4208279    
    200000   12727.922      200            200           -0.00035889575  1.0154632e-34  0             -0.0010766873   80724.286      0              3.8978869e+09  1.1971759e-13  0              3.5388413    
    300000   12727.922      200            200           -0.00011276805 -1.0154583e-34  0             -0.00033830415  5680.4776      0              2.7428993e+08  1.1971759e-13  0              3.4496712    
    400000   12727.922      200            200           -9.3196503e-05 -1.015457e-34   0             -0.00027958951  3864.27        0              1.8659177e+08  1.1971759e-13  0              3.418229     
    500000   12727.922      200            200            0.0091321448  -0.00057747786  0              0.027973912    467.71409      0              22584239       1.1971759e-13  0              3.4084583    
    600000   12727.922      200            200            0.0049960515   5.742683e-05   0              0.014930728    314.64978      0              15193312       1.1971759e-13  0              3.4102427    
    700000   12727.922      200            200            0.0046807      0.00032836842  0              0.013713732    44.46605       0              2147106.4      1.1971759e-13  0              3.4104326    
    800000   12727.922      200            200            0.0046157545   0.00031034247  0              0.013536921    5.8964579      0              284718.85      1.1971759e-13  0              3.4104587    
    900000   12727.922      200            200            0.0046022541   0.00034035044  0              0.013466412    0.772882       0              37319.706      1.1971759e-13  0              3.4104693    
   1000000   12727.922      200            200            0.0045890986   0.00033508895  0              0.013432207    0.10054954     0              4855.1775      1.1971759e-13  0              3.4104746    
   1100000   12727.922      200            200            0.0045841171   0.00033595234  0              0.013416399    0.012988654    0              627.17564      1.1971759e-13  0              3.4104771    
   1200000   12727.922      200            200            0.0045818031   0.00033599676  0              0.013409413    0.0016657065   0              80.431007      1.1971759e-13  0              3.4104782    
   1300000   12727.922      200            200            0.004580814    0.00033601592  0              0.013406426    0.00021199116  0              10.236295      1.1971759e-13  0              3.4104787    
   1400000   12727.922      200            200            0.0045804011   0.00033602398  0              0.013405179    2.6762173e-05  0              1.2922496      1.1971759e-13  0              3.4104789    
   1500000   12727.922      200            200            0.0045802319   0.0003360273   0              0.013404668    3.3494666e-06  0              0.16173376     1.1971759e-13  0              3.410479     
   1600000   12727.922      200            200            0.0045801635   0.00033602864  0              0.013404462    4.1533989e-07  0              0.020055277    1.1971759e-13  0              3.410479     
   1700000   12727.922      200            200            0.0045801361   0.00033602918  0              0.013404379    5.0988135e-08  0              0.0024620346   1.1971759e-13  0              3.410479     
   1800000   12727.922      200            200            0.0045801253   0.0003360294   0              0.013404347    6.1910315e-09  0              0.00029894276  1.1971759e-13  0              3.410479     
   1900000   12727.922      200            200            0.0045801211   0.00033602948  0              0.013404334    7.4260342e-10  0              3.5857661e-05  1.1971759e-13  0              3.410479     
   2000000   12727.922      200            200            0.0045801195   0.00033602951  0              0.013404329    8.7868475e-11  0              4.2428542e-06  1.1971759e-13  0              3.410479     
   2100000   12727.922      200            200            0.0045801188   0.00033602953  0              0.013404327    1.0236597e-11  0              4.9428866e-07  1.1971759e-13  0              3.410479     
   2200000   12727.922      200            200            0.0045801186   0.00033602953  0              0.013404326    1.1705589e-12  0              5.6522099e-08  1.1971759e-13  0              3.410479     
   2300000   12727.922      200            200            0.0045801185   0.00033602953  0              0.013404326    1.3148584e-13  0              6.3489808e-09  1.1971759e-13  0              3.410479     
   2400000   12727.922      200            200            0.0045801184   0.00033602953  0              0.013404326    1.4943059e-14  0              7.2154685e-10  1.1971759e-13  0              3.410479     
   2500000   12727.922      200            200            0.0045801184   0.00033602953  0              0.013404326    1.5690106e-15  0              7.5761906e-11  1.1971759e-13  0              3.410479     
   2600000   12727.922      200            200            0.0045801184   0.00033602953  0              0.013404326    1.4574934e-16  0              7.0377139e-12  1.1971759e-13  0              3.410479     
   2700000   12727.922      200            200            0.0045801184   0.00033602953  0              0.013404326    4.6456265e-18  0              2.2432068e-13  1.1971759e-13  0              3.410479     
   2800000   12727.922      200            200            0.0045801184   0.00033602953  0              0.013404326    2.22204e-17    0              1.0729436e-12  1.1971759e-13  0              3.410479     
   2900000   12727.922      200            200            0.0045801184   0.00033602954  0              0.013404326    3.9741414e-18  0              1.9189706e-13  1.1971759e-13  0              3.410479     
   3000000   12727.922      200            200            0.0045801184   0.00033602954  0              0.013404326    9.9515671e-18  0              4.8052556e-13  1.1971759e-13  0              3.410479     
Loop time of 533.79 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4855840.069 ns/day, 0.000 hours/ns, 5620.185 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.659     | 75.82      | 130.18     | 605.5 | 14.20
Neigh   | 3.2076     | 3.2449     | 3.2823     |   1.5 |  0.61
Comm    | 15.51      | 21.576     | 25.529     |  90.1 |  4.04
Output  | 0.43216    | 0.43284    | 0.43351    |   0.1 |  0.08
Modify  | 314.9      | 328.12     | 341        |  67.9 | 61.47
Other   |            | 104.6      |            |       | 19.60

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         661.75 ave        1324 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2647
Ave neighs/atom = 0.52929414
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.84                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.2251334349452
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.94
  ghost atom cutoff = 3.94
  binsize = 1.97, bins = 6461 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.64 | 83.65 | 83.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -6.8092718e-05 -5.0772911e-35  0             -0.00020427815  1359649.2      0              6.5652593e+10  1.1971759e-13  0              3.4312856    
    200000   12727.922      200            200           -0.00035313406 -2.5386406e-35  0             -0.0010594022   76593.29       0              3.6984158e+09  1.1971759e-13  0              3.5456474    
    300000   12727.922      200            200           -0.00010183699  2.5386615e-35  0             -0.00030551098  4552.879       0              2.1984223e+08  1.1971759e-13  0              3.4552158    
    400000   12727.922      200            200           -8.1100133e-05 -5.0772877e-35  0             -0.0002433004   2872.3959      0              1.3869772e+08  1.1971759e-13  0              3.4237176    
    500000   12727.922      200            200            0.0083995018  -0.00066071436  0              0.02585922     975.18976      0              47088423       1.1971759e-13  0              3.413713     
    600000   12727.922      200            200            0.0054383162   0.00015679133  0              0.016158157    254.82294      0              12304488       1.1971759e-13  0              3.4150558    
    700000   12727.922      200            200            0.0048486298   0.00030483928  0              0.01424105     37.506378      0              1811048.7      1.1971759e-13  0              3.4153516    
    800000   12727.922      200            200            0.0046915418   0.00031185078  0              0.013762775    4.6984549      0              226871.57      1.1971759e-13  0              3.4154272    
    900000   12727.922      200            200            0.0046350294   0.00033719778  0              0.01356789     0.56375476     0              27221.7        1.1971759e-13  0              3.4154585    
   1000000   12727.922      200            200            0.0046063004   0.000335232    0              0.013483669    0.065860812    0              3180.1829      1.1971759e-13  0              3.4154722    
   1100000   12727.922      200            200            0.0045947853   0.00033612531  0              0.013448231    0.0074683346   0              360.61915      1.1971759e-13  0              3.415478     
   1200000   12727.922      200            200            0.0045899606   0.00033621932  0              0.013433662    0.00081810641  0              39.503431      1.1971759e-13  0              3.4154804    
   1300000   12727.922      200            200            0.0045880165   0.00033625733  0              0.013427792    8.5884257e-05  0              4.1470434      1.1971759e-13  0              3.4154814    
   1400000   12727.922      200            200            0.0045872458   0.00033627244  0              0.013425465    8.5360498e-06  0              0.41217529     1.1971759e-13  0              3.4154817    
   1500000   12727.922      200            200            0.0045869446   0.00033627836  0              0.013424555    7.8762997e-07  0              0.038031832    1.1971759e-13  0              3.4154819    
   1600000   12727.922      200            200            0.0045868282   0.00033628066  0              0.013424204    6.516378e-08   0              0.0031465257   1.1971759e-13  0              3.4154819    
   1700000   12727.922      200            200            0.0045867838   0.00033628153  0              0.01342407     4.5023352e-09  0              0.00021740165  1.1971759e-13  0              3.415482     
   1800000   12727.922      200            200            0.004586767    0.00033628186  0              0.013424019    2.1564512e-10  0              1.0412731e-05  1.1971759e-13  0              3.415482     
   1900000   12727.922      200            200            0.0045867607   0.00033628199  0              0.013424       2.9108915e-12  0              1.4055653e-07  1.1971759e-13  0              3.415482     
   2000000   12727.922      200            200            0.0045867584   0.00033628204  0              0.013423993    5.2864097e-13  0              2.552618e-08   1.1971759e-13  0              3.415482     
   2100000   12727.922      200            200            0.0045867575   0.00033628205  0              0.013423991    5.7688685e-13  0              2.7855801e-08  1.1971759e-13  0              3.415482     
   2200000   12727.922      200            200            0.0045867572   0.00033628206  0              0.01342399     2.0916939e-13  0              1.0100041e-08  1.1971759e-13  0              3.415482     
   2300000   12727.922      200            200            0.0045867571   0.00033628206  0              0.013423989    5.3833451e-14  0              2.5994247e-09  1.1971759e-13  0              3.415482     
   2400000   12727.922      200            200            0.0045867571   0.00033628206  0              0.013423989    1.1838495e-14  0              5.7163857e-10  1.1971759e-13  0              3.415482     
   2500000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    2.2104869e-15  0              1.067365e-10   1.1971759e-13  0              3.415482     
   2600000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    4.4484434e-16  0              2.1479941e-11  1.1971759e-13  0              3.415482     
   2700000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    1.4467076e-16  0              6.9856333e-12  1.1971759e-13  0              3.415482     
   2800000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    5.8769656e-18  0              2.8377764e-13  1.1971759e-13  0              3.415482     
   2900000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    4.6676836e-18  0              2.2538574e-13  1.1971759e-13  0              3.415482     
   3000000   12727.922      200            200            0.004586757    0.00033628206  0              0.013423989    1.1589399e-17  0              5.596106e-13   1.1971759e-13  0              3.415482     
Loop time of 533.989 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4854030.194 ns/day, 0.000 hours/ns, 5618.091 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.146     | 75.843     | 130.5      | 610.2 | 14.20
Neigh   | 3.0338     | 3.0665     | 3.0999     |   1.4 |  0.57
Comm    | 15.288     | 21.234     | 25.114     |  89.5 |  3.98
Output  | 0.39114    | 0.39175    | 0.39237    |   0.1 |  0.07
Modify  | 316.56     | 329.02     | 340.75     |  64.7 | 61.62
Other   |            | 104.4      |            |       | 19.56

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         666.75 ave        1334 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2667
Ave neighs/atom = 0.53329334
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.85                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 65.7360329505601
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.95
  ghost atom cutoff = 3.95
  binsize = 1.975, bins = 6445 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.47 | 83.48 | 83.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -8.4110283e-05 -4.0618289e-34  0             -0.00025233085  1343024.1      0              6.4849829e+10  1.1971759e-13  0              3.4417131    
    200000   12727.922      200            200           -0.00034718453 -3.5541094e-34  0             -0.0010415536   72574.464      0              3.5043611e+09  1.1971759e-13  0              3.5524067    
    300000   12727.922      200            200           -9.0714003e-05 -4.7599688e-36  0             -0.00027214201  3551.0116      0              1.7146564e+08  1.1971759e-13  0              3.4607004    
    400000   12727.922      200            200           -6.8785071e-05  1.0154683e-34  0             -0.00020635521  2028.4988      0              97948949       1.1971759e-13  0              3.429135     
    500000   12727.922      200            200            0.00765671    -0.00019439014  0              0.02316452     1528.868       0              73823562       1.1971759e-13  0              3.4190513    
    600000   12727.922      200            200            0.0058516783   0.00029237386  0              0.017262661    174.85521      0              8443132.5      1.1971759e-13  0              3.4198942    
    700000   12727.922      200            200            0.005003363    0.00029610272  0              0.014713986    26.112407      0              1260874.7      1.1971759e-13  0              3.4202807    
    800000   12727.922      200            200            0.0047596441   0.00032211125  0              0.013956821    2.8698327      0              138573.95      1.1971759e-13  0              3.4204011    
    900000   12727.922      200            200            0.0046626064   0.0003359167   0              0.013651902    0.28155295     0              13595.184      1.1971759e-13  0              3.4204506    
   1000000   12727.922      200            200            0.0046209567   0.0003366181   0              0.013526252    0.024997981    0              1207.063       1.1971759e-13  0              3.4204712    
   1100000   12727.922      200            200            0.0046043016   0.00033716145  0              0.013475743    0.0019010089   0              91.792914      1.1971759e-13  0              3.4204796    
   1200000   12727.922      200            200            0.004597725    0.00033729202  0              0.013455883    0.00010937422  0              5.2812896      1.1971759e-13  0              3.4204829    
   1300000   12727.922      200            200            0.0045951912   0.00033734247  0              0.013448231    3.0502464e-06  0              0.14728548     1.1971759e-13  0              3.4204842    
   1400000   12727.922      200            200            0.004594233    0.0003373616   0              0.013445337    1.8188815e-08  0              0.00087827278  1.1971759e-13  0              3.4204847    
   1500000   12727.922      200            200            0.0045938769   0.00033736873  0              0.013444262    1.1051087e-07  0              0.0053361745   1.1971759e-13  0              3.4204848    
   1600000   12727.922      200            200            0.0045937468   0.00033737134  0              0.013443869    4.9920502e-08  0              0.0024104824   1.1971759e-13  0              3.4204849    
   1700000   12727.922      200            200            0.0045937001   0.00033737228  0              0.013443728    1.3855539e-08  0              0.00066903441  1.1971759e-13  0              3.4204849    
   1800000   12727.922      200            200            0.0045936836   0.00033737261  0              0.013443678    3.0836491e-09  0              0.00014889838  1.1971759e-13  0              3.4204849    
   1900000   12727.922      200            200            0.0045936779   0.00033737272  0              0.013443661    6.0250042e-10  0              2.9092589e-05  1.1971759e-13  0              3.4204849    
   2000000   12727.922      200            200            0.004593676    0.00033737276  0              0.013443655    1.0773723e-10  0              5.2022453e-06  1.1971759e-13  0              3.4204849    
   2100000   12727.922      200            200            0.0045936753   0.00033737278  0              0.013443653    1.8036476e-11  0              8.7091689e-07  1.1971759e-13  0              3.4204849    
   2200000   12727.922      200            200            0.0045936751   0.00033737278  0              0.013443653    2.8610955e-12  0              1.3815206e-07  1.1971759e-13  0              3.4204849    
   2300000   12727.922      200            200            0.0045936751   0.00033737278  0              0.013443652    4.3424961e-13  0              2.096836e-08   1.1971759e-13  0              3.4204849    
   2400000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    6.3723537e-14  0              3.0769816e-09  1.1971759e-13  0              3.4204849    
   2500000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    8.9468627e-15  0              4.3201198e-10  1.1971759e-13  0              3.4204849    
   2600000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    1.2248725e-15  0              5.914471e-11   1.1971759e-13  0              3.4204849    
   2700000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    8.9761949e-17  0              4.3342833e-12  1.1971759e-13  0              3.4204849    
   2800000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    2.0374407e-18  0              9.8380719e-14  1.1971759e-13  0              3.4204849    
   2900000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    2.364746e-20   0              1.1418512e-15  1.1971759e-13  0              3.4204849    
   3000000   12727.922      200            200            0.004593675    0.00033737278  0              0.013443652    8.2311706e-18  0              3.9745377e-13  1.1971759e-13  0              3.4204849    
Loop time of 539.022 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4808710.707 ns/day, 0.000 hours/ns, 5565.637 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.81      | 76.257     | 131.92     | 610.9 | 14.15
Neigh   | 2.9828     | 3.0167     | 3.0509     |   1.4 |  0.56
Comm    | 15.035     | 21.125     | 26.389     | 100.3 |  3.92
Output  | 0.43989    | 0.44052    | 0.44116    |   0.1 |  0.08
Modify  | 318.92     | 332.13     | 344.69     |  68.4 | 61.62
Other   |            | 106.1      |            |       | 19.68

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         672.25 ave        1345 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2689
Ave neighs/atom = 0.53769246
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.86                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.2495933951522
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.96
  ghost atom cutoff = 3.96
  binsize = 1.98, bins = 6429 102 102
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.29 | 83.3 | 83.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -9.9902649e-05 -5.0772903e-35  0             -0.00029970795  1326511.5      0              6.4052494e+10  1.1971759e-13  0              3.4521103    
    200000   12727.922      200            200           -0.00034104809 -5.0772943e-35  0             -0.0010231443   68667.516      0              3.3157086e+09  1.1971759e-13  0              3.5591189    
    300000   12727.922      200            200           -7.9400404e-05  1.269329e-35   0             -0.00023820121  2674.4394      0              1.2913911e+08  1.1971759e-13  0              3.4661249    
    400000   12727.922      200            200           -5.6253151e-05  5.07731e-35    0             -0.00016875945  1331.9323      0              64314242       1.1971759e-13  0              3.434481     
    500000   12727.922      200            200            0.0068142965   0.00031196607  0              0.020130924    2017.6578      0              97425472       1.1971759e-13  0              3.4244552    
    600000   12727.922      200            200            0.006174175    0.00036532208  0              0.018157203    93.291932      0              4504733.5      1.1971759e-13  0              3.4247678    
    700000   12727.922      200            200            0.0051363888   0.00031526113  0              0.015093905    13.676547      0              660391.52      1.1971759e-13  0              3.4252257    
    800000   12727.922      200            200            0.0048083945   0.00032430558  0              0.014100878    1.1102737      0              53611.145      1.1971759e-13  0              3.4253833    
    900000   12727.922      200            200            0.0046817245   0.00033480288  0              0.013710371    0.060340752    0              2913.639       1.1971759e-13  0              3.4254469    
   1000000   12727.922      200            200            0.004631301    0.00033738432  0              0.013556519    0.001319837    0              63.730208      1.1971759e-13  0              3.4254723    
   1100000   12727.922      200            200            0.0046117215   0.00033761731  0              0.013497547    4.6323323e-05  0              2.2367875      1.1971759e-13  0              3.4254821    
   1200000   12727.922      200            200            0.0046044363   0.00033776289  0              0.013475546    9.5961569e-05  0              4.6336408      1.1971759e-13  0              3.4254858    
   1300000   12727.922      200            200            0.0046017917   0.00033781592  0              0.013467559    3.8008946e-05  0              1.835316       1.1971759e-13  0              3.4254872    
   1400000   12727.922      200            200            0.0046008583   0.00033783469  0              0.01346474     9.8601996e-06  0              0.47611375     1.1971759e-13  0              3.4254876    
   1500000   12727.922      200            200            0.0046005389   0.00033784114  0              0.013463775    2.0779538e-06  0              0.10033695     1.1971759e-13  0              3.4254878    
   1600000   12727.922      200            200            0.0046004333   0.00033784328  0              0.013463457    3.8458036e-07  0              0.018570009    1.1971759e-13  0              3.4254878    
   1700000   12727.922      200            200            0.0046003999   0.00033784397  0              0.013463356    6.4832722e-08  0              0.0031305401   1.1971759e-13  0              3.4254879    
   1800000   12727.922      200            200            0.0046003899   0.00033784417  0              0.013463326    1.0150138e-08  0              0.00049011384  1.1971759e-13  0              3.4254879    
   1900000   12727.922      200            200            0.0046003872   0.00033784423  0              0.013463317    1.4917001e-09  0              7.2028859e-05  1.1971759e-13  0              3.4254879    
   2000000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    2.0692903e-10  0              9.9918625e-06  1.1971759e-13  0              3.4254879    
   2100000   12727.922      200            200            0.0046003865   0.00033784424  0              0.013463315    2.715454e-11   0              1.3111955e-06  1.1971759e-13  0              3.4254879    
   2200000   12727.922      200            200            0.0046003865   0.00033784424  0              0.013463315    3.3646418e-12  0              1.6246651e-07  1.1971759e-13  0              3.4254879    
   2300000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463315    3.9187196e-13  0              1.8922094e-08  1.1971759e-13  0              3.4254879    
   2400000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463315    4.2657789e-14  0              2.059792e-09   1.1971759e-13  0              3.4254879    
   2500000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    4.1370192e-15  0              1.9976185e-10  1.1971759e-13  0              3.4254879    
   2600000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    3.4781309e-16  0              1.6794649e-11  1.1971759e-13  0              3.4254879    
   2700000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    2.8503458e-18  0              1.37633e-13    1.1971759e-13  0              3.4254879    
   2800000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    2.2435862e-17  0              1.0833475e-12  1.1971759e-13  0              3.4254879    
   2900000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    1.1145836e-17  0              5.3819255e-13  1.1971759e-13  0              3.4254879    
   3000000   12727.922      200            200            0.0046003866   0.00033784424  0              0.013463316    7.8777097e-18  0              3.8038641e-13  1.1971759e-13  0              3.4254879    
Loop time of 533.625 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4857341.750 ns/day, 0.000 hours/ns, 5621.923 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.537     | 75.851     | 130.88     | 610.4 | 14.21
Neigh   | 3.089      | 3.1265     | 3.164      |   1.5 |  0.59
Comm    | 15.168     | 21.162     | 25.846     |  96.8 |  3.97
Output  | 0.3945     | 0.39511    | 0.39574    |   0.1 |  0.07
Modify  | 316.63     | 328.84     | 340.61     |  62.2 | 61.62
Other   |            | 104.2      |            |       | 19.54

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         678.25 ave        1357 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2713
Ave neighs/atom = 0.5424915
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.87                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 66.765821680226
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.97
  ghost atom cutoff = 3.97
  binsize = 1.985, bins = 6413 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.81 | 81.82 | 81.83 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00011547042  3.3637116e-34  0             -0.00034641127  1310111.1      0              6.3260579e+10  1.1971759e-13  0              3.4624772    
    200000   12727.922      200            200           -0.00033472567 -8.2506129e-35  0             -0.001004177    64872.143      0              3.1324436e+09  1.1971759e-13  0              3.565784     
    300000   12727.922      200            200           -6.7897472e-05  3.2156056e-40  0             -0.00020369242  1922.7228      0              92841405       1.1971759e-13  0              3.4714891    
    400000   12727.922      200            200           -4.3506046e-05 -1.0154585e-34  0             -0.00013051814  782.04273      0              37762044       1.1971759e-13  0              3.4397555    
    500000   12727.922      200            200            0.0058867197   0.00066234971  0              0.016997809    2354.8638      0              1.1370794e+08  1.1971759e-13  0              3.4299046    
    600000   12727.922      200            200            0.0063628473   0.00032206903  0              0.018766473    30.00813       0              1448985.2      1.1971759e-13  0              3.4296851    
    700000   12727.922      200            200            0.005221605    0.00031682914  0              0.015347986    3.9836894      0              192358.11      1.1971759e-13  0              3.4301911    
    800000   12727.922      200            200            0.0048346901   0.0003223354   0              0.014181735    0.096061758    0              4638.4785      1.1971759e-13  0              3.4303759    
    900000   12727.922      200            200            0.0046899466   0.00033145799  0              0.013738382    0.0047438038   0              229.06131      1.1971759e-13  0              3.4304483    
   1000000   12727.922      200            200            0.0046357142   0.00033426231  0              0.01357288     0.0081878939   0              395.36409      1.1971759e-13  0              3.4304758    
   1100000   12727.922      200            200            0.0046159798   0.00033466809  0              0.013513271    0.0031168906   0              150.50349      1.1971759e-13  0              3.4304857    
   1200000   12727.922      200            200            0.0046091561   0.0003348094   0              0.013492659    0.00078024872  0              37.675418      1.1971759e-13  0              3.4304892    
   1300000   12727.922      200            200            0.0046069057   0.00033485625  0              0.013485861    0.00015764468  0              7.6120975      1.1971759e-13  0              3.4304903    
   1400000   12727.922      200            200            0.0046062063   0.0003348709   0              0.013483748    2.7692753e-05  0              1.3371839      1.1971759e-13  0              3.4304907    
   1500000   12727.922      200            200            0.0046060064   0.00033487513  0              0.013483144    4.3751184e-06  0              0.21125881     1.1971759e-13  0              3.4304908    
   1600000   12727.922      200            200            0.0046059568   0.0003348762   0              0.013482994    6.3186592e-07  0              0.030510544    1.1971759e-13  0              3.4304908    
   1700000   12727.922      200            200            0.004605948    0.00033487639  0              0.013482968    8.3959961e-08  0              0.004054126    1.1971759e-13  0              3.4304908    
   1800000   12727.922      200            200            0.0046059484   0.00033487639  0              0.013482969    1.0255392e-08  0              0.00049519615  1.1971759e-13  0              3.4304908    
   1900000   12727.922      200            200            0.0046059498   0.00033487637  0              0.013482973    1.1417369e-09  0              5.5130387e-05  1.1971759e-13  0              3.4304908    
   2000000   12727.922      200            200            0.0046059508   0.00033487635  0              0.013482976    1.1360512e-10  0              5.4855848e-06  1.1971759e-13  0              3.4304908    
   2100000   12727.922      200            200            0.0046059513   0.00033487634  0              0.013482978    9.6991806e-12  0              4.6833872e-07  1.1971759e-13  0              3.4304908    
   2200000   12727.922      200            200            0.0046059515   0.00033487633  0              0.013482978    6.4696836e-13  0              3.1239787e-08  1.1971759e-13  0              3.4304908    
   2300000   12727.922      200            200            0.0046059516   0.00033487633  0              0.013482979    2.5005125e-14  0              1.207408e-09   1.1971759e-13  0              3.4304908    
   2400000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    6.2519422e-17  0              3.0188391e-12  1.1971759e-13  0              3.4304908    
   2500000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    2.86528e-16    0              1.3835412e-11  1.1971759e-13  0              3.4304908    
   2600000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    1.9619931e-16  0              9.4737624e-12  1.1971759e-13  0              3.4304908    
   2700000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    1.2396497e-16  0              5.9858248e-12  1.1971759e-13  0              3.4304908    
   2800000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    6.1055722e-18  0              2.9481623e-13  1.1971759e-13  0              3.4304908    
   2900000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    1.7302486e-18  0              8.3547511e-14  1.1971759e-13  0              3.4304908    
   3000000   12727.922      200            200            0.0046059517   0.00033487633  0              0.013482979    1.202831e-17   0              5.8080405e-13  1.1971759e-13  0              3.4304908    
Loop time of 536.89 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4827808.354 ns/day, 0.000 hours/ns, 5587.741 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.555     | 76.185     | 130.74     | 610.2 | 14.19
Neigh   | 2.9501     | 2.9834     | 3.018      |   1.4 |  0.56
Comm    | 15.041     | 20.871     | 25.32      |  96.1 |  3.89
Output  | 0.39323    | 0.39388    | 0.39456    |   0.1 |  0.07
Modify  | 318.07     | 330.7      | 343.6      |  65.9 | 61.59
Other   |            | 105.8      |            |       | 19.70

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         683.25 ave        1367 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2733
Ave neighs/atom = 0.5464907
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.88                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.284724717285
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.98
  ghost atom cutoff = 3.98
  binsize = 1.99, bins = 6396 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.59 | 81.61 | 81.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00013081422 -1.2693239e-34  0             -0.00039244265  1293822.8      0              6.2474071e+10  1.1971759e-13  0              3.4728137    
    200000   12727.922      200            200           -0.0003282182   2.8260301e-40  0             -0.0009846546   61188.042      0              2.9545515e+09  1.1971759e-13  0              3.572402     
    300000   12727.922      200            200           -5.6206513e-05 -6.0927562e-34  0             -0.00016861954  1295.425       0              62551436       1.1971759e-13  0              3.476793     
    400000   12727.922      200            200           -3.0545574e-05  8.5606202e-41  0             -9.1636723e-05  378.18667      0              18261281       1.1971759e-13  0              3.4449585    
    500000   12727.922      200            200            0.0048303688   0.00051821712  0              0.013972889    2493.2602      0              1.2039061e+08  1.1971759e-13  0              3.4353784    
    600000   12727.922      200            200            0.0064457012   0.00030237963  0              0.019034724    0.89207082     0              43074.907      1.1971759e-13  0              3.4346515    
    700000   12727.922      200            200            0.0052574858   0.00031868269  0              0.015453775    0.018881058    0              911.69872      1.1971759e-13  0              3.4351798    
    800000   12727.922      200            200            0.0048378294   0.00032071931  0              0.014192769    0.21429875     0              10347.72       1.1971759e-13  0              3.4353799    
    900000   12727.922      200            200            0.0046881924   0.00032975852  0              0.013734819    0.13993107     0              6756.7707      1.1971759e-13  0              3.4354549    
   1000000   12727.922      200            200            0.0046360906   0.00033243889  0              0.013575833    0.041395279    0              1998.8299      1.1971759e-13  0              3.4354814    
   1100000   12727.922      200            200            0.004618811    0.00033280901  0              0.013523624    0.0089877258   0              433.98512      1.1971759e-13  0              3.4354902    
   1200000   12727.922      200            200            0.0046135606   0.00033292257  0              0.013507759    0.001616164    0              78.038778      1.1971759e-13  0              3.4354928    
   1300000   12727.922      200            200            0.0046121408   0.00033295365  0              0.013503469    0.0002527612   0              12.204934      1.1971759e-13  0              3.4354936    
   1400000   12727.922      200            200            0.0046118347   0.00033296052  0              0.013502544    3.5083417e-05  0              1.6940526      1.1971759e-13  0              3.4354937    
   1500000   12727.922      200            200            0.0046118074   0.00033296125  0              0.013502461    4.3389946e-06  0              0.20951452     1.1971759e-13  0              3.4354938    
   1600000   12727.922      200            200            0.004611829    0.00033296084  0              0.013502526    4.733123e-07   0              0.022854557    1.1971759e-13  0              3.4354937    
   1700000   12727.922      200            200            0.0046118481   0.00033296045  0              0.013502584    4.4187329e-08  0              0.002133648    1.1971759e-13  0              3.4354937    
   1800000   12727.922      200            200            0.0046118588   0.00033296023  0              0.013502616    3.2847106e-09  0              0.00015860692  1.1971759e-13  0              3.4354937    
   1900000   12727.922      200            200            0.0046118638   0.00033296012  0              0.013502631    1.5844353e-10  0              7.650671e-06   1.1971759e-13  0              3.4354937    
   2000000   12727.922      200            200            0.004611866    0.00033296008  0              0.013502638    1.6098234e-12  0              7.7732609e-08  1.1971759e-13  0              3.4354937    
   2100000   12727.922      200            200            0.0046118668   0.00033296006  0              0.01350264     6.1868326e-13  0              2.9874e-08     1.1971759e-13  0              3.4354937    
   2200000   12727.922      200            200            0.0046118671   0.00033296005  0              0.013502641    5.3315749e-13  0              2.5744267e-08  1.1971759e-13  0              3.4354937    
   2300000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    1.7135048e-13  0              8.2739017e-09  1.1971759e-13  0              3.4354937    
   2400000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    3.8161851e-14  0              1.8426992e-09  1.1971759e-13  0              3.4354937    
   2500000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    7.0196242e-15  0              3.3895253e-10  1.1971759e-13  0              3.4354937    
   2600000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    1.1567482e-15  0              5.5855232e-11  1.1971759e-13  0              3.4354937    
   2700000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    1.101385e-16   0              5.3181938e-12  1.1971759e-13  0              3.4354937    
   2800000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    2.1035214e-18  0              1.0157152e-13  1.1971759e-13  0              3.4354937    
   2900000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    9.2950733e-20  0              4.4882583e-15  1.1971759e-13  0              3.4354937    
   3000000   12727.922      200            200            0.0046118673   0.00033296005  0              0.013502642    1.4380559e-18  0              6.9438572e-14  1.1971759e-13  0              3.4354937    
Loop time of 538.97 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4809172.590 ns/day, 0.000 hours/ns, 5566.172 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.394     | 76.837     | 133.13     | 617.3 | 14.26
Neigh   | 2.9886     | 3.024      | 3.0597     |   1.5 |  0.56
Comm    | 15.131     | 21.153     | 26.28      |  99.4 |  3.92
Output  | 0.39601    | 0.39666    | 0.39734    |   0.1 |  0.07
Modify  | 319.64     | 331.83     | 343.74     |  61.6 | 61.57
Other   |            | 105.7      |            |       | 19.62

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         688.75 ave        1378 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2755
Ave neighs/atom = 0.55088982
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.89                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 67.8063094178331
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.99
  ghost atom cutoff = 3.99
  binsize = 1.995, bins = 6380 101 101
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 81.42 | 81.43 | 81.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00014593461 -2.0309119e-34  0             -0.00043780383  1277646.2      0              6.1692963e+10  1.1971759e-13  0              3.4831198    
    200000   12727.922      200            200           -0.00032152658  3.5053171e-40  0             -0.00096457975  57614.902      0              2.7820174e+09  1.1971759e-13  0              3.5789727    
    300000   12727.922      200            200           -4.4328765e-05  9.1391494e-34  0             -0.0001329863   792.10693      0              38248009       1.1971759e-13  0              3.4820364    
    400000   12727.922      200            200           -1.7373417e-05 -1.0154468e-34  0             -5.212025e-05   119.71796      0              5780751.8      1.1971759e-13  0              3.4500897    
    500000   12727.922      200            200            0.0038472441   0.00032442931  0              0.011217303    2427.8011      0              1.1722983e+08  1.1971759e-13  0              3.4408563    
    600000   12727.922      200            200            0.0064136972   0.00030396764  0              0.018937124    13.280821      0              641283.3       1.1971759e-13  0              3.4396695    
    700000   12727.922      200            200            0.005241107    0.00032068633  0              0.015402635    2.9870924      0              144236         1.1971759e-13  0              3.440193     
    800000   12727.922      200            200            0.0048189229   0.00032198469  0              0.014134784    1.4104215      0              68104.205      1.1971759e-13  0              3.4403951    
    900000   12727.922      200            200            0.0046781243   0.00033178692  0              0.013702586    0.39983239     0              19306.475      1.1971759e-13  0              3.4404663    
   1000000   12727.922      200            200            0.0046340484   0.00033426595  0              0.013567879    0.081706438    0              3945.3115      1.1971759e-13  0              3.4404888    
   1100000   12727.922      200            200            0.0046215977   0.00033453068  0              0.013530262    0.01366407     0              659.78902      1.1971759e-13  0              3.4404952    
   1200000   12727.922      200            200            0.0046187965   0.00033459161  0              0.013521798    0.0019443322   0              93.884844      1.1971759e-13  0              3.4404967    
   1300000   12727.922      200            200            0.0046184925   0.00033459898  0              0.013520879    0.00023751776  0              11.468883      1.1971759e-13  0              3.4404969    
   1400000   12727.922      200            200            0.0046186543   0.000334596    0              0.013521367    2.4515788e-05  0              1.1837797      1.1971759e-13  0              3.4404968    
   1500000   12727.922      200            200            0.0046188092   0.0003345929   0              0.013521835    2.0264865e-06  0              0.09785178     1.1971759e-13  0              3.4404967    
   1600000   12727.922      200            200            0.0046188968   0.00033459112  0              0.013522099    1.1520693e-07  0              0.0055629304   1.1971759e-13  0              3.4404967    
   1700000   12727.922      200            200            0.0046189378   0.00033459028  0              0.013522223    2.3340299e-09  0              0.00011270195  1.1971759e-13  0              3.4404967    
   1800000   12727.922      200            200            0.0046189549   0.00033458992  0              0.013522275    1.3197318e-10  0              6.3725126e-06  1.1971759e-13  0              3.4404966    
   1900000   12727.922      200            200            0.0046189615   0.00033458979  0              0.013522295    2.1282794e-10  0              1.02767e-05    1.1971759e-13  0              3.4404966    
   2000000   12727.922      200            200            0.0046189638   0.00033458974  0              0.013522302    7.6519802e-11  0              3.6948674e-06  1.1971759e-13  0              3.4404966    
   2100000   12727.922      200            200            0.0046189646   0.00033458972  0              0.013522304    1.7734581e-11  0              8.5633946e-07  1.1971759e-13  0              3.4404966    
   2200000   12727.922      200            200            0.0046189648   0.00033458972  0              0.013522305    3.227801e-12   0              1.5585896e-07  1.1971759e-13  0              3.4404966    
   2300000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    4.9265586e-13  0              2.3788588e-08  1.1971759e-13  0              3.4404966    
   2400000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    6.4159854e-14  0              3.0980497e-09  1.1971759e-13  0              3.4404966    
   2500000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    7.2675816e-15  0              3.5092551e-10  1.1971759e-13  0              3.4404966    
   2600000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    6.6511735e-16  0              3.2116137e-11  1.1971759e-13  0              3.4404966    
   2700000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    7.1686098e-20  0              3.4614651e-15  1.1971759e-13  0              3.4404966    
   2800000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    2.2277732e-17  0              1.0757119e-12  1.1971759e-13  0              3.4404966    
   2900000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    4.9951604e-18  0              2.4119842e-13  1.1971759e-13  0              3.4404966    
   3000000   12727.922      200            200            0.0046189649   0.00033458971  0              0.013522305    3.3666057e-23  0              1.6256134e-18  1.1971759e-13  0              3.4404966    
Loop time of 540.754 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4793311.000 ns/day, 0.000 hours/ns, 5547.814 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 21.913     | 77.045     | 132.32     | 621.1 | 14.25
Neigh   | 2.9675     | 3.0018     | 3.037      |   1.4 |  0.56
Comm    | 14.925     | 21.28      | 25.848     |  92.1 |  3.94
Output  | 0.40829    | 0.40891    | 0.40956    |   0.1 |  0.08
Modify  | 319.51     | 332.1      | 346.73     |  66.0 | 61.41
Other   |            | 106.9      |            |       | 19.77

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         693.75 ave        1388 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2775
Ave neighs/atom = 0.55488902
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.9                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.3305826933741
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4
  ghost atom cutoff = 4
  binsize = 2, bins = 6364 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 83.86 | 83.87 | 83.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00016083221  9.8838778e-40  0             -0.00048249664  1261581.2      0              6.0917243e+10  1.1971759e-13  0              3.4933956    
    200000   12727.922      200            200           -0.00031465175  1.2693267e-35  0             -0.00094395524  54152.427      0              2.6148269e+09  1.1971759e-13  0              3.585496     
    300000   12727.922      200            200           -3.2265561e-05 -1.0154478e-34  0             -9.6796683e-05  412.33494      0              19910179       1.1971759e-13  0              3.4872193    
    400000   12727.922      200            200           -3.9913893e-06 -5.0772788e-35  0             -1.1974168e-05  5.996123       0              289531.32      1.1971759e-13  0              3.4551492    
    500000   12727.922      200            200            0.0031133635   0.00050759452  0              0.008832496    2188.1549      0              1.0565817e+08  1.1971759e-13  0              3.4463195    
    600000   12727.922      200            200            0.0062686409   0.00032329906  0              0.018482624    63.754932      0              3078497.5      1.1971759e-13  0              3.444738     
    700000   12727.922      200            200            0.0051731264   0.0003186316   0              0.015200748    11.912037      0              575189.64      1.1971759e-13  0              3.4452298    
    800000   12727.922      200            200            0.0047802981   0.00032496716  0              0.014015927    3.2115506      0              155074.29      1.1971759e-13  0              3.4454202    
    900000   12727.922      200            200            0.0046609234   0.00033455595  0              0.013648214    0.65936009     0              31838.139      1.1971759e-13  0              3.4454813    
   1000000   12727.922      200            200            0.0046298496   0.00033640773  0              0.013553141    0.10595663     0              5116.2664      1.1971759e-13  0              3.4454974    
   1100000   12727.922      200            200            0.0046240098   0.00033653663  0              0.013535493    0.013988634    0              675.46108      1.1971759e-13  0              3.4455005    
   1200000   12727.922      200            200            0.0046241596   0.00033653641  0              0.013535942    0.0015093666   0              72.88191       1.1971759e-13  0              3.4455005    
   1300000   12727.922      200            200            0.00462505     0.00033651891  0              0.013538631    0.0001262213   0              6.0947746      1.1971759e-13  0              3.4455001    
   1400000   12727.922      200            200            0.0046256517   0.00033650672  0              0.013540448    6.8892523e-06  0              0.33265734     1.1971759e-13  0              3.4454998    
   1500000   12727.922      200            200            0.004625952    0.00033650056  0              0.013541355    1.0463063e-07  0              0.0050522386   1.1971759e-13  0              3.4454996    
   1600000   12727.922      200            200            0.0046260808   0.0003364979   0              0.013541745    1.6032498e-08  0              0.00077415193  1.1971759e-13  0              3.4454996    
   1700000   12727.922      200            200            0.0046261304   0.00033649687  0              0.013541894    1.7366685e-08  0              0.00083857508  1.1971759e-13  0              3.4454996    
   1800000   12727.922      200            200            0.0046261477   0.00033649651  0              0.013541947    5.6199318e-09  0              0.0002713664   1.1971759e-13  0              3.4454995    
   1900000   12727.922      200            200            0.0046261531   0.00033649639  0              0.013541963    1.1987983e-09  0              5.7885679e-05  1.1971759e-13  0              3.4454995    
   2000000   12727.922      200            200            0.0046261546   0.00033649636  0              0.013541967    1.987525e-10   0              9.5970469e-06  1.1971759e-13  0              3.4454995    
   2100000   12727.922      200            200            0.0046261549   0.00033649635  0              0.013541968    2.6933716e-11  0              1.3005328e-06  1.1971759e-13  0              3.4454995    
   2200000   12727.922      200            200            0.0046261549   0.00033649635  0              0.013541968    2.9897264e-12  0              1.4436319e-07  1.1971759e-13  0              3.4454995    
   2300000   12727.922      200            200            0.0046261549   0.00033649636  0              0.013541968    2.601148e-13   0              1.2560013e-08  1.1971759e-13  0              3.4454995    
   2400000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    1.4996306e-14  0              7.2411794e-10  1.1971759e-13  0              3.4454995    
   2500000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    2.8053513e-16  0              1.3546037e-11  1.1971759e-13  0              3.4454995    
   2600000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    1.9201921e-17  0              9.2719206e-13  1.1971759e-13  0              3.4454995    
   2700000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    1.1010219e-16  0              5.3164407e-12  1.1971759e-13  0              3.4454995    
   2800000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    7.627766e-18   0              3.6831752e-13  1.1971759e-13  0              3.4454995    
   2900000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    1.3180349e-17  0              6.364319e-13   1.1971759e-13  0              3.4454995    
   3000000   12727.922      200            200            0.0046261548   0.00033649636  0              0.013541968    7.5680135e-18  0              3.6543229e-13  1.1971759e-13  0              3.4454995    
Loop time of 538.081 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4817121.294 ns/day, 0.000 hours/ns, 5575.372 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.291     | 77.178     | 133.48     | 621.1 | 14.34
Neigh   | 3.0743     | 3.1101     | 3.1467     |   1.5 |  0.58
Comm    | 15.02      | 21.03      | 25.111     |  90.0 |  3.91
Output  | 0.41794    | 0.41856    | 0.41921    |   0.1 |  0.08
Modify  | 319.87     | 331.43     | 343.49     |  58.9 | 61.59
Other   |            | 104.9      |            |       | 19.50

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         698.75 ave        1398 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2795
Ave neighs/atom = 0.55888822
Neighbor list builds = 147
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.91                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 68.8575514554118
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.01
  ghost atom cutoff = 4.01
  binsize = 2.005, bins = 6349 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.84 | 79.85 | 79.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00017550762  1.0154672e-34  0             -0.00052652287  1245627.7      0              6.0146903e+10  1.1971759e-13  0              3.5036408    
    200000   12727.922      200            200           -0.0003075946  -5.0772718e-35  0             -0.0009227838   50800.309      0              2.4529651e+09  1.1971759e-13  0              3.5919719    
    300000   12727.922      200            200           -2.001814e-05  -6.3466191e-36  0             -6.0054419e-05  155.67284      0              7516884.5      1.1971759e-13  0              3.4923414    
    400000   12727.922      200            200            9.5988163e-06  1.2693283e-35  0              2.8796449e-05  36.380736      0              1756695.5      1.1971759e-13  0              3.4601367    
    500000   12727.922      200            200            0.002400524    0.00033336225  0              0.0068682097   1825.9213      0              88167206       1.1971759e-13  0              3.4517518    
    600000   12727.922      200            200            0.006033301    0.00038650305  0              0.0177134      139.11844      0              6717531.5      1.1971759e-13  0              3.4498527    
    700000   12727.922      200            200            0.0050664115   0.0003308085   0              0.014868426    23.962814      0              1157078.5      1.1971759e-13  0              3.4502874    
    800000   12727.922      200            200            0.0047262171   0.00032798823  0              0.013850663    4.9154861      0              237351.23      1.1971759e-13  0              3.4504531    
    900000   12727.922      200            200            0.004639694    0.00033815368  0              0.013580928    0.79468885     0              38372.681      1.1971759e-13  0              3.4504985    
   1000000   12727.922      200            200            0.004625519    0.00033982041  0              0.013536737    0.10029052     0              4842.6702      1.1971759e-13  0              3.4505063    
   1100000   12727.922      200            200            0.004627219    0.00033979406  0              0.013541863    0.0097561311   0              471.08865      1.1971759e-13  0              3.4505056    
   1200000   12727.922      200            200            0.0046303556   0.00033973389  0              0.013551333    0.00065496482  0              31.625907      1.1971759e-13  0              3.4505041    
   1300000   12727.922      200            200            0.004632293    0.00033969589  0              0.013557183    1.923273e-05   0              0.92867968     1.1971759e-13  0              3.4505032    
   1400000   12727.922      200            200            0.0046332081   0.00033967776  0              0.013559947    1.6966489e-07  0              0.0081925103   1.1971759e-13  0              3.4505027    
   1500000   12727.922      200            200            0.004633579    0.00033967036  0              0.013561067    7.6169008e-07  0              0.036779288    1.1971759e-13  0              3.4505025    
   1600000   12727.922      200            200            0.0046337119   0.0003396677   0              0.013561468    2.9863239e-07  0              0.01441989     1.1971759e-13  0              3.4505025    
   1700000   12727.922      200            200            0.0046337538   0.00033966685  0              0.013561595    6.7411944e-08  0              0.0032550815   1.1971759e-13  0              3.4505024    
   1800000   12727.922      200            200            0.0046337648   0.00033966662  0              0.013561628    1.1164893e-08  0              0.00053911271  1.1971759e-13  0              3.4505024    
   1900000   12727.922      200            200            0.0046337668   0.00033966658  0              0.013561634    1.4441799e-09  0              6.9734281e-05  1.1971759e-13  0              3.4505024    
   2000000   12727.922      200            200            0.0046337667   0.00033966658  0              0.013561633    1.4445328e-10  0              6.9751321e-06  1.1971759e-13  0              3.4505024    
   2100000   12727.922      200            200            0.0046337663   0.00033966659  0              0.013561632    1.0150726e-11  0              4.9014225e-07  1.1971759e-13  0              3.4505024    
   2200000   12727.922      200            200            0.0046337661   0.00033966659  0              0.013561632    3.4024405e-13  0              1.6429168e-08  1.1971759e-13  0              3.4505024    
   2300000   12727.922      200            200            0.004633766    0.0003396666   0              0.013561631    6.2333368e-16  0              3.0098553e-11  1.1971759e-13  0              3.4505024    
   2400000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    9.0866041e-15  0              4.3875959e-10  1.1971759e-13  0              3.4505024    
   2500000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    3.9609191e-15  0              1.9125861e-10  1.1971759e-13  0              3.4505024    
   2600000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    9.4710843e-16  0              4.5732477e-11  1.1971759e-13  0              3.4505024    
   2700000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    1.3688749e-16  0              6.6098068e-12  1.1971759e-13  0              3.4505024    
   2800000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    1.4066861e-18  0              6.7923838e-14  1.1971759e-13  0              3.4505024    
   2900000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    2.7567601e-19  0              1.3311408e-14  1.1971759e-13  0              3.4505024    
   3000000   12727.922      200            200            0.0046337659   0.0003396666   0              0.013561631    4.6177029e-18  0              2.2297235e-13  1.1971759e-13  0              3.4505024    
Loop time of 541.312 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4788367.206 ns/day, 0.000 hours/ns, 5542.092 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.568     | 77.418     | 133.57     | 619.4 | 14.30
Neigh   | 2.9786     | 3.0123     | 3.0469     |   1.4 |  0.56
Comm    | 15.423     | 21.101     | 24.955     |  86.5 |  3.90
Output  | 0.39193    | 0.39255    | 0.39317    |   0.1 |  0.07
Modify  | 320.93     | 333.66     | 345.8      |  64.9 | 61.64
Other   |            | 105.7      |            |       | 19.53

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         703.25 ave        1407 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2813
Ave neighs/atom = 0.5624875
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.92                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.3872226154503
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.02
  ghost atom cutoff = 4.02
  binsize = 2.01, bins = 6333 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.67 | 79.68 | 79.69 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00018996143  2.5386592e-35  0             -0.00056988428  1229785.3      0              5.9381932e+10  1.1971759e-13  0              3.5138555    
    200000   12727.922      200            200           -0.00030035608  1.2693258e-35  0             -0.00090106825  47558.254      0              2.2964179e+09  1.1971759e-13  0              3.5984002    
    300000   12727.922      200            200           -7.5878209e-06  5.077327e-35   0             -2.2763463e-05  21.687579      0              1047215.6      1.1971759e-13  0              3.4974026    
    400000   12727.922      200            200            2.3395418e-05  1.0580676e-40  0              7.0186254e-05  210.23402      0              10151448       1.1971759e-13  0              3.4650523    
    500000   12727.922      200            200            0.0018872516   0.00033871866  0              0.0053230362   1401.1661      0              67657298       1.1971759e-13  0              3.4571396    
    600000   12727.922      200            200            0.0057042107   0.00041430357  0              0.016698329    220.24004      0              10634603       1.1971759e-13  0              3.4550064    
    700000   12727.922      200            200            0.0049317798   0.00035767878  0              0.014437661    35.390213      0              1708866.7      1.1971759e-13  0              3.4553615    
    800000   12727.922      200            200            0.0046646189   0.00033581477  0              0.013658042    5.8668438      0              283288.89      1.1971759e-13  0              3.4554907    
    900000   12727.922      200            200            0.0046167639   0.00033882256  0              0.013511469    0.74211666     0              35834.158      1.1971759e-13  0              3.4555162    
   1000000   12727.922      200            200            0.0046223698   0.00034308878  0              0.013524021    0.067995157    0              3283.2428      1.1971759e-13  0              3.4555146    
   1100000   12727.922      200            200            0.0046315445   0.00034291515  0              0.013551718    0.003828687    0              184.87359      1.1971759e-13  0              3.4555102    
   1200000   12727.922      200            200            0.0046372193   0.00034280549  0              0.013568852    5.0145331e-05  0              2.4213386      1.1971759e-13  0              3.4555074    
   1300000   12727.922      200            200            0.0046398512   0.00034275415  0              0.013576799    1.2183972e-05  0              0.58832042     1.1971759e-13  0              3.4555061    
   1400000   12727.922      200            200            0.0046408801   0.00034273394  0              0.013579906    1.1059907e-05  0              0.53404332     1.1971759e-13  0              3.4555055    
   1500000   12727.922      200            200            0.0046412268   0.00034272708  0              0.013580953    3.2186932e-06  0              0.15541918     1.1971759e-13  0              3.4555054    
   1600000   12727.922      200            200            0.0046413246   0.00034272512  0              0.013581249    5.9935688e-07  0              0.028940799    1.1971759e-13  0              3.4555053    
   1700000   12727.922      200            200            0.0046413445   0.00034272471  0              0.013581309    8.1731808e-08  0              0.0039465365   1.1971759e-13  0              3.4555053    
   1800000   12727.922      200            200            0.004641345    0.0003427247   0              0.01358131     8.2050084e-09  0              0.00039619049  1.1971759e-13  0              3.4555053    
   1900000   12727.922      200            200            0.0046413426   0.00034272474  0              0.013581303    5.4061692e-10  0              2.6104456e-05  1.1971759e-13  0              3.4555053    
   2000000   12727.922      200            200            0.004641341    0.00034272477  0              0.013581298    1.3390472e-11  0              6.4657798e-07  1.1971759e-13  0              3.4555053    
   2100000   12727.922      200            200            0.0046413401   0.00034272479  0              0.013581296    3.9911644e-13  0              1.9271904e-08  1.1971759e-13  0              3.4555053    
   2200000   12727.922      200            200            0.0046413398   0.0003427248   0              0.013581295    8.4722285e-13  0              4.0909359e-08  1.1971759e-13  0              3.4555053    
   2300000   12727.922      200            200            0.0046413397   0.0003427248   0              0.013581294    2.9360399e-13  0              1.4177086e-08  1.1971759e-13  0              3.4555053    
   2400000   12727.922      200            200            0.0046413397   0.0003427248   0              0.013581294    5.9711436e-14  0              2.8832515e-09  1.1971759e-13  0              3.4555053    
   2500000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    8.8584977e-15  0              4.2774515e-10  1.1971759e-13  0              3.4555053    
   2600000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    9.9817141e-16  0              4.8198125e-11  1.1971759e-13  0              3.4555053    
   2700000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    4.5216341e-18  0              2.1833353e-13  1.1971759e-13  0              3.4555053    
   2800000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    2.1435741e-17  0              1.0350552e-12  1.1971759e-13  0              3.4555053    
   2900000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    7.4560718e-18  0              3.6002702e-13  1.1971759e-13  0              3.4555053    
   3000000   12727.922      200            200            0.0046413396   0.0003427248   0              0.013581294    2.4843825e-18  0              1.1996194e-13  1.1971759e-13  0              3.4555053    
Loop time of 538.248 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4815622.440 ns/day, 0.000 hours/ns, 5573.637 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.18      | 77.428     | 134.08     | 623.0 | 14.39
Neigh   | 3.013      | 3.0483     | 3.0841     |   1.5 |  0.57
Comm    | 15.233     | 21.174     | 25.307     |  90.0 |  3.93
Output  | 0.47387    | 0.4745     | 0.47515    |   0.1 |  0.09
Modify  | 320.77     | 331.62     | 341.82     |  55.8 | 61.61
Other   |            | 104.5      |            |       | 19.41

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         708.75 ave        1418 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2835
Ave neighs/atom = 0.56688662
Neighbor list builds = 153
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.93                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 69.9196030849932
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.03
  ghost atom cutoff = 4.03
  binsize = 2.015, bins = 6317 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.5 | 79.51 | 79.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00020419421  2.5386567e-35  0             -0.00061258263  1214054        0              5.8622321e+10  1.1971759e-13  0              3.5240396    
    200000   12727.922      200            200           -0.0002929371  -1.0154521e-34  0             -0.00087881131  44425.96       0              2.1451706e+09  1.1971759e-13  0              3.6047809    
    300000   12727.922      200            200            5.024132e-06   4.1887731e-34  0              1.5072396e-05  9.9457294      0              480243.68      1.1971759e-13  0              3.502403     
    400000   12727.922      200            200            3.7396709e-05  1.5231919e-34  0              0.00011219013  526.92058      0              25443109       1.1971759e-13  0              3.4698957    
    500000   12727.922      200            200            0.0014484819   0.00018501422  0              0.0041604314   971.32782      0              46901944       1.1971759e-13  0              3.4624723    
    600000   12727.922      200            200            0.0052927748   0.00035652733  0              0.015521797    287.36492      0              13875823       1.1971759e-13  0              3.4601895    
    700000   12727.922      200            200            0.0047822186   0.00039952824  0              0.013947127    42.728524      0              2063207.5      1.1971759e-13  0              3.4604464    
    800000   12727.922      200            200            0.0046056775   0.00035764666  0              0.013459386    5.7087502      0              275655.11      1.1971759e-13  0              3.4605297    
    900000   12727.922      200            200            0.0045981108   0.00034359816  0              0.013450734    0.52752279     0              25472.188      1.1971759e-13  0              3.4605324    
   1000000   12727.922      200            200            0.0046222458   0.00034692785  0              0.01351981     0.027562125    0              1330.8764      1.1971759e-13  0              3.4605215    
   1100000   12727.922      200            200            0.0046378104   0.00034663341  0              0.013566798    0.00019866688  0              9.5929128      1.1971759e-13  0              3.4605138    
   1200000   12727.922      200            200            0.0046451468   0.00034649329  0              0.013588947    0.00016526235  0              7.9799274      1.1971759e-13  0              3.4605102    
   1300000   12727.922      200            200            0.0046479768   0.00034643886  0              0.013597492    0.0001105144   0              5.3363448      1.1971759e-13  0              3.4605088    
   1400000   12727.922      200            200            0.0046488891   0.00034642117  0              0.013600246    2.8326501e-05  0              1.3677854      1.1971759e-13  0              3.4605083    
   1500000   12727.922      200            200            0.0046491207   0.00034641662  0              0.013600946    4.652575e-06   0              0.22465619     1.1971759e-13  0              3.4605082    
   1600000   12727.922      200            200            0.0046491536   0.00034641594  0              0.013601045    5.3530892e-07  0              0.025848152    1.1971759e-13  0              3.4605082    
   1700000   12727.922      200            200            0.0046491445   0.00034641609  0              0.013601017    4.0388333e-08  0              0.0019502081   1.1971759e-13  0              3.4605082    
   1800000   12727.922      200            200            0.004649134    0.00034641629  0              0.013600986    1.3337397e-09  0              6.4401518e-05  1.1971759e-13  0              3.4605082    
   1900000   12727.922      200            200            0.0046491282   0.0003464164   0              0.013600968    6.2184115e-12  0              3.0026484e-07  1.1971759e-13  0              3.4605082    
   2000000   12727.922      200            200            0.0046491257   0.00034641645  0              0.013600961    4.3216285e-11  0              2.0867597e-06  1.1971759e-13  0              3.4605082    
   2100000   12727.922      200            200            0.0046491248   0.00034641646  0              0.013600958    1.6591025e-11  0              8.0112124e-07  1.1971759e-13  0              3.4605082    
   2200000   12727.922      200            200            0.0046491246   0.00034641647  0              0.013600957    3.4155497e-12  0              1.6492467e-07  1.1971759e-13  0              3.4605082    
   2300000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    4.7914563e-13  0              2.3136228e-08  1.1971759e-13  0              3.4605082    
   2400000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    4.6152696e-14  0              2.2285485e-09  1.1971759e-13  0              3.4605082    
   2500000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    2.7478875e-15  0              1.3268565e-10  1.1971759e-13  0              3.4605082    
   2600000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    3.7688147e-17  0              1.8198258e-12  1.1971759e-13  0              3.4605082    
   2700000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    8.5553444e-17  0              4.1310696e-12  1.1971759e-13  0              3.4605082    
   2800000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    6.5435265e-18  0              3.1596348e-13  1.1971759e-13  0              3.4605082    
   2900000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    1.2643118e-17  0              6.1049092e-13  1.1971759e-13  0              3.4605082    
   3000000   12727.922      200            200            0.0046491245   0.00034641647  0              0.013600957    4.4355322e-18  0              2.1417598e-13  1.1971759e-13  0              3.4605082    
Loop time of 534.091 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4853109.930 ns/day, 0.000 hours/ns, 5617.025 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.691     | 75.7       | 129.47     | 605.8 | 14.17
Neigh   | 2.9746     | 3.0099     | 3.0451     |   1.5 |  0.56
Comm    | 15.109     | 21.011     | 25.409     |  91.1 |  3.93
Output  | 0.43121    | 0.43189    | 0.43254    |   0.1 |  0.08
Modify  | 315.82     | 329.25     | 342.26     |  68.8 | 61.65
Other   |            | 104.7      |            |       | 19.60

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         662.25 ave        1325 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2649
Ave neighs/atom = 0.52969406
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.94                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.4546997755443
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.04
  ghost atom cutoff = 4.04
  binsize = 2.02, bins = 6301 100 100
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 79.33 | 79.35 | 79.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00021820657  5.9371134e-40  0             -0.00065461971  1198433.4      0              5.786806e+10   1.1971759e-13  0              3.5341931    
    200000   12727.922      200            200           -0.0002853386  -5.0772868e-35  0             -0.00085601579  41403.13       0              1.999209e+09   1.1971759e-13  0              3.6111139    
    300000   12727.922      200            200            1.7816419e-05  3.3043609e-40  0              5.3449258e-05  120.01497      0              5795093.6      1.1971759e-13  0              3.5073423    
    400000   12727.922      200            200            5.160093e-05   5.0773291e-35  0              0.00015480279  985.80622      0              47601054       1.1971759e-13  0              3.4746668    
    500000   12727.922      200            200            0.0011205139   2.8125894e-05  0              0.0033334157   585.01197      0              28248135       1.1971759e-13  0              3.4677416    
    600000   12727.922      200            200            0.004897554    0.0004180581   0              0.014274604    325.19189      0              15702352       1.1971759e-13  0              3.4653909    
    700000   12727.922      200            200            0.00460263     0.00036921435  0              0.013438676    43.844093      0              2117074.3      1.1971759e-13  0              3.4655358    
    800000   12727.922      200            200            0.0045501796   0.0003746619   0              0.013275877    4.5113816      0              217838.47      1.1971759e-13  0              3.4655664    
    900000   12727.922      200            200            0.0045860561   0.00034971561  0              0.013408453    0.25302902     0              12217.866      1.1971759e-13  0              3.4655457    
   1000000   12727.922      200            200            0.0046258965   0.00034998502  0              0.013527704    0.0021672374   0              104.64814      1.1971759e-13  0              3.4655263    
   1100000   12727.922      200            200            0.0046458517   0.00034961393  0              0.013587941    0.0013080347   0              63.160312      1.1971759e-13  0              3.4655165    
   1200000   12727.922      200            200            0.004653669    0.00034946756  0              0.01361154     0.00090623529  0              43.758859      1.1971759e-13  0              3.4655126    
   1300000   12727.922      200            200            0.004656146    0.0003494208   0              0.013619017    0.00022517743  0              10.873012      1.1971759e-13  0              3.4655113    
   1400000   12727.922      200            200            0.0046567304   0.00034940959  0              0.013620782    3.432408e-05   0              1.657387       1.1971759e-13  0              3.465511     
   1500000   12727.922      200            200            0.0046567834   0.00034940846  0              0.013620942    3.425407e-06   0              0.16540065     1.1971759e-13  0              3.465511     
   1600000   12727.922      200            200            0.00465674     0.00034940923  0              0.013620811    1.8885478e-07  0              0.0091191212   1.1971759e-13  0              3.465511     
   1700000   12727.922      200            200            0.0046567042   0.00034940988  0              0.013620703    1.4638581e-09  0              7.0684468e-05  1.1971759e-13  0              3.465511     
   1800000   12727.922      200            200            0.0046566864   0.00034941021  0              0.013620649    1.0952152e-09  0              5.2884024e-05  1.1971759e-13  0              3.465511     
   1900000   12727.922      200            200            0.0046566795   0.00034941034  0              0.013620628    7.2735323e-10  0              3.5121284e-05  1.1971759e-13  0              3.4655111    
   2000000   12727.922      200            200            0.0046566773   0.00034941038  0              0.013620621    1.7821017e-10  0              8.6051311e-06  1.1971759e-13  0              3.4655111    
   2100000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     2.690635e-11   0              1.2992113e-06  1.1971759e-13  0              3.4655111    
   2200000   12727.922      200            200            0.0046566767   0.00034941039  0              0.01362062     2.6580535e-12  0              1.2834789e-07  1.1971759e-13  0              3.4655111    
   2300000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     1.4466226e-13  0              6.9852228e-09  1.1971759e-13  0              3.4655111    
   2400000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     8.7934668e-16  0              4.2460504e-11  1.1971759e-13  0              3.4655111    
   2500000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     9.8842348e-16  0              4.7727432e-11  1.1971759e-13  0              3.4655111    
   2600000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     5.8859236e-16  0              2.8421019e-11  1.1971759e-13  0              3.4655111    
   2700000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     1.5145793e-16  0              7.3133614e-12  1.1971759e-13  0              3.4655111    
   2800000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     2.6621147e-19  0              1.2854399e-14  1.1971759e-13  0              3.4655111    
   2900000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     5.5441868e-18  0              2.6770894e-13  1.1971759e-13  0              3.4655111    
   3000000   12727.922      200            200            0.0046566768   0.00034941039  0              0.01362062     1.0540536e-17  0              5.0896474e-13  1.1971759e-13  0              3.4655111    
Loop time of 532.887 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4864072.574 ns/day, 0.000 hours/ns, 5629.714 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.208     | 75.824     | 130.67     | 610.9 | 14.23
Neigh   | 2.8116     | 2.8445     | 2.8779     |   1.4 |  0.53
Comm    | 14.744     | 20.692     | 24.754     |  91.9 |  3.88
Output  | 0.4087     | 0.40933    | 0.40998    |   0.1 |  0.08
Modify  | 316.37     | 328.78     | 340.94     |  64.1 | 61.70
Other   |            | 104.3      |            |       | 19.58

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         667.75 ave        1336 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2671
Ave neighs/atom = 0.53409318
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.95                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 70.9925195986076
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.05
  ghost atom cutoff = 4.05
  binsize = 2.025, bins = 6286 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.89 | 77.9 | 77.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00023199911  3.9490553e-41  0             -0.00069599732  1182923.5      0              5.711914e+10   1.1971759e-13  0              3.544316     
    200000   12727.922      200            200           -0.00027756145 -1.2693226e-35  0             -0.00083268434  38489.453      0              1.8585179e+09  1.1971759e-13  0              3.6173991    
    300000   12727.922      200            200            3.0787832e-05  1.0584035e-40  0              9.2363497e-05  351.46518      0              16970996       1.1971759e-13  0              3.5122203    
    400000   12727.922      200            200            6.6006435e-05 -2.5386495e-35  0              0.0001980193   1586.2629      0              76594959       1.1971759e-13  0              3.4793656    
    500000   12727.922      200            200            0.00092005475 -3.2331303e-05  0              0.0027924956   279.36795      0              13489678       1.1971759e-13  0              3.4729416    
    600000   12727.922      200            200            0.0044703091   0.00036925694  0              0.01304167     326.25594      0              15753732       1.1971759e-13  0              3.4705988    
    700000   12727.922      200            200            0.0044336888   0.00034813133  0              0.012952935    38.522138      0              1860096.2      1.1971759e-13  0              3.4706231    
    800000   12727.922      200            200            0.0045028088   0.00038160428  0              0.013126822    2.7358322      0              132103.55      1.1971759e-13  0              3.4705976    
    900000   12727.922      200            200            0.0045829177   0.00035669684  0              0.013392056    0.048035965    0              2319.4848      1.1971759e-13  0              3.4705547    
   1000000   12727.922      200            200            0.0046348487   0.00035501617  0              0.01354953     0.0063589598   0              307.05141      1.1971759e-13  0              3.4705289    
   1100000   12727.922      200            200            0.0046565251   0.00035461782  0              0.013614957    0.006407631    0              309.40157      1.1971759e-13  0              3.4705181    
   1200000   12727.922      200            200            0.0046635119   0.0003544885   0              0.013636047    0.0016875892   0              81.487642      1.1971759e-13  0              3.4705146    
   1300000   12727.922      200            200            0.0046651318   0.00035445802  0              0.013640937    0.00025236105  0              12.185612      1.1971759e-13  0              3.4705138    
   1400000   12727.922      200            200            0.0046652438   0.00035445561  0              0.013641276    2.2888126e-05  0              1.1051857      1.1971759e-13  0              3.4705137    
   1500000   12727.922      200            200            0.004665099    0.00035445814  0              0.013640839    9.3919034e-07  0              0.04535014     1.1971759e-13  0              3.4705138    
   1600000   12727.922      200            200            0.00466499     0.0003544601   0              0.01364051     1.9373794e-10  0              9.3549117e-06  1.1971759e-13  0              3.4705139    
   1700000   12727.922      200            200            0.0046649389   0.00035446103  0              0.013640356    1.9352494e-08  0              0.00093446268  1.1971759e-13  0              3.4705139    
   1800000   12727.922      200            200            0.0046649203   0.00035446137  0              0.0136403      7.8004378e-09  0              0.00037665522  1.1971759e-13  0              3.4705139    
   1900000   12727.922      200            200            0.0046649151   0.00035446147  0              0.013640284    1.4887953e-09  0              7.1888596e-05  1.1971759e-13  0              3.4705139    
   2000000   12727.922      200            200            0.0046649143   0.00035446148  0              0.013640281    1.7315978e-10  0              8.3612662e-06  1.1971759e-13  0              3.4705139    
   2100000   12727.922      200            200            0.0046649144   0.00035446148  0              0.013640282    1.123003e-11   0              5.4225797e-07  1.1971759e-13  0              3.4705139    
   2200000   12727.922      200            200            0.0046649146   0.00035446148  0              0.013640282    1.648776e-13   0              7.9613492e-09  1.1971759e-13  0              3.4705139    
   2300000   12727.922      200            200            0.0046649147   0.00035446148  0              0.013640283    3.4713837e-14  0              1.676207e-09   1.1971759e-13  0              3.4705139    
   2400000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    3.0565526e-14  0              1.4758999e-09  1.1971759e-13  0              3.4705139    
   2500000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    7.8975487e-15  0              3.8134436e-10  1.1971759e-13  0              3.4705139    
   2600000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    1.1576309e-15  0              5.5897854e-11  1.1971759e-13  0              3.4705139    
   2700000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    2.1813676e-17  0              1.0533043e-12  1.1971759e-13  0              3.4705139    
   2800000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    2.0311356e-17  0              9.8076268e-13  1.1971759e-13  0              3.4705139    
   2900000   12727.922      200            200            0.0046649148   0.00035446148  0              0.013640283    1.3254706e-19  0              6.4002233e-15  1.1971759e-13  0              3.4705139    
   3000000   12727.922      200            200            0.0046649148   0.00035446147  0              0.013640283    8.6706708e-19  0              4.1867566e-14  1.1971759e-13  0              3.4705139    
Loop time of 535.839 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4837276.705 ns/day, 0.000 hours/ns, 5598.700 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.513     | 76.199     | 130.68     | 612.3 | 14.22
Neigh   | 2.7133     | 2.7456     | 2.7783     |   1.4 |  0.51
Comm    | 14.603     | 20.529     | 25.045     |  92.9 |  3.83
Output  | 0.38947    | 0.39009    | 0.39073    |   0.1 |  0.07
Modify  | 319.34     | 331.44     | 343.27     |  63.6 | 61.85
Other   |            | 104.5      |            |       | 19.51

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         673.75 ave        1348 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2695
Ave neighs/atom = 0.53889222
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.96                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 71.5330694656869
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.06
  ghost atom cutoff = 4.06
  binsize = 2.03, bins = 6270 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.72 | 77.73 | 77.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00024557241 -1.015455e-34   0             -0.00073671724  1167523.9      0              5.637555e+10   1.1971759e-13  0              3.5544082    
    200000   12727.922      200            200           -0.00026960658 -6.3466176e-36  0             -0.00080881975  35684.636      0              1.7230834e+09  1.1971759e-13  0              3.6236364    
    300000   12727.922      200            200            4.3937041e-05 -2.5386409e-35  0              0.00013181112  703.86581      0              33987161       1.1971759e-13  0              3.5170371    
    400000   12727.922      200            200            8.0611431e-05  2.53866e-35    0              0.00024183429  2327.6595      0              1.1239435e+08  1.1971759e-13  0              3.4839919    
    500000   12727.922      200            200            0.00080921868 -6.5500255e-05  0              0.0024931563   79.808062      0              3853645.7      1.1971759e-13  0              3.4780682    
    600000   12727.922      200            200            0.0041157193   0.00045162193  0              0.011895536    291.86258      0              14092999       1.1971759e-13  0              3.4758014    
    700000   12727.922      200            200            0.0043001251   0.00037385049  0              0.012526525    28.435921      0              1373068.9      1.1971759e-13  0              3.475702     
    800000   12727.922      200            200            0.004467854    0.00037571935  0              0.013027843    1.0531861      0              50854.588      1.1971759e-13  0              3.4756206    
    900000   12727.922      200            200            0.0045895088   0.00036267429  0              0.013405852    0.0081945878   0              395.68732      1.1971759e-13  0              3.4755586    
   1000000   12727.922      200            200            0.0046485493   0.00036061493  0              0.013585033    0.037582945    0              1814.7459      1.1971759e-13  0              3.4755292    
   1100000   12727.922      200            200            0.0046689686   0.00036024321  0              0.013646662    0.012014178    0              580.12164      1.1971759e-13  0              3.475519     
   1200000   12727.922      200            200            0.0046738909   0.00036015245  0              0.01366152     0.0018827279   0              90.91019       1.1971759e-13  0              3.4755165    
   1300000   12727.922      200            200            0.0046742886   0.00036014431  0              0.013662722    0.00016576335  0              8.0041187      1.1971759e-13  0              3.4755163    
   1400000   12727.922      200            200            0.0046738838   0.00036015126  0              0.0136615      5.5975243e-06  0              0.27028442     1.1971759e-13  0              3.4755165    
   1500000   12727.922      200            200            0.0046735729   0.00036015677  0              0.013660562    4.9791418e-08  0              0.0024042494   1.1971759e-13  0              3.4755167    
   1600000   12727.922      200            200            0.0046734295   0.00036015934  0              0.013660129    2.1117454e-07  0              0.010196863    1.1971759e-13  0              3.4755167    
   1700000   12727.922      200            200            0.00467338     0.00036016024  0              0.01365998     6.8847266e-08  0              0.0033243881   1.1971759e-13  0              3.4755167    
   1800000   12727.922      200            200            0.0046733677   0.00036016046  0              0.013659943    1.1074402e-08  0              0.00053474325  1.1971759e-13  0              3.4755168    
   1900000   12727.922      200            200            0.0046733666   0.00036016049  0              0.013659939    1.0065064e-09  0              4.8600594e-05  1.1971759e-13  0              3.4755168    
   2000000   12727.922      200            200            0.0046733675   0.00036016047  0              0.013659942    3.6672264e-11  0              1.7707724e-06  1.1971759e-13  0              3.4755168    
   2100000   12727.922      200            200            0.0046733683   0.00036016046  0              0.013659944    1.6440573e-13  0              7.9385644e-09  1.1971759e-13  0              3.4755168    
   2200000   12727.922      200            200            0.0046733686   0.00036016045  0              0.013659945    1.146504e-12   0              5.5360574e-08  1.1971759e-13  0              3.4755168    
   2300000   12727.922      200            200            0.0046733687   0.00036016045  0              0.013659946    3.9248663e-13  0              1.8951775e-08  1.1971759e-13  0              3.4755168    
   2400000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    6.5124302e-14  0              3.1446195e-09  1.1971759e-13  0              3.4755168    
   2500000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    6.2039908e-15  0              2.9956851e-10  1.1971759e-13  0              3.4755168    
   2600000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    2.7810807e-16  0              1.3428843e-11  1.1971759e-13  0              3.4755168    
   2700000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    5.1381267e-17  0              2.4810175e-12  1.1971759e-13  0              3.4755168    
   2800000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    9.121425e-18   0              4.4044097e-13  1.1971759e-13  0              3.4755168    
   2900000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    5.5128002e-18  0              2.6619339e-13  1.1971759e-13  0              3.4755168    
   3000000   12727.922      200            200            0.0046733688   0.00036016045  0              0.013659946    6.3833156e-19  0              3.0822746e-14  1.1971759e-13  0              3.4755168    
Loop time of 535.065 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4844275.739 ns/day, 0.000 hours/ns, 5606.801 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.391     | 76.03      | 130.19     | 610.2 | 14.21
Neigh   | 2.7358     | 2.7682     | 2.8022     |   1.4 |  0.52
Comm    | 14.522     | 20.493     | 25.064     |  92.7 |  3.83
Output  | 0.40759    | 0.40821    | 0.40885    |   0.1 |  0.08
Modify  | 316.63     | 329.95     | 342.48     |  69.0 | 61.67
Other   |            | 105.4      |            |       | 19.70

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         679.25 ave        1359 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2717
Ave neighs/atom = 0.54329134
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.97                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.076356288286
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.07
  ghost atom cutoff = 4.07
  binsize = 2.035, bins = 6255 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.58 | 77.59 | 77.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00025892707  1.6511307e-40  0             -0.0007767812   1152234.5      0              5.5637282e+10  1.1971759e-13  0              3.5644696    
    200000   12727.922      200            200           -0.00026147494  1.0154667e-34  0             -0.00078442483  32988.386      0              1.5928911e+09  1.1971759e-13  0              3.6298256    
    300000   12727.922      200            200            5.7262766e-05  5.0773204e-35  0              0.0001717883   1176.7873      0              56822849       1.1971759e-13  0              3.5217925    
    400000   12727.922      200            200            9.5414214e-05 -5.0772958e-35  0              0.00028624264  3209.3698      0              1.5496898e+08  1.1971759e-13  0              3.4885456    
    500000   12727.922      200            200            0.00078495886 -5.0548951e-05  0              0.0024054255   1.0067341      0              48611.587      1.1971759e-13  0              3.4831192    
    600000   12727.922      200            200            0.0037867833   0.00046916848  0              0.010891181    230.86534      0              11147661       1.1971759e-13  0              3.4809879    
    700000   12727.922      200            200            0.0041838803   0.00036282451  0              0.012188816    16.576574      0              800423.44      1.1971759e-13  0              3.4807669    
    800000   12727.922      200            200            0.0044561565   0.00037877344  0              0.012989696    0.091070172    0              4397.4527      1.1971759e-13  0              3.4806335    
    900000   12727.922      200            200            0.0046057947   0.0003668256   0              0.013450558    0.15083776     0              7283.4156      1.1971759e-13  0              3.4805575    
   1000000   12727.922      200            200            0.0046657563   0.00036537378  0              0.013631895    0.077593209    0              3746.6984      1.1971759e-13  0              3.4805276    
   1100000   12727.922      200            200            0.0046820068   0.000365087    0              0.013680933    0.014167712    0              684.10811      1.1971759e-13  0              3.4805195    
   1200000   12727.922      200            200            0.0046839566   0.00036504843  0              0.013686821    0.0012962936   0              62.593377      1.1971759e-13  0              3.4805184    
   1300000   12727.922      200            200            0.0046829826   0.00036506542  0              0.013683882    3.858794e-05   0              1.8632735      1.1971759e-13  0              3.4805189    
   1400000   12727.922      200            200            0.0046821185   0.00036508101  0              0.013681274    1.0117282e-06  0              0.048852732    1.1971759e-13  0              3.4805193    
   1500000   12727.922      200            200            0.0046817165   0.00036508795  0              0.013680061    2.1132726e-06  0              0.10204237     1.1971759e-13  0              3.4805195    
   1600000   12727.922      200            200            0.0046815848   0.00036509026  0              0.013679664    5.787937e-07   0              0.027947876    1.1971759e-13  0              3.4805196    
   1700000   12727.922      200            200            0.0046815576   0.00036509074  0              0.013679582    7.4896113e-08  0              0.0036164653   1.1971759e-13  0              3.4805196    
   1800000   12727.922      200            200            0.0046815585   0.00036509073  0              0.013679585    4.4246574e-09  0              0.00021365087  1.1971759e-13  0              3.4805196    
   1900000   12727.922      200            200            0.0046815627   0.00036509066  0              0.013679598    1.8091543e-11  0              8.7357585e-07  1.1971759e-13  0              3.4805196    
   2000000   12727.922      200            200            0.0046815652   0.00036509062  0              0.013679605    3.9773061e-11  0              1.9204988e-06  1.1971759e-13  0              3.4805196    
   2100000   12727.922      200            200            0.0046815662   0.0003650906   0              0.013679608    1.9877271e-11  0              9.5980228e-07  1.1971759e-13  0              3.4805196    
   2200000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    3.6112434e-12  0              1.7437402e-07  1.1971759e-13  0              3.4805196    
   2300000   12727.922      200            200            0.0046815665   0.0003650906   0              0.013679609    3.281498e-13   0              1.5845179e-08  1.1971759e-13  0              3.4805196    
   2400000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    9.4500886e-15  0              4.5631096e-10  1.1971759e-13  0              3.4805196    
   2500000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    2.4289525e-16  0              1.1728542e-11  1.1971759e-13  0              3.4805196    
   2600000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    5.3052532e-16  0              2.5617169e-11  1.1971759e-13  0              3.4805196    
   2700000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    1.3659187e-16  0              6.5955325e-12  1.1971759e-13  0              3.4805196    
   2800000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    3.1512174e-18  0              1.5216101e-13  1.1971759e-13  0              3.4805196    
   2900000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    1.0068453e-17  0              4.8616954e-13  1.1971759e-13  0              3.4805196    
   3000000   12727.922      200            200            0.0046815664   0.0003650906   0              0.013679609    5.2868261e-18  0              2.5528191e-13  1.1971759e-13  0              3.4805196    
Loop time of 533.861 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4855194.477 ns/day, 0.000 hours/ns, 5619.438 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.763     | 76.349     | 131.44     | 611.6 | 14.30
Neigh   | 2.697      | 2.7287     | 2.7617     |   1.4 |  0.51
Comm    | 14.673     | 20.412     | 24.599     |  92.9 |  3.82
Output  | 0.40997    | 0.41061    | 0.41127    |   0.1 |  0.08
Modify  | 317.05     | 329.34     | 341.38     |  63.6 | 61.69
Other   |            | 104.6      |            |       | 19.60

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         685.25 ave        1371 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2741
Ave neighs/atom = 0.54809038
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.98                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 72.6223869779087
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.08
  ghost atom cutoff = 4.08
  binsize = 2.04, bins = 6240 99 99
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 77.41 | 77.42 | 77.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00027206366 -2.5386461e-35  0             -0.00081619098  1137055.2      0              5.4904326e+10  1.1971759e-13  0              3.5745002    
    200000   12727.922      200            200           -0.00025316743 -5.0772349e-35  0             -0.00075950228  30400.4        0              1.4679265e+09  1.1971759e-13  0              3.6359668    
    300000   12727.922      200            200            7.0763745e-05  1.2693264e-35  0              0.00021229124  1769.8018      0              85457397       1.1971759e-13  0              3.5264863    
    400000   12727.922      200            200            0.00011041308 -2.5386394e-35  0              0.00033123924  4230.7701      0              2.0428874e+08  1.1971759e-13  0              3.4930266    
    500000   12727.922      200            200            0.00082191306 -5.145958e-05   0              0.0025171988   48.062476      0              2320765        1.1971759e-13  0              3.4880935    
    600000   12727.922      200            200            0.0035054501   0.00044822143  0              0.010068129    156.97533      0              7579776.7      1.1971759e-13  0              3.4861486    
    700000   12727.922      200            200            0.0041023403   0.00034520931  0              0.011961812    6.3495588      0              306597.47      1.1971759e-13  0              3.4858133    
    800000   12727.922      200            200            0.0044670206   0.00038347228  0              0.01301759     0.20224471     0              9765.6733      1.1971759e-13  0              3.4856354    
    900000   12727.922      200            200            0.0046315537   0.00037143867  0              0.013523222    0.40731151     0              19667.615      1.1971759e-13  0              3.4855517    
   1000000   12727.922      200            200            0.0046853154   0.00036988575  0              0.01368606     0.10302013     0              4974.4732      1.1971759e-13  0              3.4855248    
   1100000   12727.922      200            200            0.0046949137   0.00036969472  0              0.013715046    0.011273493    0              544.35665      1.1971759e-13  0              3.4855199    
   1200000   12727.922      200            200            0.0046934034   0.00036972114  0              0.013710489    0.0004121129   0              19.899457      1.1971759e-13  0              3.4855206    
   1300000   12727.922      200            200            0.0046912037   0.00036976251  0              0.013703849    4.5803904e-06  0              0.22117066     1.1971759e-13  0              3.4855217    
   1400000   12727.922      200            200            0.004690093    0.00036978198  0              0.013700497    1.6016481e-05  0              0.77337856     1.1971759e-13  0              3.4855222    
   1500000   12727.922      200            200            0.0046897256   0.00036978851  0              0.013699388    4.4136724e-06  0              0.21312045     1.1971759e-13  0              3.4855224    
   1600000   12727.922      200            200            0.0046896555   0.00036978979  0              0.013699177    5.1331064e-07  0              0.024785934    1.1971759e-13  0              3.4855224    
   1700000   12727.922      200            200            0.004689663    0.00036978968  0              0.013699199    2.1177888e-08  0              0.0010226044   1.1971759e-13  0              3.4855224    
   1800000   12727.922      200            200            0.0046896768   0.00036978944  0              0.013699241    8.7104131e-11  0              4.2059468e-06  1.1971759e-13  0              3.4855224    
   1900000   12727.922      200            200            0.0046896841   0.00036978931  0              0.013699263    6.3022535e-10  0              3.0431327e-05  1.1971759e-13  0              3.4855224    
   2000000   12727.922      200            200            0.0046896866   0.00036978927  0              0.01369927     1.884374e-10   0              9.0989679e-06  1.1971759e-13  0              3.4855224    
   2100000   12727.922      200            200            0.0046896871   0.00036978926  0              0.013699272    2.3256523e-11  0              1.1229743e-06  1.1971759e-13  0              3.4855224    
   2200000   12727.922      200            200            0.0046896871   0.00036978926  0              0.013699272    1.0706051e-12  0              5.1695686e-08  1.1971759e-13  0              3.4855224    
   2300000   12727.922      200            200            0.004689687    0.00036978926  0              0.013699272    8.84897e-16    0              4.2728509e-11  1.1971759e-13  0              3.4855224    
   2400000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    2.5201662e-14  0              1.216898e-09   1.1971759e-13  0              3.4855224    
   2500000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    8.0802575e-15  0              3.9016672e-10  1.1971759e-13  0              3.4855224    
   2600000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    1.0480489e-15  0              5.0606532e-11  1.1971759e-13  0              3.4855224    
   2700000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    3.5065107e-19  0              1.6931685e-14  1.1971759e-13  0              3.4855224    
   2800000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    2.1817666e-17  0              1.053497e-12   1.1971759e-13  0              3.4855224    
   2900000   12727.922      200            200            0.0046896869   0.00036978926  0              0.013699271    8.3344263e-19  0              4.0243962e-14  1.1971759e-13  0              3.4855224    
   3000000   12727.922      200            200            0.0046896869   0.00036978927  0              0.013699271    6.5056607e-19  0              3.1413507e-14  1.1971759e-13  0              3.4855224    
Loop time of 539.187 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4807233.363 ns/day, 0.000 hours/ns, 5563.928 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.891     | 77.131     | 133.04     | 614.1 | 14.31
Neigh   | 2.7252     | 2.7576     | 2.7912     |   1.4 |  0.51
Comm    | 14.471     | 20.508     | 25.14      |  95.2 |  3.80
Output  | 0.41225    | 0.41289    | 0.41353    |   0.1 |  0.08
Modify  | 318.48     | 331.63     | 346.06     |  68.7 | 61.51
Other   |            | 106.7      |            |       | 19.80

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         690.25 ave        1381 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2761
Ave neighs/atom = 0.55208958
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(0*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 1000*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 ${n1e1} -100 100 -100 100 units box
region box block -6363.96103067894 6363.96103067894 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -6363.96103067894 6363.96103067894 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 3000 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -3000 3000 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 2001 atoms
  using lattice units in orthogonal box = (-6363.961 -100 -100) to (6363.961 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3.99                    
Setting atom values ...
  3000 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.171168446059
Setting atom values ...
  3000 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  2001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  2001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
3000 atoms in group substrate
group slider1 region slider1
2001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
5001 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 2001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.09
  ghost atom cutoff = 4.09
  binsize = 2.045, bins = 6224 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 76.01 | 76.02 | 76.04 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   12727.922      200            200            0              0              0              0              0              0              0              1.1971759e-13  0              6            
    100000   12727.922      200            200           -0.00028498279 -3.0463649e-34  0             -0.00085494837  1121985.7      0              5.4176672e+10  1.1971759e-13  0              3.5845       
    200000   12727.922      200            200           -0.00024468497  1.7297321e-41  0             -0.0007340549   27920.386      0              1.3481755e+09  1.1971759e-13  0              3.6420598    
    300000   12727.922      200            200            8.4438675e-05 -1.015457e-34   0              0.00025331602  2482.4803      0              1.1987009e+08  1.1971759e-13  0              3.5311184    
    400000   12727.922      200            200            0.00012560626 -2.5386458e-35  0              0.00037681879  5391.234       0              2.603234e+08   1.1971759e-13  0              3.4974347    
    500000   12727.922      200            200            0.00093195365 -4.0365897e-05  0              0.0028362268   217.05581      0              10480848       1.1971759e-13  0              3.4929916    
    600000   12727.922      200            200            0.0032617183   0.00033438223  0              0.0094507727   85.565045      0              4131629.8      1.1971759e-13  0              3.4912756    
    700000   12727.922      200            200            0.0040617052   0.00032486634  0              0.011860249    0.62673155     0              30262.624      1.1971759e-13  0              3.4908381    
    800000   12727.922      200            200            0.0044998897   0.00038877893  0              0.01311089     1.337032       0              64560.488      1.1971759e-13  0              3.4906262    
    900000   12727.922      200            200            0.004664763    0.00037675502  0              0.013617534    0.65552302     0              31652.861      1.1971759e-13  0              3.4905424    
   1000000   12727.922      200            200            0.0047060996   0.00037595444  0              0.013742344    0.098978108    0              4779.2986      1.1971759e-13  0              3.4905217    
   1100000   12727.922      200            200            0.0047073738   0.00037592249  0              0.013746199    0.0053961842   0              260.56242      1.1971759e-13  0              3.4905209    
   1200000   12727.922      200            200            0.0047025242   0.00037601055  0              0.013731562    4.2003748e-08  0              0.0020282107   1.1971759e-13  0              3.4905232    
   1300000   12727.922      200            200            0.0046995445   0.0003760616   0              0.013722572    9.4907248e-05  0              4.5827313      1.1971759e-13  0              3.4905246    
   1400000   12727.922      200            200            0.0046984736   0.00037607921  0              0.013719342    3.2003105e-05  0              1.5453154      1.1971759e-13  0              3.4905252    
   1500000   12727.922      200            200            0.0046982547   0.0003760829   0              0.013718681    3.8473018e-06  0              0.18577244     1.1971759e-13  0              3.4905253    
   1600000   12727.922      200            200            0.004698272    0.00037608266  0              0.013718733    1.3995729e-07  0              0.0067580365   1.1971759e-13  0              3.4905253    
   1700000   12727.922      200            200            0.0046983114   0.00037608203  0              0.013718852    2.2187618e-09  0              0.00010713607  1.1971759e-13  0              3.4905253    
   1800000   12727.922      200            200            0.0046983318   0.0003760817   0              0.013718914    5.9966544e-09  0              0.00028955698  1.1971759e-13  0              3.4905252    
   1900000   12727.922      200            200            0.0046983383   0.00037608159  0              0.013718933    1.4765156e-09  0              7.1295654e-05  1.1971759e-13  0              3.4905252    
   2000000   12727.922      200            200            0.0046983393   0.00037608157  0              0.013718936    1.3947922e-10  0              6.7349523e-06  1.1971759e-13  0              3.4905252    
   2100000   12727.922      200            200            0.0046983391   0.00037608158  0              0.013718936    2.7798858e-12  0              1.3423074e-07  1.1971759e-13  0              3.4905252    
   2200000   12727.922      200            200            0.0046983388   0.00037608158  0              0.013718935    3.8612488e-13  0              1.8644589e-08  1.1971759e-13  0              3.4905252    
   2300000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    3.3964731e-13  0              1.6400353e-08  1.1971759e-13  0              3.4905252    
   2400000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    6.4390955e-14  0              3.1092088e-09  1.1971759e-13  0              3.4905252    
   2500000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    4.646568e-15   0              2.2436614e-10  1.1971759e-13  0              3.4905252    
   2600000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    3.6179211e-17  0              1.7469646e-12  1.1971759e-13  0              3.4905252    
   2700000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    1.2079598e-16  0              5.8328057e-12  1.1971759e-13  0              3.4905252    
   2800000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    5.2217768e-19  0              2.5214091e-14  1.1971759e-13  0              3.4905252    
   2900000   12727.922      200            200            0.0046983386   0.00037608158  0              0.013718934    4.3988207e-18  0              2.1240331e-13  1.1971759e-13  0              3.4905252    
   3000000   12727.922      200            200            0.0046983386   0.00037608159  0              0.013718934    6.8688356e-19  0              3.3167149e-14  1.1971759e-13  0              3.4905252    
Loop time of 540.345 on 4 procs for 3000000 steps with 5001 atoms

Performance: 4796939.679 ns/day, 0.000 hours/ns, 5552.014 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.512     | 77.272     | 132.63     | 619.7 | 14.30
Neigh   | 2.709      | 2.7426     | 2.7771     |   1.5 |  0.51
Comm    | 14.617     | 20.636     | 25.203     |  93.7 |  3.82
Output  | 0.39393    | 0.39455    | 0.39519    |   0.1 |  0.07
Modify  | 322.48     | 334.14     | 346.35     |  59.0 | 61.84
Other   |            | 105.2      |            |       | 19.46

Nlocal:        1250.25 ave        1752 max         749 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         695.25 ave        1391 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2781
Ave neighs/atom = 0.55608878
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 15:04:23

LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 73.7227076042404
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.1
  ghost atom cutoff = 4.1
  binsize = 2.05, bins = 3105 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.43 | 44.44 | 44.44 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0002965533   5.0774281e-35  0             -0.0008896599   554767.77      0              5.35755e+10    1.1965779e-13  0              3.5939312    
    200000   6363.961       200            200           -0.00023890292  2.5387224e-35  0             -0.00071670877  13133.732      0              1.2683619e+09  1.1965779e-13  0              3.6478593    
    300000   6363.961       200            200            8.9867103e-05  5.0774257e-35  0              0.00026960131  1394.9466      0              1.3471395e+08  1.1965779e-13  0              3.5359843    
    400000   6363.961       200            200            0.00012213693  5.077315e-35   0              0.00036641078  2548.4965      0              2.4611555e+08  1.1965779e-13  0              3.5025951    
    500000   6363.961       200            200            0.00060104645 -0.00063760965  0              0.002440749    6.0801267      0              587175.11      1.1965779e-13  0              3.4981248    
    600000   6363.961       200            200            0.0032422378  -0.0025233948   0              0.012250108    151.16256      0              14598198       1.1965779e-13  0              3.4957684    
    700000   6363.961       200            200            0.003714473   -0.0024029699   0              0.013546389    21.83137       0              2108317.5      1.1965779e-13  0              3.4955583    
    800000   6363.961       200            200            0.0037370664  -0.0024421649   0              0.013653364    2.918748       0              281871.79      1.1965779e-13  0              3.495544     
    900000   6363.961       200            200            0.0037531477  -0.002441925    0              0.013701368    0.38863903     0              37531.976      1.1965779e-13  0              3.4955373    
   1000000   6363.961       200            200            0.0037611158  -0.0024425891   0              0.013725936    0.05170087     0              4992.9         1.1965779e-13  0              3.4955337    
   1100000   6363.961       200            200            0.0037646418  -0.0024428931   0              0.013736819    0.0068330682   0              659.88881      1.1965779e-13  0              3.4955321    
   1200000   6363.961       200            200            0.0037662267  -0.0024430258   0              0.013741706    0.00089709819  0              86.635322      1.1965779e-13  0              3.4955314    
   1300000   6363.961       200            200            0.0037669315  -0.0024430796   0              0.013743874    0.00011714427  0              11.312955      1.1965779e-13  0              3.495531     
   1400000   6363.961       200            200            0.0037672343  -0.0024431052   0              0.013744808    1.5214402e-05  0              1.469298       1.1965779e-13  0              3.4955309    
   1500000   6363.961       200            200            0.0037673617  -0.002443116    0              0.013745201    1.9650176e-06  0              0.18976733     1.1965779e-13  0              3.4955308    
   1600000   6363.961       200            200            0.0037674143  -0.0024431205   0              0.013745363    2.5232311e-07  0              0.02436756     1.1965779e-13  0              3.4955308    
   1700000   6363.961       200            200            0.0037674357  -0.0024431224   0              0.013745429    3.2203425e-08  0              0.0031099763   1.1965779e-13  0              3.4955308    
   1800000   6363.961       200            200            0.0037674443  -0.0024431231   0              0.013745456    4.0836826e-09  0              0.00039437284  1.1965779e-13  0              3.4955308    
   1900000   6363.961       200            200            0.0037674478  -0.0024431234   0              0.013745467    5.1429118e-10  0              4.9666561e-05  1.1965779e-13  0              3.4955308    
   2000000   6363.961       200            200            0.0037674491  -0.0024431235   0              0.013745471    6.4296913e-11  0              6.2093356e-06  1.1965779e-13  0              3.4955308    
   2100000   6363.961       200            200            0.0037674496  -0.0024431236   0              0.013745472    7.9753265e-12  0              7.7019995e-07  1.1965779e-13  0              3.4955308    
   2200000   6363.961       200            200            0.0037674498  -0.0024431236   0              0.013745473    9.8065955e-13  0              9.470508e-08   1.1965779e-13  0              3.4955308    
   2300000   6363.961       200            200            0.0037674499  -0.0024431236   0              0.013745473    1.1936813e-13  0              1.152772e-08   1.1965779e-13  0              3.4955308    
   2400000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745473    1.4184436e-14  0              1.3698313e-09  1.1965779e-13  0              3.4955308    
   2500000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745473    1.6629495e-15  0              1.6059576e-10  1.1965779e-13  0              3.4955308    
   2600000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745474    1.6134319e-16  0              1.5581371e-11  1.1965779e-13  0              3.4955308    
   2700000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745474    3.5512563e-19  0              3.4295492e-14  1.1965779e-13  0              3.4955308    
   2800000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745474    6.6141756e-18  0              6.3874973e-13  1.1965779e-13  0              3.4955308    
   2900000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745474    2.0553947e-18  0              1.9849531e-13  1.1965779e-13  0              3.4955308    
   3000000   6363.961       200            200            0.00376745    -0.0024431236   0              0.013745474    3.7472677e-18  0              3.6188429e-13  1.1965779e-13  0              3.4955308    
Loop time of 304.051 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8524891.796 ns/day, 0.000 hours/ns, 9866.773 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.861     | 41.981     | 73.294     | 464.3 | 13.81
Neigh   | 1.352      | 1.3718     | 1.389      |   1.2 |  0.45
Comm    | 12.839     | 17.713     | 24.238     | 105.4 |  5.83
Output  | 0.24298    | 0.24335    | 0.24376    |   0.1 |  0.08
Modify  | 180.5      | 184.23     | 188.07     |  21.9 | 60.59
Other   |            | 58.52      |            |       | 19.25

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         350.75 ave         702 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1403
Ave neighs/atom = 0.56097561
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.01                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 74.2770113639572
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.11
  ghost atom cutoff = 4.11
  binsize = 2.055, bins = 3097 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.35 | 44.36 | 44.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00030907303  2.0310434e-34  0             -0.0009272191   547330.33      0              5.2857246e+10  1.1965779e-13  0              3.603874     
    200000   6363.961       200            200           -0.00023011194 -1.5231843e-34  0             -0.00069033581  11983.967      0              1.1573258e+09  1.1965779e-13  0              3.6538707    
    300000   6363.961       200            200            0.00010381356  1.2693303e-35  0              0.00031144067  1834.5035      0              1.7716321e+08  1.1965779e-13  0              3.5405303    
    400000   6363.961       200            200            0.00013754149 -5.0772014e-35  0              0.00041262446  3182.8392      0              3.0737583e+08  1.1965779e-13  0              3.5069466    
    500000   6363.961       200            200            0.00067188306 -0.00065452684  0              0.002670176    64.983795      0              6275669.8      1.1965779e-13  0              3.5030555    
    600000   6363.961       200            200            0.0029109659  -0.0024733093   0              0.011206207    123.4568       0              11922574       1.1965779e-13  0              3.5009596    
    700000   6363.961       200            200            0.0035527441  -0.0024060948   0              0.013064327    19.123025      0              1846764.9      1.1965779e-13  0              3.5006448    
    800000   6363.961       200            200            0.0036844641  -0.0024131781   0              0.01346657     2.438986       0              235539.81      1.1965779e-13  0              3.500581     
    900000   6363.961       200            200            0.0037346819  -0.0024333014   0              0.013637347    0.30328703     0              29289.29       1.1965779e-13  0              3.5005539    
   1000000   6363.961       200            200            0.0037587752  -0.0024354093   0              0.013711735    0.03705856     0              3578.8505      1.1965779e-13  0              3.5005421    
   1100000   6363.961       200            200            0.0037688866  -0.0024363421   0              0.013743002    0.0043687953   0              421.90698      1.1965779e-13  0              3.5005371    
   1200000   6363.961       200            200            0.003773133   -0.0024367306   0              0.01375613     0.00049851389  0              48.142903      1.1965779e-13  0              3.500535     
   1300000   6363.961       200            200            0.0037748848  -0.0024368834   0              0.013761538    5.4910999e-05  0              5.3029112      1.1965779e-13  0              3.5005341    
   1400000   6363.961       200            200            0.0037755928  -0.0024369453   0              0.013763724    5.7953881e-06  0              0.5596771      1.1965779e-13  0              3.5005338    
   1500000   6363.961       200            200            0.0037758742  -0.0024369699   0              0.013764592    5.791529e-07   0              0.055930442    1.1965779e-13  0              3.5005336    
   1600000   6363.961       200            200            0.0037759845  -0.0024369796   0              0.013764933    5.3751298e-08  0              0.0051909156   1.1965779e-13  0              3.5005336    
   1700000   6363.961       200            200            0.0037760272  -0.0024369834   0              0.013765065    4.4766995e-09  0              0.00043232759  1.1965779e-13  0              3.5005336    
   1800000   6363.961       200            200            0.0037760435  -0.0024369848   0              0.013765115    3.1194868e-10  0              3.012577e-05   1.1965779e-13  0              3.5005335    
   1900000   6363.961       200            200            0.0037760497  -0.0024369854   0              0.013765134    1.5154702e-11  0              1.4635326e-06  1.1965779e-13  0              3.5005335    
   2000000   6363.961       200            200            0.003776052   -0.0024369856   0              0.013765142    2.1635196e-13  0              2.0893723e-08  1.1965779e-13  0              3.5005335    
   2100000   6363.961       200            200            0.0037760529  -0.0024369856   0              0.013765144    3.4133116e-14  0              3.296332e-09   1.1965779e-13  0              3.5005335    
   2200000   6363.961       200            200            0.0037760532  -0.0024369857   0              0.013765145    3.9321985e-14  0              3.7974358e-09  1.1965779e-13  0              3.5005335    
   2300000   6363.961       200            200            0.0037760533  -0.0024369857   0              0.013765146    1.4134904e-14  0              1.3650478e-09  1.1965779e-13  0              3.5005335    
   2400000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    3.6663262e-15  0              3.5406754e-10  1.1965779e-13  0              3.5005335    
   2500000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    8.3583322e-16  0              8.071879e-11   1.1965779e-13  0              3.5005335    
   2600000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    1.8268114e-16  0              1.7642037e-11  1.1965779e-13  0              3.5005335    
   2700000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    6.2199629e-17  0              6.0067949e-12  1.1965779e-13  0              3.5005335    
   2800000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    5.4935975e-18  0              5.3053233e-13  1.1965779e-13  0              3.5005335    
   2900000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    6.2460988e-18  0              6.0320351e-13  1.1965779e-13  0              3.5005335    
   3000000   6363.961       200            200            0.0037760534  -0.0024369857   0              0.013765146    6.6037041e-18  0              6.3773847e-13  1.1965779e-13  0              3.5005335    
Loop time of 294.307 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8807124.014 ns/day, 0.000 hours/ns, 10193.431 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.715     | 40.88      | 70.316     | 451.5 | 13.89
Neigh   | 1.3871     | 1.4046     | 1.4218     |   1.0 |  0.48
Comm    | 12.83      | 17.759     | 21.944     |  88.1 |  6.03
Output  | 0.24107    | 0.24138    | 0.24174    |   0.1 |  0.08
Modify  | 174.55     | 177.83     | 181.06     |  21.1 | 60.42
Other   |            | 56.19      |            |       | 19.09

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         352.75 ave         706 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1411
Ave neighs/atom = 0.56417433
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.02                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 74.8340866367129
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.12
  ghost atom cutoff = 4.12
  binsize = 2.06, bins = 3090 98 98
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 44.24 | 44.25 | 44.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00032137684  6.3466552e-36  0             -0.00096413053  539947.53      0              5.2144268e+10  1.1965779e-13  0              3.6137858    
    200000   6363.961       200            200           -0.00022114822 -6.3465843e-36  0             -0.00066344466  10887.856      0              1.0514712e+09  1.1965779e-13  0              3.6598336    
    300000   6363.961       200            200            0.00011793139  3.4467421e-40  0              0.00035379418  2333.5415      0              2.2535674e+08  1.1965779e-13  0              3.5450142    
    400000   6363.961       200            200            0.00015313829  2.7300204e-40  0              0.00045941488  3886.5151      0              3.7533181e+08  1.1965779e-13  0              3.5112248    
    500000   6363.961       200            200            0.00081153282 -0.00069128464  0              0.0031258831   182.20171      0              17595737       1.1965779e-13  0              3.5079102    
    600000   6363.961       200            200            0.002659888   -0.0023552454   0              0.010334909    87.538519      0              8453843.6      1.1965779e-13  0              3.5061273    
    700000   6363.961       200            200            0.0034030456  -0.0024312979   0              0.012640435    14.104977      0              1362157.7      1.1965779e-13  0              3.5057228    
    800000   6363.961       200            200            0.0036335712  -0.0024080845   0              0.013308798    1.610728       0              155552.59      1.1965779e-13  0              3.5056133    
    900000   6363.961       200            200            0.0037205957  -0.0024268217   0              0.013588609    0.17049909     0              16465.582      1.1965779e-13  0              3.505568     
   1000000   6363.961       200            200            0.0037584624  -0.0024301993   0              0.013705587    0.016582086    0              1601.3792      1.1965779e-13  0              3.5055491    
   1100000   6363.961       200            200            0.0037739141  -0.002431657    0              0.013753399    0.0013952089   0              134.73929      1.1965779e-13  0              3.5055414    
   1200000   6363.961       200            200            0.0037801302  -0.0024322437   0              0.013772634    9.5393505e-05  0              9.2124219      1.1965779e-13  0              3.5055383    
   1300000   6363.961       200            200            0.0037825767  -0.0024324606   0              0.013780191    4.2704883e-06  0              0.41241319     1.1965779e-13  0              3.505537     
   1400000   6363.961       200            200            0.0037835168  -0.002432544    0              0.013783095    3.476228e-08   0              0.0033570922   1.1965779e-13  0              3.5055366    
   1500000   6363.961       200            200            0.0037838709  -0.0024325755   0              0.013784188    2.0432e-08     0              0.0019731763   1.1965779e-13  0              3.5055364    
   1600000   6363.961       200            200            0.0037840017  -0.0024325871   0              0.013784592    1.6667338e-08  0              0.0016096122   1.1965779e-13  0              3.5055363    
   1700000   6363.961       200            200            0.0037840492  -0.0024325913   0              0.013784739    5.5708609e-09  0              0.00053799387  1.1965779e-13  0              3.5055363    
   1800000   6363.961       200            200            0.003784066   -0.0024325928   0              0.013784791    1.3607538e-09  0              0.00013141187  1.1965779e-13  0              3.5055363    
   1900000   6363.961       200            200            0.0037840719  -0.0024325934   0              0.013784809    2.8127223e-10  0              2.7163259e-05  1.1965779e-13  0              3.5055363    
   2000000   6363.961       200            200            0.0037840739  -0.0024325935   0              0.013784815    5.2223807e-11  0              5.0434014e-06  1.1965779e-13  0              3.5055363    
   2100000   6363.961       200            200            0.0037840746  -0.0024325936   0              0.013784817    8.971887e-12   0              8.6644063e-07  1.1965779e-13  0              3.5055363    
   2200000   6363.961       200            200            0.0037840748  -0.0024325936   0              0.013784818    1.4525179e-12  0              1.4027379e-07  1.1965779e-13  0              3.5055363    
   2300000   6363.961       200            200            0.0037840748  -0.0024325936   0              0.013784818    2.2337255e-13  0              2.1571722e-08  1.1965779e-13  0              3.5055363    
   2400000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    3.2766546e-14  0              3.1643585e-09  1.1965779e-13  0              3.5055363    
   2500000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    4.6458612e-15  0              4.4866402e-10  1.1965779e-13  0              3.5055363    
   2600000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    6.355189e-16   0              6.1373867e-11  1.1965779e-13  0              3.5055363    
   2700000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    5.0440586e-17  0              4.8711908e-12  1.1965779e-13  0              3.5055363    
   2800000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    6.4391511e-19  0              6.2184712e-14  1.1965779e-13  0              3.5055363    
   2900000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    1.3683853e-21  0              1.3214886e-16  1.1965779e-13  0              3.5055363    
   3000000   6363.961       200            200            0.0037840749  -0.0024325936   0              0.013784818    1.0051106e-18  0              9.7066392e-14  1.1965779e-13  0              3.5055363    
Loop time of 300.912 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8613825.955 ns/day, 0.000 hours/ns, 9969.706 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.296     | 41.473     | 74.241     | 460.4 | 13.78
Neigh   | 1.426      | 1.4433     | 1.4604     |   1.0 |  0.48
Comm    | 13.029     | 19.126     | 25.584     | 110.2 |  6.36
Output  | 0.24365    | 0.244      | 0.24438    |   0.1 |  0.08
Modify  | 179.56     | 181.69     | 183.55     |  12.4 | 60.38
Other   |            | 56.93      |            |       | 18.92

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         355.25 ave         711 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1421
Ave neighs/atom = 0.56817273
Neighbor list builds = 152
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.03                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 75.3939403340114
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.13
  ghost atom cutoff = 4.13
  binsize = 2.065, bins = 3082 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.55 | 43.57 | 43.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00033346528  2.5387037e-35  0             -0.0010003959   532619.3       0              5.1436559e+10  1.1965779e-13  0              3.6236667    
    200000   6363.961       200            200           -0.0002120127   7.6159535e-35  0             -0.00063603809  9845.2518      0              9.5078395e+08  1.1965779e-13  0              3.6657479    
    300000   6363.961       200            200            0.00013221934  2.5387046e-35  0              0.00039665802  2891.8486      0              2.7927404e+08  1.1965779e-13  0              3.5494358    
    400000   6363.961       200            200            0.00016892566  7.9303232e-40  0              0.00050677698  4659.216       0              4.4995374e+08  1.1965779e-13  0              3.5154294    
    500000   6363.961       200            200            0.0010394126  -0.00072712848  0              0.0038453662   348.0185       0              33609136       1.1965779e-13  0              3.5126918    
    600000   6363.961       200            200            0.0024966879  -0.0021718328   0              0.0096618965   50.962691      0              4921611.9      1.1965779e-13  0              3.5112632    
    700000   6363.961       200            200            0.0032944     -0.0024210284   0              0.012304228    8.2362941      0              795402.33      1.1965779e-13  0              3.510787     
    800000   6363.961       200            200            0.003597722   -0.0024029281   0              0.013196094    0.73798269     0              71269.086      1.1965779e-13  0              3.5106384    
    900000   6363.961       200            200            0.0037140553  -0.0024210032   0              0.013563169    0.05133819     0              4957.8749      1.1965779e-13  0              3.5105783    
   1000000   6363.961       200            200            0.0037620056  -0.0024253522   0              0.013711369    0.0021155036   0              204.3002       1.1965779e-13  0              3.5105542    
   1100000   6363.961       200            200            0.0037808258  -0.0024271627   0              0.01376964     3.8290093e-06  0              0.36977831     1.1965779e-13  0              3.5105447    
   1200000   6363.961       200            200            0.0037880059  -0.002427845    0              0.013791863    2.3288959e-05  0              2.249081       1.1965779e-13  0              3.5105411    
   1300000   6363.961       200            200            0.0037906606  -0.0024280827   0              0.013800065    1.4084312e-05  0              1.3601621      1.1965779e-13  0              3.5105398    
   1400000   6363.961       200            200            0.003791609   -0.0024281677   0              0.013802995    4.2488024e-06  0              0.41031892     1.1965779e-13  0              3.5105393    
   1500000   6363.961       200            200            0.0037919364  -0.0024281971   0              0.013804006    9.6728788e-07  0              0.09341374     1.1965779e-13  0              3.5105391    
   1600000   6363.961       200            200            0.0037920451  -0.0024282069   0              0.013804342    1.873118e-07   0              0.018089232    1.1965779e-13  0              3.5105391    
   1700000   6363.961       200            200            0.0037920795  -0.00242821     0              0.013804449    3.2453881e-08  0              0.0031341635   1.1965779e-13  0              3.510539     
   1800000   6363.961       200            200            0.0037920898  -0.002428211    0              0.01380448     5.1597544e-09  0              0.00049829215  1.1965779e-13  0              3.510539     
   1900000   6363.961       200            200            0.0037920925  -0.0024282112   0              0.013804489    7.6281822e-10  0              7.3667523e-05  1.1965779e-13  0              3.510539     
   2000000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.013804491    1.0555602e-10  0              1.0193845e-05  1.1965779e-13  0              3.510539     
   2100000   6363.961       200            200            0.0037920932  -0.0024282113   0              0.013804491    1.369923e-11   0              1.3229735e-06  1.1965779e-13  0              3.510539     
   2200000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.013804491    1.6619786e-12  0              1.60502e-07    1.1965779e-13  0              3.510539     
   2300000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.013804491    1.87097e-13    0              1.8068489e-08  1.1965779e-13  0              3.510539     
   2400000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.013804491    1.8914758e-14  0              1.826652e-09   1.1965779e-13  0              3.510539     
   2500000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.013804491    1.7852881e-15  0              1.7241035e-10  1.1965779e-13  0              3.510539     
   2600000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.01380449     1.0568157e-16  0              1.020597e-11   1.1965779e-13  0              3.510539     
   2700000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.01380449     3.3197483e-18  0              3.2059753e-13  1.1965779e-13  0              3.510539     
   2800000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.01380449     1.1916451e-17  0              1.1508055e-12  1.1965779e-13  0              3.510539     
   2900000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.01380449     4.6684121e-20  0              4.5084183e-15  1.1965779e-13  0              3.510539     
   3000000   6363.961       200            200            0.0037920931  -0.0024282113   0              0.01380449     2.047626e-20   0              1.9774506e-15  1.1965779e-13  0              3.510539     
Loop time of 294.109 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8813073.645 ns/day, 0.000 hours/ns, 10200.317 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.898     | 40.785     | 71.418     | 450.9 | 13.87
Neigh   | 1.3741     | 1.3911     | 1.4077     |   1.0 |  0.47
Comm    | 12.833     | 18.179     | 25.375     | 111.5 |  6.18
Output  | 0.2468     | 0.24712    | 0.24747    |   0.1 |  0.08
Modify  | 173.8      | 176.91     | 179.72     |  19.6 | 60.15
Other   |            | 56.59      |            |       | 19.24

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.25 ave         663 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1325
Ave neighs/atom = 0.52978808
Neighbor list builds = 151
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.04                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 75.9565793673566
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.14
  ghost atom cutoff = 4.14
  binsize = 2.07, bins = 3075 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.5 | 43.51 | 43.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00034533893 -1.5866563e-35  0             -0.0010360168   525345.55      0              5.0734113e+10  1.1965779e-13  0              3.6335164    
    200000   6363.961       200            200           -0.00020270631 -5.0771283e-35  0             -0.00060811894  8856.0108      0              8.5525013e+08  1.1965779e-13  0              3.6716135    
    300000   6363.961       200            200            0.00014667607  8.8105313e-40  0              0.00044002821  3509.2106      0              3.3889444e+08  1.1965779e-13  0              3.5537951    
    400000   6363.961       200            200            0.00023010112 -2.113287e-06   0              0.00069241665  5499.1388      0              5.3106746e+08  1.1965779e-13  0              3.5195604    
    500000   6363.961       200            200            0.0013789119  -0.0007389157   0              0.0048756513   547.08863      0              52833904       1.1965779e-13  0              3.5174048    
    600000   6363.961       200            200            0.0023897861  -0.0020367707   0              0.0092061289   20.984028      0              2026487.3      1.1965779e-13  0              3.5163607    
    700000   6363.961       200            200            0.0032193182  -0.0024199191   0              0.012077874    3.1767542      0              306788.18      1.1965779e-13  0              3.5158329    
    800000   6363.961       200            200            0.0035814173  -0.0023959603   0              0.013140212    0.1370991      0              13240.05       1.1965779e-13  0              3.5156541    
    900000   6363.961       200            200            0.0037174838  -0.0024138489   0              0.0135663      0.00019351305  0              18.688106      1.1965779e-13  0              3.5155839    
   1000000   6363.961       200            200            0.0037707869  -0.0024187341   0              0.013731095    0.0018704756   0              180.63715      1.1965779e-13  0              3.515557     
   1100000   6363.961       200            200            0.0037905345  -0.0024206584   0              0.013792262    0.0011246042   0              108.60623      1.1965779e-13  0              3.515547     
   1200000   6363.961       200            200            0.0037975123  -0.0024213176   0              0.013813855    0.00033243607  0              32.104296      1.1965779e-13  0              3.5155435    
   1300000   6363.961       200            200            0.0037998496  -0.0024215277   0              0.013821076    7.3053218e-05  0              7.0549569      1.1965779e-13  0              3.5155423    
   1400000   6363.961       200            200            0.0038005822  -0.0024215938   0              0.01382334     1.3451033e-05  0              1.2990045      1.1965779e-13  0              3.5155419    
   1500000   6363.961       200            200            0.0038007922  -0.0024216128   0              0.013823989    2.1793281e-06  0              0.2104639      1.1965779e-13  0              3.5155418    
   1600000   6363.961       200            200            0.0038008439  -0.0024216176   0              0.013824149    3.176412e-07   0              0.030675514    1.1965779e-13  0              3.5155418    
   1700000   6363.961       200            200            0.0038008527  -0.0024216185   0              0.013824177    4.1990034e-08  0              0.0040550969   1.1965779e-13  0              3.5155418    
   1800000   6363.961       200            200            0.003800852   -0.0024216184   0              0.013824174    5.024519e-09   0              0.00048523208  1.1965779e-13  0              3.5155418    
   1900000   6363.961       200            200            0.0038008503  -0.0024216183   0              0.013824169    5.3724267e-10  0              5.1883052e-05  1.1965779e-13  0              3.5155418    
   2000000   6363.961       200            200            0.0038008492  -0.0024216182   0              0.013824166    4.9791622e-11  0              4.8085184e-06  1.1965779e-13  0              3.5155418    
   2100000   6363.961       200            200            0.0038008486  -0.0024216182   0              0.013824164    3.733558e-12   0              3.6056031e-07  1.1965779e-13  0              3.5155418    
   2200000   6363.961       200            200            0.0038008484  -0.0024216181   0              0.013824163    1.8830179e-13  0              1.818484e-08   1.1965779e-13  0              3.5155418    
   2300000   6363.961       200            200            0.0038008483  -0.0024216181   0              0.013824163    2.5290823e-15  0              2.4424066e-10  1.1965779e-13  0              3.5155418    
   2400000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    5.3974693e-16  0              5.2124895e-11  1.1965779e-13  0              3.5155418    
   2500000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    5.6422431e-16  0              5.4488746e-11  1.1965779e-13  0              3.5155418    
   2600000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    2.1743001e-16  0              2.0997834e-11  1.1965779e-13  0              3.5155418    
   2700000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    7.6304598e-17  0              7.3689519e-12  1.1965779e-13  0              3.5155418    
   2800000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    2.7061323e-18  0              2.6133889e-13  1.1965779e-13  0              3.5155418    
   2900000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    4.4348117e-18  0              4.2828237e-13  1.1965779e-13  0              3.5155418    
   3000000   6363.961       200            200            0.0038008482  -0.0024216181   0              0.013824163    2.7966013e-18  0              2.7007573e-13  1.1965779e-13  0              3.5155418    
Loop time of 295.617 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8768109.815 ns/day, 0.000 hours/ns, 10148.275 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.521     | 39.809     | 68.256     | 441.6 | 13.47
Neigh   | 1.288      | 1.3041     | 1.3201     |   1.0 |  0.44
Comm    | 12.569     | 17.607     | 21.923     |  91.0 |  5.96
Output  | 0.24334    | 0.24366    | 0.24403    |   0.1 |  0.08
Modify  | 173.81     | 179.19     | 184.46     |  34.9 | 60.61
Other   |            | 57.47      |            |       | 19.44

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         334.75 ave         670 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1339
Ave neighs/atom = 0.53538585
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.05                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 76.5220106482522
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.15
  ghost atom cutoff = 4.15
  binsize = 2.075, bins = 3067 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.42 | 43.43 | 43.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00035699838  7.5605581e-41  0             -0.0010709951   518126.17      0              5.0036917e+10  1.1965779e-13  0              3.643335     
    200000   6363.961       200            200           -0.00019322997  1.0849365e-39  0             -0.00057968991  7919.9839      0              7.6485535e+08  1.1965779e-13  0              3.6774303    
    300000   6363.961       200            200            0.00016130032  3.8079881e-35  0              0.00048390097  4185.4156      0              4.0419748e+08  1.1965779e-13  0              3.5580919    
    400000   6363.961       200            200            0.00061124865 -9.8617232e-05  0              0.0019323632   6364.8901      0              6.1467552e+08  1.1965779e-13  0              3.5236189    
    500000   6363.961       200            200            0.0018255599  -0.00079510312  0              0.0062717829   758.09569      0              73211455       1.1965779e-13  0              3.5220561    
    600000   6363.961       200            200            0.0023319836  -0.0019789416   0              0.0089748923   3.2807932      0              316835.53      1.1965779e-13  0              3.5214152    
    700000   6363.961       200            200            0.0031864409  -0.0024164762   0              0.011975799    0.32684125     0              31563.989      1.1965779e-13  0              3.5208576    
    800000   6363.961       200            200            0.0035863846  -0.002388648    0              0.013147802    0.022982589    0              2219.494       1.1965779e-13  0              3.5206592    
    900000   6363.961       200            200            0.0037309777  -0.0024070174   0              0.01359995     0.039948811    0              3857.9702      1.1965779e-13  0              3.5205845    
   1000000   6363.961       200            200            0.0037842465  -0.0024119398   0              0.013764679    0.015782156    0              1524.1276      1.1965779e-13  0              3.5205575    
   1100000   6363.961       200            200            0.0038023072  -0.0024137325   0              0.013820654    0.0039338634   0              379.90437      1.1965779e-13  0              3.5205483    
   1200000   6363.961       200            200            0.0038079331  -0.0024142635   0              0.013838063    0.00076163157  0              73.552926      1.1965779e-13  0              3.5205455    
   1300000   6363.961       200            200            0.0038094865  -0.0024144041   0              0.013842864    0.00012392608  0              11.967893      1.1965779e-13  0              3.5205447    
   1400000   6363.961       200            200            0.0038098293  -0.0024144357   0              0.013843924    1.7478576e-05  0              1.6879557      1.1965779e-13  0              3.5205445    
   1500000   6363.961       200            200            0.0038098632  -0.0024144393   0              0.013844029    2.1510258e-06  0              0.20773068     1.1965779e-13  0              3.5205445    
   1600000   6363.961       200            200            0.003809841   -0.0024144375   0              0.013843961    2.2789675e-07  0              0.022008637    1.1965779e-13  0              3.5205445    
   1700000   6363.961       200            200            0.0038098207  -0.0024144358   0              0.013843898    1.9916188e-08  0              0.0019233629   1.1965779e-13  0              3.5205445    
   1800000   6363.961       200            200            0.0038098093  -0.0024144348   0              0.013843863    1.2826088e-09  0              0.00012386518  1.1965779e-13  0              3.5205445    
   1900000   6363.961       200            200            0.0038098039  -0.0024144344   0              0.013843846    4.0904539e-11  0              3.9502676e-06  1.1965779e-13  0              3.5205445    
   2000000   6363.961       200            200            0.0038098017  -0.0024144342   0              0.013843839    8.2710077e-14  0              7.9875472e-09  1.1965779e-13  0              3.5205445    
   2100000   6363.961       200            200            0.0038098008  -0.0024144341   0              0.013843836    1.1365968e-12  0              1.0976439e-07  1.1965779e-13  0              3.5205445    
   2200000   6363.961       200            200            0.0038098005  -0.0024144341   0              0.013843835    5.1511429e-13  0              4.9746051e-08  1.1965779e-13  0              3.5205445    
   2300000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    1.3351663e-13  0              1.289408e-08   1.1965779e-13  0              3.5205445    
   2400000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    2.645002e-14   0              2.5543536e-09  1.1965779e-13  0              3.5205445    
   2500000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    4.3980854e-15  0              4.2473561e-10  1.1965779e-13  0              3.5205445    
   2600000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    6.3002521e-16  0              6.0843326e-11  1.1965779e-13  0              3.5205445    
   2700000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    4.1047205e-17  0              3.9640452e-12  1.1965779e-13  0              3.5205445    
   2800000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    2.237596e-18   0              2.1609101e-13  1.1965779e-13  0              3.5205445    
   2900000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    4.3919571e-19  0              4.2414378e-14  1.1965779e-13  0              3.5205445    
   3000000   6363.961       200            200            0.0038098003  -0.0024144341   0              0.013843835    3.647068e-18   0              3.5220772e-13  1.1965779e-13  0              3.5205445    
Loop time of 290.83 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8912416.193 ns/day, 0.000 hours/ns, 10315.297 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.38      | 39.636     | 67.807     | 445.0 | 13.63
Neigh   | 1.2796     | 1.2962     | 1.3123     |   1.0 |  0.45
Comm    | 12.563     | 17.56      | 22.272     |  93.0 |  6.04
Output  | 0.24551    | 0.24584    | 0.24621    |   0.1 |  0.08
Modify  | 172.31     | 176.08     | 179.64     |  25.0 | 60.54
Other   |            | 56.01      |            |       | 19.26

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         337.75 ave         676 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1351
Ave neighs/atom = 0.54018393
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.06                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 77.0902410882023
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.16
  ghost atom cutoff = 4.16
  binsize = 2.08, bins = 3060 97 97
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 43.34 | 43.35 | 43.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00036844423  1.2693304e-35  0             -0.0011053327   510961.06      0              4.9344962e+10  1.1965779e-13  0              3.6531225    
    200000   6363.961       200            200           -0.00018358457  5.0773555e-35  0             -0.00055075371  7037.0231      0              6.7958532e+08  1.1965779e-13  0              3.6831982    
    300000   6363.961       200            200            0.00017609086 -2.5386357e-35  0              0.00052827257  4920.2538      0              4.751629e+08   1.1965779e-13  0              3.562326     
    400000   6363.961       200            200            0.0014321497  -0.00035577964  0              0.0046522287   7148.8902      0              6.9038865e+08  1.1965779e-13  0              3.5276114    
    500000   6363.961       200            200            0.0023622249  -0.00098649257  0              0.0080731673   954.43095      0              92172109       1.1965779e-13  0              3.5266549    
    600000   6363.961       200            200            0.0023328267  -0.0019736942   0              0.0089721742   1.0770753      0              104016.23      1.1965779e-13  0              3.5264245    
    700000   6363.961       200            200            0.0031978127  -0.0024114945   0              0.012004933    0.45757799     0              44189.607      1.1965779e-13  0              3.5258596    
    800000   6363.961       200            200            0.0036119585  -0.002384116    0              0.013219992    0.43312945     0              41828.542      1.1965779e-13  0              3.5256535    
    900000   6363.961       200            200            0.0037535524  -0.0024018735   0              0.013662531    0.15168894     0              14649.032      1.1965779e-13  0              3.5255804    
   1000000   6363.961       200            200            0.0038012212  -0.0024063368   0              0.01381        0.035722723    0              3449.8449      1.1965779e-13  0              3.5255561    
   1100000   6363.961       200            200            0.0038151402  -0.002407772    0              0.013853192    0.0064741346   0              625.22558      1.1965779e-13  0              3.525549     
   1200000   6363.961       200            200            0.0038184668  -0.0024080872   0              0.013863488    0.00096107181  0              92.813437      1.1965779e-13  0              3.5255473    
   1300000   6363.961       200            200            0.0038189176  -0.0024081308   0              0.013864884    0.00011906104  0              11.498063      1.1965779e-13  0              3.525547     
   1400000   6363.961       200            200            0.003818785   -0.0024081207   0              0.013864476    1.210627e-05   0              1.1691369      1.1965779e-13  0              3.5255471    
   1500000   6363.961       200            200            0.0038186312  -0.0024081078   0              0.013864001    9.4329477e-07  0              0.091096657    1.1965779e-13  0              3.5255471    
   1600000   6363.961       200            200            0.0038185411  -0.0024081001   0              0.013863723    4.5227593e-08  0              0.0043677572   1.1965779e-13  0              3.5255472    
   1700000   6363.961       200            200            0.0038184986  -0.0024080964   0              0.013863592    3.3668018e-10  0              3.2514162e-05  1.1965779e-13  0              3.5255472    
   1800000   6363.961       200            200            0.003818481   -0.0024080949   0              0.013863538    2.4921981e-10  0              2.4067865e-05  1.1965779e-13  0              3.5255472    
   1900000   6363.961       200            200            0.0038184743  -0.0024080943   0              0.013863517    1.83674e-10    0              1.773792e-05   1.1965779e-13  0              3.5255472    
   2000000   6363.961       200            200            0.003818472   -0.0024080941   0              0.01386351     5.452339e-11   0              5.2654788e-06  1.1965779e-13  0              3.5255472    
   2100000   6363.961       200            200            0.0038184713  -0.002408094    0              0.013863508    1.1257152e-11  0              1.0871351e-06  1.1965779e-13  0              3.5255472    
   2200000   6363.961       200            200            0.0038184711  -0.002408094    0              0.013863507    1.8493696e-12  0              1.7859888e-07  1.1965779e-13  0              3.5255472    
   2300000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    2.5212699e-13  0              2.434862e-08   1.1965779e-13  0              3.5255472    
   2400000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    2.8803857e-14  0              2.7816703e-09  1.1965779e-13  0              3.5255472    
   2500000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    2.6742974e-15  0              2.582645e-10   1.1965779e-13  0              3.5255472    
   2600000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    1.5124043e-16  0              1.4605719e-11  1.1965779e-13  0              3.5255472    
   2700000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    5.2477058e-18  0              5.0678586e-13  1.1965779e-13  0              3.5255472    
   2800000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    1.1919745e-17  0              1.1511237e-12  1.1965779e-13  0              3.5255472    
   2900000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    2.8409347e-19  0              2.7435714e-14  1.1965779e-13  0              3.5255472    
   3000000   6363.961       200            200            0.003818471   -0.002408094    0              0.013863507    5.5752148e-19  0              5.3841434e-14  1.1965779e-13  0              3.5255472    
Loop time of 297.653 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8708116.314 ns/day, 0.000 hours/ns, 10078.838 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.66      | 40.514     | 71.502     | 453.8 | 13.61
Neigh   | 1.2692     | 1.2851     | 1.3011     |   1.0 |  0.43
Comm    | 12.462     | 18.772     | 25.417     | 128.6 |  6.31
Output  | 0.24324    | 0.24357    | 0.24394    |   0.1 |  0.08
Modify  | 178.06     | 179.8      | 181.88     |  11.8 | 60.41
Other   |            | 57.04      |            |       | 19.16

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         340.25 ave         681 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1361
Ave neighs/atom = 0.54418233
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.07                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 77.6612775987105
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.17
  ghost atom cutoff = 4.17
  binsize = 2.085, bins = 3053 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.7 | 42.71 | 42.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00037967705  1.5232021e-34  0             -0.0011390311   503850.13      0              4.8658239e+10  1.1965779e-13  0              3.6628788    
    200000   6363.961       200            200           -0.00017377103  1.0154704e-34  0             -0.00052131309  6206.9824      0              5.9942593e+08  1.1965779e-13  0              3.6889172    
    300000   6363.961       200            200            0.0001910464   1.2693283e-35  0              0.00057313919  5713.5147      0              5.5177035e+08  1.1965779e-13  0              3.5664974    
    400000   6363.961       200            200            0.0027081532  -0.00090456509  0              0.0090290247   7702.5329      0              7.438555e+08   1.1965779e-13  0              3.5315524    
    500000   6363.961       200            200            0.0029905021  -0.0013466043   0              0.010318111    1106.0507      0              1.0681446e+08  1.1965779e-13  0              3.5312132    
    600000   6363.961       200            200            0.0024065125  -0.0019792352   0              0.0091987726   14.69463       0              1419102.1      1.1965779e-13  0              3.5313881    
    700000   6363.961       200            200            0.0032509138  -0.0024123482   0              0.01216509     3.5134808      0              339306.82      1.1965779e-13  0              3.5308388    
    800000   6363.961       200            200            0.0036569777  -0.0023813723   0              0.013352305    1.2150218      0              117338.11      1.1965779e-13  0              3.5306379    
    900000   6363.961       200            200            0.0037837555  -0.0023978936   0              0.01374916     0.28347736     0              27376.215      1.1965779e-13  0              3.5305723    
   1000000   6363.961       200            200            0.0038206005  -0.0024014292   0              0.013863231    0.050259869    0              4853.7384      1.1965779e-13  0              3.5305534    
   1100000   6363.961       200            200            0.0038284199  -0.0024022869   0              0.013887547    0.0070140592   0              677.36764      1.1965779e-13  0              3.5305493    
   1200000   6363.961       200            200            0.0038288535  -0.0024023368   0              0.013888897    0.00077415289  0              74.762145      1.1965779e-13  0              3.530549     
   1300000   6363.961       200            200            0.0038280926  -0.0024022748   0              0.013886553    6.3903117e-05  0              6.1713056      1.1965779e-13  0              3.5305494    
   1400000   6363.961       200            200            0.003827507   -0.0024022252   0              0.013884746    3.2037662e-06  0              0.30939681     1.1965779e-13  0              3.5305497    
   1500000   6363.961       200            200            0.0038272038  -0.0024021992   0              0.013883811    2.6575933e-08  0              0.0025665133   1.1965779e-13  0              3.5305498    
   1600000   6363.961       200            200            0.0038270726  -0.0024021878   0              0.013883406    1.6453072e-08  0              0.0015889199   1.1965779e-13  0              3.5305499    
   1700000   6363.961       200            200            0.0038270225  -0.0024021835   0              0.013883251    1.2291362e-08  0              0.0011870118   1.1965779e-13  0              3.5305499    
   1800000   6363.961       200            200            0.0038270055  -0.002402182    0              0.013883199    3.5455631e-09  0              0.0003424051   1.1965779e-13  0              3.5305499    
   1900000   6363.961       200            200            0.0038270005  -0.0024021815   0              0.013883183    6.9293335e-10  0              6.6918544e-05  1.1965779e-13  0              3.5305499    
   2000000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    1.0440622e-10  0              1.0082806e-05  1.1965779e-13  0              3.5305499    
   2100000   6363.961       200            200            0.0038269991  -0.0024021814   0              0.013883179    1.2479885e-11  0              1.205218e-06   1.1965779e-13  0              3.5305499    
   2200000   6363.961       200            200            0.0038269992  -0.0024021814   0              0.013883179    1.1472439e-12  0              1.107926e-07   1.1965779e-13  0              3.5305499    
   2300000   6363.961       200            200            0.0038269992  -0.0024021814   0              0.013883179    7.0476963e-14  0              6.8061606e-09  1.1965779e-13  0              3.5305499    
   2400000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    1.4382268e-15  0              1.3889365e-10  1.1965779e-13  0              3.5305499    
   2500000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    5.8108739e-17  0              5.6117261e-12  1.1965779e-13  0              3.5305499    
   2600000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    1.5035972e-16  0              1.4520665e-11  1.1965779e-13  0              3.5305499    
   2700000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    7.7718593e-17  0              7.5055054e-12  1.1965779e-13  0              3.5305499    
   2800000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    1.4156414e-18  0              1.3671252e-13  1.1965779e-13  0              3.5305499    
   2900000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    5.7392708e-18  0              5.542577e-13   1.1965779e-13  0              3.5305499    
   3000000   6363.961       200            200            0.0038269993  -0.0024021814   0              0.013883179    5.5567317e-18  0              5.3662938e-13  1.1965779e-13  0              3.5305499    
Loop time of 291.77 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8883711.288 ns/day, 0.000 hours/ns, 10282.073 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.575     | 39.986     | 68.891     | 447.2 | 13.70
Neigh   | 1.243      | 1.2597     | 1.2761     |   1.1 |  0.43
Comm    | 12.302     | 18.222     | 24.498     | 114.9 |  6.25
Output  | 0.24319    | 0.2435     | 0.24386    |   0.1 |  0.08
Modify  | 173.08     | 176.04     | 179.59     |  18.5 | 60.34
Other   |            | 56.01      |            |       | 19.20

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           2 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         342.75 ave         686 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1371
Ave neighs/atom = 0.54818073
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.08                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 78.235127091281
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.18
  ghost atom cutoff = 4.18
  binsize = 2.09, bins = 3045 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.63 | 42.63 | 42.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00039069743 -5.0772139e-35  0             -0.0011720923   496793.27      0              4.7976739e+10  1.1965779e-13  0              3.6726038    
    200000   6363.961       200            200           -0.00016379027  5.7805024e-40  0             -0.00049137082  5429.7157      0              5.2436308e+08  1.1965779e-13  0              3.6945871    
    300000   6363.961       200            200            0.00020616567 -1.0154518e-34  0              0.00061849702  6564.9875      0              6.3399951e+08  1.1965779e-13  0              3.5706059    
    400000   6363.961       200            200            0.0044720585  -0.0017100073   0              0.015126183    7861.0761      0              7.5916646e+08  1.1965779e-13  0              3.5354656    
    500000   6363.961       200            200            0.0037963165  -0.0015884872   0              0.012977437    1183.865       0              1.1432921e+08  1.1965779e-13  0              3.5357464    
    600000   6363.961       200            200            0.00254854    -0.0020066552   0              0.0096522751   41.508571      0              4008600.6      1.1965779e-13  0              3.5363079    
    700000   6363.961       200            200            0.0033423239  -0.0024218351   0              0.012448807    8.6274832      0              833180.58      1.1965779e-13  0              3.535797     
    800000   6363.961       200            200            0.0037183266  -0.0023799346   0              0.013534915    2.0809315      0              200961.47      1.1965779e-13  0              3.5356141    
    900000   6363.961       200            200            0.0038190834  -0.0023948109   0              0.013852061    0.37413016     0              36130.813      1.1965779e-13  0              3.5355615    
   1000000   6363.961       200            200            0.0038408158  -0.002396958    0              0.013919405    0.051172473    0              4941.8712      1.1965779e-13  0              3.5355502    
   1100000   6363.961       200            200            0.0038413314  -0.002397104    0              0.013921098    0.0052092134   0              503.06854      1.1965779e-13  0              3.5355498    
   1200000   6363.961       200            200            0.0038387324  -0.0023968907   0              0.013913088    0.00035457628  0              34.242439      1.1965779e-13  0              3.535551     
   1300000   6363.961       200            200            0.0038368841  -0.0023967341   0              0.013907386    9.861601e-06   0              0.95236284     1.1965779e-13  0              3.5355519    
   1400000   6363.961       200            200            0.0038359717  -0.0023966558   0              0.013904571    1.5355119e-07  0              0.014828875    1.1965779e-13  0              3.5355524    
   1500000   6363.961       200            200            0.0038355972  -0.0023966234   0              0.013903415    4.7751214e-07  0              0.046114704    1.1965779e-13  0              3.5355525    
   1600000   6363.961       200            200            0.0038354644  -0.0023966118   0              0.013903005    1.7590006e-07  0              0.016987169    1.1965779e-13  0              3.5355526    
   1700000   6363.961       200            200            0.003835424   -0.0023966083   0              0.01390288     3.7429756e-08  0              0.003614698    1.1965779e-13  0              3.5355526    
   1800000   6363.961       200            200            0.0038354144  -0.0023966074   0              0.01390285     5.7275451e-09  0              0.00055312531  1.1965779e-13  0              3.5355526    
   1900000   6363.961       200            200            0.0038354132  -0.0023966073   0              0.013902847    6.5745025e-10  0              6.3491839e-05  1.1965779e-13  0              3.5355526    
   2000000   6363.961       200            200            0.0038354137  -0.0023966074   0              0.013902848    5.3612009e-11  0              5.1774641e-06  1.1965779e-13  0              3.5355526    
   2100000   6363.961       200            200            0.0038354142  -0.0023966074   0              0.01390285     2.3942112e-12  0              2.3121578e-07  1.1965779e-13  0              3.5355526    
   2200000   6363.961       200            200            0.0038354145  -0.0023966074   0              0.013902851    4.9815703e-15  0              4.8108441e-10  1.1965779e-13  0              3.5355526    
   2300000   6363.961       200            200            0.0038354146  -0.0023966074   0              0.013902851    2.5635481e-14  0              2.4756913e-09  1.1965779e-13  0              3.5355526    
   2400000   6363.961       200            200            0.0038354146  -0.0023966074   0              0.013902851    1.441439e-14   0              1.3920386e-09  1.1965779e-13  0              3.5355526    
   2500000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    3.6525501e-15  0              3.5273714e-10  1.1965779e-13  0              3.5355526    
   2600000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    6.2421773e-16  0              6.0282481e-11  1.1965779e-13  0              3.5355526    
   2700000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    4.2656118e-17  0              4.1194226e-12  1.1965779e-13  0              3.5355526    
   2800000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    3.4263325e-18  0              3.3089067e-13  1.1965779e-13  0              3.5355526    
   2900000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    1.0583464e-18  0              1.0220752e-13  1.1965779e-13  0              3.5355526    
   3000000   6363.961       200            200            0.0038354147  -0.0023966074   0              0.013902851    3.6563645e-18  0              3.5310552e-13  1.1965779e-13  0              3.5355526    
Loop time of 292.378 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8865246.311 ns/day, 0.000 hours/ns, 10260.702 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.352     | 40.546     | 71.991     | 457.0 | 13.87
Neigh   | 1.2598     | 1.2763     | 1.2927     |   1.0 |  0.44
Comm    | 12.535     | 18.135     | 23.712     | 106.8 |  6.20
Output  | 0.24024    | 0.24056    | 0.24093    |   0.1 |  0.08
Modify  | 173.8      | 176.27     | 178.55     |  13.7 | 60.29
Other   |            | 55.91      |            |       | 19.12

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         346.25 ave         693 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1385
Ave neighs/atom = 0.55377849
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.09                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 78.8117964774169
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.19
  ghost atom cutoff = 4.19
  binsize = 2.095, bins = 3038 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.52 | 42.54 | 42.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00040150596 -6.3466229e-36  0             -0.0012045179   489790.4       0              4.7300451e+10  1.1965779e-13  0              3.6822975    
    200000   6363.961       200            200           -0.0001536432   5.2149757e-40  0             -0.00046092959  4705.0762      0              4.5438258e+08  1.1965779e-13  0              3.7002077    
    300000   6363.961       200            200            0.0002214474   1.8087187e-41  0              0.0006643422   7474.4616      0              7.2183e+08     1.1965779e-13  0              3.5746514    
    400000   6363.961       200            200            0.0067558072  -0.002511517    0              0.022778939    7483.5886      0              7.2271142e+08  1.1965779e-13  0              3.539384     
    500000   6363.961       200            200            0.0046705788  -0.0019658414   0              0.015977578    1166.3274      0              1.1263555e+08  1.1965779e-13  0              3.5402725    
    600000   6363.961       200            200            0.0027722843  -0.0020108021   0              0.010327655    76.310426      0              7369514.7      1.1965779e-13  0              3.5411878    
    700000   6363.961       200            200            0.003473188   -0.0024213014   0              0.012840865    14.346003      0              1385434.3      1.1965779e-13  0              3.5407375    
    800000   6363.961       200            200            0.0037916235  -0.0023784776   0              0.013753348    2.7114749      0              261854.84      1.1965779e-13  0              3.5405845    
    900000   6363.961       200            200            0.0038566148  -0.0023915149   0              0.013961359    0.3815365      0              36846.064      1.1965779e-13  0              3.5405498    
   1000000   6363.961       200            200            0.0038603922  -0.0023919707   0              0.013973147    0.038034419    0              3673.092       1.1965779e-13  0              3.5405474    
   1100000   6363.961       200            200            0.003853342   -0.0023913777   0              0.013951404    0.0022983263   0              221.9559       1.1965779e-13  0              3.5405507    
   1200000   6363.961       200            200            0.003848066   -0.0023909326   0              0.013935131    3.567407e-05   0              3.4451463      1.1965779e-13  0              3.5405533    
   1300000   6363.961       200            200            0.0038454679  -0.00239071     0              0.013927114    5.9617678e-06  0              0.57574486     1.1965779e-13  0              3.5405546    
   1400000   6363.961       200            200            0.0038444309  -0.0023906203   0              0.013923913    5.9918235e-06  0              0.57864743     1.1965779e-13  0              3.5405551    
   1500000   6363.961       200            200            0.0038440833  -0.00239059     0              0.01392284     1.7370496e-06  0              0.16775181     1.1965779e-13  0              3.5405553    
   1600000   6363.961       200            200            0.0038439891  -0.0023905817   0              0.013922549    3.1014257e-07  0              0.02995135     1.1965779e-13  0              3.5405553    
   1700000   6363.961       200            200            0.0038439726  -0.0023905802   0              0.013922498    3.8842791e-08  0              0.0037511587   1.1965779e-13  0              3.5405553    
   1800000   6363.961       200            200            0.0038439742  -0.0023905803   0              0.013922503    3.3122847e-09  0              0.00031987675  1.1965779e-13  0              3.5405553    
   1900000   6363.961       200            200            0.0038439775  -0.0023905805   0              0.013922513    1.4791597e-10  0              1.4284666e-05  1.1965779e-13  0              3.5405553    
   2000000   6363.961       200            200            0.0038439795  -0.0023905807   0              0.013922519    1.816177e-13   0              1.7539337e-08  1.1965779e-13  0              3.5405553    
   2100000   6363.961       200            200            0.0038439804  -0.0023905808   0              0.013922522    1.828557e-12   0              1.7658895e-07  1.1965779e-13  0              3.5405553    
   2200000   6363.961       200            200            0.0038439808  -0.0023905808   0              0.013922523    9.3546867e-13  0              9.0340868e-08  1.1965779e-13  0              3.5405553    
   2300000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922523    2.1954243e-13  0              2.1201837e-08  1.1965779e-13  0              3.5405553    
   2400000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    3.4275149e-14  0              3.3100486e-09  1.1965779e-13  0              3.5405553    
   2500000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    3.7838251e-15  0              3.6541475e-10  1.1965779e-13  0              3.5405553    
   2600000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    2.4769653e-16  0              2.3920758e-11  1.1965779e-13  0              3.5405553    
   2700000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    4.0592479e-18  0              3.920131e-13   1.1965779e-13  0              3.5405553    
   2800000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    1.1288683e-17  0              1.0901802e-12  1.1965779e-13  0              3.5405553    
   2900000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    2.6397163e-18  0              2.5492491e-13  1.1965779e-13  0              3.5405553    
   3000000   6363.961       200            200            0.0038439809  -0.0023905808   0              0.013922524    6.4152225e-18  0              6.1953627e-13  1.1965779e-13  0              3.5405553    
Loop time of 296.445 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8743614.808 ns/day, 0.000 hours/ns, 10119.925 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.334     | 41.196     | 71.1       | 459.1 | 13.90
Neigh   | 1.247      | 1.2636     | 1.2803     |   1.1 |  0.43
Comm    | 12.503     | 17.758     | 22.007     |  90.0 |  5.99
Output  | 0.24243    | 0.24276    | 0.24314    |   0.1 |  0.08
Modify  | 174.5      | 178.33     | 183.96     |  26.9 | 60.16
Other   |            | 57.65      |            |       | 19.45

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         348.75 ave         698 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1395
Ave neighs/atom = 0.55777689
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.1                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 79.3912926686227
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.2
  ghost atom cutoff = 4.2
  binsize = 2.1, bins = 3031 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.47 | 42.48 | 42.48 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0004121032  -5.0772168e-35  0             -0.0012363096   482841.43      0              4.6629369e+10  1.1965779e-13  0              3.6919598    
    200000   6363.961       200            200           -0.00014333076  8.1133009e-42  0             -0.00042999228  4032.9209      0              3.8947063e+08  1.1965779e-13  0              3.7057791    
    300000   6363.961       200            200            0.00023689025  3.807987e-35   0              0.00071067075  8441.7233      0              8.1524121e+08  1.1965779e-13  0              3.5786337    
    400000   6363.961       200            200            0.0093559656  -0.0035794872   0              0.031647384    6506.7231      0              6.2837274e+08  1.1965779e-13  0              3.5433495    
    500000   6363.961       200            200            0.0056299039  -0.0022961012   0              0.019185813    1046.5672      0              1.0106997e+08  1.1965779e-13  0              3.544812     
    600000   6363.961       200            200            0.0030581116  -0.0020348217   0              0.011209156    112.08999      0              10824849       1.1965779e-13  0              3.546034     
    700000   6363.961       200            200            0.0036332199  -0.0024184237   0              0.013318083    19.01875       0              1836694.8      1.1965779e-13  0              3.5456646    
    800000   6363.961       200            200            0.0038678649  -0.0023861966   0              0.013989791    2.8713086      0              277290.43      1.1965779e-13  0              3.5455523    
    900000   6363.961       200            200            0.00389349    -0.0023858317   0              0.014066302    0.30227512     0              29191.567      1.1965779e-13  0              3.5455387    
   1000000   6363.961       200            200            0.0038783257  -0.0023844811   0              0.014019458    0.018337765    0              1770.9301      1.1965779e-13  0              3.5455458    
   1100000   6363.961       200            200            0.0038644636  -0.0023832257   0              0.013976616    0.00023805221  0              22.989378      1.1965779e-13  0              3.5455525    
   1200000   6363.961       200            200            0.003857312   -0.0023826197   0              0.013954556    6.4670309e-05  0              6.2453956      1.1965779e-13  0              3.545556     
   1300000   6363.961       200            200            0.0038544534  -0.0023823741   0              0.013945734    5.4746405e-05  0              5.2870159      1.1965779e-13  0              3.5455574    
   1400000   6363.961       200            200            0.0038535258  -0.0023822935   0              0.013942871    1.4525656e-05  0              1.4027839      1.1965779e-13  0              3.5455579    
   1500000   6363.961       200            200            0.0038532974  -0.0023822734   0              0.013942165    2.3232832e-06  0              0.22436606     1.1965779e-13  0              3.545558     
   1600000   6363.961       200            200            0.0038532712  -0.0023822709   0              0.013942085    2.4475368e-07  0              0.023636558    1.1965779e-13  0              3.545558     
   1700000   6363.961       200            200            0.0038532847  -0.002382272    0              0.013942126    1.4851031e-08  0              0.0014342063   1.1965779e-13  0              3.545558     
   1800000   6363.961       200            200            0.0038532972  -0.0023822731   0              0.013942165    1.9442673e-10  0              1.8776342e-05  1.1965779e-13  0              3.545558     
   1900000   6363.961       200            200            0.0038533036  -0.0023822736   0              0.013942184    5.1849701e-11  0              5.007273e-06   1.1965779e-13  0              3.545558     
   2000000   6363.961       200            200            0.0038533062  -0.0023822738   0              0.013942192    4.4126186e-11  0              4.2613912e-06  1.1965779e-13  0              3.545558     
   2100000   6363.961       200            200            0.003853307   -0.0023822739   0              0.013942195    1.1727764e-11  0              1.1325835e-06  1.1965779e-13  0              3.545558     
   2200000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    1.8776505e-12  0              1.8133004e-07  1.1965779e-13  0              3.545558     
   2300000   6363.961       200            200            0.0038533073  -0.0023822739   0              0.013942196    1.978861e-13   0              1.9110423e-08  1.1965779e-13  0              3.545558     
   2400000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    1.2340017e-14  0              1.1917105e-09  1.1965779e-13  0              3.545558     
   2500000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    1.8906799e-16  0              1.8258833e-11  1.1965779e-13  0              3.545558     
   2600000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    5.0640615e-17  0              4.8905081e-12  1.1965779e-13  0              3.545558     
   2700000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    7.2447545e-17  0              6.9964654e-12  1.1965779e-13  0              3.545558     
   2800000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    1.0347448e-18  0              9.9928243e-14  1.1965779e-13  0              3.545558     
   2900000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    7.6323678e-19  0              7.3707945e-14  1.1965779e-13  0              3.545558     
   3000000   6363.961       200            200            0.0038533072  -0.0023822739   0              0.013942196    1.8658995e-19  0              1.8019522e-14  1.1965779e-13  0              3.545558     
Loop time of 293.03 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8845500.549 ns/day, 0.000 hours/ns, 10237.848 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.248     | 40.956     | 70.773     | 460.7 | 13.98
Neigh   | 1.2519     | 1.2692     | 1.2864     |   1.1 |  0.43
Comm    | 12.478     | 17.543     | 22.78      |  95.3 |  5.99
Output  | 0.24355    | 0.24388    | 0.24425    |   0.1 |  0.08
Modify  | 174.72     | 177.36     | 180.05     |  14.9 | 60.52
Other   |            | 55.66      |            |       | 19.00

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         351.25 ave         703 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1405
Ave neighs/atom = 0.56177529
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.11                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 79.9736225764021
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.21
  ghost atom cutoff = 4.21
  binsize = 2.105, bins = 3024 96 96
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 42.39 | 42.4 | 42.4 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00042248977 -1.2693248e-35  0             -0.0012674693   475946.22      0              4.5963479e+10  1.1965779e-13  0              3.7015907    
    200000   6363.961       200            200           -0.00013285378 -3.5540958e-34  0             -0.00039856133  3413.0983      0              3.296126e+08   1.1965779e-13  0              3.7113012    
    300000   6363.961       200            200            0.00025249315 -1.2693141e-35  0              0.00075747946  9466.5766      0              9.1421421e+08  1.1965779e-13  0              3.5825528    
    400000   6363.961       200            200            0.012109865   -0.0046639941   0              0.04099359     5003.5092      0              4.8320311e+08  1.1965779e-13  0              3.5474107    
    500000   6363.961       200            200            0.0066311062  -0.0025252359   0              0.022418555    837.59553      0              80888981       1.1965779e-13  0              3.549387     
    600000   6363.961       200            200            0.0034065809  -0.0020538768   0              0.01227362     141.25095      0              13641006       1.1965779e-13  0              3.5508544    
    700000   6363.961       200            200            0.0038141851  -0.0024074006   0              0.013849956    21.262675      0              2053397        1.1965779e-13  0              3.5505839    
    800000   6363.961       200            200            0.0039426341  -0.0023956454   0              0.014223548    2.4977996      0              241219.6       1.1965779e-13  0              3.5505207    
    900000   6363.961       200            200            0.0039255609  -0.0023798791   0              0.014156562    0.17323604     0              16729.897      1.1965779e-13  0              3.55053      
   1000000   6363.961       200            200            0.0038925432  -0.0023768218   0              0.014054451    0.0031689061   0              306.03027      1.1965779e-13  0              3.5505459    
   1100000   6363.961       200            200            0.0038735698  -0.0023750924   0              0.013995802    0.00038440179  0              37.122774      1.1965779e-13  0              3.5505552    
   1200000   6363.961       200            200            0.0038656721  -0.0023744212   0              0.013971438    0.00041299008  0              39.883626      1.1965779e-13  0              3.5505591    
   1300000   6363.961       200            200            0.0038631039  -0.0023741997   0              0.013963511    0.0001114687   0              10.764849      1.1965779e-13  0              3.5505604    
   1400000   6363.961       200            200            0.0038624996  -0.0023741466   0              0.013961646    1.6965787e-05  0              1.6384343      1.1965779e-13  0              3.5505607    
   1500000   6363.961       200            200            0.0038624532  -0.0023741421   0              0.013961502    1.5686832e-06  0              0.1514922      1.1965779e-13  0              3.5505608    
   1600000   6363.961       200            200            0.0038625046  -0.0023741463   0              0.01396166     6.6758941e-08  0              0.0064471007   1.1965779e-13  0              3.5505607    
   1700000   6363.961       200            200            0.0038625441  -0.0023741496   0              0.013961782    9.6725988e-13  0              9.3411035e-08  1.1965779e-13  0              3.5505607    
   1800000   6363.961       200            200            0.0038625629  -0.0023741512   0              0.01396184     1.2576258e-09  0              0.0001214525   1.1965779e-13  0              3.5505607    
   1900000   6363.961       200            200            0.0038625698  -0.0023741518   0              0.013961861    5.2454629e-10  0              5.0656926e-05  1.1965779e-13  0              3.5505607    
   2000000   6363.961       200            200            0.0038625717  -0.002374152    0              0.013961867    1.0194944e-10  0              9.8455473e-06  1.1965779e-13  0              3.5505607    
   2100000   6363.961       200            200            0.0038625721  -0.002374152    0              0.013961868    1.2049004e-11  0              1.1636066e-06  1.1965779e-13  0              3.5505607    
   2200000   6363.961       200            200            0.003862572   -0.002374152    0              0.013961868    7.9933297e-13  0              7.7193857e-08  1.1965779e-13  0              3.5505607    
   2300000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    1.2857475e-14  0              1.241683e-09   1.1965779e-13  0              3.5505607    
   2400000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    2.2926984e-15  0              2.214124e-10   1.1965779e-13  0              3.5505607    
   2500000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    2.047005e-15   0              1.9768509e-10  1.1965779e-13  0              3.5505607    
   2600000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    5.655685e-16   0              5.4618557e-11  1.1965779e-13  0              3.5505607    
   2700000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    5.0473009e-17  0              4.8743219e-12  1.1965779e-13  0              3.5505607    
   2800000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    3.2785364e-18  0              3.1661757e-13  1.1965779e-13  0              3.5505607    
   2900000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    2.6248963e-18  0              2.534937e-13   1.1965779e-13  0              3.5505607    
   3000000   6363.961       200            200            0.0038625719  -0.002374152    0              0.013961868    3.1607767e-18  0              3.0524519e-13  1.1965779e-13  0              3.5505607    
Loop time of 297.601 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8709661.882 ns/day, 0.000 hours/ns, 10080.627 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.437     | 41.983     | 73.556     | 468.8 | 14.11
Neigh   | 1.2678     | 1.2843     | 1.3001     |   1.0 |  0.43
Comm    | 12.723     | 17.69      | 23.934     | 101.6 |  5.94
Output  | 0.24353    | 0.24385    | 0.24422    |   0.1 |  0.08
Modify  | 176.68     | 179.03     | 181.25     |  13.4 | 60.16
Other   |            | 57.37      |            |       | 19.28

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         353.25 ave         707 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1413
Ave neighs/atom = 0.56497401
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.12                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 80.5587931122588
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.22
  ghost atom cutoff = 4.22
  binsize = 2.11, bins = 3017 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.77 | 41.78 | 41.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00043266621 -1.0154153e-34  0             -0.0012979986   469104.73      0              4.5302777e+10  1.1965779e-13  0              3.7111902    
    200000   6363.961       200            200           -0.00012221328 -6.346594e-36   0             -0.00036663985  2845.4702      0              2.7479514e+08  1.1965779e-13  0              3.7167737    
    300000   6363.961       200            200            0.0002682546   4.1917296e-40  0              0.0008047638   10548.797      0              1.0187273e+09  1.1965779e-13  0              3.5864084    
    400000   6363.961       200            200            0.014891331   -0.005185382    0              0.049859375    3215.5415      0              3.1053398e+08  1.1965779e-13  0              3.5516193    
    500000   6363.961       200            200            0.0075355964  -0.0028168176   0              0.025423607    574.65272      0              55495846       1.1965779e-13  0              3.5540198    
    600000   6363.961       200            200            0.0037848258  -0.0021276537   0              0.013482131    157.06262      0              15167984       1.1965779e-13  0              3.5556587    
    700000   6363.961       200            200            0.0039953801  -0.002414846    0              0.014400986    20.370391      0              1967226.6      1.1965779e-13  0              3.5555017    
    800000   6363.961       200            200            0.0040139361  -0.0023918343   0              0.014433643    1.7280865      0              166886.23      1.1965779e-13  0              3.555493     
    900000   6363.961       200            200            0.0039496517  -0.0023745774   0              0.014223532    0.054344596    0              5248.2121      1.1965779e-13  0              3.5555251    
   1000000   6363.961       200            200            0.0039019371  -0.0023701096   0              0.014075921    0.00094166266  0              90.939039      1.1965779e-13  0              3.5555483    
   1100000   6363.961       200            200            0.0038803118  -0.0023681481   0              0.014009084    0.0026068722   0              251.75306      1.1965779e-13  0              3.5555589    
   1200000   6363.961       200            200            0.0038729499  -0.002367519    0              0.013986369    0.00080561162  0              77.800204      1.1965779e-13  0              3.5555626    
   1300000   6363.961       200            200            0.0038711795  -0.0023673646   0              0.013980903    0.00012530366  0              12.10093       1.1965779e-13  0              3.5555635    
   1400000   6363.961       200            200            0.003871044   -0.0023673515   0              0.013980483    1.0908473e-05  0              1.0534623      1.1965779e-13  0              3.5555635    
   1500000   6363.961       200            200            0.0038711963  -0.0023673639   0              0.013980953    3.5336377e-07  0              0.034125344    1.1965779e-13  0              3.5555635    
   1600000   6363.961       200            200            0.0038713116  -0.0023673736   0              0.013981308    4.4393513e-09  0              0.00042872077  1.1965779e-13  0              3.5555634    
   1700000   6363.961       200            200            0.0038713644  -0.0023673781   0              0.013981471    1.5018314e-08  0              0.0014503613   1.1965779e-13  0              3.5555634    
   1800000   6363.961       200            200            0.0038713826  -0.0023673797   0              0.013981527    4.7689284e-09  0              0.00046054897  1.1965779e-13  0              3.5555634    
   1900000   6363.961       200            200            0.003871387   -0.0023673801   0              0.013981541    7.5389608e-10  0              7.2805888e-05  1.1965779e-13  0              3.5555634    
   2000000   6363.961       200            200            0.0038713873  -0.0023673801   0              0.013981542    6.6861089e-11  0              6.4569654e-06  1.1965779e-13  0              3.5555634    
   2100000   6363.961       200            200            0.003871387   -0.0023673801   0              0.013981541    2.2696869e-12  0              2.1919011e-07  1.1965779e-13  0              3.5555634    
   2200000   6363.961       200            200            0.0038713867  -0.00236738     0              0.01398154     2.0494813e-14  0              1.9792423e-09  1.1965779e-13  0              3.5555634    
   2300000   6363.961       200            200            0.0038713866  -0.00236738     0              0.01398154     8.6507206e-14  0              8.3542467e-09  1.1965779e-13  0              3.5555634    
   2400000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     2.849453e-14   0              2.7517978e-09  1.1965779e-13  0              3.5555634    
   2500000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     4.5217992e-15  0              4.36683e-10    1.1965779e-13  0              3.5555634    
   2600000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     3.8343318e-16  0              3.7029232e-11  1.1965779e-13  0              3.5555634    
   2700000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     5.1307547e-19  0              4.9549156e-14  1.1965779e-13  0              3.5555634    
   2800000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     1.1349031e-17  0              1.0960082e-12  1.1965779e-13  0              3.5555634    
   2900000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     3.8157774e-23  0              3.6850047e-18  1.1965779e-13  0              3.5555634    
   3000000   6363.961       200            200            0.0038713865  -0.00236738     0              0.01398154     7.8170942e-21  0              7.5491901e-16  1.1965779e-13  0              3.5555634    
Loop time of 291.012 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8906837.044 ns/day, 0.000 hours/ns, 10308.839 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.239     | 40.855     | 70.281     | 458.7 | 14.04
Neigh   | 1.2923     | 1.3095     | 1.3268     |   1.1 |  0.45
Comm    | 12.492     | 17.544     | 22.252     |  91.7 |  6.03
Output  | 0.2424     | 0.24272    | 0.2431     |   0.1 |  0.08
Modify  | 172.59     | 175.32     | 178.35     |  16.5 | 60.24
Other   |            | 55.74      |            |       | 19.15

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         355.75 ave         712 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1423
Ave neighs/atom = 0.56897241
Neighbor list builds = 149
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.13                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 81.1468111876968
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.23
  ghost atom cutoff = 4.23
  binsize = 2.115, bins = 3009 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.69 | 41.7 | 41.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00044263312  1.0154679e-34  0             -0.0013278994   462316.83      0              4.464725e+10   1.1965779e-13  0              3.7207582    
    200000   6363.961       200            200           -0.00011141011 -5.0770107e-35  0             -0.00033423032  2329.8868      0              2.2500379e+08  1.1965779e-13  0              3.7221966    
    300000   6363.961       200            200            0.00028417349  2.538659e-35   0              0.00085252048  11688.188      0              1.1287615e+09  1.1965779e-13  0              3.5902004    
    400000   6363.961       200            200            0.017198808   -0.0055377354   0              0.057134159    1523.1334      0              1.4709333e+08  1.1965779e-13  0              3.5560244    
    500000   6363.961       200            200            0.0082796549  -0.0030942196   0              0.027933184    310.49006      0              29984908       1.1965779e-13  0              3.5587313    
    600000   6363.961       200            200            0.0042026822  -0.0021662667   0              0.014774313    155.34181      0              15001800       1.1965779e-13  0              3.560458     
    700000   6363.961       200            200            0.0041845301  -0.0023755686   0              0.014929159    16.556532      0              1598911.4      1.1965779e-13  0              3.5604245    
    800000   6363.961       200            200            0.0040707704  -0.0023886382   0              0.014600949    0.8499862      0              82085.583      1.1965779e-13  0              3.5604722    
    900000   6363.961       200            200            0.0039638066  -0.0023700076   0              0.014261427    0.00051262776  0              49.50592       1.1965779e-13  0              3.5605247    
   1000000   6363.961       200            200            0.0039063477  -0.0023646127   0              0.014083656    0.01273151     0              1229.5181      1.1965779e-13  0              3.5605528    
   1100000   6363.961       200            200            0.0038849823  -0.0023626609   0              0.014017608    0.0054059401   0              522.06701      1.1965779e-13  0              3.5605633    
   1200000   6363.961       200            200            0.0038793844  -0.0023621754   0              0.014000329    0.00093868199  0              90.651188      1.1965779e-13  0              3.5605661    
   1300000   6363.961       200            200            0.0038787774  -0.0023621192   0              0.013998451    8.4453687e-05  0              8.1559326      1.1965779e-13  0              3.5605665    
   1400000   6363.961       200            200            0.0038791533  -0.0023621498   0              0.01399961     2.5569324e-06  0              0.24693023     1.1965779e-13  0              3.5605663    
   1500000   6363.961       200            200            0.0038794696  -0.0023621764   0              0.014000585    5.8521567e-08  0              0.005651594    1.1965779e-13  0              3.5605661    
   1600000   6363.961       200            200            0.003879616   -0.0023621889   0              0.014001037    1.3419017e-07  0              0.012959126    1.1965779e-13  0              3.5605661    
   1700000   6363.961       200            200            0.0038796647  -0.0023621931   0              0.014001187    3.831201e-08   0              0.0036998997   1.1965779e-13  0              3.560566     
   1800000   6363.961       200            200            0.0038796753  -0.002362194    0              0.01400122     5.2758538e-09  0              0.0005095042   1.1965779e-13  0              3.560566     
   1900000   6363.961       200            200            0.0038796753  -0.002362194    0              0.01400122     3.5700197e-10  0              3.4476695e-05  1.1965779e-13  0              3.560566     
   2000000   6363.961       200            200            0.0038796739  -0.0023621939   0              0.014001216    3.9511042e-12  0              3.8156936e-07  1.1965779e-13  0              3.560566     
   2100000   6363.961       200            200            0.0038796731  -0.0023621939   0              0.014001213    1.709784e-12   0              1.651187e-07   1.1965779e-13  0              3.560566     
   2200000   6363.961       200            200            0.0038796727  -0.0023621938   0              0.014001212    1.1723667e-12  0              1.1321879e-07  1.1965779e-13  0              3.560566     
   2300000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    2.4870448e-13  0              2.4018099e-08  1.1965779e-13  0              3.560566     
   2400000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    2.7250311e-14  0              2.63164e-09    1.1965779e-13  0              3.560566     
   2500000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    1.2558035e-15  0              1.2127652e-10  1.1965779e-13  0              3.560566     
   2600000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    7.8294014e-19  0              7.5610755e-14  1.1965779e-13  0              3.560566     
   2700000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    6.4723654e-17  0              6.2505472e-12  1.1965779e-13  0              3.560566     
   2800000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    8.1163722e-19  0              7.8382113e-14  1.1965779e-13  0              3.560566     
   2900000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    4.5103267e-18  0              4.3557507e-13  1.1965779e-13  0              3.560566     
   3000000   6363.961       200            200            0.0038796726  -0.0023621938   0              0.014001212    4.8188968e-18  0              4.6537456e-13  1.1965779e-13  0              3.560566     
Loop time of 292.718 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8854931.030 ns/day, 0.000 hours/ns, 10248.763 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.293     | 41.136     | 71.735     | 460.6 | 14.05
Neigh   | 1.2803     | 1.2968     | 1.3129     |   1.0 |  0.44
Comm    | 12.583     | 17.817     | 23.844     | 100.3 |  6.09
Output  | 0.24252    | 0.24285    | 0.24322    |   0.1 |  0.08
Modify  | 173.91     | 176.32     | 179.04     |  14.4 | 60.23
Other   |            | 55.91      |            |       | 19.10

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         331.75 ave         664 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1327
Ave neighs/atom = 0.53058776
Neighbor list builds = 148
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.14                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 81.7376837142197
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.24
  ghost atom cutoff = 4.24
  binsize = 2.12, bins = 3002 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.59 | 41.6 | 41.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00045239108  6.143904e-40   0             -0.0013571732   455582.43      0              4.399689e+10   1.1965779e-13  0              3.7302946    
    200000   6363.961       200            200           -0.00010044519  8.521299e-40   0             -0.00030133557  1866.2053      0              1.8022475e+08  1.1965779e-13  0              3.7275698    
    300000   6363.961       200            200            0.00030024851 -1.2693069e-35  0              0.00090074553  12884.537      0              1.2442963e+09  1.1965779e-13  0              3.5939287    
    400000   6363.961       200            200            0.018698506   -0.0056556658   0              0.061751185    347.9475       0              33602279       1.1965779e-13  0              3.560667     
    500000   6363.961       200            200            0.0087885063  -0.003315381    0              0.0296809      104.09019      0              10052285       1.1965779e-13  0              3.5635388    
    600000   6363.961       200            200            0.0046184126  -0.0022185209   0              0.016073759    135.74453      0              13109235       1.1965779e-13  0              3.5652641    
    700000   6363.961       200            200            0.0043398736  -0.0023724722   0              0.015392093    10.939458      0              1056454.5      1.1965779e-13  0              3.5653584    
    800000   6363.961       200            200            0.0041082926  -0.0023854282   0              0.014710306    0.19400454     0              18735.57       1.1965779e-13  0              3.5654605    
    900000   6363.961       200            200            0.003967729   -0.0023648452   0              0.014268032    0.036039763    0              3480.4624      1.1965779e-13  0              3.5655292    
   1000000   6363.961       200            200            0.0039067817  -0.0023591089   0              0.014079454    0.031789103    0              3069.9641      1.1965779e-13  0              3.5655592    
   1100000   6363.961       200            200            0.0038886352  -0.0023574213   0              0.014023327    0.0069271324   0              668.97286      1.1965779e-13  0              3.5655682    
   1200000   6363.961       200            200            0.0038857715  -0.0023571652   0              0.01401448     0.00071262105  0              68.81984       1.1965779e-13  0              3.5655697    
   1300000   6363.961       200            200            0.0038864768  -0.0023572211   0              0.014016652    2.5471075e-05  0              2.4598141      1.1965779e-13  0              3.5655693    
   1400000   6363.961       200            200            0.0038872928  -0.0023572897   0              0.014019168    2.7395334e-07  0              0.026456453    1.1965779e-13  0              3.565569     
   1500000   6363.961       200            200            0.003887695   -0.0023573239   0              0.014020409    9.9827932e-07  0              0.096406671    1.1965779e-13  0              3.5655688    
   1600000   6363.961       200            200            0.00388783    -0.0023573355   0              0.014020826    2.8961675e-07  0              0.027969113    1.1965779e-13  0              3.5655687    
   1700000   6363.961       200            200            0.0038878581  -0.002357338    0              0.014020912    3.7324875e-08  0              0.0036045693   1.1965779e-13  0              3.5655687    
   1800000   6363.961       200            200            0.0038878569  -0.0023573379   0              0.014020909    2.0400121e-09  0              0.00019700977  1.1965779e-13  0              3.5655687    
   1900000   6363.961       200            200            0.0038878525  -0.0023573376   0              0.014020895    2.1834303e-12  0              2.1086007e-07  1.1965779e-13  0              3.5655687    
   2000000   6363.961       200            200            0.0038878499  -0.0023573374   0              0.014020887    2.6908461e-11  0              2.5986266e-06  1.1965779e-13  0              3.5655687    
   2100000   6363.961       200            200            0.003887849   -0.0023573373   0              0.014020884    1.1286714e-11  0              1.0899901e-06  1.1965779e-13  0              3.5655687    
   2200000   6363.961       200            200            0.0038878487  -0.0023573372   0              0.014020883    1.8161616e-12  0              1.7539189e-07  1.1965779e-13  0              3.5655687    
   2300000   6363.961       200            200            0.0038878487  -0.0023573372   0              0.014020883    1.3545886e-13  0              1.3081647e-08  1.1965779e-13  0              3.5655687    
   2400000   6363.961       200            200            0.0038878487  -0.0023573372   0              0.014020883    1.9242403e-15  0              1.8582935e-10  1.1965779e-13  0              3.5655687    
   2500000   6363.961       200            200            0.0038878487  -0.0023573373   0              0.014020883    4.9050163e-16  0              4.7369136e-11  1.1965779e-13  0              3.5655687    
   2600000   6363.961       200            200            0.0038878487  -0.0023573373   0              0.014020883    4.3119674e-16  0              4.1641895e-11  1.1965779e-13  0              3.5655687    
   2700000   6363.961       200            200            0.0038878488  -0.0023573373   0              0.014020884    6.1356824e-17  0              5.9254029e-12  1.1965779e-13  0              3.5655687    
   2800000   6363.961       200            200            0.0038878487  -0.0023573373   0              0.014020884    2.6851797e-18  0              2.5931544e-13  1.1965779e-13  0              3.5655687    
   2900000   6363.961       200            200            0.0038878488  -0.0023573373   0              0.014020884    4.3077021e-18  0              4.1600703e-13  1.1965779e-13  0              3.5655687    
   3000000   6363.961       200            200            0.0038878487  -0.0023573373   0              0.014020884    7.3379107e-18  0              7.0864289e-13  1.1965779e-13  0              3.5655687    
Loop time of 294.259 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8808573.955 ns/day, 0.000 hours/ns, 10195.109 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.52      | 40.235     | 68.958     | 450.2 | 13.67
Neigh   | 1.2171     | 1.2333     | 1.2495     |   1.0 |  0.42
Comm    | 12.383     | 17.381     | 22.428     |  94.4 |  5.91
Output  | 0.24103    | 0.24134    | 0.24171    |   0.1 |  0.08
Modify  | 173.99     | 178.39     | 183.13     |  28.4 | 60.62
Other   |            | 56.78      |            |       | 19.30

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           1.75 ave           3 max           1 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         335.25 ave         671 max           0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 1341
Ave neighs/atom = 0.53618553
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.15                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 82.3314176033318
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.25
  ghost atom cutoff = 4.25
  binsize = 2.125, bins = 2995 95 95
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 41.54 | 41.55 | 41.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00046194067  3.4506884e-39  0             -0.001385822    448901.44      0              4.3351688e+10  1.1965779e-13  0              3.7397994    
    200000   6363.961       200            200           -8.931943e-05   2.5386689e-35  0             -0.00026795829  1454.2805      0              1.40444e+08    1.1965779e-13  0              3.7328932    
    300000   6363.961       200            200            0.0003164784  -1.2693077e-35  0              0.00094943521  14137.638      0              1.3653119e+09  1.1965779e-13  0              3.5975931    
    400000   6363.961       200            200            0.019124371   -0.005628891    0              0.063002003    9.3404676      0              902035.5       1.1965779e-13  0              3.5655732    
    500000   6363.961       200            200            0.0090195867  -0.0034151905   0              0.030473951    4.6176698      0              445941.5       1.1965779e-13  0              3.5684548    
    600000   6363.961       200            200            0.0049944591  -0.0023119986   0              0.017295376    102.31222      0              9880581.9      1.1965779e-13  0              3.5700891    
    700000   6363.961       200            200            0.004458821   -0.002374645    0              0.015751108    5.222939       0              504394.06      1.1965779e-13  0              3.5703088    
    800000   6363.961       200            200            0.0041236299  -0.0023814306   0              0.01475232     0.0068759369   0              664.02877      1.1965779e-13  0              3.5704593    
    900000   6363.961       200            200            0.0039619972  -0.0023589926   0              0.014244984    0.14352611     0              13860.725      1.1965779e-13  0              3.5705385    
   1000000   6363.961       200            200            0.0039044521  -0.0023534749   0              0.014066831    0.047417603    0              4579.2527      1.1965779e-13  0              3.5705669    
   1100000   6363.961       200            200            0.0038921243  -0.0023522796   0              0.014028653    0.006182155    0              597.02828      1.1965779e-13  0              3.5705731    
   1200000   6363.961       200            200            0.0038925424  -0.0023523028   0              0.01402993     0.00030315152  0              29.276204      1.1965779e-13  0              3.570573     
   1300000   6363.961       200            200            0.0038944594  -0.002352463    0              0.014035841    6.0896345e-08  0              0.0058809332   1.1965779e-13  0              3.5705721    
   1400000   6363.961       200            200            0.0038955433  -0.002352555    0              0.014039185    6.2185204e-06  0              0.60054019     1.1965779e-13  0              3.5705715    
   1500000   6363.961       200            200            0.0038959293  -0.0023525881   0              0.014040376    2.1003249e-06  0              0.20283435     1.1965779e-13  0              3.5705714    
   1600000   6363.961       200            200            0.0038960127  -0.0023525954   0              0.014040633    2.7611263e-07  0              0.026664982    1.1965779e-13  0              3.5705713    
   1700000   6363.961       200            200            0.0038960103  -0.0023525952   0              0.014040626    1.3701361e-08  0              0.0013231793   1.1965779e-13  0              3.5705713    
   1800000   6363.961       200            200            0.0038959976  -0.0023525942   0              0.014040587    1.5258062e-12  0              1.4735144e-07  1.1965779e-13  0              3.5705713    
   1900000   6363.961       200            200            0.0038959903  -0.0023525936   0              0.014040565    2.7260403e-10  0              2.6326146e-05  1.1965779e-13  0              3.5705713    
   2000000   6363.961       200            200            0.0038959878  -0.0023525934   0              0.014040557    9.3107825e-11  0              8.9916873e-06  1.1965779e-13  0              3.5705713    
   2100000   6363.961       200            200            0.0038959872  -0.0023525933   0              0.014040555    1.2324701e-11  0              1.1902314e-06  1.1965779e-13  0              3.5705713    
   2200000   6363.961       200            200            0.0038959872  -0.0023525933   0              0.014040555    6.1833021e-13  0              5.9713906e-08  1.1965779e-13  0              3.5705713    
   2300000   6363.961       200            200            0.0038959873  -0.0023525933   0              0.014040555    2.9471105e-17  0              2.8461084e-12  1.1965779e-13  0              3.5705713    
   2400000   6363.961       200            200            0.0038959873  -0.0023525933   0              0.014040555    1.1667592e-14  0              1.1267725e-09  1.1965779e-13  0              3.5705713    
   2500000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    4.0593582e-15  0              3.9202376e-10  1.1965779e-13  0              3.5705713    
   2600000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    5.5675784e-16  0              5.3767687e-11  1.1965779e-13  0              3.5705713    
   2700000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    7.9136283e-19  0              7.6424158e-14  1.1965779e-13  0              3.5705713    
   2800000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    1.1698553e-17  0              1.1297625e-12  1.1965779e-13  0              3.5705713    
   2900000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    3.4712694e-18  0              3.3523036e-13  1.1965779e-13  0              3.5705713    
   3000000   6363.961       200            200            0.0038959874  -0.0023525933   0              0.014040555    6.8546975e-18  0              6.6197762e-13  1.1965779e-13  0              3.5705713    
Loop time of 314.109 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8251922.429 ns/day, 0.000 hours/ns, 9550.836 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.881     | 59.64      | 88.51      | 362.1 | 18.99
Neigh   | 1.1728     | 1.1888     | 1.2043     |   1.0 |  0.38
Comm    | 24.463     | 51.859     | 79.823     | 377.0 | 16.51
Output  | 0.24251    | 0.24282    | 0.24318    |   0.1 |  0.08
Modify  | 107.27     | 144.35     | 179.48     | 292.3 | 45.96
Other   |            | 56.83      |            |       | 18.09

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         713.25 ave        1053 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2853
Ave neighs/atom = 1.1407437
Neighbor list builds = 138
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.16                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 82.9280197665364
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.26
  ghost atom cutoff = 4.26
  binsize = 2.13, bins = 2988 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.89 | 40.9 | 40.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00047128247  5.0773109e-35  0             -0.0014138474   442273.77      0              4.2711635e+10  1.1965779e-13  0              3.7492725    
    200000   6363.961       200            200           -7.8033774e-05  2.5806916e-41  0             -0.00023410132  1093.9694      0              1.0564773e+08  1.1965779e-13  0              3.7381667    
    300000   6363.961       200            200            0.00033286183  1.5232026e-34  0              0.00099858548  15447.279      0              1.4917876e+09  1.1965779e-13  0              3.6011936    
    400000   6363.961       200            200            0.018325828   -0.005684382    0              0.060661865    601.46129      0              58084826       1.1965779e-13  0              3.570751     
    500000   6363.961       200            200            0.0089359744  -0.0034085112   0              0.030216434    36.411082      0              3516321.7      1.1965779e-13  0              3.5734849    
    600000   6363.961       200            200            0.0053075841  -0.002422741    0              0.018345493    62.844224      0              6069045.3      1.1965779e-13  0              3.5749443    
    700000   6363.961       200            200            0.0045372737  -0.0023639237   0              0.015975745    1.1707827      0              113065.81      1.1965779e-13  0              3.5752799    
    800000   6363.961       200            200            0.0041168257  -0.0023740546   0              0.014724532    0.35628437     0              34407.395      1.1965779e-13  0              3.575469     
    900000   6363.961       200            200            0.0039490798  -0.0023503037   0              0.014197543    0.27238781     0              26305.265      1.1965779e-13  0              3.5755516    
   1000000   6363.961       200            200            0.0039016318  -0.0023455917   0              0.014050487    0.050961023    0              4921.4509      1.1965779e-13  0              3.5755753    
   1100000   6363.961       200            200            0.0038969924  -0.0023450597   0              0.014036037    0.0036759727   0              354.99913      1.1965779e-13  0              3.5755777    
   1200000   6363.961       200            200            0.0039007166  -0.0023453651   0              0.014047515    2.2045125e-05  0              2.1289603      1.1965779e-13  0              3.575576     
   1300000   6363.961       200            200            0.0039035081  -0.0023455997   0              0.014056124    2.9749377e-05  0              2.8729819      1.1965779e-13  0              3.5755746    
   1400000   6363.961       200            200            0.0039046233  -0.0023456944   0              0.014059564    1.4379288e-05  0              1.3886487      1.1965779e-13  0              3.5755741    
   1500000   6363.961       200            200            0.0039048929  -0.0023457177   0              0.014060396    2.1346449e-06  0              0.20614873     1.1965779e-13  0              3.5755739    
   1600000   6363.961       200            200            0.0039048987  -0.0023457184   0              0.014060415    1.1228392e-07  0              0.010843577    1.1965779e-13  0              3.5755739    
   1700000   6363.961       200            200            0.0039048658  -0.0023457157   0              0.014060313    8.1248643e-12  0              7.8464124e-07  1.1965779e-13  0              3.5755739    
   1800000   6363.961       200            200            0.0039048459  -0.002345714    0              0.014060252    2.1915403e-09  0              0.00021164328  1.1965779e-13  0              3.575574     
   1900000   6363.961       200            200            0.0039048388  -0.0023457134   0              0.01406023     7.1445548e-10  0              6.8996996e-05  1.1965779e-13  0              3.575574     
   2000000   6363.961       200            200            0.0039048374  -0.0023457133   0              0.014060225    8.4103563e-11  0              8.1221201e-06  1.1965779e-13  0              3.575574     
   2100000   6363.961       200            200            0.0039048375  -0.0023457133   0              0.014060226    2.9210506e-12  0              2.8209416e-07  1.1965779e-13  0              3.575574     
   2200000   6363.961       200            200            0.0039048378  -0.0023457133   0              0.014060227    6.0658837e-14  0              5.8579963e-09  1.1965779e-13  0              3.575574     
   2300000   6363.961       200            200            0.0039048379  -0.0023457133   0              0.014060227    1.3878182e-13  0              1.3402555e-08  1.1965779e-13  0              3.575574     
   2400000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    3.3470451e-14  0              3.2323366e-09  1.1965779e-13  0              3.575574     
   2500000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    3.0347846e-15  0              2.9307777e-10  1.1965779e-13  0              3.575574     
   2600000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    4.1079034e-17  0              3.9671191e-12  1.1965779e-13  0              3.575574     
   2700000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    4.5035285e-17  0              4.3491854e-12  1.1965779e-13  0              3.575574     
   2800000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    1.2509524e-18  0              1.2080802e-13  1.1965779e-13  0              3.575574     
   2900000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    3.0938181e-18  0              2.9877881e-13  1.1965779e-13  0              3.575574     
   3000000   6363.961       200            200            0.003904838   -0.0023457133   0              0.014060227    2.6753868e-18  0              2.5836971e-13  1.1965779e-13  0              3.575574     
Loop time of 324.253 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7993757.814 ns/day, 0.000 hours/ns, 9252.035 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 32.618     | 60.657     | 89.429     | 356.0 | 18.71
Neigh   | 1.1623     | 1.1784     | 1.1938     |   1.0 |  0.36
Comm    | 22.835     | 51.452     | 78.903     | 378.7 | 15.87
Output  | 0.24004    | 0.24039    | 0.24076    |   0.1 |  0.07
Modify  | 111.78     | 148.72     | 190.65     | 303.3 | 45.86
Other   |            | 62.01      |            |       | 19.12

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         715.75 ave        1058 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2863
Ave neighs/atom = 1.1447421
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.17                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 83.5274971153375
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.27
  ghost atom cutoff = 4.27
  binsize = 2.135, bins = 2981 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.86 | 40.86 | 40.87 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00048041706  3.8079869e-35  0             -0.0014412512   435699.31      0              4.2076721e+10  1.1965779e-13  0              3.758714     
    200000   6363.961       200            200           -6.6589073e-05  5.077397e-35   0             -0.00019976722  785.12612      0              75821860       1.1965779e-13  0              3.7433902    
    300000   6363.961       200            200            0.00034939766 -2.5386188e-35  0              0.001048193    16813.265      0              1.6237047e+09  1.1965779e-13  0              3.60473      
    400000   6363.961       200            200            0.01642981    -0.0057744423   0              0.055063871    1953.4426      0              1.886495e+08   1.1965779e-13  0              3.5761886    
    500000   6363.961       200            200            0.0085236814  -0.0033604569   0              0.028931501    191.0483       0              18450077       1.1965779e-13  0              3.5786277    
    600000   6363.961       200            200            0.0055518932  -0.0024790123   0              0.019134692    27.187343      0              2625558.9      1.1965779e-13  0              3.5798393    
    700000   6363.961       200            200            0.0045636174  -0.0023551145   0              0.016045967    0.042623888    0              4116.31        1.1965779e-13  0              3.5802741    
    800000   6363.961       200            200            0.0040892553  -0.0023639796   0              0.014631746    1.1049555      0              106708.69      1.1965779e-13  0              3.5804888    
    900000   6363.961       200            200            0.0039310845  -0.0023406334   0              0.014133887    0.36271555     0              35028.471      1.1965779e-13  0              3.5805674    
   1000000   6363.961       200            200            0.0038994496  -0.0023372591   0              0.014035608    0.040546262    0              3915.6677      1.1965779e-13  0              3.5805834    
   1100000   6363.961       200            200            0.0039033636  -0.0023374669   0              0.014047558    0.0010504976   0              101.44954      1.1965779e-13  0              3.5805817    
   1200000   6363.961       200            200            0.0039098758  -0.0023380091   0              0.014067637    7.9051458e-05  0              7.634224       1.1965779e-13  0              3.5805785    
   1300000   6363.961       200            200            0.0039130257  -0.002338274    0              0.014077351    8.7963788e-05  0              8.4949131      1.1965779e-13  0              3.580577     
   1400000   6363.961       200            200            0.0039139222  -0.0023383504   0              0.014080117    1.6683168e-05  0              1.6111409      1.1965779e-13  0              3.5805766    
   1500000   6363.961       200            200            0.0039140025  -0.0023383577   0              0.014080365    1.0744012e-06  0              0.10375797     1.1965779e-13  0              3.5805765    
   1600000   6363.961       200            200            0.0039139269  -0.0023383516   0              0.014080132    1.110892e-09   0              0.000107282    1.1965779e-13  0              3.5805766    
   1700000   6363.961       200            200            0.0039138735  -0.0023383471   0              0.014079968    1.4624236e-08  0              0.0014123041   1.1965779e-13  0              3.5805766    
   1800000   6363.961       200            200            0.0039138536  -0.0023383454   0              0.014079906    5.2719866e-09  0              0.00050913073  1.1965779e-13  0              3.5805766    
   1900000   6363.961       200            200            0.0039138496  -0.0023383451   0              0.014079894    6.0510918e-10  0              5.8437113e-05  1.1965779e-13  0              3.5805766    
   2000000   6363.961       200            200            0.00391385    -0.0023383451   0              0.014079895    1.6560967e-11  0              1.5993397e-06  1.1965779e-13  0              3.5805766    
   2100000   6363.961       200            200            0.0039138508  -0.0023383452   0              0.014079898    1.0472354e-12  0              1.011345e-07   1.1965779e-13  0              3.5805766    
   2200000   6363.961       200            200            0.0039138512  -0.0023383452   0              0.014079899    1.265532e-12   0              1.2221602e-07  1.1965779e-13  0              3.5805766    
   2300000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    2.456779e-13   0              2.3725813e-08  1.1965779e-13  0              3.5805766    
   2400000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    1.6025906e-14  0              1.5476673e-09  1.1965779e-13  0              3.5805766    
   2500000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    1.4820408e-17  0              1.4312489e-12  1.1965779e-13  0              3.5805766    
   2600000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    2.3420312e-16  0              2.2617661e-11  1.1965779e-13  0              3.5805766    
   2700000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    7.2667573e-17  0              7.0177141e-12  1.1965779e-13  0              3.5805766    
   2800000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    2.317334e-18   0              2.2379153e-13  1.1965779e-13  0              3.5805766    
   2900000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    7.2988208e-18  0              7.0486787e-13  1.1965779e-13  0              3.5805766    
   3000000   6363.961       200            200            0.0039138513  -0.0023383452   0              0.014079899    5.4230194e-18  0              5.237164e-13   1.1965779e-13  0              3.5805766    
Loop time of 315.517 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8215090.662 ns/day, 0.000 hours/ns, 9508.207 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 33.344     | 60.901     | 88.499     | 351.6 | 19.30
Neigh   | 1.1712     | 1.1877     | 1.2036     |   1.1 |  0.38
Comm    | 23.36      | 50.959     | 78.389     | 378.3 | 16.15
Output  | 0.24499    | 0.24533    | 0.24571    |   0.1 |  0.08
Modify  | 109.1      | 145.34     | 181.31     | 293.6 | 46.06
Other   |            | 56.89      |            |       | 18.03

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         718.75 ave        1064 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2875
Ave neighs/atom = 1.1495402
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.18                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 84.1298565612391
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.28
  ghost atom cutoff = 4.28
  binsize = 2.14, bins = 2974 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.75 | 40.77 | 40.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00048934501  3.9666422e-37  0             -0.001468035    429177.97      0              4.1446937e+10  1.1965779e-13  0              3.7681237    
    200000   6363.961       200            200           -5.4986285e-05  2.411718e-34   0             -0.00016495885  527.60854      0              50952656       1.1965779e-13  0              3.7485636    
    300000   6363.961       200            200            0.00036608455 -5.0771302e-35  0              0.0010982536   18235.38       0              1.7610425e+09  1.1965779e-13  0              3.608202     
    400000   6363.961       200            200            0.013603994   -0.0062076483   0              0.04701963     3694.1227      0              3.5675193e+08  1.1965779e-13  0              3.5818558    
    500000   6363.961       200            200            0.0078627717  -0.0031706639   0              0.026758979    429.77718      0              41504804       1.1965779e-13  0              3.5838745    
    600000   6363.961       200            200            0.0056905737  -0.0025182705   0              0.019589992    4.6154369      0              445725.86      1.1965779e-13  0              3.5847815    
    700000   6363.961       200            200            0.0045368446  -0.0023457924   0              0.015956326    2.1772313      0              210261.42      1.1965779e-13  0              3.5852923    
    800000   6363.961       200            200            0.0040445138  -0.0023519178   0              0.014485459    1.9646411      0              189730.98      1.1965779e-13  0              3.585517     
    900000   6363.961       200            200            0.0039112828  -0.0023302066   0              0.014064055    0.37306498     0              36027.945      1.1965779e-13  0              3.5855842    
   1000000   6363.961       200            200            0.0038994083  -0.0023288941   0              0.014027119    0.022000278    0              2124.6294      1.1965779e-13  0              3.5855905    
   1100000   6363.961       200            200            0.0039115687  -0.0023298684   0              0.014064574    1.3636979e-06  0              0.13169619     1.1965779e-13  0              3.5855848    
   1200000   6363.961       200            200            0.0039198762  -0.0023305622   0              0.014090191    0.00042638834  0              41.177534      1.1965779e-13  0              3.5855807    
   1300000   6363.961       200            200            0.0039227843  -0.002330807    0              0.01409916     0.00012400533  0              11.975547      1.1965779e-13  0              3.5855793    
   1400000   6363.961       200            200            0.0039232543  -0.0023308477   0              0.014100611    1.0930189e-05  0              1.0555594      1.1965779e-13  0              3.5855791    
   1500000   6363.961       200            200            0.0039231192  -0.0023308371   0              0.014100195    9.4224901e-08  0              0.0090995665   1.1965779e-13  0              3.5855791    
   1600000   6363.961       200            200            0.0039229821  -0.0023308257   0              0.014099772    7.7137458e-08  0              0.0074493835   1.1965779e-13  0              3.5855792    
   1700000   6363.961       200            200            0.0039229253  -0.002330821    0              0.014099597    3.7344628e-08  0              0.0036064769   1.1965779e-13  0              3.5855792    
   1800000   6363.961       200            200            0.0039229127  -0.0023308199   0              0.014099558    4.6567527e-09  0              0.00044971584  1.1965779e-13  0              3.5855792    
   1900000   6363.961       200            200            0.0039229135  -0.00233082     0              0.01409956     1.2701674e-10  0              1.2266367e-05  1.1965779e-13  0              3.5855792    
   2000000   6363.961       200            200            0.0039229156  -0.0023308201   0              0.014099567    9.2074889e-12  0              8.8919337e-07  1.1965779e-13  0              3.5855792    
   2100000   6363.961       200            200            0.0039229166  -0.0023308202   0              0.01409957     1.0105158e-11  0              9.7588383e-07  1.1965779e-13  0              3.5855792    
   2200000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    1.766991e-12   0              1.7064334e-07  1.1965779e-13  0              3.5855792    
   2300000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    8.8883684e-14  0              8.58375e-09    1.1965779e-13  0              3.5855792    
   2400000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    2.1325217e-16  0              2.0594369e-11  1.1965779e-13  0              3.5855792    
   2500000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    2.3337841e-15  0              2.2538016e-10  1.1965779e-13  0              3.5855792    
   2600000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    6.1072641e-16  0              5.8979585e-11  1.1965779e-13  0              3.5855792    
   2700000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    7.3146642e-18  0              7.0639791e-13  1.1965779e-13  0              3.5855792    
   2800000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    1.1704097e-17  0              1.130298e-12   1.1965779e-13  0              3.5855792    
   2900000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    2.796088e-18   0              2.7002616e-13  1.1965779e-13  0              3.5855792    
   3000000   6363.961       200            200            0.0039229169  -0.0023308203   0              0.014099571    5.7095767e-18  0              5.5139005e-13  1.1965779e-13  0              3.5855792    
Loop time of 323.039 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8023795.281 ns/day, 0.000 hours/ns, 9286.800 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 32.149     | 63.507     | 98.495     | 392.4 | 19.66
Neigh   | 1.1806     | 1.1952     | 1.2101     |   1.0 |  0.37
Comm    | 24.721     | 56.442     | 90.353     | 392.1 | 17.47
Output  | 0.24416    | 0.24448    | 0.24485    |   0.1 |  0.08
Modify  | 107.28     | 145.38     | 179.42     | 278.9 | 45.00
Other   |            | 56.27      |            |       | 17.42

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         721.75 ave        1070 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2887
Ave neighs/atom = 1.1543383
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.19                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 84.7351050157449
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.29
  ghost atom cutoff = 4.29
  binsize = 2.145, bins = 2967 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.71 | 40.71 | 40.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0004980669   3.7951204e-40  0             -0.0014942007   422709.67      0              4.0822274e+10  1.1965779e-13  0              3.7775015    
    200000   6363.961       200            200           -4.3226334e-05 -1.5866563e-35  0             -0.000129679    321.27322      0              31026268       1.1965779e-13  0              3.7536867    
    300000   6363.961       200            200            0.00038292118  2.5386737e-35  0              0.0011487635   19713.417      0              1.9037807e+09  1.1965779e-13  0              3.6116097    
    400000   6363.961       200            200            0.010373381   -0.0065380275   0              0.037658171    5390.2038      0              5.2054731e+08  1.1965779e-13  0              3.5877085    
    500000   6363.961       200            200            0.0069380141  -0.0031147794   0              0.023928822    695.40765      0              67157493       1.1965779e-13  0              3.5892103    
    600000   6363.961       200            200            0.0057159404  -0.0025182576   0              0.019666079    1.1276872      0              108903.96      1.1965779e-13  0              3.589775     
    700000   6363.961       200            200            0.0044592855  -0.0023388245   0              0.015716681    6.8766469      0              664097.34      1.1965779e-13  0              3.590333     
    800000   6363.961       200            200            0.0039883305  -0.0023374948   0              0.014302486    2.6080328      0              251865.14      1.1965779e-13  0              3.5905512    
    900000   6363.961       200            200            0.0038927947  -0.0023203059   0              0.01399869     0.29921503     0              28896.046      1.1965779e-13  0              3.5906003    
   1000000   6363.961       200            200            0.0039026053  -0.0023211791   0              0.014028995    0.0055336292   0              534.3983       1.1965779e-13  0              3.590596     
   1100000   6363.961       200            200            0.0039215671  -0.0023228085   0              0.01408751     0.0011833627   0              114.2807       1.1965779e-13  0              3.5905869    
   1200000   6363.961       200            200            0.0039303504  -0.0023235433   0              0.014114595    0.00079954732  0              77.214557      1.1965779e-13  0              3.5905826    
   1300000   6363.961       200            200            0.0039324458  -0.002323721    0              0.014121058    0.00010705232  0              10.338347      1.1965779e-13  0              3.5905816    
   1400000   6363.961       200            200            0.0039323716  -0.0023237165   0              0.014120831    2.7929265e-06  0              0.26972085     1.1965779e-13  0              3.5905816    
   1500000   6363.961       200            200            0.0039320498  -0.0023236903   0              0.01411984     2.5903773e-07  0              0.02501601     1.1965779e-13  0              3.5905817    
   1600000   6363.961       200            200            0.0039318893  -0.0023236769   0              0.014119345    2.4495829e-07  0              0.023656318    1.1965779e-13  0              3.5905818    
   1700000   6363.961       200            200            0.0039318477  -0.0023236734   0              0.014119216    3.7505274e-08  0              0.003621991    1.1965779e-13  0              3.5905818    
   1800000   6363.961       200            200            0.0039318472  -0.0023236734   0              0.014119215    1.2897551e-09  0              0.00012455532  1.1965779e-13  0              3.5905818    
   1900000   6363.961       200            200            0.0039318526  -0.0023236738   0              0.014119232    5.0009133e-11  0              4.8295241e-06  1.1965779e-13  0              3.5905818    
   2000000   6363.961       200            200            0.0039318555  -0.002323674    0              0.014119241    7.3742524e-11  0              7.1215251e-06  1.1965779e-13  0              3.5905818    
   2100000   6363.961       200            200            0.0039318563  -0.0023236741   0              0.014119243    1.2938088e-11  0              1.249468e-06   1.1965779e-13  0              3.5905818    
   2200000   6363.961       200            200            0.0039318564  -0.0023236741   0              0.014119243    5.6089946e-13  0              5.4167655e-08  1.1965779e-13  0              3.5905818    
   2300000   6363.961       200            200            0.0039318563  -0.0023236741   0              0.014119243    7.7264613e-15  0              7.4616633e-10  1.1965779e-13  0              3.5905818    
   2400000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    2.1519499e-14  0              2.0781992e-09  1.1965779e-13  0              3.5905818    
   2500000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    4.430867e-15   0              4.2790142e-10  1.1965779e-13  0              3.5905818    
   2600000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    2.4451607e-16  0              2.3613612e-11  1.1965779e-13  0              3.5905818    
   2700000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    2.6518096e-17  0              2.5609279e-12  1.1965779e-13  0              3.5905818    
   2800000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    2.334102e-18   0              2.2541087e-13  1.1965779e-13  0              3.5905818    
   2900000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    4.4626185e-19  0              4.3096775e-14  1.1965779e-13  0              3.5905818    
   3000000   6363.961       200            200            0.0039318562  -0.0023236741   0              0.014119243    1.5518609e-19  0              1.4986762e-14  1.1965779e-13  0              3.5905818    
Loop time of 313.438 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8269576.171 ns/day, 0.000 hours/ns, 9571.269 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 32.153     | 61.219     | 89.297     | 353.1 | 19.53
Neigh   | 1.1914     | 1.2077     | 1.2238     |   1.1 |  0.39
Comm    | 23.24      | 51.225     | 79.492     | 379.0 | 16.34
Output  | 0.24492    | 0.24524    | 0.24559    |   0.1 |  0.08
Modify  | 108.36     | 143.41     | 178.63     | 288.9 | 45.76
Other   |            | 56.13      |            |       | 17.91

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         724.25 ave        1075 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2897
Ave neighs/atom = 1.1583367
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.2                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 85.343249390359
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.3
  ghost atom cutoff = 4.3
  binsize = 2.15, bins = 2960 94 94
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.63 | 40.64 | 40.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00050658331  6.346634e-36   0             -0.0015197499   416294.29      0              4.0202723e+10  1.1965779e-13  0              3.7868475    
    200000   6363.961       200            200           -3.1310089e-05  2.0116993e-41  0             -9.3930268e-05  165.97625      0              16028799       1.1965779e-13  0              3.7587595    
    300000   6363.961       200            200            0.00039990638 -1.9833202e-37  0              0.0011997191   21247.177      0              2.0519002e+09  1.1965779e-13  0              3.6149528    
    400000   6363.961       200            200            0.0074817885  -0.0056623106   0              0.028107676    6687.6075      0              6.4584127e+08  1.1965779e-13  0              3.5936952    
    500000   6363.961       200            200            0.005817485   -0.0032717897   0              0.020724245    929.13105      0              89728827       1.1965779e-13  0              3.5946156    
    600000   6363.961       200            200            0.0056171777  -0.0025035524   0              0.019355086    17.582536      0              1697995.4      1.1965779e-13  0              3.5948206    
    700000   6363.961       200            200            0.0043424675  -0.0023236828   0              0.015351085    12.640835      0              1220761.3      1.1965779e-13  0              3.5953932    
    800000   6363.961       200            200            0.0039269339  -0.002322204    0              0.014103006    2.7937457      0              269799.96      1.1965779e-13  0              3.5955882    
    900000   6363.961       200            200            0.0038789817  -0.0023108263   0              0.013947771    0.17550057     0              16948.589      1.1965779e-13  0              3.5956142    
   1000000   6363.961       200            200            0.0039099608  -0.0023138355   0              0.014043718    9.6390707e-05  0              9.3087245      1.1965779e-13  0              3.5955995    
   1100000   6363.961       200            200            0.0039333124  -0.0023158538   0              0.014115791    0.0038066939   0              367.62325      1.1965779e-13  0              3.5955881    
   1200000   6363.961       200            200            0.0039411325  -0.0023165098   0              0.014139907    0.0009186778   0              88.719326      1.1965779e-13  0              3.5955843    
   1300000   6363.961       200            200            0.0039419853  -0.002316585    0              0.014142541    5.2060185e-05  0              5.0276         1.1965779e-13  0              3.5955839    
   1400000   6363.961       200            200            0.0039413678  -0.0023165354   0              0.014140639    1.5028636e-07  0              0.014513581    1.1965779e-13  0              3.5955842    
   1500000   6363.961       200            200            0.0039409365  -0.0023164999   0              0.014139309    1.3714887e-06  0              0.13244857     1.1965779e-13  0              3.5955844    
   1600000   6363.961       200            200            0.0039407987  -0.0023164884   0              0.014138884    3.001976e-07   0              0.028990935    1.1965779e-13  0              3.5955844    
   1700000   6363.961       200            200            0.0039407862  -0.0023164872   0              0.014138846    1.5114728e-08  0              0.0014596723   1.1965779e-13  0              3.5955844    
   1800000   6363.961       200            200            0.0039407984  -0.0023164882   0              0.014138883    1.1756392e-10  0              1.1353482e-05  1.1965779e-13  0              3.5955844    
   1900000   6363.961       200            200            0.0039408063  -0.0023164889   0              0.014138908    4.8959189e-10  0              4.728128e-05   1.1965779e-13  0              3.5955844    
   2000000   6363.961       200            200            0.0039408087  -0.0023164891   0              0.014138915    9.7568423e-11  0              9.42246e-06    1.1965779e-13  0              3.5955844    
   2100000   6363.961       200            200            0.0039408089  -0.0023164891   0              0.014138916    4.325964e-12   0              4.1777064e-07  1.1965779e-13  0              3.5955844    
   2200000   6363.961       200            200            0.0039408086  -0.0023164891   0              0.014138915    7.0526016e-14  0              6.8108978e-09  1.1965779e-13  0              3.5955844    
   2300000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138915    1.7333791e-13  0              1.6739735e-08  1.1965779e-13  0              3.5955844    
   2400000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    3.1441687e-14  0              3.0364131e-09  1.1965779e-13  0              3.5955844    
   2500000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    1.2541713e-15  0              1.2111888e-10  1.1965779e-13  0              3.5955844    
   2600000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    4.2229112e-17  0              4.0781854e-12  1.1965779e-13  0              3.5955844    
   2700000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    8.1934918e-17  0              7.9126879e-12  1.1965779e-13  0              3.5955844    
   2800000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    1.044785e-18   0              1.0089786e-13  1.1965779e-13  0              3.5955844    
   2900000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    8.4382359e-19  0              8.1490443e-14  1.1965779e-13  0              3.5955844    
   3000000   6363.961       200            200            0.0039408085  -0.0023164891   0              0.014138914    2.9663531e-20  0              2.8646915e-15  1.1965779e-13  0              3.5955844    
Loop time of 317.485 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8164157.816 ns/day, 0.000 hours/ns, 9449.257 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 31.546     | 60.45      | 90.214     | 370.1 | 19.04
Neigh   | 1.1885     | 1.2036     | 1.2194     |   1.0 |  0.38
Comm    | 23.245     | 52.648     | 81.186     | 386.2 | 16.58
Output  | 0.24266    | 0.24299    | 0.24337    |   0.1 |  0.08
Modify  | 110.65     | 146.14     | 181.6      | 292.0 | 46.03
Other   |            | 56.8       |            |       | 17.89

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         726.75 ave        1080 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2907
Ave neighs/atom = 1.1623351
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.21                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 85.9542965965847
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.31
  ghost atom cutoff = 4.31
  binsize = 2.155, bins = 2954 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 40.01 | 40.02 | 40.03 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00051489482 -1.5231855e-34  0             -0.0015446845   409931.76      0              3.9588275e+10  1.1965779e-13  0              3.7961616    
    200000   6363.961       200            200           -1.923848e-05   7.615958e-35   0             -5.771544e-05   61.575074      0              5946479.9      1.1965779e-13  0              3.7637818    
    300000   6363.961       200            200            0.00041703886 -1.5231817e-34  0              0.0012511166   22836.452      0              2.2053811e+09  1.1965779e-13  0              3.6182312    
    400000   6363.961       200            200            0.004856139   -0.0047439815   0              0.019312399    7394.4131      0              7.1409949e+08  1.1965779e-13  0              3.5997626    
    500000   6363.961       200            200            0.0047469934  -0.0031720499   0              0.01741303     1085.3165      0              1.048121e+08   1.1965779e-13  0              3.6000679    
    600000   6363.961       200            200            0.0053905951  -0.0025160992   0              0.018687885    49.399495      0              4770649.6      1.1965779e-13  0              3.5999151    
    700000   6363.961       200            200            0.0041974115  -0.0023010948   0              0.014893329    17.662421      0              1705710.2      1.1965779e-13  0              3.6004683    
    800000   6363.961       200            200            0.0038678113  -0.0023049345   0              0.013908368    2.4557466      0              237158.43      1.1965779e-13  0              3.6006248    
    900000   6363.961       200            200            0.0038723372  -0.0023024688   0              0.01391948     0.058576551    0              5656.904       1.1965779e-13  0              3.6006245    
   1000000   6363.961       200            200            0.003921553   -0.0023072913   0              0.01407195     0.0085205905   0              822.85764      1.1965779e-13  0              3.6006008    
   1100000   6363.961       200            200            0.0039461829  -0.0023094052   0              0.014147954    0.0061662354   0              595.49088      1.1965779e-13  0              3.6005888    
   1200000   6363.961       200            200            0.0039517153  -0.0023098729   0              0.014165019    0.00069686681  0              67.298409      1.1965779e-13  0              3.600586     
   1300000   6363.961       200            200            0.0039511237  -0.0023098289   0              0.0141632      6.1047982e-06  0              0.58955771     1.1965779e-13  0              3.6005863    
   1400000   6363.961       200            200            0.0039500856  -0.0023097442   0              0.014160001    5.4558286e-06  0              0.52688487     1.1965779e-13  0              3.6005868    
   1500000   6363.961       200            200            0.0039496519  -0.0023097082   0              0.014158664    2.214839e-06   0              0.2138933      1.1965779e-13  0              3.600587     
   1600000   6363.961       200            200            0.0039495774  -0.0023097018   0              0.014158434    1.7745841e-07  0              0.017137664    1.1965779e-13  0              3.6005871    
   1700000   6363.961       200            200            0.0039495989  -0.0023097035   0              0.0141585      6.0336131e-11  0              5.8268316e-06  1.1965779e-13  0              3.600587     
   1800000   6363.961       200            200            0.0039496197  -0.0023097052   0              0.014158564    2.802151e-09   0              0.00027061169  1.1965779e-13  0              3.600587     
   1900000   6363.961       200            200            0.003949627   -0.0023097059   0              0.014158587    7.4137231e-10  0              7.1596431e-05  1.1965779e-13  0              3.600587     
   2000000   6363.961       200            200            0.0039496278  -0.0023097059   0              0.014158589    4.0104175e-11  0              3.8729742e-06  1.1965779e-13  0              3.600587     
   2100000   6363.961       200            200            0.0039496273  -0.0023097059   0              0.014158588    2.891907e-13   0              2.7927968e-08  1.1965779e-13  0              3.600587     
   2200000   6363.961       200            200            0.0039496269  -0.0023097058   0              0.014158586    1.2540612e-12  0              1.2110826e-07  1.1965779e-13  0              3.600587     
   2300000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    2.3175538e-13  0              2.2381276e-08  1.1965779e-13  0              3.600587     
   2400000   6363.961       200            200            0.0039496267  -0.0023097058   0              0.014158586    7.3543586e-15  0              7.1023131e-10  1.1965779e-13  0              3.600587     
   2500000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    5.1336532e-16  0              4.9577148e-11  1.1965779e-13  0              3.600587     
   2600000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    5.2184684e-16  0              5.0396233e-11  1.1965779e-13  0              3.600587     
   2700000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    2.4164403e-17  0              2.3336251e-12  1.1965779e-13  0              3.600587     
   2800000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    1.1140652e-17  0              1.0758844e-12  1.1965779e-13  0              3.600587     
   2900000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    7.5475835e-18  0              7.2889159e-13  1.1965779e-13  0              3.600587     
   3000000   6363.961       200            200            0.0039496268  -0.0023097058   0              0.014158586    4.8929164e-18  0              4.7252284e-13  1.1965779e-13  0              3.600587     
Loop time of 313.725 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8262019.724 ns/day, 0.000 hours/ns, 9562.523 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.431     | 59.087     | 90.078     | 367.8 | 18.83
Neigh   | 1.1496     | 1.165      | 1.1805     |   1.0 |  0.37
Comm    | 22.943     | 52.659     | 81.797     | 367.1 | 16.79
Output  | 0.24353    | 0.24384    | 0.24418    |   0.1 |  0.08
Modify  | 110.11     | 145.15     | 178.45     | 275.4 | 46.27
Other   |            | 55.42      |            |       | 17.66

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         729.25 ave        1085 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2917
Ave neighs/atom = 1.1663335
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.22                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 86.5682535459263
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.32
  ghost atom cutoff = 4.32
  binsize = 2.16, bins = 2947 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.96 | 39.97 | 39.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.000523002    2.5387086e-35  0             -0.001569006    403621.96      0              3.897892e+10   1.1965779e-13  0              3.8054438    
    200000   6363.961       200            200           -7.0123931e-06 -1.0154506e-34  0             -2.1037179e-05  7.9269721      0              765530.23      1.1965779e-13  0              3.7687536    
    300000   6363.961       200            200            0.00043431738 -1.0154535e-34  0              0.0013029521   24481.041      0              2.3642037e+09  1.1965779e-13  0              3.6214447    
    400000   6363.961       200            200            0.0028156668  -0.0034950291   0              0.011942029    7492.7919      0              7.2360021e+08  1.1965779e-13  0              3.6058614    
    500000   6363.961       200            200            0.0037936647  -0.0028570497   0              0.014238044    1140.2615      0              1.1011829e+08  1.1965779e-13  0              3.6055441    
    600000   6363.961       200            200            0.0050768953  -0.0024981057   0              0.017728792    87.970114      0              8495523.9      1.1965779e-13  0              3.6050524    
    700000   6363.961       200            200            0.0040426192  -0.0022565036   0              0.014384361    20.403085      0              1970383.9      1.1965779e-13  0              3.6055524    
    800000   6363.961       200            200            0.0038209996  -0.0022759451   0              0.013738944    1.7245056      0              166540.4       1.1965779e-13  0              3.6056576    
    900000   6363.961       200            200            0.0038749411  -0.0022944936   0              0.013919317    0.0013926768   0              134.49476      1.1965779e-13  0              3.6056304    
   1000000   6363.961       200            200            0.0039373069  -0.0023005374   0              0.014112458    0.026058223    0              2516.5166      1.1965779e-13  0              3.6056001    
   1100000   6363.961       200            200            0.003959817   -0.0023024421   0              0.014181893    0.0067462668   0              651.50616      1.1965779e-13  0              3.6055891    
   1200000   6363.961       200            200            0.0039620756  -0.0023026396   0              0.014188866    0.00030114093  0              29.082036      1.1965779e-13  0              3.605588     
   1300000   6363.961       200            200            0.0039601119  -0.0023024831   0              0.014182819    7.8715803e-06  0              0.76018089     1.1965779e-13  0              3.6055889    
   1400000   6363.961       200            200            0.0039588728  -0.0023023818   0              0.014179       1.3504738e-05  0              1.3041909      1.1965779e-13  0              3.6055895    
   1500000   6363.961       200            200            0.0039585474  -0.0023023547   0              0.014177997    1.8828516e-06  0              0.18183233     1.1965779e-13  0              3.6055897    
   1600000   6363.961       200            200            0.0039585593  -0.0023023554   0              0.014178033    2.5045991e-08  0              0.0024187626   1.1965779e-13  0              3.6055897    
   1700000   6363.961       200            200            0.0039586089  -0.0023023594   0              0.014178186    1.2004104e-08  0              0.0011592704   1.1965779e-13  0              3.6055896    
   1800000   6363.961       200            200            0.0039586309  -0.0023023613   0              0.014178254    5.404292e-09   0              0.00052190784  1.1965779e-13  0              3.6055896    
   1900000   6363.961       200            200            0.0039586347  -0.0023023616   0              0.014178266    4.0993087e-10  0              3.9588189e-05  1.1965779e-13  0              3.6055896    
   2000000   6363.961       200            200            0.0039586335  -0.0023023615   0              0.014178262    6.9773954e-14  0              6.7382691e-09  1.1965779e-13  0              3.6055896    
   2100000   6363.961       200            200            0.0039586325  -0.0023023614   0              0.014178259    8.1491586e-12  0              7.8698741e-07  1.1965779e-13  0              3.6055896    
   2200000   6363.961       200            200            0.0039586321  -0.0023023614   0              0.014178258    1.7534271e-12  0              1.6933344e-07  1.1965779e-13  0              3.6055896    
   2300000   6363.961       200            200            0.0039586321  -0.0023023614   0              0.014178258    6.0716978e-14  0              5.8636112e-09  1.1965779e-13  0              3.6055896    
   2400000   6363.961       200            200            0.0039586321  -0.0023023614   0              0.014178258    3.7749095e-15  0              3.6455374e-10  1.1965779e-13  0              3.6055896    
   2500000   6363.961       200            200            0.0039586321  -0.0023023614   0              0.014178258    3.8821671e-15  0              3.7491191e-10  1.1965779e-13  0              3.6055896    
   2600000   6363.961       200            200            0.0039586322  -0.0023023614   0              0.014178258    4.6914305e-16  0              4.5306477e-11  1.1965779e-13  0              3.6055896    
   2700000   6363.961       200            200            0.0039586322  -0.0023023614   0              0.014178258    1.0310388e-17  0              9.957035e-13   1.1965779e-13  0              3.6055896    
   2800000   6363.961       200            200            0.0039586322  -0.0023023614   0              0.014178258    4.1336436e-18  0              3.9919771e-13  1.1965779e-13  0              3.6055896    
   2900000   6363.961       200            200            0.0039586322  -0.0023023614   0              0.014178258    5.9375055e-18  0              5.7340179e-13  1.1965779e-13  0              3.6055896    
   3000000   6363.961       200            200            0.0039586322  -0.0023023614   0              0.014178258    3.7580872e-18  0              3.6292916e-13  1.1965779e-13  0              3.6055896    
Loop time of 306.23 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8464222.601 ns/day, 0.000 hours/ns, 9796.554 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.47      | 57.703     | 85.082     | 358.2 | 18.84
Neigh   | 1.1625     | 1.1793     | 1.1953     |   1.1 |  0.39
Comm    | 22.665     | 49.808     | 76.893     | 376.7 | 16.26
Output  | 0.24601    | 0.24632    | 0.24667    |   0.1 |  0.08
Modify  | 106.83     | 141.91     | 176.12     | 286.4 | 46.34
Other   |            | 55.38      |            |       | 18.08

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         731.25 ave        1088 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2925
Ave neighs/atom = 1.1695322
Neighbor list builds = 146
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.23                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 87.1851271498876
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.33
  ghost atom cutoff = 4.33
  binsize = 2.165, bins = 2940 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.89 | 39.89 | 39.9 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00053090543 -1.777048e-34   0             -0.0015927163   397364.82      0              3.8374651e+10  1.1965779e-13  0              3.8146939    
    200000   6363.961       200            200            5.3672252e-06 -2.5386445e-35  0              1.6101676e-05  4.8897735      0              472219.32      1.1965779e-13  0              3.7736746    
    300000   6363.961       200            200            0.00045174066  1.2693281e-34  0              0.001355222    26180.738      0              2.5283483e+09  1.1965779e-13  0              3.6245932    
    400000   6363.961       200            200            0.0014902021  -0.0018163453   0              0.0062869517   7089.397       0              6.8464322e+08  1.1965779e-13  0              3.6119499    
    500000   6363.961       200            200            0.0029487562  -0.0025122594   0              0.011358528    1093.1262      0              1.0556631e+08  1.1965779e-13  0              3.6110216    
    600000   6363.961       200            200            0.0047175034  -0.0024113193   0              0.016563829    123.23087      0              11900755       1.1965779e-13  0              3.6102234    
    700000   6363.961       200            200            0.0038726523  -0.0022497337   0              0.013867691    20.063306      0              1937570.5      1.1965779e-13  0              3.6106392    
    800000   6363.961       200            200            0.0037822257  -0.0022655931   0              0.01361227     0.87454776     0              84457.563      1.1965779e-13  0              3.6106838    
    900000   6363.961       200            200            0.0038874625  -0.0022871446   0              0.013949532    0.029272197    0              2826.8993      1.1965779e-13  0              3.6106315    
   1000000   6363.961       200            200            0.0039561922  -0.0022937109   0              0.014162287    0.043046908    0              4157.1622      1.1965779e-13  0              3.610598     
   1100000   6363.961       200            200            0.0039733614  -0.0022951337   0              0.014215218    0.005185852    0              500.81247      1.1965779e-13  0              3.6105896    
   1200000   6363.961       200            200            0.0039718718  -0.0022950266   0              0.014210642    2.4751985e-05  0              2.3903695      1.1965779e-13  0              3.6105902    
   1300000   6363.961       200            200            0.0039688761  -0.0022947867   0              0.014201415    5.5177521e-05  0              5.3286501      1.1965779e-13  0              3.6105916    
   1400000   6363.961       200            200            0.0039677066  -0.0022946913   0              0.014197811    1.6559822e-05  0              1.5992291      1.1965779e-13  0              3.6105922    
   1500000   6363.961       200            200            0.0039675752  -0.00229468     0              0.014197406    7.41293e-07    0              0.071588772    1.1965779e-13  0              3.6105923    
   1600000   6363.961       200            200            0.0039676727  -0.0022946877   0              0.014197706    2.3866088e-08  0              0.0023048159   1.1965779e-13  0              3.6105922    
   1700000   6363.961       200            200            0.003967735   -0.0022946928   0              0.014197898    3.4870259e-08  0              0.0033675201   1.1965779e-13  0              3.6105922    
   1800000   6363.961       200            200            0.0039677503  -0.002294694    0              0.014197945    4.1766229e-09  0              0.00040334835  1.1965779e-13  0              3.6105922    
   1900000   6363.961       200            200            0.003967749   -0.0022946939   0              0.014197941    1.9400308e-11  0              1.8735429e-06  1.1965779e-13  0              3.6105922    
   2000000   6363.961       200            200            0.0039677463  -0.0022946937   0              0.014197933    4.4816731e-11  0              4.3280791e-06  1.1965779e-13  0              3.6105922    
   2100000   6363.961       200            200            0.0039677452  -0.0022946936   0              0.014197929    1.3373909e-11  0              1.2915564e-06  1.1965779e-13  0              3.6105922    
   2200000   6363.961       200            200            0.0039677451  -0.0022946936   0              0.014197929    5.9369652e-13  0              5.7334961e-08  1.1965779e-13  0              3.6105922    
   2300000   6363.961       200            200            0.0039677452  -0.0022946936   0              0.014197929    1.9703222e-14  0              1.9027962e-09  1.1965779e-13  0              3.6105922    
   2400000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    2.8043376e-14  0              2.7082285e-09  1.1965779e-13  0              3.6105922    
   2500000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    3.456004e-15   0              3.3375612e-10  1.1965779e-13  0              3.6105922    
   2600000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    1.96633e-17    0              1.8989408e-12  1.1965779e-13  0              3.6105922    
   2700000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    7.4412065e-17  0              7.1861846e-12  1.1965779e-13  0              3.6105922    
   2800000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    1.9704408e-19  0              1.9029107e-14  1.1965779e-13  0              3.6105922    
   2900000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    1.1548668e-19  0              1.1152877e-14  1.1965779e-13  0              3.6105922    
   3000000   6363.961       200            200            0.0039677453  -0.0022946936   0              0.014197929    2.4413624e-19  0              2.357693e-14   1.1965779e-13  0              3.6105922    
Loop time of 308.926 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8390349.248 ns/day, 0.000 hours/ns, 9711.052 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.367     | 57.173     | 85.393     | 354.4 | 18.51
Neigh   | 1.156      | 1.1728     | 1.1894     |   1.1 |  0.38
Comm    | 24.323     | 50.455     | 78.071     | 359.6 | 16.33
Output  | 0.24402    | 0.24434    | 0.24469    |   0.1 |  0.08
Modify  | 107.35     | 143.84     | 178.01     | 284.2 | 46.56
Other   |            | 56.04      |            |       | 18.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         707.25 ave        1041 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2829
Ave neighs/atom = 1.1311475
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.24                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 87.804924319972
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.34
  ghost atom cutoff = 4.34
  binsize = 2.17, bins = 2933 93 93
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.85 | 39.86 | 39.86 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            0              0              0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00053860567  1.7770603e-34  0             -0.001615817    391160.25      0              3.7775457e+10  1.1965779e-13  0              3.8239119    
    200000   6363.961       200            200            1.7899459e-05  5.0773182e-34  0              5.3698377e-05  52.321144      0              5052801.6      1.1965779e-13  0              3.7785449    
    300000   6363.961       200            200            0.0004693074  -4.5695602e-34  0              0.0014079222   27935.334      0              2.6977946e+09  1.1965779e-13  0              3.6276766    
    400000   6363.961       200            200            0.00059398907 -0.00065478947  0              0.0024367567   6352.5048      0              6.1347944e+08  1.1965779e-13  0              3.6179957    
    500000   6363.961       200            200            0.0022199176  -0.002232807    0              0.0088925598   961.49867      0              92854659       1.1965779e-13  0              3.61648      
    600000   6363.961       200            200            0.0042860423  -0.0024323349   0              0.015290462    146.47194      0              14145212       1.1965779e-13  0              3.6154169    
    700000   6363.961       200            200            0.0037090901  -0.0022581937   0              0.013385464    16.798199      0              1622249.8      1.1965779e-13  0              3.6157222    
    800000   6363.961       200            200            0.0037605941  -0.0022597507   0              0.013541533    0.22055747     0              21299.862      1.1965779e-13  0              3.6157012    
    900000   6363.961       200            200            0.0039089714  -0.0022819892   0              0.014008903    0.12873012     0              12431.833      1.1965779e-13  0              3.6156279    
   1000000   6363.961       200            200            0.0039762601  -0.0022883968   0              0.014217177    0.050206857    0              4848.6189      1.1965779e-13  0              3.6155951    
   1100000   6363.961       200            200            0.003985493   -0.00228917     0              0.014245649    0.0024931902   0              240.77447      1.1965779e-13  0              3.6155905    
   1200000   6363.961       200            200            0.0039803911  -0.0022887736   0              0.014229947    6.9075955e-05  0              6.6708613      1.1965779e-13  0              3.6155928    
   1300000   6363.961       200            200            0.0039769131  -0.0022884949   0              0.014219234    0.00010758232  0              10.389531      1.1965779e-13  0              3.6155945    
   1400000   6363.961       200            200            0.0039760758  -0.0022884263   0              0.014216654    1.1753015e-05  0              1.1350221      1.1965779e-13  0              3.6155949    
   1500000   6363.961       200            200            0.0039761772  -0.0022884338   0              0.014216965    1.1119324e-08  0              0.0010738247   1.1965779e-13  0              3.6155949    
   1600000   6363.961       200            200            0.0039763346  -0.0022884463   0              0.01421745     1.7290709e-07  0              0.01669813     1.1965779e-13  0              3.6155948    
   1700000   6363.961       200            200            0.0039763899  -0.0022884508   0              0.014217621    3.8635231e-08  0              0.0037311141   1.1965779e-13  0              3.6155948    
   1800000   6363.961       200            200            0.003976393   -0.0022884511   0              0.01421763     9.0909467e-10  0              8.7793857e-05  1.1965779e-13  0              3.6155948    
   1900000   6363.961       200            200            0.0039763868  -0.0022884506   0              0.014217611    1.7608569e-10  0              1.7005096e-05  1.1965779e-13  0              3.6155948    
   2000000   6363.961       200            200            0.0039763837  -0.0022884504   0              0.014217602    9.7675086e-11  0              9.4327606e-06  1.1965779e-13  0              3.6155948    
   2100000   6363.961       200            200            0.0039763832  -0.0022884503   0              0.0142176      6.4803465e-12  0              6.2582548e-07  1.1965779e-13  0              3.6155948    
   2200000   6363.961       200            200            0.0039763834  -0.0022884503   0              0.014217601    4.6559661e-14  0              4.4963988e-09  1.1965779e-13  0              3.6155948    
   2300000   6363.961       200            200            0.0039763836  -0.0022884503   0              0.014217601    1.9143825e-13  0              1.8487736e-08  1.1965779e-13  0              3.6155948    
   2400000   6363.961       200            200            0.0039763836  -0.0022884504   0              0.014217601    2.6751518e-14  0              2.5834701e-09  1.1965779e-13  0              3.6155948    
   2500000   6363.961       200            200            0.0039763836  -0.0022884504   0              0.014217601    1.946876e-16   0              1.8801535e-11  1.1965779e-13  0              3.6155948    
   2600000   6363.961       200            200            0.0039763836  -0.0022884503   0              0.014217601    2.6387505e-16  0              2.5483163e-11  1.1965779e-13  0              3.6155948    
   2700000   6363.961       200            200            0.0039763836  -0.0022884503   0              0.014217601    4.9234662e-17  0              4.7547312e-12  1.1965779e-13  0              3.6155948    
   2800000   6363.961       200            200            0.0039763836  -0.0022884503   0              0.014217601    9.0971136e-18  0              8.7853411e-13  1.1965779e-13  0              3.6155948    
   2900000   6363.961       200            200            0.0039763836  -0.0022884503   0              0.014217601    1.2041982e-18  0              1.1629284e-13  1.1965779e-13  0              3.6155948    
   3000000   6363.961       200            200            0.0039763836  -0.0022884504   0              0.014217601    1.3619993e-22  0              1.3153214e-17  1.1965779e-13  0              3.6155948    
Loop time of 305.831 on 4 procs for 3000000 steps with 2501 atoms

Performance: 8475256.956 ns/day, 0.000 hours/ns, 9809.325 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 30.468     | 56.924     | 83.415     | 350.3 | 18.61
Neigh   | 1.0979     | 1.1132     | 1.1293     |   1.1 |  0.36
Comm    | 22.92      | 49.31      | 75.93      | 368.1 | 16.12
Output  | 0.24249    | 0.2428     | 0.24312    |   0.1 |  0.08
Modify  | 106.49     | 142        | 177.65     | 288.8 | 46.43
Other   |            | 56.24      |            |       | 18.39

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         710.75 ave        1048 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2843
Ave neighs/atom = 1.1367453
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.25                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 88.427651967684
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.35
  ghost atom cutoff = 4.35
  binsize = 2.175, bins = 2926 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.2 | 39.21 | 39.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.9728894e-17  1.1918668e-16  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00054610329  1.1918668e-16  0             -0.0016383099   385008.16      0              3.7181332e+10  1.1965779e-13  0              3.8330978    
    200000   6363.961       200            200            3.0583398e-05  1.1918668e-16  0              9.1750195e-05  150.07898      0              14493554       1.1965779e-13  0              3.7833643    
    300000   6363.961       200            200            0.00048701636  1.1918668e-16  0              0.0014610491   29744.63       0              2.8725234e+09  1.1965779e-13  0              3.6306947    
    400000   6363.961       200            200            7.2205956e-05 -7.0987107e-05  0              0.00028760498  5455.3536      0              5.2683901e+08  1.1965779e-13  0              3.6239767    
    500000   6363.961       200            200            0.0017202076  -0.0017280053   0              0.006888628    774.20893      0              74767557       1.1965779e-13  0              3.6219017    
    600000   6363.961       200            200            0.0038470858  -0.0024579477   0              0.013999205    152.4851       0              14725920       1.1965779e-13  0              3.620621     
    700000   6363.961       200            200            0.0035719559  -0.0022572564   0              0.012973124    11.62777       0              1122926.8      1.1965779e-13  0              3.6207952    
    800000   6363.961       200            200            0.0037603707  -0.0022536004   0              0.013534712    0.0015268674   0              147.45392      1.1965779e-13  0              3.6207084    
    900000   6363.961       200            200            0.0039385379  -0.0022772523   0              0.014092866    0.25385206     0              24515.215      1.1965779e-13  0              3.6206205    
   1000000   6363.961       200            200            0.0039964293  -0.0022828638   0              0.014272152    0.043675149    0              4217.8333      1.1965779e-13  0              3.6205921    
   1100000   6363.961       200            200            0.0039961741  -0.0022828799   0              0.014271402    0.00038571964  0              37.250042      1.1965779e-13  0              3.620592     
   1200000   6363.961       200            200            0.0039882025  -0.0022822555   0              0.014246863    0.00039728194  0              38.366646      1.1965779e-13  0              3.6205958    
   1300000   6363.961       200            200            0.0039849009  -0.0022819908   0              0.014236693    0.00012097322  0              11.682728      1.1965779e-13  0              3.6205974    
   1400000   6363.961       200            200            0.0039845911  -0.0022819643   0              0.014235737    3.6998148e-06  0              0.35730163     1.1965779e-13  0              3.6205976    
   1500000   6363.961       200            200            0.0039849061  -0.0022819889   0              0.014236707    4.5731993e-07  0              0.044164685    1.1965779e-13  0              3.6205974    
   1600000   6363.961       200            200            0.0039850799  -0.0022820028   0              0.014237243    2.9449178e-07  0              0.028439908    1.1965779e-13  0              3.6205974    
   1700000   6363.961       200            200            0.0039851103  -0.0022820053   0              0.014237336    1.8574745e-08  0              0.0017938159   1.1965779e-13  0              3.6205973    
   1800000   6363.961       200            200            0.0039850996  -0.0022820045   0              0.014237303    2.5666611e-10  0              2.4786976e-05  1.1965779e-13  0              3.6205973    
   1900000   6363.961       200            200            0.0039850911  -0.0022820038   0              0.014237277    6.2914943e-10  0              6.0758748e-05  1.1965779e-13  0              3.6205973    
   2000000   6363.961       200            200            0.0039850889  -0.0022820036   0              0.01423727     6.9777919e-11  0              6.738652e-06   1.1965779e-13  0              3.6205973    
   2100000   6363.961       200            200            0.0039850892  -0.0022820037   0              0.014237271    1.4488738e-14  0              1.3992187e-09  1.1965779e-13  0              3.6205973    
   2200000   6363.961       200            200            0.0039850896  -0.0022820037   0              0.014237272    1.1567874e-12  0              1.1171424e-07  1.1965779e-13  0              3.6205973    
   2300000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    2.1824562e-13  0              2.10766e-08    1.1965779e-13  0              3.6205973    
   2400000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    2.4548134e-15  0              2.370683e-10   1.1965779e-13  0              3.6205973    
   2500000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    1.7810426e-15  0              1.7200034e-10  1.1965779e-13  0              3.6205973    
   2600000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    5.9110388e-16  0              5.7084581e-11  1.1965779e-13  0              3.6205973    
   2700000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    9.5876254e-20  0              9.2590423e-15  1.1965779e-13  0              3.6205973    
   2800000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    5.9667057e-18  0              5.7622173e-13  1.1965779e-13  0              3.6205973    
   2900000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    6.8500881e-18  0              6.6153248e-13  1.1965779e-13  0              3.6205973    
   3000000   6363.961       200            200            0.0039850897  -0.0022820037   0              0.014237273    4.9697118e-18  0              4.7993919e-13  1.1965779e-13  0              3.6205973    
Loop time of 371.044 on 4 procs for 3000000 steps with 2501 atoms

Performance: 6985690.518 ns/day, 0.000 hours/ns, 8085.290 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.059     | 117.92     | 147.61     | 262.8 | 31.78
Neigh   | 1.0706     | 1.0855     | 1.1006     |   1.0 |  0.29
Comm    | 24.31      | 52.044     | 81.012     | 380.1 | 14.03
Output  | 0.24293    | 0.24323    | 0.24357    |   0.1 |  0.07
Modify  | 108.13     | 144.07     | 177.97     | 280.5 | 38.83
Other   |            | 55.68      |            |       | 15.01

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         713.75 ave        1054 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2855
Ave neighs/atom = 1.1415434
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.26                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 89.0533170045268
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.36
  ghost atom cutoff = 4.36
  binsize = 2.18, bins = 2920 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.16 | 39.16 | 39.17 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.4409858e-16  4.3229574e-16  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00055339889  4.3229574e-16  0             -0.0016601967   378908.42      0              3.6592263e+10  1.1965779e-13  0              3.8422515    
    200000   6363.961       200            200            4.3418186e-05  4.3229574e-16  0              0.00013025456  298.02217      0              28780848       1.1965779e-13  0              3.7881327    
    300000   6363.961       200            200            0.00050486634  4.3229574e-16  0              0.001514599    31608.426      0              3.0525156e+09  1.1965779e-13  0              3.6336473    
    400000   6363.961       200            200           -0.00014449674 -2.4447201e-07  0             -0.00043324574  4540.0702      0              4.3844748e+08  1.1965779e-13  0              3.62988      
    500000   6363.961       200            200            0.0013612624  -0.0012620427   0              0.00534583     563.89156      0              54456611       1.1965779e-13  0              3.6272721    
    600000   6363.961       200            200            0.003471561   -0.0023604877   0              0.012775171    140.50399      0              13568870       1.1965779e-13  0              3.6258232    
    700000   6363.961       200            200            0.0034604227  -0.0022783188   0              0.012659587    6.0968579      0              588790.9       1.1965779e-13  0              3.625853     
    800000   6363.961       200            200            0.0037828856  -0.002245591    0              0.013594248    0.29471065     0              28461.045      1.1965779e-13  0              3.6257049    
    900000   6363.961       200            200            0.0039742357  -0.0022712799   0              0.014193987    0.34725332     0              33535.24       1.1965779e-13  0              3.6256104    
   1000000   6363.961       200            200            0.0040156166  -0.0022753699   0              0.01432222     0.02705642     0              2612.9154      1.1965779e-13  0              3.6255899    
   1100000   6363.961       200            200            0.0040056188  -0.0022746221   0              0.014291478    0.00019005764  0              18.354407      1.1965779e-13  0              3.6255945    
   1200000   6363.961       200            200            0.0039960215  -0.0022738681   0              0.014261933    0.00076519678  0              73.897228      1.1965779e-13  0              3.6255991    
   1300000   6363.961       200            200            0.0039935387  -0.0022736678   0              0.014254284    8.4441268e-05  0              8.1547333      1.1965779e-13  0              3.6256003    
   1400000   6363.961       200            200            0.0039938398  -0.0022736899   0              0.014255209    3.3785404e-09  0              0.00032627525  1.1965779e-13  0              3.6256002    
   1500000   6363.961       200            200            0.0039942947  -0.0022737257   0              0.01425661     1.5920115e-06  0              0.15374508     1.1965779e-13  0              3.6256       
   1600000   6363.961       200            200            0.0039944358  -0.0022737371   0              0.014257045    2.4608048e-07  0              0.023764691    1.1965779e-13  0              3.6255999    
   1700000   6363.961       200            200            0.0039944309  -0.0022737368   0              0.014257029    7.869649e-10   0              7.5999437e-05  1.1965779e-13  0              3.6255999    
   1800000   6363.961       200            200            0.0039944099  -0.0022737351   0              0.014256965    3.0975285e-09  0              0.00029913714  1.1965779e-13  0              3.6255999    
   1900000   6363.961       200            200            0.0039944021  -0.0022737345   0              0.014256941    6.764065e-10   0              6.5322499e-05  1.1965779e-13  0              3.6255999    
   2000000   6363.961       200            200            0.0039944019  -0.0022737345   0              0.01425694     8.3284697e-12  0              8.0430399e-07  1.1965779e-13  0              3.6255999    
   2100000   6363.961       200            200            0.0039944028  -0.0022737346   0              0.014256943    5.536701e-12   0              5.3469496e-07  1.1965779e-13  0              3.6255999    
   2200000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    1.7642336e-12  0              1.7037705e-07  1.1965779e-13  0              3.6255999    
   2300000   6363.961       200            200            0.0039944033  -0.0022737346   0              0.014256944    4.5812849e-14  0              4.424277e-09   1.1965779e-13  0              3.6255999    
   2400000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    9.0112154e-15  0              8.7023868e-10  1.1965779e-13  0              3.6255999    
   2500000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    4.3838951e-15  0              4.2336521e-10  1.1965779e-13  0              3.6255999    
   2600000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    1.9193769e-16  0              1.8535968e-11  1.1965779e-13  0              3.6255999    
   2700000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    5.532974e-17   0              5.3433503e-12  1.1965779e-13  0              3.6255999    
   2800000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    1.870749e-20   0              1.8066355e-15  1.1965779e-13  0              3.6255999    
   2900000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    1.2937803e-18  0              1.2494404e-13  1.1965779e-13  0              3.6255999    
   3000000   6363.961       200            200            0.0039944032  -0.0022737346   0              0.014256944    6.7715215e-18  0              6.5394508e-13  1.1965779e-13  0              3.6255999    
Loop time of 375.843 on 4 procs for 3000000 steps with 2501 atoms

Performance: 6896496.501 ns/day, 0.000 hours/ns, 7982.056 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.308     | 119.06     | 153.28     | 273.9 | 31.68
Neigh   | 1.0958     | 1.1115     | 1.1272     |   1.1 |  0.30
Comm    | 24.165     | 54.734     | 87.076     | 373.5 | 14.56
Output  | 0.24115    | 0.24146    | 0.24179    |   0.1 |  0.06
Modify  | 106.78     | 144.58     | 177.59     | 273.7 | 38.47
Other   |            | 56.12      |            |       | 14.93

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         716.75 ave        1060 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2867
Ave neighs/atom = 1.1463415
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.27                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 89.6819263420049
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.37
  ghost atom cutoff = 4.37
  binsize = 2.185, bins = 2913 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.12 | 39.12 | 39.13 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.8544854e-16  8.5634561e-16  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00056049303  8.5634561e-16  0             -0.0016814791   372860.97      0              3.6008244e+10  1.1965779e-13  0              3.851373     
    200000   6363.961       200            200            5.6402864e-05  8.5634561e-16  0              0.00016920859  496.00886      0              47900985       1.1965779e-13  0              3.79285      
    300000   6363.961       200            200            0.00052285602  8.5634561e-16  0              0.0015685681   33526.516      0              3.237751e+09   1.1965779e-13  0              3.6365344    
    400000   6363.961       200            200           -0.00013483572  8.5634561e-16  0             -0.00040450717  3694.4035      0              3.5677905e+08  1.1965779e-13  0              3.6357009    
    500000   6363.961       200            200            0.0010632495  -0.0010255957   0              0.0042153441   360.66725      0              34830661       1.1965779e-13  0              3.6325798    
    600000   6363.961       200            200            0.0031321491  -0.0022888698   0              0.011685317    113.99233      0              11008563       1.1965779e-13  0              3.6310118    
    700000   6363.961       200            200            0.0034033389  -0.0022562688   0              0.012466285    1.818657       0              175632.87      1.1965779e-13  0              3.6308915    
    800000   6363.961       200            200            0.0038264088  -0.0022375928   0              0.013716819    0.98828185     0              95441.187      1.1965779e-13  0              3.6306914    
    900000   6363.961       200            200            0.0040129159  -0.0022640216   0              0.014302769    0.36619492     0              35364.485      1.1965779e-13  0              3.6305991    
   1000000   6363.961       200            200            0.0040323502  -0.0022660315   0              0.014363082    0.0094035255   0              908.12519      1.1965779e-13  0              3.6305891    
   1100000   6363.961       200            200            0.0040137375  -0.0022646162   0              0.014305829    0.0020064397   0              193.76758      1.1965779e-13  0              3.6305979    
   1200000   6363.961       200            200            0.0040040647  -0.0022638548   0              0.014276049    0.00090286025  0              87.19178       1.1965779e-13  0              3.6306025    
   1300000   6363.961       200            200            0.0040029022  -0.0022637584   0              0.014272465    2.8758844e-05  0              2.7773233      1.1965779e-13  0              3.6306031    
   1400000   6363.961       200            200            0.0040037641  -0.002263825    0              0.014275117    4.0618909e-06  0              0.39226835     1.1965779e-13  0              3.6306027    
   1500000   6363.961       200            200            0.0040042479  -0.0022638632   0              0.014276607    2.2121543e-06  0              0.21363402     1.1965779e-13  0              3.6306025    
   1600000   6363.961       200            200            0.0040043152  -0.0022638687   0              0.014276814    8.55871e-08    0              0.0082653895   1.1965779e-13  0              3.6306024    
   1700000   6363.961       200            200            0.0040042755  -0.0022638657   0              0.014276692    8.0077014e-09  0              0.00077332648  1.1965779e-13  0              3.6306024    
   1800000   6363.961       200            200            0.0040042514  -0.0022638638   0              0.014276618    5.3837892e-09  0              0.00051992783  1.1965779e-13  0              3.6306025    
   1900000   6363.961       200            200            0.0040042476  -0.0022638634   0              0.014276606    2.4879888e-10  0              2.4027215e-05  1.1965779e-13  0              3.6306025    
   2000000   6363.961       200            200            0.0040042494  -0.0022638636   0              0.014276612    1.5257492e-11  0              1.4734594e-06  1.1965779e-13  0              3.6306025    
   2100000   6363.961       200            200            0.0040042506  -0.0022638637   0              0.014276616    1.3015456e-11  0              1.2569396e-06  1.1965779e-13  0              3.6306025    
   2200000   6363.961       200            200            0.0040042508  -0.0022638637   0              0.014276616    7.0875976e-13  0              6.8446945e-08  1.1965779e-13  0              3.6306025    
   2300000   6363.961       200            200            0.0040042508  -0.0022638637   0              0.014276616    2.7958108e-14  0              2.699994e-09   1.1965779e-13  0              3.6306025    
   2400000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    3.1242637e-14  0              3.0171903e-09  1.1965779e-13  0              3.6306025    
   2500000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    1.9528358e-15  0              1.885909e-10   1.1965779e-13  0              3.6306025    
   2600000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    4.2210783e-17  0              4.0764153e-12  1.1965779e-13  0              3.6306025    
   2700000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    6.9750741e-17  0              6.7360273e-12  1.1965779e-13  0              3.6306025    
   2800000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    5.3251851e-18  0              5.1426826e-13  1.1965779e-13  0              3.6306025    
   2900000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    2.9737651e-19  0              2.8718494e-14  1.1965779e-13  0              3.6306025    
   3000000   6363.961       200            200            0.0040042507  -0.0022638637   0              0.014276616    5.9585247e-20  0              5.7543167e-15  1.1965779e-13  0              3.6306025    
Loop time of 368.726 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7029602.703 ns/day, 0.000 hours/ns, 8136.114 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.968     | 117.11     | 146.05     | 257.8 | 31.76
Neigh   | 1.0807     | 1.0969     | 1.1131     |   1.1 |  0.30
Comm    | 24.167     | 51.352     | 80.18      | 375.1 | 13.93
Output  | 0.24233    | 0.24264    | 0.24298    |   0.1 |  0.07
Modify  | 107.69     | 143.58     | 177.2      | 280.4 | 38.94
Other   |            | 55.35      |            |       | 15.01

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         719.25 ave        1065 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2877
Ave neighs/atom = 1.1503399
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.28                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 90.3134868916216
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.38
  ghost atom cutoff = 4.38
  binsize = 2.19, bins = 2906 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 39.02 | 39.04 | 39.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.5601204e-16  1.3680361e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00056738628  1.3680361e-15  0             -0.0017021589   366865.71      0              3.5429264e+10  1.1965779e-13  0              3.8604621    
    200000   6363.961       200            200            6.9536541e-05  1.3680361e-15  0              0.00020860962  743.89817      0              71840361       1.1965779e-13  0              3.797516     
    300000   6363.961       200            200            0.0006419696  -5.7413681e-06  0              0.0019316502   35493.988      0              3.4277553e+09  1.1965779e-13  0              3.6393556    
    400000   6363.961       200            200           -0.00012136834  1.3680361e-15  0             -0.00036410502  2936.8677      0              2.8362166e+08  1.1965779e-13  0              3.6414388    
    500000   6363.961       200            200            0.00086753604 -0.00084634266  0              0.0034489508   189.16282      0              18267991       1.1965779e-13  0              3.6378165    
    600000   6363.961       200            200            0.0028610971  -0.0021988569   0              0.010782148    79.423635      0              7670166.2      1.1965779e-13  0              3.6361763    
    700000   6363.961       200            200            0.0033859     -0.0022486432   0              0.012406343    0.017329445    0              1673.5538      1.1965779e-13  0              3.6359081    
    800000   6363.961       200            200            0.0038872888  -0.0022316381   0              0.013893505    1.8217835      0              175934.81      1.1965779e-13  0              3.6356694    
    900000   6363.961       200            200            0.0040505854  -0.0022569626   0              0.014408719    0.30206052     0              29170.843      1.1965779e-13  0              3.6355882    
   1000000   6363.961       200            200            0.004045023   -0.0022566774   0              0.014391746    0.0002574487   0              24.862553      1.1965779e-13  0              3.6355902    
   1100000   6363.961       200            200            0.0040201893  -0.002254785    0              0.014315353    0.0046618762   0              450.21063      1.1965779e-13  0              3.635602     
   1200000   6363.961       200            200            0.0040120462  -0.0022541423   0              0.014290281    0.00071138494  0              68.700466      1.1965779e-13  0              3.6356059    
   1300000   6363.961       200            200            0.0040124637  -0.00225417     0              0.014291561    1.4151896e-07  0              0.013666888    1.1965779e-13  0              3.6356057    
   1400000   6363.961       200            200            0.004013711   -0.0022542668   0              0.0142954      1.1970908e-05  0              1.1560646      1.1965779e-13  0              3.6356051    
   1500000   6363.961       200            200            0.0040141026  -0.0022542978   0              0.014296606    1.6716402e-06  0              0.16143505     1.1965779e-13  0              3.635605     
   1600000   6363.961       200            200            0.0040140751  -0.0022542959   0              0.014296521    4.5396877e-12  0              4.3841054e-07  1.1965779e-13  0              3.635605     
   1700000   6363.961       200            200            0.0040140125  -0.002254291    0              0.014296328    3.0632549e-08  0              0.0029582723   1.1965779e-13  0              3.635605     
   1800000   6363.961       200            200            0.0040139937  -0.0022542895   0              0.01429627     3.9125753e-09  0              0.00037784852  1.1965779e-13  0              3.635605     
   1900000   6363.961       200            200            0.0040139954  -0.0022542896   0              0.014296276    1.2814545e-12  0              1.237537e-07   1.1965779e-13  0              3.635605     
   2000000   6363.961       200            200            0.0040139985  -0.0022542899   0              0.014296285    7.8096048e-11  0              7.5419573e-06  1.1965779e-13  0              3.635605     
   2100000   6363.961       200            200            0.0040139994  -0.0022542899   0              0.014296288    9.1201633e-12  0              8.807601e-07   1.1965779e-13  0              3.635605     
   2200000   6363.961       200            200            0.0040139993  -0.0022542899   0              0.014296288    1.1405335e-14  0              1.1014456e-09  1.1965779e-13  0              3.635605     
   2300000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    1.9797443e-13  0              1.9118953e-08  1.1965779e-13  0              3.635605     
   2400000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    2.1499215e-14  0              2.0762403e-09  1.1965779e-13  0              3.635605     
   2500000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    3.787838e-17   0              3.6580229e-12  1.1965779e-13  0              3.635605     
   2600000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    4.9385528e-16  0              4.7693008e-11  1.1965779e-13  0              3.635605     
   2700000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    1.02889e-17    0              9.9362827e-13  1.1965779e-13  0              3.635605     
   2800000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    9.7581362e-18  0              9.4237095e-13  1.1965779e-13  0              3.635605     
   2900000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    1.4595008e-18  0              1.4094814e-13  1.1965779e-13  0              3.635605     
   3000000   6363.961       200            200            0.0040139991  -0.0022542899   0              0.014296287    2.352116e-18   0              2.2715052e-13  1.1965779e-13  0              3.635605     
Loop time of 366.176 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7078565.505 ns/day, 0.000 hours/ns, 8192.784 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.883     | 116.94     | 144.92     | 253.3 | 31.94
Neigh   | 1.0875     | 1.1017     | 1.1166     |   1.0 |  0.30
Comm    | 24.007     | 50.535     | 79.034     | 373.6 | 13.80
Output  | 0.24273    | 0.24304    | 0.24338    |   0.1 |  0.07
Modify  | 106.07     | 141.89     | 176.4      | 285.4 | 38.75
Other   |            | 55.47      |            |       | 15.15

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         722.25 ave        1071 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2889
Ave neighs/atom = 1.1551379
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.29                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 90.9480055648809
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.39
  ghost atom cutoff = 4.39
  binsize = 2.195, bins = 2900 92 92
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.98 | 38.98 | 38.99 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            6.5161765e-16  1.954853e-15   0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00057407921  1.954853e-15   0             -0.0017222376   360922.55      0              3.4855317e+10  1.1965779e-13  0              3.869519     
    200000   6363.961       200            200            8.2818259e-05  1.954853e-15   0              0.00024845478  1041.5481      0              1.0058526e+08  1.1965779e-13  0              3.8021307    
    300000   6363.961       200            200            0.0024516032  -0.00052292729  0              0.0078777369   37104.41       0              3.5832783e+09  1.1965779e-13  0              3.6421151    
    400000   6363.961       200            200           -0.00010764292  1.954853e-15   0             -0.00032292875  2267.1069      0              2.1894095e+08  1.1965779e-13  0              3.6470936    
    500000   6363.961       200            200            0.00075489015 -0.00072724939  0              0.0029919198   67.260095      0              6495498.6      1.1965779e-13  0              3.6429763    
    600000   6363.961       200            200            0.0026700168  -0.0020840153   0              0.010094066    44.569969      0              4304248.6      1.1965779e-13  0              3.6413079    
    700000   6363.961       200            200            0.0034138526  -0.0022431742   0              0.012484732    1.1931809      0              115228.87      1.1965779e-13  0              3.6409018    
    800000   6363.961       200            200            0.0039604273  -0.0022287758   0              0.014110058    2.4813408      0              239630.13      1.1965779e-13  0              3.6406413    
    900000   6363.961       200            200            0.0040834503  -0.0022512185   0              0.01450157     0.18428878     0              17797.292      1.1965779e-13  0              3.6405794    
   1000000   6363.961       200            200            0.0040527544  -0.0022486925   0              0.014406956    0.0044681249   0              431.49952      1.1965779e-13  0              3.6405934    
   1100000   6363.961       200            200            0.0040250544  -0.0022465797   0              0.014321743    0.0064674455   0              624.57959      1.1965779e-13  0              3.6406066    
   1200000   6363.961       200            200            0.0040198346  -0.0022461635   0              0.014305667    0.0003320046   0              32.062628      1.1965779e-13  0              3.6406091    
   1300000   6363.961       200            200            0.0040217942  -0.0022463113   0              0.014311694    2.1807063e-05  0              2.10597        1.1965779e-13  0              3.6406082    
   1400000   6363.961       200            200            0.0040231616  -0.0022464173   0              0.014315902    1.6295398e-05  0              1.5736929      1.1965779e-13  0              3.6406075    
   1500000   6363.961       200            200            0.0040233604  -0.0022464333   0              0.014316514    5.4308347e-07  0              0.052447114    1.1965779e-13  0              3.6406074    
   1600000   6363.961       200            200            0.0040232433  -0.0022464245   0              0.014316154    8.6806463e-08  0              0.0083831469   1.1965779e-13  0              3.6406075    
   1700000   6363.961       200            200            0.0040231769  -0.0022464193   0              0.01431595     3.9619955e-08  0              0.0038262116   1.1965779e-13  0              3.6406075    
   1800000   6363.961       200            200            0.0040231702  -0.0022464188   0              0.014315929    7.6527755e-10  0              7.3905028e-05  1.1965779e-13  0              3.6406075    
   1900000   6363.961       200            200            0.0040231769  -0.0022464193   0              0.01431595     3.0499044e-10  0              2.9453794e-05  1.1965779e-13  0              3.6406075    
   2000000   6363.961       200            200            0.0040231801  -0.0022464195   0              0.01431596     9.2934391e-11  0              8.9749382e-06  1.1965779e-13  0              3.6406075    
   2100000   6363.961       200            200            0.0040231802  -0.0022464195   0              0.01431596     8.2592296e-13  0              7.9761728e-08  1.1965779e-13  0              3.6406075    
   2200000   6363.961       200            200            0.0040231799  -0.0022464195   0              0.014315959    9.838909e-13   0              9.501714e-08   1.1965779e-13  0              3.6406075    
   2300000   6363.961       200            200            0.0040231797  -0.0022464195   0              0.014315959    2.0987802e-13  0              2.0268516e-08  1.1965779e-13  0              3.6406075    
   2400000   6363.961       200            200            0.0040231797  -0.0022464195   0              0.014315959    5.1223534e-16  0              4.9468023e-11  1.1965779e-13  0              3.6406075    
   2500000   6363.961       200            200            0.0040231797  -0.0022464195   0              0.014315959    2.8713272e-15  0              2.7729223e-10  1.1965779e-13  0              3.6406075    
   2600000   6363.961       200            200            0.0040231798  -0.0022464195   0              0.014315959    4.7193632e-16  0              4.5576232e-11  1.1965779e-13  0              3.6406075    
   2700000   6363.961       200            200            0.0040231798  -0.0022464195   0              0.014315959    2.1996723e-17  0              2.1242861e-12  1.1965779e-13  0              3.6406075    
   2800000   6363.961       200            200            0.0040231798  -0.0022464195   0              0.014315959    5.9102359e-19  0              5.7076828e-14  1.1965779e-13  0              3.6406075    
   2900000   6363.961       200            200            0.0040231798  -0.0022464195   0              0.014315959    7.0582419e-23  0              6.8163449e-18  1.1965779e-13  0              3.6406075    
   3000000   6363.961       200            200            0.0040231798  -0.0022464195   0              0.014315959    3.4436621e-19  0              3.3256424e-14  1.1965779e-13  0              3.6406075    
Loop time of 365.112 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7099187.954 ns/day, 0.000 hours/ns, 8216.653 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.269     | 116.42     | 144.79     | 255.7 | 31.89
Neigh   | 1.0958     | 1.1117     | 1.1281     |   1.1 |  0.30
Comm    | 23.647     | 50.492     | 79.11      | 375.4 | 13.83
Output  | 0.24088    | 0.24119    | 0.24152    |   0.1 |  0.07
Modify  | 105.93     | 141.71     | 175.86     | 284.0 | 38.81
Other   |            | 55.13      |            |       | 15.10

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         724.75 ave        1076 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2899
Ave neighs/atom = 1.1591363
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.3                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 91.5854892732866
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.4
  ghost atom cutoff = 4.4
  binsize = 2.2, bins = 2893 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.4 | 38.41 | 38.41 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            8.6955337e-16  2.6086601e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0005805724   2.6086601e-15  0             -0.0017417172   355031.4       0              3.4286391e+10  1.1965779e-13  0              3.8785434    
    200000   6363.961       200            200            9.624721e-05   2.6086601e-15  0              0.00028874163  1388.8204      0              1.3412233e+08  1.1965779e-13  0              3.8066939    
    300000   6363.961       200            200            0.0064312716  -0.002103285    0              0.0213971      37191.739      0              3.591712e+09   1.1965779e-13  0              3.6448416    
    400000   6363.961       200            200           -9.366136e-05   2.6086601e-15  0             -0.00028098408  1684.715       0              1.6269771e+08  1.1965779e-13  0              3.652665     
    500000   6363.961       200            200            0.00071182539 -0.00066771236  0              0.0028031885   6.1373832      0              592704.54      1.1965779e-13  0              3.6480555    
    600000   6363.961       200            200            0.0025551059  -0.0019747213   0              0.0096400388   16.799304      0              1622356.6      1.1965779e-13  0              3.6463998    
    700000   6363.961       200            200            0.003485171   -0.0022428611   0              0.012698374    4.9887666      0              481779.37      1.1965779e-13  0              3.6458732    
    800000   6363.961       200            200            0.0040400366  -0.0022279886   0              0.014348099    2.7164858      0              262338.75      1.1965779e-13  0              3.64561      
    900000   6363.961       200            200            0.004108733   -0.0022463394   0              0.014572538    0.066837056    0              6454.6444      1.1965779e-13  0              3.6455739    
   1000000   6363.961       200            200            0.0040558132  -0.0022419257   0              0.014409365    0.019612095    0              1893.9957      1.1965779e-13  0              3.6455985    
   1100000   6363.961       200            200            0.0040291059  -0.0022398785   0              0.014327196    0.0062883268   0              607.28159      1.1965779e-13  0              3.6456113    
   1200000   6363.961       200            200            0.0040277532  -0.0022397603   0              0.01432302     4.0188506e-05  0              3.8811183      1.1965779e-13  0              3.645612     
   1300000   6363.961       200            200            0.0040309189  -0.0022400016   0              0.014332758    7.5238868e-05  0              7.2660314      1.1965779e-13  0              3.6456105    
   1400000   6363.961       200            200            0.0040321078  -0.0022400941   0              0.014336418    1.3035457e-05  0              1.2588712      1.1965779e-13  0              3.6456099    
   1500000   6363.961       200            200            0.0040320588  -0.002240091    0              0.014336267    4.8568744e-10  0              4.6904217e-05  1.1965779e-13  0              3.64561      
   1600000   6363.961       200            200            0.004031883   -0.0022400776   0              0.014335727    2.4364785e-07  0              0.023529766    1.1965779e-13  0              3.64561      
   1700000   6363.961       200            200            0.0040318337  -0.0022400737   0              0.014335575    2.3670459e-08  0              0.0022859235   1.1965779e-13  0              3.6456101    
   1800000   6363.961       200            200            0.0040318418  -0.0022400743   0              0.0143356      3.1141475e-10  0              3.0074207e-05  1.1965779e-13  0              3.6456101    
   1900000   6363.961       200            200            0.004031851   -0.002240075    0              0.014335628    6.9395375e-10  0              6.7017086e-05  1.1965779e-13  0              3.6456101    
   2000000   6363.961       200            200            0.0040318528  -0.0022400752   0              0.014335634    3.5894594e-11  0              3.466443e-06   1.1965779e-13  0              3.6456101    
   2100000   6363.961       200            200            0.0040318522  -0.0022400751   0              0.014335632    2.7142373e-12  0              2.6212161e-07  1.1965779e-13  0              3.6456101    
   2200000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     1.7715371e-12  0              1.7108237e-07  1.1965779e-13  0              3.6456101    
   2300000   6363.961       200            200            0.0040318516  -0.0022400751   0              0.01433563     4.0334821e-14  0              3.8952483e-09  1.1965779e-13  0              3.6456101    
   2400000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     1.3592096e-14  0              1.3126274e-09  1.1965779e-13  0              3.6456101    
   2500000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     4.033213e-15   0              3.8949884e-10  1.1965779e-13  0              3.6456101    
   2600000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     2.3713488e-17  0              2.2900789e-12  1.1965779e-13  0              3.6456101    
   2700000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     7.9498082e-17  0              7.6773558e-12  1.1965779e-13  0              3.6456101    
   2800000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     3.5434966e-18  0              3.4220554e-13  1.1965779e-13  0              3.6456101    
   2900000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     5.5681611e-20  0              5.3773314e-15  1.1965779e-13  0              3.6456101    
   3000000   6363.961       200            200            0.0040318517  -0.0022400751   0              0.01433563     1.3431241e-18  0              1.2970931e-13  1.1965779e-13  0              3.6456101    
Loop time of 364.405 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7112966.942 ns/day, 0.000 hours/ns, 8232.601 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.489     | 116.53     | 144.5      | 256.7 | 31.98
Neigh   | 1.0791     | 1.0944     | 1.11       |   1.1 |  0.30
Comm    | 23.222     | 50.443     | 78.751     | 379.9 | 13.84
Output  | 0.2422     | 0.24254    | 0.24288    |   0.1 |  0.07
Modify  | 105.56     | 140.99     | 175.43     | 285.7 | 38.69
Other   |            | 55.11      |            |       | 15.12

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         727.25 ave        1081 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2909
Ave neighs/atom = 1.1631347
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.31                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 92.2259449283427
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.41
  ghost atom cutoff = 4.41
  binsize = 2.205, bins = 2887 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.33 | 38.34 | 38.34 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.1078762e-15  3.3236285e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00058686642  3.3236285e-15  0             -0.0017605993   349192.15      0              3.3722478e+10  1.1965779e-13  0              3.8875353    
    200000   6363.961       200            200            0.0001098224   3.3236285e-15  0              0.00032946721  1785.5728      0              1.7243784e+08  1.1965779e-13  0              3.8112055    
    300000   6363.961       200            200            0.012611964   -0.0042710823   0              0.042106974    34596.634      0              3.3410953e+09  1.1965779e-13  0              3.6476005    
    400000   6363.961       200            200           -7.9426029e-05  3.3236285e-15  0             -0.00023827809  1189.3082      0              1.1485487e+08  1.1965779e-13  0              3.6581529    
    500000   6363.961       200            200            0.00073298383 -0.00066227837  0              0.0028612299   10.825798      0              1045478.1      1.1965779e-13  0              3.6530523    
    600000   6363.961       200            200            0.0025042843  -0.0019178669   0              0.0094307198   1.7376629      0              167811.05      1.1965779e-13  0              3.6514474    
    700000   6363.961       200            200            0.0035918753  -0.002260289    0              0.013035915    10.285022      0              993253.77      1.1965779e-13  0              3.6508246    
    800000   6363.961       200            200            0.0041167607  -0.0022363263   0              0.014586608    2.4356496      0              235217.6       1.1965779e-13  0              3.6505788    
    900000   6363.961       200            200            0.0041246762  -0.0022413968   0              0.014615425    0.0033244418   0              321.0508       1.1965779e-13  0              3.6505727    
   1000000   6363.961       200            200            0.0040552663  -0.0022356388   0              0.014401438    0.037379674    0              3609.8614      1.1965779e-13  0              3.6506053    
   1100000   6363.961       200            200            0.0040333666  -0.0022339503   0              0.01433405     0.0042486917   0              410.30823      1.1965779e-13  0              3.6506158    
   1200000   6363.961       200            200            0.0040362057  -0.0022341544   0              0.014342772    4.481688e-05   0              4.3280935      1.1965779e-13  0              3.6506145    
   1300000   6363.961       200            200            0.0040400009  -0.0022344438   0              0.014354446    0.00011607579  0              11.209769      1.1965779e-13  0              3.6506127    
   1400000   6363.961       200            200            0.0040407449  -0.0022345022   0              0.014356737    5.2656831e-06  0              0.50852199     1.1965779e-13  0              3.6506124    
   1500000   6363.961       200            200            0.0040404541  -0.0022344805   0              0.014355843    5.9470009e-07  0              0.057431878    1.1965779e-13  0              3.6506125    
   1600000   6363.961       200            200            0.0040402675  -0.0022344663   0              0.014355269    2.8955431e-07  0              0.027963083    1.1965779e-13  0              3.6506126    
   1700000   6363.961       200            200            0.0040402513  -0.0022344649   0              0.014355219    3.1070071e-09  0              0.00030005251  1.1965779e-13  0              3.6506126    
   1800000   6363.961       200            200            0.0040402717  -0.0022344665   0              0.014355281    3.1341379e-09  0              0.0003026726   1.1965779e-13  0              3.6506126    
   1900000   6363.961       200            200            0.0040402799  -0.0022344671   0              0.014355307    5.8200933e-10  0              5.6206295e-05  1.1965779e-13  0              3.6506126    
   2000000   6363.961       200            200            0.0040402796  -0.0022344671   0              0.014355306    1.4948794e-13  0              1.4436475e-08  1.1965779e-13  0              3.6506126    
   2100000   6363.961       200            200            0.0040402784  -0.002234467    0              0.014355302    1.1329203e-11  0              1.0940933e-06  1.1965779e-13  0              3.6506126    
   2200000   6363.961       200            200            0.0040402781  -0.002234467    0              0.014355301    8.9671138e-13  0              8.6597967e-08  1.1965779e-13  0              3.6506126    
   2300000   6363.961       200            200            0.0040402781  -0.002234467    0              0.014355301    2.958795e-14   0              2.8573924e-09  1.1965779e-13  0              3.6506126    
   2400000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    3.2000246e-14  0              3.0903547e-09  1.1965779e-13  0              3.6506126    
   2500000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    8.2238097e-16  0              7.9419668e-11  1.1965779e-13  0              3.6506126    
   2600000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    2.2515179e-16  0              2.1743548e-11  1.1965779e-13  0              3.6506126    
   2700000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    3.1256388e-17  0              3.0185183e-12  1.1965779e-13  0              3.6506126    
   2800000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    1.154795e-17   0              1.1152184e-12  1.1965779e-13  0              3.6506126    
   2900000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    7.7552539e-18  0              7.4894691e-13  1.1965779e-13  0              3.6506126    
   3000000   6363.961       200            200            0.0040402782  -0.002234467    0              0.014355302    4.4734325e-18  0              4.3201209e-13  1.1965779e-13  0              3.6506126    
Loop time of 366.161 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7078851.632 ns/day, 0.000 hours/ns, 8193.115 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.251     | 116.42     | 144.55     | 256.7 | 31.79
Neigh   | 1.1012     | 1.1179     | 1.1348     |   1.1 |  0.31
Comm    | 23.324     | 50.413     | 79.099     | 379.9 | 13.77
Output  | 0.24522    | 0.24553    | 0.24587    |   0.1 |  0.07
Modify  | 107.05     | 142.61     | 176.6      | 282.8 | 38.95
Other   |            | 55.36      |            |       | 15.12

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         729.75 ave        1086 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2919
Ave neighs/atom = 1.1671331
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.32                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 92.869379441553
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.42
  ghost atom cutoff = 4.42
  binsize = 2.21, bins = 2880 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.26 | 38.27 | 38.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.3651076e-15  4.0953228e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00059296182  4.0953228e-15  0             -0.0017788855   343404.74      0              3.3163571e+10  1.1965779e-13  0              3.8964948    
    200000   6363.961       200            200            0.00012354291  4.0953228e-15  0              0.00037062873  2231.6641      0              2.1551814e+08  1.1965779e-13  0              3.8156654    
    300000   6363.961       200            200            0.021054201   -0.0052457705   0              0.068408373    28679.682      0              2.7696784e+09  1.1965779e-13  0              3.6504925    
    400000   6363.961       200            200           -6.4939106e-05  4.0953228e-15  0             -0.00019481732  780.49516      0              75374636       1.1965779e-13  0              3.6635572    
    500000   6363.961       200            200            0.00083170002 -0.00067323891  0              0.003168339    80.62528       0              7786212.5      1.1965779e-13  0              3.6579667    
    600000   6363.961       200            200            0.0025195751  -0.0019106164   0              0.0094693416   2.3207053      0              224117.11      1.1965779e-13  0              3.6564485    
    700000   6363.961       200            200            0.0037374007  -0.0022652452   0              0.013477447    15.508098      0              1497661.1      1.1965779e-13  0              3.65576      
    800000   6363.961       200            200            0.0041842164  -0.0022512565   0              0.014803906    1.7435113      0              168375.84      1.1965779e-13  0              3.6555509    
    900000   6363.961       200            200            0.0041301618  -0.0022369291   0              0.014627414    0.02232615     0              2156.0998      1.1965779e-13  0              3.6555762    
   1000000   6363.961       200            200            0.004052184   -0.0022305286   0              0.01438708     0.048127887    0              4647.8469      1.1965779e-13  0              3.655613     
   1100000   6363.961       200            200            0.0040383195  -0.0022294397   0              0.014344398    0.0016369859   0              158.08838      1.1965779e-13  0              3.6556198    
   1200000   6363.961       200            200            0.0040449869  -0.002229938    0              0.014364899    0.00033878239  0              32.717179      1.1965779e-13  0              3.6556167    
   1300000   6363.961       200            200            0.0040486987  -0.0022302218   0              0.014376318    0.00011084709  0              10.704819      1.1965779e-13  0              3.6556149    
   1400000   6363.961       200            200            0.0040488228  -0.0022302331   0              0.014376702    1.7690621e-07  0              0.017084336    1.1965779e-13  0              3.6556148    
   1500000   6363.961       200            200            0.0040483567  -0.002230198    0              0.014375268    1.6979439e-06  0              0.16397527     1.1965779e-13  0              3.655615     
   1600000   6363.961       200            200            0.0040482115  -0.0022301868   0              0.014374821    1.7289078e-07  0              0.016696554    1.1965779e-13  0              3.6556151    
   1700000   6363.961       200            200            0.0040482343  -0.0022301885   0              0.014374891    3.724241e-09   0              0.00035966054  1.1965779e-13  0              3.6556151    
   1800000   6363.961       200            200            0.0040482602  -0.0022301904   0              0.014374971    5.3085083e-09  0              0.00051265774  1.1965779e-13  0              3.6556151    
   1900000   6363.961       200            200            0.0040482642  -0.0022301907   0              0.014374983    1.40551e-10    0              1.3573409e-05  1.1965779e-13  0              3.6556151    
   2000000   6363.961       200            200            0.0040482619  -0.0022301906   0              0.014374976    4.2940371e-11  0              4.1468736e-06  1.1965779e-13  0              3.6556151    
   2100000   6363.961       200            200            0.0040482607  -0.0022301905   0              0.014374972    1.1585144e-11  0              1.1188103e-06  1.1965779e-13  0              3.6556151    
   2200000   6363.961       200            200            0.0040482606  -0.0022301905   0              0.014374972    3.0056737e-15  0              2.9026646e-10  1.1965779e-13  0              3.6556151    
   2300000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    1.9691369e-13  0              1.9016515e-08  1.1965779e-13  0              3.6556151    
   2400000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    1.6792984e-14  0              1.6217462e-09  1.1965779e-13  0              3.6556151    
   2500000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    5.6927315e-16  0              5.4976326e-11  1.1965779e-13  0              3.6556151    
   2600000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    5.8168552e-16  0              5.6175024e-11  1.1965779e-13  0              3.6556151    
   2700000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    2.8919149e-18  0              2.7928045e-13  1.1965779e-13  0              3.6556151    
   2800000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    2.0292566e-18  0              1.9597108e-13  1.1965779e-13  0              3.6556151    
   2900000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    4.7874698e-18  0              4.6233956e-13  1.1965779e-13  0              3.6556151    
   3000000   6363.961       200            200            0.0040482608  -0.0022301905   0              0.014374973    2.7476534e-19  0              2.653487e-14   1.1965779e-13  0              3.6556151    
Loop time of 363.263 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7135325.087 ns/day, 0.000 hours/ns, 8258.478 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.44      | 116.24     | 144.08     | 256.6 | 32.00
Neigh   | 1.0961     | 1.1127     | 1.1285     |   1.1 |  0.31
Comm    | 22.832     | 50.225     | 78.263     | 381.2 | 13.83
Output  | 0.24352    | 0.24384    | 0.24418    |   0.1 |  0.07
Modify  | 105.07     | 140.44     | 174.7      | 286.9 | 38.66
Other   |            | 55         |            |       | 15.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         731.75 ave        1090 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2927
Ave neighs/atom = 1.1703319
Neighbor list builds = 145
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.33                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 93.5157997244211
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.43
  ghost atom cutoff = 4.43
  binsize = 2.215, bins = 2874 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.2 | 38.21 | 38.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.6400756e-15  4.9202268e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00059885919  4.9202268e-15  0             -0.0017965776   337669.04      0              3.2609659e+10  1.1965779e-13  0              3.9054216    
    200000   6363.961       200            200            0.00013740791  4.9202268e-15  0              0.00041222374  2726.9577      0              2.6335005e+08  1.1965779e-13  0              3.8200735    
    300000   6363.961       200            200            0.030363987   -0.0056874264   0              0.096779387    19944.076      0              1.9260561e+09  1.1965779e-13  0              3.6536454    
    400000   6363.961       200            200           -5.0202595e-05  4.9202268e-15  0             -0.00015060779  457.88215      0              44218981       1.1965779e-13  0              3.6688777    
    500000   6363.961       200            200            0.0010116635  -0.00071533641  0              0.0037503268   209.08067      0              20191515       1.1965779e-13  0              3.6628005    
    600000   6363.961       200            200            0.0026120847  -0.0019201186   0              0.0097563726   18.346345      0              1771758.6      1.1965779e-13  0              3.661403     
    700000   6363.961       200            200            0.0039092012  -0.0022678433   0              0.013995447    19.07542       0              1842167.5      1.1965779e-13  0              3.6606843    
    800000   6363.961       200            200            0.0042421021  -0.0022535882   0              0.014979895    0.903463       0              87249.99       1.1965779e-13  0              3.6605295    
    900000   6363.961       200            200            0.0041258442  -0.0022319058   0              0.014609438    0.1143359      0              11041.743      1.1965779e-13  0              3.6605843    
   1000000   6363.961       200            200            0.0040485285  -0.0022254917   0              0.014371077    0.046091109    0              4451.1494      1.1965779e-13  0              3.660621     
   1100000   6363.961       200            200            0.0040448596  -0.0022251732   0              0.014359752    8.5193168e-05  0              8.2273464      1.1965779e-13  0              3.660623     
   1200000   6363.961       200            200            0.0040543467  -0.0022258892   0              0.014388929    0.00070718641  0              68.295002      1.1965779e-13  0              3.6606185    
   1300000   6363.961       200            200            0.0040572607  -0.0022261134   0              0.014397896    6.4130491e-05  0              6.1932638      1.1965779e-13  0              3.6606171    
   1400000   6363.961       200            200            0.0040567223  -0.0022260744   0              0.014396241    2.3960378e-06  0              0.23139218     1.1965779e-13  0              3.6606174    
   1500000   6363.961       200            200            0.0040561926  -0.0022260343   0              0.014394612    2.1694491e-06  0              0.20950987     1.1965779e-13  0              3.6606176    
   1600000   6363.961       200            200            0.0040561305  -0.0022260294   0              0.014394421    2.7538022e-08  0              0.002659425    1.1965779e-13  0              3.6606176    
   1700000   6363.961       200            200            0.0040561861  -0.0022260335   0              0.014394592    2.4433142e-08  0              0.002359578    1.1965779e-13  0              3.6606176    
   1800000   6363.961       200            200            0.0040562086  -0.0022260352   0              0.014394661    3.8584456e-09  0              0.00037262106  1.1965779e-13  0              3.6606176    
   1900000   6363.961       200            200            0.0040562068  -0.0022260351   0              0.014394656    2.7779029e-11  0              2.6826998e-06  1.1965779e-13  0              3.6606176    
   2000000   6363.961       200            200            0.0040562034  -0.0022260348   0              0.014394645    9.4310733e-11  0              9.1078556e-06  1.1965779e-13  0              3.6606176    
   2100000   6363.961       200            200            0.0040562027  -0.0022260348   0              0.014394643    3.0952345e-12  0              2.9891559e-07  1.1965779e-13  0              3.6606176    
   2200000   6363.961       200            200            0.004056203   -0.0022260348   0              0.014394644    7.426858e-13   0              7.1723279e-08  1.1965779e-13  0              3.6606176    
   2300000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    2.081496e-13   0              2.0101599e-08  1.1965779e-13  0              3.6606176    
   2400000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    2.8925304e-18  0              2.7933989e-13  1.1965779e-13  0              3.6606176    
   2500000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    3.705798e-15   0              3.5787944e-10  1.1965779e-13  0              3.6606176    
   2600000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    2.7296484e-16  0              2.636099e-11   1.1965779e-13  0              3.6606176    
   2700000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    5.6158791e-17  0              5.4234141e-12  1.1965779e-13  0              3.6606176    
   2800000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    7.6371245e-19  0              7.3753882e-14  1.1965779e-13  0              3.6606176    
   2900000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    4.6308973e-19  0              4.4721892e-14  1.1965779e-13  0              3.6606176    
   3000000   6363.961       200            200            0.0040562032  -0.0022260348   0              0.014394644    3.5089329e-18  0              3.3886763e-13  1.1965779e-13  0              3.6606176    
Loop time of 363.459 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7131482.338 ns/day, 0.000 hours/ns, 8254.030 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.169     | 115.28     | 142.35     | 249.7 | 31.72
Neigh   | 1.0602     | 1.0752     | 1.0905     |   1.1 |  0.30
Comm    | 22.866     | 49.307     | 76.755     | 372.5 | 13.57
Output  | 0.24271    | 0.24302    | 0.24334    |   0.1 |  0.07
Modify  | 106.03     | 141.82     | 176.65     | 288.2 | 39.02
Other   |            | 55.73      |            |       | 15.33

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         708.25 ave        1043 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2833
Ave neighs/atom = 1.1327469
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.34                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 94.1652126884511
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.44
  ghost atom cutoff = 4.44
  binsize = 2.22, bins = 2867 91 91
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 38.16 | 38.16 | 38.17 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.9318225e-15  5.7954675e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006045591   5.7954675e-15  0             -0.0018136773   331985         0              3.2060735e+10  1.1965779e-13  0              3.9143159    
    200000   6363.961       200            200            0.00015141643  5.7954675e-15  0              0.00045424929  3271.3114      0              3.1591984e+08  1.1965779e-13  0              3.8244296    
    300000   6363.961       200            200            0.038425461   -0.0072966107   0              0.12257299     10335.778      0              9.9815549e+08  1.1965779e-13  0              3.6571982    
    400000   6363.961       200            200           -3.5218836e-05  5.7954675e-15  0             -0.00010565651  221.08497      0              21350804       1.1965779e-13  0              3.6741143    
    500000   6363.961       200            200            0.0012959503  -0.00076432436  0              0.0046521752   383.51906      0              37037526       1.1965779e-13  0              3.6675575    
    600000   6363.961       200            200            0.0027826821  -0.0019408578   0              0.010288904    46.50007       0              4490643.9      1.1965779e-13  0              3.6663134    
    700000   6363.961       200            200            0.0040984323  -0.0022593532   0              0.01455465     19.86251       0              1918179.1      1.1965779e-13  0              3.6656036    
    800000   6363.961       200            200            0.0042830881  -0.0022490501   0              0.015098314    0.23739571     0              22925.978      1.1965779e-13  0              3.6655168    
    900000   6363.961       200            200            0.0041139267  -0.0022242768   0              0.014566057    0.23641241     0              22831.018      1.1965779e-13  0              3.6655963    
   1000000   6363.961       200            200            0.0040466141  -0.0022185688   0              0.014358411    0.032431909    0              3132.0417      1.1965779e-13  0              3.6656285    
   1100000   6363.961       200            200            0.0040539048  -0.0022190875   0              0.014380802    0.00054671677  0              52.797992      1.1965779e-13  0              3.6656253    
   1200000   6363.961       200            200            0.0040647099  -0.0022199052   0              0.014414035    0.00088420728  0              85.39041       1.1965779e-13  0              3.6656202    
   1300000   6363.961       200            200            0.0040662478  -0.002220026    0              0.014418769    1.4235255e-05  0              1.3747391      1.1965779e-13  0              3.6656194    
   1400000   6363.961       200            200            0.0040651487  -0.0022199444   0              0.01441539     9.7911892e-06  0              0.94556297     1.1965779e-13  0              3.6656199    
   1500000   6363.961       200            200            0.0040646855  -0.0022199091   0              0.014413966    1.5306045e-06  0              0.14781483     1.1965779e-13  0              3.6656202    
   1600000   6363.961       200            200            0.0040647258  -0.0022199119   0              0.014414089    1.7849992e-08  0              0.0017238245   1.1965779e-13  0              3.6656201    
   1700000   6363.961       200            200            0.0040647976  -0.0022199173   0              0.01441431     3.9147248e-08  0              0.003780561    1.1965779e-13  0              3.6656201    
   1800000   6363.961       200            200            0.0040648089  -0.0022199182   0              0.014414345    7.8797366e-10  0              7.6096856e-05  1.1965779e-13  0              3.6656201    
   1900000   6363.961       200            200            0.0040648018  -0.0022199177   0              0.014414323    4.0519955e-10  0              3.9131272e-05  1.1965779e-13  0              3.6656201    
   2000000   6363.961       200            200            0.0040647987  -0.0022199174   0              0.014414313    7.1754692e-11  0              6.9295545e-06  1.1965779e-13  0              3.6656201    
   2100000   6363.961       200            200            0.0040647989  -0.0022199174   0              0.014414314    5.4813613e-13  0              5.2935064e-08  1.1965779e-13  0              3.6656201    
   2200000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    1.7270627e-12  0              1.6678735e-07  1.1965779e-13  0              3.6656201    
   2300000   6363.961       200            200            0.0040647995  -0.0022199175   0              0.014414316    4.2383441e-14  0              4.0930893e-09  1.1965779e-13  0              3.6656201    
   2400000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    1.650089e-14   0              1.5935379e-09  1.1965779e-13  0              3.6656201    
   2500000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    3.3804181e-15  0              3.2645658e-10  1.1965779e-13  0              3.6656201    
   2600000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    1.1889443e-17  0              1.1481973e-12  1.1965779e-13  0              3.6656201    
   2700000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    6.1404014e-17  0              5.9299601e-12  1.1965779e-13  0              3.6656201    
   2800000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    1.0115288e-17  0              9.7686215e-13  1.1965779e-13  0              3.6656201    
   2900000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    2.9372107e-19  0              2.8365479e-14  1.1965779e-13  0              3.6656201    
   3000000   6363.961       200            200            0.0040647994  -0.0022199175   0              0.014414316    7.1370837e-18  0              6.8924846e-13  1.1965779e-13  0              3.6656201    
Loop time of 361.98 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7160608.244 ns/day, 0.000 hours/ns, 8287.741 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.508     | 115.51     | 142.55     | 250.6 | 31.91
Neigh   | 1.017      | 1.032      | 1.0465     |   1.1 |  0.29
Comm    | 22.545     | 49.301     | 76.487     | 374.9 | 13.62
Output  | 0.24317    | 0.24349    | 0.24381    |   0.1 |  0.07
Modify  | 105.16     | 140.49     | 175.17     | 286.7 | 38.81
Other   |            | 55.41      |            |       | 15.31

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         711.25 ave        1049 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2845
Ave neighs/atom = 1.137545
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.35                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 94.8176252451468
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.45
  ghost atom cutoff = 4.45
  binsize = 2.225, bins = 2861 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.59 | 37.6 | 37.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.2395477e-15  6.7186432e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006100621   6.7186432e-15  0             -0.0018301863   326352.5       0              3.1516789e+10  1.1965779e-13  0              3.9231774    
    200000   6363.961       200            200            0.00016556757  6.7186432e-15  0              0.0004967027   3864.586       0              3.7321405e+08  1.1965779e-13  0              3.8287336    
    300000   6363.961       200            200            0.043872214   -0.0089709849   0              0.14058763     2788.9786      0              2.6933959e+08  1.1965779e-13  0              3.6612778    
    400000   6363.961       200            200           -1.9989867e-05  6.7186432e-15  0             -5.9969602e-05  69.714388      0              6732516.6      1.1965779e-13  0              3.6792667    
    500000   6363.961       200            200            0.0017142182  -0.00079127215  0              0.0059339267   584.51376      0              56448155       1.1965779e-13  0              3.6722439    
    600000   6363.961       200            200            0.0030383924  -0.0019407881   0              0.011055965    80.864358      0              7809300.9      1.1965779e-13  0              3.6711845    
    700000   6363.961       200            200            0.0042833209  -0.0022624114   0              0.015112374    17.577825      0              1697540.5      1.1965779e-13  0              3.6705244    
    800000   6363.961       200            200            0.0043007598  -0.0022464151   0              0.015148694    0.00054713753  0              52.838626      1.1965779e-13  0              3.6705143    
    900000   6363.961       200            200            0.0040951751  -0.002219334    0              0.014504859    0.33222033     0              32083.461      1.1965779e-13  0              3.6706111    
   1000000   6363.961       200            200            0.0040462117  -0.0022149334   0              0.014353569    0.014533832    0              1403.5735      1.1965779e-13  0              3.6706348    
   1100000   6363.961       200            200            0.0040636901  -0.0022162405   0              0.014407311    0.002710896    0              261.79893      1.1965779e-13  0              3.6706267    
   1200000   6363.961       200            200            0.0040740532  -0.0022170301   0              0.01443919     0.00074392575  0              71.843024      1.1965779e-13  0              3.6706218    
   1300000   6363.961       200            200            0.0040738866  -0.0022170228   0              0.014438683    1.5744467e-06  0              0.15204879     1.1965779e-13  0              3.6706219    
   1400000   6363.961       200            200            0.0040724543  -0.0022169152   0              0.014434278    1.5531567e-05  0              1.4999276      1.1965779e-13  0              3.6706225    
   1500000   6363.961       200            200            0.0040721741  -0.0022168934   0              0.014433416    4.4066748e-07  0              0.042556511    1.1965779e-13  0              3.6706227    
   1600000   6363.961       200            200            0.0040723079  -0.0022169033   0              0.014433827    1.5276237e-07  0              0.014752696    1.1965779e-13  0              3.6706226    
   1700000   6363.961       200            200            0.0040723739  -0.0022169084   0              0.01443403     2.9610087e-08  0              0.0028595303   1.1965779e-13  0              3.6706226    
   1800000   6363.961       200            200            0.0040723698  -0.0022169081   0              0.014434018    2.6594689e-10  0              2.5683247e-05  1.1965779e-13  0              3.6706226    
   1900000   6363.961       200            200            0.0040723601  -0.0022169074   0              0.014433988    7.0958907e-10  0              6.8527033e-05  1.1965779e-13  0              3.6706226    
   2000000   6363.961       200            200            0.0040723586  -0.0022169072   0              0.014433983    1.1778763e-11  0              1.1375086e-06  1.1965779e-13  0              3.6706226    
   2100000   6363.961       200            200            0.0040723596  -0.0022169073   0              0.014433986    8.2049666e-12  0              7.9237695e-07  1.1965779e-13  0              3.6706226    
   2200000   6363.961       200            200            0.00407236    -0.0022169073   0              0.014433987    1.140879e-12   0              1.1017793e-07  1.1965779e-13  0              3.6706226    
   2300000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    2.557342e-14   0              2.4696979e-09  1.1965779e-13  0              3.6706226    
   2400000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    3.1603721e-14  0              3.0520611e-09  1.1965779e-13  0              3.6706226    
   2500000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    2.2199531e-16  0              2.1438718e-11  1.1965779e-13  0              3.6706226    
   2600000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    4.1921554e-16  0              4.0484836e-11  1.1965779e-13  0              3.6706226    
   2700000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    2.8166419e-18  0              2.7201111e-13  1.1965779e-13  0              3.6706226    
   2800000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    5.888357e-18   0              5.6865537e-13  1.1965779e-13  0              3.6706226    
   2900000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    6.2351392e-19  0              6.0214511e-14  1.1965779e-13  0              3.6706226    
   3000000   6363.961       200            200            0.0040723599  -0.0022169073   0              0.014433987    1.0314842e-18  0              9.9613358e-14  1.1965779e-13  0              3.6706226    
Loop time of 363.238 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7135817.893 ns/day, 0.000 hours/ns, 8259.048 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.356     | 115.91     | 143.49     | 253.7 | 31.91
Neigh   | 0.98469    | 1.0002     | 1.0154     |   1.1 |  0.28
Comm    | 22.936     | 49.749     | 77.67      | 376.6 | 13.70
Output  | 0.2434     | 0.24371    | 0.24405    |   0.1 |  0.07
Modify  | 105.78     | 141.14     | 175.2      | 285.3 | 38.86
Other   |            | 55.2       |            |       | 15.20

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         714.75 ave        1056 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2859
Ave neighs/atom = 1.1431427
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.36                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 95.4730443060119
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.46
  ghost atom cutoff = 4.46
  binsize = 2.23, bins = 2854 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.5 | 37.51 | 37.52 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.5625697e-15  7.6877091e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00061536878  7.6877091e-15  0             -0.0018461063   320771.46      0              3.0977812e+10  1.1965779e-13  0              3.9320062    
    200000   6363.961       200            200            0.00017986043  7.6877091e-15  0              0.00053958128  4506.6433      0              4.3521936e+08  1.1965779e-13  0              3.8329855    
    300000   6363.961       200            200            0.045804641   -0.0093902855   0              0.14680421     1.4806073      0              142986.45      1.1965779e-13  0              3.6659743    
    400000   6363.961       200            200           -4.5178929e-06  7.6877091e-15  0             -1.3553679e-05  3.3854299      0              326940.58      1.1965779e-13  0              3.6843349    
    500000   6363.961       200            200            0.002257516   -0.00087268186  0              0.00764523     786.01008      0              75907227       1.1965779e-13  0              3.6768685    
    600000   6363.961       200            200            0.0033656735  -0.0019420746   0              0.012039095    113.92529      0              11002089       1.1965779e-13  0              3.6760233    
    700000   6363.961       200            200            0.0044586961  -0.002247486    0              0.015623574    12.89397       0              1245207.3      1.1965779e-13  0              3.6754532    
    800000   6363.961       200            200            0.0042950072  -0.0022426361   0              0.015127658    0.28129581     0              27165.536      1.1965779e-13  0              3.6755226    
    900000   6363.961       200            200            0.0040737725  -0.0022141854   0              0.014435503    0.35797948     0              34571.096      1.1965779e-13  0              3.6756272    
   1000000   6363.961       200            200            0.0040494266  -0.0022116512   0              0.014359931    0.0019791651   0              191.1336       1.1965779e-13  0              3.6756394    
   1100000   6363.961       200            200            0.0040748593  -0.0022135799   0              0.014438158    0.0052106094   0              503.20336      1.1965779e-13  0              3.6756275    
   1200000   6363.961       200            200            0.0040830511  -0.0022142092   0              0.014463362    0.00038837772  0              37.50674       1.1965779e-13  0              3.6756236    
   1300000   6363.961       200            200            0.0040811718  -0.0022140722   0              0.014457588    3.5899507e-05  0              3.4669174      1.1965779e-13  0              3.6756245    
   1400000   6363.961       200            200            0.0040797114  -0.0022139615   0              0.014453096    1.4383455e-05  0              1.3890512      1.1965779e-13  0              3.6756252    
   1500000   6363.961       200            200            0.0040796876  -0.002213959    0              0.014453022    7.7265531e-09  0              0.0007461752   1.1965779e-13  0              3.6756252    
   1600000   6363.961       200            200            0.0040798799  -0.0022139734   0              0.014453613    2.7859846e-07  0              0.026905045    1.1965779e-13  0              3.6756251    
   1700000   6363.961       200            200            0.0040799196  -0.0022139765   0              0.014453735    7.7970799e-09  0              0.00075298617  1.1965779e-13  0              3.6756251    
   1800000   6363.961       200            200            0.0040799012  -0.0022139752   0              0.014453679    2.9576095e-09  0              0.00028562476  1.1965779e-13  0              3.6756251    
   1900000   6363.961       200            200            0.0040798924  -0.0022139745   0              0.014453652    4.9370025e-10  0              4.7678036e-05  1.1965779e-13  0              3.6756251    
   2000000   6363.961       200            200            0.0040798932  -0.0022139746   0              0.014453654    9.6936928e-12  0              9.3614747e-07  1.1965779e-13  0              3.6756251    
   2100000   6363.961       200            200            0.0040798946  -0.0022139747   0              0.014453658    1.2855627e-11  0              1.2415044e-06  1.1965779e-13  0              3.6756251    
   2200000   6363.961       200            200            0.0040798947  -0.0022139747   0              0.014453659    6.8075051e-14  0              6.5742012e-09  1.1965779e-13  0              3.6756251    
   2300000   6363.961       200            200            0.0040798945  -0.0022139747   0              0.014453658    1.8817059e-13  0              1.8172169e-08  1.1965779e-13  0              3.6756251    
   2400000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    1.3668505e-14  0              1.3200064e-09  1.1965779e-13  0              3.6756251    
   2500000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    1.3691794e-15  0              1.3222555e-10  1.1965779e-13  0              3.6756251    
   2600000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    5.2989484e-16  0              5.1173451e-11  1.1965779e-13  0              3.6756251    
   2700000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    2.8568395e-17  0              2.7589311e-12  1.1965779e-13  0              3.6756251    
   2800000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    4.8191965e-21  0              4.654035e-16   1.1965779e-13  0              3.6756251    
   2900000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    2.9406862e-18  0              2.8399043e-13  1.1965779e-13  0              3.6756251    
   3000000   6363.961       200            200            0.0040798945  -0.0022139746   0              0.014453658    5.8257378e-20  0              5.6260806e-15  1.1965779e-13  0              3.6756251    
Loop time of 363.454 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7131584.833 ns/day, 0.000 hours/ns, 8254.149 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.306     | 116.07     | 144.15     | 254.9 | 31.93
Neigh   | 1.01       | 1.0248     | 1.0388     |   1.0 |  0.28
Comm    | 23.091     | 49.873     | 78.19      | 379.0 | 13.72
Output  | 0.24404    | 0.24436    | 0.24472    |   0.1 |  0.07
Modify  | 105.54     | 141.03     | 175.09     | 283.7 | 38.80
Other   |            | 55.21      |            |       | 15.19

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         717.25 ave        1061 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2869
Ave neighs/atom = 1.1471411
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.37                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 96.1314767825505
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.47
  ghost atom cutoff = 4.47
  binsize = 2.235, bins = 2848 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.46 | 37.46 | 37.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.9002998e-15  8.7008993e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00062047969  8.7008993e-15  0             -0.0018614391   315241.8       0              3.0443797e+10  1.1965779e-13  0              3.9408021    
    200000   6363.961       200            200            0.00019429408  8.7008993e-15  0              0.00058288225  5197.3432      0              5.0192221e+08  1.1965779e-13  0              3.8371851    
    300000   6363.961       200            200            0.04337318    -0.0095184196   0              0.13963796     3032.9731      0              2.9290283e+08  1.1965779e-13  0              3.6713203    
    400000   6363.961       200            200            1.1194957e-05  8.7008993e-15  0              3.358487e-05   21.713511      0              2096935.5      1.1965779e-13  0              3.6893186    
    500000   6363.961       200            200            0.0029200762  -0.0010779921   0              0.0098382207   956.77566      0              92398544       1.1965779e-13  0              3.6814433    
    600000   6363.961       200            200            0.0037508568  -0.0019545951   0              0.013207166    137.96718      0              13323883       1.1965779e-13  0              3.6808388    
    700000   6363.961       200            200            0.0046128458  -0.0022072506   0              0.016045788    7.267617       0              701854.43      1.1965779e-13  0              3.6803962    
    800000   6363.961       200            200            0.0042671172  -0.0022380228   0              0.015039374    0.96655767     0              93343.221      1.1965779e-13  0              3.6805409    
    900000   6363.961       200            200            0.0040529625  -0.0022096238   0              0.014368511    0.30230327     0              29194.286      1.1965779e-13  0              3.680643     
   1000000   6363.961       200            200            0.0040566234  -0.0022094502   0              0.01437932     0.0014054442   0              135.72774      1.1965779e-13  0              3.680642     
   1100000   6363.961       200            200            0.0040865943  -0.0022117386   0              0.014471522    0.0064829814   0              626.07994      1.1965779e-13  0              3.6806279    
   1200000   6363.961       200            200            0.0040912039  -0.0022121001   0              0.014485712    7.1916922e-05  0              6.9452216      1.1965779e-13  0              3.6806257    
   1300000   6363.961       200            200            0.0040879318  -0.0022118565   0              0.014475652    8.8871005e-05  0              8.5825256      1.1965779e-13  0              3.6806272    
   1400000   6363.961       200            200            0.0040867615  -0.0022117668   0              0.014472051    7.4365648e-06  0              0.7181702      1.1965779e-13  0              3.6806277    
   1500000   6363.961       200            200            0.0040870057  -0.0022117846   0              0.014472802    6.5969155e-07  0              0.063708288    1.1965779e-13  0              3.6806276    
   1600000   6363.961       200            200            0.0040872044  -0.0022117997   0              0.014473413    2.5405364e-07  0              0.024534682    1.1965779e-13  0              3.6806275    
   1700000   6363.961       200            200            0.0040872049  -0.0022117998   0              0.014473415    6.1307844e-10  0              5.9206728e-05  1.1965779e-13  0              3.6806275    
   1800000   6363.961       200            200            0.0040871782  -0.0022117978   0              0.014473332    5.197464e-09   0              0.00050193387  1.1965779e-13  0              3.6806276    
   1900000   6363.961       200            200            0.0040871737  -0.0022117974   0              0.014473318    7.7069487e-11  0              7.4428194e-06  1.1965779e-13  0              3.6806276    
   2000000   6363.961       200            200            0.0040871765  -0.0022117977   0              0.014473327    6.7909223e-11  0              6.5581866e-06  1.1965779e-13  0              3.6806276    
   2100000   6363.961       200            200            0.0040871776  -0.0022117977   0              0.014473331    6.5953544e-12  0              6.3693212e-07  1.1965779e-13  0              3.6806276    
   2200000   6363.961       200            200            0.0040871774  -0.0022117977   0              0.01447333     4.6087018e-13  0              4.4507543e-08  1.1965779e-13  0              3.6806276    
   2300000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    2.1182974e-13  0              2.0457e-08     1.1965779e-13  0              3.6806276    
   2400000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    2.0723925e-16  0              2.0013684e-11  1.1965779e-13  0              3.6806276    
   2500000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    4.1482251e-15  0              4.0060589e-10  1.1965779e-13  0              3.6806276    
   2600000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    1.000064e-16   0              9.6579019e-12  1.1965779e-13  0              3.6806276    
   2700000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    7.8310292e-17  0              7.5626475e-12  1.1965779e-13  0              3.6806276    
   2800000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    5.7528644e-18  0              5.5557047e-13  1.1965779e-13  0              3.6806276    
   2900000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    4.7177322e-19  0              4.5560481e-14  1.1965779e-13  0              3.6806276    
   3000000   6363.961       200            200            0.0040871772  -0.0022117977   0              0.014473329    4.7377912e-18  0              4.5754196e-13  1.1965779e-13  0              3.6806276    
Loop time of 363.106 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7138409.867 ns/day, 0.000 hours/ns, 8262.048 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.483     | 115.88     | 143.39     | 254.1 | 31.91
Neigh   | 1.0047     | 1.0204     | 1.0354     |   1.1 |  0.28
Comm    | 22.672     | 49.741     | 77.426     | 378.3 | 13.70
Output  | 0.24411    | 0.24441    | 0.24475    |   0.1 |  0.07
Modify  | 105.81     | 141.18     | 175.08     | 285.4 | 38.88
Other   |            | 55.04      |            |       | 15.16

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         720.25 ave        1067 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2881
Ave neighs/atom = 1.1519392
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.38                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 96.7929295862661
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.48
  ghost atom cutoff = 4.48
  binsize = 2.24, bins = 2842 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.4 | 37.41 | 37.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.2522231e-15  9.7566692e-15  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00062539541  9.7566692e-15  0             -0.0018761862   309763.4       0              2.9914732e+10  1.1965779e-13  0              3.9495653    
    200000   6363.961       200            200            0.00020886766  9.7566692e-15  0              0.00062660297  5936.5489      0              5.733094e+08   1.1965779e-13  0              3.8413322    
    300000   6363.961       200            200            0.037646496   -0.0077265848   0              0.12066607     10690.674      0              1.0324288e+09  1.1965779e-13  0              3.6772836    
    400000   6363.961       200            200            2.7146522e-05  9.7566692e-15  0              8.1439566e-05  124.31541      0              12005493       1.1965779e-13  0              3.6942178    
    500000   6363.961       200            200            0.0037079568  -0.0013804084   0              0.012504279    1064.1505      0              1.0276804e+08  1.1965779e-13  0              3.6859839    
    600000   6363.961       200            200            0.0041524944  -0.0020469376   0              0.014504421    146.85726      0              14182423       1.1965779e-13  0              3.6856419    
    700000   6363.961       200            200            0.0047097786  -0.0022117347   0              0.016341071    2.4910098      0              240563.89      1.1965779e-13  0              3.685358     
    800000   6363.961       200            200            0.0042211598  -0.0022315876   0              0.014895067    1.7870818      0              172583.57      1.1965779e-13  0              3.6855677    
    900000   6363.961       200            200            0.0040364198  -0.0022047643   0              0.014314024    0.19096098     0              18441.644      1.1965779e-13  0              3.6856569    
   1000000   6363.961       200            200            0.0040681599  -0.0022072827   0              0.014411762    0.012993319    0              1254.8018      1.1965779e-13  0              3.6856425    
   1100000   6363.961       200            200            0.0040985225  -0.0022096094   0              0.014505177    0.0057411548   0              554.43963      1.1965779e-13  0              3.6856282    
   1200000   6363.961       200            200            0.0040987012  -0.0022096378   0              0.014505741    1.8366865e-05  0              1.7737403      1.1965779e-13  0              3.6856281    
   1300000   6363.961       200            200            0.0040946303  -0.0022093315   0              0.014493222    0.00011745817  0              11.34327       1.1965779e-13  0              3.68563      
   1400000   6363.961       200            200            0.0040940111  -0.0022092828   0              0.014491316    1.0168325e-06  0              0.098198405    1.1965779e-13  0              3.6856303    
   1500000   6363.961       200            200            0.0040944691  -0.002209317    0              0.014492724    1.7242201e-06  0              0.16651284     1.1965779e-13  0              3.6856301    
   1600000   6363.961       200            200            0.0040946195  -0.0022093286   0              0.014493187    1.0762177e-07  0              0.010393341    1.1965779e-13  0              3.68563      
   1700000   6363.961       200            200            0.0040945798  -0.0022093256   0              0.014493065    1.6632709e-08  0              0.001606268    1.1965779e-13  0              3.68563      
   1800000   6363.961       200            200            0.0040945538  -0.0022093237   0              0.014492985    3.9798785e-09  0              0.00038434818  1.1965779e-13  0              3.68563      
   1900000   6363.961       200            200            0.0040945553  -0.0022093238   0              0.01449299     6.6421364e-11  0              6.4144999e-06  1.1965779e-13  0              3.68563      
   2000000   6363.961       200            200            0.004094559   -0.002209324    0              0.014493001    9.3994006e-11  0              9.0772683e-06  1.1965779e-13  0              3.68563      
   2100000   6363.961       200            200            0.0040945594  -0.0022093241   0              0.014493002    1.0279666e-13  0              9.9273653e-09  1.1965779e-13  0              3.68563      
   2200000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    1.5876485e-12  0              1.5332373e-07  1.1965779e-13  0              3.68563      
   2300000   6363.961       200            200            0.0040945588  -0.002209324    0              0.014493       5.1728824e-14  0              4.9955995e-09  1.1965779e-13  0              3.68563      
   2400000   6363.961       200            200            0.0040945588  -0.002209324    0              0.014493001    1.8342784e-14  0              1.7714148e-09  1.1965779e-13  0              3.68563      
   2500000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    2.6543712e-15  0              2.5634017e-10  1.1965779e-13  0              3.68563      
   2600000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    1.0215429e-16  0              9.8653305e-12  1.1965779e-13  0              3.68563      
   2700000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    3.2619579e-17  0              3.1501654e-12  1.1965779e-13  0              3.68563      
   2800000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    9.8006056e-18  0              9.4647234e-13  1.1965779e-13  0              3.68563      
   2900000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    7.4153285e-19  0              7.1611935e-14  1.1965779e-13  0              3.68563      
   3000000   6363.961       200            200            0.0040945589  -0.002209324    0              0.014493001    7.050223e-18   0              6.8086008e-13  1.1965779e-13  0              3.68563      
Loop time of 364.341 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7114214.062 ns/day, 0.000 hours/ns, 8234.044 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.254     | 116.4      | 144.62     | 253.9 | 31.95
Neigh   | 0.991      | 1.0056     | 1.0195     |   1.0 |  0.28
Comm    | 23.379     | 50.107     | 78.978     | 375.0 | 13.75
Output  | 0.24561    | 0.24591    | 0.24623    |   0.1 |  0.07
Modify  | 105.3      | 141.1      | 175.28     | 285.0 | 38.73
Other   |            | 55.48      |            |       | 15.23

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         722.75 ave        1072 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2891
Ave neighs/atom = 1.1559376
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.39                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 97.4574096286626
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.49
  ghost atom cutoff = 4.49
  binsize = 2.245, bins = 2835 90 90
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 37.35 | 37.36 | 37.36 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.6178849e-15  1.0853655e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063011651  1.0853655e-14  0             -0.0018903495   304336.2       0              2.9390612e+10  1.1965779e-13  0              3.9582954    
    200000   6363.961       200            200            0.00022358022  1.0853655e-14  0              0.00067074067  6724.121       0              6.4936748e+08  1.1965779e-13  0              3.8454268    
    300000   6363.961       200            200            0.028771875   -0.007666536    0              0.093982161    20177.091      0              1.9485591e+09  1.1965779e-13  0              3.6837735    
    400000   6363.961       200            200            4.3334646e-05  1.0853655e-14  0              0.00013000394  310.80884      0              30015693       1.1965779e-13  0              3.6990322    
    500000   6363.961       200            200            0.0046324151  -0.0016835626   0              0.015580808    1081.0396      0              1.0439907e+08  1.1965779e-13  0              3.6905094    
    600000   6363.961       200            200            0.0045892446  -0.0020901085   0              0.015857842    137.7411       0              13302049       1.1965779e-13  0              3.6904448    
    700000   6363.961       200            200            0.0047574116  -0.0022100046   0              0.016482239    0.10907206     0              10533.398      1.1965779e-13  0              3.6903423    
    800000   6363.961       200            200            0.00416292    -0.0022228932   0              0.014711653    2.423943       0              234087.07      1.1965779e-13  0              3.6906006    
    900000   6363.961       200            200            0.0040269584  -0.0021997569   0              0.014280632    0.074726953    0              7216.5942      1.1965779e-13  0              3.6906676    
   1000000   6363.961       200            200            0.004083643   -0.0022045577   0              0.014455487    0.030426256    0              2938.35        1.1965779e-13  0              3.6906414    
   1100000   6363.961       200            200            0.0041100894  -0.0022065877   0              0.014536856    0.0034545441   0              333.61514      1.1965779e-13  0              3.6906289    
   1200000   6363.961       200            200            0.0041057064  -0.0022062718   0              0.014523391    0.00026247558  0              25.348013      1.1965779e-13  0              3.6906308    
   1300000   6363.961       200            200            0.0041015957  -0.0022059603   0              0.014510748    9.8754772e-05  0              9.5370291      1.1965779e-13  0              3.6906328    
   1400000   6363.961       200            200            0.0041016744  -0.0022059642   0              0.014510988    8.9329167e-07  0              0.086267716    1.1965779e-13  0              3.6906327    
   1500000   6363.961       200            200            0.0041022382  -0.0022060068   0              0.014512721    2.1231678e-06  0              0.20504035     1.1965779e-13  0              3.6906325    
   1600000   6363.961       200            200            0.0041022978  -0.0022060115   0              0.014512905    2.9324086e-09  0              0.00028319104  1.1965779e-13  0              3.6906324    
   1700000   6363.961       200            200            0.0041022293  -0.0022060064   0              0.014512694    3.5961166e-08  0              0.003472872    1.1965779e-13  0              3.6906325    
   1800000   6363.961       200            200            0.0041022127  -0.0022060051   0              0.014512643    9.5628703e-10  0              9.2351357e-05  1.1965779e-13  0              3.6906325    
   1900000   6363.961       200            200            0.0041022199  -0.0022060057   0              0.014512665    4.7110331e-10  0              4.5495786e-05  1.1965779e-13  0              3.6906325    
   2000000   6363.961       200            200            0.004102223   -0.0022060059   0              0.014512675    4.7225107e-11  0              4.5606628e-06  1.1965779e-13  0              3.6906325    
   2100000   6363.961       200            200            0.0041022224  -0.0022060059   0              0.014512673    4.2795142e-12  0              4.1328485e-07  1.1965779e-13  0              3.6906325    
   2200000   6363.961       200            200            0.0041022219  -0.0022060058   0              0.014512672    1.4013371e-12  0              1.3533111e-07  1.1965779e-13  0              3.6906325    
   2300000   6363.961       200            200            0.0041022219  -0.0022060058   0              0.014512672    1.7429014e-14  0              1.6831694e-09  1.1965779e-13  0              3.6906325    
   2400000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    3.099751e-14   0              2.9935176e-09  1.1965779e-13  0              3.6906325    
   2500000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    2.0232703e-17  0              1.9539297e-12  1.1965779e-13  0              3.6906325    
   2600000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    5.3377403e-16  0              5.1548076e-11  1.1965779e-13  0              3.6906325    
   2700000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    3.6817902e-18  0              3.5556095e-13  1.1965779e-13  0              3.6906325    
   2800000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    6.4373208e-19  0              6.2167037e-14  1.1965779e-13  0              3.6906325    
   2900000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    3.0120259e-18  0              2.908799e-13   1.1965779e-13  0              3.6906325    
   3000000   6363.961       200            200            0.004102222   -0.0022060058   0              0.014512672    9.3193514e-21  0              8.9999625e-16  1.1965779e-13  0              3.6906325    
Loop time of 363.382 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7132980.281 ns/day, 0.000 hours/ns, 8255.764 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.143     | 115.91     | 143.48     | 255.9 | 31.90
Neigh   | 1.0255     | 1.0413     | 1.0566     |   1.1 |  0.29
Comm    | 22.461     | 49.957     | 77.945     | 381.8 | 13.75
Output  | 0.2477     | 0.248      | 0.24834    |   0.1 |  0.07
Modify  | 105.59     | 140.92     | 175.38     | 287.7 | 38.78
Other   |            | 55.3       |            |       | 15.22

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         725.75 ave        1078 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2903
Ave neighs/atom = 1.1607357
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.4                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 98.1249238212441
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.5
  ghost atom cutoff = 4.5
  binsize = 2.25, bins = 2829 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.8 | 36.81 | 36.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.9968801e-15  1.199064e-14   0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063464353  1.199064e-14   0             -0.0019039306   298960.1       0              2.8871427e+10  1.1965779e-13  0              3.9669926    
    200000   6363.961       200            200            0.00023843084  1.199064e-14   0              0.00071529252  7559.9196      0              7.3008292e+08  1.1965779e-13  0              3.8494687    
    300000   6363.961       200            200            0.018454603   -0.0095415756   0              0.064905386    28529.134      0              2.7551395e+09  1.1965779e-13  0              3.6906607    
    400000   6363.961       200            200            5.9757175e-05  1.199064e-14   0              0.00017927153  580.8125       0              56090714       1.1965779e-13  0              3.7037616    
    500000   6363.961       200            200            0.0056419516  -0.0020057453   0              0.0189316      994.1407       0              96006993       1.1965779e-13  0              3.6950418    
    600000   6363.961       200            200            0.0050103587  -0.0021486788   0              0.017179755    112.19241      0              10834740       1.1965779e-13  0              3.6952601    
    700000   6363.961       200            200            0.0047503183  -0.0022058554   0              0.01645681     0.88961001     0              85912.167      1.1965779e-13  0              3.6953504    
    800000   6363.961       200            200            0.004098619   -0.0022139033   0              0.01450976     2.6328587      0              254262.65      1.1965779e-13  0              3.6956366    
    900000   6363.961       200            200            0.0040255482  -0.0021977953   0              0.01427444     0.0061282127   0              591.81892      1.1965779e-13  0              3.6956741    
   1000000   6363.961       200            200            0.0041009624  -0.0022042801   0              0.014507167    0.044309171    0              4279.0625      1.1965779e-13  0              3.695639     
   1100000   6363.961       200            200            0.0041196279  -0.0022057302   0              0.014564614    0.0010457629   0              100.99229      1.1965779e-13  0              3.6956301    
   1200000   6363.961       200            200            0.0041113105  -0.0022051124   0              0.014539044    0.00062766506  0              60.615398      1.1965779e-13  0              3.6956339    
   1300000   6363.961       200            200            0.0041079435  -0.0022048534   0              0.014528684    4.80659e-05    0              4.6418606      1.1965779e-13  0              3.6956355    
   1400000   6363.961       200            200            0.0041087177  -0.0022049105   0              0.014531063    7.093036e-06   0              0.68499465     1.1965779e-13  0              3.6956351    
   1500000   6363.961       200            200            0.0041092511  -0.0022049513   0              0.014532705    1.4600148e-06  0              0.14099778     1.1965779e-13  0              3.6956349    
   1600000   6363.961       200            200            0.0041092016  -0.0022049478   0              0.014532553    5.5078993e-08  0              0.0053191349   1.1965779e-13  0              3.6956349    
   1700000   6363.961       200            200            0.0041091246  -0.0022049419   0              0.014532316    3.4962755e-08  0              0.0033764527   1.1965779e-13  0              3.6956349    
   1800000   6363.961       200            200            0.0041091234  -0.0022049418   0              0.014532312    1.5379313e-10  0              1.485224e-05   1.1965779e-13  0              3.6956349    
   1900000   6363.961       200            200            0.0041091336  -0.0022049426   0              0.014532343    7.0097476e-10  0              6.7695125e-05  1.1965779e-13  0              3.6956349    
   2000000   6363.961       200            200            0.0041091348  -0.0022049427   0              0.014532347    1.1056583e-12  0              1.0677656e-07  1.1965779e-13  0              3.6956349    
   2100000   6363.961       200            200            0.0041091336  -0.0022049426   0              0.014532343    1.1970082e-11  0              1.1559849e-06  1.1965779e-13  0              3.6956349    
   2200000   6363.961       200            200            0.0041091333  -0.0022049425   0              0.014532342    2.4756376e-13  0              2.3907936e-08  1.1965779e-13  0              3.6956349    
   2300000   6363.961       200            200            0.0041091334  -0.0022049425   0              0.014532343    1.7221173e-13  0              1.6630976e-08  1.1965779e-13  0              3.6956349    
   2400000   6363.961       200            200            0.0041091335  -0.0022049426   0              0.014532343    1.1901495e-14  0              1.1493612e-09  1.1965779e-13  0              3.6956349    
   2500000   6363.961       200            200            0.0041091335  -0.0022049426   0              0.014532343    2.0416628e-15  0              1.9716918e-10  1.1965779e-13  0              3.6956349    
   2600000   6363.961       200            200            0.0041091335  -0.0022049425   0              0.014532343    4.0271989e-16  0              3.8891805e-11  1.1965779e-13  0              3.6956349    
   2700000   6363.961       200            200            0.0041091335  -0.0022049425   0              0.014532343    5.9221507e-17  0              5.7191892e-12  1.1965779e-13  0              3.6956349    
   2800000   6363.961       200            200            0.0041091335  -0.0022049425   0              0.014532343    2.5209924e-18  0              2.434594e-13   1.1965779e-13  0              3.6956349    
   2900000   6363.961       200            200            0.0041091335  -0.0022049426   0              0.014532343    4.3870963e-18  0              4.2367435e-13  1.1965779e-13  0              3.6956349    
   3000000   6363.961       200            200            0.0041091335  -0.0022049426   0              0.014532343    2.1851687e-19  0              2.1102795e-14  1.1965779e-13  0              3.6956349    
Loop time of 363.765 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7125471.612 ns/day, 0.000 hours/ns, 8247.074 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.326     | 116.11     | 143.9      | 257.4 | 31.92
Neigh   | 1.003      | 1.0186     | 1.0335     |   1.1 |  0.28
Comm    | 22.372     | 50.119     | 78.079     | 383.5 | 13.78
Output  | 0.24224    | 0.24255    | 0.24289    |   0.1 |  0.07
Modify  | 105.03     | 140.46     | 175.72     | 289.0 | 38.61
Other   |            | 55.81      |            |       | 15.34

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         727.75 ave        1082 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2911
Ave neighs/atom = 1.1639344
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.41                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 98.7954790755143
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.51
  ghost atom cutoff = 4.51
  binsize = 2.255, bins = 2823 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.74 | 36.74 | 36.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.3888448e-15  1.3166535e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063897707  1.3166535e-14  0             -0.0019169312   293635.02      0              2.8357168e+10  1.1965779e-13  0              3.9756568    
    200000   6363.961       200            200            0.00025341862  1.3166535e-14  0              0.00076025586  8443.8078      0              8.1544252e+08  1.1965779e-13  0              3.8534578    
    300000   6363.961       200            200            0.0097228313  -0.0090410822   0              0.038209576    33856.838      0              3.269651e+09   1.1965779e-13  0              3.6978028    
    400000   6363.961       200            200            7.6411985e-05  1.3166535e-14  0              0.00022923596  933.94659      0              90193876       1.1965779e-13  0              3.708406     
    500000   6363.961       200            200            0.0067122381  -0.0022270567   0              0.022363771    810.98354      0              78318986       1.1965779e-13  0              3.6996055    
    600000   6363.961       200            200            0.0053904516  -0.002198411    0              0.018369766    76.242603      0              7362964.9      1.1965779e-13  0              3.7001003    
    700000   6363.961       200            200            0.0046888227  -0.0022020938   0              0.016268562    4.5549329      0              439882.82      1.1965779e-13  0              3.7003819    
    800000   6363.961       200            200            0.0040347237  -0.00220726     0              0.014311431    2.336916       0              225682.62      1.1965779e-13  0              3.7006722    
    900000   6363.961       200            200            0.0040333207  -0.0021984517   0              0.014298414    0.015713391    0              1517.4868      1.1965779e-13  0              3.7006761    
   1000000   6363.961       200            200            0.0041188747  -0.0022057482   0              0.014562372    0.047202906    0              4558.5188      1.1965779e-13  0              3.7006361    
   1100000   6363.961       200            200            0.0041269163  -0.002206398    0              0.014587147    6.0009046e-07  0              0.057952441    1.1965779e-13  0              3.7006321    
   1200000   6363.961       200            200            0.0041159604  -0.002205573    0              0.014553454    0.00085359589  0              82.434181      1.1965779e-13  0              3.7006371    
   1300000   6363.961       200            200            0.0041139933  -0.002205418    0              0.014547398    6.1198463e-06  0              0.59101095     1.1965779e-13  0              3.7006381    
   1400000   6363.961       200            200            0.0041153094  -0.0022055172   0              0.014551445    1.3964274e-05  0              1.3485696      1.1965779e-13  0              3.7006375    
   1500000   6363.961       200            200            0.0041156813  -0.0022055461   0              0.01455259     4.0513421e-07  0              0.039124963    1.1965779e-13  0              3.7006373    
   1600000   6363.961       200            200            0.0041155341  -0.0022055351   0              0.014552137    2.0431909e-07  0              0.019731676    1.1965779e-13  0              3.7006374    
   1700000   6363.961       200            200            0.0041154721  -0.0022055303   0              0.014551946    1.499231e-08   0              0.00144785     1.1965779e-13  0              3.7006374    
   1800000   6363.961       200            200            0.0041154869  -0.0022055314   0              0.014551992    2.5999231e-09  0              0.00025108197  1.1965779e-13  0              3.7006374    
   1900000   6363.961       200            200            0.0041154964  -0.0022055321   0              0.014552021    4.2591348e-10  0              4.1131676e-05  1.1965779e-13  0              3.7006374    
   2000000   6363.961       200            200            0.0041154952  -0.002205532    0              0.014552018    2.702607e-11   0              2.6099844e-06  1.1965779e-13  0              3.7006374    
   2100000   6363.961       200            200            0.0041154938  -0.0022055319   0              0.014552013    1.0261083e-11  0              9.9094192e-07  1.1965779e-13  0              3.7006374    
   2200000   6363.961       200            200            0.0041154939  -0.0022055319   0              0.014552014    1.943848e-13   0              1.8772292e-08  1.1965779e-13  0              3.7006374    
   2300000   6363.961       200            200            0.0041154941  -0.0022055319   0              0.014552014    2.1832502e-13  0              2.1084268e-08  1.1965779e-13  0              3.7006374    
   2400000   6363.961       200            200            0.0041154941  -0.0022055319   0              0.014552014    5.1744427e-16  0              4.9971064e-11  1.1965779e-13  0              3.7006374    
   2500000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    4.1917147e-15  0              4.048058e-10   1.1965779e-13  0              3.7006374    
   2600000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    9.3268869e-18  0              9.0072398e-13  1.1965779e-13  0              3.7006374    
   2700000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    6.2991402e-17  0              6.0832587e-12  1.1965779e-13  0              3.7006374    
   2800000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    1.1255847e-17  0              1.0870091e-12  1.1965779e-13  0              3.7006374    
   2900000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    1.6706663e-18  0              1.6134099e-13  1.1965779e-13  0              3.7006374    
   3000000   6363.961       200            200            0.004115494   -0.0022055319   0              0.014552014    6.4822999e-18  0              6.2601413e-13  1.1965779e-13  0              3.7006374    
Loop time of 364.419 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7112693.355 ns/day, 0.000 hours/ns, 8232.284 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.525     | 116.47     | 144.19     | 255.0 | 31.96
Neigh   | 1.0136     | 1.0289     | 1.044      |   1.1 |  0.28
Comm    | 22.764     | 49.939     | 78.157     | 380.4 | 13.70
Output  | 0.25746    | 0.25775    | 0.25807    |   0.1 |  0.07
Modify  | 105.86     | 141.13     | 176.11     | 287.4 | 38.73
Other   |            | 55.6       |            |       | 15.26

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         730.25 ave        1087 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2921
Ave neighs/atom = 1.1679328
Neighbor list builds = 142
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.42                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 99.4690823029768
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.52
  ghost atom cutoff = 4.52
  binsize = 2.26, bins = 2816 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.67 | 36.67 | 36.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.7934504e-15  1.4380351e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00064311767  1.4380351e-14  0             -0.001929353    288360.85      0              2.7847827e+10  1.1965779e-13  0              3.9842878    
    200000   6363.961       200            200            0.00026854269  1.4380351e-14  0              0.00080562806  9375.6498      0              9.0543315e+08  1.1965779e-13  0              3.857394     
    300000   6363.961       200            200            0.0041282187  -0.0051050063   0              0.017489663    35774.942      0              3.4548878e+09  1.1965779e-13  0              3.705068     
    400000   6363.961       200            200            9.3296966e-05  1.4380351e-14  0              0.0002798909   1369.8331      0              1.3228868e+08  1.1965779e-13  0              3.7129651    
    500000   6363.961       200            200            0.0077018117  -0.0024910811   0              0.025596516    563.99676      0              54466771       1.1965779e-13  0              3.7042253    
    600000   6363.961       200            200            0.0056851694  -0.0022698092   0              0.019325317    39.193305      0              3785008.9      1.1965779e-13  0              3.7049766    
    700000   6363.961       200            200            0.0045770123  -0.0022061233   0              0.01593716     9.8770837      0              953858.04      1.1965779e-13  0              3.7054343    
    800000   6363.961       200            200            0.0039804273  -0.0021965733   0              0.014137855    1.6527974      0              159615.34      1.1965779e-13  0              3.7057044    
    900000   6363.961       200            200            0.0040510054  -0.0021990588   0              0.014352075    0.098431923    0              9505.8506      1.1965779e-13  0              3.7056735    
   1000000   6363.961       200            200            0.0041366076  -0.002206347    0              0.01461617     0.037586265    0              3629.8124      1.1965779e-13  0              3.7056333    
   1100000   6363.961       200            200            0.0041326369  -0.0022060891   0              0.014604       0.00094850051  0              91.59939       1.1965779e-13  0              3.7056349    
   1200000   6363.961       200            200            0.0041208042  -0.0022051892   0              0.014567602    0.00078100429  0              75.423804      1.1965779e-13  0              3.7056404    
   1300000   6363.961       200            200            0.0041206394  -0.0022051708   0              0.014567089    6.1947436e-06  0              0.598244       1.1965779e-13  0              3.7056405    
   1400000   6363.961       200            200            0.0041222236  -0.0022052915   0              0.014571962    1.5323145e-05  0              1.4797997      1.1965779e-13  0              3.7056398    
   1500000   6363.961       200            200            0.00412234    -0.0022053011   0              0.014572321    1.0593178e-08  0              0.0010230133   1.1965779e-13  0              3.7056397    
   1600000   6363.961       200            200            0.0041221334  -0.0022052854   0              0.014571686    2.8481757e-07  0              0.027505643    1.1965779e-13  0              3.7056398    
   1700000   6363.961       200            200            0.0041221054  -0.0022052832   0              0.014571599    3.1799434e-10  0              3.0709618e-05  1.1965779e-13  0              3.7056398    
   1800000   6363.961       200            200            0.0041221316  -0.0022052852   0              0.01457168     5.0221268e-09  0              0.00048500106  1.1965779e-13  0              3.7056398    
   1900000   6363.961       200            200            0.0041221369  -0.0022052856   0              0.014571696    4.3736072e-11  0              4.2237168e-06  1.1965779e-13  0              3.7056398    
   2000000   6363.961       200            200            0.0041221337  -0.0022052854   0              0.014571687    8.3873551e-11  0              8.0999072e-06  1.1965779e-13  0              3.7056398    
   2100000   6363.961       200            200            0.0041221328  -0.0022052853   0              0.014571684    2.05907e-12    0              1.9885024e-07  1.1965779e-13  0              3.7056398    
   2200000   6363.961       200            200            0.0041221332  -0.0022052853   0              0.014571685    1.3200056e-12  0              1.2747669e-07  1.1965779e-13  0              3.7056398    
   2300000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    6.8590358e-14  0              6.6239658e-09  1.1965779e-13  0              3.7056398    
   2400000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    1.9466449e-14  0              1.8799304e-09  1.1965779e-13  0              3.7056398    
   2500000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    1.8769519e-15  0              1.8126258e-10  1.1965779e-13  0              3.7056398    
   2600000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    2.4145779e-16  0              2.3318265e-11  1.1965779e-13  0              3.7056398    
   2700000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    7.2804287e-18  0              7.030917e-13   1.1965779e-13  0              3.7056398    
   2800000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    3.3580346e-18  0              3.2429495e-13  1.1965779e-13  0              3.7056398    
   2900000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    8.022044e-19   0              7.7471159e-14  1.1965779e-13  0              3.7056398    
   3000000   6363.961       200            200            0.0041221333  -0.0022052853   0              0.014571685    6.5856145e-18  0              6.3599151e-13  1.1965779e-13  0              3.7056398    
Loop time of 364.069 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7119529.678 ns/day, 0.000 hours/ns, 8240.196 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.122     | 116.22     | 144.34     | 259.3 | 31.92
Neigh   | 1.0242     | 1.0397     | 1.055      |   1.1 |  0.29
Comm    | 22.718     | 50.414     | 78.814     | 384.8 | 13.85
Output  | 0.24178    | 0.24208    | 0.24242    |   0.1 |  0.07
Modify  | 105.33     | 140.72     | 175.36     | 286.7 | 38.65
Other   |            | 55.44      |            |       | 15.23

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         732.75 ave        1092 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2931
Ave neighs/atom = 1.1719312
Neighbor list builds = 144
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.43                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 100.145740415136
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.53
  ghost atom cutoff = 4.53
  binsize = 2.265, bins = 2810 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.61 | 36.62 | 36.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            5.210398e-15   1.5631194e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006470659   1.5631194e-14  0             -0.0019411977   283137.51      0              2.7343394e+10  1.1965779e-13  0              3.9928857    
    200000   6363.961       200            200            0.00028380209  1.5631194e-14  0              0.00085140628  10355.306      0              1.0000413e+09  1.1965779e-13  0              3.8612771    
    300000   6363.961       200            200            0.0010496829  -0.0011762781   0              0.0043253268   35047.028      0              3.3845911e+09  1.1965779e-13  0              3.7123532    
    400000   6363.961       200            200            0.00011040999  1.5631194e-14  0              0.00033122998  1888.0951      0              1.8233871e+08  1.1965779e-13  0              3.7174387    
    500000   6363.961       200            200            0.0085198485  -0.0027606547   0              0.0283202      306.82611      0              29631070       1.1965779e-13  0              3.7089248    
    600000   6363.961       200            200            0.0058834662  -0.0023046021   0              0.019955001    11.15481       0              1077251.7      1.1965779e-13  0              3.7098982    
    700000   6363.961       200            200            0.0044318399  -0.002200368    0              0.015495888    15.102384      0              1458480.1      1.1965779e-13  0              3.7105035    
    800000   6363.961       200            200            0.003943621   -0.0021765272   0              0.01400739     0.84289211     0              81400.487      1.1965779e-13  0              3.7107301    
    900000   6363.961       200            200            0.0040780187  -0.0021974875   0              0.014431544    0.21609695     0              20869.096      1.1965779e-13  0              3.7106669    
   1000000   6363.961       200            200            0.004153298   -0.0022039146   0              0.014663808    0.020637239    0              1992.9969      1.1965779e-13  0              3.7106315    
   1100000   6363.961       200            200            0.0041376204  -0.0022027771   0              0.014615638    0.0032822055   0              316.97192      1.1965779e-13  0              3.7106385    
   1200000   6363.961       200            200            0.0041268519  -0.0022019552   0              0.014582511    0.00046268686  0              44.682985      1.1965779e-13  0              3.7106436    
   1300000   6363.961       200            200            0.0041285568  -0.0022020794   0              0.01458775     4.7702535e-05  0              4.6067694      1.1965779e-13  0              3.7106428    
   1400000   6363.961       200            200            0.0041300724  -0.0022021951   0              0.014592412    9.9862348e-06  0              0.96439908     1.1965779e-13  0              3.7106421    
   1500000   6363.961       200            200            0.0041298998  -0.0022021827   0              0.014591882    6.5863142e-07  0              0.063605908    1.1965779e-13  0              3.7106422    
   1600000   6363.961       200            200            0.004129689   -0.0022021667   0              0.014591234    2.0842502e-07  0              0.020128197    1.1965779e-13  0              3.7106423    
   1700000   6363.961       200            200            0.0041297043  -0.0022021677   0              0.014591281    8.4893891e-09  0              0.00081984443  1.1965779e-13  0              3.7106423    
   1800000   6363.961       200            200            0.0041297333  -0.0022021699   0              0.01459137     4.2260922e-09  0              0.00040812573  1.1965779e-13  0              3.7106423    
   1900000   6363.961       200            200            0.0041297323  -0.0022021699   0              0.014591367    9.9262905e-11  0              9.5861009e-06  1.1965779e-13  0              3.7106423    
   2000000   6363.961       200            200            0.0041297284  -0.0022021696   0              0.014591355    8.3490507e-11  0              8.0629156e-06  1.1965779e-13  0              3.7106423    
   2100000   6363.961       200            200            0.0041297284  -0.0022021696   0              0.014591355    9.9523436e-13  0              9.6112611e-08  1.1965779e-13  0              3.7106423    
   2200000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    1.6107287e-12  0              1.5555265e-07  1.1965779e-13  0              3.7106423    
   2300000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    7.6488953e-15  0              7.3867556e-10  1.1965779e-13  0              3.7106423    
   2400000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    3.0415265e-14  0              2.9372886e-09  1.1965779e-13  0              3.7106423    
   2500000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    1.76819e-17    0              1.7075914e-12  1.1965779e-13  0              3.7106423    
   2600000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    5.6073368e-16  0              5.4151645e-11  1.1965779e-13  0              3.7106423    
   2700000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    1.9915693e-17  0              1.9233151e-12  1.1965779e-13  0              3.7106423    
   2800000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    2.7737833e-19  0              2.6787214e-14  1.1965779e-13  0              3.7106423    
   2900000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    2.1691454e-18  0              2.0948053e-13  1.1965779e-13  0              3.7106423    
   3000000   6363.961       200            200            0.0041297289  -0.0022021696   0              0.014591356    5.2612131e-20  0              5.080903e-15   1.1965779e-13  0              3.7106423    
Loop time of 365.454 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7092543.377 ns/day, 0.000 hours/ns, 8208.962 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.186     | 115.42     | 142.65     | 250.9 | 31.58
Neigh   | 0.99982    | 1.0151     | 1.0296     |   1.1 |  0.28
Comm    | 22.991     | 49.443     | 76.961     | 373.1 | 13.53
Output  | 0.24346    | 0.24377    | 0.24409    |   0.1 |  0.07
Modify  | 107.36     | 143.53     | 178.99     | 289.3 | 39.28
Other   |            | 55.8       |            |       | 15.27

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         708.75 ave        1044 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2835
Ave neighs/atom = 1.1335466
Neighbor list builds = 141
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.44                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 100.825460323495
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.54
  ghost atom cutoff = 4.54
  binsize = 2.27, bins = 2804 89 89
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.57 | 36.57 | 36.58 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            5.6394147e-15  1.6918244e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065082234  1.6918244e-14  0             -0.001952467    277964.92      0              2.6843862e+10  1.1965779e-13  0              4.0014503    
    200000   6363.961       200            200            0.00029919594  1.6918244e-14  0              0.00089758781  11382.64       0              1.0992539e+09  1.1965779e-13  0              3.865107     
    300000   6363.961       200            200           -0.00031093952  7.3561409e-07  0             -0.00093355419  32919.024      0              3.1790837e+09  1.1965779e-13  0              3.7195921    
    400000   6363.961       200            200            0.0001277489   1.6918244e-14  0              0.00038324671  2488.3553      0              2.4030754e+08  1.1965779e-13  0              3.7218267    
    500000   6363.961       200            200            0.0090822661  -0.0029761898   0              0.030222988    102.33235      0              9882526.2      1.1965779e-13  0              3.713724     
    600000   6363.961       200            200            0.0059605015  -0.0023124721   0              0.020193977    0.031505202    0              3042.5469      1.1965779e-13  0              3.7148708    
    700000   6363.961       200            200            0.0042707063  -0.0021745775   0              0.014986696    18.54704       0              1791140.3      1.1965779e-13  0              3.7155838    
    800000   6363.961       200            200            0.0039229216  -0.0021652487   0              0.013934014    0.21390844     0              20657.746      1.1965779e-13  0              3.7157472    
    900000   6363.961       200            200            0.0041117318  -0.0021947457   0              0.014529941    0.31476684     0              30397.929      1.1965779e-13  0              3.7156575    
   1000000   6363.961       200            200            0.0041672647  -0.0021995915   0              0.014701386    0.0054265768   0              524.05994      1.1965779e-13  0              3.7156312    
   1100000   6363.961       200            200            0.0041418791  -0.0021977313   0              0.014623369    0.0055450589   0              535.5021       1.1965779e-13  0              3.7156427    
   1200000   6363.961       200            200            0.0041339787  -0.0021971245   0              0.014599061    0.00012378094  0              11.953877      1.1965779e-13  0              3.7156465    
   1300000   6363.961       200            200            0.0041372667  -0.0021973686   0              0.014609169    9.7107305e-05  0              9.3779284      1.1965779e-13  0              3.715645     
   1400000   6363.961       200            200            0.0041383852  -0.0021974544   0              0.01461261     2.7527697e-06  0              0.26584279     1.1965779e-13  0              3.7156444    
   1500000   6363.961       200            200            0.0041379601  -0.002197423    0              0.014611303    1.6933226e-06  0              0.16352898     1.1965779e-13  0              3.7156446    
   1600000   6363.961       200            200            0.0041378025  -0.0021974109   0              0.014610818    5.9859794e-08  0              0.0057808304   1.1965779e-13  0              3.7156447    
   1700000   6363.961       200            200            0.0041378572  -0.0021974149   0              0.014610987    2.938407e-08   0              0.0028377031   1.1965779e-13  0              3.7156447    
   1800000   6363.961       200            200            0.0041378794  -0.0021974166   0              0.014611055    1.2779608e-09  0              0.00012341631  1.1965779e-13  0              3.7156447    
   1900000   6363.961       200            200            0.0041378724  -0.0021974161   0              0.014611033    5.0731021e-10  0              4.8992389e-05  1.1965779e-13  0              3.7156447    
   2000000   6363.961       200            200            0.0041378693  -0.0021974159   0              0.014611024    2.6851565e-11  0              2.5931319e-06  1.1965779e-13  0              3.7156447    
   2100000   6363.961       200            200            0.0041378702  -0.002197416    0              0.014611026    8.7132363e-12  0              8.4146199e-07  1.1965779e-13  0              3.7156447    
   2200000   6363.961       200            200            0.0041378706  -0.002197416    0              0.014611028    5.5640403e-13  0              5.3733519e-08  1.1965779e-13  0              3.7156447    
   2300000   6363.961       200            200            0.0041378705  -0.002197416    0              0.014611027    1.4838794e-13  0              1.4330245e-08  1.1965779e-13  0              3.7156447    
   2400000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    1.1708648e-14  0              1.1307374e-09  1.1965779e-13  0              3.7156447    
   2500000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    2.4647568e-15  0              2.3802857e-10  1.1965779e-13  0              3.7156447    
   2600000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    2.5799836e-16  0              2.4915635e-11  1.1965779e-13  0              3.7156447    
   2700000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    7.6076628e-17  0              7.3469362e-12  1.1965779e-13  0              3.7156447    
   2800000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    7.9464464e-18  0              7.6741092e-13  1.1965779e-13  0              3.7156447    
   2900000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    7.718818e-18   0              7.4542819e-13  1.1965779e-13  0              3.7156447    
   3000000   6363.961       200            200            0.0041378704  -0.002197416    0              0.014611027    1.8060906e-18  0              1.744193e-13   1.1965779e-13  0              3.7156447    
Loop time of 362.763 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7145163.594 ns/day, 0.000 hours/ns, 8269.865 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.205     | 115.59     | 143.23     | 253.3 | 31.86
Neigh   | 0.94481    | 0.95909    | 0.97307    |   1.1 |  0.26
Comm    | 22.98      | 49.535     | 77.319     | 375.7 | 13.65
Output  | 0.24298    | 0.24329    | 0.24362    |   0.1 |  0.07
Modify  | 105.8      | 141.28     | 175.24     | 284.8 | 38.95
Other   |            | 55.15      |            |       | 15.20

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         711.75 ave        1050 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2847
Ave neighs/atom = 1.1383447
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.45                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 101.508248939558
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.55
  ghost atom cutoff = 4.55
  binsize = 2.275, bins = 2798 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 36.01 | 36.02 | 36.03 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            6.0802499e-15  1.824075e-14   0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065438753  1.824075e-14   0             -0.0019631626   272842.98      0              2.6349222e+10  1.1965779e-13  0              4.0099817    
    200000   6363.961       200            200            0.00031472331  1.824075e-14   0              0.00094416993  12457.514      0              1.2030576e+09  1.1965779e-13  0              3.8688836    
    300000   6363.961       200            200           -0.00034579542  1.824075e-14   0             -0.0010373863   30554.267      0              2.9507124e+09  1.1965779e-13  0              3.7267572    
    400000   6363.961       200            200            0.00014531158  1.824075e-14   0              0.00043593474  3170.2386      0              3.0615895e+08  1.1965779e-13  0              3.726129     
    500000   6363.961       200            200            0.0093334663  -0.0030748816   0              0.031075281    4.0806563      0              394080.58      1.1965779e-13  0              3.7186371    
    600000   6363.961       200            200            0.0059042665  -0.0023045479   0              0.020017348    8.9584618      0              865144.12      1.1965779e-13  0              3.7198968    
    700000   6363.961       200            200            0.004104807   -0.0021402512   0              0.014454672    19.137563      0              1848168.8      1.1965779e-13  0              3.7206688    
    800000   6363.961       200            200            0.0039220455  -0.0021601682   0              0.013926305    0.0013477431   0              130.15538      1.1965779e-13  0              3.7207542    
    900000   6363.961       200            200            0.0041486391  -0.0021922028   0              0.01463812     0.34925457     0              33728.507      1.1965779e-13  0              3.7206466    
   1000000   6363.961       200            200            0.0041771229  -0.0021950305   0              0.014726399    3.9981591e-05  0              3.8611359      1.1965779e-13  0              3.7206327    
   1100000   6363.961       200            200            0.0041454755  -0.0021926956   0              0.014629122    0.0063373428   0              612.0152       1.1965779e-13  0              3.7206472    
   1200000   6363.961       200            200            0.0041418061  -0.0021924045   0              0.014617823    1.6129066e-06  0              0.15576297     1.1965779e-13  0              3.720649     
   1300000   6363.961       200            200            0.0041460842  -0.0021927244   0              0.014630977    0.00011496951  0              11.102932      1.1965779e-13  0              3.7206471    
   1400000   6363.961       200            200            0.0041465568  -0.002192762    0              0.014632432    5.1994933e-08  0              0.0050212985   1.1965779e-13  0              3.7206468    
   1500000   6363.961       200            200            0.0041459776  -0.0021927187   0              0.014630651    2.0847759e-06  0              0.20133273     1.1965779e-13  0              3.7206471    
   1600000   6363.961       200            200            0.004145917   -0.0021927139   0              0.014630465    1.4735647e-09  0              0.00014230633  1.1965779e-13  0              3.7206471    
   1700000   6363.961       200            200            0.0041459954  -0.0021927197   0              0.014630706    3.7788206e-08  0              0.0036493144   1.1965779e-13  0              3.7206471    
   1800000   6363.961       200            200            0.0041460031  -0.0021927204   0              0.01463073     3.8488785e-11  0              3.7169714e-06  1.1965779e-13  0              3.7206471    
   1900000   6363.961       200            200            0.0041459925  -0.0021927196   0              0.014630697    6.8466904e-10  0              6.6120435e-05  1.1965779e-13  0              3.7206471    
   2000000   6363.961       200            200            0.0041459915  -0.0021927195   0              0.014630694    9.5055529e-13  0              9.1797826e-08  1.1965779e-13  0              3.7206471    
   2100000   6363.961       200            200            0.004145993   -0.0021927196   0              0.014630698    1.2401485e-11  0              1.1976467e-06  1.1965779e-13  0              3.7206471    
   2200000   6363.961       200            200            0.0041459931  -0.0021927196   0              0.014630699    2.2553569e-14  0              2.1780622e-09  1.1965779e-13  0              3.7206471    
   2300000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    2.2465172e-13  0              2.1695256e-08  1.1965779e-13  0              3.7206471    
   2400000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    5.6450907e-16  0              5.4516245e-11  1.1965779e-13  0              3.7206471    
   2500000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    4.0459619e-15  0              3.9073004e-10  1.1965779e-13  0              3.7206471    
   2600000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    4.794565e-18   0              4.6302477e-13  1.1965779e-13  0              3.7206471    
   2700000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    3.799149e-17   0              3.6689462e-12  1.1965779e-13  0              3.7206471    
   2800000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    7.8270865e-18  0              7.5588399e-13  1.1965779e-13  0              3.7206471    
   2900000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    7.0896593e-18  0              6.8466855e-13  1.1965779e-13  0              3.7206471    
   3000000   6363.961       200            200            0.0041459929  -0.0021927196   0              0.014630698    8.5025898e-19  0              8.2111927e-14  1.1965779e-13  0              3.7206471    
Loop time of 362.477 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7150799.279 ns/day, 0.000 hours/ns, 8276.388 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.064     | 115.78     | 143.29     | 253.4 | 31.94
Neigh   | 0.87899    | 0.8917     | 0.90414    |   1.0 |  0.25
Comm    | 22.596     | 49.402     | 77.429     | 378.1 | 13.63
Output  | 0.243      | 0.2433     | 0.24364    |   0.1 |  0.07
Modify  | 105.53     | 140.89     | 175.21     | 285.9 | 38.87
Other   |            | 55.28      |            |       | 15.25

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         715.25 ave        1057 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2861
Ave neighs/atom = 1.1439424
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.46                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 102.194113174829
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.56
  ghost atom cutoff = 4.56
  binsize = 2.28, bins = 2792 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.96 | 35.97 | 35.97 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            6.5326729e-15  1.9598019e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065776205  1.9598019e-14  0             -0.0019732862   267771.61      0              2.5859466e+10  1.1965779e-13  0              4.0184797    
    200000   6363.961       200            200            0.0003303833   1.9598019e-14  0              0.00099114991  13579.793      0              1.3114392e+09  1.1965779e-13  0              3.8726068    
    300000   6363.961       200            200           -0.00033637716  1.9598019e-14  0             -0.0010091315   28279.272      0              2.7310097e+09  1.1965779e-13  0              3.7338451    
    400000   6363.961       200            200            0.0001630959   1.9598019e-14  0              0.0004892877   3933.3712      0              3.7985684e+08  1.1965779e-13  0              3.7303452    
    500000   6363.961       200            200            0.0092326124  -0.0030684401   0              0.030766277    38.560339      0              3723881.5      1.1965779e-13  0              3.7236706    
    600000   6363.961       200            200            0.0057161008  -0.002294682    0              0.019442985    35.236925      0              3402930        1.1965779e-13  0              3.7249745    
    700000   6363.961       200            200            0.0039354769  -0.0021389174   0              0.013945348    16.731746      0              1615832.3      1.1965779e-13  0              3.7257519    
    800000   6363.961       200            200            0.0039435344  -0.0021562639   0              0.013986867    0.2821214      0              27245.266      1.1965779e-13  0              3.7257507    
    900000   6363.961       200            200            0.0041853263  -0.0021897016   0              0.014745681    0.30374692     0              29333.704      1.1965779e-13  0              3.7256358    
   1000000   6363.961       200            200            0.0041826475  -0.0021901629   0              0.014738105    0.0072541099   0              700.55001      1.1965779e-13  0              3.7256363    
   1100000   6363.961       200            200            0.0041491542  -0.0021876783   0              0.014635141    0.0051770737   0              499.96472      1.1965779e-13  0              3.7256517    
   1200000   6363.961       200            200            0.0041504014  -0.0021877559   0              0.01463896     0.00017913344  0              17.299426      1.1965779e-13  0              3.7256512    
   1300000   6363.961       200            200            0.0041548777  -0.0021880918   0              0.014652725    8.7269134e-05  0              8.4278283      1.1965779e-13  0              3.7256492    
   1400000   6363.961       200            200            0.0041545906  -0.0021880724   0              0.014651844    4.2160257e-06  0              0.40715359     1.1965779e-13  0              3.7256493    
   1500000   6363.961       200            200            0.0041539949  -0.0021880277   0              0.014650012    1.4500907e-06  0              0.14003938     1.1965779e-13  0              3.7256496    
   1600000   6363.961       200            200            0.0041540495  -0.0021880315   0              0.01465018     9.5391863e-08  0              0.0092122634   1.1965779e-13  0              3.7256495    
   1700000   6363.961       200            200            0.0041541283  -0.0021880374   0              0.014650422    2.3732263e-08  0              0.0022918921   1.1965779e-13  0              3.7256495    
   1800000   6363.961       200            200            0.0041541189  -0.0021880368   0              0.014650393    2.0917632e-09  0              0.00020200752  1.1965779e-13  0              3.7256495    
   1900000   6363.961       200            200            0.0041541085  -0.002188036    0              0.014650361    3.8189477e-10  0              3.6880663e-05  1.1965779e-13  0              3.7256495    
   2000000   6363.961       200            200            0.00415411    -0.0021880361   0              0.014650366    4.4696845e-11  0              4.3165013e-06  1.1965779e-13  0              3.7256495    
   2100000   6363.961       200            200            0.0041541114  -0.0021880362   0              0.01465037     6.0275471e-12  0              5.8209736e-07  1.1965779e-13  0              3.7256495    
   2200000   6363.961       200            200            0.0041541111  -0.0021880362   0              0.01465037     9.3424218e-13  0              9.0222422e-08  1.1965779e-13  0              3.7256495    
   2300000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    9.3047341e-14  0              8.9858462e-09  1.1965779e-13  0              3.7256495    
   2400000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    1.9443238e-14  0              1.8776887e-09  1.1965779e-13  0              3.7256495    
   2500000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    1.2999819e-15  0              1.2554295e-10  1.1965779e-13  0              3.7256495    
   2600000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    3.7820819e-16  0              3.652464e-11   1.1965779e-13  0              3.7256495    
   2700000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    1.810606e-19   0              1.7485537e-14  1.1965779e-13  0              3.7256495    
   2800000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    3.1440121e-19  0              3.0362618e-14  1.1965779e-13  0              3.7256495    
   2900000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    1.2512848e-18  0              1.2084013e-13  1.1965779e-13  0              3.7256495    
   3000000   6363.961       200            200            0.004154111   -0.0021880362   0              0.014650369    2.5627638e-19  0              2.4749339e-14  1.1965779e-13  0              3.7256495    
Loop time of 362.7 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7146408.690 ns/day, 0.000 hours/ns, 8271.306 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.192     | 115.83     | 143.67     | 255.0 | 31.93
Neigh   | 0.92451    | 0.93927    | 0.95395    |   1.1 |  0.26
Comm    | 22.802     | 49.671     | 77.762     | 379.2 | 13.69
Output  | 0.24229    | 0.24261    | 0.24296    |   0.1 |  0.07
Modify  | 105.17     | 140.82     | 174.89     | 286.9 | 38.83
Other   |            | 55.2       |            |       | 15.22

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         717.25 ave        1061 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2869
Ave neighs/atom = 1.1471411
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.47                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 102.883059940812
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.57
  ghost atom cutoff = 4.57
  binsize = 2.285, bins = 2786 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.91 | 35.92 | 35.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            6.9964702e-15  2.0989411e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066094646  2.0989411e-14  0             -0.0019828394   262750.72      0              2.5374584e+10  1.1965779e-13  0              4.0269443    
    200000   6363.961       200            200            0.00034617501  2.0989411e-14  0              0.001038525    14749.338      0              1.4243855e+09  1.1965779e-13  0              3.8762764    
    300000   6363.961       200            200           -0.00032667197  2.0989411e-14  0             -0.00098001591  26094.944      0              2.5200629e+09  1.1965779e-13  0              3.7408556    
    400000   6363.961       200            200            0.00025215858 -2.3962785e-06  0              0.00075887201  4774.7325      0              4.6110949e+08  1.1965779e-13  0              3.7344754    
    500000   6363.961       200            200            0.0087670164  -0.0030258893   0              0.029326939    195.74144      0              18903307       1.1965779e-13  0              3.7288227    
    600000   6363.961       200            200            0.0054058204  -0.0023125585   0              0.01853002     71.199921      0              6875978.7      1.1965779e-13  0              3.7300983    
    700000   6363.961       200            200            0.0037863625  -0.0021409795   0              0.013500067    12.127618      0              1171198.6      1.1965779e-13  0              3.7308265    
    800000   6363.961       200            200            0.0039864479  -0.0021527976   0              0.014112141    0.94640174     0              91396.706      1.1965779e-13  0              3.7307373    
    900000   6363.961       200            200            0.0042185982  -0.0021863796   0              0.014842174    0.19910033     0              19227.685      1.1965779e-13  0              3.7306267    
   1000000   6363.961       200            200            0.0041844897  -0.0021841557   0              0.014737625    0.023086581    0              2229.5367      1.1965779e-13  0              3.7306416    
   1100000   6363.961       200            200            0.0041539149  -0.0021818703   0              0.014643615    0.0027866257   0              269.11237      1.1965779e-13  0              3.7306558    
   1200000   6363.961       200            200            0.0041599628  -0.0021823088   0              0.014662197    0.00052857359  0              51.045854      1.1965779e-13  0              3.7306531    
   1300000   6363.961       200            200            0.0041637934  -0.0021825976   0              0.014673978    3.6174272e-05  0              3.4934523      1.1965779e-13  0              3.7306513    
   1400000   6363.961       200            200            0.0041627945  -0.0021825249   0              0.014670908    1.1472541e-05  0              1.1079359      1.1965779e-13  0              3.7306518    
   1500000   6363.961       200            200            0.0041623261  -0.0021824895   0              0.014669468    4.2012967e-07  0              0.040573116    1.1965779e-13  0              3.730652     
   1600000   6363.961       200            200            0.0041624832  -0.002182501    0              0.014669951    2.3771454e-07  0              0.022956769    1.1965779e-13  0              3.7306519    
   1700000   6363.961       200            200            0.0041625388  -0.0021825052   0              0.014670122    4.0938855e-09  0              0.00039535816  1.1965779e-13  0              3.7306519    
   1800000   6363.961       200            200            0.004162515   -0.0021825035   0              0.014670048    4.7302662e-09  0              0.00045681525  1.1965779e-13  0              3.7306519    
   1900000   6363.961       200            200            0.0041625086  -0.002182503    0              0.014670029    2.8371487e-11  0              2.7399152e-06  1.1965779e-13  0              3.7306519    
   2000000   6363.961       200            200            0.0041625121  -0.0021825033   0              0.01467004     9.0713778e-11  0              8.7604874e-06  1.1965779e-13  0              3.7306519    
   2100000   6363.961       200            200            0.0041625128  -0.0021825033   0              0.014670042    6.818888e-14   0              6.585194e-09   1.1965779e-13  0              3.7306519    
   2200000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     1.6803224e-12  0              1.6227351e-07  1.1965779e-13  0              3.7306519    
   2300000   6363.961       200            200            0.0041625122  -0.0021825033   0              0.01467004     7.1885619e-16  0              6.9421986e-11  1.1965779e-13  0              3.7306519    
   2400000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     3.005646e-14   0              2.9026378e-09  1.1965779e-13  0              3.7306519    
   2500000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     1.4396465e-16  0              1.3903076e-11  1.1965779e-13  0              3.7306519    
   2600000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     5.3002616e-16  0              5.1186132e-11  1.1965779e-13  0              3.7306519    
   2700000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     4.4555068e-17  0              4.3028095e-12  1.1965779e-13  0              3.7306519    
   2800000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     2.503832e-18   0              2.4180217e-13  1.1965779e-13  0              3.7306519    
   2900000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     4.8384181e-18  0              4.6725979e-13  1.1965779e-13  0              3.7306519    
   3000000   6363.961       200            200            0.0041625123  -0.0021825033   0              0.01467004     7.6172335e-21  0              7.3561789e-16  1.1965779e-13  0              3.7306519    
Loop time of 365.869 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7084505.840 ns/day, 0.000 hours/ns, 8199.660 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.248     | 116.27     | 143.71     | 252.6 | 31.78
Neigh   | 0.92962    | 0.94376    | 0.95777    |   1.1 |  0.26
Comm    | 22.23      | 48.975     | 77.179     | 379.6 | 13.39
Output  | 0.24533    | 0.24565    | 0.246      |   0.1 |  0.07
Modify  | 108.2      | 144.07     | 178.75     | 285.9 | 39.38
Other   |            | 55.36      |            |       | 15.13

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         720.75 ave        1067 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2883
Ave neighs/atom = 1.1527389
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.48                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 103.57509614901
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.58
  ghost atom cutoff = 4.58
  binsize = 2.29, bins = 2780 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.86 | 35.87 | 35.88 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            7.4714437e-15  2.2414331e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066394132  2.2414331e-14  0             -0.0019918239   257780.23      0              2.489457e+10   1.1965779e-13  0              4.0353754    
    200000   6363.961       200            200            0.00036209746  2.2414331e-14  0              0.0010862924   15966.011      0              1.541883e+09   1.1965779e-13  0              3.8798923    
    300000   6363.961       200            200           -0.00031668187  2.2414331e-14  0             -0.00095004561  24000.963      0              2.3178412e+09  1.1965779e-13  0              3.7477886    
    400000   6363.961       200            200            0.00072899867 -0.000111652    0              0.002298648    5642.751       0              5.4493651e+08  1.1965779e-13  0              3.7385211    
    500000   6363.961       200            200            0.0080307025  -0.0028359554   0              0.026928063    432.27156      0              41745694       1.1965779e-13  0              3.7340829    
    600000   6363.961       200            200            0.0050291649  -0.0022814249   0              0.01736892     106.69182      0              10303532       1.1965779e-13  0              3.7352594    
    700000   6363.961       200            200            0.0036707385  -0.0021401988   0              0.013152414    6.7789851      0              654665.85      1.1965779e-13  0              3.7358871    
    800000   6363.961       200            200            0.0040474588  -0.0021501981   0              0.014292575    1.7385825      0              167899.85      1.1965779e-13  0              3.7357155    
    900000   6363.961       200            200            0.0042454657  -0.0021819737   0              0.014918371    0.083319955    0              8046.4449      1.1965779e-13  0              3.7356206    
   1000000   6363.961       200            200            0.0041834473  -0.0021774366   0              0.014727779    0.038978623    0              3764.2764      1.1965779e-13  0              3.7356484    
   1100000   6363.961       200            200            0.0041602192  -0.0021756769   0              0.014656335    0.00063707611  0              61.524251      1.1965779e-13  0              3.7356593    
   1200000   6363.961       200            200            0.0041701551  -0.0021764098   0              0.014686875    0.00080310764  0              77.558387      1.1965779e-13  0              3.7356548    
   1300000   6363.961       200            200            0.0041726032  -0.002176597    0              0.014694407    2.0911439e-06  0              0.20194771     1.1965779e-13  0              3.7356536    
   1400000   6363.961       200            200            0.0041710944  -0.0021764857   0              0.014689769    1.5360925e-05  0              1.4834482      1.1965779e-13  0              3.7356543    
   1500000   6363.961       200            200            0.0041708687  -0.0021764682   0              0.014689074    5.7423987e-09  0              0.00055455977  1.1965779e-13  0              3.7356544    
   1600000   6363.961       200            200            0.0041710876  -0.0021764844   0              0.014689747    2.735081e-07   0              0.026413454    1.1965779e-13  0              3.7356543    
   1700000   6363.961       200            200            0.0041711029  -0.0021764857   0              0.014689794    2.1463527e-09  0              0.00020727939  1.1965779e-13  0              3.7356543    
   1800000   6363.961       200            200            0.0041710724  -0.0021764834   0              0.0146897      4.5270748e-09  0              0.00043719248  1.1965779e-13  0              3.7356543    
   1900000   6363.961       200            200            0.0041710724  -0.0021764834   0              0.014689701    1.1859797e-10  0              1.1453343e-05  1.1965779e-13  0              3.7356543    
   2000000   6363.961       200            200            0.0041710765  -0.0021764837   0              0.014689713    6.9153968e-11  0              6.6783953e-06  1.1965779e-13  0              3.7356543    
   2100000   6363.961       200            200            0.0041710762  -0.0021764837   0              0.014689712    4.1694374e-12  0              4.0265442e-07  1.1965779e-13  0              3.7356543    
   2200000   6363.961       200            200            0.0041710757  -0.0021764836   0              0.014689711    9.5936439e-13  0              9.2648546e-08  1.1965779e-13  0              3.7356543    
   2300000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    1.1763773e-13  0              1.136061e-08   1.1965779e-13  0              3.7356543    
   2400000   6363.961       200            200            0.0041710759  -0.0021764836   0              0.014689711    1.1749534e-14  0              1.1346859e-09  1.1965779e-13  0              3.7356543    
   2500000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    2.8515097e-15  0              2.7537839e-10  1.1965779e-13  0              3.7356543    
   2600000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    1.3779546e-16  0              1.3307299e-11  1.1965779e-13  0              3.7356543    
   2700000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    7.1388598e-17  0              6.8941998e-12  1.1965779e-13  0              3.7356543    
   2800000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    1.1065181e-17  0              1.068596e-12   1.1965779e-13  0              3.7356543    
   2900000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    7.4637478e-18  0              7.2079534e-13  1.1965779e-13  0              3.7356543    
   3000000   6363.961       200            200            0.0041710758  -0.0021764836   0              0.014689711    3.7536483e-19  0              3.6250049e-14  1.1965779e-13  0              3.7356543    
Loop time of 365.483 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7091991.263 ns/day, 0.000 hours/ns, 8208.323 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.198     | 115.94     | 143.59     | 255.1 | 31.72
Neigh   | 0.91562    | 0.92988    | 0.94404    |   1.1 |  0.25
Comm    | 22.102     | 49.135     | 77.092     | 382.0 | 13.44
Output  | 0.24493    | 0.24523    | 0.24556    |   0.1 |  0.07
Modify  | 108.68     | 144.19     | 178.36     | 284.0 | 39.45
Other   |            | 55.04      |            |       | 15.06

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         723.75 ave        1073 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2895
Ave neighs/atom = 1.157537
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.49                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 104.270228710928
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.59
  ghost atom cutoff = 4.59
  binsize = 2.295, bins = 2773 88 88
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.83 | 35.84 | 35.84 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            7.9574089e-15  2.3872227e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066674719  2.3872227e-14  0             -0.0020002416   252860.04      0              2.4419413e+10  1.1965779e-13  0              4.0437729    
    200000   6363.961       200            200            0.00037814986  2.3872227e-14  0              0.0011344496   17229.683      0              1.6639195e+09  1.1965779e-13  0              3.8834543    
    300000   6363.961       200            200           -0.00030640871  2.3872227e-14  0             -0.00091922612  21996.981      0              2.124311e+09   1.1965779e-13  0              3.7546439    
    400000   6363.961       200            200            0.0017418017  -0.00035071687  0              0.005576122    6412.3672      0              6.1926053e+08  1.1965779e-13  0              3.7424914    
    500000   6363.961       200            200            0.0070326638  -0.0027470188   0              0.02384501     686.03938      0              66252773       1.1965779e-13  0              3.7394341    
    600000   6363.961       200            200            0.0046051413  -0.0022483917   0              0.016063816    132.16783      0              12763823       1.1965779e-13  0              3.7404467    
    700000   6363.961       200            200            0.0035866049  -0.0021668332   0              0.012926648    2.3267314      0              224699.06      1.1965779e-13  0              3.7409291    
    800000   6363.961       200            200            0.0041220154  -0.0021471716   0              0.014513218    2.3530804      0              227243.67      1.1965779e-13  0              3.7406878    
    900000   6363.961       200            200            0.0042640808  -0.0021751681   0              0.01496741     0.0094539357   0              912.99344      1.1965779e-13  0              3.7406185    
   1000000   6363.961       200            200            0.0041812463  -0.0021689451   0              0.014712684    0.04640721     0              4481.6762      1.1965779e-13  0              3.740656     
   1100000   6363.961       200            200            0.0041688084  -0.0021679798   0              0.014674405    3.9038277e-05  0              3.7700374      1.1965779e-13  0              3.7406619    
   1200000   6363.961       200            200            0.0041810616  -0.0021688863   0              0.014712071    0.00081054016  0              78.276167      1.1965779e-13  0              3.7406563    
   1300000   6363.961       200            200            0.0041816402  -0.002168935    0              0.014713856    1.1594653e-05  0              1.1197286      1.1965779e-13  0              3.740656     
   1400000   6363.961       200            200            0.0041799359  -0.0021688089   0              0.014708617    1.2463072e-05  0              1.2035943      1.1965779e-13  0              3.7406568    
   1500000   6363.961       200            200            0.0041800114  -0.0021688137   0              0.014708848    6.032535e-07   0              0.058257905    1.1965779e-13  0              3.7406568    
   1600000   6363.961       200            200            0.0041802343  -0.0021688303   0              0.014709533    1.6473173e-07  0              0.015908612    1.1965779e-13  0              3.7406567    
   1700000   6363.961       200            200            0.0041802041  -0.0021688281   0              0.01470944     1.9941478e-08  0              0.0019258052   1.1965779e-13  0              3.7406567    
   1800000   6363.961       200            200            0.0041801768  -0.0021688261   0              0.014709356    1.7629843e-09  0              0.00017025641  1.1965779e-13  0              3.7406567    
   1900000   6363.961       200            200            0.0041801833  -0.0021688266   0              0.014709376    5.2033422e-10  0              5.0250154e-05  1.1965779e-13  0              3.7406567    
   2000000   6363.961       200            200            0.0041801864  -0.0021688268   0              0.014709386    1.3001804e-11  0              1.2556212e-06  1.1965779e-13  0              3.7406567    
   2100000   6363.961       200            200            0.0041801852  -0.0021688267   0              0.014709382    1.155066e-11   0              1.1154801e-06  1.1965779e-13  0              3.7406567    
   2200000   6363.961       200            200            0.0041801849  -0.0021688267   0              0.014709381    3.2282473e-14  0              3.1176102e-09  1.1965779e-13  0              3.7406567    
   2300000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    2.2504943e-13  0              2.1733664e-08  1.1965779e-13  0              3.7406567    
   2400000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    2.9832637e-16  0              2.8810225e-11  1.1965779e-13  0              3.7406567    
   2500000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    3.8963792e-15  0              3.7628441e-10  1.1965779e-13  0              3.7406567    
   2600000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    4.7657122e-17  0              4.6023838e-12  1.1965779e-13  0              3.7406567    
   2700000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    1.5331372e-17  0              1.4805942e-12  1.1965779e-13  0              3.7406567    
   2800000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    3.4288983e-18  0              3.3113846e-13  1.1965779e-13  0              3.7406567    
   2900000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    6.4444265e-19  0              6.2235659e-14  1.1965779e-13  0              3.7406567    
   3000000   6363.961       200            200            0.0041801851  -0.0021688267   0              0.014709382    7.5263112e-18  0              7.2683727e-13  1.1965779e-13  0              3.7406567    
Loop time of 363.021 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7140080.449 ns/day, 0.000 hours/ns, 8263.982 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.527     | 116.22     | 143.94     | 256.5 | 32.02
Neigh   | 0.93802    | 0.95322    | 0.96864    |   1.1 |  0.26
Comm    | 22.355     | 49.801     | 77.593     | 382.9 | 13.72
Output  | 0.24082    | 0.24113    | 0.24146    |   0.1 |  0.07
Modify  | 105.69     | 140.73     | 174.84     | 285.8 | 38.77
Other   |            | 55.07      |            |       | 15.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         726.25 ave        1079 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2905
Ave neighs/atom = 1.1615354
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.5                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 104.968464538069
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.6
  ghost atom cutoff = 4.6
  binsize = 2.3, bins = 2767 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.27 | 35.28 | 35.28 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            8.4541937e-15  2.5362581e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066936463  2.5362581e-14  0             -0.0020080939   247990.07      0              2.3949106e+10  1.1965779e-13  0              4.0521368    
    200000   6363.961       200            200            0.0003943312   2.5362581e-14  0              0.0011829936   18540.211      0              1.7904809e+09  1.1965779e-13  0              3.8869624    
    300000   6363.961       200            200           -0.00029585454  2.5362581e-14  0             -0.00088756363  20082.692      0              1.9394426e+09  1.1965779e-13  0              3.7614213    
    400000   6363.961       200            200            0.0032744137  -0.00097324392  0              0.010796485    6911.3632      0              6.6744999e+08  1.1965779e-13  0              3.7464056    
    500000   6363.961       200            200            0.0058309358  -0.0029175469   0              0.020410354    895.93555      0              86523042       1.1965779e-13  0              3.7448536    
    600000   6363.961       200            200            0.0041447208  -0.0022868142   0              0.014720977    141.32103      0              13647774       1.1965779e-13  0              3.7456474    
    700000   6363.961       200            200            0.0035615153  -0.0021544345   0              0.012838981    0.1103197      0              10653.887      1.1965779e-13  0              3.7459493    
    800000   6363.961       200            200            0.0042028236  -0.0021463556   0              0.014754826    2.5507158      0              246329.87      1.1965779e-13  0              3.745657     
    900000   6363.961       200            200            0.0042721902  -0.0021691228   0              0.014985693    0.011071597    0              1069.2156      1.1965779e-13  0              3.7456209    
   1000000   6363.961       200            200            0.0041783649  -0.002162076    0              0.014697171    0.041433342    0              4001.3356      1.1965779e-13  0              3.7456636    
   1100000   6363.961       200            200            0.0041786739  -0.0021620542   0              0.014698076    0.0013415337   0              129.55572      1.1965779e-13  0              3.7456637    
   1200000   6363.961       200            200            0.0041912612  -0.0021629876   0              0.014736771    0.00054685366  0              52.811213      1.1965779e-13  0              3.745658     
   1300000   6363.961       200            200            0.0041898285  -0.0021628878   0              0.014732373    5.6686573e-05  0              5.4743835      1.1965779e-13  0              3.7456586    
   1400000   6363.961       200            200            0.0041882904  -0.0021627734   0              0.014727645    5.3686767e-06  0              0.51846837     1.1965779e-13  0              3.7456593    
   1500000   6363.961       200            200            0.0041886539  -0.0021627996   0              0.014728761    1.6165402e-06  0              0.15611388     1.1965779e-13  0              3.7456591    
   1600000   6363.961       200            200            0.004188821   -0.0021628121   0              0.014729275    2.9372164e-08  0              0.0028365534   1.1965779e-13  0              3.7456591    
   1700000   6363.961       200            200            0.0041887535  -0.0021628072   0              0.014729068    3.6231365e-08  0              0.0034989659   1.1965779e-13  0              3.7456591    
   1800000   6363.961       200            200            0.0041887384  -0.0021628061   0              0.014729021    4.0200737e-12  0              3.8822994e-07  1.1965779e-13  0              3.7456591    
   1900000   6363.961       200            200            0.0041887492  -0.0021628068   0              0.014729054    6.6954883e-10  0              6.4660234e-05  1.1965779e-13  0              3.7456591    
   2000000   6363.961       200            200            0.00418875    -0.0021628069   0              0.014729057    6.7457415e-12  0              6.5145543e-07  1.1965779e-13  0              3.7456591    
   2100000   6363.961       200            200            0.0041887485  -0.0021628068   0              0.014729052    1.0238182e-11  0              9.8873037e-07  1.1965779e-13  0              3.7456591    
   2200000   6363.961       200            200            0.0041887485  -0.0021628068   0              0.014729052    4.961691e-13   0              4.7916461e-08  1.1965779e-13  0              3.7456591    
   2300000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    1.2507883e-13  0              1.2079218e-08  1.1965779e-13  0              3.7456591    
   2400000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    1.7708884e-14  0              1.7101972e-09  1.1965779e-13  0              3.7456591    
   2500000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    1.043594e-15   0              1.0078283e-10  1.1965779e-13  0              3.7456591    
   2600000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    4.4765284e-16  0              4.3231107e-11  1.1965779e-13  0              3.7456591    
   2700000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    1.042543e-17   0              1.0068134e-12  1.1965779e-13  0              3.7456591    
   2800000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    3.6737616e-19  0              3.547856e-14   1.1965779e-13  0              3.7456591    
   2900000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    7.6919601e-21  0              7.4283445e-16  1.1965779e-13  0              3.7456591    
   3000000   6363.961       200            200            0.0041887487  -0.0021628068   0              0.014729053    7.1048555e-18  0              6.8613609e-13  1.1965779e-13  0              3.7456591    
Loop time of 366.793 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7066664.898 ns/day, 0.000 hours/ns, 8179.010 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.2       | 117.02     | 146.33     | 257.3 | 31.90
Neigh   | 0.90907    | 0.92306    | 0.93646    |   1.1 |  0.25
Comm    | 23.382     | 50.612     | 80.411     | 374.8 | 13.80
Output  | 0.24445    | 0.24476    | 0.24509    |   0.1 |  0.07
Modify  | 106.47     | 142.83     | 176.99     | 280.8 | 38.94
Other   |            | 55.16      |            |       | 15.04

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         728.75 ave        1084 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2915
Ave neighs/atom = 1.1655338
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.51                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 105.669810541937
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.61
  ghost atom cutoff = 4.61
  binsize = 2.305, bins = 2761 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.24 | 35.24 | 35.25 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            8.9616371e-15  2.6884911e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067179421  2.6884911e-14  0             -0.0020153826   243170.22      0              2.3483639e+10  1.1965779e-13  0              4.0604671    
    200000   6363.961       200            200            0.00041064062  2.6884911e-14  0              0.0012319219   19897.465      0              1.9215547e+09  1.1965779e-13  0              3.8904164    
    300000   6363.961       200            200           -0.00028502125  2.6884911e-14  0             -0.00085506376  18257.753      0              1.7632031e+09  1.1965779e-13  0              3.7681207    
    400000   6363.961       200            200            0.0054275425  -0.0017016469   0              0.017984274    6953.8021      0              6.7154844e+08  1.1965779e-13  0              3.7502946    
    500000   6363.961       200            200            0.0047086532  -0.0028020938   0              0.016928053    1018.254       0              98335681       1.1965779e-13  0              3.7503163    
    600000   6363.961       200            200            0.0037233357  -0.0022620166   0              0.013432024    132.44576      0              12790663       1.1965779e-13  0              3.7508484    
    700000   6363.961       200            200            0.0035820123  -0.0021504631   0              0.0128965      0.78154575     0              75476.094      1.1965779e-13  0              3.7509466    
    800000   6363.961       200            200            0.0042830881  -0.0021462296   0              0.014995494    2.2521964      0              217501         1.1965779e-13  0              3.7506265    
    900000   6363.961       200            200            0.0042704797  -0.0021619156   0              0.014973355    0.086768601    0              8379.4904      1.1965779e-13  0              3.7506279    
   1000000   6363.961       200            200            0.0041770652  -0.0021549097   0              0.014686105    0.026759214    0              2584.2134      1.1965779e-13  0              3.7506706    
   1100000   6363.961       200            200            0.0041902866  -0.0021558433   0              0.014726703    0.0037268978   0              359.91711      1.1965779e-13  0              3.7506648    
   1200000   6363.961       200            200            0.0042011364  -0.0021566451   0              0.014760054    0.00019710711  0              19.035194      1.1965779e-13  0              3.7506598    
   1300000   6363.961       200            200            0.0041979288  -0.0021564157   0              0.014750202    0.00010149201  0              9.801372       1.1965779e-13  0              3.7506612    
   1400000   6363.961       200            200            0.0041968882  -0.002156338    0              0.014747003    3.2251381e-07  0              0.031146075    1.1965779e-13  0              3.7506617    
   1500000   6363.961       200            200            0.0041974572  -0.0021563792   0              0.014748751    2.051625e-06   0              0.19813126     1.1965779e-13  0              3.7506615    
   1600000   6363.961       200            200            0.0041975226  -0.0021563842   0              0.014748952    1.2478352e-08  0              0.0012050699   1.1965779e-13  0              3.7506614    
   1700000   6363.961       200            200            0.0041974374  -0.002156378    0              0.01474869     3.1811986e-08  0              0.0030721739   1.1965779e-13  0              3.7506615    
   1800000   6363.961       200            200            0.0041974397  -0.0021563782   0              0.014748697    1.4818749e-09  0              0.00014310887  1.1965779e-13  0              3.7506615    
   1900000   6363.961       200            200            0.0041974509  -0.002156379    0              0.014748732    3.60192e-10    0              3.4784765e-05  1.1965779e-13  0              3.7506615    
   2000000   6363.961       200            200            0.0041974491  -0.0021563789   0              0.014748726    5.9014289e-11  0              5.6991776e-06  1.1965779e-13  0              3.7506615    
   2100000   6363.961       200            200            0.0041974479  -0.0021563788   0              0.014748722    2.3957699e-12  0              2.313663e-07   1.1965779e-13  0              3.7506615    
   2200000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    1.5349847e-12  0              1.4823783e-07  1.1965779e-13  0              3.7506615    
   2300000   6363.961       200            200            0.0041974484  -0.0021563788   0              0.014748724    2.0895396e-15  0              2.0179278e-10  1.1965779e-13  0              3.7506615    
   2400000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    2.9860502e-14  0              2.8837135e-09  1.1965779e-13  0              3.7506615    
   2500000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    3.3752809e-16  0              3.2596047e-11  1.1965779e-13  0              3.7506615    
   2600000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    4.636454e-16   0              4.4775554e-11  1.1965779e-13  0              3.7506615    
   2700000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    6.5564774e-17  0              6.3317765e-12  1.1965779e-13  0              3.7506615    
   2800000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    7.6771758e-18  0              7.4140669e-13  1.1965779e-13  0              3.7506615    
   2900000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    3.0086588e-18  0              2.9055473e-13  1.1965779e-13  0              3.7506615    
   3000000   6363.961       200            200            0.0041974483  -0.0021563788   0              0.014748724    1.3512156e-20  0              1.3049073e-15  1.1965779e-13  0              3.7506615    
Loop time of 363.986 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7121161.208 ns/day, 0.000 hours/ns, 8242.085 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.209     | 116.38     | 144.53     | 257.3 | 31.97
Neigh   | 0.92412    | 0.93877    | 0.95284    |   1.1 |  0.26
Comm    | 22.891     | 50.028     | 78.467     | 382.4 | 13.74
Output  | 0.24167    | 0.24198    | 0.24231    |   0.1 |  0.07
Modify  | 105.83     | 141.32     | 175.39     | 285.1 | 38.83
Other   |            | 55.07      |            |       | 15.13

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         731.25 ave        1089 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2925
Ave neighs/atom = 1.1695322
Neighbor list builds = 139
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.52                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 106.374273634036
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.62
  ghost atom cutoff = 4.62
  binsize = 2.31, bins = 2755 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.17 | 35.18 | 35.19 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            9.4795878e-15  2.8438763e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067403649  2.8438763e-14  0             -0.0020221095   238400.42      0              2.3023007e+10  1.1965779e-13  0              4.0687636    
    200000   6363.961       200            200            0.00042707718  2.8438763e-14  0              0.0012812315   21301.305      0              2.0571275e+09  1.1965779e-13  0              3.8938161    
    300000   6363.961       200            200           -0.00027391078  2.8438763e-14  0             -0.00082173233  16521.839      0              1.595561e+09   1.1965779e-13  0              3.7747418    
    400000   6363.961       200            200            0.0081534374  -0.0024419757   0              0.026902288    6398.3147      0              6.1790343e+08  1.1965779e-13  0              3.7542018    
    500000   6363.961       200            200            0.0037257447  -0.0024815149   0              0.013658749    1034.9487      0              99947938       1.1965779e-13  0              3.7557961    
    600000   6363.961       200            200            0.0033765704  -0.0021481412   0              0.012277853    108.44134      0              10472489       1.1965779e-13  0              3.7560372    
    700000   6363.961       200            200            0.0036485593  -0.0021515612   0              0.013097239    4.1194732      0              397829.23      1.1965779e-13  0              3.7559212    
    800000   6363.961       200            200            0.0043536139  -0.0021519076   0              0.015212749    1.5716801      0              151781.61      1.1965779e-13  0              3.7555997    
    900000   6363.961       200            200            0.0042598156  -0.0021548105   0              0.014934257    0.20095429     0              19406.727      1.1965779e-13  0              3.7556388    
   1000000   6363.961       200            200            0.0041783643  -0.0021486307   0              0.014683724    0.010230847    0              988.02201      1.1965779e-13  0              3.7556763    
   1100000   6363.961       200            200            0.0042028224  -0.0021503861   0              0.014758853    0.0057206562   0              552.46003      1.1965779e-13  0              3.7556653    
   1200000   6363.961       200            200            0.0042101115  -0.002150926    0              0.014781261    4.6753686e-06  0              0.45151364     1.1965779e-13  0              3.7556619    
   1300000   6363.961       200            200            0.0042057051  -0.0021506104   0              0.014767726    0.00011072404  0              10.692935      1.1965779e-13  0              3.7556639    
   1400000   6363.961       200            200            0.0042053922  -0.0021505856   0              0.014766762    1.7064651e-06  0              0.16479819     1.1965779e-13  0              3.7556641    
   1500000   6363.961       200            200            0.0042060335  -0.002150632    0              0.014768732    1.4879145e-06  0              0.14369213     1.1965779e-13  0              3.7556638    
   1600000   6363.961       200            200            0.0042059783  -0.0021506283   0              0.014768563    1.3051277e-07  0              0.01260399     1.1965779e-13  0              3.7556638    
   1700000   6363.961       200            200            0.0042059003  -0.0021506226   0              0.014768323    1.199915e-08   0              0.0011587921   1.1965779e-13  0              3.7556638    
   1800000   6363.961       200            200            0.0042059196  -0.0021506239   0              0.014768383    4.2666943e-09  0              0.00041204679  1.1965779e-13  0              3.7556638    
   1900000   6363.961       200            200            0.0042059271  -0.0021506245   0              0.014768406    2.3476571e-11  0              2.2671992e-06  1.1965779e-13  0              3.7556638    
   2000000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768394    9.098929e-11   0              8.7870944e-06  1.1965779e-13  0              3.7556638    
   2100000   6363.961       200            200            0.0042059229  -0.0021506242   0              0.014768393    6.3245538e-13  0              6.1078013e-08  1.1965779e-13  0              3.7556638    
   2200000   6363.961       200            200            0.0042059235  -0.0021506242   0              0.014768395    1.3557806e-12  0              1.3093159e-07  1.1965779e-13  0              3.7556638    
   2300000   6363.961       200            200            0.0042059235  -0.0021506242   0              0.014768395    8.0582137e-14  0              7.782046e-09   1.1965779e-13  0              3.7556638    
   2400000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768394    1.2887437e-14  0              1.2445765e-09  1.1965779e-13  0              3.7556638    
   2500000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    3.1281951e-15  0              3.0209869e-10  1.1965779e-13  0              3.7556638    
   2600000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    6.2130508e-17  0              6.0001198e-12  1.1965779e-13  0              3.7556638    
   2700000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    5.7004997e-17  0              5.5051346e-12  1.1965779e-13  0              3.7556638    
   2800000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    7.84892e-18    0              7.5799251e-13  1.1965779e-13  0              3.7556638    
   2900000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    3.0068394e-18  0              2.9037902e-13  1.1965779e-13  0              3.7556638    
   3000000   6363.961       200            200            0.0042059234  -0.0021506242   0              0.014768395    3.6657965e-18  0              3.5401639e-13  1.1965779e-13  0              3.7556638    
Loop time of 363.744 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7125887.461 ns/day, 0.000 hours/ns, 8247.555 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.08      | 116.29     | 144.49     | 260.3 | 31.97
Neigh   | 0.95286    | 0.96816    | 0.98322    |   1.2 |  0.27
Comm    | 22.473     | 50.257     | 78.601     | 387.3 | 13.82
Output  | 0.24497    | 0.24528    | 0.24562    |   0.1 |  0.07
Modify  | 105.56     | 140.78     | 174.99     | 286.5 | 38.70
Other   |            | 55.2       |            |       | 15.18

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         733.75 ave        1094 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2935
Ave neighs/atom = 1.1735306
Neighbor list builds = 143
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.53                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 107.081860725869
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.63
  ghost atom cutoff = 4.63
  binsize = 2.315, bins = 2750 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.12 | 35.13 | 35.14 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.0007904e-14  3.0023711e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067609203  3.0023711e-14  0             -0.0020282761   233680.58      0              2.2567198e+10  1.1965779e-13  0              4.0770264    
    200000   6363.961       200            200            0.00044364     3.0023711e-14  0              0.00133092     22751.598      0              2.1971865e+09  1.1965779e-13  0              3.8971615    
    300000   6363.961       200            200           -0.00026252508  3.0023711e-14  0             -0.00078757524  14874.627      0              1.436485e+09   1.1965779e-13  0              3.7812845    
    400000   6363.961       200            200            0.011108253   -0.0035969396   0              0.036921697    5221.5387      0              5.0425884e+08  1.1965779e-13  0              3.7581808    
    500000   6363.961       200            200            0.0028525174  -0.002209948    0              0.0107675      952.56672      0              91992076       1.1965779e-13  0              3.7612688    
    600000   6363.961       200            200            0.0030685023  -0.0021112428   0              0.01131675     75.644686      0              7305222.3      1.1965779e-13  0              3.7612023    
    700000   6363.961       200            200            0.0037576819  -0.0021569618   0              0.013430007    9.0924385      0              878082.63      1.1965779e-13  0              3.7608753    
    800000   6363.961       200            200            0.0044080754  -0.0021617281   0              0.015385954    0.77471994     0              74816.907      1.1965779e-13  0              3.7605794    
    900000   6363.961       200            200            0.0042425747  -0.0021477736   0              0.014875498    0.3005173      0              29021.81       1.1965779e-13  0              3.7606527    
   1000000   6363.961       200            200            0.0041832915  -0.0021431814   0              0.014693056    0.00062238595  0              60.10558       1.1965779e-13  0              3.7606803    
   1100000   6363.961       200            200            0.0042156744  -0.0021455072   0              0.01479253     0.0060986266   0              588.9617       1.1965779e-13  0              3.7606656    
   1200000   6363.961       200            200            0.0042181379  -0.0021456992   0              0.014800113    0.00010131935  0              9.7846975      1.1965779e-13  0              3.7606644    
   1300000   6363.961       200            200            0.0042133445  -0.0021453561   0              0.01478539     7.7310615e-05  0              7.4661058      1.1965779e-13  0              3.7606666    
   1400000   6363.961       200            200            0.0042138376  -0.0021453893   0              0.014786902    8.2314363e-06  0              0.7949332      1.1965779e-13  0              3.7606664    
   1500000   6363.961       200            200            0.0042143987  -0.0021454299   0              0.014788626    4.7810406e-07  0              0.046171868    1.1965779e-13  0              3.7606661    
   1600000   6363.961       200            200            0.0042142357  -0.0021454184   0              0.014788126    2.5565272e-07  0              0.02468911     1.1965779e-13  0              3.7606662    
   1700000   6363.961       200            200            0.0042141881  -0.0021454149   0              0.014787979    3.8487288e-11  0              3.7168268e-06  1.1965779e-13  0              3.7606662    
   1800000   6363.961       200            200            0.0042142183  -0.0021454171   0              0.014788072    4.7900735e-09  0              0.00046259101  1.1965779e-13  0              3.7606662    
   1900000   6363.961       200            200            0.0042142195  -0.0021454172   0              0.014788076    1.2254038e-10  0              1.1834073e-05  1.1965779e-13  0              3.7606662    
   2000000   6363.961       200            200            0.0042142153  -0.0021454169   0              0.014788063    5.5109124e-11  0              5.3220447e-06  1.1965779e-13  0              3.7606662    
   2100000   6363.961       200            200            0.0042142158  -0.0021454169   0              0.014788064    7.6671943e-12  0              7.4044275e-07  1.1965779e-13  0              3.7606662    
   2200000   6363.961       200            200            0.0042142163  -0.002145417    0              0.014788066    2.750344e-13   0              2.6560854e-08  1.1965779e-13  0              3.7606662    
   2300000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    2.1452709e-13  0              2.0717491e-08  1.1965779e-13  0              3.7606662    
   2400000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    8.4958831e-17  0              8.2047158e-12  1.1965779e-13  0              3.7606662    
   2500000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    3.7368675e-15  0              3.6087992e-10  1.1965779e-13  0              3.7606662    
   2600000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    1.1972634e-16  0              1.1562313e-11  1.1965779e-13  0              3.7606662    
   2700000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    2.5057227e-18  0              2.4198476e-13  1.1965779e-13  0              3.7606662    
   2800000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    6.6942951e-19  0              6.464871e-14   1.1965779e-13  0              3.7606662    
   2900000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    7.6321608e-18  0              7.3705946e-13  1.1965779e-13  0              3.7606662    
   3000000   6363.961       200            200            0.0042142161  -0.0021454169   0              0.014788065    2.0351744e-19  0              1.9654258e-14  1.1965779e-13  0              3.7606662    
Loop time of 361.773 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7164709.381 ns/day, 0.000 hours/ns, 8292.488 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.324     | 115.46     | 142.62     | 250.2 | 31.91
Neigh   | 0.93912    | 0.95428    | 0.96891    |   1.1 |  0.26
Comm    | 22.744     | 49.172     | 76.533     | 373.0 | 13.59
Output  | 0.24479    | 0.24508    | 0.24541    |   0.1 |  0.07
Modify  | 105.4      | 140.79     | 174.8      | 285.8 | 38.92
Other   |            | 55.15      |            |       | 15.24

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         709.25 ave        1045 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2837
Ave neighs/atom = 1.1343463
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.54                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 107.792578728941
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.64
  ghost atom cutoff = 4.64
  binsize = 2.32, bins = 2744 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.08 | 35.08 | 35.09 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.0546451e-14  3.1639354e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067796138  3.1639354e-14  0             -0.0020338841   229010.61      0              2.2116205e+10  1.1965779e-13  0              4.0852552    
    200000   6363.961       200            200            0.00046032815  3.1639354e-14  0              0.0013809845   24248.211      0              2.3417186e+09  1.1965779e-13  0              3.9004524    
    300000   6363.961       200            200           -0.00025086609  3.1639354e-14  0             -0.00075259828  13315.79       0              1.2859437e+09  1.1965779e-13  0              3.7877485    
    400000   6363.961       200            200            0.014264423   -0.0041836947   0              0.046976964    3590.6694      0              3.4676115e+08  1.1965779e-13  0              3.7622924    
    500000   6363.961       200            200            0.0021537548  -0.0018980316   0              0.008359296    795.75822      0              76848633       1.1965779e-13  0              3.7667124    
    600000   6363.961       200            200            0.0028487165  -0.0020420524   0              0.010588202    42.035082      0              4059447.3      1.1965779e-13  0              3.7663341    
    700000   6363.961       200            200            0.0038970978  -0.0021835567   0              0.01387485     14.153408      0              1366834.8      1.1965779e-13  0              3.7658128    
    800000   6363.961       200            200            0.0044443199  -0.0021657259   0              0.015498686    0.17461407     0              16862.977      1.1965779e-13  0              3.7655679    
    900000   6363.961       200            200            0.0042220428  -0.002140373    0              0.014806501    0.33948447     0              32784.98       1.1965779e-13  0              3.7656681    
   1000000   6363.961       200            200            0.0041925309  -0.002137929    0              0.014715522    0.0029656016   0              286.39657      1.1965779e-13  0              3.7656823    
   1100000   6363.961       200            200            0.0042283349  -0.0021404899   0              0.014825495    0.0046341354   0              447.53163      1.1965779e-13  0              3.765666     
   1200000   6363.961       200            200            0.0042254867  -0.0021403043   0              0.014816764    0.00041666446  0              40.238471      1.1965779e-13  0              3.7656672    
   1300000   6363.961       200            200            0.0042212036  -0.0021399979   0              0.014803609    2.760165e-05   0              2.6655698      1.1965779e-13  0              3.7656692    
   1400000   6363.961       200            200            0.00422241    -0.0021400819   0              0.014807312    1.4133933e-05  0              1.3649541      1.1965779e-13  0              3.7656686    
   1500000   6363.961       200            200            0.0042227556  -0.0021401071   0              0.014808374    1.8971614e-10  0              1.8321426e-05  1.1965779e-13  0              3.7656685    
   1600000   6363.961       200            200            0.0042225266  -0.0021400909   0              0.014807671    2.5404533e-07  0              0.02453388     1.1965779e-13  0              3.7656686    
   1700000   6363.961       200            200            0.004222524   -0.0021400906   0              0.014807663    9.7283096e-09  0              0.0009394905   1.1965779e-13  0              3.7656686    
   1800000   6363.961       200            200            0.0042225554  -0.0021400929   0              0.014807759    2.4000526e-09  0              0.0002317799   1.1965779e-13  0              3.7656685    
   1900000   6363.961       200            200            0.0042225497  -0.0021400925   0              0.014807742    5.1525919e-10  0              4.9760045e-05  1.1965779e-13  0              3.7656685    
   2000000   6363.961       200            200            0.0042225466  -0.0021400923   0              0.014807732    5.0375879e-12  0              4.8649418e-07  1.1965779e-13  0              3.7656685    
   2100000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    1.2181056e-11  0              1.1763592e-06  1.1965779e-13  0              3.7656685    
   2200000   6363.961       200            200            0.0042225481  -0.0021400924   0              0.014807737    1.3528861e-13  0              1.3065206e-08  1.1965779e-13  0              3.7656685    
   2300000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    1.5956018e-13  0              1.5409181e-08  1.1965779e-13  0              3.7656685    
   2400000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    1.5857697e-14  0              1.5314229e-09  1.1965779e-13  0              3.7656685    
   2500000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    9.2314513e-16  0              8.9150749e-11  1.1965779e-13  0              3.7656685    
   2600000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    5.0116345e-16  0              4.8398779e-11  1.1965779e-13  0              3.7656685    
   2700000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    2.8563084e-17  0              2.7584182e-12  1.1965779e-13  0              3.7656685    
   2800000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    2.5767411e-18  0              2.4884321e-13  1.1965779e-13  0              3.7656685    
   2900000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    2.9290259e-19  0              2.8286436e-14  1.1965779e-13  0              3.7656685    
   3000000   6363.961       200            200            0.0042225479  -0.0021400924   0              0.014807736    3.5362313e-18  0              3.4150391e-13  1.1965779e-13  0              3.7656685    
Loop time of 362.852 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7143408.222 ns/day, 0.000 hours/ns, 8267.834 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.362     | 115.77     | 143.19     | 253.3 | 31.91
Neigh   | 0.87489    | 0.88902    | 0.90265    |   1.1 |  0.25
Comm    | 22.427     | 49.368     | 77.138     | 378.5 | 13.61
Output  | 0.24121    | 0.24151    | 0.24185    |   0.1 |  0.07
Modify  | 105.86     | 141.19     | 175.81     | 285.4 | 38.91
Other   |            | 55.39      |            |       | 15.27

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         712.75 ave        1052 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2851
Ave neighs/atom = 1.139944
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.55                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 108.506434554756
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.65
  ghost atom cutoff = 4.65
  binsize = 2.325, bins = 2738 87 87
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 35.02 | 35.03 | 35.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.1095104e-14  3.3285311e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067964511  3.3285311e-14  0             -0.0020389353   224390.41      0              2.167002e+10   1.1965779e-13  0              4.0934501    
    200000   6363.961       200            200            0.00047714075  3.3285311e-14  0              0.0014314223   25791.009      0              2.490711e+09   1.1965779e-13  0              3.9036886    
    300000   6363.961       200            200           -0.00023893577  3.3285311e-14  0             -0.00071680731  11845.005      0              1.1439058e+09  1.1965779e-13  0              3.7941338    
    400000   6363.961       200            200            0.017061352   -0.0045411513   0              0.055725207    1870.1742      0              1.8060804e+08  1.1965779e-13  0              3.766598     
    500000   6363.961       200            200            0.0016668611  -0.0014698875   0              0.0064704708   598.31259      0              57780747       1.1965779e-13  0              3.7721088    
    600000   6363.961       200            200            0.0027236618  -0.001941055    0              0.01011204     15.297245      0              1477298.4      1.1965779e-13  0              3.7714252    
    700000   6363.961       200            200            0.0040710425  -0.0021895605   0              0.014402688    17.69324       0              1708686.5      1.1965779e-13  0              3.7707387    
    800000   6363.961       200            200            0.0044589994  -0.0021637563   0              0.015540755    0.0074211541   0              716.68194      1.1965779e-13  0              3.7705666    
    900000   6363.961       200            200            0.0042012851  -0.0021339949   0              0.01473785     0.300137       0              28985.083      1.1965779e-13  0              3.7706835    
   1000000   6363.961       200            200            0.0042055883  -0.0021339754   0              0.01475074     0.015900854    0              1535.5907      1.1965779e-13  0              3.7706824    
   1100000   6363.961       200            200            0.0042397352  -0.002136414    0              0.01485562     0.0022296829   0              215.32682      1.1965779e-13  0              3.7706668    
   1200000   6363.961       200            200            0.004231963   -0.0021358808   0              0.01483177     0.00072905481  0              70.406895      1.1965779e-13  0              3.7706702    
   1300000   6363.961       200            200            0.0042290046  -0.0021356673   0              0.014822681    4.1612602e-07  0              0.040186473    1.1965779e-13  0              3.7706716    
   1400000   6363.961       200            200            0.0042306782  -0.0021357847   0              0.014827819    1.4253564e-05  0              1.3765072      1.1965779e-13  0              3.7706708    
   1500000   6363.961       200            200            0.0042307226  -0.0021357886   0              0.014827956    5.0760459e-07  0              0.049020818    1.1965779e-13  0              3.7706708    
   1600000   6363.961       200            200            0.0042304876  -0.002135772    0              0.014827235    1.2812931e-07  0              0.012373812    1.1965779e-13  0              3.7706709    
   1700000   6363.961       200            200            0.0042305314  -0.002135775    0              0.014827369    2.9519246e-08  0              0.0028507575   1.1965779e-13  0              3.7706709    
   1800000   6363.961       200            200            0.0042305538  -0.0021357766   0              0.014827438    1.4071152e-10  0              1.3588912e-05  1.1965779e-13  0              3.7706709    
   1900000   6363.961       200            200            0.0042305432  -0.0021357758   0              0.014827405    6.5879577e-10  0              6.362178e-05   1.1965779e-13  0              3.7706709    
   2000000   6363.961       200            200            0.0042305424  -0.0021357758   0              0.014827403    1.4718943e-11  0              1.4214502e-06  1.1965779e-13  0              3.7706709    
   2100000   6363.961       200            200            0.004230544   -0.0021357759   0              0.014827408    7.0071073e-12  0              6.7669626e-07  1.1965779e-13  0              3.7706709    
   2200000   6363.961       200            200            0.0042305437  -0.0021357759   0              0.014827407    1.1620813e-12  0              1.122255e-07   1.1965779e-13  0              3.7706709    
   2300000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    1.635986e-14   0              1.5799182e-09  1.1965779e-13  0              3.7706709    
   2400000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    2.9720681e-14  0              2.8702106e-09  1.1965779e-13  0              3.7706709    
   2500000   6363.961       200            200            0.0042305437  -0.0021357759   0              0.014827407    3.7248739e-16  0              3.5972166e-11  1.1965779e-13  0              3.7706709    
   2600000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    4.0312463e-16  0              3.8930892e-11  1.1965779e-13  0              3.7706709    
   2700000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    7.4533047e-17  0              7.1978682e-12  1.1965779e-13  0              3.7706709    
   2800000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    1.034707e-17   0              9.99246e-13    1.1965779e-13  0              3.7706709    
   2900000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    4.8607087e-19  0              4.6941246e-14  1.1965779e-13  0              3.7706709    
   3000000   6363.961       200            200            0.0042305436  -0.0021357759   0              0.014827407    5.6368869e-18  0              5.4437019e-13  1.1965779e-13  0              3.7706709    
Loop time of 362.754 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7145330.704 ns/day, 0.000 hours/ns, 8270.059 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.582     | 116.2      | 143.76     | 252.8 | 32.03
Neigh   | 0.85067    | 0.86355    | 0.87571    |   1.0 |  0.24
Comm    | 22.664     | 49.42      | 77.326     | 377.5 | 13.62
Output  | 0.24331    | 0.24361    | 0.24394    |   0.1 |  0.07
Modify  | 105.67     | 141.01     | 174.88     | 284.7 | 38.87
Other   |            | 55.02      |            |       | 15.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         715.75 ave        1058 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2863
Ave neighs/atom = 1.1447421
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.56                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 109.223435114817
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.66
  ghost atom cutoff = 4.66
  binsize = 2.33, bins = 2732 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.5 | 34.5 | 34.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.1653742e-14  3.4961226e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068114378  3.4961226e-14  0             -0.0020434313   219819.92      0              2.1228635e+10  1.1965779e-13  0              4.1016111    
    200000   6363.961       200            200            0.00049407683  3.4961226e-14  0              0.0014822305   27379.853      0              2.6441502e+09  1.1965779e-13  0              3.90687      
    300000   6363.961       200            200           -0.00022673608  3.4961226e-14  0             -0.00068020824  10461.95       0              1.0103402e+09  1.1965779e-13  0              3.80044      
    400000   6363.961       200            200            0.019029304   -0.0046603646   0              0.061748275    535.69393      0              51733485       1.1965779e-13  0              3.7711514    
    500000   6363.961       200            200            0.0013324341  -0.0010748114   0              0.0050721137   395.00429      0              38146687       1.1965779e-13  0              3.7774432    
    600000   6363.961       200            200            0.0026700927  -0.0018903612   0              0.0099006394   1.2747669      0              123107.86      1.1965779e-13  0              3.7764708    
    700000   6363.961       200            200            0.0042608172  -0.0021921086   0              0.01497456     18.547836      0              1791217.2      1.1965779e-13  0              3.7756592    
    800000   6363.961       200            200            0.0044503125  -0.002158591    0              0.015509529    0.33658478     0              32504.949      1.1965779e-13  0              3.775576     
    900000   6363.961       200            200            0.0041837918  -0.0021286271   0              0.014680003    0.20088202     0              19399.748      1.1965779e-13  0              3.7756974    
   1000000   6363.961       200            200            0.0042218306  -0.0021310892   0              0.014796581    0.032435173    0              3132.3568      1.1965779e-13  0              3.7756809    
   1100000   6363.961       200            200            0.0042493886  -0.002133066    0              0.014881232    0.00035704369  0              34.480724      1.1965779e-13  0              3.7756682    
   1200000   6363.961       200            200            0.004237905   -0.0021322677   0              0.014845983    0.00082079588  0              79.266591      1.1965779e-13  0              3.7756734    
   1300000   6363.961       200            200            0.0042368473  -0.0021321872   0              0.014842729    1.6634941e-05  0              1.6064835      1.1965779e-13  0              3.7756739    
   1400000   6363.961       200            200            0.0042386389  -0.0021323138   0              0.01484823     8.5150985e-06  0              0.82232727     1.1965779e-13  0              3.7756731    
   1500000   6363.961       200            200            0.0042383672  -0.0021322954   0              0.014847397    1.4992043e-06  0              0.14478242     1.1965779e-13  0              3.7756732    
   1600000   6363.961       200            200            0.0042381886  -0.0021322826   0              0.014846848    1.2132666e-08  0              0.0011716861   1.1965779e-13  0              3.7756733    
   1700000   6363.961       200            200            0.0042382665  -0.002132288    0              0.014847087    3.6283997e-08  0              0.0035040487   1.1965779e-13  0              3.7756732    
   1800000   6363.961       200            200            0.0042382726  -0.0021322885   0              0.014847106    8.5262899e-10  0              8.2340805e-05  1.1965779e-13  0              3.7756732    
   1900000   6363.961       200            200            0.0042382606  -0.0021322876   0              0.01484707     3.579579e-10   0              3.4569012e-05  1.1965779e-13  0              3.7756732    
   2000000   6363.961       200            200            0.0042382626  -0.0021322878   0              0.014847076    6.9052054e-11  0              6.6685531e-06  1.1965779e-13  0              3.7756732    
   2100000   6363.961       200            200            0.0042382637  -0.0021322878   0              0.014847079    3.9452568e-13  0              3.8100467e-08  1.1965779e-13  0              3.7756732    
   2200000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847077    1.599714e-12   0              1.5448892e-07  1.1965779e-13  0              3.7756732    
   2300000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847077    4.3113892e-14  0              4.1636311e-09  1.1965779e-13  0              3.7756732    
   2400000   6363.961       200            200            0.0042382633  -0.0021322878   0              0.014847078    1.4896188e-14  0              1.4385672e-09  1.1965779e-13  0              3.7756732    
   2500000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    3.2425116e-15  0              3.1313856e-10  1.1965779e-13  0              3.7756732    
   2600000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    2.0329927e-17  0              1.9633189e-12  1.1965779e-13  0              3.7756732    
   2700000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    3.7295154e-17  0              3.601699e-12   1.1965779e-13  0              3.7756732    
   2800000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    3.5948711e-18  0              3.4716692e-13  1.1965779e-13  0              3.7756732    
   2900000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    6.2823125e-18  0              6.0670077e-13  1.1965779e-13  0              3.7756732    
   3000000   6363.961       200            200            0.0042382632  -0.0021322878   0              0.014847078    4.1780045e-19  0              4.0348177e-14  1.1965779e-13  0              3.7756732    
Loop time of 362.805 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7144337.244 ns/day, 0.000 hours/ns, 8268.909 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.553     | 116.05     | 143.72     | 254.7 | 31.99
Neigh   | 0.84182    | 0.85595    | 0.86982    |   1.1 |  0.24
Comm    | 21.925     | 49.429     | 76.746     | 381.6 | 13.62
Output  | 0.24329    | 0.24359    | 0.24393    |   0.1 |  0.07
Modify  | 106.64     | 141.32     | 175.24     | 285.4 | 38.95
Other   |            | 54.91      |            |       | 15.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         718.25 ave        1063 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2873
Ave neighs/atom = 1.1487405
Neighbor list builds = 130
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.57                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 109.943587320628
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.67
  ghost atom cutoff = 4.67
  binsize = 2.335, bins = 2726 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.45 | 34.46 | 34.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.2222253e-14  3.6666758e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068245794  3.6666758e-14  0             -0.0020473738   215299.04      0              2.079204e+10   1.1965779e-13  0              4.1097379    
    200000   6363.961       200            200            0.00051113552  3.6666758e-14  0              0.0015334066   29014.614      0              2.8020238e+09  1.1965779e-13  0              3.9099965    
    300000   6363.961       200            200           -0.0002142689   3.6666758e-14  0             -0.00064280671  9166.2961      0              8.8521526e+08  1.1965779e-13  0              3.8066671    
    400000   6363.961       200            200            0.019781421   -0.0046510135   0              0.063995276    1.2504446      0              120758.98      1.1965779e-13  0              3.7759902    
    500000   6363.961       200            200            0.0010640158  -0.00091335708  0              0.0041054045   215.59574      0              20820693       1.1965779e-13  0              3.7827048    
    600000   6363.961       200            200            0.0026907618  -0.0018868877   0              0.009959173    2.9220972      0              282195.23      1.1965779e-13  0              3.7814684    
    700000   6363.961       200            200            0.0044525006  -0.0021877478   0              0.01554525     16.395913      0              1583400        1.1965779e-13  0              3.7805811    
    800000   6363.961       200            200            0.0044193818  -0.0021521729   0              0.015410318    1.0271108      0              99191.008      1.1965779e-13  0              3.7805952    
    900000   6363.961       200            200            0.0041727205  -0.002123913    0              0.014642074    0.087470433    0              8447.2683      1.1965779e-13  0              3.7807084    
   1000000   6363.961       200            200            0.004240269   -0.0021286365   0              0.014849444    0.043690373    0              4219.3035      1.1965779e-13  0              3.7806784    
   1100000   6363.961       200            200            0.0042571719  -0.0021298659   0              0.014901382    0.00015252633  0              14.729901      1.1965779e-13  0              3.7806705    
   1200000   6363.961       200            200            0.004243823   -0.0021289299   0              0.014860399    0.00062904627  0              60.748786      1.1965779e-13  0              3.7806765    
   1300000   6363.961       200            200            0.0042448909  -0.0021289994   0              0.014863672    6.3127694e-05  0              6.0964208      1.1965779e-13  0              3.780676     
   1400000   6363.961       200            200            0.0042464219  -0.0021291085   0              0.014868374    1.9333688e-06  0              0.18671092     1.1965779e-13  0              3.7806753    
   1500000   6363.961       200            200            0.0042458946  -0.0021290718   0              0.014866756    2.0136905e-06  0              0.19446781     1.1965779e-13  0              3.7806756    
   1600000   6363.961       200            200            0.0042458203  -0.0021290663   0              0.014866527    2.8225183e-08  0              0.0027257862   1.1965779e-13  0              3.7806756    
   1700000   6363.961       200            200            0.00424591    -0.0021290726   0              0.014866803    2.2251572e-08  0              0.0021488975   1.1965779e-13  0              3.7806756    
   1800000   6363.961       200            200            0.0042458975  -0.0021290718   0              0.014866764    3.6000315e-09  0              0.00034766527  1.1965779e-13  0              3.7806756    
   1900000   6363.961       200            200            0.0042458886  -0.0021290712   0              0.014866737    2.5778612e-11  0              2.4895138e-06  1.1965779e-13  0              3.7806756    
   2000000   6363.961       200            200            0.0042458925  -0.0021290714   0              0.014866749    8.7564741e-11  0              8.4563759e-06  1.1965779e-13  0              3.7806756    
   2100000   6363.961       200            200            0.0042458927  -0.0021290715   0              0.01486675     2.7528468e-12  0              2.6585024e-07  1.1965779e-13  0              3.7806756    
   2200000   6363.961       200            200            0.0042458921  -0.0021290714   0              0.014866748    7.148274e-13   0              6.9032914e-08  1.1965779e-13  0              3.7806756    
   2300000   6363.961       200            200            0.0042458922  -0.0021290714   0              0.014866748    1.8941964e-13  0              1.8292793e-08  1.1965779e-13  0              3.7806756    
   2400000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    1.4617399e-17  0              1.4116438e-12  1.1965779e-13  0              3.7806756    
   2500000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    3.5623037e-15  0              3.440218e-10   1.1965779e-13  0              3.7806756    
   2600000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    1.9709637e-16  0              1.9034157e-11  1.1965779e-13  0              3.7806756    
   2700000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    3.8276077e-19  0              3.6964296e-14  1.1965779e-13  0              3.7806756    
   2800000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    1.5318247e-19  0              1.4793267e-14  1.1965779e-13  0              3.7806756    
   2900000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    5.6811071e-19  0              5.4864066e-14  1.1965779e-13  0              3.7806756    
   3000000   6363.961       200            200            0.0042458923  -0.0021290714   0              0.014866748    7.4201757e-18  0              7.1658746e-13  1.1965779e-13  0              3.7806756    
Loop time of 363.549 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7129712.089 ns/day, 0.000 hours/ns, 8251.982 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.284     | 116.14     | 144.15     | 255.0 | 31.95
Neigh   | 0.8548     | 0.86861    | 0.88212    |   1.1 |  0.24
Comm    | 22.879     | 49.682     | 78.145     | 380.0 | 13.67
Output  | 0.24437    | 0.24467    | 0.245      |   0.1 |  0.07
Modify  | 105.71     | 141.31     | 175.59     | 284.4 | 38.87
Other   |            | 55.3       |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         721.25 ave        1069 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2885
Ave neighs/atom = 1.1535386
Neighbor list builds = 132
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.58                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 110.666898083693
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.68
  ghost atom cutoff = 4.68
  binsize = 2.34, bins = 2720 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.4 | 34.41 | 34.42 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.2800529e-14  3.8401586e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068358816  3.8401586e-14  0             -0.0020507645   210827.69      0              2.0360229e+10  1.1965779e-13  0              4.1178306    
    200000   6363.961       200            200            0.0005283159   3.8401586e-14  0              0.0015849477   30695.156      0              2.9643184e+09  1.1965779e-13  0              3.913068     
    300000   6363.961       200            200           -0.00020153625  3.8401586e-14  0             -0.00060460874  7957.7267      0              7.6850028e+08  1.1965779e-13  0              3.8128149    
    400000   6363.961       200            200            0.019125515   -0.0046482281   0              0.062024775    440.34583      0              42525449       1.1965779e-13  0              3.7811294    
    500000   6363.961       200            200            0.00091507845 -0.00076929877  0              0.0035145341   82.618537      0              7978706.9      1.1965779e-13  0              3.7878857    
    600000   6363.961       200            200            0.0027966684  -0.0018976379   0              0.010287643    19.796408      0              1911795.4      1.1965779e-13  0              3.7864182    
    700000   6363.961       200            200            0.0046258109  -0.002190496    0              0.016067929    11.899685      0              1149186.4      1.1965779e-13  0              3.7855112    
    800000   6363.961       200            200            0.004370556   -0.0021440848   0              0.015255753    1.8004868      0              173878.13      1.1965779e-13  0              3.7856225    
    900000   6363.961       200            200            0.0041704922  -0.0021193339   0              0.014630811    0.011820067    0              1141.4974      1.1965779e-13  0              3.7857155    
   1000000   6363.961       200            200            0.0042596335  -0.0021258434   0              0.014904744    0.043643128    0              4214.741       1.1965779e-13  0              3.7856754    
   1100000   6363.961       200            200            0.0042632835  -0.0021261439   0              0.014915994    0.0017239752   0              166.48918      1.1965779e-13  0              3.7856735    
   1200000   6363.961       200            200            0.0042502504  -0.0021252226   0              0.014875974    0.00028786308  0              27.799756      1.1965779e-13  0              3.7856794    
   1300000   6363.961       200            200            0.0042532721  -0.0021254311   0              0.014885247    0.00010332805  0              9.9786835      1.1965779e-13  0              3.7856781    
   1400000   6363.961       200            200            0.0042542142  -0.0021254994   0              0.014888142    2.0394109e-07  0              0.019695171    1.1965779e-13  0              3.7856777    
   1500000   6363.961       200            200            0.0042535532  -0.002125453    0              0.014886112    1.5582415e-06  0              0.15048381     1.1965779e-13  0              3.7856779    
   1600000   6363.961       200            200            0.0042536043  -0.0021254563   0              0.014886269    1.5772219e-07  0              0.01523168     1.1965779e-13  0              3.7856779    
   1700000   6363.961       200            200            0.0042536796  -0.0021254616   0              0.0148865      3.7511181e-09  0              0.00036225613  1.1965779e-13  0              3.7856779    
   1800000   6363.961       200            200            0.0042536524  -0.0021254597   0              0.014886417    4.9030591e-09  0              0.00047350235  1.1965779e-13  0              3.7856779    
   1900000   6363.961       200            200            0.0042536496  -0.0021254595   0              0.014886408    1.1254642e-10  0              1.0868927e-05  1.1965779e-13  0              3.7856779    
   2000000   6363.961       200            200            0.004253654   -0.0021254598   0              0.014886422    4.3286212e-11  0              4.1802725e-06  1.1965779e-13  0              3.7856779    
   2100000   6363.961       200            200            0.0042536532  -0.0021254598   0              0.014886419    1.0253925e-11  0              9.9025065e-07  1.1965779e-13  0              3.7856779    
   2200000   6363.961       200            200            0.0042536528  -0.0021254598   0              0.014886418    5.7525816e-16  0              5.5554315e-11  1.1965779e-13  0              3.7856779    
   2300000   6363.961       200            200            0.0042536531  -0.0021254598   0              0.014886419    1.9182161e-13  0              1.8524758e-08  1.1965779e-13  0              3.7856779    
   2400000   6363.961       200            200            0.0042536531  -0.0021254598   0              0.014886419    1.3217135e-14  0              1.2764163e-09  1.1965779e-13  0              3.7856779    
   2500000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    8.4675947e-16  0              8.1773969e-11  1.1965779e-13  0              3.7856779    
   2600000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    5.2693669e-16  0              5.0887774e-11  1.1965779e-13  0              3.7856779    
   2700000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    4.5173058e-17  0              4.3624906e-12  1.1965779e-13  0              3.7856779    
   2800000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    4.9800963e-18  0              4.8094206e-13  1.1965779e-13  0              3.7856779    
   2900000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    3.2486719e-20  0              3.1373348e-15  1.1965779e-13  0              3.7856779    
   3000000   6363.961       200            200            0.004253653   -0.0021254598   0              0.014886419    7.4824999e-18  0              7.2260628e-13  1.1965779e-13  0              3.7856779    
Loop time of 365.26 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7096312.953 ns/day, 0.000 hours/ns, 8213.325 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.748     | 116.96     | 145.23     | 255.3 | 32.02
Neigh   | 0.86133    | 0.87614    | 0.89035    |   1.2 |  0.24
Comm    | 22.969     | 49.836     | 78.607     | 380.1 | 13.64
Output  | 0.2421     | 0.24241    | 0.24274    |   0.1 |  0.07
Modify  | 106.15     | 141.77     | 176.21     | 284.5 | 38.81
Other   |            | 55.57      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         723.75 ave        1074 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2895
Ave neighs/atom = 1.157537
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.59                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 111.393374315515
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.69
  ghost atom cutoff = 4.69
  binsize = 2.345, bins = 2714 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.35 | 34.36 | 34.37 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.3388468e-14  4.0165403e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068453499  4.0165403e-14  0             -0.002053605    206405.78      0              1.9933193e+10  1.1965779e-13  0              4.1258891    
    200000   6363.961       200            200            0.00054561702  4.0165403e-14  0              0.001636851    32421.342      0              3.1310212e+09  1.1965779e-13  0              3.9160842    
    300000   6363.961       200            200           -0.00018854004  4.0165403e-14  0             -0.00056562012  6835.9186      0              6.6016409e+08  1.1965779e-13  0              3.818883     
    400000   6363.961       200            200            0.017140241   -0.0047409831   0              0.056161706    1703.9685      0              1.6455708e+08  1.1965779e-13  0              3.7865581    
    500000   6363.961       200            200            0.00084852702 -0.00070185493  0              0.003247436    10.682314      0              1031621.5      1.1965779e-13  0              3.7929811    
    600000   6363.961       200            200            0.0029892843  -0.0019123941   0              0.010880247    48.125431      0              4647609.7      1.1965779e-13  0              3.7913232    
    700000   6363.961       200            200            0.0047782956  -0.0021607188   0              0.016495606    6.5228989      0              629934.89      1.1965779e-13  0              3.7904555    
    800000   6363.961       200            200            0.00430977    -0.0021349296   0              0.01506424     2.3475258      0              226707.23      1.1965779e-13  0              3.7906554    
    900000   6363.961       200            200            0.0041782303  -0.0021151536   0              0.014649844    0.0082242427   0              794.23849      1.1965779e-13  0              3.790718     
   1000000   6363.961       200            200            0.0042783574  -0.002122464    0              0.014957536    0.032334395    0              3122.6245      1.1965779e-13  0              3.7906729    
   1100000   6363.961       200            200            0.0042680321  -0.0021217861   0              0.014925882    0.0040920138   0              395.1774       1.1965779e-13  0              3.7906773    
   1200000   6363.961       200            200            0.0042574727  -0.0021210327   0              0.014893451    3.3637907e-05  0              3.2485083      1.1965779e-13  0              3.7906821    
   1300000   6363.961       200            200            0.0042619066  -0.0021213425   0              0.014907062    0.00010588989  0              10.226087      1.1965779e-13  0              3.7906801    
   1400000   6363.961       200            200            0.0042620526  -0.002121355    0              0.014907513    4.7628961e-06  0              0.45996641     1.1965779e-13  0              3.79068      
   1500000   6363.961       200            200            0.0042614129  -0.0021213097   0              0.014905548    5.7479942e-07  0              0.055510014    1.1965779e-13  0              3.7906803    
   1600000   6363.961       200            200            0.0042615775  -0.0021213211   0              0.014906054    2.6266487e-07  0              0.025366293    1.1965779e-13  0              3.7906802    
   1700000   6363.961       200            200            0.0042616163  -0.0021213239   0              0.014906173    2.0660166e-09  0              0.0001995211   1.1965779e-13  0              3.7906802    
   1800000   6363.961       200            200            0.0042615829  -0.0021213216   0              0.01490607     3.1334694e-09  0              0.00030260804  1.1965779e-13  0              3.7906802    
   1900000   6363.961       200            200            0.0042615873  -0.0021213219   0              0.014906084    4.9505093e-10  0              4.7808475e-05  1.1965779e-13  0              3.7906802    
   2000000   6363.961       200            200            0.0042615905  -0.0021213221   0              0.014906094    1.2879892e-12  0              1.2438478e-07  1.1965779e-13  0              3.7906802    
   2100000   6363.961       200            200            0.004261589   -0.002121322    0              0.014906089    1.1061303e-11  0              1.0682214e-06  1.1965779e-13  0              3.7906802    
   2200000   6363.961       200            200            0.004261589   -0.002121322    0              0.014906089    6.4830213e-13  0              6.2608379e-08  1.1965779e-13  0              3.7906802    
   2300000   6363.961       200            200            0.0042615892  -0.002121322    0              0.01490609     4.6740534e-14  0              4.5138662e-09  1.1965779e-13  0              3.7906802    
   2400000   6363.961       200            200            0.0042615892  -0.002121322    0              0.01490609     2.91838e-14    0              2.8183625e-09  1.1965779e-13  0              3.7906802    
   2500000   6363.961       200            200            0.0042615892  -0.002121322    0              0.014906089    3.6478575e-16  0              3.5228397e-11  1.1965779e-13  0              3.7906802    
   2600000   6363.961       200            200            0.0042615892  -0.002121322    0              0.01490609     3.2779997e-16  0              3.1656575e-11  1.1965779e-13  0              3.7906802    
   2700000   6363.961       200            200            0.0042615892  -0.002121322    0              0.014906089    7.1313796e-17  0              6.8869759e-12  1.1965779e-13  0              3.7906802    
   2800000   6363.961       200            200            0.0042615892  -0.002121322    0              0.014906089    9.385278e-18   0              9.0636297e-13  1.1965779e-13  0              3.7906802    
   2900000   6363.961       200            200            0.0042615892  -0.002121322    0              0.014906089    3.6270246e-18  0              3.5027208e-13  1.1965779e-13  0              3.7906802    
   3000000   6363.961       200            200            0.0042615892  -0.002121322    0              0.014906089    5.1872226e-21  0              5.0094483e-16  1.1965779e-13  0              3.7906802    
Loop time of 364.444 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7112202.935 ns/day, 0.000 hours/ns, 8231.716 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.523     | 116.64     | 145.02     | 257.1 | 32.01
Neigh   | 0.87408    | 0.88834    | 0.90253    |   1.1 |  0.24
Comm    | 22.619     | 49.671     | 78.26      | 382.7 | 13.63
Output  | 0.24439    | 0.2447     | 0.24506    |   0.1 |  0.07
Modify  | 106.39     | 141.85     | 175.68     | 283.2 | 38.92
Other   |            | 55.15      |            |       | 15.13

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         726.75 ave        1079 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2907
Ave neighs/atom = 1.1623351
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.6                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 112.123022927599
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.7
  ghost atom cutoff = 4.7
  binsize = 2.35, bins = 2709 86 86
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 34.34 | 34.35 | 34.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.3985973e-14  4.1957918e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068529899  4.1957918e-14  0             -0.002055897    202033.23      0              1.9510923e+10  1.1965779e-13  0              4.1339134    
    200000   6363.961       200            200            0.00056303796  4.1957918e-14  0              0.0016891139   34193.039      0              3.302119e+09   1.1965779e-13  0              3.9190451    
    300000   6363.961       200            200           -0.00017528222  4.1957918e-14  0             -0.00052584667  5800.5496      0              5.6017556e+08  1.1965779e-13  0              3.8248714    
    400000   6363.961       200            200            0.01405306    -0.005229298    0              0.047388477    3385.5359      0              3.2695083e+08  1.1965779e-13  0              3.7922419    
    500000   6363.961       200            200            0.00086099012 -0.00069267263  0              0.003275643    6.8917576      0              665556.62      1.1965779e-13  0              3.7979883    
    600000   6363.961       200            200            0.00327586    -0.0018964853   0              0.011724065    81.453593      0              7866205        1.1965779e-13  0              3.7961886    
    700000   6363.961       200            200            0.004886366   -0.0021294464   0              0.016788544    2.0644751      0              199372.23      1.1965779e-13  0              3.7954192    
    800000   6363.961       200            200            0.0042446128  -0.0021239444   0              0.014857783    2.452156       0              236811.67      1.1965779e-13  0              3.7956908    
    900000   6363.961       200            200            0.0041959427  -0.0021114732   0              0.014699301    0.077743366    0              7507.8978      1.1965779e-13  0              3.7957161    
   1000000   6363.961       200            200            0.0042948398  -0.0021186804   0              0.0150032      0.0158334      0              1529.0764      1.1965779e-13  0              3.7956714    
   1100000   6363.961       200            200            0.0042718328  -0.0021171145   0              0.014932613    0.0057969198   0              559.82502      1.1965779e-13  0              3.7956815    
   1200000   6363.961       200            200            0.0042655234  -0.002116656    0              0.014913226    4.0705211e-05  0              3.931018       1.1965779e-13  0              3.7956844    
   1300000   6363.961       200            200            0.0042705555  -0.0021170097   0              0.014928676    6.8978082e-05  0              6.6614094      1.1965779e-13  0              3.7956821    
   1400000   6363.961       200            200            0.0042698642  -0.0021169632   0              0.014926556    1.159255e-05   0              1.1195255      1.1965779e-13  0              3.7956824    
   1500000   6363.961       200            200            0.0042693978  -0.0021169299   0              0.014925123    5.7733693e-09  0              0.00055755068  1.1965779e-13  0              3.7956826    
   1600000   6363.961       200            200            0.0042696339  -0.0021169464   0              0.014925848    2.3245922e-07  0              0.022449248    1.1965779e-13  0              3.7956825    
   1700000   6363.961       200            200            0.0042696244  -0.0021169458   0              0.014925819    1.8905218e-08  0              0.0018257307   1.1965779e-13  0              3.7956825    
   1800000   6363.961       200            200            0.0042695955  -0.0021169438   0              0.01492573     5.2195261e-10  0              5.0406447e-05  1.1965779e-13  0              3.7956825    
   1900000   6363.961       200            200            0.0042696056  -0.0021169445   0              0.014925761    6.5182869e-10  0              6.294895e-05   1.1965779e-13  0              3.7956825    
   2000000   6363.961       200            200            0.0042696064  -0.0021169445   0              0.014925764    2.2511678e-11  0              2.1740167e-06  1.1965779e-13  0              3.7956825    
   2100000   6363.961       200            200            0.0042696048  -0.0021169444   0              0.014925759    3.9486749e-12  0              3.8133476e-07  1.1965779e-13  0              3.7956825    
   2200000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     1.5577199e-12  0              1.5043344e-07  1.1965779e-13  0              3.7956825    
   2300000   6363.961       200            200            0.0042696053  -0.0021169444   0              0.01492576     1.3241649e-14  0              1.2787837e-09  1.1965779e-13  0              3.7956825    
   2400000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     1.7818657e-14  0              1.7207984e-09  1.1965779e-13  0              3.7956825    
   2500000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     3.1702064e-15  0              3.0615585e-10  1.1965779e-13  0              3.7956825    
   2600000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     5.7634755e-18  0              5.5659521e-13  1.1965779e-13  0              3.7956825    
   2700000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     2.2255835e-17  0              2.1493093e-12  1.1965779e-13  0              3.7956825    
   2800000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     1.1487832e-18  0              1.1094126e-13  1.1965779e-13  0              3.7956825    
   2900000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     5.9364513e-18  0              5.7329997e-13  1.1965779e-13  0              3.7956825    
   3000000   6363.961       200            200            0.0042696052  -0.0021169444   0              0.01492576     7.1658389e-21  0              6.9202543e-16  1.1965779e-13  0              3.7956825    
Loop time of 364.24 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7116193.705 ns/day, 0.000 hours/ns, 8236.335 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.357     | 116.5      | 144.93     | 258.1 | 31.98
Neigh   | 0.87397    | 0.88797    | 0.90301    |   1.1 |  0.24
Comm    | 23.058     | 50.086     | 78.649     | 382.0 | 13.75
Output  | 0.24381    | 0.24414    | 0.2445     |   0.1 |  0.07
Modify  | 105.35     | 141.24     | 175.82     | 286.5 | 38.78
Other   |            | 55.28      |            |       | 15.18

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         729.75 ave        1086 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2919
Ave neighs/atom = 1.1671331
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.61                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 112.855850831449
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.71
  ghost atom cutoff = 4.71
  binsize = 2.355, bins = 2703 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.81 | 33.81 | 33.82 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.4592952e-14  4.3778856e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068588071  4.3778856e-14  0             -0.0020576421   197709.94      0              1.9093411e+10  1.1965779e-13  0              4.1419033    
    200000   6363.961       200            200            0.00058057792  4.3778856e-14  0              0.0017417337   36010.123      0              3.4775999e+09  1.1965779e-13  0              3.9219505    
    300000   6363.961       200            200           -0.00016176466  4.3778856e-14  0             -0.00048529397  4851.2935      0              4.685032e+08   1.1965779e-13  0              3.8307799    
    400000   6363.961       200            200            0.010509696   -0.0056016185   0              0.037130706    4996.2553      0              4.8250257e+08  1.1965779e-13  0              3.7981279    
    500000   6363.961       200            200            0.0009639505  -0.0007062239   0              0.0035980754   71.305879      0              6886211.4      1.1965779e-13  0              3.8029071    
    600000   6363.961       200            200            0.0036326409  -0.0018987882   0              0.012796711    111.81922      0              10798700       1.1965779e-13  0              3.8010226    
    700000   6363.961       200            200            0.0049343821  -0.0021148356   0              0.016917982    0.037920782    0              3662.1177      1.1965779e-13  0              3.8004056    
    800000   6363.961       200            200            0.0041824909  -0.0021120302   0              0.014659503    2.0757825      0              200464.22      1.1965779e-13  0              3.8007252    
    900000   6363.961       200            200            0.0042225898  -0.0021080002   0              0.01477577     0.18779686     0              18136.077      1.1965779e-13  0              3.8007102    
   1000000   6363.961       200            200            0.0043079746  -0.0021141656   0              0.015038089    0.0029698522   0              286.80707      1.1965779e-13  0              3.8006714    
   1100000   6363.961       200            200            0.0042754409  -0.0021119335   0              0.014938256    0.0057947188   0              559.61247      1.1965779e-13  0              3.8006858    
   1200000   6363.961       200            200            0.0042744765  -0.0021118491   0              0.014935279    0.00030137271  0              29.10442       1.1965779e-13  0              3.8006864    
   1300000   6363.961       200            200            0.0042791701  -0.0021121802   0              0.01494969     2.140378e-05   0              2.0670239      1.1965779e-13  0              3.8006842    
   1400000   6363.961       200            200            0.0042777775  -0.0021120843   0              0.014945417    1.4752776e-05  0              1.4247175      1.1965779e-13  0              3.8006848    
   1500000   6363.961       200            200            0.0042775968  -0.0021120708   0              0.014944861    3.8791779e-07  0              0.037462323    1.1965779e-13  0              3.8006849    
   1600000   6363.961       200            200            0.0042778431  -0.0021120881   0              0.014945617    9.9567231e-08  0              0.0096154905   1.1965779e-13  0              3.8006848    
   1700000   6363.961       200            200            0.0042777875  -0.0021120843   0              0.014945447    3.4717284e-08  0              0.0033527468   1.1965779e-13  0              3.8006848    
   1800000   6363.961       200            200            0.0042777723  -0.0021120832   0              0.0149454      3.2161285e-10  0              3.1059067e-05  1.1965779e-13  0              3.8006849    
   1900000   6363.961       200            200            0.0042777848  -0.0021120841   0              0.014945438    3.7218311e-10  0              3.5942781e-05  1.1965779e-13  0              3.8006849    
   2000000   6363.961       200            200            0.0042777828  -0.002112084    0              0.014945432    7.5285596e-11  0              7.2705439e-06  1.1965779e-13  0              3.8006849    
   2100000   6363.961       200            200            0.0042777817  -0.0021120839   0              0.014945429    4.6233132e-14  0              4.464865e-09   1.1965779e-13  0              3.8006849    
   2200000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    1.2091819e-12  0              1.1677414e-07  1.1965779e-13  0              3.8006849    
   2300000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    1.4906497e-13  0              1.4395628e-08  1.1965779e-13  0              3.8006849    
   2400000   6363.961       200            200            0.0042777822  -0.0021120839   0              0.014945431    5.93739e-16    0              5.7339063e-11  1.1965779e-13  0              3.8006849    
   2500000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    3.5198937e-15  0              3.3992613e-10  1.1965779e-13  0              3.8006849    
   2600000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    2.1854919e-16  0              2.1105917e-11  1.1965779e-13  0              3.8006849    
   2700000   6363.961       200            200            0.0042777822  -0.0021120839   0              0.014945431    3.1888586e-18  0              3.0795714e-13  1.1965779e-13  0              3.8006849    
   2800000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    8.9889829e-19  0              8.6809162e-14  1.1965779e-13  0              3.8006849    
   2900000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    5.9586982e-18  0              5.7544842e-13  1.1965779e-13  0              3.8006849    
   3000000   6363.961       200            200            0.0042777823  -0.0021120839   0              0.014945431    4.3396235e-24  0              4.1908978e-19  1.1965779e-13  0              3.8006849    
Loop time of 363.396 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7132719.926 ns/day, 0.000 hours/ns, 8255.463 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.408     | 116.66     | 144.83     | 256.1 | 32.10
Neigh   | 0.87114    | 0.88509    | 0.89914    |   1.1 |  0.24
Comm    | 22.871     | 49.846     | 78.553     | 381.8 | 13.72
Output  | 0.24586    | 0.24617    | 0.2465     |   0.1 |  0.07
Modify  | 105.36     | 140.78     | 174.6      | 284.2 | 38.74
Other   |            | 54.98      |            |       | 15.13

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         731.75 ave        1090 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2927
Ave neighs/atom = 1.1703319
Neighbor list builds = 138
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.62                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 113.591864938568
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.72
  ghost atom cutoff = 4.72
  binsize = 2.36, bins = 2697 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.78 | 33.78 | 33.79 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.5209317e-14  4.562795e-14   0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068628073  4.562795e-14   0             -0.0020588422   193435.85      0              1.868065e+10   1.1965779e-13  0              4.1498587    
    200000   6363.961       200            200            0.00059823585  4.562795e-14   0              0.0017947076   37872.448      0              3.6574499e+09  1.1965779e-13  0              3.9248003    
    300000   6363.961       200            200           -0.00014798939  4.562795e-14   0             -0.00044396817  3987.8374      0              3.851168e+08   1.1965779e-13  0              3.8366082    
    400000   6363.961       200            200            0.0073420953  -0.0047774885   0              0.026803774    6150.0139      0              5.9392432e+08  1.1965779e-13  0              3.8041536    
    500000   6363.961       200            200            0.0011716643  -0.0007272379   0              0.0042422309   196.96711      0              19021674       1.1965779e-13  0              3.8077395    
    600000   6363.961       200            200            0.0040472513  -0.0019099164   0              0.01405167     131.46552      0              12695999       1.1965779e-13  0              3.8058353    
    700000   6363.961       200            200            0.0049208127  -0.0021092978   0              0.016871736    1.1283463      0              108967.61      1.1965779e-13  0              3.8054161    
    800000   6363.961       200            200            0.004130146   -0.0021007932   0              0.014491231    1.3696685      0              132272.78      1.1965779e-13  0              3.8057554    
    900000   6363.961       200            200            0.004255985   -0.0021046897   0              0.014872645    0.28713884     0              27729.814      1.1965779e-13  0              3.8057012    
   1000000   6363.961       200            200            0.0043170038  -0.0021090467   0              0.015060058    0.00058663998  0              56.65349       1.1965779e-13  0              3.8056733    
   1100000   6363.961       200            200            0.0042795275  -0.0021064699   0              0.014945052    0.0040922104   0              395.19638      1.1965779e-13  0              3.80569      
   1200000   6363.961       200            200            0.004284133   -0.0021067753   0              0.014959174    0.00063271479  0              61.103065      1.1965779e-13  0              3.805688     
   1300000   6363.961       200            200            0.0042876032  -0.0021070211   0              0.014969831    2.0349782e-10  0              1.9652363e-05  1.1965779e-13  0              3.8056865    
   1400000   6363.961       200            200            0.0042857951  -0.002106896    0              0.014964281    1.152595e-05   0              1.1130938      1.1965779e-13  0              3.8056873    
   1500000   6363.961       200            200            0.0042859462  -0.0021069057   0              0.014964744    1.3454407e-06  0              0.12993303     1.1965779e-13  0              3.8056872    
   1600000   6363.961       200            200            0.0042861382  -0.0021069193   0              0.014965334    3.6705334e-09  0              0.00035447384  1.1965779e-13  0              3.8056871    
   1700000   6363.961       200            200            0.0042860521  -0.0021069133   0              0.01496507     3.1348969e-08  0              0.003027459    1.1965779e-13  0              3.8056872    
   1800000   6363.961       200            200            0.0042860557  -0.0021069135   0              0.014965081    2.7486549e-09  0              0.00026544541  1.1965779e-13  0              3.8056872    
   1900000   6363.961       200            200            0.0042860661  -0.0021069143   0              0.014965113    3.5041419e-11  0              3.3840494e-06  1.1965779e-13  0              3.8056872    
   2000000   6363.961       200            200            0.0042860621  -0.002106914    0              0.0149651      8.2656541e-11  0              7.9823771e-06  1.1965779e-13  0              3.8056872    
   2100000   6363.961       200            200            0.004286062   -0.002106914    0              0.0149651      5.3533401e-12  0              5.1698727e-07  1.1965779e-13  0              3.8056872    
   2200000   6363.961       200            200            0.0042860626  -0.002106914    0              0.014965102    1.8797091e-13  0              1.8152885e-08  1.1965779e-13  0              3.8056872    
   2300000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    2.1174939e-13  0              2.044924e-08   1.1965779e-13  0              3.8056872    
   2400000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    9.9977863e-15  0              9.6551464e-10  1.1965779e-13  0              3.8056872    
   2500000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    7.4627033e-16  0              7.2069447e-11  1.1965779e-13  0              3.8056872    
   2600000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    5.2857555e-16  0              5.1046043e-11  1.1965779e-13  0              3.8056872    
   2700000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    5.9185798e-17  0              5.7157407e-12  1.1965779e-13  0              3.8056872    
   2800000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    9.3416965e-18  0              9.0215418e-13  1.1965779e-13  0              3.8056872    
   2900000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    8.0263187e-21  0              7.7512441e-16  1.1965779e-13  0              3.8056872    
   3000000   6363.961       200            200            0.0042860624  -0.002106914    0              0.014965101    4.956034e-18   0              4.7861829e-13  1.1965779e-13  0              3.8056872    
Loop time of 365.861 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7084667.070 ns/day, 0.000 hours/ns, 8199.846 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.145     | 116.73     | 145.73     | 260.8 | 31.91
Neigh   | 0.87611    | 0.89093    | 0.90569    |   1.2 |  0.24
Comm    | 23.087     | 50.557     | 79.823     | 383.2 | 13.82
Output  | 0.24287    | 0.24318    | 0.24353    |   0.1 |  0.07
Modify  | 107.18     | 142.58     | 176.55     | 280.7 | 38.97
Other   |            | 54.86      |            |       | 14.99

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         734.25 ave        1095 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2937
Ave neighs/atom = 1.1743303
Neighbor list builds = 140
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.63                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 114.33107216046
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.73
  ghost atom cutoff = 4.73
  binsize = 2.365, bins = 2691 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.71 | 33.72 | 33.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.5834983e-14  4.7504949e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068649958  4.7504949e-14  0             -0.0020594987   189210.86      0              1.8272631e+10  1.1965779e-13  0              4.1577797    
    200000   6363.961       200            200            0.00061601091  4.7504949e-14  0              0.0018480327   39779.889      0              3.841657e+09   1.1965779e-13  0              3.9275942    
    300000   6363.961       200            200           -0.00013395829  4.7504949e-14  0             -0.00040187486  3209.8569      0              3.09985e+08    1.1965779e-13  0              3.8423562    
    400000   6363.961       200            200            0.004524914   -0.0039742609   0              0.017549003    6664.3272      0              6.4359302e+08  1.1965779e-13  0              3.8102556    
    500000   6363.961       200            200            0.0014856953  -0.00080315356  0              0.0052602394   369.47282      0              35681040       1.1965779e-13  0              3.81249      
    600000   6363.961       200            200            0.0044737507  -0.0020027691   0              0.015424021    134.83345      0              13021249       1.1965779e-13  0              3.8106386    
    700000   6363.961       200            200            0.0048536344  -0.0020950114   0              0.016655915    4.9376212      0              476840.11      1.1965779e-13  0              3.8104501    
    800000   6363.961       200            200            0.0040948523  -0.0020868671   0              0.014371424    0.61265772     0              59166.098      1.1965779e-13  0              3.8107787    
    900000   6363.961       200            200            0.0042931026  -0.002101529    0              0.014980837    0.32948087     0              31818.904      1.1965779e-13  0              3.8106906    
   1000000   6363.961       200            200            0.0043217205  -0.0021036076   0              0.015068769    0.0098673742   0              952.92037      1.1965779e-13  0              3.8106771    
   1100000   6363.961       200            200            0.0042846674  -0.0021010525   0              0.014955055    0.0017353413   0              167.58684      1.1965779e-13  0              3.8106937    
   1200000   6363.961       200            200            0.0042941491  -0.0021016978   0              0.014984145    0.0008043041   0              77.673933      1.1965779e-13  0              3.8106896    
   1300000   6363.961       200            200            0.0042957298  -0.0021018128   0              0.014989002    2.1012157e-05  0              2.0292038      1.1965779e-13  0              3.8106888    
   1400000   6363.961       200            200            0.0042938833  -0.0021016848   0              0.014983335    4.7243477e-06  0              0.45624368     1.1965779e-13  0              3.8106897    
   1500000   6363.961       200            200            0.0042943344  -0.0021017153   0              0.014984719    1.9584737e-06  0              0.18913538     1.1965779e-13  0              3.8106895    
   1600000   6363.961       200            200            0.004294421   -0.0021017216   0              0.014984985    4.4257088e-08  0              0.0042740328   1.1965779e-13  0              3.8106894    
   1700000   6363.961       200            200            0.0042943291  -0.0021017152   0              0.014984702    1.2756088e-08  0              0.0012318917   1.1965779e-13  0              3.8106895    
   1800000   6363.961       200            200            0.0042943505  -0.0021017167   0              0.014984768    4.7569714e-09  0              0.00045939425  1.1965779e-13  0              3.8106895    
   1900000   6363.961       200            200            0.0042943551  -0.002101717    0              0.014984782    9.1848294e-11  0              8.8700508e-06  1.1965779e-13  0              3.8106894    
   2000000   6363.961       200            200            0.0042943506  -0.0021017167   0              0.014984768    3.420598e-11   0              3.3033687e-06  1.1965779e-13  0              3.8106895    
   2100000   6363.961       200            200            0.0042943516  -0.0021017168   0              0.014984772    1.1522444e-11  0              1.1127551e-06  1.1965779e-13  0              3.8106895    
   2200000   6363.961       200            200            0.0042943518  -0.0021017168   0              0.014984772    1.8743154e-13  0              1.8100797e-08  1.1965779e-13  0              3.8106895    
   2300000   6363.961       200            200            0.0042943516  -0.0021017168   0              0.014984772    9.1312314e-14  0              8.8182897e-09  1.1965779e-13  0              3.8106895    
   2400000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    2.7863968e-14  0              2.6909026e-09  1.1965779e-13  0              3.8106895    
   2500000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    3.6962643e-16  0              3.5695875e-11  1.1965779e-13  0              3.8106895    
   2600000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    2.6057138e-16  0              2.5164119e-11  1.1965779e-13  0              3.8106895    
   2700000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    6.0515304e-17  0              5.8441349e-12  1.1965779e-13  0              3.8106895    
   2800000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    6.3334122e-18  0              6.1163562e-13  1.1965779e-13  0              3.8106895    
   2900000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    2.0483749e-19  0              1.9781739e-14  1.1965779e-13  0              3.8106895    
   3000000   6363.961       200            200            0.0042943517  -0.0021017168   0              0.014984772    3.5957256e-18  0              3.4724945e-13  1.1965779e-13  0              3.8106895    
Loop time of 362.4 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7152323.024 ns/day, 0.000 hours/ns, 8278.152 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.514     | 115.93     | 144.03     | 253.7 | 31.99
Neigh   | 0.84045    | 0.85443    | 0.86852    |   1.1 |  0.24
Comm    | 22.97      | 49.55      | 77.542     | 375.3 | 13.67
Output  | 0.24396    | 0.24426    | 0.24458    |   0.1 |  0.07
Modify  | 105.06     | 140.78     | 174.32     | 282.3 | 38.85
Other   |            | 55.04      |            |       | 15.19

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         709.75 ave        1046 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2839
Ave neighs/atom = 1.1351459
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.64                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 115.073479408629
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.74
  ghost atom cutoff = 4.74
  binsize = 2.37, bins = 2686 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.66 | 33.67 | 33.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.6469871e-14  4.9409612e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068653783  4.9409612e-14  0             -0.0020596135   185034.88      0              1.7869345e+10  1.1965779e-13  0              4.1656662    
    200000   6363.961       200            200            0.00063390217  4.9409612e-14  0              0.0019017065   41732.312      0              4.030208e+09   1.1965779e-13  0              3.9303323    
    300000   6363.961       200            200           -0.00011967331  4.9409612e-14  0             -0.00035901992  2517.0343      0              2.4307716e+08  1.1965779e-13  0              3.8480237    
    400000   6363.961       200            200            0.0024826166  -0.0026414737   0              0.010089324    6561.0594      0              6.3362016e+08  1.1965779e-13  0              3.8163763    
    500000   6363.961       200            200            0.0019445057  -0.00087855273  0              0.0067120698   566.48852      0              54707407       1.1965779e-13  0              3.8171657    
    600000   6363.961       200            200            0.0049319864  -0.0020298528   0              0.016825812    120.32423      0              11620053       1.1965779e-13  0              3.8154459    
    700000   6363.961       200            200            0.0047357497  -0.0020870965   0              0.016294346    10.128191      0              978108.22      1.1965779e-13  0              3.8155047    
    800000   6363.961       200            200            0.0040801462  -0.0020731473   0              0.014313586    0.10074663     0              9729.3887      1.1965779e-13  0              3.8157928    
    900000   6363.961       200            200            0.0043302375  -0.0020990696   0              0.015089782    0.29498227     0              28487.276      1.1965779e-13  0              3.8156799    
   1000000   6363.961       200            200            0.004322364   -0.0020986577   0              0.01506575     0.025721162    0              2483.9658      1.1965779e-13  0              3.8156827    
   1100000   6363.961       200            200            0.0042911066  -0.0020964852   0              0.014969805    0.00016314172  0              15.75506       1.1965779e-13  0              3.8156968    
   1200000   6363.961       200            200            0.0043039542  -0.0020973664   0              0.015009229    0.00069772042  0              67.380844      1.1965779e-13  0              3.8156911    
   1300000   6363.961       200            200            0.0043033262  -0.0020973293   0              0.015007308    6.7710641e-05  0              6.539009       1.1965779e-13  0              3.8156913    
   1400000   6363.961       200            200            0.0043018308  -0.0020972249   0              0.015002717    2.113919e-07   0              0.020414717    1.1965779e-13  0              3.815692     
   1500000   6363.961       200            200            0.0043024789  -0.0020972693   0              0.015004706    1.6438965e-06  0              0.15875576     1.1965779e-13  0              3.8156917    
   1600000   6363.961       200            200            0.0043024363  -0.0020972666   0              0.015004575    1.7728722e-07  0              0.017121131    1.1965779e-13  0              3.8156917    
   1700000   6363.961       200            200            0.004302365   -0.0020972616   0              0.015004357    2.0077261e-10  0              1.9389181e-05  1.1965779e-13  0              3.8156918    
   1800000   6363.961       200            200            0.0043023976  -0.0020972639   0              0.015004457    3.8542915e-09  0              0.00037221989  1.1965779e-13  0              3.8156917    
   1900000   6363.961       200            200            0.0043023949  -0.0020972637   0              0.015004448    4.6133126e-10  0              4.4552071e-05  1.1965779e-13  0              3.8156917    
   2000000   6363.961       200            200            0.0043023915  -0.0020972635   0              0.015004438    7.5650003e-14  0              7.3057358e-09  1.1965779e-13  0              3.8156917    
   2100000   6363.961       200            200            0.0043023931  -0.0020972636   0              0.015004443    8.9874552e-12  0              8.6794409e-07  1.1965779e-13  0              3.8156917    
   2200000   6363.961       200            200            0.004302393   -0.0020972636   0              0.015004443    1.1933443e-12  0              1.1524465e-07  1.1965779e-13  0              3.8156917    
   2300000   6363.961       200            200            0.0043023928  -0.0020972636   0              0.015004442    5.2592419e-17  0              5.0789994e-12  1.1965779e-13  0              3.8156917    
   2400000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    2.0736484e-14  0              2.0025812e-09  1.1965779e-13  0              3.8156917    
   2500000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    3.021715e-15   0              2.9181561e-10  1.1965779e-13  0              3.8156917    
   2600000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    2.6865862e-19  0              2.5945127e-14  1.1965779e-13  0              3.8156917    
   2700000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    8.2448247e-18  0              7.9622616e-13  1.1965779e-13  0              3.8156917    
   2800000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    8.2837391e-20  0              7.9998423e-15  1.1965779e-13  0              3.8156917    
   2900000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    1.6937053e-19  0              1.6356594e-14  1.1965779e-13  0              3.8156917    
   3000000   6363.961       200            200            0.0043023929  -0.0020972636   0              0.015004442    7.0997911e-18  0              6.85647e-13    1.1965779e-13  0              3.8156917    
Loop time of 361.779 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7164603.720 ns/day, 0.000 hours/ns, 8292.365 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.399     | 115.86     | 143.37     | 253.4 | 32.03
Neigh   | 0.79647    | 0.80916    | 0.82193    |   1.0 |  0.22
Comm    | 22.434     | 49.292     | 77.019     | 378.6 | 13.62
Output  | 0.24474    | 0.24505    | 0.24537    |   0.1 |  0.07
Modify  | 105.32     | 140.55     | 174.49     | 285.1 | 38.85
Other   |            | 55.02      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         713.25 ave        1053 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2853
Ave neighs/atom = 1.1407437
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.65                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 115.819093594578
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.75
  ghost atom cutoff = 4.75
  binsize = 2.375, bins = 2680 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.62 | 33.63 | 33.63 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.7113903e-14  5.1341708e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068639603  5.1341708e-14  0             -0.0020591881   180907.85      0              1.7470785e+10  1.1965779e-13  0              4.173518     
    200000   6363.961       200            200            0.0006519087   5.1341708e-14  0              0.0019557261   43729.582      0              4.22309e+09    1.1965779e-13  0              3.9330143    
    300000   6363.961       200            200           -0.00010513639  5.1341708e-14  0             -0.00031540918  1909.0511      0              1.8436249e+08  1.1965779e-13  0              3.8536104    
    400000   6363.961       200            200            0.0011613615  -0.0012055992   0              0.0046896837   5991.6118      0              5.7862698e+08  1.1965779e-13  0              3.822469     
    500000   6363.961       200            200            0.0025652029  -0.00096543647  0              0.0086610451   758.31124      0              73232272       1.1965779e-13  0              3.8217775    
    600000   6363.961       200            200            0.0053501532  -0.0021050132   0              0.018155473    91.177381      0              8805258.8      1.1965779e-13  0              3.8202707    
    700000   6363.961       200            200            0.0045777686  -0.0020912945   0              0.0158246      14.909442      0              1439847.2      1.1965779e-13  0              3.8205752    
    800000   6363.961       200            200            0.0040854665  -0.0020688185   0              0.014325218    0.031934881    0              3084.0423      1.1965779e-13  0              3.8207966    
    900000   6363.961       200            200            0.0043635127  -0.0020981395   0              0.015188678    0.19963893     0              19279.699      1.1965779e-13  0              3.8206707    
   1000000   6363.961       200            200            0.0043196272  -0.0020952936   0              0.015054175    0.039548643    0              3819.3249      1.1965779e-13  0              3.8206894    
   1100000   6363.961       200            200            0.0042987566  -0.0020938181   0              0.014990088    0.00032615143  0              31.497371      1.1965779e-13  0              3.820699     
   1200000   6363.961       200            200            0.0043128832  -0.0020947931   0              0.015033443    0.00038755041  0              37.426845      1.1965779e-13  0              3.8206927    
   1300000   6363.961       200            200            0.0043101396  -0.0020946097   0              0.015025028    0.00010362879  0              10.007727      1.1965779e-13  0              3.8206939    
   1400000   6363.961       200            200            0.0043093147  -0.0020945509   0              0.015022495    1.8294348e-06  0              0.17667372     1.1965779e-13  0              3.8206943    
   1500000   6363.961       200            200            0.004310009   -0.0020945988   0              0.015024626    7.0509954e-07  0              0.068093466    1.1965779e-13  0              3.8206939    
   1600000   6363.961       200            200            0.004309847   -0.0020945879   0              0.015024129    2.6284217e-07  0              0.025383416    1.1965779e-13  0              3.820694     
   1700000   6363.961       200            200            0.0043098172  -0.0020945857   0              0.015024037    7.842899e-09   0              0.00075741105  1.1965779e-13  0              3.820694     
   1800000   6363.961       200            200            0.0043098507  -0.002094588    0              0.01502414     1.1728467e-09  0              0.00011326514  1.1965779e-13  0              3.820694     
   1900000   6363.961       200            200            0.0043098416  -0.0020945874   0              0.015024112    6.4568961e-10  0              6.2356081e-05  1.1965779e-13  0              3.820694     
   2000000   6363.961       200            200            0.0043098406  -0.0020945873   0              0.015024109    2.8976645e-11  0              2.798357e-06   1.1965779e-13  0              3.820694     
   2100000   6363.961       200            200            0.0043098422  -0.0020945874   0              0.015024114    1.7065846e-12  0              1.6480972e-07  1.1965779e-13  0              3.820694     
   2200000   6363.961       200            200            0.0043098417  -0.0020945874   0              0.015024113    1.5365042e-12  0              1.4838458e-07  1.1965779e-13  0              3.820694     
   2300000   6363.961       200            200            0.0043098417  -0.0020945874   0              0.015024113    9.7091275e-14  0              9.3763804e-09  1.1965779e-13  0              3.820694     
   2400000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    1.966618e-15   0              1.8992189e-10  1.1965779e-13  0              3.820694     
   2500000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    3.5588568e-15  0              3.4368892e-10  1.1965779e-13  0              3.820694     
   2600000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    2.6665628e-16  0              2.5751754e-11  1.1965779e-13  0              3.820694     
   2700000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    1.3404161e-17  0              1.294478e-12   1.1965779e-13  0              3.820694     
   2800000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    2.5794645e-18  0              2.4910622e-13  1.1965779e-13  0              3.820694     
   2900000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    6.9037316e-18  0              6.6671298e-13  1.1965779e-13  0              3.820694     
   3000000   6363.961       200            200            0.0043098418  -0.0020945874   0              0.015024113    1.8068099e-19  0              1.7448877e-14  1.1965779e-13  0              3.820694     
Loop time of 363.27 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7135191.067 ns/day, 0.000 hours/ns, 8258.323 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.139     | 116.19     | 144.66     | 256.0 | 31.99
Neigh   | 0.77112    | 0.7845     | 0.79724    |   1.1 |  0.22
Comm    | 22.916     | 49.788     | 78.456     | 377.9 | 13.71
Output  | 0.24483    | 0.24513    | 0.24547    |   0.1 |  0.07
Modify  | 105.37     | 141.22     | 175.43     | 283.7 | 38.88
Other   |            | 55.04      |            |       | 15.15

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         715.75 ave        1058 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2863
Ave neighs/atom = 1.1447421
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.66                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 116.567921629813
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.76
  ghost atom cutoff = 4.76
  binsize = 2.38, bins = 2674 85 85
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.57 | 33.58 | 33.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.7767005e-14  5.3301015e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068607475  5.3301015e-14  0             -0.0020582242   176829.67      0              1.7076943e+10  1.1965779e-13  0              4.1813351    
    200000   6363.961       200            200            0.00067002958  5.3301015e-14  0              0.0020100888   45771.568      0              4.4202904e+09  1.1965779e-13  0              3.93564      
    300000   6363.961       200            200           -9.0349473e-05  5.3301015e-14  0             -0.00027104842  1385.589       0              1.3381027e+08  1.1965779e-13  0              3.8591161    
    400000   6363.961       200            200            0.00033895131 -0.00031670472  0              0.0013335587   5155.4793      0              4.9787929e+08  1.1965779e-13  0              3.8284994    
    500000   6363.961       200            200            0.0033442164  -0.0011126068   0              0.011145256    909.94817      0              87876281       1.1965779e-13  0              3.82634      
    600000   6363.961       200            200            0.0057360948  -0.0020899391   0              0.019298224    55.113487      0              5322466.1      1.1965779e-13  0              3.8251259    
    700000   6363.961       200            200            0.0044044366  -0.0020798347   0              0.015293144    17.668412      0              1706288.8      1.1965779e-13  0              3.8256558    
    800000   6363.961       200            200            0.0041126808  -0.0020692206   0              0.014407263    0.42993609     0              41520.15       1.1965779e-13  0              3.82579      
    900000   6363.961       200            200            0.0043897624  -0.0020985162   0              0.015267803    0.087982106    0              8496.682       1.1965779e-13  0              3.8256643    
   1000000   6363.961       200            200            0.0043149538  -0.0020935583   0              0.01503842     0.043886139    0              4238.2092      1.1965779e-13  0              3.8256968    
   1100000   6363.961       200            200            0.0043076018  -0.0020930033   0              0.015015809    0.0021082918   0              203.60373      1.1965779e-13  0              3.8257004    
   1200000   6363.961       200            200            0.0043206821  -0.002093915    0              0.015055961    8.8568738e-05  0              8.5533348      1.1965779e-13  0              3.8256945    
   1300000   6363.961       200            200            0.0043163152  -0.0020936171   0              0.015042563    0.00010092634  0              9.7467432      1.1965779e-13  0              3.8256965    
   1400000   6363.961       200            200            0.0043163419  -0.0020936167   0              0.015042642    8.1193157e-06  0              0.7841054      1.1965779e-13  0              3.8256965    
   1500000   6363.961       200            200            0.0043169194  -0.0020936571   0              0.015044415    3.4605206e-08  0              0.0033419231   1.1965779e-13  0              3.8256962    
   1600000   6363.961       200            200            0.0043166791  -0.0020936406   0              0.015043678    2.1184038e-07  0              0.020458027    1.1965779e-13  0              3.8256963    
   1700000   6363.961       200            200            0.0043166998  -0.0020936419   0              0.015043741    2.6756483e-08  0              0.0025839496   1.1965779e-13  0              3.8256963    
   1800000   6363.961       200            200            0.0043167237  -0.0020936436   0              0.015043815    2.5149052e-11  0              2.4287155e-06  1.1965779e-13  0              3.8256963    
   1900000   6363.961       200            200            0.0043167111  -0.0020936427   0              0.015043776    3.99563e-10    0              3.8586934e-05  1.1965779e-13  0              3.8256963    
   2000000   6363.961       200            200            0.004316713   -0.0020936428   0              0.015043782    7.8647754e-11  0              7.5952371e-06  1.1965779e-13  0              3.8256963    
   2100000   6363.961       200            200            0.0043167139  -0.0020936429   0              0.015043785    8.8521007e-13  0              8.5487253e-08  1.1965779e-13  0              3.8256963    
   2200000   6363.961       200            200            0.0043167133  -0.0020936429   0              0.015043783    6.5521149e-13  0              6.3275636e-08  1.1965779e-13  0              3.8256963    
   2300000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    2.1038938e-13  0              2.03179e-08    1.1965779e-13  0              3.8256963    
   2400000   6363.961       200            200            0.0043167135  -0.0020936429   0              0.015043783    6.0887608e-15  0              5.8800894e-10  1.1965779e-13  0              3.8256963    
   2500000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    8.5856426e-16  0              8.291399e-11   1.1965779e-13  0              3.8256963    
   2600000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    5.195002e-16   0              5.016961e-11   1.1965779e-13  0              3.8256963    
   2700000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    6.384356e-17   0              6.1655541e-12  1.1965779e-13  0              3.8256963    
   2800000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    1.0755853e-17  0              1.0387233e-12  1.1965779e-13  0              3.8256963    
   2900000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    5.6584119e-18  0              5.4644892e-13  1.1965779e-13  0              3.8256963    
   3000000   6363.961       200            200            0.0043167134  -0.0020936429   0              0.015043783    1.1745157e-19  0              1.1342631e-14  1.1965779e-13  0              3.8256963    
Loop time of 362.748 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7145463.160 ns/day, 0.000 hours/ns, 8270.212 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.218     | 116.01     | 143.83     | 254.3 | 31.98
Neigh   | 0.77522    | 0.78765    | 0.80009    |   1.0 |  0.22
Comm    | 22.575     | 49.334     | 77.569     | 379.7 | 13.60
Output  | 0.24489    | 0.2452     | 0.24553    |   0.1 |  0.07
Modify  | 105.96     | 141.36     | 175.29     | 283.2 | 38.97
Other   |            | 55.01      |            |       | 15.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         719.25 ave        1065 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2877
Ave neighs/atom = 1.1503399
Neighbor list builds = 127
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.67                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 117.319970425835
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77
  ghost atom cutoff = 4.77
  binsize = 2.385, bins = 2669 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.1 | 33.1 | 33.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.8429108e-14  5.5287323e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068557453  5.5287323e-14  0             -0.0020567236   172800.25      0              1.6687811e+10  1.1965779e-13  0              4.1891175    
    200000   6363.961       200            200            0.00068826393  5.5287323e-14  0              0.0020647918   47858.139      0              4.6217965e+09  1.1965779e-13  0              3.9382094    
    300000   6363.961       200            200           -7.5314461e-05  5.5287323e-14  0             -0.00022594338  946.32993      0              91389771       1.1965779e-13  0              3.8645408    
    400000   6363.961       200            200           -6.6588155e-05  4.9608696e-06  0             -0.00020472533  4235.4389      0              4.0902838e+08  1.1965779e-13  0              3.8344457    
    500000   6363.961       200            200            0.0042527715  -0.0013735504   0              0.014131865    987.13738      0              95330663       1.1965779e-13  0              3.8308718    
    600000   6363.961       200            200            0.0060064096  -0.0021235823   0              0.020142811    22.407268      0              2163933.5      1.1965779e-13  0              3.8300225    
    700000   6363.961       200            200            0.0042360771  -0.0020409427   0              0.014749174    17.514608      0              1691435.5      1.1965779e-13  0              3.8307396    
    800000   6363.961       200            200            0.0041610374  -0.0020708805   0              0.014553993    1.1350439      0              109614.41      1.1965779e-13  0              3.8307739    
    900000   6363.961       200            200            0.0044072182  -0.0020981083   0              0.015319763    0.012260196    0              1184.002       1.1965779e-13  0              3.8306618    
   1000000   6363.961       200            200            0.0043106061  -0.0020916184   0              0.015023437    0.036415849    0              3516.782       1.1965779e-13  0              3.8307041    
   1100000   6363.961       200            200            0.0043179731  -0.0020920864   0              0.015046006    0.0044031295   0              425.22273      1.1965779e-13  0              3.8307012    
   1200000   6363.961       200            200            0.0043278285  -0.0020927823   0              0.015076268    6.43677e-06    0              0.62161717     1.1965779e-13  0              3.8306967    
   1300000   6363.961       200            200            0.0043226411  -0.002092424    0              0.015060347    6.1833013e-05  0              5.9713898      1.1965779e-13  0              3.830699     
   1400000   6363.961       200            200            0.0043235222  -0.0020924831   0              0.01506305     1.3623347e-05  0              1.3156453      1.1965779e-13  0              3.8306986    
   1500000   6363.961       200            200            0.004323846   -0.0020925062   0              0.015064044    2.6238491e-07  0              0.025339257    1.1965779e-13  0              3.8306985    
   1600000   6363.961       200            200            0.0043235894  -0.0020924884   0              0.015063256    7.7989697e-08  0              0.0075316867   1.1965779e-13  0              3.8306986    
   1700000   6363.961       200            200            0.004323655   -0.0020924929   0              0.015063458    3.5333226e-08  0              0.0034122301   1.1965779e-13  0              3.8306986    
   1800000   6363.961       200            200            0.0043236616  -0.0020924934   0              0.015063478    1.7995556e-09  0              0.0001737882   1.1965779e-13  0              3.8306986    
   1900000   6363.961       200            200            0.00432365    -0.0020924926   0              0.015063442    5.2794782e-11  0              5.0985422e-06  1.1965779e-13  0              3.8306986    
   2000000   6363.961       200            200            0.004323654   -0.0020924929   0              0.015063455    7.765303e-11   0              7.4991738e-06  1.1965779e-13  0              3.8306986    
   2100000   6363.961       200            200            0.0043236539  -0.0020924928   0              0.015063454    7.6945611e-12  0              7.4308564e-07  1.1965779e-13  0              3.8306986    
   2200000   6363.961       200            200            0.0043236534  -0.0020924928   0              0.015063453    3.9742238e-17  0              3.8380209e-12  1.1965779e-13  0              3.8306986    
   2300000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    1.4170761e-13  0              1.3685107e-08  1.1965779e-13  0              3.8306986    
   2400000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    2.5318846e-14  0              2.4451129e-09  1.1965779e-13  0              3.8306986    
   2500000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    2.9502616e-16  0              2.8491515e-11  1.1965779e-13  0              3.8306986    
   2600000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    2.2245708e-16  0              2.1483313e-11  1.1965779e-13  0              3.8306986    
   2700000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    5.2614113e-17  0              5.0810945e-12  1.1965779e-13  0              3.8306986    
   2800000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    3.7545009e-18  0              3.6258282e-13  1.1965779e-13  0              3.8306986    
   2900000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    2.6178237e-18  0              2.5281067e-13  1.1965779e-13  0              3.8306986    
   3000000   6363.961       200            200            0.0043236536  -0.0020924928   0              0.015063454    9.0410745e-19  0              8.7312227e-14  1.1965779e-13  0              3.8306986    
Loop time of 362.9 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7142459.299 ns/day, 0.000 hours/ns, 8266.735 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.167     | 116.18     | 143.95     | 254.2 | 32.01
Neigh   | 0.789      | 0.80293    | 0.81669    |   1.1 |  0.22
Comm    | 22.588     | 49.366     | 77.633     | 379.9 | 13.60
Output  | 0.24401    | 0.24431    | 0.24465    |   0.1 |  0.07
Modify  | 106.03     | 141.31     | 175.37     | 284.6 | 38.94
Other   |            | 55         |            |       | 15.16

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         721.75 ave        1070 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2887
Ave neighs/atom = 1.1543383
Neighbor list builds = 131
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.68                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 118.07524689415
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.78
  ghost atom cutoff = 4.78
  binsize = 2.39, bins = 2663 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 33.04 | 33.04 | 33.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.9100142e-14  5.7300427e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068489592  5.7300427e-14  0             -0.0020546878   168819.52      0              1.6303381e+10  1.1965779e-13  0              4.196865     
    200000   6363.961       200            200            0.00070661079  5.7300427e-14  0              0.0021198324   49989.161      0              4.8275954e+09  1.1965779e-13  0              3.9407223    
    300000   6363.961       200            200           -6.0033337e-05  5.7300427e-14  0             -0.00018010001  590.95817      0              57070510       1.1965779e-13  0              3.869884     
    400000   6363.961       200            200           -0.00013680293  5.7300427e-14  0             -0.00041040879  3361.4018      0              3.2462013e+08  1.1965779e-13  0              3.8402977    
    500000   6363.961       200            200            0.0052628588  -0.0017259971   0              0.017514574    964.94787      0              93187759       1.1965779e-13  0              3.8353956    
    600000   6363.961       200            200            0.0061479156  -0.0021555309   0              0.020599278    2.8097574      0              271346.26      1.1965779e-13  0              3.8349689    
    700000   6363.961       200            200            0.0040673494  -0.0020380826   0              0.014240131    14.542999      0              1404458.7      1.1965779e-13  0              3.8358197    
    800000   6363.961       200            200            0.0042268068  -0.0020729207   0              0.014753341    1.8657531      0              180181.08      1.1965779e-13  0              3.8357501    
    900000   6363.961       200            200            0.0044149442  -0.0020956287   0              0.015340461    0.0077860883   0              751.92467      1.1965779e-13  0              3.8356638    
   1000000   6363.961       200            200            0.0043085478  -0.0020884248   0              0.015014068    0.021187225    0              2046.1105      1.1965779e-13  0              3.8357106    
   1100000   6363.961       200            200            0.0043297132  -0.0020898617   0              0.015079001    0.0057954236   0              559.68053      1.1965779e-13  0              3.8357015    
   1200000   6363.961       200            200            0.0043346751  -0.0020902208   0              0.015094246    0.00019562722  0              18.892277      1.1965779e-13  0              3.8356992    
   1300000   6363.961       200            200            0.0043296323  -0.0020898704   0              0.015078767    1.6681254e-05  0              1.6109561      1.1965779e-13  0              3.8357015    
   1400000   6363.961       200            200            0.0043311907  -0.0020899769   0              0.015083549    1.3603814e-05  0              1.313759       1.1965779e-13  0              3.8357008    
   1500000   6363.961       200            200            0.0043311821  -0.0020899771   0              0.015083523    1.1625388e-06  0              0.11226968     1.1965779e-13  0              3.8357008    
   1600000   6363.961       200            200            0.0043309759  -0.0020899627   0              0.01508289     4.3931569e-10  0              4.2425965e-05  1.1965779e-13  0              3.8357009    
   1700000   6363.961       200            200            0.0043310681  -0.002089969    0              0.015083173    2.3889421e-08  0              0.0023070692   1.1965779e-13  0              3.8357008    
   1800000   6363.961       200            200            0.0043310552  -0.0020899682   0              0.015083134    4.2805206e-09  0              0.00041338204  1.1965779e-13  0              3.8357008    
   1900000   6363.961       200            200            0.0043310485  -0.0020899677   0              0.015083113    6.4973601e-11  0              6.2746853e-06  1.1965779e-13  0              3.8357008    
   2000000   6363.961       200            200            0.0043310532  -0.002089968    0              0.015083128    2.7644178e-11  0              2.6696768e-06  1.1965779e-13  0              3.8357008    
   2100000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    1.161707e-11   0              1.1218935e-06  1.1965779e-13  0              3.8357008    
   2200000   6363.961       200            200            0.0043310519  -0.0020899679   0              0.015083124    6.3394369e-13  0              6.1221744e-08  1.1965779e-13  0              3.8357008    
   2300000   6363.961       200            200            0.0043310521  -0.002089968    0              0.015083124    1.1712408e-14  0              1.1311005e-09  1.1965779e-13  0              3.8357008    
   2400000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    2.3860373e-14  0              2.304264e-09   1.1965779e-13  0              3.8357008    
   2500000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    2.92739e-15    0              2.8270637e-10  1.1965779e-13  0              3.8357008    
   2600000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    6.6743548e-18  0              6.4456141e-13  1.1965779e-13  0              3.8357008    
   2700000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    2.8045366e-18  0              2.7084207e-13  1.1965779e-13  0              3.8357008    
   2800000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    1.0563375e-19  0              1.0201351e-14  1.1965779e-13  0              3.8357008    
   2900000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    3.483417e-18   0              3.3640348e-13  1.1965779e-13  0              3.8357008    
   3000000   6363.961       200            200            0.004331052   -0.0020899679   0              0.015083124    2.4360454e-18  0              2.3525583e-13  1.1965779e-13  0              3.8357008    
Loop time of 363.476 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7131146.067 ns/day, 0.000 hours/ns, 8253.641 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.315     | 116.14     | 143.88     | 256.0 | 31.95
Neigh   | 0.79846    | 0.81196    | 0.82623    |   1.2 |  0.22
Comm    | 22.323     | 49.559     | 77.472     | 381.9 | 13.63
Output  | 0.24424    | 0.24454    | 0.24486    |   0.1 |  0.07
Modify  | 105.68     | 141.22     | 175.45     | 288.2 | 38.85
Other   |            | 55.5       |            |       | 15.27

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         725.25 ave        1077 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2901
Ave neighs/atom = 1.159936
Neighbor list builds = 131
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.69                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 118.833757946262
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.79
  ghost atom cutoff = 4.79
  binsize = 2.395, bins = 2658 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.99 | 33 | 33.01 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            1.9780044e-14  5.9340132e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006840395   5.9340132e-14  0             -0.0020521185   164887.39      0              1.5923644e+10  1.1965779e-13  0              4.2045776    
    200000   6363.961       200            200            0.00072506928  5.9340132e-14  0              0.0021752078   52164.506      0              5.0376746e+09  1.1965779e-13  0              3.9431785    
    300000   6363.961       200            200           -4.4507961e-05  5.9340132e-14  0             -0.00013352388  319.15581      0              30821783       1.1965779e-13  0              3.8751458    
    400000   6363.961       200            200           -0.00012116355  5.9340132e-14  0             -0.00036349066  2586.8904      0              2.4982335e+08  1.1965779e-13  0              3.8460527    
    500000   6363.961       200            200            0.0064034737  -0.0019071316   0              0.021117553    837.41835      0              80871870       1.1965779e-13  0              3.8399374    
    600000   6363.961       200            200            0.0061549936  -0.0021532233   0              0.020618204    2.2786958      0              220060.13      1.1965779e-13  0              3.8399696    
    700000   6363.961       200            200            0.0039220716  -0.0020424093   0              0.013808624    9.7673168      0              943257.54      1.1965779e-13  0              3.8408896    
    800000   6363.961       200            200            0.0043044749  -0.0020743324   0              0.014987757    2.328764       0              224895.36      1.1965779e-13  0              3.8407213    
    900000   6363.961       200            200            0.0044132029  -0.0020900647   0              0.015329673    0.076165143    0              7355.4844      1.1965779e-13  0              3.8406702    
   1000000   6363.961       200            200            0.0043104356  -0.0020830658   0              0.015014373    0.0064085753   0              618.89433      1.1965779e-13  0              3.8407158    
   1100000   6363.961       200            200            0.0043424679  -0.0020852617   0              0.015112665    0.0054295103   0              524.34325      1.1965779e-13  0              3.8407017    
   1200000   6363.961       200            200            0.0043416601  -0.0020852233   0              0.015110204    0.00052268823  0              50.477488      1.1965779e-13  0              3.840702     
   1300000   6363.961       200            200            0.0043377101  -0.0020849475   0              0.015098078    2.6521556e-07  0              0.02561262     1.1965779e-13  0              3.8407038    
   1400000   6363.961       200            200            0.004339624   -0.0020850788   0              0.015103951    8.0975047e-06  0              0.78199904     1.1965779e-13  0              3.8407029    
   1500000   6363.961       200            200            0.0043392819  -0.002085056    0              0.015102902    1.8754569e-06  0              0.1811182      1.1965779e-13  0              3.8407031    
   1600000   6363.961       200            200            0.0043391803  -0.0020850487   0              0.015102589    5.8652871e-08  0              0.0056642745   1.1965779e-13  0              3.8407031    
   1700000   6363.961       200            200            0.0043392728  -0.0020850551   0              0.015102874    5.4631523e-09  0              0.00052759214  1.1965779e-13  0              3.8407031    
   1800000   6363.961       200            200            0.0043392442  -0.0020850532   0              0.015102786    4.4098917e-09  0              0.00042587577  1.1965779e-13  0              3.8407031    
   1900000   6363.961       200            200            0.0043392448  -0.0020850532   0              0.015102788    4.1527344e-10  0              4.0104136e-05  1.1965779e-13  0              3.8407031    
   2000000   6363.961       200            200            0.0043392484  -0.0020850534   0              0.015102799    1.3041736e-13  0              1.2594775e-08  1.1965779e-13  0              3.8407031    
   2100000   6363.961       200            200            0.0043392467  -0.0020850533   0              0.015102793    6.6633205e-12  0              6.434958e-07   1.1965779e-13  0              3.8407031    
   2200000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    1.5079281e-12  0              1.4562491e-07  1.1965779e-13  0              3.8407031    
   2300000   6363.961       200            200            0.0043392471  -0.0020850534   0              0.015102795    4.5283964e-14  0              4.3732011e-09  1.1965779e-13  0              3.8407031    
   2400000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    4.4903599e-15  0              4.3364682e-10  1.1965779e-13  0              3.8407031    
   2500000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    3.6077205e-15  0              3.4840782e-10  1.1965779e-13  0              3.8407031    
   2600000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    3.0953527e-16  0              2.9892701e-11  1.1965779e-13  0              3.8407031    
   2700000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    2.5426204e-17  0              2.4554808e-12  1.1965779e-13  0              3.8407031    
   2800000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    6.2399407e-18  0              6.0260881e-13  1.1965779e-13  0              3.8407031    
   2900000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    5.3447892e-18  0              5.1616148e-13  1.1965779e-13  0              3.8407031    
   3000000   6363.961       200            200            0.004339247   -0.0020850533   0              0.015102794    9.9105988e-19  0              9.5709469e-14  1.1965779e-13  0              3.8407031    
Loop time of 363.995 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7120985.143 ns/day, 0.000 hours/ns, 8241.881 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.545     | 116.74     | 144.73     | 256.6 | 32.07
Neigh   | 0.80791    | 0.82149    | 0.83498    |   1.1 |  0.23
Comm    | 22.529     | 49.848     | 78.248     | 383.9 | 13.69
Output  | 0.24467    | 0.24498    | 0.24532    |   0.1 |  0.07
Modify  | 105.68     | 140.94     | 175.26     | 286.2 | 38.72
Other   |            | 55.4       |            |       | 15.22

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         727.25 ave        1081 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2909
Ave neighs/atom = 1.1631347
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.7                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 119.595510493673
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.8
  ghost atom cutoff = 4.8
  binsize = 2.4, bins = 2652 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.95 | 32.95 | 32.96 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.046875e-14   6.1406251e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006830058   6.1406251e-14  0             -0.0020490174   161003.78      0              1.5548592e+10  1.1965779e-13  0              4.2122552    
    200000   6363.961       200            200            0.00074363847  6.1406251e-14  0              0.0022309154   54384.042      0              5.2520215e+09  1.1965779e-13  0              3.9455779    
    300000   6363.961       200            200           -2.874031e-05   6.1406251e-14  0             -8.622093e-05   130.60824      0              12613209       1.1965779e-13  0              3.8803257    
    400000   6363.961       200            200           -0.000105228    6.1406251e-14  0             -0.00031568399  1914.6273      0              1.84901e+08    1.1965779e-13  0              3.8517105    
    500000   6363.961       200            200            0.0074938409  -0.0021739965   0              0.024655519    624.78132      0              60336908       1.1965779e-13  0              3.8445248    
    600000   6363.961       200            200            0.0060175748  -0.00214435     0              0.020197074    20.880127      0              2016453.2      1.1965779e-13  0              3.8450247    
    700000   6363.961       200            200            0.0038216196  -0.002024015    0              0.013488874    4.7587318      0              459564.25      1.1965779e-13  0              3.8459437    
    800000   6363.961       200            200            0.0043871377  -0.0020742116   0              0.015235625    2.3358332      0              225578.05      1.1965779e-13  0              3.8456908    
    900000   6363.961       200            200            0.0044030436  -0.0020819695   0              0.0152911      0.18450363     0              17818.04       1.1965779e-13  0              3.8456807    
   1000000   6363.961       200            200            0.0043169977  -0.0020760744   0              0.015027067    1.2309859e-05  0              1.1887981      1.1965779e-13  0              3.8457191    
   1100000   6363.961       200            200            0.0043553506  -0.0020787006   0              0.015144752    0.0035328322   0              341.17565      1.1965779e-13  0              3.8457022    
   1200000   6363.961       200            200            0.0043488472  -0.0020782734   0              0.015124815    0.0007595836   0              73.355147      1.1965779e-13  0              3.845705     
   1300000   6363.961       200            200            0.0043467424  -0.0020781242   0              0.015118351    2.4938887e-05  0              2.4084192      1.1965779e-13  0              3.8457059    
   1400000   6363.961       200            200            0.0043486121  -0.0020782523   0              0.015124089    1.8441473e-06  0              0.17809454     1.1965779e-13  0              3.8457051    
   1500000   6363.961       200            200            0.0043480137  -0.002078212    0              0.015122253    1.7258536e-06  0              0.16667059     1.1965779e-13  0              3.8457054    
   1600000   6363.961       200            200            0.004348044   -0.0020782138   0              0.015122346    1.9079241e-07  0              0.018425365    1.1965779e-13  0              3.8457054    
   1700000   6363.961       200            200            0.0043481103  -0.0020782184   0              0.015122549    8.429461e-10   0              8.1405701e-05  1.1965779e-13  0              3.8457053    
   1800000   6363.961       200            200            0.0043480749  -0.002078216    0              0.015122441    2.0401875e-09  0              0.0001970267   1.1965779e-13  0              3.8457053    
   1900000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    6.3622785e-10  0              6.1442332e-05  1.1965779e-13  0              3.8457053    
   2000000   6363.961       200            200            0.0043480838  -0.0020782166   0              0.015122468    3.3795023e-11  0              3.2636815e-06  1.1965779e-13  0              3.8457053    
   2100000   6363.961       200            200            0.0043480822  -0.0020782165   0              0.015122463    4.3136278e-13  0              4.165793e-08   1.1965779e-13  0              3.8457053    
   2200000   6363.961       200            200            0.0043480828  -0.0020782165   0              0.015122465    1.1957314e-12  0              1.1547518e-07  1.1965779e-13  0              3.8457053    
   2300000   6363.961       200            200            0.0043480828  -0.0020782165   0              0.015122465    1.822628e-13   0              1.7601636e-08  1.1965779e-13  0              3.8457053    
   2400000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    2.9019162e-15  0              2.802463e-10   1.1965779e-13  0              3.8457053    
   2500000   6363.961       200            200            0.0043480828  -0.0020782165   0              0.015122465    1.0989053e-15  0              1.061244e-10   1.1965779e-13  0              3.8457053    
   2600000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    5.071666e-16   0              4.8978521e-11  1.1965779e-13  0              3.8457053    
   2700000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    7.0578176e-17  0              6.815935e-12   1.1965779e-13  0              3.8457053    
   2800000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    9.3249459e-18  0              9.0053653e-13  1.1965779e-13  0              3.8457053    
   2900000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    5.5919116e-18  0              5.400268e-13   1.1965779e-13  0              3.8457053    
   3000000   6363.961       200            200            0.0043480827  -0.0020782165   0              0.015122465    3.2064817e-18  0              3.0965905e-13  1.1965779e-13  0              3.8457053    
Loop time of 363.355 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7133521.044 ns/day, 0.000 hours/ns, 8256.390 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.456     | 116.68     | 144.84     | 258.6 | 32.11
Neigh   | 0.82153    | 0.83617    | 0.85014    |   1.2 |  0.23
Comm    | 22.374     | 49.901     | 78.282     | 385.0 | 13.73
Output  | 0.242      | 0.2423     | 0.24263    |   0.1 |  0.07
Modify  | 105.38     | 140.57     | 174.41     | 285.0 | 38.69
Other   |            | 55.12      |            |       | 15.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         729.75 ave        1086 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2919
Ave neighs/atom = 1.1671331
Neighbor list builds = 135
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.71                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 120.360511447888
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.81
  ghost atom cutoff = 4.81
  binsize = 2.405, bins = 2647 84 84
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.92 | 32.92 | 32.93 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.1166201e-14  6.3498602e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068179538  6.3498602e-14  0             -0.0020453862   157168.6       0              1.5178218e+10  1.1965779e-13  0              4.2198978    
    200000   6363.961       200            200            0.00076231745  6.3498602e-14  0              0.0022869524   56647.637      0              5.4706233e+09  1.1965779e-13  0              3.9479202    
    300000   6363.961       200            200           -1.2732296e-05  6.3498602e-14  0             -3.8196889e-05  25.000111      0              2414331.8      1.1965779e-13  0              3.8854237    
    400000   6363.961       200            200           -8.8998905e-05  6.3498602e-14  0             -0.00026699671  1344.138       0              1.2980723e+08  1.1965779e-13  0              3.8572709    
    500000   6363.961       200            200            0.0084455146  -0.0024521045   0              0.027788648    374.42014      0              36158817       1.1965779e-13  0              3.8491852    
    600000   6363.961       200            200            0.0057406415  -0.0021592287   0              0.019381153    52.731408      0              5092421.9      1.1965779e-13  0              3.8501301    
    700000   6363.961       200            200            0.0037566272  -0.0020351565   0              0.013305038    1.1279321      0              108927.61      1.1965779e-13  0              3.8509777    
    800000   6363.961       200            200            0.0044670712  -0.0020720526   0              0.015473266    1.8814328      0              181695.31      1.1965779e-13  0              3.8506618    
    900000   6363.961       200            200            0.0043867082  -0.0020717816   0              0.015231906    0.28105818     0              27142.588      1.1965779e-13  0              3.8506941    
   1000000   6363.961       200            200            0.0043284693  -0.0020677456   0              0.015053154    0.0053789806   0              519.46344      1.1965779e-13  0              3.8507204    
   1100000   6363.961       200            200            0.0043676165  -0.0020704129   0              0.015173262    0.0012735202   0              122.98746      1.1965779e-13  0              3.8507032    
   1200000   6363.961       200            200            0.0043564427  -0.0020696716   0              0.015139       0.00074196423  0              71.653595      1.1965779e-13  0              3.850708     
   1300000   6363.961       200            200            0.0043565964  -0.0020696758   0              0.015139465    7.1225318e-05  0              6.8784314      1.1965779e-13  0              3.850708     
   1400000   6363.961       200            200            0.0043580273  -0.002069774    0              0.015143856    1.8794659e-07  0              0.018150536    1.1965779e-13  0              3.8507073    
   1500000   6363.961       200            200            0.0043573108  -0.0020697257   0              0.015141658    8.5849368e-07  0              0.082907175    1.1965779e-13  0              3.8507077    
   1600000   6363.961       200            200            0.0043574664  -0.002069736    0              0.015142135    2.591218e-07   0              0.025024129    1.1965779e-13  0              3.8507076    
   1700000   6363.961       200            200            0.0043574873  -0.0020697375   0              0.015142199    1.5054215e-08  0              0.0014538283   1.1965779e-13  0              3.8507076    
   1800000   6363.961       200            200            0.0043574561  -0.0020697354   0              0.015142104    7.9748434e-11  0              7.7015329e-06  1.1965779e-13  0              3.8507076    
   1900000   6363.961       200            200            0.0043574685  -0.0020697362   0              0.015142142    4.359069e-10   0              4.2096768e-05  1.1965779e-13  0              3.8507076    
   2000000   6363.961       200            200            0.0043574667  -0.0020697361   0              0.015142136    8.0109812e-11  0              7.7364323e-06  1.1965779e-13  0              3.8507076    
   2100000   6363.961       200            200            0.0043574659  -0.002069736    0              0.015142134    2.3686879e-12  0              2.2875092e-07  1.1965779e-13  0              3.8507076    
   2200000   6363.961       200            200            0.0043574665  -0.0020697361   0              0.015142136    2.0947751e-13  0              2.0229838e-08  1.1965779e-13  0              3.8507076    
   2300000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    1.8487377e-13  0              1.7853786e-08  1.1965779e-13  0              3.8507076    
   2400000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    2.1751111e-14  0              2.1005666e-09  1.1965779e-13  0              3.8507076    
   2500000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    1.8286431e-16  0              1.7659727e-11  1.1965779e-13  0              3.8507076    
   2600000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    2.0450362e-16  0              1.9749496e-11  1.1965779e-13  0              3.8507076    
   2700000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    4.5609328e-17  0              4.4046225e-12  1.1965779e-13  0              3.8507076    
   2800000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    1.0579205e-18  0              1.0216639e-13  1.1965779e-13  0              3.8507076    
   2900000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    5.2209521e-18  0              5.0420219e-13  1.1965779e-13  0              3.8507076    
   3000000   6363.961       200            200            0.0043574663  -0.002069736    0              0.015142135    9.3920193e-19  0              9.07014e-14    1.1965779e-13  0              3.8507076    
Loop time of 363.263 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7135322.285 ns/day, 0.000 hours/ns, 8258.475 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.217     | 116.52     | 144.79     | 258.1 | 32.08
Neigh   | 0.80928    | 0.82274    | 0.8361     |   1.1 |  0.23
Comm    | 22.688     | 49.921     | 78.723     | 384.4 | 13.74
Output  | 0.24373    | 0.24403    | 0.24435    |   0.1 |  0.07
Modify  | 105.63     | 140.89     | 174.56     | 283.6 | 38.79
Other   |            | 54.86      |            |       | 15.10

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         731.75 ave        1090 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2927
Ave neighs/atom = 1.1703319
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.72                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 121.12876772041
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.82
  ghost atom cutoff = 4.82
  binsize = 2.41, bins = 2641 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.44 | 32.44 | 32.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.1872338e-14  6.5617014e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00068040881  6.5617014e-14  0             -0.0020412264   153381.78      0              1.4812514e+10  1.1965779e-13  0              4.2275052    
    200000   6363.961       200            200            0.00078110526  6.5617014e-14  0              0.0023433158   58955.156      0              5.693467e+09   1.1965779e-13  0              3.9502055    
    300000   6363.961       200            200            3.5141352e-06  6.5617014e-14  0              1.0542406e-05  2.0170243      0              194789.77      1.1965779e-13  0              3.8904395    
    400000   6363.961       200            200           -7.2478956e-05  6.5617014e-14  0             -0.00021743687  874.95101      0              84496505       1.1965779e-13  0              3.8627336    
    500000   6363.961       200            200            0.0091507866  -0.0026902486   0              0.030142608    151.28989      0              14610495       1.1965779e-13  0              3.8539429    
    600000   6363.961       200            200            0.0053645005  -0.0021644626   0              0.018257964    88.028631      0              8501175.1      1.1965779e-13  0              3.8552777    
    700000   6363.961       200            200            0.0037455334  -0.0020340243   0              0.013270624    0.01988579     0              1920.4272      1.1965779e-13  0              3.8559891    
    800000   6363.961       200            200            0.0045367191  -0.0020675338   0              0.015677691    1.1478631      0              110852.4       1.1965779e-13  0              3.8556376    
    900000   6363.961       200            200            0.0043667169  -0.0020616516   0              0.015161802    0.31985509     0              30889.315      1.1965779e-13  0              3.8557092    
   1000000   6363.961       200            200            0.0043439259  -0.0020599932   0              0.015091771    0.019517695    0              1884.8793      1.1965779e-13  0              3.85572      
   1100000   6363.961       200            200            0.0043781494  -0.0020623147   0              0.015196763    3.9177028e-05  0              3.7834369      1.1965779e-13  0              3.8557048    
   1200000   6363.961       200            200            0.0043641237  -0.0020613842   0              0.015153755    0.00048258794  0              46.604889      1.1965779e-13  0              3.855711     
   1300000   6363.961       200            200            0.0043665282  -0.0020615397   0              0.015161124    0.00010306564  0              9.9533413      1.1965779e-13  0              3.8557099    
   1400000   6363.961       200            200            0.0043672144  -0.0020615877   0              0.015163231    4.495697e-06   0              0.43416224     1.1965779e-13  0              3.8557096    
   1500000   6363.961       200            200            0.004366547   -0.0020615427   0              0.015161184    9.4248026e-08  0              0.0091017998   1.1965779e-13  0              3.8557099    
   1600000   6363.961       200            200            0.0043667885  -0.0020615588   0              0.015161924    1.9306615e-07  0              0.018644946    1.1965779e-13  0              3.8557098    
   1700000   6363.961       200            200            0.0043667576  -0.0020615568   0              0.01516183     3.1875243e-08  0              0.0030782828   1.1965779e-13  0              3.8557098    
   1800000   6363.961       200            200            0.0043667405  -0.0020615556   0              0.015161777    9.0837782e-10  0              8.7724628e-05  1.1965779e-13  0              3.8557098    
   1900000   6363.961       200            200            0.0043667532  -0.0020615565   0              0.015161816    8.0579971e-11  0              7.7818369e-06  1.1965779e-13  0              3.8557098    
   2000000   6363.961       200            200            0.0043667492  -0.0020615562   0              0.015161804    7.3186337e-11  0              7.0678126e-06  1.1965779e-13  0              3.8557098    
   2100000   6363.961       200            200            0.0043667495  -0.0020615562   0              0.015161805    9.4352043e-12  0              9.1118449e-07  1.1965779e-13  0              3.8557098    
   2200000   6363.961       200            200            0.0043667499  -0.0020615563   0              0.015161806    1.4720143e-13  0              1.421566e-08   1.1965779e-13  0              3.8557098    
   2300000   6363.961       200            200            0.0043667496  -0.0020615562   0              0.015161805    4.9286863e-14  0              4.7597724e-09  1.1965779e-13  0              3.8557098    
   2400000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    2.6615165e-14  0              2.5703022e-09  1.1965779e-13  0              3.8557098    
   2500000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    2.6689911e-15  0              2.5775206e-10  1.1965779e-13  0              3.8557098    
   2600000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    6.7848895e-18  0              6.5523607e-13  1.1965779e-13  0              3.8557098    
   2700000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    7.6432949e-19  0              7.3813471e-14  1.1965779e-13  0              3.8557098    
   2800000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    7.0130212e-19  0              6.7726739e-14  1.1965779e-13  0              3.8557098    
   2900000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    2.1330487e-18  0              2.0599458e-13  1.1965779e-13  0              3.8557098    
   3000000   6363.961       200            200            0.0043667497  -0.0020615563   0              0.015161805    4.2831612e-18  0              4.1363705e-13  1.1965779e-13  0              3.8557098    
Loop time of 364.847 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7104348.895 ns/day, 0.000 hours/ns, 8222.626 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.254     | 116.87     | 145.32     | 260.0 | 32.03
Neigh   | 0.80797    | 0.82291    | 0.83667    |   1.2 |  0.23
Comm    | 22.702     | 50.207     | 79.033     | 385.9 | 13.76
Output  | 0.24141    | 0.24172    | 0.24207    |   0.1 |  0.07
Modify  | 105.36     | 141.32     | 176.4      | 288.7 | 38.73
Other   |            | 55.39      |            |       | 15.18

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         734.75 ave        1096 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2939
Ave neighs/atom = 1.1751299
Neighbor list builds = 137
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.73                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 121.900286222745
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.83
  ghost atom cutoff = 4.83
  binsize = 2.415, bins = 2636 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.38 | 32.38 | 32.39 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.2587106e-14  6.7761317e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067884663  6.7761317e-14  0             -0.0020365399   149643.23      0              1.4451472e+10  1.1965779e-13  0              4.2350774    
    200000   6363.961       200            200            0.00080000097  6.7761317e-14  0              0.0024000029   61306.467      0              5.9205397e+09  1.1965779e-13  0              3.9524335    
    300000   6363.961       200            200            1.9996993e-05  6.7761317e-14  0              5.999098e-05   61.344551      0              5924217.7      1.1965779e-13  0              3.8953729    
    400000   6363.961       200            200           -5.5670909e-05  6.7761317e-14  0             -0.00016701273  506.59779      0              48923588       1.1965779e-13  0              3.8680985    
    500000   6363.961       200            200            0.0095298221  -0.0028240129   0              0.031413479    18.673661      0              1803368.5      1.1965779e-13  0              3.8588166    
    600000   6363.961       200            200            0.0049501813  -0.0020905048   0              0.016941049    116.35568      0              11236798       1.1965779e-13  0              3.8604563    
    700000   6363.961       200            200            0.0037873901  -0.0020274886   0              0.013389659    1.7691975      0              170856.43      1.1965779e-13  0              3.8609771    
    800000   6363.961       200            200            0.0045891173  -0.0020611298   0              0.015828482    0.43340261     0              41854.922      1.1965779e-13  0              3.8606212    
    900000   6363.961       200            200            0.0043469318  -0.0020510268   0              0.015091822    0.28250413     0              27282.227      1.1965779e-13  0              3.8607243    
   1000000   6363.961       200            200            0.0043627794  -0.0020519647   0              0.015140303    0.034683067    0              3349.4424      1.1965779e-13  0              3.8607181    
   1100000   6363.961       200            200            0.0043870073  -0.0020536033   0              0.015214625    0.00058083851  0              56.093226      1.1965779e-13  0              3.8607073    
   1200000   6363.961       200            200            0.0043724452  -0.0020526414   0              0.015169977    0.00016168711  0              15.614584      1.1965779e-13  0              3.8607137    
   1300000   6363.961       200            200            0.0043766686  -0.002052917    0              0.015182923    9.5779078e-05  0              9.2496578      1.1965779e-13  0              3.8607119    
   1400000   6363.961       200            200            0.0043764586  -0.0020529053   0              0.015182281    1.1014873e-05  0              1.0637376      1.1965779e-13  0              3.8607119    
   1500000   6363.961       200            200            0.0043759974  -0.0020528742   0              0.015180866    1.5038808e-07  0              0.014523404    1.1965779e-13  0              3.8607121    
   1600000   6363.961       200            200            0.0043762629  -0.0020528918   0              0.01518168     6.1426075e-08  0              0.0059320906   1.1965779e-13  0              3.860712     
   1700000   6363.961       200            200            0.0043761885  -0.002052887    0              0.015181452    3.2296759e-08  0              0.0031189898   1.1965779e-13  0              3.8607121    
   1800000   6363.961       200            200            0.004376191   -0.0020528871   0              0.01518146     3.482773e-09   0              0.00033634129  1.1965779e-13  0              3.8607121    
   1900000   6363.961       200            200            0.0043761997  -0.0020528877   0              0.015181487    3.7564329e-11  0              3.627694e-06   1.1965779e-13  0              3.8607121    
   2000000   6363.961       200            200            0.0043761949  -0.0020528873   0              0.015181472    2.305367e-11   0              2.2263585e-06  1.1965779e-13  0              3.8607121    
   2100000   6363.961       200            200            0.0043761962  -0.0020528874   0              0.015181476    1.0858417e-11  0              1.0486282e-06  1.1965779e-13  0              3.8607121    
   2200000   6363.961       200            200            0.0043761962  -0.0020528874   0              0.015181476    1.0965345e-12  0              1.0589546e-07  1.1965779e-13  0              3.8607121    
   2300000   6363.961       200            200            0.004376196   -0.0020528874   0              0.015181475    8.9232285e-15  0              8.6174154e-10  1.1965779e-13  0              3.8607121    
   2400000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    8.85499e-15    0              8.5515156e-10  1.1965779e-13  0              3.8607121    
   2500000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    3.6506971e-15  0              3.525582e-10   1.1965779e-13  0              3.8607121    
   2600000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    3.3450074e-16  0              3.2303688e-11  1.1965779e-13  0              3.8607121    
   2700000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    3.3795666e-17  0              3.2637435e-12  1.1965779e-13  0              3.8607121    
   2800000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    7.4791056e-18  0              7.2227849e-13  1.1965779e-13  0              3.8607121    
   2900000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    5.2831565e-19  0              5.1020944e-14  1.1965779e-13  0              3.8607121    
   3000000   6363.961       200            200            0.0043761961  -0.0020528874   0              0.015181476    5.3193828e-18  0              5.1370791e-13  1.1965779e-13  0              3.8607121    
Loop time of 363.125 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7138028.286 ns/day, 0.000 hours/ns, 8261.607 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.134     | 115.64     | 143.04     | 252.7 | 31.84
Neigh   | 0.79544    | 0.80931    | 0.82256    |   1.2 |  0.22
Comm    | 22.327     | 49.111     | 77.021     | 378.7 | 13.52
Output  | 0.24188    | 0.24219    | 0.24253    |   0.1 |  0.07
Modify  | 106.2      | 141.7      | 176.53     | 286.9 | 39.02
Other   |            | 55.62      |            |       | 15.32

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         710.75 ave        1048 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2843
Ave neighs/atom = 1.1367453
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.74                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 122.675073866394
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.84
  ghost atom cutoff = 4.84
  binsize = 2.42, bins = 2630 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.33 | 32.34 | 32.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.331045e-14   6.993135e-14   0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067710938  6.993135e-14   0             -0.0020313281   145952.88      0              1.4095084e+10  1.1965779e-13  0              4.2426143    
    200000   6363.961       200            200            0.00081900376  6.993135e-14   0              0.0024570113   63701.451      0              6.1518302e+09  1.1965779e-13  0              3.954604     
    300000   6363.961       200            200            3.6714482e-05  6.993135e-14   0              0.00011014345  202.66977      0              19572396       1.1965779e-13  0              3.9002237    
    400000   6363.961       200            200           -3.8577296e-05  6.993135e-14   0             -0.00011573189  238.60634      0              23042893       1.1965779e-13  0              3.8733654    
    500000   6363.961       200            200            0.0095293013  -0.0028380148   0              0.031425919    15.878851      0              1533465.8      1.1965779e-13  0              3.8638164    
    600000   6363.961       200            200            0.0044806202  -0.0021067445   0              0.015548605    129.898        0              12544619       1.1965779e-13  0              3.8656528    
    700000   6363.961       200            200            0.0038771311  -0.0020247592   0              0.013656152    5.7999937      0              560121.88      1.1965779e-13  0              3.8659429    
    800000   6363.961       200            200            0.0046182476  -0.0020558954   0              0.015910638    0.030978485    0              2991.6804      1.1965779e-13  0              3.8656143    
    900000   6363.961       200            200            0.0043308499  -0.0020404052   0              0.015032955    0.18684528     0              18044.18       1.1965779e-13  0              3.8657379    
   1000000   6363.961       200            200            0.0043836364  -0.0020438095   0              0.015194719    0.04257308     0              4111.4033      1.1965779e-13  0              3.8657154    
   1100000   6363.961       200            200            0.0043941958  -0.0020445409   0              0.015227128    0.0025498522   0              246.24647      1.1965779e-13  0              3.8657105    
   1200000   6363.961       200            200            0.0043815296  -0.0020437068   0              0.015188296    1.3755769e-06  0              0.13284337     1.1965779e-13  0              3.8657161    
   1300000   6363.961       200            200            0.0043867919  -0.0020440493   0              0.015204425    5.5094384e-05  0              5.3206213      1.1965779e-13  0              3.8657138    
   1400000   6363.961       200            200            0.0043857221  -0.0020439814   0              0.015201148    1.4122134e-05  0              1.3638146      1.1965779e-13  0              3.8657143    
   1500000   6363.961       200            200            0.0043855773  -0.0020439711   0              0.015200703    9.6515135e-07  0              0.093207409    1.1965779e-13  0              3.8657143    
   1600000   6363.961       200            200            0.0043857979  -0.0020439857   0              0.015201379    1.4131692e-10  0              1.3647376e-05  1.1965779e-13  0              3.8657142    
   1700000   6363.961       200            200            0.004385701   -0.0020439794   0              0.015201082    1.5907437e-08  0              0.0015362264   1.1965779e-13  0              3.8657143    
   1800000   6363.961       200            200            0.0043857224  -0.0020439808   0              0.015201148    4.6438112e-09  0              0.00044846605  1.1965779e-13  0              3.8657143    
   1900000   6363.961       200            200            0.0043857242  -0.0020439809   0              0.015201153    3.5934775e-10  0              3.4703233e-05  1.1965779e-13  0              3.8657143    
   2000000   6363.961       200            200            0.0043857203  -0.0020439806   0              0.015201142    6.6868317e-13  0              6.4576634e-08  1.1965779e-13  0              3.8657143    
   2100000   6363.961       200            200            0.0043857221  -0.0020439807   0              0.015201147    4.5083429e-12  0              4.3538349e-07  1.1965779e-13  0              3.8657143    
   2200000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    1.5143017e-12  0              1.4624041e-07  1.1965779e-13  0              3.8657143    
   2300000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    1.3175503e-13  0              1.2723958e-08  1.1965779e-13  0              3.8657143    
   2400000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    7.1571312e-16  0              6.911845e-11   1.1965779e-13  0              3.8657143    
   2500000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    1.2359415e-15  0              1.1935838e-10  1.1965779e-13  0              3.8657143    
   2600000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    4.9190111e-16  0              4.7504288e-11  1.1965779e-13  0              3.8657143    
   2700000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    7.1899079e-17  0              6.9434984e-12  1.1965779e-13  0              3.8657143    
   2800000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    6.1729845e-18  0              5.9614266e-13  1.1965779e-13  0              3.8657143    
   2900000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    4.5430362e-18  0              4.3873392e-13  1.1965779e-13  0              3.8657143    
   3000000   6363.961       200            200            0.0043857217  -0.0020439807   0              0.015201146    2.6324829e-21  0              2.5422636e-16  1.1965779e-13  0              3.8657143    
Loop time of 361.418 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7171759.666 ns/day, 0.000 hours/ns, 8300.648 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.453     | 115.8      | 143.1      | 252.2 | 32.04
Neigh   | 0.75049    | 0.76307    | 0.77542    |   1.1 |  0.21
Comm    | 22.029     | 48.911     | 76.397     | 378.8 | 13.53
Output  | 0.24214    | 0.24246    | 0.2428     |   0.1 |  0.07
Modify  | 105.57     | 140.77     | 174.74     | 286.2 | 38.95
Other   |            | 54.93      |            |       | 15.20

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         713.25 ave        1053 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2853
Ave neighs/atom = 1.1407437
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.75                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 123.453137562863
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.85
  ghost atom cutoff = 4.85
  binsize = 2.425, bins = 2625 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.32 | 32.32 | 32.33 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.404232e-14   7.2126959e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067519764  7.2126959e-14  0             -0.0020255929   142310.63      0              1.3743342e+10  1.1965779e-13  0              4.2501159    
    200000   6363.961       200            200            0.00083811262  7.2126959e-14  0              0.0025143378   66139.968      0              6.3873247e+09  1.1965779e-13  0              3.9567169    
    300000   6363.961       200            200            5.3664587e-05  7.2126959e-14  0              0.00016099376  425.67947      0              41109076       1.1965779e-13  0              3.9049916    
    400000   6363.961       200            200           -2.1200877e-05  7.2126959e-14  0             -6.3602632e-05  70.510971      0              6809444.9      1.1965779e-13  0              3.878534     
    500000   6363.961       200            200            0.009116893   -0.0028200757   0              0.030170755    143.23812      0              13832913       1.1965779e-13  0              3.8689428    
    600000   6363.961       200            200            0.0040180583  -0.0021360604   0              0.014190235    125.49389      0              12119301       1.1965779e-13  0              3.8708532    
    700000   6363.961       200            200            0.0040094628  -0.0020258122   0              0.014054201    10.795087      0              1042512.2      1.1965779e-13  0              3.8708894    
    800000   6363.961       200            200            0.0046236209  -0.0020459506   0              0.015916813    0.10505121     0              10145.094      1.1965779e-13  0              3.8706181    
    900000   6363.961       200            200            0.0043214596  -0.0020304469   0              0.014994826    0.078399257    0              7571.2391      1.1965779e-13  0              3.8707485    
   1000000   6363.961       200            200            0.0044047515  -0.0020358647   0              0.015250119    0.038851096    0              3751.9608      1.1965779e-13  0              3.8707125    
   1100000   6363.961       200            200            0.0043999403  -0.0020355997   0              0.015235421    0.0047147402   0              455.31586      1.1965779e-13  0              3.8707143    
   1200000   6363.961       200            200            0.0043913106  -0.0020350294   0              0.015208961    0.00011137919  0              10.756205      1.1965779e-13  0              3.8707182    
   1300000   6363.961       200            200            0.0043966272  -0.0020353742   0              0.015225256    1.2580605e-05  0              1.2149448      1.1965779e-13  0              3.8707159    
   1400000   6363.961       200            200            0.0043949163  -0.0020352649   0              0.015220014    1.1153007e-05  0              1.0770775      1.1965779e-13  0              3.8707166    
   1500000   6363.961       200            200            0.0043951246  -0.0020352776   0              0.015220651    1.7616814e-06  0              0.17013058     1.1965779e-13  0              3.8707165    
   1600000   6363.961       200            200            0.0043952426  -0.0020352855   0              0.015221013    7.1506652e-08  0              0.0069056006   1.1965779e-13  0              3.8707165    
   1700000   6363.961       200            200            0.0043951507  -0.0020352795   0              0.015220732    1.1781162e-09  0              0.00011377403  1.1965779e-13  0              3.8707165    
   1800000   6363.961       200            200            0.0043951845  -0.0020352817   0              0.015220835    2.9801694e-09  0              0.00028780343  1.1965779e-13  0              3.8707165    
   1900000   6363.961       200            200            0.0043951786  -0.0020352813   0              0.015220817    6.1918015e-10  0              5.9795987e-05  1.1965779e-13  0              3.8707165    
   2000000   6363.961       200            200            0.0043951772  -0.0020352812   0              0.015220813    3.7134053e-11  0              3.586141e-06   1.1965779e-13  0              3.8707165    
   2100000   6363.961       200            200            0.0043951788  -0.0020352813   0              0.015220818    3.4854021e-15  0              3.3659519e-10  1.1965779e-13  0              3.8707165    
   2200000   6363.961       200            200            0.0043951781  -0.0020352813   0              0.015220816    7.2758841e-13  0              7.0265281e-08  1.1965779e-13  0              3.8707165    
   2300000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    2.0542197e-13  0              1.9838184e-08  1.1965779e-13  0              3.8707165    
   2400000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    1.7124137e-14  0              1.6537265e-09  1.1965779e-13  0              3.8707165    
   2500000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    7.6363557e-17  0              7.3746457e-12  1.1965779e-13  0              3.8707165    
   2600000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    1.6892104e-16  0              1.6313185e-11  1.1965779e-13  0              3.8707165    
   2700000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    3.3861488e-17  0              3.2701002e-12  1.1965779e-13  0              3.8707165    
   2800000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    2.8021404e-19  0              2.7061067e-14  1.1965779e-13  0              3.8707165    
   2900000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    2.0937536e-18  0              2.0219974e-13  1.1965779e-13  0              3.8707165    
   3000000   6363.961       200            200            0.0043951783  -0.0020352813   0              0.015220816    2.7886566e-19  0              2.6930849e-14  1.1965779e-13  0              3.8707165    
Loop time of 363.999 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7120905.821 ns/day, 0.000 hours/ns, 8241.789 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.316     | 116        | 143.94     | 255.5 | 31.87
Neigh   | 0.72673    | 0.73951    | 0.7521     |   1.1 |  0.20
Comm    | 22.398     | 49.303     | 77.455     | 381.2 | 13.54
Output  | 0.2441     | 0.2444     | 0.24473    |   0.1 |  0.07
Modify  | 107.01     | 142.6      | 176.67     | 283.4 | 39.18
Other   |            | 55.11      |            |       | 15.14

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         716.75 ave        1060 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2867
Ave neighs/atom = 1.1463415
Neighbor list builds = 124
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.76                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 124.234484223654
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.86
  ghost atom cutoff = 4.86
  binsize = 2.43, bins = 2619 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.26 | 32.26 | 32.27 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.4782664e-14  7.4347992e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067311195  7.4347992e-14  0             -0.0020193358   138716.41      0              1.3396238e+10  1.1965779e-13  0              4.257582     
    200000   6363.961       200            200            0.00085732663  7.4347992e-14  0              0.0025719799   68621.887      0              6.6270107e+09  1.1965779e-13  0              3.9587721    
    300000   6363.961       200            200            7.0845374e-05  7.4347992e-14  0              0.00021253612  730.06096      0              70504062       1.1965779e-13  0              3.9096765    
    400000   6363.961       200            200           -3.5443195e-06  7.4347992e-14  0             -1.0632959e-05  1.8449697      0              178173.96      1.1965779e-13  0              3.883604     
    500000   6363.961       200            200            0.0083748903  -0.0026837856   0              0.027808456    361.61657      0              34922340       1.1965779e-13  0              3.8741865    
    600000   6363.961       200            200            0.0036322764  -0.0020598414   0              0.012956671    105.01604      0              10141697       1.1965779e-13  0              3.8760438    
    700000   6363.961       200            200            0.0041681385  -0.0020521415   0              0.014556557    15.098793      0              1458133.3      1.1965779e-13  0              3.8758213    
    800000   6363.961       200            200            0.0046043992  -0.002035075    0              0.015848273    0.62156028     0              60025.843      1.1965779e-13  0              3.8756322    
    900000   6363.961       200            200            0.0043210097  -0.0020215356   0              0.014984565    0.0087341528   0              843.48196      1.1965779e-13  0              3.8757552    
   1000000   6363.961       200            200            0.0044243883  -0.0020282475   0              0.015301412    0.025537135    0              2466.1937      1.1965779e-13  0              3.8757102    
   1100000   6363.961       200            200            0.0044047652  -0.0020270408   0              0.015241336    0.005724958    0              552.87547      1.1965779e-13  0              3.8757185    
   1200000   6363.961       200            200            0.004401657   -0.0020268261   0              0.015231797    0.00041301038  0              39.885586      1.1965779e-13  0              3.87572      
   1300000   6363.961       200            200            0.0044060225  -0.0020271087   0              0.015245176    1.0916504e-06  0              0.10542378     1.1965779e-13  0              3.875718     
   1400000   6363.961       200            200            0.0044040273  -0.0020269815   0              0.015239063    4.6703426e-06  0              0.45102826     1.1965779e-13  0              3.8757189    
   1500000   6363.961       200            200            0.0044045425  -0.0020270138   0              0.015240641    1.7852577e-06  0              0.17240741     1.1965779e-13  0              3.8757187    
   1600000   6363.961       200            200            0.0044045264  -0.0020270131   0              0.015240592    2.0050599e-07  0              0.019363433    1.1965779e-13  0              3.8757187    
   1700000   6363.961       200            200            0.0044044659  -0.0020270091   0              0.015240407    4.5703628e-09  0              0.00044137293  1.1965779e-13  0              3.8757187    
   1800000   6363.961       200            200            0.0044045015  -0.0020270114   0              0.015240516    5.2682823e-10  0              5.08773e-05    1.1965779e-13  0              3.8757187    
   1900000   6363.961       200            200            0.00440449    -0.0020270107   0              0.015240481    4.7551995e-10  0              4.5922313e-05  1.1965779e-13  0              3.8757187    
   2000000   6363.961       200            200            0.0044044916  -0.0020270108   0              0.015240485    8.0415105e-11  0              7.7659152e-06  1.1965779e-13  0              3.8757187    
   2100000   6363.961       200            200            0.0044044922  -0.0020270108   0              0.015240488    4.0854006e-12  0              3.9453875e-07  1.1965779e-13  0              3.8757187    
   2200000   6363.961       200            200            0.0044044916  -0.0020270108   0              0.015240486    8.1445065e-15  0              7.8653814e-10  1.1965779e-13  0              3.8757187    
   2300000   6363.961       200            200            0.0044044919  -0.0020270108   0              0.015240486    1.0435449e-13  0              1.007781e-08   1.1965779e-13  0              3.8757187    
   2400000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    2.7618526e-14  0              2.6671996e-09  1.1965779e-13  0              3.8757187    
   2500000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    2.2574861e-15  0              2.1801185e-10  1.1965779e-13  0              3.8757187    
   2600000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    7.1694725e-18  0              6.9237633e-13  1.1965779e-13  0              3.8757187    
   2700000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    3.2895317e-20  0              3.1767943e-15  1.1965779e-13  0              3.8757187    
   2800000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    1.496118e-18   0              1.4448437e-13  1.1965779e-13  0              3.8757187    
   2900000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    3.5405722e-18  0              3.4192312e-13  1.1965779e-13  0              3.8757187    
   3000000   6363.961       200            200            0.0044044918  -0.0020270108   0              0.015240486    6.5093702e-20  0              6.2862839e-15  1.1965779e-13  0              3.8757187    
Loop time of 362.303 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7154232.800 ns/day, 0.000 hours/ns, 8280.362 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.305     | 115.9      | 143.69     | 254.7 | 31.99
Neigh   | 0.72543    | 0.73839    | 0.75066    |   1.1 |  0.20
Comm    | 22.214     | 49.13      | 77.204     | 381.3 | 13.56
Output  | 0.24331    | 0.24361    | 0.24395    |   0.1 |  0.07
Modify  | 105.2      | 140.93     | 175.32     | 286.8 | 38.90
Other   |            | 55.36      |            |       | 15.28

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         719.25 ave        1065 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2877
Ave neighs/atom = 1.1503399
Neighbor list builds = 124
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.77                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 125.019120760273
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.87
  ghost atom cutoff = 4.87
  binsize = 2.435, bins = 2614 83 83
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 32.21 | 32.22 | 32.23 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.5531435e-14  7.6594305e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00067085285  7.6594305e-14  0             -0.0020125586   135170.13      0              1.3053764e+10  1.1965779e-13  0              4.2650126    
    200000   6363.961       200            200            0.00087664498  7.6594305e-14  0              0.0026299349   71147.094      0              6.8708771e+09  1.1965779e-13  0              3.9607694    
    300000   6363.961       200            200            8.8255058e-05  7.6594305e-14  0              0.00026476517  1115.5057      0              1.0772756e+08  1.1965779e-13  0              3.9142782    
    400000   6363.961       200            200            1.4389879e-05  7.6594305e-14  0              4.3169636e-05  32.14368       0              3104206.6      1.1965779e-13  0              3.8885753    
    500000   6363.961       200            200            0.0073516461  -0.0025834934   0              0.024638432    606.88485      0              58608595       1.1965779e-13  0              3.8795294    
    600000   6363.961       200            200            0.0033118516  -0.0019834187   0              0.011918973    74.416444      0              7186607.6      1.1965779e-13  0              3.8812121    
    700000   6363.961       200            200            0.0043572255  -0.0020541376   0              0.015125814    17.24954       0              1665837.1      1.1965779e-13  0              3.8807446    
    800000   6363.961       200            200            0.0045623994  -0.0020275874   0              0.015714786    1.3621145      0              131543.27      1.1965779e-13  0              3.8806556    
    900000   6363.961       200            200            0.0043303763  -0.0020148267   0              0.015005956    0.010889412    0              1051.6214      1.1965779e-13  0              3.8807573    
   1000000   6363.961       200            200            0.0044406968  -0.002021945    0              0.015344035    0.0099350173   0              959.45286      1.1965779e-13  0              3.8807091    
   1100000   6363.961       200            200            0.0044090395  -0.0020199856   0              0.015247104    0.0049494671   0              477.9841       1.1965779e-13  0              3.8807227    
   1200000   6363.961       200            200            0.0044120239  -0.0020201588   0              0.015256231    0.00069413127  0              67.03423       1.1965779e-13  0              3.8807215    
   1300000   6363.961       200            200            0.0044146019  -0.0020203271   0              0.015264133    2.9275151e-05  0              2.8271846      1.1965779e-13  0              3.8807204    
   1400000   6363.961       200            200            0.004412743   -0.0020202088   0              0.015258438    2.4251223e-07  0              0.023420096    1.1965779e-13  0              3.8807212    
   1500000   6363.961       200            200            0.0044134463  -0.002020253    0              0.015260592    1.0150711e-06  0              0.098028301    1.1965779e-13  0              3.8807209    
   1600000   6363.961       200            200            0.0044132993  -0.002020244    0              0.015260142    2.5312885e-07  0              0.024445373    1.1965779e-13  0              3.8807209    
   1700000   6363.961       200            200            0.0044132876  -0.0020202431   0              0.015260106    2.2084614e-08  0              0.0021327739   1.1965779e-13  0              3.8807209    
   1800000   6363.961       200            200            0.004413314   -0.0020202448   0              0.015260187    2.6235166e-10  0              2.5336046e-05  1.1965779e-13  0              3.8807209    
   1900000   6363.961       200            200            0.0044133007  -0.002020244    0              0.015260146    1.1820404e-10  0              1.14153e-05    1.1965779e-13  0              3.8807209    
   2000000   6363.961       200            200            0.0044133047  -0.0020202442   0              0.015260158    6.9348921e-11  0              6.6972224e-06  1.1965779e-13  0              3.8807209    
   2100000   6363.961       200            200            0.0044133042  -0.0020202442   0              0.015260157    1.0512144e-11  0              1.0151876e-06  1.1965779e-13  0              3.8807209    
   2200000   6363.961       200            200            0.0044133039  -0.0020202442   0              0.015260156    5.0460297e-13  0              4.8730943e-08  1.1965779e-13  0              3.8807209    
   2300000   6363.961       200            200            0.0044133042  -0.0020202442   0              0.015260157    1.1714315e-15  0              1.1312847e-10  1.1965779e-13  0              3.8807209    
   2400000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    1.3387033e-14  0              1.2928238e-09  1.1965779e-13  0              3.8807209    
   2500000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    3.675314e-15   0              3.5493552e-10  1.1965779e-13  0              3.8807209    
   2600000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    3.1474699e-16  0              3.0396011e-11  1.1965779e-13  0              3.8807209    
   2700000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    3.3037739e-17  0              3.1905484e-12  1.1965779e-13  0              3.8807209    
   2800000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    1.0014593e-17  0              9.6713774e-13  1.1965779e-13  0              3.8807209    
   2900000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    2.5818686e-22  0              2.4933839e-17  1.1965779e-13  0              3.8807209    
   3000000   6363.961       200            200            0.0044133041  -0.0020202442   0              0.015260156    1.8306913e-18  0              1.7679506e-13  1.1965779e-13  0              3.8807209    
Loop time of 362.166 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7156937.938 ns/day, 0.000 hours/ns, 8283.493 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.682     | 116.27     | 143.94     | 255.1 | 32.10
Neigh   | 0.7448     | 0.75823    | 0.77054    |   1.1 |  0.21
Comm    | 21.632     | 49.24      | 76.733     | 384.4 | 13.60
Output  | 0.24291    | 0.24322    | 0.24354    |   0.1 |  0.07
Modify  | 105.5      | 140.41     | 174.98     | 286.1 | 38.77
Other   |            | 55.25      |            |       | 15.26

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         722.25 ave        1071 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2889
Ave neighs/atom = 1.1551379
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.78                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 125.807054084222
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.88
  ghost atom cutoff = 4.88
  binsize = 2.44, bins = 2609 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.76 | 31.76 | 31.77 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.6288586e-14  7.8865758e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066842092  7.8865758e-14  0             -0.0020052628   131671.73      0              1.2715913e+10  1.1965779e-13  0              4.2724077    
    200000   6363.961       200            200            0.00089606659  7.8865758e-14  0              0.0026881998   73715.436      0              7.1189092e+09  1.1965779e-13  0              3.9627085    
    300000   6363.961       200            200            0.00010589151  7.8865758e-14  0              0.00031767454  1581.6984      0              1.5274911e+08  1.1965779e-13  0              3.9187964    
    400000   6363.961       200            200            3.2598828e-05  7.8865758e-14  0              9.7796485e-05  160.9434       0              15542762       1.1965779e-13  0              3.8934476    
    500000   6363.961       200            200            0.0061312038  -0.0026479863   0              0.021041598    812.60729      0              78475796       1.1965779e-13  0              3.8849469    
    600000   6363.961       200            200            0.0030616561  -0.0019420716   0              0.01112704     41.807313      0              4037451        1.1965779e-13  0              3.8863472    
    700000   6363.961       200            200            0.0045549871  -0.0020515547   0              0.015716516    16.479488      0              1591471        1.1965779e-13  0              3.885666     
    800000   6363.961       200            200            0.0045038227  -0.0020219269   0              0.015533395    2.0165515      0              194744.11      1.1965779e-13  0              3.8856858    
    900000   6363.961       200            200            0.0043495411  -0.0020103305   0              0.015058954    0.083460018    0              8059.9712      1.1965779e-13  0              3.8857548    
   1000000   6363.961       200            200            0.0044525589  -0.002016941    0              0.015374618    0.00063890717  0              61.701081      1.1965779e-13  0              3.8857097    
   1100000   6363.961       200            200            0.0044134901  -0.0020145185   0              0.015254989    0.0028707219   0              277.23377      1.1965779e-13  0              3.8857266    
   1200000   6363.961       200            200            0.0044221146  -0.0020150484   0              0.015281392    0.000757138    0              73.118968      1.1965779e-13  0              3.8857229    
   1300000   6363.961       200            200            0.0044223991  -0.0020150722   0              0.01528227     7.488501e-05   0              7.2318582      1.1965779e-13  0              3.8857228    
   1400000   6363.961       200            200            0.0044210729  -0.0020149872   0              0.015278206    1.650191e-06   0              0.15936364     1.1965779e-13  0              3.8857234    
   1500000   6363.961       200            200            0.0044217998  -0.002015033    0              0.015280433    1.8061766e-07  0              0.017442761    1.1965779e-13  0              3.885723     
   1600000   6363.961       200            200            0.0044215591  -0.0020150181   0              0.015279695    1.7499742e-07  0              0.016899998    1.1965779e-13  0              3.8857231    
   1700000   6363.961       200            200            0.0044216     -0.0020150205   0              0.015279821    3.3888919e-08  0              0.0032727493   1.1965779e-13  0              3.8857231    
   1800000   6363.961       200            200            0.0044216089  -0.0020150211   0              0.015279848    2.4838791e-09  0              0.00023987526  1.1965779e-13  0              3.8857231    
   1900000   6363.961       200            200            0.0044215983  -0.0020150204   0              0.015279815    1.5577882e-11  0              1.5044004e-06  1.1965779e-13  0              3.8857231    
   2000000   6363.961       200            200            0.0044216032  -0.0020150208   0              0.01527983     1.9705247e-11  0              1.9029917e-06  1.1965779e-13  0              3.8857231    
   2100000   6363.961       200            200            0.0044216018  -0.0020150207   0              0.015279826    9.5636443e-12  0              9.2358831e-07  1.1965779e-13  0              3.8857231    
   2200000   6363.961       200            200            0.0044216019  -0.0020150207   0              0.015279826    1.4073723e-12  0              1.3591394e-07  1.1965779e-13  0              3.8857231    
   2300000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    7.147128e-14   0              6.9021846e-09  1.1965779e-13  0              3.8857231    
   2400000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    4.4518888e-17  0              4.2993155e-12  1.1965779e-13  0              3.8857231    
   2500000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    1.519059e-15   0              1.4669985e-10  1.1965779e-13  0              3.8857231    
   2600000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    4.8295465e-16  0              4.6640303e-11  1.1965779e-13  0              3.8857231    
   2700000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    7.0874735e-17  0              6.8445746e-12  1.1965779e-13  0              3.8857231    
   2800000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    5.0563117e-18  0              4.8830239e-13  1.1965779e-13  0              3.8857231    
   2900000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    1.1170646e-18  0              1.078781e-13   1.1965779e-13  0              3.8857231    
   3000000   6363.961       200            200            0.004421602   -0.0020150207   0              0.015279827    5.237255e-18   0              5.057766e-13   1.1965779e-13  0              3.8857231    
Loop time of 362.301 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7154265.475 ns/day, 0.000 hours/ns, 8280.400 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.596     | 116.19     | 143.75     | 255.4 | 32.07
Neigh   | 0.72454    | 0.73738    | 0.7502     |   1.2 |  0.20
Comm    | 21.477     | 48.825     | 76.398     | 385.1 | 13.48
Output  | 0.24185    | 0.24217    | 0.24252    |   0.1 |  0.07
Modify  | 106.07     | 141.21     | 175.28     | 284.9 | 38.98
Other   |            | 55.1       |            |       | 15.21

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         725.75 ave        1077 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2903
Ave neighs/atom = 1.1607357
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.79                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 126.598291107006
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.89
  ghost atom cutoff = 4.89
  binsize = 2.445, bins = 2603 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.7 | 31.71 | 31.71 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.7054071e-14  8.1162214e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066581668  8.1162214e-14  0             -0.00199745     128221.1       0              1.2382676e+10  1.1965779e-13  0              4.279767     
    200000   6363.961       200            200            0.00091559065  8.1162214e-14  0              0.0027467719   76326.8        0              7.371096e+09   1.1965779e-13  0              3.9645894    
    300000   6363.961       200            200            0.0001237529   8.1162214e-14  0              0.00037125871  2128.3303      0              2.0553891e+08  1.1965779e-13  0              3.9232308    
    400000   6363.961       200            200            5.1079957e-05  8.1162214e-14  0              0.00015323987  387.78149      0              37449161       1.1965779e-13  0              3.8982207    
    500000   6363.961       200            200            0.0049155681  -0.0026288183   0              0.017375523    930.47547      0              89858661       1.1965779e-13  0              3.8904108    
    600000   6363.961       200            200            0.0029039257  -0.0018967246   0              0.010608502    15.331444      0              1480601.1      1.1965779e-13  0              3.8914411    
    700000   6363.961       200            200            0.0047493047  -0.0020310988   0              0.016279013    13.004219      0              1255854.4      1.1965779e-13  0              3.8905927    
    800000   6363.961       200            200            0.0044376889  -0.0020132773   0              0.015326344    2.3136268      0              223433.51      1.1965779e-13  0              3.8907199    
    900000   6363.961       200            200            0.0043776084  -0.0020068139   0              0.015139639    0.19106787     0              18451.967      1.1965779e-13  0              3.8907485    
   1000000   6363.961       200            200            0.0044598066  -0.0020120675   0              0.015391487    0.0027788608   0              268.36248      1.1965779e-13  0              3.8907123    
   1100000   6363.961       200            200            0.0044191291  -0.0020095407   0              0.015266928    0.00078713111  0              76.015489      1.1965779e-13  0              3.8907299    
   1200000   6363.961       200            200            0.0044319787  -0.0020103367   0              0.015306273    0.00055733201  0              53.823136      1.1965779e-13  0              3.8907244    
   1300000   6363.961       200            200            0.0044298959  -0.0020102123   0              0.0152999      0.00010210988  0              9.8610413      1.1965779e-13  0              3.8907252    
   1400000   6363.961       200            200            0.0044293892  -0.0020101786   0              0.015298346    7.6351623e-06  0              0.73734933     1.1965779e-13  0              3.8907255    
   1500000   6363.961       200            200            0.004429968   -0.0020102152   0              0.015300119    6.9569336e-08  0              0.0067185085   1.1965779e-13  0              3.8907252    
   1600000   6363.961       200            200            0.0044296958  -0.0020101982   0              0.015299286    4.7183992e-08  0              0.0045566922   1.1965779e-13  0              3.8907253    
   1700000   6363.961       200            200            0.0044297779  -0.0020102033   0              0.015299537    2.6676987e-08  0              0.0025762724   1.1965779e-13  0              3.8907253    
   1800000   6363.961       200            200            0.0044297663  -0.0020102026   0              0.015299501    4.4636933e-09  0              0.00043107155  1.1965779e-13  0              3.8907253    
   1900000   6363.961       200            200            0.0044297621  -0.0020102023   0              0.015299489    2.9902238e-10  0              2.8877441e-05  1.1965779e-13  0              3.8907253    
   2000000   6363.961       200            200            0.0044297661  -0.0020102026   0              0.015299501    1.3670281e-12  0              1.3201779e-07  1.1965779e-13  0              3.8907253    
   2100000   6363.961       200            200            0.0044297643  -0.0020102024   0              0.015299495    2.6978123e-12  0              2.605354e-07   1.1965779e-13  0              3.8907253    
   2200000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    1.2629628e-12  0              1.219679e-07   1.1965779e-13  0              3.8907253    
   2300000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    1.9333841e-13  0              1.8671239e-08  1.1965779e-13  0              3.8907253    
   2400000   6363.961       200            200            0.0044297647  -0.0020102025   0              0.015299497    1.1254515e-14  0              1.0868805e-09  1.1965779e-13  0              3.8907253    
   2500000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    1.5185723e-17  0              1.4665284e-12  1.1965779e-13  0              3.8907253    
   2600000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    1.5382752e-16  0              1.4855561e-11  1.1965779e-13  0              3.8907253    
   2700000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    3.0718404e-17  0              2.9665636e-12  1.1965779e-13  0              3.8907253    
   2800000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    8.0569373e-21  0              7.7808133e-16  1.1965779e-13  0              3.8907253    
   2900000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    2.630712e-18   0              2.5405534e-13  1.1965779e-13  0              3.8907253    
   3000000   6363.961       200            200            0.0044297648  -0.0020102025   0              0.015299497    2.5589291e-19  0              2.4712306e-14  1.1965779e-13  0              3.8907253    
Loop time of 364.108 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7118765.692 ns/day, 0.000 hours/ns, 8239.312 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.214     | 116.15     | 144.14     | 257.3 | 31.90
Neigh   | 0.71518    | 0.72749    | 0.73976    |   1.1 |  0.20
Comm    | 22.3       | 49.569     | 77.962     | 384.0 | 13.61
Output  | 0.24451    | 0.24482    | 0.24513    |   0.1 |  0.07
Modify  | 105.79     | 141.63     | 176.55     | 288.0 | 38.90
Other   |            | 55.79      |            |       | 15.32

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         727.75 ave        1082 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2911
Ave neighs/atom = 1.1639344
Neighbor list builds = 128
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.8                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 127.392838740128
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.9
  ghost atom cutoff = 4.9
  binsize = 2.45, bins = 2598 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.65 | 31.66 | 31.67 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.7827848e-14  8.3483543e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066304071  8.3483543e-14  0             -0.0019891221   124818.18      0              1.2054047e+10  1.1965779e-13  0              4.2870906    
    200000   6363.961       200            200            0.00093521614  8.3483543e-14  0              0.0028056484   78981.044      0              7.6274239e+09  1.1965779e-13  0              3.966412     
    300000   6363.961       200            200            0.00014183725  8.3483543e-14  0              0.00042551174  2755.0895      0              2.6606683e+08  1.1965779e-13  0              3.9275813    
    400000   6363.961       200            200            6.9830589e-05  8.3483543e-14  0              0.00020949177  712.19621      0              68778812       1.1965779e-13  0              3.9028944    
    500000   6363.961       200            200            0.0038638676  -0.0023518026   0              0.013943405    940.70465      0              90846522       1.1965779e-13  0              3.8958924    
    600000   6363.961       200            200            0.0028353761  -0.0018704932   0              0.010376621    1.2916283      0              124736.22      1.1965779e-13  0              3.896488     
    700000   6363.961       200            200            0.0049125541  -0.0020238275   0              0.01676149     7.9966552      0              772259.72      1.1965779e-13  0              3.8955313    
    800000   6363.961       200            200            0.0043716765  -0.0020027691   0              0.015117799    2.132935       0              205983.59      1.1965779e-13  0              3.8957545    
    900000   6363.961       200            200            0.0044122756  -0.0020037843   0              0.015240611    0.28121        0              27157.249      1.1965779e-13  0              3.8957392    
   1000000   6363.961       200            200            0.0044626395  -0.0020070201   0              0.015394939    0.01513084     0              1461.2282      1.1965779e-13  0              3.8957167    
   1100000   6363.961       200            200            0.0044264844  -0.0020047649   0              0.015284218    4.2628265e-06  0              0.41167327     1.1965779e-13  0              3.8957324    
   1200000   6363.961       200            200            0.0044414047  -0.0020056918   0              0.015329906    0.0002349601   0              22.690764      1.1965779e-13  0              3.895726     
   1300000   6363.961       200            200            0.0044373336  -0.0020054432   0              0.015317444    8.95176e-05    0              8.6449691      1.1965779e-13  0              3.8957277    
   1400000   6363.961       200            200            0.0044377614  -0.0020054677   0              0.015318752    1.2985468e-05  0              1.2540436      1.1965779e-13  0              3.8957276    
   1500000   6363.961       200            200            0.0044380537  -0.0020054866   0              0.015319648    7.8157542e-07  0              0.07547896     1.1965779e-13  0              3.8957274    
   1600000   6363.961       200            200            0.0044378209  -0.002005472    0              0.015318935    1.9425386e-09  0              0.00018759647  1.1965779e-13  0              3.8957275    
   1700000   6363.961       200            200            0.004437921   -0.0020054782   0              0.015319241    8.5991918e-09  0              0.00083044839  1.1965779e-13  0              3.8957275    
   1800000   6363.961       200            200            0.0044378924  -0.0020054764   0              0.015319154    3.7824593e-09  0              0.00036528284  1.1965779e-13  0              3.8957275    
   1900000   6363.961       200            200            0.004437896   -0.0020054766   0              0.015319165    5.9304809e-10  0              5.727234e-05   1.1965779e-13  0              3.8957275    
   2000000   6363.961       200            200            0.0044378977  -0.0020054768   0              0.01531917     3.9724391e-11  0              3.8362973e-06  1.1965779e-13  0              3.8957275    
   2100000   6363.961       200            200            0.0044378962  -0.0020054767   0              0.015319165    2.4533106e-13  0              2.3692318e-08  1.1965779e-13  0              3.8957275    
   2200000   6363.961       200            200            0.0044378969  -0.0020054767   0              0.015319167    3.0522561e-13  0              2.9476505e-08  1.1965779e-13  0              3.8957275    
   2300000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    1.5815885e-13  0              1.527385e-08   1.1965779e-13  0              3.8957275    
   2400000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    2.6899969e-14  0              2.5978065e-09  1.1965779e-13  0              3.8957275    
   2500000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    1.9889226e-15  0              1.9207591e-10  1.1965779e-13  0              3.8957275    
   2600000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    1.8657572e-17  0              1.8018147e-12  1.1965779e-13  0              3.8957275    
   2700000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    7.9194179e-19  0              7.648007e-14   1.1965779e-13  0              3.8957275    
   2800000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    3.5648136e-18  0              3.4426418e-13  1.1965779e-13  0              3.8957275    
   2900000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    7.6479925e-18  0              7.3858837e-13  1.1965779e-13  0              3.8957275    
   3000000   6363.961       200            200            0.0044378967  -0.0020054767   0              0.015319167    6.1210075e-18  0              5.9112309e-13  1.1965779e-13  0              3.8957275    
Loop time of 365.427 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7093072.554 ns/day, 0.000 hours/ns, 8209.575 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.399     | 116.58     | 145.25     | 259.0 | 31.90
Neigh   | 0.76905    | 0.78143    | 0.79371    |   1.1 |  0.21
Comm    | 22.776     | 50.023     | 78.833     | 383.4 | 13.69
Output  | 0.24409    | 0.2444     | 0.24472    |   0.1 |  0.07
Modify  | 106.73     | 142.37     | 176.55     | 282.1 | 38.96
Other   |            | 55.43      |            |       | 15.17

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         730.25 ave        1087 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2921
Ave neighs/atom = 1.1679328
Neighbor list builds = 134
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.81                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 128.190703895092
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.91
  ghost atom cutoff = 4.91
  binsize = 2.455, bins = 2593 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.64 | 31.65 | 31.65 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.8609873e-14  8.5829618e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00066009354  8.5829618e-14  0             -0.0019802806   121462.88      0              1.1730016e+10  1.1965779e-13  0              4.2943784    
    200000   6363.961       200            200            0.0009549423   8.5829618e-14  0              0.0028648269   81678.062      0              7.8878826e+09  1.1965779e-13  0              3.9681759    
    300000   6363.961       200            200            0.0001601428   8.5829618e-14  0              0.00048042839  3461.6733      0              3.3430363e+08  1.1965779e-13  0              3.9318477    
    400000   6363.961       200            200            8.8848246e-05  8.5829618e-14  0              0.00026654474  1133.7314      0              1.0948767e+08  1.1965779e-13  0              3.9074684    
    500000   6363.961       200            200            0.0029674672  -0.0020306416   0              0.010933043    851.31204      0              82213624       1.1965779e-13  0              3.9013642    
    600000   6363.961       200            200            0.0028584547  -0.0018626506   0              0.010438015    2.905831       0              280624.36      1.1965779e-13  0              3.9014854    
    700000   6363.961       200            200            0.0050265945  -0.0020369605   0              0.017116744    3.2077766      0              309784.1       1.1965779e-13  0              3.9004878    
    800000   6363.961       200            200            0.004313382   -0.0019915951   0              0.014931741    1.551634       0              149845.71      1.1965779e-13  0              3.9007861    
    900000   6363.961       200            200            0.0044504209  -0.0020005473   0              0.01535181     0.30964727     0              29903.517      1.1965779e-13  0              3.9007285    
   1000000   6363.961       200            200            0.0044619485  -0.0020013709   0              0.015387216    0.03072805     0              2967.4951      1.1965779e-13  0              3.9007227    
   1100000   6363.961       200            200            0.004435856   -0.0019997313   0              0.015307299    0.0010139899   0              97.923883      1.1965779e-13  0              3.9007342    
   1200000   6363.961       200            200            0.0044503049  -0.0020006289   0              0.015351543    1.7590483e-05  0              1.6987629      1.1965779e-13  0              3.9007279    
   1300000   6363.961       200            200            0.0044450127  -0.0020003045   0              0.015335343    4.6905342e-05  0              4.5297822      1.1965779e-13  0              3.9007302    
   1400000   6363.961       200            200            0.0044462911  -0.0020003817   0              0.015339255    1.3034095e-05  0              1.2587396      1.1965779e-13  0              3.9007296    
   1500000   6363.961       200            200            0.0044462248  -0.0020003784   0              0.015339053    1.6331965e-06  0              0.15772242     1.1965779e-13  0              3.9007297    
   1600000   6363.961       200            200            0.0044460929  -0.00200037     0              0.015338649    8.5592935e-08  0              0.008265953    1.1965779e-13  0              3.9007297    
   1700000   6363.961       200            200            0.0044461823  -0.0020003756   0              0.015338922    3.7627912e-11  0              3.6338344e-06  1.1965779e-13  0              3.9007297    
   1800000   6363.961       200            200            0.0044461456  -0.0020003733   0              0.01533881     1.2736079e-09  0              0.00012299594  1.1965779e-13  0              3.9007297    
   1900000   6363.961       200            200            0.0044461559  -0.002000374    0              0.015338842    5.1000764e-10  0              4.9252887e-05  1.1965779e-13  0              3.9007297    
   2000000   6363.961       200            200            0.0044461546  -0.0020003739   0              0.015338838    8.0246907e-11  0              7.7496719e-06  1.1965779e-13  0              3.9007297    
   2100000   6363.961       200            200            0.004446154   -0.0020003739   0              0.015338836    5.8456985e-12  0              5.6453572e-07  1.1965779e-13  0              3.9007297    
   2200000   6363.961       200            200            0.0044461545  -0.0020003739   0              0.015338837    7.1382471e-14  0              6.8936081e-09  1.1965779e-13  0              3.9007297    
   2300000   6363.961       200            200            0.0044461543  -0.0020003739   0              0.015338837    2.6467512e-14  0              2.5560429e-09  1.1965779e-13  0              3.9007297    
   2400000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    1.8058325e-14  0              1.7439438e-09  1.1965779e-13  0              3.9007297    
   2500000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    3.6655294e-15  0              3.5399059e-10  1.1965779e-13  0              3.9007297    
   2600000   6363.961       200            200            0.0044461543  -0.0020003739   0              0.015338837    3.3367333e-16  0              3.2223782e-11  1.1965779e-13  0              3.9007297    
   2700000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    4.2263785e-17  0              4.0815339e-12  1.1965779e-13  0              3.9007297    
   2800000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    1.0192794e-17  0              9.8434711e-13  1.1965779e-13  0              3.9007297    
   2900000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    1.7180224e-20  0              1.6591431e-15  1.1965779e-13  0              3.9007297    
   3000000   6363.961       200            200            0.0044461544  -0.0020003739   0              0.015338837    1.761849e-18   0              1.7014677e-13  1.1965779e-13  0              3.9007297    
Loop time of 365.77 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7086416.683 ns/day, 0.000 hours/ns, 8201.871 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.449     | 116.69     | 145.08     | 259.5 | 31.90
Neigh   | 0.74882    | 0.76166    | 0.7746     |   1.1 |  0.21
Comm    | 21.18      | 49.51      | 77.487     | 391.6 | 13.54
Output  | 0.24416    | 0.24448    | 0.24483    |   0.1 |  0.07
Modify  | 107.89     | 143.05     | 177.99     | 285.1 | 39.11
Other   |            | 55.51      |            |       | 15.18

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         733.25 ave        1092 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2933
Ave neighs/atom = 1.1727309
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.82                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 128.991893483402
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.92
  ghost atom cutoff = 4.92
  binsize = 2.46, bins = 2587 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.59 | 31.59 | 31.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            2.9400106e-14  8.8200317e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065697575  8.8200317e-14  0             -0.0019709272   118155.13      0              1.1410577e+10  1.1965779e-13  0              4.3016303    
    200000   6363.961       200            200            0.00097476795  8.8200317e-14  0              0.0029243039   84417.689      0              8.1524562e+09  1.1965779e-13  0              3.9698811    
    300000   6363.961       200            200            0.00017866734  8.8200317e-14  0              0.00053600202  4247.7616      0              4.1021841e+08  1.1965779e-13  0              3.9360297    
    400000   6363.961       200            200            0.00010813002  8.8200317e-14  0              0.00032439005  1651.9227      0              1.5953087e+08  1.1965779e-13  0              3.9119425    
    500000   6363.961       200            200            0.0022192085  -0.0018041964   0              0.0084618219   690.14563      0              66649326       1.1965779e-13  0              3.906802     
    600000   6363.961       200            200            0.0029732083  -0.0018728762   0              0.010792501    19.706906      0              1903151.9      1.1965779e-13  0              3.9064334    
    700000   6363.961       200            200            0.0050949307  -0.0020236262   0              0.017308418    0.34751532     0              33560.543      1.1965779e-13  0              3.9054663    
    800000   6363.961       200            200            0.0042691693  -0.0019819613   0              0.014789469    0.81022404     0              78245.638      1.1965779e-13  0              3.9058117    
    900000   6363.961       200            200            0.0044880917  -0.0019974295   0              0.015461705    0.26215873     0              25317.414      1.1965779e-13  0              3.9057179    
   1000000   6363.961       200            200            0.0044588043  -0.0019958055   0              0.015372218    0.040690389    0              3929.5866      1.1965779e-13  0              3.9057297    
   1100000   6363.961       200            200            0.004446881   -0.0019950332   0              0.015335676    0.0031733494   0              306.45937      1.1965779e-13  0              3.9057351    
   1200000   6363.961       200            200            0.0044583497  -0.0019957468   0              0.015370796    5.9843168e-05  0              5.7792248      1.1965779e-13  0              3.9057301    
   1300000   6363.961       200            200            0.0044528532  -0.0019954096   0              0.015353969    7.8383138e-06  0              0.75696824     1.1965779e-13  0              3.9057325    
   1400000   6363.961       200            200            0.0044547135  -0.0019955227   0              0.015359663    7.7141626e-06  0              0.74497861     1.1965779e-13  0              3.9057317    
   1500000   6363.961       200            200            0.0044543013  -0.0019954981   0              0.015358402    1.8058092e-06  0              0.17439213     1.1965779e-13  0              3.9057319    
   1600000   6363.961       200            200            0.004454306   -0.0019954981   0              0.015358416    2.1016979e-07  0              0.020296694    1.1965779e-13  0              3.9057319    
   1700000   6363.961       200            200            0.0044543587  -0.0019955014   0              0.015358577    1.0607864e-08  0              0.0010244315   1.1965779e-13  0              3.9057319    
   1800000   6363.961       200            200            0.0044543254  -0.0019954994   0              0.015358476    4.1711291e-12  0              4.0281779e-07  1.1965779e-13  0              3.9057319    
   1900000   6363.961       200            200            0.0044543389  -0.0019955002   0              0.015358517    1.5911278e-10  0              1.5365973e-05  1.1965779e-13  0              3.9057319    
   2000000   6363.961       200            200            0.004454335   -0.0019955      0              0.015358505    6.5477262e-11  0              6.3233253e-06  1.1965779e-13  0              3.9057319    
   2100000   6363.961       200            200            0.0044543356  -0.0019955      0              0.015358507    1.0985171e-11  0              1.0608692e-06  1.1965779e-13  0              3.9057319    
   2200000   6363.961       200            200            0.0044543358  -0.0019955      0              0.015358507    9.2787878e-13  0              8.9607891e-08  1.1965779e-13  0              3.9057319    
   2300000   6363.961       200            200            0.0044543356  -0.0019955      0              0.015358507    2.2559222e-14  0              2.1786082e-09  1.1965779e-13  0              3.9057319    
   2400000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    1.3288642e-15  0              1.2833219e-10  1.1965779e-13  0              3.9057319    
   2500000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    1.8783117e-15  0              1.813939e-10   1.1965779e-13  0              3.9057319    
   2600000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    4.8323188e-16  0              4.6667076e-11  1.1965779e-13  0              3.9057319    
   2700000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    7.0375125e-17  0              6.7963259e-12  1.1965779e-13  0              3.9057319    
   2800000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    2.7303948e-18  0              2.6368198e-13  1.1965779e-13  0              3.9057319    
   2900000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    1.7736141e-18  0              1.7128296e-13  1.1965779e-13  0              3.9057319    
   3000000   6363.961       200            200            0.0044543357  -0.0019955      0              0.015358507    5.418362e-18   0              5.2326662e-13  1.1965779e-13  0              3.9057319    
Loop time of 365.042 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7100551.917 ns/day, 0.000 hours/ns, 8218.231 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.24      | 116.75     | 145.51     | 261.4 | 31.98
Neigh   | 0.75478    | 0.76786    | 0.78065    |   1.1 |  0.21
Comm    | 22.672     | 50.226     | 79.341     | 388.6 | 13.76
Output  | 0.23909    | 0.2394     | 0.23972    |   0.1 |  0.07
Modify  | 105.77     | 141.48     | 176.12     | 285.1 | 38.76
Other   |            | 55.58      |            |       | 15.23

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         735.75 ave        1098 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2943
Ave neighs/atom = 1.1767293
Neighbor list builds = 136
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.83                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 129.796414416562
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.93
  ghost atom cutoff = 4.93
  binsize = 2.465, bins = 2582 82 82
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.54 | 31.55 | 31.56 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.0198506e-14  9.0595519e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065368784  9.0595519e-14  0             -0.0019610635   114894.84      0              1.1095721e+10  1.1965779e-13  0              4.3088461    
    200000   6363.961       200            200            0.00099469249  9.0595519e-14  0              0.0029840775   87199.842      0              8.4211366e+09  1.1965779e-13  0              3.9715274    
    300000   6363.961       200            200            0.00019740929  9.0595519e-14  0              0.00059222788  5113.0605      0              4.9378278e+08  1.1965779e-13  0              3.940127     
    400000   6363.961       200            200            0.00012767357  9.0595519e-14  0              0.00038302072  2266.3216      0              2.1886512e+08  1.1965779e-13  0              3.9163164    
    500000   6363.961       200            200            0.0017155008  -0.0014147663   0              0.0065612687   494.39256      0              47744894       1.1965779e-13  0              3.9121859    
    600000   6363.961       200            200            0.0031850519  -0.001878144    0              0.0114333      47.618454      0              4598649.5      1.1965779e-13  0              3.9113352    
    700000   6363.961       200            200            0.0050992492  -0.0020194854   0              0.017317233    0.44212368     0              42697.141      1.1965779e-13  0              3.9104692    
    800000   6363.961       200            200            0.004243749   -0.0019762494   0              0.014707497    0.21232367     0              20504.7        1.1965779e-13  0              3.9108287    
    900000   6363.961       200            200            0.0045211054  -0.0019955226   0              0.015558839    0.16182971     0              15628.355      1.1965779e-13  0              3.9107092    
   1000000   6363.961       200            200            0.0044541965  -0.0019924198   0              0.015355009    0.039209333    0              3786.5568      1.1965779e-13  0              3.9107371    
   1100000   6363.961       200            200            0.0044584483  -0.0019926378   0              0.015367983    0.0050920418   0              491.75295      1.1965779e-13  0              3.9107355    
   1200000   6363.961       200            200            0.0044648863  -0.0019930464   0              0.015387705    0.00033214687  0              32.076367      1.1965779e-13  0              3.9107327    
   1300000   6363.961       200            200            0.0044602645  -0.0019927604   0              0.015373554    3.4246345e-06  0              0.33072669     1.1965779e-13  0              3.9107347    
   1400000   6363.961       200            200            0.0044623057  -0.0019928855   0              0.015379803    1.6672744e-06  0              0.16101343     1.1965779e-13  0              3.9107338    
   1500000   6363.961       200            200            0.0044616439  -0.0019928454   0              0.015377777    1.1277664e-06  0              0.10891161     1.1965779e-13  0              3.9107341    
   1600000   6363.961       200            200            0.0044617853  -0.0019928538   0              0.01537821     2.4432904e-07  0              0.02359555     1.1965779e-13  0              3.910734     
   1700000   6363.961       200            200            0.0044617855  -0.0019928539   0              0.01537821     2.8207054e-08  0              0.0027240354   1.1965779e-13  0              3.910734     
   1800000   6363.961       200            200            0.0044617663  -0.0019928527   0              0.015378152    1.5271163e-09  0              0.00014747796  1.1965779e-13  0              3.910734     
   1900000   6363.961       200            200            0.0044617784  -0.0019928534   0              0.015378188    3.8371553e-12  0              3.7056499e-07  1.1965779e-13  0              3.910734     
   2000000   6363.961       200            200            0.0044617734  -0.0019928531   0              0.015378173    1.6263893e-11  0              1.5706503e-06  1.1965779e-13  0              3.910734     
   2100000   6363.961       200            200            0.0044617749  -0.0019928532   0              0.015378178    7.8531663e-12  0              7.5840259e-07  1.1965779e-13  0              3.910734     
   2200000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    1.4884947e-12  0              1.4374817e-07  1.1965779e-13  0              3.910734     
   2300000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    1.5250335e-13  0              1.4727682e-08  1.1965779e-13  0              3.910734     
   2400000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    6.5430855e-15  0              6.3188436e-10  1.1965779e-13  0              3.910734     
   2500000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    1.7437883e-18  0              1.6840259e-13  1.1965779e-13  0              3.910734     
   2600000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    1.6400447e-16  0              1.5838378e-11  1.1965779e-13  0              3.910734     
   2700000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    2.915414e-17   0              2.8154982e-12  1.1965779e-13  0              3.910734     
   2800000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    9.3042597e-24  0              8.9853881e-19  1.1965779e-13  0              3.910734     
   2900000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    1.3700656e-18  0              1.3231113e-13  1.1965779e-13  0              3.910734     
   3000000   6363.961       200            200            0.0044617746  -0.0019928532   0              0.015378177    4.7258973e-18  0              4.5639334e-13  1.1965779e-13  0              3.910734     
Loop time of 361.521 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7169715.380 ns/day, 0.000 hours/ns, 8298.282 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.328     | 115.6      | 143.27     | 253.0 | 31.98
Neigh   | 0.74959    | 0.76291    | 0.77588    |   1.1 |  0.21
Comm    | 22.604     | 49.142     | 76.888     | 377.9 | 13.59
Output  | 0.24285    | 0.24316    | 0.24349    |   0.1 |  0.07
Modify  | 105.36     | 140.77     | 174.64     | 283.8 | 38.94
Other   |            | 55         |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         710.75 ave        1048 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2843
Ave neighs/atom = 1.1367453
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.84                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 130.604273606076
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.94
  ghost atom cutoff = 4.94
  binsize = 2.47, bins = 2577 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.1 | 31.1 | 31.11 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.1005036e-14  9.3015109e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00065023042  9.3015109e-14  0             -0.0019506912   111681.93      0              1.0785442e+10  1.1965779e-13  0              4.3160259    
    200000   6363.961       200            200            0.0010147147   9.3015109e-14  0              0.0030441441   90024.35       0              8.6939073e+09  1.1965779e-13  0              3.9731147    
    300000   6363.961       200            200            0.0002163664   9.3015109e-14  0              0.0006490992   6057.2474      0              5.849656e+08   1.1965779e-13  0              3.9441395    
    400000   6363.961       200            200            0.00014747598  9.3015109e-14  0              0.00044242793  2976.463       0              2.8744549e+08  1.1965779e-13  0              3.9205899    
    500000   6363.961       200            200            0.0013856656  -0.0010400607   0              0.0051970574   301.22357      0              29090016       1.1965779e-13  0              3.9175       
    600000   6363.961       200            200            0.0034908657  -0.0018731418   0              0.012345739    79.702936      0              7697139.1      1.1965779e-13  0              3.916197     
    700000   6363.961       200            200            0.0050426761  -0.0020155334   0              0.017143562    3.438175       0              332034.33      1.1965779e-13  0              3.9154962    
    800000   6363.961       200            200            0.0042404732  -0.0019747231   0              0.014696143    0.00067375329  0              65.066271      1.1965779e-13  0              3.9158357    
    900000   6363.961       200            200            0.0045459296  -0.0019952067   0              0.015632995    0.05808763     0              5609.6875      1.1965779e-13  0              3.9157036    
   1000000   6363.961       200            200            0.0044499555  -0.0019912938   0              0.01534116     0.02700794     0              2608.2335      1.1965779e-13  0              3.915744     
   1100000   6363.961       200            200            0.0044699012  -0.0019924877   0              0.015402191    0.0054991099   0              531.06468      1.1965779e-13  0              3.9157357    
   1200000   6363.961       200            200            0.004470075   -0.0019925144   0              0.015402739    0.00063758097  0              61.573006      1.1965779e-13  0              3.9157355    
   1300000   6363.961       200            200            0.0044672663  -0.0019923368   0              0.015394136    3.7556788e-05  0              3.6269657      1.1965779e-13  0              3.9157367    
   1400000   6363.961       200            200            0.0044690369  -0.0019924467   0              0.015399557    2.6055822e-07  0              0.025162848    1.1965779e-13  0              3.915736     
   1500000   6363.961       200            200            0.0044682849  -0.0019924005   0              0.015397255    2.4998395e-07  0              0.024141661    1.1965779e-13  0              3.9157363    
   1600000   6363.961       200            200            0.0044685264  -0.0019924152   0              0.015397994    1.5056959e-07  0              0.014540933    1.1965779e-13  0              3.9157362    
   1700000   6363.961       200            200            0.0044684735  -0.001992412    0              0.015397833    3.2536812e-08  0              0.0031421724   1.1965779e-13  0              3.9157362    
   1800000   6363.961       200            200            0.0044684748  -0.001992412    0              0.015397836    3.9539582e-09  0              0.00038184498  1.1965779e-13  0              3.9157362    
   1900000   6363.961       200            200            0.0044684811  -0.0019924124   0              0.015397856    2.5093954e-10  0              2.4233945e-05  1.1965779e-13  0              3.9157362    
   2000000   6363.961       200            200            0.0044684769  -0.0019924122   0              0.015397843    2.6910551e-12  0              2.5988284e-07  1.1965779e-13  0              3.9157362    
   2100000   6363.961       200            200            0.0044684787  -0.0019924123   0              0.015397848    1.1823644e-12  0              1.1418429e-07  1.1965779e-13  0              3.9157362    
   2200000   6363.961       200            200            0.0044684781  -0.0019924123   0              0.015397847    8.3737026e-13  0              8.0867226e-08  1.1965779e-13  0              3.9157362    
   2300000   6363.961       200            200            0.0044684783  -0.0019924123   0              0.015397847    1.9189169e-13  0              1.8531526e-08  1.1965779e-13  0              3.9157362    
   2400000   6363.961       200            200            0.0044684783  -0.0019924123   0              0.015397847    2.4315629e-14  0              2.3482294e-09  1.1965779e-13  0              3.9157362    
   2500000   6363.961       200            200            0.0044684782  -0.0019924123   0              0.015397847    1.6882968e-15  0              1.6304362e-10  1.1965779e-13  0              3.9157362    
   2600000   6363.961       200            200            0.0044684783  -0.0019924123   0              0.015397847    2.2789366e-17  0              2.2008338e-12  1.1965779e-13  0              3.9157362    
   2700000   6363.961       200            200            0.0044684782  -0.0019924123   0              0.015397847    2.1322691e-18  0              2.0591929e-13  1.1965779e-13  0              3.9157362    
   2800000   6363.961       200            200            0.0044684783  -0.0019924123   0              0.015397847    5.7873179e-18  0              5.5889773e-13  1.1965779e-13  0              3.9157362    
   2900000   6363.961       200            200            0.0044684783  -0.0019924123   0              0.015397847    4.3851399e-18  0              4.2348542e-13  1.1965779e-13  0              3.9157362    
   3000000   6363.961       200            200            0.0044684782  -0.0019924123   0              0.015397847    2.80944e-18    0              2.7131561e-13  1.1965779e-13  0              3.9157362    
Loop time of 364.308 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7114849.811 ns/day, 0.000 hours/ns, 8234.780 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.296     | 115.79     | 143.42     | 254.3 | 31.78
Neigh   | 0.69507    | 0.70748    | 0.72012    |   1.1 |  0.19
Comm    | 22.168     | 49.055     | 76.828     | 380.5 | 13.47
Output  | 0.24293    | 0.24323    | 0.24357    |   0.1 |  0.07
Modify  | 107.92     | 143.49     | 177.62     | 284.5 | 39.39
Other   |            | 55.02      |            |       | 15.10

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         714.25 ave        1055 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2857
Ave neighs/atom = 1.1423431
Neighbor list builds = 127
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.85                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 131.415477963447
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.95
  ghost atom cutoff = 4.95
  binsize = 2.475, bins = 2572 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.04 | 31.05 | 31.05 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.1819659e-14  9.5458976e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.000646604    9.5458976e-14  0             -0.001939812    108516.34      0              1.0479731e+10  1.1965779e-13  0              4.3231696    
    200000   6363.961       200            200            0.0010348338   9.5458976e-14  0              0.0031045014   92891.106      0              8.9707582e+09  1.1965779e-13  0              3.9746427    
    300000   6363.961       200            200            0.00023553693  9.5458976e-14  0              0.00070661078  7080.0239      0              6.8373804e+08  1.1965779e-13  0              3.9480669    
    400000   6363.961       200            200            0.00018404678 -4.726788e-07   0              0.00055261303  3781.6391      0              3.6520364e+08  1.1965779e-13  0              3.9247628    
    500000   6363.961       200            200            0.0011261403  -0.00092193921  0              0.0043003603   141.32526      0              13648182       1.1965779e-13  0              3.922733     
    600000   6363.961       200            200            0.0038777478  -0.0018631128   0              0.013496356    107.58149      0              10389451       1.1965779e-13  0              3.9210276    
    700000   6363.961       200            200            0.0049375588  -0.0019948719   0              0.016807548    8.2197312      0              793802.8       1.1965779e-13  0              3.9205451    
    800000   6363.961       200            200            0.0042613953  -0.0019745078   0              0.014758694    0.25895153     0              25007.685      1.1965779e-13  0              3.9208321    
    900000   6363.961       200            200            0.004560979   -0.0019939073   0              0.015676844    0.002387849    0              230.60137      1.1965779e-13  0              3.9207023    
   1000000   6363.961       200            200            0.0044487234  -0.0019896892   0              0.015335859    0.011132963    0              1075.1419      1.1965779e-13  0              3.9207497    
   1100000   6363.961       200            200            0.0044814059  -0.0019916802   0              0.015435898    0.0040586207   0              391.95254      1.1965779e-13  0              3.9207359    
   1200000   6363.961       200            200            0.0044751243  -0.0019913128   0              0.015416686    0.00074617325  0              72.060071      1.1965779e-13  0              3.9207384    
   1300000   6363.961       200            200            0.004474761   -0.0019912846   0              0.015415568    8.295835e-05   0              8.0115236      1.1965779e-13  0              3.9207386    
   1400000   6363.961       200            200            0.0044758458  -0.0019913531   0              0.01541889     4.9033253e-06  0              0.47352806     1.1965779e-13  0              3.9207382    
   1500000   6363.961       200            200            0.0044751927  -0.0019913126   0              0.015416891    4.2354093e-08  0              0.0040902552   1.1965779e-13  0              3.9207384    
   1600000   6363.961       200            200            0.0044754692  -0.0019913296   0              0.015417737    2.7290764e-08  0              0.0026355467   1.1965779e-13  0              3.9207383    
   1700000   6363.961       200            200            0.0044753783  -0.0019913241   0              0.015417459    1.8134288e-08  0              0.0017512797   1.1965779e-13  0              3.9207384    
   1800000   6363.961       200            200            0.0044753999  -0.0019913253   0              0.015417525    4.2121688e-09  0              0.00040678112  1.1965779e-13  0              3.9207384    
   1900000   6363.961       200            200            0.0044753981  -0.0019913253   0              0.01541752     5.6935345e-10  0              5.4984081e-05  1.1965779e-13  0              3.9207384    
   2000000   6363.961       200            200            0.0044753964  -0.0019913251   0              0.015417514    4.4865566e-11  0              4.3327952e-06  1.1965779e-13  0              3.9207384    
   2100000   6363.961       200            200            0.0044753977  -0.0019913252   0              0.015417518    1.2547745e-12  0              1.2117714e-07  1.1965779e-13  0              3.9207384    
   2200000   6363.961       200            200            0.0044753971  -0.0019913252   0              0.015417516    3.1351403e-14  0              3.0276941e-09  1.1965779e-13  0              3.9207384    
   2300000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    7.0735393e-14  0              6.831118e-09   1.1965779e-13  0              3.9207384    
   2400000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    2.2104053e-14  0              2.1346512e-09  1.1965779e-13  0              3.9207384    
   2500000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    3.6017861e-15  0              3.4783472e-10  1.1965779e-13  0              3.9207384    
   2600000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    3.505558e-16   0              3.385417e-11   1.1965779e-13  0              3.9207384    
   2700000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    4.8507691e-17  0              4.6845256e-12  1.1965779e-13  0              3.9207384    
   2800000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    8.4791918e-18  0              8.1885965e-13  1.1965779e-13  0              3.9207384    
   2900000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    2.9613522e-20  0              2.859862e-15   1.1965779e-13  0              3.9207384    
   3000000   6363.961       200            200            0.0044753973  -0.0019913252   0              0.015417517    2.0330516e-18  0              1.9633757e-13  1.1965779e-13  0              3.9207384    
Loop time of 361.983 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7160548.155 ns/day, 0.000 hours/ns, 8287.671 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.204     | 115.99     | 143.84     | 255.1 | 32.04
Neigh   | 0.66777    | 0.67956    | 0.69107    |   1.1 |  0.19
Comm    | 22.343     | 49.216     | 77.368     | 381.4 | 13.60
Output  | 0.24361    | 0.24392    | 0.24426    |   0.1 |  0.07
Modify  | 105.61     | 140.79     | 174.77     | 283.5 | 38.89
Other   |            | 55.07      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         717.25 ave        1061 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2869
Ave neighs/atom = 1.1471411
Neighbor list builds = 123
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.86                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 132.23003440018
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.96
  ghost atom cutoff = 4.96
  binsize = 2.48, bins = 2567 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.01 | 31.02 | 31.02 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.2642337e-14  9.7927012e-14  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00064280914  9.7927012e-14  0             -0.0019284274   105397.96      0              1.0178581e+10  1.1965779e-13  0              4.330277     
    200000   6363.961       200            200            0.0010550488   9.7927012e-14  0              0.0031651465   95799.983      0              9.2516766e+09  1.1965779e-13  0              3.9761113    
    300000   6363.961       200            200            0.00025491891  9.7927012e-14  0              0.00076475672  8181.0813      0              7.9007027e+08  1.1965779e-13  0              3.951909     
    400000   6363.961       200            200            0.00055436613 -5.4618475e-05  0              0.0017177169   4652.1256      0              4.4926899e+08  1.1965779e-13  0              3.9288358    
    500000   6363.961       200            200            0.0010080404  -0.00078843548  0              0.0038125567   36.661548      0              3540509.9      1.1965779e-13  0              3.9278771    
    600000   6363.961       200            200            0.0043196161  -0.0018722834   0              0.014831132    123.46353      0              11923224       1.1965779e-13  0              3.9258384    
    700000   6363.961       200            200            0.0047864758  -0.0019870134   0              0.016346441    13.034687      0              1258796.7      1.1965779e-13  0              3.9256115    
    800000   6363.961       200            200            0.0043051358  -0.0019756999   0              0.014891107    0.87793357     0              84784.54       1.1965779e-13  0              3.9258185    
    900000   6363.961       200            200            0.0045649653  -0.0019921207   0              0.015687016    0.022288627    0              2152.476       1.1965779e-13  0              3.9257056    
   1000000   6363.961       200            200            0.0044516399  -0.0019881536   0              0.015343073    0.0009224705   0              89.085598      1.1965779e-13  0              3.9257537    
   1100000   6363.961       200            200            0.0044919886  -0.0019904846   0              0.01546645     0.0016980276   0              163.98336      1.1965779e-13  0              3.9257365    
   1200000   6363.961       200            200            0.0044801793  -0.0019899208   0              0.015430459    0.00054618415  0              52.746556      1.1965779e-13  0              3.9257414    
   1300000   6363.961       200            200            0.0044825583  -0.0019900467   0              0.015437722    9.9428862e-05  0              9.6021278      1.1965779e-13  0              3.9257404    
   1400000   6363.961       200            200            0.0044825634  -0.0019900458   0              0.015437736    1.2115277e-05  0              1.1700068      1.1965779e-13  0              3.9257404    
   1500000   6363.961       200            200            0.004482241   -0.0019900267   0              0.01543675     9.4420866e-07  0              0.091184914    1.1965779e-13  0              3.9257406    
   1600000   6363.961       200            200            0.0044824548  -0.0019900396   0              0.015437404    3.1458345e-08  0              0.0030380218   1.1965779e-13  0              3.9257405    
   1700000   6363.961       200            200            0.004482356   -0.0019900336   0              0.015437102    1.6795916e-10  0              1.6220293e-05  1.1965779e-13  0              3.9257405    
   1800000   6363.961       200            200            0.0044823929  -0.0019900358   0              0.015437215    1.0577884e-09  0              0.00010215363  1.1965779e-13  0              3.9257405    
   1900000   6363.961       200            200            0.0044823817  -0.0019900352   0              0.01543718     3.9560137e-10  0              3.8204349e-05  1.1965779e-13  0              3.9257405    
   2000000   6363.961       200            200            0.0044823842  -0.0019900353   0              0.015437188    7.8301751e-11  0              7.5618227e-06  1.1965779e-13  0              3.9257405    
   2100000   6363.961       200            200            0.004482384   -0.0019900353   0              0.015437187    1.0280256e-11  0              9.9279351e-07  1.1965779e-13  0              3.9257405    
   2200000   6363.961       200            200            0.0044823838  -0.0019900353   0              0.015437187    8.8449196e-13  0              8.5417903e-08  1.1965779e-13  0              3.9257405    
   2300000   6363.961       200            200            0.004482384   -0.0019900353   0              0.015437187    3.7411312e-14  0              3.6129167e-09  1.1965779e-13  0              3.9257405    
   2400000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    1.3929493e-17  0              1.3452108e-12  1.1965779e-13  0              3.9257405    
   2500000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    5.9805462e-16  0              5.7755834e-11  1.1965779e-13  0              3.9257405    
   2600000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    2.9338598e-16  0              2.8333118e-11  1.1965779e-13  0              3.9257405    
   2700000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    4.4295451e-17  0              4.2777376e-12  1.1965779e-13  0              3.9257405    
   2800000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    1.7315281e-20  0              1.6721859e-15  1.1965779e-13  0              3.9257405    
   2900000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    6.0160115e-19  0              5.8098333e-14  1.1965779e-13  0              3.9257405    
   3000000   6363.961       200            200            0.0044823839  -0.0019900353   0              0.015437187    2.5963123e-18  0              2.5073326e-13  1.1965779e-13  0              3.9257405    
Loop time of 361.103 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7178009.724 ns/day, 0.000 hours/ns, 8307.882 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.125     | 115.72     | 143.36     | 255.4 | 32.05
Neigh   | 0.67007    | 0.68196    | 0.69372    |   1.1 |  0.19
Comm    | 21.932     | 49.066     | 76.82      | 383.0 | 13.59
Output  | 0.24406    | 0.24437    | 0.24469    |   0.1 |  0.07
Modify  | 105.49     | 140.52     | 174.48     | 285.1 | 38.91
Other   |            | 54.87      |            |       | 15.19

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         720.25 ave        1067 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2881
Ave neighs/atom = 1.1519392
Neighbor list builds = 123
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.87                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 133.047949827778
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.97
  ghost atom cutoff = 4.97
  binsize = 2.485, bins = 2561 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.98 | 30.99 | 31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.3473037e-14  1.0041911e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063884639  1.0041911e-13  0             -0.0019165392   102326.74      0              9.8819837e+09  1.1965779e-13  0              4.3373481    
    200000   6363.961       200            200            0.0010753589   1.0041911e-13  0              0.0032260767   98750.849      0              9.5366502e+09  1.1965779e-13  0              3.9775203    
    300000   6363.961       200            200            0.00027451041  1.0041911e-13  0              0.00082353123  9360.1134      0              9.0393275e+08  1.1965779e-13  0              3.9556656    
    400000   6363.961       200            200            0.0014843937  -0.00025418369  0              0.0047073648   5474.5224      0              5.2869019e+08  1.1965779e-13  0              3.9328163    
    500000   6363.961       200            200            0.00097956851 -0.00074598425  0              0.0036846898   0.0026417685   0              255.12309      1.1965779e-13  0              3.9329276    
    600000   6363.961       200            200            0.0047728876  -0.0019498013   0              0.016268464    122.3444       0              11815147       1.1965779e-13  0              3.9306427    
    700000   6363.961       200            200            0.0046053635  -0.0019934362   0              0.015809527    16.155932      0              1560224.3      1.1965779e-13  0              3.9306895    
    800000   6363.961       200            200            0.00436747    -0.0019798335   0              0.015082244    1.5993333      0              154452.16      1.1965779e-13  0              3.9307966    
    900000   6363.961       200            200            0.0045576819  -0.0019915729   0              0.015664618    0.107362       0              10368.254      1.1965779e-13  0              3.9307134    
   1000000   6363.961       200            200            0.0044587372  -0.0019886711   0              0.015364883    0.0024512059   0              236.71992      1.1965779e-13  0              3.9307556    
   1100000   6363.961       200            200            0.0045002054  -0.001990882    0              0.015491498    0.00011176507  0              10.79347       1.1965779e-13  0              3.9307378    
   1200000   6363.961       200            200            0.004485166   -0.0019902257   0              0.015445724    0.00018851036  0              18.204981      1.1965779e-13  0              3.9307442    
   1300000   6363.961       200            200            0.0044897723  -0.001990454    0              0.015459771    6.2630454e-05  0              6.0484009      1.1965779e-13  0              3.9307423    
   1400000   6363.961       200            200            0.0044886607  -0.0019903912   0              0.015456373    1.2506105e-05  0              1.2077501      1.1965779e-13  0              3.9307427    
   1500000   6363.961       200            200            0.0044887983  -0.0019903984   0              0.015456793    1.7984503e-06  0              0.17368146     1.1965779e-13  0              3.9307427    
   1600000   6363.961       200            200            0.0044888545  -0.0019904019   0              0.015456965    1.904428e-07   0              0.018391602    1.1965779e-13  0              3.9307426    
   1700000   6363.961       200            200            0.0044887977  -0.0019903986   0              0.015456792    1.3541028e-08  0              0.0013076956   1.1965779e-13  0              3.9307427    
   1800000   6363.961       200            200            0.0044888288  -0.0019904004   0              0.015456887    4.1659218e-10  0              4.0231491e-05  1.1965779e-13  0              3.9307427    
   1900000   6363.961       200            200            0.0044888153  -0.0019903996   0              0.015456845    3.1921292e-12  0              3.0827299e-07  1.1965779e-13  0              3.9307427    
   2000000   6363.961       200            200            0.0044888203  -0.0019903999   0              0.015456861    1.5740155e-11  0              1.5200715e-06  1.1965779e-13  0              3.9307427    
   2100000   6363.961       200            200            0.0044888187  -0.0019903998   0              0.015456856    6.0512726e-12  0              5.843886e-07   1.1965779e-13  0              3.9307427    
   2200000   6363.961       200            200            0.0044888191  -0.0019903998   0              0.015456857    1.299501e-12   0              1.2549651e-07  1.1965779e-13  0              3.9307427    
   2300000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    1.9760667e-13  0              1.9083437e-08  1.1965779e-13  0              3.9307427    
   2400000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    2.2193188e-14  0              2.1432593e-09  1.1965779e-13  0              3.9307427    
   2500000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    1.726652e-15   0              1.6674769e-10  1.1965779e-13  0              3.9307427    
   2600000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    5.1118431e-17  0              4.9366522e-12  1.1965779e-13  0              3.9307427    
   2700000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    1.0752319e-17  0              1.038382e-12   1.1965779e-13  0              3.9307427    
   2800000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    8.3593601e-18  0              8.0728717e-13  1.1965779e-13  0              3.9307427    
   2900000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    6.8160285e-18  0              6.5824325e-13  1.1965779e-13  0              3.9307427    
   3000000   6363.961       200            200            0.004488819   -0.0019903998   0              0.015456857    2.406487e-18   0              2.3240129e-13  1.1965779e-13  0              3.9307427    
Loop time of 361.879 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7162623.654 ns/day, 0.000 hours/ns, 8290.074 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.201     | 115.93     | 143.55     | 255.5 | 32.04
Neigh   | 0.65711    | 0.66892    | 0.68095    |   1.1 |  0.18
Comm    | 21.98      | 49.212     | 77.168     | 383.2 | 13.60
Output  | 0.24655    | 0.24685    | 0.24717    |   0.1 |  0.07
Modify  | 105.49     | 140.76     | 174.8      | 286.9 | 38.90
Other   |            | 55.05      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         723.25 ave        1073 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2893
Ave neighs/atom = 1.1567373
Neighbor list builds = 123
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.88                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 133.869231157745
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.98
  ghost atom cutoff = 4.98
  binsize = 2.49, bins = 2556 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.93 | 30.93 | 30.94 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.4311723e-14  1.0293517e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063471632  1.0293517e-13  0             -0.001904149    99302.58       0              9.5899324e+09  1.1965779e-13  0              4.3443828    
    200000   6363.961       200            200            0.001095763    1.0293517e-13  0              0.0032872889   101743.57      0              9.8256654e+09  1.1965779e-13  0              3.9788696    
    300000   6363.961       200            200            0.00029430943  1.0293517e-13  0              0.00088292828  10616.809      0              1.0252954e+09  1.1965779e-13  0              3.9593364    
    400000   6363.961       200            200            0.0030384801  -0.00074703491  0              0.0098624753   6069.2155      0              5.8612139e+08  1.1965779e-13  0              3.9367239    
    500000   6363.961       200            200            0.0010491119  -0.00075387161  0              0.0039012073   35.33121       0              3412035.4      1.1965779e-13  0              3.937883     
    600000   6363.961       200            200            0.0052341783  -0.0020072223   0              0.017709757    103.79875      0              10024140       1.1965779e-13  0              3.9354549    
    700000   6363.961       200            200            0.0044280048  -0.001965952    0              0.015249967    16.502996      0              1593741.2      1.1965779e-13  0              3.9357721    
    800000   6363.961       200            200            0.0044428765  -0.0019860366   0              0.015314666    2.1208817      0              204819.57      1.1965779e-13  0              3.935769     
    900000   6363.961       200            200            0.0045408985  -0.0019924237   0              0.015615119    0.21432646     0              20698.116      1.1965779e-13  0              3.9357251    
   1000000   6363.961       200            200            0.0044700887  -0.0019908319   0              0.015401098    0.014793869    0              1428.686       1.1965779e-13  0              3.9357555    
   1100000   6363.961       200            200            0.0045057725  -0.0019924955   0              0.015509813    0.00048613648  0              46.947582      1.1965779e-13  0              3.9357402    
   1200000   6363.961       200            200            0.0044906218  -0.0019918443   0              0.01546371     1.1587003e-06  0              0.11189898     1.1965779e-13  0              3.9357466    
   1300000   6363.961       200            200            0.0044962596  -0.001992134    0              0.015480913    1.37706e-05    0              1.329866       1.1965779e-13  0              3.9357442    
   1400000   6363.961       200            200            0.0044943969  -0.0019920288   0              0.01547522     5.8676353e-06  0              0.56665422     1.1965779e-13  0              3.935745     
   1500000   6363.961       200            200            0.0044949274  -0.0019920584   0              0.01547684     1.3833216e-06  0              0.1335913      1.1965779e-13  0              3.9357448    
   1600000   6363.961       200            200            0.0044948113  -0.001992052    0              0.015476486    2.3757284e-07  0              0.022943085    1.1965779e-13  0              3.9357448    
   1700000   6363.961       200            200            0.0044948201  -0.0019920524   0              0.015476513    3.1961641e-08  0              0.0030866265   1.1965779e-13  0              3.9357448    
   1800000   6363.961       200            200            0.0044948297  -0.001992053    0              0.015476542    3.3668669e-09  0              0.0003251479   1.1965779e-13  0              3.9357448    
   1900000   6363.961       200            200            0.0044948219  -0.0019920525   0              0.015476518    2.5787846e-10  0              2.4904056e-05  1.1965779e-13  0              3.9357448    
   2000000   6363.961       200            200            0.004494826   -0.0019920528   0              0.015476531    1.0840761e-11  0              1.0469231e-06  1.1965779e-13  0              3.9357448    
   2100000   6363.961       200            200            0.0044948242  -0.0019920527   0              0.015476525    1.3029057e-14  0              1.258253e-09   1.1965779e-13  0              3.9357448    
   2200000   6363.961       200            200            0.0044948249  -0.0019920527   0              0.015476527    1.3327289e-13  0              1.2870542e-08  1.1965779e-13  0              3.9357448    
   2300000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    7.1403912e-14  0              6.8956787e-09  1.1965779e-13  0              3.9357448    
   2400000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    1.8657723e-14  0              1.8018294e-09  1.1965779e-13  0              3.9357448    
   2500000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    3.347462e-15   0              3.2327392e-10  1.1965779e-13  0              3.9357448    
   2600000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    4.7583879e-16  0              4.5953104e-11  1.1965779e-13  0              3.9357448    
   2700000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    6.8370715e-17  0              6.6027543e-12  1.1965779e-13  0              3.9357448    
   2800000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    2.1750257e-18  0              2.1004841e-13  1.1965779e-13  0              3.9357448    
   2900000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    1.8112324e-19  0              1.7491587e-14  1.1965779e-13  0              3.9357448    
   3000000   6363.961       200            200            0.0044948247  -0.0019920527   0              0.015476527    6.6195419e-19  0              6.3926797e-14  1.1965779e-13  0              3.9357448    
Loop time of 364.369 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7113676.108 ns/day, 0.000 hours/ns, 8233.421 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.128     | 116.14     | 144.29     | 256.9 | 31.87
Neigh   | 0.67513    | 0.68716    | 0.69926    |   1.1 |  0.19
Comm    | 22.392     | 49.468     | 78.127     | 383.7 | 13.58
Output  | 0.247      | 0.2473     | 0.24765    |   0.1 |  0.07
Modify  | 106.74     | 142.49     | 176.94     | 284.4 | 39.11
Other   |            | 55.34      |            |       | 15.19

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         726.25 ave        1079 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2905
Ave neighs/atom = 1.1615354
Neighbor list builds = 125
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.89                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 134.693885301585
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.99
  ghost atom cutoff = 4.99
  binsize = 2.495, bins = 2551 81 81
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.9 | 30.91 | 30.91 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.5158362e-14  1.0547509e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00063041945  1.0547509e-13  0             -0.0018912583   96325.412      0              9.3024188e+09  1.1965779e-13  0              4.351381     
    200000   6363.961       200            200            0.0011162602   1.0547509e-13  0              0.0033487807   104778.03      0              1.0118712e+10  1.1965779e-13  0              3.9801589    
    300000   6363.961       200            200            0.00031431419  1.0547509e-13  0              0.00094294257  11950.872      0              1.1541297e+09  1.1965779e-13  0              3.9629211    
    400000   6363.961       200            200            0.005289761   -0.001418367    0              0.01728765     6225.6453      0              6.0122826e+08  1.1965779e-13  0              3.9405926    
    500000   6363.961       200            200            0.0012366842  -0.00076866779  0              0.0044787204   138.11987      0              13338628       1.1965779e-13  0              3.9427445    
    600000   6363.961       200            200            0.0056720725  -0.0020174697   0              0.019033687    72.660508      0              7017031.8      1.1965779e-13  0              3.9402893    
    700000   6363.961       200            200            0.004254458   -0.0019567045   0              0.014720079    13.999595      0              1351980.6      1.1965779e-13  0              3.940852     
    800000   6363.961       200            200            0.0045249654  -0.00199137     0              0.015566266    2.2215198      0              214538.48      1.1965779e-13  0              3.9407388    
    900000   6363.961       200            200            0.0045182594  -0.0019928306   0              0.015547609    0.28893884     0              27903.645      1.1965779e-13  0              3.9407392    
   1000000   6363.961       200            200            0.0044856877  -0.0019921859   0              0.015449249    0.030470511    0              2942.6238      1.1965779e-13  0              3.9407537    
   1100000   6363.961       200            200            0.0045095668  -0.0019930223   0              0.015521723    0.0025112688   0              242.52037      1.1965779e-13  0              3.9407433    
   1200000   6363.961       200            200            0.0044973804  -0.0019925075   0              0.015484649    0.00013472559  0              13.010834      1.1965779e-13  0              3.9407486    
   1300000   6363.961       200            200            0.0045026832  -0.0019928034   0              0.015500853    1.9305627e-06  0              0.18643993     1.1965779e-13  0              3.9407463    
   1400000   6363.961       200            200            0.0045006008  -0.0019926865   0              0.015494489    3.4841003e-07  0              0.033646947    1.1965779e-13  0              3.9407472    
   1500000   6363.961       200            200            0.0045013462  -0.0019927279   0              0.015496767    3.6126137e-07  0              0.034888037    1.1965779e-13  0              3.9407469    
   1600000   6363.961       200            200            0.0045011043  -0.0019927145   0              0.015496027    1.1684004e-07  0              0.011283575    1.1965779e-13  0              3.940747     
   1700000   6363.961       200            200            0.0045011734  -0.0019927183   0              0.015496239    2.5165455e-08  0              0.0024302995   1.1965779e-13  0              3.9407469    
   1800000   6363.961       200            200            0.0045011576  -0.0019927175   0              0.01549619     4.2443607e-09  0              0.00040988998  1.1965779e-13  0              3.9407469    
   1900000   6363.961       200            200            0.0045011594  -0.0019927176   0              0.015496196    5.9021822e-10  0              5.6999051e-05  1.1965779e-13  0              3.9407469    
   2000000   6363.961       200            200            0.0045011603  -0.0019927176   0              0.015496198    6.8098656e-11  0              6.5764807e-06  1.1965779e-13  0              3.9407469    
   2100000   6363.961       200            200            0.0045011594  -0.0019927176   0              0.015496196    6.3073775e-12  0              6.0912137e-07  1.1965779e-13  0              3.9407469    
   2200000   6363.961       200            200            0.0045011599  -0.0019927176   0              0.015496197    4.20869e-13    0              4.0644516e-08  1.1965779e-13  0              3.9407469    
   2300000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    1.3512418e-14  0              1.3049327e-09  1.1965779e-13  0              3.9407469    
   2400000   6363.961       200            200            0.0045011598  -0.0019927176   0              0.015496197    3.5204946e-17  0              3.3998417e-12  1.1965779e-13  0              3.9407469    
   2500000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    4.035085e-16   0              3.8967962e-11  1.1965779e-13  0              3.9407469    
   2600000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    1.7798618e-16  0              1.7188631e-11  1.1965779e-13  0              3.9407469    
   2700000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    2.0496614e-17  0              1.9794163e-12  1.1965779e-13  0              3.9407469    
   2800000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    1.5847096e-18  0              1.5303991e-13  1.1965779e-13  0              3.9407469    
   2900000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    3.2508012e-18  0              3.1393911e-13  1.1965779e-13  0              3.9407469    
   3000000   6363.961       200            200            0.0045011597  -0.0019927176   0              0.015496197    6.7674275e-18  0              6.5354971e-13  1.1965779e-13  0              3.9407469    
Loop time of 362.566 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7149051.288 ns/day, 0.000 hours/ns, 8274.365 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.137     | 116.29     | 144.47     | 257.6 | 32.07
Neigh   | 0.69051    | 0.7028     | 0.71504    |   1.1 |  0.19
Comm    | 22.424     | 49.547     | 78.077     | 384.4 | 13.67
Output  | 0.24454    | 0.24485    | 0.2452     |   0.1 |  0.07
Modify  | 105.57     | 140.83     | 174.67     | 283.6 | 38.84
Other   |            | 54.96      |            |       | 15.16

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         728.75 ave        1084 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2915
Ave neighs/atom = 1.1655338
Neighbor list builds = 127
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.9                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 135.521919170801
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5
  ghost atom cutoff = 5
  binsize = 2.5, bins = 2546 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 31.71 | 31.72 | 31.73 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.6012923e-14  1.0803877e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00062595634  1.0803877e-13  0             -0.001877869    93395.156      0              9.0194357e+09  1.1965779e-13  0              4.3583427    
    200000   6363.961       200            200            0.0011368497   1.0803877e-13  0              0.003410549    107854.09      0              1.0415776e+10  1.1965779e-13  0              3.9813881    
    300000   6363.961       200            200            0.00033452263  1.0803877e-13  0              0.0010035679   13361.99       0              1.2904053e+09  1.1965779e-13  0              3.9664195    
    400000   6363.961       200            200            0.008210749   -0.0021179405   0              0.026750187    5769.745       0              5.5720067e+08  1.1965779e-13  0              3.9444719    
    500000   6363.961       200            200            0.0015552502  -0.00080241999  0              0.0054681705   295.04633      0              28493463       1.1965779e-13  0              3.9475163    
    600000   6363.961       200            200            0.0060156408  -0.0020648584   0              0.020111781    38.096176      0              3679056        1.1965779e-13  0              3.9451595    
    700000   6363.961       200            200            0.0041015638  -0.0019615382   0              0.01426623     9.5543405      0              922689.81      1.1965779e-13  0              3.9459224    
    800000   6363.961       200            200            0.0046058075  -0.0019948724   0              0.015812295    1.8551379      0              179155.94      1.1965779e-13  0              3.9457096    
    900000   6363.961       200            200            0.004493323   -0.00199358     0              0.015473549    0.29348336     0              28342.522      1.1965779e-13  0              3.9457544    
   1000000   6363.961       200            200            0.0045036183  -0.0019940648   0              0.01550492     0.039913569    0              3854.5668      1.1965779e-13  0              3.9457508    
   1100000   6363.961       200            200            0.0045115608  -0.0019941425   0              0.015528825    0.0046786618   0              451.83167      1.1965779e-13  0              3.9457472    
   1200000   6363.961       200            200            0.0045047497  -0.0019939064   0              0.015508155    0.00046385764  0              44.796051      1.1965779e-13  0              3.9457502    
   1300000   6363.961       200            200            0.0045084885  -0.0019941169   0              0.015519582    3.6582565e-05  0              3.5328823      1.1965779e-13  0              3.9457486    
   1400000   6363.961       200            200            0.0045067511  -0.0019940193   0              0.015514273    1.9134126e-06  0              0.18478369     1.1965779e-13  0              3.9457493    
   1500000   6363.961       200            200            0.0045074785  -0.0019940598   0              0.015516495    2.7292909e-08  0              0.0026357538   1.1965779e-13  0              3.945749     
   1600000   6363.961       200            200            0.0045071972  -0.0019940442   0              0.015515636    4.8084055e-09  0              0.00046436138  1.1965779e-13  0              3.9457491    
   1700000   6363.961       200            200            0.0045072986  -0.0019940498   0              0.015515945    5.0982929e-09  0              0.00049235664  1.1965779e-13  0              3.9457491    
   1800000   6363.961       200            200            0.0045072647  -0.0019940479   0              0.015515842    1.7018596e-09  0              0.00016435342  1.1965779e-13  0              3.9457491    
   1900000   6363.961       200            200            0.004507275   -0.0019940485   0              0.015515874    3.8459773e-10  0              3.7141696e-05  1.1965779e-13  0              3.9457491    
   2000000   6363.961       200            200            0.0045072722  -0.0019940483   0              0.015515865    6.951411e-11   0              6.7131752e-06  1.1965779e-13  0              3.9457491    
   2100000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.0663966e-11  0              1.0298495e-06  1.1965779e-13  0              3.9457491    
   2200000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.4180814e-12  0              1.3694815e-07  1.1965779e-13  0              3.9457491    
   2300000   6363.961       200            200            0.0045072727  -0.0019940484   0              0.015515867    1.6302501e-13  0              1.5743789e-08  1.1965779e-13  0              3.9457491    
   2400000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.6036117e-14  0              1.5486534e-09  1.1965779e-13  0              3.9457491    
   2500000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.2143986e-15  0              1.1727793e-10  1.1965779e-13  0              3.9457491    
   2600000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    4.5351497e-17  0              4.379723e-12   1.1965779e-13  0              3.9457491    
   2700000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.1957323e-17  0              1.1547527e-12  1.1965779e-13  0              3.9457491    
   2800000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    1.0169864e-17  0              9.8213271e-13  1.1965779e-13  0              3.9457491    
   2900000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    2.8098193e-18  0              2.7135224e-13  1.1965779e-13  0              3.9457491    
   3000000   6363.961       200            200            0.0045072728  -0.0019940484   0              0.015515867    3.2713475e-18  0              3.1592332e-13  1.1965779e-13  0              3.9457491    
Loop time of 363.424 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7132167.005 ns/day, 0.000 hours/ns, 8254.823 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.134     | 116.32     | 144.52     | 258.8 | 32.01
Neigh   | 0.71921    | 0.73129    | 0.74319    |   1.1 |  0.20
Comm    | 21.948     | 49.304     | 77.767     | 387.0 | 13.57
Output  | 0.24647    | 0.24678    | 0.2471     |   0.1 |  0.07
Modify  | 106.58     | 141.85     | 175.86     | 283.5 | 39.03
Other   |            | 54.97      |            |       | 15.13

Nlocal:         625.25 ave         876 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           4 max           3 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:         731.25 ave        1088 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2925
Ave neighs/atom = 1.1695322
Neighbor list builds = 129
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.91                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 136.353339676899
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.01
  ghost atom cutoff = 5.01
  binsize = 2.505, bins = 2541 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.42 | 30.43 | 30.44 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.6875375e-14  1.1062612e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00062132754  1.1062612e-13  0             -0.0018639826   90511.735      0              8.7409755e+09  1.1965779e-13  0              4.3652677    
    200000   6363.961       200            200            0.0011575305   1.1062612e-13  0              0.0034725914   110971.64      0              1.0716846e+10  1.1965779e-13  0              3.9825571    
    300000   6363.961       200            200            0.00035493297  1.1062612e-13  0              0.0010647989   14849.868      0              1.434094e+09   1.1965779e-13  0              3.9698315    
    400000   6363.961       200            200            0.011445471   -0.0031862182   0              0.037522632    4658.1821      0              4.4985388e+08  1.1965779e-13  0              3.9484252    
    500000   6363.961       200            200            0.0019951935  -0.00094609004  0              0.0069316705   483.56457      0              46699205       1.1965779e-13  0              3.9522058    
    600000   6363.961       200            200            0.0062653846  -0.0020294488   0              0.020825603    10.947301      0              1057212        1.1965779e-13  0              3.9500763    
    700000   6363.961       200            200            0.0039861978  -0.0019682475   0              0.013926841    4.717197       0              455553.12      1.1965779e-13  0              3.9509772    
    800000   6363.961       200            200            0.0046770511  -0.0019960512   0              0.016027205    1.1746898      0              113443.14      1.1965779e-13  0              3.9506848    
    900000   6363.961       200            200            0.0044707217  -0.001993061    0              0.015405226    0.22579901     0              21806.053      1.1965779e-13  0              3.9507688    
   1000000   6363.961       200            200            0.004522454   -0.001994986    0              0.015562348    0.037358587    0              3607.8249      1.1965779e-13  0              3.9507477    
   1100000   6363.961       200            200            0.0045130499  -0.0019944062   0              0.015533556    0.0054292868   0              524.32165      1.1965779e-13  0              3.9507514    
   1200000   6363.961       200            200            0.0045129398  -0.001994509    0              0.015533328    0.00070950951  0              68.51935       1.1965779e-13  0              3.9507515    
   1300000   6363.961       200            200            0.0045142638  -0.001994587    0              0.015537378    8.310215e-05   0              8.0254109      1.1965779e-13  0              3.9507509    
   1400000   6363.961       200            200            0.0045133277  -0.0019945337   0              0.015534517    8.5739757e-06  0              0.8280132      1.1965779e-13  0              3.9507514    
   1500000   6363.961       200            200            0.0045138187  -0.0019945613   0              0.015536017    7.4855182e-07  0              0.072289777    1.1965779e-13  0              3.9507511    
   1600000   6363.961       200            200            0.0045135938  -0.0019945487   0              0.01553533     5.0177628e-08  0              0.0048457962   1.1965779e-13  0              3.9507512    
   1700000   6363.961       200            200            0.0045136884  -0.001994554    0              0.015535619    1.8983171e-09  0              0.00018332588  1.1965779e-13  0              3.9507512    
   1800000   6363.961       200            200            0.0045136511  -0.0019945519   0              0.015535505    9.3201644e-13  0              9.0007477e-08  1.1965779e-13  0              3.9507512    
   1900000   6363.961       200            200            0.004513665   -0.0019945527   0              0.015535548    2.684628e-11   0              2.5926216e-06  1.1965779e-13  0              3.9507512    
   2000000   6363.961       200            200            0.0045136601  -0.0019945524   0              0.015535533    1.4707052e-11  0              1.4203018e-06  1.1965779e-13  0              3.9507512    
   2100000   6363.961       200            200            0.0045136617  -0.0019945525   0              0.015535538    4.1750676e-12  0              4.0319814e-07  1.1965779e-13  0              3.9507512    
   2200000   6363.961       200            200            0.0045136612  -0.0019945525   0              0.015535536    8.9190778e-13  0              8.6134069e-08  1.1965779e-13  0              3.9507512    
   2300000   6363.961       200            200            0.0045136614  -0.0019945525   0              0.015535537    1.6015194e-13  0              1.5466328e-08  1.1965779e-13  0              3.9507512    
   2400000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    2.5149231e-14  0              2.4287327e-09  1.1965779e-13  0              3.9507512    
   2500000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    3.5415399e-15  0              3.4201658e-10  1.1965779e-13  0              3.9507512    
   2600000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    4.3987058e-16  0              4.2479552e-11  1.1965779e-13  0              3.9507512    
   2700000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    6.7325386e-17  0              6.5018039e-12  1.1965779e-13  0              3.9507512    
   2800000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    1.5997367e-18  0              1.5449112e-13  1.1965779e-13  0              3.9507512    
   2900000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    2.5746846e-19  0              2.4864461e-14  1.1965779e-13  0              3.9507512    
   3000000   6363.961       200            200            0.0045136613  -0.0019945525   0              0.015535537    1.1894717e-19  0              1.1487067e-14  1.1965779e-13  0              3.9507512    
Loop time of 363.941 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7122036.961 ns/day, 0.000 hours/ns, 8243.098 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.57      | 116.67     | 144.86     | 257.9 | 32.06
Neigh   | 0.68776    | 0.70022    | 0.71254    |   1.2 |  0.19
Comm    | 22.255     | 49.586     | 78.03      | 386.2 | 13.62
Output  | 0.24661    | 0.24692    | 0.24724    |   0.1 |  0.07
Modify  | 105.53     | 141.13     | 175.88     | 287.6 | 38.78
Other   |            | 55.6       |            |       | 15.28

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         733.75 ave        1094 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2935
Ave neighs/atom = 1.1735306
Neighbor list builds = 131
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.92                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 137.18815373138
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.02
  ghost atom cutoff = 5.02
  binsize = 2.51, bins = 2536 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.37 | 30.37 | 30.38 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.7745686e-14  1.1323706e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.0006165336   1.1323706e-13  0             -0.0018496008   87675.07       0              8.4670307e+09  1.1965779e-13  0              4.372156     
    200000   6363.961       200            200            0.0011783016   1.1323706e-13  0              0.0035349047   114130.53      0              1.102191e+10   1.1965779e-13  0              3.9836656    
    300000   6363.961       200            200            0.00037554316  1.1323706e-13  0              0.0011266295   16414.194      0              1.5851654e+09  1.1965779e-13  0              3.9731566    
    400000   6363.961       200            200            0.014869198   -0.0036864879   0              0.048294082    3073.9499      0              2.9686008e+08  1.1965779e-13  0              3.9525251    
    500000   6363.961       200            200            0.002631286   -0.0010495665   0              0.0089434246   672.3443       0              64930200       1.1965779e-13  0              3.9568245    
    600000   6363.961       200            200            0.0063600368  -0.0020143384   0              0.021094449    0.028308768    0              2733.8582      1.1965779e-13  0              3.955047     
    700000   6363.961       200            200            0.0039232927  -0.001959617    0              0.013729495    1.1380615      0              109905.83      1.1965779e-13  0              3.9560118    
    800000   6363.961       200            200            0.0047307949  -0.0019960382   0              0.016188423    0.47032265     0              45420.395      1.1965779e-13  0              3.9556674    
    900000   6363.961       200            200            0.0044540403  -0.0019919793   0              0.0153541      0.12021051     0              11609.07       1.1965779e-13  0              3.9557809    
   1000000   6363.961       200            200            0.0045400464  -0.0019953742   0              0.015615513    0.024410387    0              2357.3805      1.1965779e-13  0              3.9557452    
   1100000   6363.961       200            200            0.0045148091  -0.0019942985   0              0.015538726    0.0042510075   0              410.53187      1.1965779e-13  0              3.9557555    
   1200000   6363.961       200            200            0.0045214049  -0.0019947333   0              0.015558948    0.00067181259  0              64.878851      1.1965779e-13  0              3.9557528    
   1300000   6363.961       200            200            0.0045200221  -0.0019946628   0              0.015554729    9.7624828e-05  0              9.4279071      1.1965779e-13  0              3.9557534    
   1400000   6363.961       200            200            0.0045201263  -0.0019946666   0              0.015555045    1.3135067e-05  0              1.2684907      1.1965779e-13  0              3.9557534    
   1500000   6363.961       200            200            0.0045202377  -0.0019946733   0              0.015555387    1.6359519e-06  0              0.15798852     1.1965779e-13  0              3.9557533    
   1600000   6363.961       200            200            0.0045201434  -0.0019946679   0              0.015555098    1.8739575e-07  0              0.01809734     1.1965779e-13  0              3.9557533    
   1700000   6363.961       200            200            0.0045201963  -0.0019946709   0              0.01555526     1.9446245e-08  0              0.0018779792   1.1965779e-13  0              3.9557533    
   1800000   6363.961       200            200            0.0045201709  -0.0019946695   0              0.015555182    1.7731683e-09  0              0.0001712399   1.1965779e-13  0              3.9557533    
   1900000   6363.961       200            200            0.0045201821  -0.0019946701   0              0.015555216    1.3315096e-10  0              1.2858767e-05  1.1965779e-13  0              3.9557533    
   2000000   6363.961       200            200            0.0045201775  -0.0019946699   0              0.015555202    6.9521411e-12  0              6.7138802e-07  1.1965779e-13  0              3.9557533    
   2100000   6363.961       200            200            0.0045201793  -0.00199467     0              0.015555208    1.1880812e-13  0              1.1473638e-08  1.1965779e-13  0              3.9557533    
   2200000   6363.961       200            200            0.0045201786  -0.0019946699   0              0.015555206    1.1372436e-14  0              1.0982684e-09  1.1965779e-13  0              3.9557533    
   2300000   6363.961       200            200            0.0045201789  -0.0019946699   0              0.015555207    1.5440557e-14  0              1.4911385e-09  1.1965779e-13  0              3.9557533    
   2400000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    5.7471363e-15  0              5.5501728e-10  1.1965779e-13  0              3.9557533    
   2500000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    1.3356943e-15  0              1.2899179e-10  1.1965779e-13  0              3.9557533    
   2600000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    2.7280831e-16  0              2.6345874e-11  1.1965779e-13  0              3.9557533    
   2700000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    3.6852925e-17  0              3.5589917e-12  1.1965779e-13  0              3.9557533    
   2800000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    1.150228e-18   0              1.1108079e-13  1.1965779e-13  0              3.9557533    
   2900000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    5.1818709e-19  0              5.00428e-14    1.1965779e-13  0              3.9557533    
   3000000   6363.961       200            200            0.0045201788  -0.0019946699   0              0.015555206    1.9964201e-20  0              1.9279996e-15  1.1965779e-13  0              3.9557533    
Loop time of 365.041 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7100567.686 ns/day, 0.000 hours/ns, 8218.250 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.29      | 116.83     | 145.43     | 261.5 | 32.00
Neigh   | 0.70939    | 0.72274    | 0.73612    |   1.2 |  0.20
Comm    | 22.264     | 50.123     | 79.304     | 390.7 | 13.73
Output  | 0.2438     | 0.2441     | 0.24443    |   0.1 |  0.07
Modify  | 105.48     | 141.28     | 176.59     | 287.5 | 38.70
Other   |            | 55.84      |            |       | 15.30

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         736.25 ave        1099 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2945
Ave neighs/atom = 1.177529
Neighbor list builds = 133
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.93                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 138.02636824575
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.03
  ghost atom cutoff = 5.03
  binsize = 2.515, bins = 2531 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.34 | 30.35 | 30.35 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.8623827e-14  1.1587148e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00061157508  1.1587148e-13  0             -0.0018347252   84885.086      0              8.1975941e+09  1.1965779e-13  0              4.3790074    
    200000   6363.961       200            200            0.0011991621   1.1587148e-13  0              0.0035974862   117330.66      0              1.1330955e+10  1.1965779e-13  0              3.9847134    
    300000   6363.961       200            200            0.00039635131  1.1587148e-13  0              0.0011890539   18054.668      0              1.7435906e+09  1.1965779e-13  0              3.9763948    
    400000   6363.961       200            200            0.017798611   -0.0039822034   0              0.057378036    1436.8591      0              1.3876157e+08  1.1965779e-13  0              3.9568446    
    500000   6363.961       200            200            0.0034628018  -0.0011513299   0              0.011539735    823.62511      0              79539818       1.1965779e-13  0              3.9613885    
    600000   6363.961       200            200            0.0062918624  -0.0020113803   0              0.020886967    8.8876198      0              858302.71      1.1965779e-13  0              3.9600744    
    700000   6363.961       200            200            0.0039113312  -0.0019562537   0              0.013690247    0.016343031    0              1578.293       1.1965779e-13  0              3.9610235    
    800000   6363.961       200            200            0.0047609816  -0.0019962155   0              0.01627916     0.04489738     0              4335.8676      1.1965779e-13  0              3.9606596    
    900000   6363.961       200            200            0.004445837   -0.0019918125   0              0.015329324    0.030006955    0              2897.8569      1.1965779e-13  0              3.9607893    
   1000000   6363.961       200            200            0.0045543655  -0.0019960131   0              0.01565911     0.0089653589   0              865.8102       1.1965779e-13  0              3.960744     
   1100000   6363.961       200            200            0.0045174567  -0.0019946361   0              0.015547006    0.0019993655   0              193.08441      1.1965779e-13  0              3.9607593    
   1200000   6363.961       200            200            0.0045294758  -0.0019953077   0              0.015583735    0.00038617231  0              37.293757      1.1965779e-13  0              3.9607543    
   1300000   6363.961       200            200            0.0045257021  -0.001995106    0              0.015572212    6.7410757e-05  0              6.5100484      1.1965779e-13  0              3.9607558    
   1400000   6363.961       200            200            0.0045268159  -0.0019951648   0              0.015575613    1.0902703e-05  0              1.052905       1.1965779e-13  0              3.9607554    
   1500000   6363.961       200            200            0.0045265174  -0.0019951492   0              0.015574702    1.6544513e-06  0              0.15977507     1.1965779e-13  0              3.9607555    
   1600000   6363.961       200            200            0.0045265837  -0.0019951525   0              0.015574904    2.3729089e-07  0              0.022915856    1.1965779e-13  0              3.9607555    
   1700000   6363.961       200            200            0.0045265759  -0.0019951522   0              0.01557488     3.2277523e-08  0              0.0031171322   1.1965779e-13  0              3.9607555    
   1800000   6363.961       200            200            0.0045265726  -0.001995152    0              0.01557487     4.1660665e-09  0              0.00040232888  1.1965779e-13  0              3.9607555    
   1900000   6363.961       200            200            0.004526576   -0.0019951522   0              0.01557488     5.0904399e-10  0              4.9159825e-05  1.1965779e-13  0              3.9607555    
   2000000   6363.961       200            200            0.004526574   -0.0019951521   0              0.015574874    5.8550449e-11  0              5.6543833e-06  1.1965779e-13  0              3.9607555    
   2100000   6363.961       200            200            0.004526575   -0.0019951521   0              0.015574877    6.2726438e-12  0              6.0576704e-07  1.1965779e-13  0              3.9607555    
   2200000   6363.961       200            200            0.0045265746  -0.0019951521   0              0.015574876    6.1326821e-13  0              5.9225054e-08  1.1965779e-13  0              3.9607555    
   2300000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    5.3103264e-14  0              5.1283332e-09  1.1965779e-13  0              3.9607555    
   2400000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    3.614976e-15   0              3.4910851e-10  1.1965779e-13  0              3.9607555    
   2500000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    1.8198332e-16  0              1.7574647e-11  1.1965779e-13  0              3.9607555    
   2600000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    2.4010524e-18  0              2.3187646e-13  1.1965779e-13  0              3.9607555    
   2700000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    3.9195212e-18  0              3.7851931e-13  1.1965779e-13  0              3.9607555    
   2800000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    1.0121126e-17  0              9.7742586e-13  1.1965779e-13  0              3.9607555    
   2900000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    2.9774909e-18  0              2.8754476e-13  1.1965779e-13  0              3.9607555    
   3000000   6363.961       200            200            0.0045265747  -0.0019951521   0              0.015574876    5.018749e-18   0              4.8467485e-13  1.1965779e-13  0              3.9607555    
Loop time of 361.391 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7172279.281 ns/day, 0.000 hours/ns, 8301.249 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.207     | 115.67     | 143.09     | 252.2 | 32.01
Neigh   | 0.67738    | 0.68985    | 0.70213    |   1.2 |  0.19
Comm    | 22.305     | 48.896     | 76.68      | 377.7 | 13.53
Output  | 0.24496    | 0.24526    | 0.24559    |   0.1 |  0.07
Modify  | 105.59     | 140.86     | 174.85     | 284.2 | 38.98
Other   |            | 55.03      |            |       | 15.23

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         711.25 ave        1049 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2845
Ave neighs/atom = 1.137545
Neighbor list builds = 130
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.94                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 138.867990131512
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.04
  ghost atom cutoff = 5.04
  binsize = 2.52, bins = 2526 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.3 | 30.31 | 30.31 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            3.9509769e-14  1.1852931e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00060645251  1.1852931e-13  0             -0.0018193575   82141.706      0              7.932658e+09   1.1965779e-13  0              4.3858219    
    200000   6363.961       200            200            0.001220111    1.1852931e-13  0              0.0036603331   120571.87      0              1.1643968e+10  1.1965779e-13  0              3.9857005    
    300000   6363.961       200            200            0.00041735542  1.1852931e-13  0              0.0012520662   19770.979      0              1.9093396e+09  1.1965779e-13  0              3.9795457    
    400000   6363.961       200            200            0.019679435   -0.0040145827   0              0.063052888    283.42298      0              27370963       1.1965779e-13  0              3.9614459    
    500000   6363.961       200            200            0.0044733244  -0.0012685384   0              0.014688511    900.06338      0              86921679       1.1965779e-13  0              3.9659186    
    600000   6363.961       200            200            0.0060743945  -0.0020033996   0              0.020226583    34.446995      0              3326644.2      1.1965779e-13  0              3.9651563    
    700000   6363.961       200            200            0.0039515505  -0.001959064    0              0.013813716    1.7131591      0              165444.64      1.1965779e-13  0              3.9660113    
    800000   6363.961       200            200            0.0047646583  -0.0019967361   0              0.016290711    0.081136375    0              7835.5703      1.1965779e-13  0              3.9656624    
    900000   6363.961       200            200            0.0044479923  -0.0019927258   0              0.015336703    0.00050807292  0              49.066046      1.1965779e-13  0              3.9657933    
   1000000   6363.961       200            200            0.0045641368  -0.0019969623   0              0.015689373    0.00034164864  0              32.99398       1.1965779e-13  0              3.9657445    
   1100000   6363.961       200            200            0.0045216721  -0.0019954381   0              0.015560454    0.00026041327  0              25.148849      1.1965779e-13  0              3.9657622    
   1200000   6363.961       200            200            0.0045367867  -0.0019962543   0              0.015606614    8.5618258e-05  0              8.2683985      1.1965779e-13  0              3.9657559    
   1300000   6363.961       200            200            0.0045314632  -0.001995966    0              0.015590356    2.0793223e-05  0              2.0080606      1.1965779e-13  0              3.9657581    
   1400000   6363.961       200            200            0.0045333021  -0.0019960647   0              0.015595971    4.2998499e-06  0              0.41524873     1.1965779e-13  0              3.9657574    
   1500000   6363.961       200            200            0.0045326806  -0.0019960313   0              0.015594073    8.0152512e-07  0              0.077405559    1.1965779e-13  0              3.9657576    
   1600000   6363.961       200            200            0.0045328853  -0.0019960423   0              0.015594698    1.3871304e-07  0              0.013395912    1.1965779e-13  0              3.9657575    
   1700000   6363.961       200            200            0.00453282    -0.0019960388   0              0.015594499    2.2660466e-08  0              0.0021883856   1.1965779e-13  0              3.9657576    
   1800000   6363.961       200            200            0.00453284    -0.0019960398   0              0.01559456     3.5304075e-09  0              0.00034094149  1.1965779e-13  0              3.9657576    
   1900000   6363.961       200            200            0.0045328343  -0.0019960395   0              0.015594542    5.2795578e-10  0              5.098619e-05   1.1965779e-13  0              3.9657576    
   2000000   6363.961       200            200            0.0045328357  -0.0019960396   0              0.015594547    7.6092985e-11  0              7.3485158e-06  1.1965779e-13  0              3.9657576    
   2100000   6363.961       200            200            0.0045328354  -0.0019960396   0              0.015594546    1.0594661e-11  0              1.0231565e-06  1.1965779e-13  0              3.9657576    
   2200000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    1.4268063e-12  0              1.3779074e-07  1.1965779e-13  0              3.9657576    
   2300000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    1.856134e-13   0              1.7925214e-08  1.1965779e-13  0              3.9657576    
   2400000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    2.3405813e-14  0              2.2603659e-09  1.1965779e-13  0              3.9657576    
   2500000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    2.7992664e-15  0              2.7033311e-10  1.1965779e-13  0              3.9657576    
   2600000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    3.1984156e-16  0              3.0888009e-11  1.1965779e-13  0              3.9657576    
   2700000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    5.4666695e-17  0              5.2793181e-12  1.1965779e-13  0              3.9657576    
   2800000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    2.5558553e-18  0              2.4682621e-13  1.1965779e-13  0              3.9657576    
   2900000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    3.9900943e-18  0              3.8533475e-13  1.1965779e-13  0              3.9657576    
   3000000   6363.961       200            200            0.0045328355  -0.0019960396   0              0.015594546    1.3627265e-18  0              1.3160237e-13  1.1965779e-13  0              3.9657576    
Loop time of 361.811 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7163953.825 ns/day, 0.000 hours/ns, 8291.613 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.495     | 116.16     | 143.89     | 255.1 | 32.11
Neigh   | 0.65814    | 0.67057    | 0.68229    |   1.1 |  0.19
Comm    | 22.096     | 49.218     | 77.242     | 382.2 | 13.60
Output  | 0.24387    | 0.24417    | 0.2445     |   0.1 |  0.07
Modify  | 105.24     | 140.5      | 174.41     | 284.0 | 38.83
Other   |            | 55.02      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         714.75 ave        1056 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2859
Ave neighs/atom = 1.1431427
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.95                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 139.71302630017
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.05
  ghost atom cutoff = 5.05
  binsize = 2.525, bins = 2521 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.29 | 30.29 | 30.3 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.0403484e-14  1.2121045e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00060116644  1.2121045e-13  0             -0.0018034993   79444.843      0              7.6722143e+09  1.1965779e-13  0              4.3925995    
    200000   6363.961       200            200            0.0012411476   1.2121045e-13  0              0.0037234428   123854.07      0              1.196094e+10   1.1965779e-13  0              3.9866266    
    300000   6363.961       200            200            0.00043855371  1.2121045e-13  0              0.0013156611   21562.84       0              2.0823847e+09  1.1965779e-13  0              3.9826091    
    400000   6363.961       200            200            0.020050001   -0.004009581    0              0.064159585    34.507962      0              3332532        1.1965779e-13  0              3.9663687    
    500000   6363.961       200            200            0.0055565724  -0.0015916257   0              0.018261343    874.84078      0              84485861       1.1965779e-13  0              3.9704405    
    600000   6363.961       200            200            0.005721818   -0.0020227952   0              0.019188249    68.119165      0              6578461.4      1.1965779e-13  0              3.9702861    
    700000   6363.961       200            200            0.0040425185  -0.0019655364   0              0.014093092    5.6350078      0              544188.72      1.1965779e-13  0              3.9709766    
    800000   6363.961       200            200            0.0047427003  -0.0019956139   0              0.016223715    0.56014976     0              54095.255      1.1965779e-13  0              3.9706759    
    900000   6363.961       200            200            0.0044613488  -0.0019938662   0              0.015377913    0.046188719    0              4460.5759      1.1965779e-13  0              3.9707925    
   1000000   6363.961       200            200            0.0045691366  -0.001997259    0              0.015704669    0.003634419    0              350.98617      1.1965779e-13  0              3.9707472    
   1100000   6363.961       200            200            0.0045281231  -0.0019957933   0              0.015580163    0.0002317959   0              22.385189      1.1965779e-13  0              3.9707644    
   1200000   6363.961       200            200            0.0045434395  -0.001996613    0              0.015626931    9.158061e-06   0              0.88441998     1.1965779e-13  0              3.9707579    
   1300000   6363.961       200            200            0.0045377378  -0.0019963024   0              0.015609516    2.5404607e-08  0              0.0024533951   1.1965779e-13  0              3.9707603    
   1400000   6363.961       200            200            0.0045398404  -0.0019964159   0              0.015615937    8.4840098e-08  0              0.0081932494   1.1965779e-13  0              3.9707594    
   1500000   6363.961       200            200            0.0045390723  -0.0019963744   0              0.015613591    5.4907613e-08  0              0.0053025842   1.1965779e-13  0              3.9707598    
   1600000   6363.961       200            200            0.0045393503  -0.0019963894   0              0.01561444     1.7420685e-08  0              0.0016823651   1.1965779e-13  0              3.9707596    
   1700000   6363.961       200            200            0.0045392506  -0.001996384    0              0.015614136    4.2086265e-09  0              0.00040643902  1.1965779e-13  0              3.9707597    
   1800000   6363.961       200            200            0.004539286   -0.0019963859   0              0.015614244    8.774319e-10   0              8.4736092e-05  1.1965779e-13  0              3.9707597    
   1900000   6363.961       200            200            0.0045392736  -0.0019963853   0              0.015614206    1.6652089e-10  0              1.6081396e-05  1.1965779e-13  0              3.9707597    
   2000000   6363.961       200            200            0.0045392779  -0.0019963855   0              0.015614219    2.9572273e-11  0              2.8558784e-06  1.1965779e-13  0              3.9707597    
   2100000   6363.961       200            200            0.0045392764  -0.0019963854   0              0.015614215    4.9953289e-12  0              4.8241311e-07  1.1965779e-13  0              3.9707597    
   2200000   6363.961       200            200            0.0045392769  -0.0019963854   0              0.015614216    8.1136795e-13  0              7.8356109e-08  1.1965779e-13  0              3.9707597    
   2300000   6363.961       200            200            0.0045392767  -0.0019963854   0              0.015614216    1.273221e-13   0              1.2295857e-08  1.1965779e-13  0              3.9707597    
   2400000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    1.9249233e-14  0              1.8589532e-09  1.1965779e-13  0              3.9707597    
   2500000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    2.8832077e-15  0              2.7843957e-10  1.1965779e-13  0              3.9707597    
   2600000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    4.2925154e-16  0              4.1454041e-11  1.1965779e-13  0              3.9707597    
   2700000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    6.0651395e-17  0              5.8572777e-12  1.1965779e-13  0              3.9707597    
   2800000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    1.4715334e-19  0              1.4211017e-14  1.1965779e-13  0              3.9707597    
   2900000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    1.774361e-18   0              1.7135508e-13  1.1965779e-13  0              3.9707597    
   3000000   6363.961       200            200            0.0045392768  -0.0019963854   0              0.015614216    7.3108131e-19  0              7.06026e-14    1.1965779e-13  0              3.9707597    
Loop time of 361.845 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7163284.919 ns/day, 0.000 hours/ns, 8290.839 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.284     | 115.99     | 143.51     | 255.5 | 32.05
Neigh   | 0.63923    | 0.65202    | 0.66417    |   1.2 |  0.18
Comm    | 21.813     | 49.197     | 77.097     | 383.7 | 13.60
Output  | 0.24465    | 0.24496    | 0.24529    |   0.1 |  0.07
Modify  | 105.49     | 140.71     | 174.9      | 285.5 | 38.89
Other   |            | 55.05      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         717.25 ave        1061 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2869
Ave neighs/atom = 1.1471411
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.96                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 140.561483663227
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.06
  ghost atom cutoff = 5.06
  binsize = 2.53, bins = 2516 80 80
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 30.23 | 30.24 | 30.24 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.1304946e-14  1.2391484e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00059571743  1.2391484e-13  0             -0.0017871523   76794.43       0              7.4162563e+09  1.1965779e-13  0              4.3993399    
    200000   6363.961       200            200            0.0012622708   1.2391484e-13  0              0.0037868123   127177.12      0              1.2281856e+10  1.1965779e-13  0              3.9874914    
    300000   6363.961       200            200            0.00045994425  1.2391484e-13  0              0.0013798327   23429.947      0              2.2626966e+09  1.1965779e-13  0              3.9855847    
    400000   6363.961       200            200            0.018780264   -0.0040800716   0              0.060420863    782.34401      0              75553185       1.1965779e-13  0              3.9716219    
    500000   6363.961       200            200            0.0067349276  -0.0018437571   0              0.02204854     742.85221      0              71739349       1.1965779e-13  0              3.9749834    
    600000   6363.961       200            200            0.0052813491  -0.002044049    0              0.017888096    98.948726      0              9555759.7      1.1965779e-13  0              3.975453     
    700000   6363.961       200            200            0.0041786808  -0.0019737011   0              0.014509744    10.421201      0              1006405        1.1965779e-13  0              3.9759224    
    800000   6363.961       200            200            0.0046987461  -0.0019919539   0              0.016088192    1.2692635      0              122576.38      1.1965779e-13  0              3.9756987    
    900000   6363.961       200            200            0.0044855574  -0.0019936405   0              0.015450313    0.14333587     0              13842.353      1.1965779e-13  0              3.9757875    
   1000000   6363.961       200            200            0.0045700801  -0.0019954993   0              0.01570574     0.016702691    0              1613.0264      1.1965779e-13  0              3.9757518    
   1100000   6363.961       200            200            0.0045372138  -0.001994439    0              0.015606081    0.0019047317   0              183.94536      1.1965779e-13  0              3.9757656    
   1200000   6363.961       200            200            0.0045498187  -0.0019951202   0              0.015644576    0.00021293306  0              20.563551      1.1965779e-13  0              3.9757603    
   1300000   6363.961       200            200            0.0045449821  -0.0019948554   0              0.015629802    2.310488e-05   0              2.2313039      1.1965779e-13  0              3.9757623    
   1400000   6363.961       200            200            0.0045468272  -0.0019949557   0              0.015635437    2.4198459e-06  0              0.2336914      1.1965779e-13  0              3.9757616    
   1500000   6363.961       200            200            0.0045461272  -0.0019949176   0              0.015633299    2.4194401e-07  0              0.02336522     1.1965779e-13  0              3.9757619    
   1600000   6363.961       200            200            0.0045463914  -0.001994932    0              0.015634106    2.2723882e-08  0              0.0021945098   1.1965779e-13  0              3.9757617    
   1700000   6363.961       200            200            0.0045462921  -0.0019949266   0              0.015633803    1.9496454e-09  0              0.0001882828   1.1965779e-13  0              3.9757618    
   1800000   6363.961       200            200            0.0045463292  -0.0019949286   0              0.015633916    1.4485658e-10  0              1.3989212e-05  1.1965779e-13  0              3.9757618    
   1900000   6363.961       200            200            0.0045463154  -0.0019949278   0              0.015633874    8.2214045e-12  0              7.939644e-07   1.1965779e-13  0              3.9757618    
   2000000   6363.961       200            200            0.0045463206  -0.0019949281   0              0.01563389     2.2884135e-13  0              2.209986e-08   1.1965779e-13  0              3.9757618    
   2100000   6363.961       200            200            0.0045463187  -0.001994928    0              0.015633884    1.2962786e-15  0              1.2518531e-10  1.1965779e-13  0              3.9757618    
   2200000   6363.961       200            200            0.0045463194  -0.0019949281   0              0.015633886    8.3156326e-15  0              8.0306428e-10  1.1965779e-13  0              3.9757618    
   2300000   6363.961       200            200            0.0045463191  -0.001994928    0              0.015633885    3.7809862e-15  0              3.6514058e-10  1.1965779e-13  0              3.9757618    
   2400000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    1.0783715e-15  0              1.041414e-10   1.1965779e-13  0              3.9757618    
   2500000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    2.3321181e-16  0              2.2521928e-11  1.1965779e-13  0              3.9757618    
   2600000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    4.9218551e-17  0              4.7531754e-12  1.1965779e-13  0              3.9757618    
   2700000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    1.494315e-18   0              1.4431025e-13  1.1965779e-13  0              3.9757618    
   2800000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    8.4944581e-18  0              8.2033396e-13  1.1965779e-13  0              3.9757618    
   2900000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    1.4371467e-19  0              1.3878934e-14  1.1965779e-13  0              3.9757618    
   3000000   6363.961       200            200            0.0045463192  -0.001994928    0              0.015633886    9.528302e-20   0              9.2017521e-15  1.1965779e-13  0              3.9757618    
Loop time of 361.763 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7164911.738 ns/day, 0.000 hours/ns, 8292.722 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.403     | 116        | 143.87     | 256.1 | 32.07
Neigh   | 0.61107    | 0.62223    | 0.63326    |   1.1 |  0.17
Comm    | 22.036     | 49.16      | 77.064     | 383.2 | 13.59
Output  | 0.28108    | 0.28139    | 0.28172    |   0.1 |  0.08
Modify  | 105.45     | 140.66     | 174.71     | 284.5 | 38.88
Other   |            | 55.04      |            |       | 15.21

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         720.75 ave        1068 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2883
Ave neighs/atom = 1.1527389
Neighbor list builds = 120
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.97                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 141.413369132189
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.07
  ghost atom cutoff = 5.07
  binsize = 2.535, bins = 2511 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 29.79 | 29.8 | 29.81 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.2214126e-14  1.2664238e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00059010603  1.2664238e-13  0             -0.0017703181   74190.393      0              7.1647771e+09  1.1965779e-13  0              4.4060432    
    200000   6363.961       200            200            0.0012834796   1.2664238e-13  0              0.0038504387   130540.88      0              1.2606704e+10  1.1965779e-13  0              3.988295     
    300000   6363.961       200            200            0.00048152491  1.2664238e-13  0              0.0014445747   25371.982      0              2.4502445e+09  1.1965779e-13  0              3.9884723    
    400000   6363.961       200            200            0.016048051   -0.0044265594   0              0.052570711    2237.7884      0              2.1610958e+08  1.1965779e-13  0              3.977182     
    500000   6363.961       200            200            0.0078866318  -0.0020502446   0              0.02571014     529.16741      0              51103201       1.1965779e-13  0              3.9795783    
    600000   6363.961       200            200            0.0048261758  -0.0019808169   0              0.016459344    117.44911      0              11342395       1.1965779e-13  0              3.9806436    
    700000   6363.961       200            200            0.0043460158  -0.0019950008   0              0.015033048    14.388459      0              1389534.4      1.1965779e-13  0              3.9808539    
    800000   6363.961       200            200            0.0046372712  -0.0019903842   0              0.015902198    1.8963393      0              183134.88      1.1965779e-13  0              3.9807285    
    900000   6363.961       200            200            0.0045185899  -0.0019914316   0              0.015547201    0.24193531     0              23364.381      1.1965779e-13  0              3.980779     
   1000000   6363.961       200            200            0.0045679543  -0.001991704    0              0.015695567    0.031553174    0              3047.1797      1.1965779e-13  0              3.9807579    
   1100000   6363.961       200            200            0.0045485696  -0.0019913306   0              0.015637039    0.0040953299   0              395.49765      1.1965779e-13  0              3.9807662    
   1200000   6363.961       200            200            0.004556084   -0.0019917432   0              0.015659995    0.00053110948  0              51.290752      1.1965779e-13  0              3.980763     
   1300000   6363.961       200            200            0.0045531575  -0.0019915816   0              0.015651054    6.8619404e-05  0              6.6267709      1.1965779e-13  0              3.9807642    
   1400000   6363.961       200            200            0.0045542929  -0.001991644    0              0.015654523    8.8391614e-06  0              0.85362294     1.1965779e-13  0              3.9807637    
   1500000   6363.961       200            200            0.0045538542  -0.0019916199   0              0.015653183    1.1346177e-06  0              0.10957326     1.1965779e-13  0              3.9807639    
   1600000   6363.961       200            200            0.0045540231  -0.0019916291   0              0.015653698    1.4512757e-07  0              0.014015382    1.1965779e-13  0              3.9807639    
   1700000   6363.961       200            200            0.0045539583  -0.0019916256   0              0.015653501    1.8492832e-08  0              0.0017859053   1.1965779e-13  0              3.9807639    
   1800000   6363.961       200            200            0.0045539831  -0.0019916269   0              0.015653576    2.3470655e-09  0              0.00022666278  1.1965779e-13  0              3.9807639    
   1900000   6363.961       200            200            0.0045539736  -0.0019916264   0              0.015653547    2.9661611e-10  0              2.864506e-05   1.1965779e-13  0              3.9807639    
   2000000   6363.961       200            200            0.0045539772  -0.0019916266   0              0.015653558    3.7312633e-11  0              3.603387e-06   1.1965779e-13  0              3.9807639    
   2100000   6363.961       200            200            0.0045539759  -0.0019916265   0              0.015653554    4.6702822e-12  0              4.5102243e-07  1.1965779e-13  0              3.9807639    
   2200000   6363.961       200            200            0.0045539764  -0.0019916266   0              0.015653556    5.8155848e-13  0              5.6162755e-08  1.1965779e-13  0              3.9807639    
   2300000   6363.961       200            200            0.0045539762  -0.0019916266   0              0.015653555    7.1895632e-14  0              6.9431655e-09  1.1965779e-13  0              3.9807639    
   2400000   6363.961       200            200            0.0045539763  -0.0019916266   0              0.015653555    8.6605277e-15  0              8.3637178e-10  1.1965779e-13  0              3.9807639    
   2500000   6363.961       200            200            0.0045539762  -0.0019916266   0              0.015653555    1.1252049e-15  0              1.0866424e-10  1.1965779e-13  0              3.9807639    
   2600000   6363.961       200            200            0.0045539763  -0.0019916266   0              0.015653555    1.3603925e-16  0              1.3137697e-11  1.1965779e-13  0              3.9807639    
   2700000   6363.961       200            200            0.0045539762  -0.0019916266   0              0.015653555    3.6268182e-17  0              3.5025214e-12  1.1965779e-13  0              3.9807639    
   2800000   6363.961       200            200            0.0045539763  -0.0019916266   0              0.015653555    4.7944425e-18  0              4.6301294e-13  1.1965779e-13  0              3.9807639    
   2900000   6363.961       200            200            0.0045539763  -0.0019916266   0              0.015653555    3.3873734e-18  0              3.2712828e-13  1.1965779e-13  0              3.9807639    
   3000000   6363.961       200            200            0.0045539763  -0.0019916266   0              0.015653555    5.3337697e-18  0              5.150973e-13   1.1965779e-13  0              3.9807639    
Loop time of 362.376 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7152791.338 ns/day, 0.000 hours/ns, 8278.694 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.468     | 116.08     | 143.68     | 255.2 | 32.03
Neigh   | 0.60624    | 0.61765    | 0.62908    |   1.1 |  0.17
Comm    | 21.975     | 49.199     | 76.967     | 382.6 | 13.58
Output  | 0.28491    | 0.28522    | 0.28554    |   0.1 |  0.08
Modify  | 105.78     | 141.15     | 175.35     | 285.9 | 38.95
Other   |            | 55.04      |            |       | 15.19

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         723.75 ave        1074 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2895
Ave neighs/atom = 1.157537
Neighbor list builds = 120
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.98                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 142.268689618557
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.08
  ghost atom cutoff = 5.08
  binsize = 2.54, bins = 2506 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 29.75 | 29.76 | 29.77 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.3131001e-14  1.29393e-13    0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00058433276  1.29393e-13    0             -0.0017529983   71632.645      0              6.9177682e+09  1.1965779e-13  0              4.4127092    
    200000   6363.961       200            200            0.0015683341  -2.3424358e-05  0              0.0047284266   133928.49      0              1.2933855e+10  1.1965779e-13  0              3.989037     
    300000   6363.961       200            200            0.00050329403  1.29393e-13    0              0.0015098821   27388.67       0              2.6450017e+09  1.1965779e-13  0              3.9912716    
    400000   6363.961       200            200            0.01248991    -0.0046442432   0              0.042113974    3877.0098      0              3.7441386e+08  1.1965779e-13  0              3.9829969    
    500000   6363.961       200            200            0.0088549681  -0.0022742505   0              0.028839155    288.49439      0              27860724       1.1965779e-13  0              3.9842557    
    600000   6363.961       200            200            0.0043277301  -0.0020471588   0              0.015030349    118.50625      0              11444485       1.1965779e-13  0              3.985843     
    700000   6363.961       200            200            0.0045361209  -0.0020131571   0              0.01562152     16.106262      0              1555427.5      1.1965779e-13  0              3.9857774    
    800000   6363.961       200            200            0.0045674736  -0.0019870354   0              0.015689456    2.1676842      0              209339.43      1.1965779e-13  0              3.9857622    
    900000   6363.961       200            200            0.0045571569  -0.0019870106   0              0.015658481    0.29114636     0              28116.831      1.1965779e-13  0              3.9857686    
   1000000   6363.961       200            200            0.0045643253  -0.0019859007   0              0.015678877    0.039215401    0              3787.1427      1.1965779e-13  0              3.985765     
   1100000   6363.961       200            200            0.0045615435  -0.0019863426   0              0.015670973    0.0052804286   0              509.946        1.1965779e-13  0              3.9857664    
   1200000   6363.961       200            200            0.0045625596  -0.00198641     0              0.015674089    0.00071127355  0              68.689708      1.1965779e-13  0              3.9857658    
   1300000   6363.961       200            200            0.004562169   -0.0019863843   0              0.015672891    9.579745e-05   0              9.251432       1.1965779e-13  0              3.985766     
   1400000   6363.961       200            200            0.0045623197  -0.0019863941   0              0.015673353    1.2902633e-05  0              1.2460439      1.1965779e-13  0              3.9857659    
   1500000   6363.961       200            200            0.0045622618  -0.0019863904   0              0.015673176    1.7377481e-06  0              0.16781927     1.1965779e-13  0              3.985766     
   1600000   6363.961       200            200            0.004562284   -0.0019863918   0              0.015673244    2.3403895e-07  0              0.022601807    1.1965779e-13  0              3.985766     
   1700000   6363.961       200            200            0.0045622755  -0.0019863913   0              0.015673218    3.1519558e-08  0              0.0030439333   1.1965779e-13  0              3.985766     
   1800000   6363.961       200            200            0.0045622788  -0.0019863915   0              0.015673228    4.2447998e-09  0              0.00040993238  1.1965779e-13  0              3.985766     
   1900000   6363.961       200            200            0.0045622775  -0.0019863914   0              0.015673224    5.7164851e-10  0              5.5205722e-05  1.1965779e-13  0              3.985766     
   2000000   6363.961       200            200            0.004562278   -0.0019863914   0              0.015673225    7.698073e-11   0              7.4342479e-06  1.1965779e-13  0              3.985766     
   2100000   6363.961       200            200            0.0045622778  -0.0019863914   0              0.015673225    1.0368463e-11  0              1.001312e-06   1.1965779e-13  0              3.985766     
   2200000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    1.3963219e-12  0              1.3484678e-07  1.1965779e-13  0              3.985766     
   2300000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    1.8806315e-13  0              1.8161793e-08  1.1965779e-13  0              3.985766     
   2400000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    2.5283519e-14  0              2.4417013e-09  1.1965779e-13  0              3.985766     
   2500000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    3.4046812e-15  0              3.2879974e-10  1.1965779e-13  0              3.985766     
   2600000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    4.5677849e-16  0              4.4112397e-11  1.1965779e-13  0              3.985766     
   2700000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    6.6318896e-17  0              6.4046043e-12  1.1965779e-13  0              3.985766     
   2800000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    5.2376557e-22  0              5.058153e-17   1.1965779e-13  0              3.985766     
   2900000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    3.0703202e-18  0              2.9650955e-13  1.1965779e-13  0              3.985766     
   3000000   6363.961       200            200            0.0045622779  -0.0019863914   0              0.015673225    6.2191708e-19  0              6.00603e-14    1.1965779e-13  0              3.985766     
Loop time of 364.503 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7111059.819 ns/day, 0.000 hours/ns, 8230.393 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.301     | 116.18     | 144.1      | 257.4 | 31.87
Neigh   | 0.62944    | 0.64082    | 0.65209    |   1.1 |  0.18
Comm    | 21.983     | 49.337     | 77.355     | 385.0 | 13.54
Output  | 0.294      | 0.2943     | 0.29462    |   0.1 |  0.08
Modify  | 107.6      | 142.94     | 177.08     | 284.2 | 39.21
Other   |            | 55.12      |            |       | 15.12

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         726.75 ave        1080 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2907
Ave neighs/atom = 1.1623351
Neighbor list builds = 122
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3*(2^(1/2))       # Lattice distance of bottom chain
variable lat2 equal 3                   # Lattice distance of top chain
variable d1 equal 3+(100*0.01)+(v_ind*0.01)                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 500*v_lat2              # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)               # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials
#variable den2 equal 1.5

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000 #-(v_ind*100)                       # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 4.24264068711929                                                               
Lattice spacing in x,y,z = 4.2426407 4.2426407 4.2426407

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 ${n1e1} -100 100 -100 100 units box
region box block -3181.98051533947 3181.98051533947 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -3181.98051533947 3181.98051533947 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  4 by 1 by 1 MPI processor grid
create_atoms 1 region substrate
Created 1500 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -1500 1500 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 1001 atoms
  using lattice units in orthogonal box = (-3181.9805 -100 -100) to (3181.9805 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 4.99                    
Setting atom values ...
  1500 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 143.127452033837
Setting atom values ...
  1500 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  1001 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  1001 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
1500 atoms in group substrate
group slider1 region slider1
1001 atoms in group slider1
#group support region support
group substrate_slider union substrate slider1
2501 atoms in group substrate_slider

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 1001 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu
dump_modify D1 format 5 %.18g
dump_modify D1 format 7 %.18g

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.09
  ghost atom cutoff = 5.09
  binsize = 2.545, bins = 2501 79 79
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 29.74 | 29.75 | 29.75 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   6363.961       200            200            4.4055543e-14  1.3216663e-13  0              0              0              0              0              1.1965779e-13  0              6            
    100000   6363.961       200            200           -0.00057839821  1.3216663e-13  0             -0.0017351946   69121.12       0              6.675223e+09   1.1965779e-13  0              4.4193378    
    200000   6363.961       200            200            0.0087561433  -0.0018970505   0              0.02816548     134652.41      0              1.3003766e+10  1.1965779e-13  0              3.9897305    
    300000   6363.961       200            200            0.00081809483 -3.1645471e-05  0              0.00248593     29459.881      0              2.8450245e+09  1.1965779e-13  0              3.9939824    
    400000   6363.961       200            200            0.0087680293  -0.0045751241   0              0.030879212    5190.8084      0              5.0129112e+08  1.1965779e-13  0              3.9889963    
    500000   6363.961       200            200            0.0094995088  -0.0025185472   0              0.031017073    91.825985      0              8867896.4      1.1965779e-13  0              3.9890416    
    600000   6363.961       200            200            0.0038954847  -0.0020214479   0              0.013707902    102.50782      0              9899471.7      1.1965779e-13  0              3.9910363    
    700000   6363.961       200            200            0.004739895   -0.0020062765   0              0.016225961    14.912039      0              1440098        1.1965779e-13  0              3.9907       
    800000   6363.961       200            200            0.0044979372  -0.0019825633   0              0.015476375    1.9672027      0              189978.36      1.1965779e-13  0              3.9907962    
    900000   6363.961       200            200            0.0045963295  -0.001983024    0              0.015772012    0.26549275     0              25639.389      1.1965779e-13  0              3.9907578    
   1000000   6363.961       200            200            0.0045601217  -0.0019810161   0              0.015661381    0.035125276    0              3392.1478      1.1965779e-13  0              3.9907722    
   1100000   6363.961       200            200            0.0045743556  -0.0019822279   0              0.015705295    0.0046485129   0              448.9201       1.1965779e-13  0              3.9907664    
   1200000   6363.961       200            200            0.0045686908  -0.0019819462   0              0.015688019    0.0006133118   0              59.229263      1.1965779e-13  0              3.9907687    
   1300000   6363.961       200            200            0.0045709146  -0.0019820566   0              0.0156948      8.0820998e-05  0              7.8051135      1.1965779e-13  0              3.9907678    
   1400000   6363.961       200            200            0.0045700466  -0.0019820133   0              0.015692153    1.0629989e-05  0              1.0265683      1.1965779e-13  0              3.9907682    
   1500000   6363.961       200            200            0.004570384   -0.0019820301   0              0.015693182    1.3957551e-06  0              0.13479204     1.1965779e-13  0              3.990768     
   1600000   6363.961       200            200            0.0045702534  -0.0019820236   0              0.015692784    1.8293057e-07  0              0.017666125    1.1965779e-13  0              3.9907681    
   1700000   6363.961       200            200            0.0045703038  -0.0019820261   0              0.015692938    2.3930901e-08  0              0.0023110751   1.1965779e-13  0              3.9907681    
   1800000   6363.961       200            200            0.0045702844  -0.0019820251   0              0.015692878    3.124642e-09   0              0.00030175556  1.1965779e-13  0              3.9907681    
   1900000   6363.961       200            200            0.0045702918  -0.0019820255   0              0.015692901    4.0718212e-10  0              3.9322735e-05  1.1965779e-13  0              3.9907681    
   2000000   6363.961       200            200            0.004570289   -0.0019820254   0              0.015692892    5.2950055e-11  0              5.1135373e-06  1.1965779e-13  0              3.9907681    
   2100000   6363.961       200            200            0.0045702901  -0.0019820254   0              0.015692896    6.8724708e-12  0              6.6369404e-07  1.1965779e-13  0              3.9907681    
   2200000   6363.961       200            200            0.0045702897  -0.0019820254   0              0.015692894    8.8953257e-13  0              8.5904688e-08  1.1965779e-13  0              3.9907681    
   2300000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    1.1508988e-13  0              1.1114557e-08  1.1965779e-13  0              3.9907681    
   2400000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    1.4782283e-14  0              1.4275671e-09  1.1965779e-13  0              3.9907681    
   2500000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    1.9047753e-15  0              1.8394957e-10  1.1965779e-13  0              3.9907681    
   2600000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    2.4828251e-16  0              2.3977348e-11  1.1965779e-13  0              3.9907681    
   2700000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    3.1037132e-17  0              2.9973441e-12  1.1965779e-13  0              3.9907681    
   2800000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    3.7593899e-18  0              3.6305497e-13  1.1965779e-13  0              3.9907681    
   2900000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    6.9951917e-22  0              6.7554555e-17  1.1965779e-13  0              3.9907681    
   3000000   6363.961       200            200            0.0045702898  -0.0019820254   0              0.015692895    1.9106136e-19  0              1.8451339e-14  1.1965779e-13  0              3.9907681    
Loop time of 364.074 on 4 procs for 3000000 steps with 2501 atoms

Performance: 7119425.519 ns/day, 0.000 hours/ns, 8240.076 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.603     | 116.65     | 144.92     | 257.7 | 32.04
Neigh   | 0.64059    | 0.65256    | 0.66414    |   1.1 |  0.18
Comm    | 22.434     | 49.538     | 77.939     | 383.8 | 13.61
Output  | 0.25998    | 0.26029    | 0.26063    |   0.1 |  0.07
Modify  | 106.8      | 142.03     | 175.93     | 283.3 | 39.01
Other   |            | 54.94      |            |       | 15.09

Nlocal:         625.25 ave         877 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:           3.75 ave           5 max           3 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Neighs:         729.25 ave        1085 max         374 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2917
Ave neighs/atom = 1.1663335
Neighbor list builds = 126
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 9:41:03
